{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0, "cur_lr": 0.0007999999797903001, "total_loss": 7.602513313293457, "policy_loss": -0.05897967144846916, "vf_loss": 7.644383430480957, "vf_explained_var": 0.04401485621929169, "kl": 0.01710931770503521, "entropy": 2.061995506286621, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -19.712721452116966, "episode_reward_min": -65.67168603092432, "episode_reward_mean": -40.72106991708279, "episode_len_mean": 239.625, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.156525991857052, -65.67168603092432, -19.712721452116966, -23.84236551821232, -24.353673040866852, -62.37685623764992, -50.83015235513449, -53.82457870990038], "episode_lengths": [241, 250, 220, 233, 235, 243, 247, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5673977483316247, "mean_inference_ms": 7.675629687974177, "mean_action_processing_ms": 0.13490656457574246, "mean_env_wait_ms": 5.734362331519564, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -19.712721452116966, "episode_reward_min": -65.67168603092432, "episode_reward_mean": -40.72106991708279, "episode_len_mean": 239.625, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25.156525991857052, -65.67168603092432, -19.712721452116966, -23.84236551821232, -24.353673040866852, -62.37685623764992, -50.83015235513449, -53.82457870990038], "episode_lengths": [241, 250, 220, 233, 235, 243, 247, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5673977483316247, "mean_inference_ms": 7.675629687974177, "mean_action_processing_ms": 0.13490656457574246, "mean_env_wait_ms": 5.734362331519564, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 25921.433, "learn_time_ms": 21097.716, "learn_throughput": 189.594, "update_time_ms": 28.986}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 8, "training_iteration": 1, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-23-58", "timestamp": 1655555038, "time_this_iter_s": 25.931427717208862, "time_total_s": 25.931427717208862, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 25.931427717208862, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 31.800000000000004, "ram_util_percent": 63.57297297297294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0, "cur_lr": 0.0007999999797903001, "total_loss": 6.368012428283691, "policy_loss": -0.06304562836885452, "vf_loss": 6.412425518035889, "vf_explained_var": 0.0853632241487503, "kl": 0.018631979823112488, "entropy": 2.028143882751465, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 1.237474761903286, "episode_reward_min": -109.96809378266335, "episode_reward_mean": -49.69751976132393, "episode_len_mean": 244.96, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.156525991857052, -65.67168603092432, -19.712721452116966, -23.84236551821232, -24.353673040866852, -62.37685623764992, -50.83015235513449, -53.82457870990038, 0.5222751870751381, -91.84660343080759, -38.28846211731434, -109.96809378266335, -73.48342146724463, -90.76105071604252, -33.78936465084553, -58.207718908786774, -8.398326188325882, -87.18677989393473, -25.578734390437603, -103.99626488238573, 1.237474761903286, -20.085335731506348, -59.15359001606703, -43.36861527711153, -74.31682319194078], "episode_lengths": [241, 250, 220, 233, 235, 243, 247, 248, 219, 275, 239, 272, 273, 262, 224, 254, 226, 254, 230, 262, 230, 230, 251, 248, 258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6161703519161904, "mean_inference_ms": 7.626745288825609, "mean_action_processing_ms": 0.13287403934449424, "mean_env_wait_ms": 5.459547209008414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 1.237474761903286, "episode_reward_min": -109.96809378266335, "episode_reward_mean": -49.69751976132393, "episode_len_mean": 244.96, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25.156525991857052, -65.67168603092432, -19.712721452116966, -23.84236551821232, -24.353673040866852, -62.37685623764992, -50.83015235513449, -53.82457870990038, 0.5222751870751381, -91.84660343080759, -38.28846211731434, -109.96809378266335, -73.48342146724463, -90.76105071604252, -33.78936465084553, -58.207718908786774, -8.398326188325882, -87.18677989393473, -25.578734390437603, -103.99626488238573, 1.237474761903286, -20.085335731506348, -59.15359001606703, -43.36861527711153, -74.31682319194078], "episode_lengths": [241, 250, 220, 233, 235, 243, 247, 248, 219, 275, 239, 272, 273, 262, 224, 254, 226, 254, 230, 262, 230, 230, 251, 248, 258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6161703519161904, "mean_inference_ms": 7.626745288825609, "mean_action_processing_ms": 0.13287403934449424, "mean_env_wait_ms": 5.459547209008414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 25255.626, "learn_time_ms": 20958.588, "learn_throughput": 190.853, "update_time_ms": 27.063}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 25, "training_iteration": 2, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-24-23", "timestamp": 1655555063, "time_this_iter_s": 24.59981369972229, "time_total_s": 50.53124141693115, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 50.53124141693115, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 30.261764705882356, "ram_util_percent": 63.8029411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0, "cur_lr": 0.0007999999797903001, "total_loss": 7.127462863922119, "policy_loss": -0.06722940504550934, "vf_loss": 7.1740899085998535, "vf_explained_var": 0.17486903071403503, "kl": 0.020601939409971237, "entropy": 2.0068864822387695, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 1.237474761903286, "episode_reward_min": -168.69999992102385, "episode_reward_mean": -54.533472968026615, "episode_len_mean": 248.17948717948718, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.156525991857052, -65.67168603092432, -19.712721452116966, -23.84236551821232, -24.353673040866852, -62.37685623764992, -50.83015235513449, -53.82457870990038, 0.5222751870751381, -91.84660343080759, -38.28846211731434, -109.96809378266335, -73.48342146724463, -90.76105071604252, -33.78936465084553, -58.207718908786774, -8.398326188325882, -87.18677989393473, -25.578734390437603, -103.99626488238573, 1.237474761903286, -20.085335731506348, -59.15359001606703, -43.36861527711153, -74.31682319194078, -117.14556035399437, -55.46105074882507, -12.681609131395817, -8.82275304198265, -168.69999992102385, -64.29641958326101, -69.20098286122084, -21.220087982714176, -76.04860261082649, -91.12457856535912, -108.01173520088196, -16.68041654676199, -72.08655264228582, -2.8871025294065475], "episode_lengths": [241, 250, 220, 233, 235, 243, 247, 248, 219, 275, 239, 272, 273, 262, 224, 254, 226, 254, 230, 262, 230, 230, 251, 248, 258, 275, 250, 230, 233, 292, 247, 257, 236, 262, 275, 276, 234, 263, 225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.605404703520866, "mean_inference_ms": 7.6081009275241716, "mean_action_processing_ms": 0.13241930609206956, "mean_env_wait_ms": 5.3531115977525685, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 1.237474761903286, "episode_reward_min": -168.69999992102385, "episode_reward_mean": -54.533472968026615, "episode_len_mean": 248.17948717948718, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25.156525991857052, -65.67168603092432, -19.712721452116966, -23.84236551821232, -24.353673040866852, -62.37685623764992, -50.83015235513449, -53.82457870990038, 0.5222751870751381, -91.84660343080759, -38.28846211731434, -109.96809378266335, -73.48342146724463, -90.76105071604252, -33.78936465084553, -58.207718908786774, -8.398326188325882, -87.18677989393473, -25.578734390437603, -103.99626488238573, 1.237474761903286, -20.085335731506348, -59.15359001606703, -43.36861527711153, -74.31682319194078, -117.14556035399437, -55.46105074882507, -12.681609131395817, -8.82275304198265, -168.69999992102385, -64.29641958326101, -69.20098286122084, -21.220087982714176, -76.04860261082649, -91.12457856535912, -108.01173520088196, -16.68041654676199, -72.08655264228582, -2.8871025294065475], "episode_lengths": [241, 250, 220, 233, 235, 243, 247, 248, 219, 275, 239, 272, 273, 262, 224, 254, 226, 254, 230, 262, 230, 230, 251, 248, 258, 275, 250, 230, 233, 292, 247, 257, 236, 262, 275, 276, 234, 263, 225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.605404703520866, "mean_inference_ms": 7.6081009275241716, "mean_action_processing_ms": 0.13241930609206956, "mean_env_wait_ms": 5.3531115977525685, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 24940.911, "learn_time_ms": 20869.132, "learn_throughput": 191.671, "update_time_ms": 26.699}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 39, "training_iteration": 3, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-24-47", "timestamp": 1655555087, "time_this_iter_s": 24.321478366851807, "time_total_s": 74.85271978378296, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 74.85271978378296, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 28.102857142857143, "ram_util_percent": 63.811428571428586}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 7.189481735229492, "policy_loss": -0.07587432861328125, "vf_loss": 7.239841938018799, "vf_explained_var": -0.24718652665615082, "kl": 0.017009271308779716, "entropy": 1.9989891052246094, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 1.237474761903286, "episode_reward_min": -168.69999992102385, "episode_reward_mean": -63.00202035917988, "episode_len_mean": 251.83018867924528, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.156525991857052, -65.67168603092432, -19.712721452116966, -23.84236551821232, -24.353673040866852, -62.37685623764992, -50.83015235513449, -53.82457870990038, 0.5222751870751381, -91.84660343080759, -38.28846211731434, -109.96809378266335, -73.48342146724463, -90.76105071604252, -33.78936465084553, -58.207718908786774, -8.398326188325882, -87.18677989393473, -25.578734390437603, -103.99626488238573, 1.237474761903286, -20.085335731506348, -59.15359001606703, -43.36861527711153, -74.31682319194078, -117.14556035399437, -55.46105074882507, -12.681609131395817, -8.82275304198265, -168.69999992102385, -64.29641958326101, -69.20098286122084, -21.220087982714176, -76.04860261082649, -91.12457856535912, -108.01173520088196, -16.68041654676199, -72.08655264228582, -2.8871025294065475, -71.66393055021763, -84.69626495242119, -50.47816949337721, -97.2130409553647, -77.46142785996199, -57.25846600532532, -90.3733686581254, -41.949512884020805, -132.25601457804441, -121.69999987632036, -145.68160928040743, -143.80258970707655, -78.91682326048613, -18.850415222346783], "episode_lengths": [241, 250, 220, 233, 235, 243, 247, 248, 219, 275, 239, 272, 273, 262, 224, 254, 226, 254, 230, 262, 230, 230, 251, 248, 258, 275, 250, 230, 233, 292, 247, 257, 236, 262, 275, 276, 234, 263, 225, 263, 249, 253, 276, 246, 240, 261, 244, 297, 266, 288, 298, 263, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5970008151198763, "mean_inference_ms": 7.591672669233822, "mean_action_processing_ms": 0.1316396731202696, "mean_env_wait_ms": 5.261449828435542, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 1.237474761903286, "episode_reward_min": -168.69999992102385, "episode_reward_mean": -63.00202035917988, "episode_len_mean": 251.83018867924528, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25.156525991857052, -65.67168603092432, -19.712721452116966, -23.84236551821232, -24.353673040866852, -62.37685623764992, -50.83015235513449, -53.82457870990038, 0.5222751870751381, -91.84660343080759, -38.28846211731434, -109.96809378266335, -73.48342146724463, -90.76105071604252, -33.78936465084553, -58.207718908786774, -8.398326188325882, -87.18677989393473, -25.578734390437603, -103.99626488238573, 1.237474761903286, -20.085335731506348, -59.15359001606703, -43.36861527711153, -74.31682319194078, -117.14556035399437, -55.46105074882507, -12.681609131395817, -8.82275304198265, -168.69999992102385, -64.29641958326101, -69.20098286122084, -21.220087982714176, -76.04860261082649, -91.12457856535912, -108.01173520088196, -16.68041654676199, -72.08655264228582, -2.8871025294065475, -71.66393055021763, -84.69626495242119, -50.47816949337721, -97.2130409553647, -77.46142785996199, -57.25846600532532, -90.3733686581254, -41.949512884020805, -132.25601457804441, -121.69999987632036, -145.68160928040743, -143.80258970707655, -78.91682326048613, -18.850415222346783], "episode_lengths": [241, 250, 220, 233, 235, 243, 247, 248, 219, 275, 239, 272, 273, 262, 224, 254, 226, 254, 230, 262, 230, 230, 251, 248, 258, 275, 250, 230, 233, 292, 247, 257, 236, 262, 275, 276, 234, 263, 225, 263, 249, 253, 276, 246, 240, 261, 244, 297, 266, 288, 298, 263, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5970008151198763, "mean_inference_ms": 7.591672669233822, "mean_action_processing_ms": 0.1316396731202696, "mean_env_wait_ms": 5.261449828435542, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 24770.728, "learn_time_ms": 20843.31, "learn_throughput": 191.908, "update_time_ms": 26.766}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 53, "training_iteration": 4, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-25-12", "timestamp": 1655555112, "time_this_iter_s": 24.27017617225647, "time_total_s": 99.12289595603943, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 99.12289595603943, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 29.888235294117646, "ram_util_percent": 63.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 6.527104377746582, "policy_loss": -0.07874877750873566, "vf_loss": 6.580855846405029, "vf_explained_var": 0.1719084084033966, "kl": 0.01666436903178692, "entropy": 1.975795030593872, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 16.36477518826723, "episode_reward_min": -168.69999992102385, "episode_reward_mean": -64.31641499336277, "episode_len_mean": 252.75714285714287, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.156525991857052, -65.67168603092432, -19.712721452116966, -23.84236551821232, -24.353673040866852, -62.37685623764992, -50.83015235513449, -53.82457870990038, 0.5222751870751381, -91.84660343080759, -38.28846211731434, -109.96809378266335, -73.48342146724463, -90.76105071604252, -33.78936465084553, -58.207718908786774, -8.398326188325882, -87.18677989393473, -25.578734390437603, -103.99626488238573, 1.237474761903286, -20.085335731506348, -59.15359001606703, -43.36861527711153, -74.31682319194078, -117.14556035399437, -55.46105074882507, -12.681609131395817, -8.82275304198265, -168.69999992102385, -64.29641958326101, -69.20098286122084, -21.220087982714176, -76.04860261082649, -91.12457856535912, -108.01173520088196, -16.68041654676199, -72.08655264228582, -2.8871025294065475, -71.66393055021763, -84.69626495242119, -50.47816949337721, -97.2130409553647, -77.46142785996199, -57.25846600532532, -90.3733686581254, -41.949512884020805, -132.25601457804441, -121.69999987632036, -145.68160928040743, -143.80258970707655, -78.91682326048613, -18.850415222346783, -135.81541439890862, -63.871586829423904, -126.84087684750557, -2.8495538383722305, -86.13580740243196, -50.68304492533207, -65.15300030261278, -33.82745884358883, -49.413943387568, -78.56159281730652, -43.77524192631245, -94.68077716976404, -125.86700087785721, -98.16302816569805, -88.25041534751654, 16.36477518826723, -35.51800260692835], "episode_lengths": [241, 250, 220, 233, 235, 243, 247, 248, 219, 275, 239, 272, 273, 262, 224, 254, 226, 254, 230, 262, 230, 230, 251, 248, 258, 275, 250, 230, 233, 292, 247, 257, 236, 262, 275, 276, 234, 263, 225, 263, 249, 253, 276, 246, 240, 261, 244, 297, 266, 288, 298, 263, 224, 289, 260, 274, 215, 268, 251, 263, 229, 247, 260, 248, 262, 289, 266, 265, 224, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5962186736184293, "mean_inference_ms": 7.575061006571998, "mean_action_processing_ms": 0.1308075563798046, "mean_env_wait_ms": 5.197964228132524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 16.36477518826723, "episode_reward_min": -168.69999992102385, "episode_reward_mean": -64.31641499336277, "episode_len_mean": 252.75714285714287, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25.156525991857052, -65.67168603092432, -19.712721452116966, -23.84236551821232, -24.353673040866852, -62.37685623764992, -50.83015235513449, -53.82457870990038, 0.5222751870751381, -91.84660343080759, -38.28846211731434, -109.96809378266335, -73.48342146724463, -90.76105071604252, -33.78936465084553, -58.207718908786774, -8.398326188325882, -87.18677989393473, -25.578734390437603, -103.99626488238573, 1.237474761903286, -20.085335731506348, -59.15359001606703, -43.36861527711153, -74.31682319194078, -117.14556035399437, -55.46105074882507, -12.681609131395817, -8.82275304198265, -168.69999992102385, -64.29641958326101, -69.20098286122084, -21.220087982714176, -76.04860261082649, -91.12457856535912, -108.01173520088196, -16.68041654676199, -72.08655264228582, -2.8871025294065475, -71.66393055021763, -84.69626495242119, -50.47816949337721, -97.2130409553647, -77.46142785996199, -57.25846600532532, -90.3733686581254, -41.949512884020805, -132.25601457804441, -121.69999987632036, -145.68160928040743, -143.80258970707655, -78.91682326048613, -18.850415222346783, -135.81541439890862, -63.871586829423904, -126.84087684750557, -2.8495538383722305, -86.13580740243196, -50.68304492533207, -65.15300030261278, -33.82745884358883, -49.413943387568, -78.56159281730652, -43.77524192631245, -94.68077716976404, -125.86700087785721, -98.16302816569805, -88.25041534751654, 16.36477518826723, -35.51800260692835], "episode_lengths": [241, 250, 220, 233, 235, 243, 247, 248, 219, 275, 239, 272, 273, 262, 224, 254, 226, 254, 230, 262, 230, 230, 251, 248, 258, 275, 250, 230, 233, 292, 247, 257, 236, 262, 275, 276, 234, 263, 225, 263, 249, 253, 276, 246, 240, 261, 244, 297, 266, 288, 298, 263, 224, 289, 260, 274, 215, 268, 251, 263, 229, 247, 260, 248, 262, 289, 266, 265, 224, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5962186736184293, "mean_inference_ms": 7.575061006571998, "mean_action_processing_ms": 0.1308075563798046, "mean_env_wait_ms": 5.197964228132524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 24720.778, "learn_time_ms": 20816.61, "learn_throughput": 192.154, "update_time_ms": 28.007}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 70, "training_iteration": 5, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-25-36", "timestamp": 1655555136, "time_this_iter_s": 24.531973361968994, "time_total_s": 123.65486931800842, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 123.65486931800842, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 28.570588235294117, "ram_util_percent": 63.89411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 6.291946887969971, "policy_loss": -0.07982496172189713, "vf_loss": 6.347254753112793, "vf_explained_var": 0.02062457613646984, "kl": 0.016345124691724777, "entropy": 1.98016357421875, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 18.2910313680768, "episode_reward_min": -168.69999992102385, "episode_reward_mean": -64.40828771715941, "episode_len_mean": 252.98837209302326, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.156525991857052, -65.67168603092432, -19.712721452116966, -23.84236551821232, -24.353673040866852, -62.37685623764992, -50.83015235513449, -53.82457870990038, 0.5222751870751381, -91.84660343080759, -38.28846211731434, -109.96809378266335, -73.48342146724463, -90.76105071604252, -33.78936465084553, -58.207718908786774, -8.398326188325882, -87.18677989393473, -25.578734390437603, -103.99626488238573, 1.237474761903286, -20.085335731506348, -59.15359001606703, -43.36861527711153, -74.31682319194078, -117.14556035399437, -55.46105074882507, -12.681609131395817, -8.82275304198265, -168.69999992102385, -64.29641958326101, -69.20098286122084, -21.220087982714176, -76.04860261082649, -91.12457856535912, -108.01173520088196, -16.68041654676199, -72.08655264228582, -2.8871025294065475, -71.66393055021763, -84.69626495242119, -50.47816949337721, -97.2130409553647, -77.46142785996199, -57.25846600532532, -90.3733686581254, -41.949512884020805, -132.25601457804441, -121.69999987632036, -145.68160928040743, -143.80258970707655, -78.91682326048613, -18.850415222346783, -135.81541439890862, -63.871586829423904, -126.84087684750557, -2.8495538383722305, -86.13580740243196, -50.68304492533207, -65.15300030261278, -33.82745884358883, -49.413943387568, -78.56159281730652, -43.77524192631245, -94.68077716976404, -125.86700087785721, -98.16302816569805, -88.25041534751654, 16.36477518826723, -35.51800260692835, 18.2910313680768, -89.36760874092579, -11.196264915168285, -85.8893646299839, -155.9990974739194, -54.18304466456175, -56.340947173535824, -167.0973433330655, -84.79909731447697, -97.30431328713894, -26.416741870343685, -23.424975104629993, -48.13719543069601, -36.5761444196105, -65.46105083823204, -53.06153631210327], "episode_lengths": [241, 250, 220, 233, 235, 243, 247, 248, 219, 275, 239, 272, 273, 262, 224, 254, 226, 254, 230, 262, 230, 230, 251, 248, 258, 275, 250, 230, 233, 292, 247, 257, 236, 262, 275, 276, 234, 263, 225, 263, 249, 253, 276, 246, 240, 261, 244, 297, 266, 288, 298, 263, 224, 289, 260, 274, 215, 268, 251, 263, 229, 247, 260, 248, 262, 289, 266, 265, 224, 236, 215, 257, 223, 258, 297, 257, 254, 307, 260, 270, 242, 224, 257, 243, 259, 241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5971674786056543, "mean_inference_ms": 7.574524748429423, "mean_action_processing_ms": 0.13006680294698592, "mean_env_wait_ms": 5.160780147732532, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 18.2910313680768, "episode_reward_min": -168.69999992102385, "episode_reward_mean": -64.40828771715941, "episode_len_mean": 252.98837209302326, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25.156525991857052, -65.67168603092432, -19.712721452116966, -23.84236551821232, -24.353673040866852, -62.37685623764992, -50.83015235513449, -53.82457870990038, 0.5222751870751381, -91.84660343080759, -38.28846211731434, -109.96809378266335, -73.48342146724463, -90.76105071604252, -33.78936465084553, -58.207718908786774, -8.398326188325882, -87.18677989393473, -25.578734390437603, -103.99626488238573, 1.237474761903286, -20.085335731506348, -59.15359001606703, -43.36861527711153, -74.31682319194078, -117.14556035399437, -55.46105074882507, -12.681609131395817, -8.82275304198265, -168.69999992102385, -64.29641958326101, -69.20098286122084, -21.220087982714176, -76.04860261082649, -91.12457856535912, -108.01173520088196, -16.68041654676199, -72.08655264228582, -2.8871025294065475, -71.66393055021763, -84.69626495242119, -50.47816949337721, -97.2130409553647, -77.46142785996199, -57.25846600532532, -90.3733686581254, -41.949512884020805, -132.25601457804441, -121.69999987632036, -145.68160928040743, -143.80258970707655, -78.91682326048613, -18.850415222346783, -135.81541439890862, -63.871586829423904, -126.84087684750557, -2.8495538383722305, -86.13580740243196, -50.68304492533207, -65.15300030261278, -33.82745884358883, -49.413943387568, -78.56159281730652, -43.77524192631245, -94.68077716976404, -125.86700087785721, -98.16302816569805, -88.25041534751654, 16.36477518826723, -35.51800260692835, 18.2910313680768, -89.36760874092579, -11.196264915168285, -85.8893646299839, -155.9990974739194, -54.18304466456175, -56.340947173535824, -167.0973433330655, -84.79909731447697, -97.30431328713894, -26.416741870343685, -23.424975104629993, -48.13719543069601, -36.5761444196105, -65.46105083823204, -53.06153631210327], "episode_lengths": [241, 250, 220, 233, 235, 243, 247, 248, 219, 275, 239, 272, 273, 262, 224, 254, 226, 254, 230, 262, 230, 230, 251, 248, 258, 275, 250, 230, 233, 292, 247, 257, 236, 262, 275, 276, 234, 263, 225, 263, 249, 253, 276, 246, 240, 261, 244, 297, 266, 288, 298, 263, 224, 289, 260, 274, 215, 268, 251, 263, 229, 247, 260, 248, 262, 289, 266, 265, 224, 236, 215, 257, 223, 258, 297, 257, 254, 307, 260, 270, 242, 224, 257, 243, 259, 241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5971674786056543, "mean_inference_ms": 7.574524748429423, "mean_action_processing_ms": 0.13006680294698592, "mean_env_wait_ms": 5.160780147732532, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 24689.975, "learn_time_ms": 20817.955, "learn_throughput": 192.142, "update_time_ms": 27.679}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 86, "training_iteration": 6, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-26-01", "timestamp": 1655555161, "time_this_iter_s": 24.545955896377563, "time_total_s": 148.200825214386, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 148.200825214386, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 28.98, "ram_util_percent": 64.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 7.030550479888916, "policy_loss": -0.09632851928472519, "vf_loss": 7.098622798919678, "vf_explained_var": 0.12485140562057495, "kl": 0.018837792798876762, "entropy": 1.9493529796600342, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 18.2910313680768, "episode_reward_min": -168.69999992102385, "episode_reward_mean": -63.67040742613375, "episode_len_mean": 252.65, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.84236551821232, -24.353673040866852, -62.37685623764992, -50.83015235513449, -53.82457870990038, 0.5222751870751381, -91.84660343080759, -38.28846211731434, -109.96809378266335, -73.48342146724463, -90.76105071604252, -33.78936465084553, -58.207718908786774, -8.398326188325882, -87.18677989393473, -25.578734390437603, -103.99626488238573, 1.237474761903286, -20.085335731506348, -59.15359001606703, -43.36861527711153, -74.31682319194078, -117.14556035399437, -55.46105074882507, -12.681609131395817, -8.82275304198265, -168.69999992102385, -64.29641958326101, -69.20098286122084, -21.220087982714176, -76.04860261082649, -91.12457856535912, -108.01173520088196, -16.68041654676199, -72.08655264228582, -2.8871025294065475, -71.66393055021763, -84.69626495242119, -50.47816949337721, -97.2130409553647, -77.46142785996199, -57.25846600532532, -90.3733686581254, -41.949512884020805, -132.25601457804441, -121.69999987632036, -145.68160928040743, -143.80258970707655, -78.91682326048613, -18.850415222346783, -135.81541439890862, -63.871586829423904, -126.84087684750557, -2.8495538383722305, -86.13580740243196, -50.68304492533207, -65.15300030261278, -33.82745884358883, -49.413943387568, -78.56159281730652, -43.77524192631245, -94.68077716976404, -125.86700087785721, -98.16302816569805, -88.25041534751654, 16.36477518826723, -35.51800260692835, 18.2910313680768, -89.36760874092579, -11.196264915168285, -85.8893646299839, -155.9990974739194, -54.18304466456175, -56.340947173535824, -167.0973433330655, -84.79909731447697, -97.30431328713894, -26.416741870343685, -23.424975104629993, -48.13719543069601, -36.5761444196105, -65.46105083823204, -53.06153631210327, -86.18887940049171, -53.7495127171278, -74.50888150185347, -79.43521421402693, -68.68238920718431, -73.99843715876341, -53.551901303231716, -82.17872920632362, -46.6217056363821, 4.943898588418961, -43.282529048621655, -88.41195169091225, -23.439386062324047, 14.454669527709484, -62.24915488809347, -54.33361441642046, -67.23521407693624], "episode_lengths": [233, 235, 243, 247, 248, 219, 275, 239, 272, 273, 262, 224, 254, 226, 254, 230, 262, 230, 230, 251, 248, 258, 275, 250, 230, 233, 292, 247, 257, 236, 262, 275, 276, 234, 263, 225, 263, 249, 253, 276, 246, 240, 261, 244, 297, 266, 288, 298, 263, 224, 289, 260, 274, 215, 268, 251, 263, 229, 247, 260, 248, 262, 289, 266, 265, 224, 236, 215, 257, 223, 258, 297, 257, 254, 307, 260, 270, 242, 224, 257, 243, 259, 241, 256, 246, 261, 254, 266, 261, 239, 256, 247, 232, 242, 279, 233, 216, 259, 237, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6017295928704828, "mean_inference_ms": 7.5617506404566734, "mean_action_processing_ms": 0.1289062024774035, "mean_env_wait_ms": 5.107746952777821, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 18.2910313680768, "episode_reward_min": -168.69999992102385, "episode_reward_mean": -63.67040742613375, "episode_len_mean": 252.65, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.84236551821232, -24.353673040866852, -62.37685623764992, -50.83015235513449, -53.82457870990038, 0.5222751870751381, -91.84660343080759, -38.28846211731434, -109.96809378266335, -73.48342146724463, -90.76105071604252, -33.78936465084553, -58.207718908786774, -8.398326188325882, -87.18677989393473, -25.578734390437603, -103.99626488238573, 1.237474761903286, -20.085335731506348, -59.15359001606703, -43.36861527711153, -74.31682319194078, -117.14556035399437, -55.46105074882507, -12.681609131395817, -8.82275304198265, -168.69999992102385, -64.29641958326101, -69.20098286122084, -21.220087982714176, -76.04860261082649, -91.12457856535912, -108.01173520088196, -16.68041654676199, -72.08655264228582, -2.8871025294065475, -71.66393055021763, -84.69626495242119, -50.47816949337721, -97.2130409553647, -77.46142785996199, -57.25846600532532, -90.3733686581254, -41.949512884020805, -132.25601457804441, -121.69999987632036, -145.68160928040743, -143.80258970707655, -78.91682326048613, -18.850415222346783, -135.81541439890862, -63.871586829423904, -126.84087684750557, -2.8495538383722305, -86.13580740243196, -50.68304492533207, -65.15300030261278, -33.82745884358883, -49.413943387568, -78.56159281730652, -43.77524192631245, -94.68077716976404, -125.86700087785721, -98.16302816569805, -88.25041534751654, 16.36477518826723, -35.51800260692835, 18.2910313680768, -89.36760874092579, -11.196264915168285, -85.8893646299839, -155.9990974739194, -54.18304466456175, -56.340947173535824, -167.0973433330655, -84.79909731447697, -97.30431328713894, -26.416741870343685, -23.424975104629993, -48.13719543069601, -36.5761444196105, -65.46105083823204, -53.06153631210327, -86.18887940049171, -53.7495127171278, -74.50888150185347, -79.43521421402693, -68.68238920718431, -73.99843715876341, -53.551901303231716, -82.17872920632362, -46.6217056363821, 4.943898588418961, -43.282529048621655, -88.41195169091225, -23.439386062324047, 14.454669527709484, -62.24915488809347, -54.33361441642046, -67.23521407693624], "episode_lengths": [233, 235, 243, 247, 248, 219, 275, 239, 272, 273, 262, 224, 254, 226, 254, 230, 262, 230, 230, 251, 248, 258, 275, 250, 230, 233, 292, 247, 257, 236, 262, 275, 276, 234, 263, 225, 263, 249, 253, 276, 246, 240, 261, 244, 297, 266, 288, 298, 263, 224, 289, 260, 274, 215, 268, 251, 263, 229, 247, 260, 248, 262, 289, 266, 265, 224, 236, 215, 257, 223, 258, 297, 257, 254, 307, 260, 270, 242, 224, 257, 243, 259, 241, 256, 246, 261, 254, 266, 261, 239, 256, 247, 232, 242, 279, 233, 216, 259, 237, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6017295928704828, "mean_inference_ms": 7.5617506404566734, "mean_action_processing_ms": 0.1289062024774035, "mean_env_wait_ms": 5.107746952777821, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 24647.322, "learn_time_ms": 20828.258, "learn_throughput": 192.047, "update_time_ms": 27.72}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 103, "training_iteration": 7, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-26-25", "timestamp": 1655555185, "time_this_iter_s": 24.40139865875244, "time_total_s": 172.60222387313843, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 172.60222387313843, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 29.105882352941176, "ram_util_percent": 64.07647058823528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 6.7382707595825195, "policy_loss": -0.08950021862983704, "vf_loss": 6.8009161949157715, "vf_explained_var": -0.046678684651851654, "kl": 0.017903562635183334, "entropy": 1.9315919876098633, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 25.67621522396803, "episode_reward_min": -168.69999992102385, "episode_reward_mean": -64.08812106080353, "episode_len_mean": 252.79, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.398326188325882, -87.18677989393473, -25.578734390437603, -103.99626488238573, 1.237474761903286, -20.085335731506348, -59.15359001606703, -43.36861527711153, -74.31682319194078, -117.14556035399437, -55.46105074882507, -12.681609131395817, -8.82275304198265, -168.69999992102385, -64.29641958326101, -69.20098286122084, -21.220087982714176, -76.04860261082649, -91.12457856535912, -108.01173520088196, -16.68041654676199, -72.08655264228582, -2.8871025294065475, -71.66393055021763, -84.69626495242119, -50.47816949337721, -97.2130409553647, -77.46142785996199, -57.25846600532532, -90.3733686581254, -41.949512884020805, -132.25601457804441, -121.69999987632036, -145.68160928040743, -143.80258970707655, -78.91682326048613, -18.850415222346783, -135.81541439890862, -63.871586829423904, -126.84087684750557, -2.8495538383722305, -86.13580740243196, -50.68304492533207, -65.15300030261278, -33.82745884358883, -49.413943387568, -78.56159281730652, -43.77524192631245, -94.68077716976404, -125.86700087785721, -98.16302816569805, -88.25041534751654, 16.36477518826723, -35.51800260692835, 18.2910313680768, -89.36760874092579, -11.196264915168285, -85.8893646299839, -155.9990974739194, -54.18304466456175, -56.340947173535824, -167.0973433330655, -84.79909731447697, -97.30431328713894, -26.416741870343685, -23.424975104629993, -48.13719543069601, -36.5761444196105, -65.46105083823204, -53.06153631210327, -86.18887940049171, -53.7495127171278, -74.50888150185347, -79.43521421402693, -68.68238920718431, -73.99843715876341, -53.551901303231716, -82.17872920632362, -46.6217056363821, 4.943898588418961, -43.282529048621655, -88.41195169091225, -23.439386062324047, 14.454669527709484, -62.24915488809347, -54.33361441642046, -67.23521407693624, -137.79999981075525, -35.606187880039215, -48.096264973282814, -43.71172207593918, 25.67621522396803, -80.79421980679035, -47.61093842983246, -3.3265271112322807, -87.90950589627028, -12.393534012138844, -119.25707807391882, -124.40320423990488, -37.58846212923527], "episode_lengths": [226, 254, 230, 262, 230, 230, 251, 248, 258, 275, 250, 230, 233, 292, 247, 257, 236, 262, 275, 276, 234, 263, 225, 263, 249, 253, 276, 246, 240, 261, 244, 297, 266, 288, 298, 263, 224, 289, 260, 274, 215, 268, 251, 263, 229, 247, 260, 248, 262, 289, 266, 265, 224, 236, 215, 257, 223, 258, 297, 257, 254, 307, 260, 270, 242, 224, 257, 243, 259, 241, 256, 246, 261, 254, 266, 261, 239, 256, 247, 232, 242, 279, 233, 216, 259, 237, 235, 287, 234, 247, 246, 211, 262, 240, 230, 268, 227, 276, 277, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6044093152237519, "mean_inference_ms": 7.543645341435745, "mean_action_processing_ms": 0.12777344532557453, "mean_env_wait_ms": 5.035445767013005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 25.67621522396803, "episode_reward_min": -168.69999992102385, "episode_reward_mean": -64.08812106080353, "episode_len_mean": 252.79, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.398326188325882, -87.18677989393473, -25.578734390437603, -103.99626488238573, 1.237474761903286, -20.085335731506348, -59.15359001606703, -43.36861527711153, -74.31682319194078, -117.14556035399437, -55.46105074882507, -12.681609131395817, -8.82275304198265, -168.69999992102385, -64.29641958326101, -69.20098286122084, -21.220087982714176, -76.04860261082649, -91.12457856535912, -108.01173520088196, -16.68041654676199, -72.08655264228582, -2.8871025294065475, -71.66393055021763, -84.69626495242119, -50.47816949337721, -97.2130409553647, -77.46142785996199, -57.25846600532532, -90.3733686581254, -41.949512884020805, -132.25601457804441, -121.69999987632036, -145.68160928040743, -143.80258970707655, -78.91682326048613, -18.850415222346783, -135.81541439890862, -63.871586829423904, -126.84087684750557, -2.8495538383722305, -86.13580740243196, -50.68304492533207, -65.15300030261278, -33.82745884358883, -49.413943387568, -78.56159281730652, -43.77524192631245, -94.68077716976404, -125.86700087785721, -98.16302816569805, -88.25041534751654, 16.36477518826723, -35.51800260692835, 18.2910313680768, -89.36760874092579, -11.196264915168285, -85.8893646299839, -155.9990974739194, -54.18304466456175, -56.340947173535824, -167.0973433330655, -84.79909731447697, -97.30431328713894, -26.416741870343685, -23.424975104629993, -48.13719543069601, -36.5761444196105, -65.46105083823204, -53.06153631210327, -86.18887940049171, -53.7495127171278, -74.50888150185347, -79.43521421402693, -68.68238920718431, -73.99843715876341, -53.551901303231716, -82.17872920632362, -46.6217056363821, 4.943898588418961, -43.282529048621655, -88.41195169091225, -23.439386062324047, 14.454669527709484, -62.24915488809347, -54.33361441642046, -67.23521407693624, -137.79999981075525, -35.606187880039215, -48.096264973282814, -43.71172207593918, 25.67621522396803, -80.79421980679035, -47.61093842983246, -3.3265271112322807, -87.90950589627028, -12.393534012138844, -119.25707807391882, -124.40320423990488, -37.58846212923527], "episode_lengths": [226, 254, 230, 262, 230, 230, 251, 248, 258, 275, 250, 230, 233, 292, 247, 257, 236, 262, 275, 276, 234, 263, 225, 263, 249, 253, 276, 246, 240, 261, 244, 297, 266, 288, 298, 263, 224, 289, 260, 274, 215, 268, 251, 263, 229, 247, 260, 248, 262, 289, 266, 265, 224, 236, 215, 257, 223, 258, 297, 257, 254, 307, 260, 270, 242, 224, 257, 243, 259, 241, 256, 246, 261, 254, 266, 261, 239, 256, 247, 232, 242, 279, 233, 216, 259, 237, 235, 287, 234, 247, 246, 211, 262, 240, 230, 268, 227, 276, 277, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6044093152237519, "mean_inference_ms": 7.543645341435745, "mean_action_processing_ms": 0.12777344532557453, "mean_env_wait_ms": 5.035445767013005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 24625.329, "learn_time_ms": 20847.482, "learn_throughput": 191.87, "update_time_ms": 27.501}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 116, "training_iteration": 8, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-26-50", "timestamp": 1655555210, "time_this_iter_s": 24.48137879371643, "time_total_s": 197.08360266685486, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 197.08360266685486, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 27.831428571428567, "ram_util_percent": 64.13428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 6.808548450469971, "policy_loss": -0.08957962691783905, "vf_loss": 6.871545791625977, "vf_explained_var": 0.13400019705295563, "kl": 0.017721548676490784, "entropy": 1.9177658557891846, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 25.67621522396803, "episode_reward_min": -313.3406648337841, "episode_reward_mean": -66.63831529699266, "episode_len_mean": 254.74, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.220087982714176, -76.04860261082649, -91.12457856535912, -108.01173520088196, -16.68041654676199, -72.08655264228582, -2.8871025294065475, -71.66393055021763, -84.69626495242119, -50.47816949337721, -97.2130409553647, -77.46142785996199, -57.25846600532532, -90.3733686581254, -41.949512884020805, -132.25601457804441, -121.69999987632036, -145.68160928040743, -143.80258970707655, -78.91682326048613, -18.850415222346783, -135.81541439890862, -63.871586829423904, -126.84087684750557, -2.8495538383722305, -86.13580740243196, -50.68304492533207, -65.15300030261278, -33.82745884358883, -49.413943387568, -78.56159281730652, -43.77524192631245, -94.68077716976404, -125.86700087785721, -98.16302816569805, -88.25041534751654, 16.36477518826723, -35.51800260692835, 18.2910313680768, -89.36760874092579, -11.196264915168285, -85.8893646299839, -155.9990974739194, -54.18304466456175, -56.340947173535824, -167.0973433330655, -84.79909731447697, -97.30431328713894, -26.416741870343685, -23.424975104629993, -48.13719543069601, -36.5761444196105, -65.46105083823204, -53.06153631210327, -86.18887940049171, -53.7495127171278, -74.50888150185347, -79.43521421402693, -68.68238920718431, -73.99843715876341, -53.551901303231716, -82.17872920632362, -46.6217056363821, 4.943898588418961, -43.282529048621655, -88.41195169091225, -23.439386062324047, 14.454669527709484, -62.24915488809347, -54.33361441642046, -67.23521407693624, -137.79999981075525, -35.606187880039215, -48.096264973282814, -43.71172207593918, 25.67621522396803, -80.79421980679035, -47.61093842983246, -3.3265271112322807, -87.90950589627028, -12.393534012138844, -119.25707807391882, -124.40320423990488, -37.58846212923527, -77.16031432896852, -10.829821266233921, -115.73431136459112, -30.676144629716873, -13.199999958276749, -116.63058944791555, -62.59173683077097, 11.574662245810032, -313.3406648337841, -75.0563830807805, -39.48160910606384, -146.72523325681686, -46.55966315418482, -17.914238840341568, -67.68769542872906, -50.16105078905821], "episode_lengths": [236, 262, 275, 276, 234, 263, 225, 263, 249, 253, 276, 246, 240, 261, 244, 297, 266, 288, 298, 263, 224, 289, 260, 274, 215, 268, 251, 263, 229, 247, 260, 248, 262, 289, 266, 265, 224, 236, 215, 257, 223, 258, 297, 257, 254, 307, 260, 270, 242, 224, 257, 243, 259, 241, 256, 246, 261, 254, 266, 261, 239, 256, 247, 232, 242, 279, 233, 216, 259, 237, 235, 287, 234, 247, 246, 211, 262, 240, 230, 268, 227, 276, 277, 233, 260, 241, 283, 240, 221, 276, 262, 223, 372, 267, 236, 298, 242, 234, 261, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.600884974006317, "mean_inference_ms": 7.531644031382858, "mean_action_processing_ms": 0.1264611840463098, "mean_env_wait_ms": 4.9828569765357384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 25.67621522396803, "episode_reward_min": -313.3406648337841, "episode_reward_mean": -66.63831529699266, "episode_len_mean": 254.74, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.220087982714176, -76.04860261082649, -91.12457856535912, -108.01173520088196, -16.68041654676199, -72.08655264228582, -2.8871025294065475, -71.66393055021763, -84.69626495242119, -50.47816949337721, -97.2130409553647, -77.46142785996199, -57.25846600532532, -90.3733686581254, -41.949512884020805, -132.25601457804441, -121.69999987632036, -145.68160928040743, -143.80258970707655, -78.91682326048613, -18.850415222346783, -135.81541439890862, -63.871586829423904, -126.84087684750557, -2.8495538383722305, -86.13580740243196, -50.68304492533207, -65.15300030261278, -33.82745884358883, -49.413943387568, -78.56159281730652, -43.77524192631245, -94.68077716976404, -125.86700087785721, -98.16302816569805, -88.25041534751654, 16.36477518826723, -35.51800260692835, 18.2910313680768, -89.36760874092579, -11.196264915168285, -85.8893646299839, -155.9990974739194, -54.18304466456175, -56.340947173535824, -167.0973433330655, -84.79909731447697, -97.30431328713894, -26.416741870343685, -23.424975104629993, -48.13719543069601, -36.5761444196105, -65.46105083823204, -53.06153631210327, -86.18887940049171, -53.7495127171278, -74.50888150185347, -79.43521421402693, -68.68238920718431, -73.99843715876341, -53.551901303231716, -82.17872920632362, -46.6217056363821, 4.943898588418961, -43.282529048621655, -88.41195169091225, -23.439386062324047, 14.454669527709484, -62.24915488809347, -54.33361441642046, -67.23521407693624, -137.79999981075525, -35.606187880039215, -48.096264973282814, -43.71172207593918, 25.67621522396803, -80.79421980679035, -47.61093842983246, -3.3265271112322807, -87.90950589627028, -12.393534012138844, -119.25707807391882, -124.40320423990488, -37.58846212923527, -77.16031432896852, -10.829821266233921, -115.73431136459112, -30.676144629716873, -13.199999958276749, -116.63058944791555, -62.59173683077097, 11.574662245810032, -313.3406648337841, -75.0563830807805, -39.48160910606384, -146.72523325681686, -46.55966315418482, -17.914238840341568, -67.68769542872906, -50.16105078905821], "episode_lengths": [236, 262, 275, 276, 234, 263, 225, 263, 249, 253, 276, 246, 240, 261, 244, 297, 266, 288, 298, 263, 224, 289, 260, 274, 215, 268, 251, 263, 229, 247, 260, 248, 262, 289, 266, 265, 224, 236, 215, 257, 223, 258, 297, 257, 254, 307, 260, 270, 242, 224, 257, 243, 259, 241, 256, 246, 261, 254, 266, 261, 239, 256, 247, 232, 242, 279, 233, 216, 259, 237, 235, 287, 234, 247, 246, 211, 262, 240, 230, 268, 227, 276, 277, 233, 260, 241, 283, 240, 221, 276, 262, 223, 372, 267, 236, 298, 242, 234, 261, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.600884974006317, "mean_inference_ms": 7.531644031382858, "mean_action_processing_ms": 0.1264611840463098, "mean_env_wait_ms": 4.9828569765357384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 24599.627, "learn_time_ms": 20841.84, "learn_throughput": 191.922, "update_time_ms": 27.331}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 132, "training_iteration": 9, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-27-15", "timestamp": 1655555235, "time_this_iter_s": 24.40401291847229, "time_total_s": 221.48761558532715, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 221.48761558532715, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 29.23529411764706, "ram_util_percent": 64.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 6.079436302185059, "policy_loss": -0.08557015657424927, "vf_loss": 6.139101028442383, "vf_explained_var": -0.0018005650490522385, "kl": 0.017270104959607124, "entropy": 1.919628620147705, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 25.67621522396803, "episode_reward_min": -313.3406648337841, "episode_reward_mean": -67.81801381267607, "episode_len_mean": 255.01, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.949512884020805, -132.25601457804441, -121.69999987632036, -145.68160928040743, -143.80258970707655, -78.91682326048613, -18.850415222346783, -135.81541439890862, -63.871586829423904, -126.84087684750557, -2.8495538383722305, -86.13580740243196, -50.68304492533207, -65.15300030261278, -33.82745884358883, -49.413943387568, -78.56159281730652, -43.77524192631245, -94.68077716976404, -125.86700087785721, -98.16302816569805, -88.25041534751654, 16.36477518826723, -35.51800260692835, 18.2910313680768, -89.36760874092579, -11.196264915168285, -85.8893646299839, -155.9990974739194, -54.18304466456175, -56.340947173535824, -167.0973433330655, -84.79909731447697, -97.30431328713894, -26.416741870343685, -23.424975104629993, -48.13719543069601, -36.5761444196105, -65.46105083823204, -53.06153631210327, -86.18887940049171, -53.7495127171278, -74.50888150185347, -79.43521421402693, -68.68238920718431, -73.99843715876341, -53.551901303231716, -82.17872920632362, -46.6217056363821, 4.943898588418961, -43.282529048621655, -88.41195169091225, -23.439386062324047, 14.454669527709484, -62.24915488809347, -54.33361441642046, -67.23521407693624, -137.79999981075525, -35.606187880039215, -48.096264973282814, -43.71172207593918, 25.67621522396803, -80.79421980679035, -47.61093842983246, -3.3265271112322807, -87.90950589627028, -12.393534012138844, -119.25707807391882, -124.40320423990488, -37.58846212923527, -77.16031432896852, -10.829821266233921, -115.73431136459112, -30.676144629716873, -13.199999958276749, -116.63058944791555, -62.59173683077097, 11.574662245810032, -313.3406648337841, -75.0563830807805, -39.48160910606384, -146.72523325681686, -46.55966315418482, -17.914238840341568, -67.68769542872906, -50.16105078905821, -30.962336868047714, -156.5747563391924, -22.02861036360264, -74.00718190521002, -49.11025156080723, -165.80000004172325, -76.04981672018766, -38.83307036757469, -21.97524218261242, -95.04120447486639, -41.37782669067383, -10.315920703113079, -217.88539186120033, -35.21198604255915], "episode_lengths": [244, 297, 266, 288, 298, 263, 224, 289, 260, 274, 215, 268, 251, 263, 229, 247, 260, 248, 262, 289, 266, 265, 224, 236, 215, 257, 223, 258, 297, 257, 254, 307, 260, 270, 242, 224, 257, 243, 259, 241, 256, 246, 261, 254, 266, 261, 239, 256, 247, 232, 242, 279, 233, 216, 259, 237, 235, 287, 234, 247, 246, 211, 262, 240, 230, 268, 227, 276, 277, 233, 260, 241, 283, 240, 221, 276, 262, 223, 372, 267, 236, 298, 242, 234, 261, 252, 235, 297, 236, 265, 232, 293, 258, 246, 236, 270, 246, 225, 313, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6007597141306519, "mean_inference_ms": 7.524965591221936, "mean_action_processing_ms": 0.1261204779256699, "mean_env_wait_ms": 4.953510617870761, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 25.67621522396803, "episode_reward_min": -313.3406648337841, "episode_reward_mean": -67.81801381267607, "episode_len_mean": 255.01, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.949512884020805, -132.25601457804441, -121.69999987632036, -145.68160928040743, -143.80258970707655, -78.91682326048613, -18.850415222346783, -135.81541439890862, -63.871586829423904, -126.84087684750557, -2.8495538383722305, -86.13580740243196, -50.68304492533207, -65.15300030261278, -33.82745884358883, -49.413943387568, -78.56159281730652, -43.77524192631245, -94.68077716976404, -125.86700087785721, -98.16302816569805, -88.25041534751654, 16.36477518826723, -35.51800260692835, 18.2910313680768, -89.36760874092579, -11.196264915168285, -85.8893646299839, -155.9990974739194, -54.18304466456175, -56.340947173535824, -167.0973433330655, -84.79909731447697, -97.30431328713894, -26.416741870343685, -23.424975104629993, -48.13719543069601, -36.5761444196105, -65.46105083823204, -53.06153631210327, -86.18887940049171, -53.7495127171278, -74.50888150185347, -79.43521421402693, -68.68238920718431, -73.99843715876341, -53.551901303231716, -82.17872920632362, -46.6217056363821, 4.943898588418961, -43.282529048621655, -88.41195169091225, -23.439386062324047, 14.454669527709484, -62.24915488809347, -54.33361441642046, -67.23521407693624, -137.79999981075525, -35.606187880039215, -48.096264973282814, -43.71172207593918, 25.67621522396803, -80.79421980679035, -47.61093842983246, -3.3265271112322807, -87.90950589627028, -12.393534012138844, -119.25707807391882, -124.40320423990488, -37.58846212923527, -77.16031432896852, -10.829821266233921, -115.73431136459112, -30.676144629716873, -13.199999958276749, -116.63058944791555, -62.59173683077097, 11.574662245810032, -313.3406648337841, -75.0563830807805, -39.48160910606384, -146.72523325681686, -46.55966315418482, -17.914238840341568, -67.68769542872906, -50.16105078905821, -30.962336868047714, -156.5747563391924, -22.02861036360264, -74.00718190521002, -49.11025156080723, -165.80000004172325, -76.04981672018766, -38.83307036757469, -21.97524218261242, -95.04120447486639, -41.37782669067383, -10.315920703113079, -217.88539186120033, -35.21198604255915], "episode_lengths": [244, 297, 266, 288, 298, 263, 224, 289, 260, 274, 215, 268, 251, 263, 229, 247, 260, 248, 262, 289, 266, 265, 224, 236, 215, 257, 223, 258, 297, 257, 254, 307, 260, 270, 242, 224, 257, 243, 259, 241, 256, 246, 261, 254, 266, 261, 239, 256, 247, 232, 242, 279, 233, 216, 259, 237, 235, 287, 234, 247, 246, 211, 262, 240, 230, 268, 227, 276, 277, 233, 260, 241, 283, 240, 221, 276, 262, 223, 372, 267, 236, 298, 242, 234, 261, 252, 235, 297, 236, 265, 232, 293, 258, 246, 236, 270, 246, 225, 313, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6007597141306519, "mean_inference_ms": 7.524965591221936, "mean_action_processing_ms": 0.1261204779256699, "mean_env_wait_ms": 4.953510617870761, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 24586.018, "learn_time_ms": 20848.76, "learn_throughput": 191.858, "update_time_ms": 27.296}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 146, "training_iteration": 10, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-27-39", "timestamp": 1655555259, "time_this_iter_s": 24.473532676696777, "time_total_s": 245.96114826202393, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 245.96114826202393, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 28.588235294117652, "ram_util_percent": 64.18823529411763}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 5.510167121887207, "policy_loss": -0.10502874106168747, "vf_loss": 5.586118698120117, "vf_explained_var": 0.244267538189888, "kl": 0.01938452012836933, "entropy": 1.9032540321350098, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 25.67621522396803, "episode_reward_min": -313.3406648337841, "episode_reward_mean": -60.5587026001513, "episode_len_mean": 251.19, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.16302816569805, -88.25041534751654, 16.36477518826723, -35.51800260692835, 18.2910313680768, -89.36760874092579, -11.196264915168285, -85.8893646299839, -155.9990974739194, -54.18304466456175, -56.340947173535824, -167.0973433330655, -84.79909731447697, -97.30431328713894, -26.416741870343685, -23.424975104629993, -48.13719543069601, -36.5761444196105, -65.46105083823204, -53.06153631210327, -86.18887940049171, -53.7495127171278, -74.50888150185347, -79.43521421402693, -68.68238920718431, -73.99843715876341, -53.551901303231716, -82.17872920632362, -46.6217056363821, 4.943898588418961, -43.282529048621655, -88.41195169091225, -23.439386062324047, 14.454669527709484, -62.24915488809347, -54.33361441642046, -67.23521407693624, -137.79999981075525, -35.606187880039215, -48.096264973282814, -43.71172207593918, 25.67621522396803, -80.79421980679035, -47.61093842983246, -3.3265271112322807, -87.90950589627028, -12.393534012138844, -119.25707807391882, -124.40320423990488, -37.58846212923527, -77.16031432896852, -10.829821266233921, -115.73431136459112, -30.676144629716873, -13.199999958276749, -116.63058944791555, -62.59173683077097, 11.574662245810032, -313.3406648337841, -75.0563830807805, -39.48160910606384, -146.72523325681686, -46.55966315418482, -17.914238840341568, -67.68769542872906, -50.16105078905821, -30.962336868047714, -156.5747563391924, -22.02861036360264, -74.00718190521002, -49.11025156080723, -165.80000004172325, -76.04981672018766, -38.83307036757469, -21.97524218261242, -95.04120447486639, -41.37782669067383, -10.315920703113079, -217.88539186120033, -35.21198604255915, -62.53521404415369, -223.56014812737703, -16.75917784869671, -13.925569340586662, -100.96728973090649, 0.559569388628006, 16.1568396165967, -26.133403040468693, -44.37524202466011, -16.97042828798294, -43.999999828636646, -34.19999989122152, -91.16031442582607, -25.749512761831284, 13.37145870923996, 17.448865249753, -68.38936460018158, -68.36033841222525, -47.08018755167723, -78.07168617099524], "episode_lengths": [266, 265, 224, 236, 215, 257, 223, 258, 297, 257, 254, 307, 260, 270, 242, 224, 257, 243, 259, 241, 256, 246, 261, 254, 266, 261, 239, 256, 247, 232, 242, 279, 233, 216, 259, 237, 235, 287, 234, 247, 246, 211, 262, 240, 230, 268, 227, 276, 277, 233, 260, 241, 283, 240, 221, 276, 262, 223, 372, 267, 236, 298, 242, 234, 261, 252, 235, 297, 236, 265, 232, 293, 258, 246, 236, 270, 246, 225, 313, 234, 255, 318, 224, 226, 274, 216, 216, 246, 243, 229, 231, 230, 261, 243, 219, 226, 249, 252, 246, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6035380543299622, "mean_inference_ms": 7.517777168779223, "mean_action_processing_ms": 0.1255800819328569, "mean_env_wait_ms": 4.934199167150364, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 25.67621522396803, "episode_reward_min": -313.3406648337841, "episode_reward_mean": -60.5587026001513, "episode_len_mean": 251.19, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-98.16302816569805, -88.25041534751654, 16.36477518826723, -35.51800260692835, 18.2910313680768, -89.36760874092579, -11.196264915168285, -85.8893646299839, -155.9990974739194, -54.18304466456175, -56.340947173535824, -167.0973433330655, -84.79909731447697, -97.30431328713894, -26.416741870343685, -23.424975104629993, -48.13719543069601, -36.5761444196105, -65.46105083823204, -53.06153631210327, -86.18887940049171, -53.7495127171278, -74.50888150185347, -79.43521421402693, -68.68238920718431, -73.99843715876341, -53.551901303231716, -82.17872920632362, -46.6217056363821, 4.943898588418961, -43.282529048621655, -88.41195169091225, -23.439386062324047, 14.454669527709484, -62.24915488809347, -54.33361441642046, -67.23521407693624, -137.79999981075525, -35.606187880039215, -48.096264973282814, -43.71172207593918, 25.67621522396803, -80.79421980679035, -47.61093842983246, -3.3265271112322807, -87.90950589627028, -12.393534012138844, -119.25707807391882, -124.40320423990488, -37.58846212923527, -77.16031432896852, -10.829821266233921, -115.73431136459112, -30.676144629716873, -13.199999958276749, -116.63058944791555, -62.59173683077097, 11.574662245810032, -313.3406648337841, -75.0563830807805, -39.48160910606384, -146.72523325681686, -46.55966315418482, -17.914238840341568, -67.68769542872906, -50.16105078905821, -30.962336868047714, -156.5747563391924, -22.02861036360264, -74.00718190521002, -49.11025156080723, -165.80000004172325, -76.04981672018766, -38.83307036757469, -21.97524218261242, -95.04120447486639, -41.37782669067383, -10.315920703113079, -217.88539186120033, -35.21198604255915, -62.53521404415369, -223.56014812737703, -16.75917784869671, -13.925569340586662, -100.96728973090649, 0.559569388628006, 16.1568396165967, -26.133403040468693, -44.37524202466011, -16.97042828798294, -43.999999828636646, -34.19999989122152, -91.16031442582607, -25.749512761831284, 13.37145870923996, 17.448865249753, -68.38936460018158, -68.36033841222525, -47.08018755167723, -78.07168617099524], "episode_lengths": [266, 265, 224, 236, 215, 257, 223, 258, 297, 257, 254, 307, 260, 270, 242, 224, 257, 243, 259, 241, 256, 246, 261, 254, 266, 261, 239, 256, 247, 232, 242, 279, 233, 216, 259, 237, 235, 287, 234, 247, 246, 211, 262, 240, 230, 268, 227, 276, 277, 233, 260, 241, 283, 240, 221, 276, 262, 223, 372, 267, 236, 298, 242, 234, 261, 252, 235, 297, 236, 265, 232, 293, 258, 246, 236, 270, 246, 225, 313, 234, 255, 318, 224, 226, 274, 216, 216, 246, 243, 229, 231, 230, 261, 243, 219, 226, 249, 252, 246, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6035380543299622, "mean_inference_ms": 7.517777168779223, "mean_action_processing_ms": 0.1255800819328569, "mean_env_wait_ms": 4.934199167150364, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 24436.309, "learn_time_ms": 20827.894, "learn_throughput": 192.05, "update_time_ms": 26.994}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 166, "training_iteration": 11, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-28-04", "timestamp": 1655555284, "time_this_iter_s": 24.43434190750122, "time_total_s": 270.39549016952515, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 270.39549016952515, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 28.825714285714284, "ram_util_percent": 64.35714285714288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 6.2019171714782715, "policy_loss": -0.11046335101127625, "vf_loss": 6.281238555908203, "vf_explained_var": 0.18349416553974152, "kl": 0.020761631429195404, "entropy": 1.8645949363708496, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 25.67621522396803, "episode_reward_min": -313.3406648337841, "episode_reward_mean": -64.47264946371317, "episode_len_mean": 252.6, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.416741870343685, -23.424975104629993, -48.13719543069601, -36.5761444196105, -65.46105083823204, -53.06153631210327, -86.18887940049171, -53.7495127171278, -74.50888150185347, -79.43521421402693, -68.68238920718431, -73.99843715876341, -53.551901303231716, -82.17872920632362, -46.6217056363821, 4.943898588418961, -43.282529048621655, -88.41195169091225, -23.439386062324047, 14.454669527709484, -62.24915488809347, -54.33361441642046, -67.23521407693624, -137.79999981075525, -35.606187880039215, -48.096264973282814, -43.71172207593918, 25.67621522396803, -80.79421980679035, -47.61093842983246, -3.3265271112322807, -87.90950589627028, -12.393534012138844, -119.25707807391882, -124.40320423990488, -37.58846212923527, -77.16031432896852, -10.829821266233921, -115.73431136459112, -30.676144629716873, -13.199999958276749, -116.63058944791555, -62.59173683077097, 11.574662245810032, -313.3406648337841, -75.0563830807805, -39.48160910606384, -146.72523325681686, -46.55966315418482, -17.914238840341568, -67.68769542872906, -50.16105078905821, -30.962336868047714, -156.5747563391924, -22.02861036360264, -74.00718190521002, -49.11025156080723, -165.80000004172325, -76.04981672018766, -38.83307036757469, -21.97524218261242, -95.04120447486639, -41.37782669067383, -10.315920703113079, -217.88539186120033, -35.21198604255915, -62.53521404415369, -223.56014812737703, -16.75917784869671, -13.925569340586662, -100.96728973090649, 0.559569388628006, 16.1568396165967, -26.133403040468693, -44.37524202466011, -16.97042828798294, -43.999999828636646, -34.19999989122152, -91.16031442582607, -25.749512761831284, 13.37145870923996, 17.448865249753, -68.38936460018158, -68.36033841222525, -47.08018755167723, -78.07168617099524, -244.26800804585218, -16.837195433676243, -80.11002520471811, -37.49224457889795, -104.17236145585775, -155.2765168249607, -267.21373891830444, -144.65707799047232, -29.82363400608301, -66.84652807563543, -74.56412138789892, -6.258116111159325, -46.23847473412752, -107.0893646851182], "episode_lengths": [242, 224, 257, 243, 259, 241, 256, 246, 261, 254, 266, 261, 239, 256, 247, 232, 242, 279, 233, 216, 259, 237, 235, 287, 234, 247, 246, 211, 262, 240, 230, 268, 227, 276, 277, 233, 260, 241, 283, 240, 221, 276, 262, 223, 372, 267, 236, 298, 242, 234, 261, 252, 235, 297, 236, 265, 232, 293, 258, 246, 236, 270, 246, 225, 313, 234, 255, 318, 224, 226, 274, 216, 216, 246, 243, 229, 231, 230, 261, 243, 219, 226, 249, 252, 246, 249, 333, 228, 259, 240, 269, 282, 349, 295, 235, 252, 252, 218, 252, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6028733464108617, "mean_inference_ms": 7.505660084731303, "mean_action_processing_ms": 0.12534631403139124, "mean_env_wait_ms": 4.917312772142361, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 25.67621522396803, "episode_reward_min": -313.3406648337841, "episode_reward_mean": -64.47264946371317, "episode_len_mean": 252.6, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.416741870343685, -23.424975104629993, -48.13719543069601, -36.5761444196105, -65.46105083823204, -53.06153631210327, -86.18887940049171, -53.7495127171278, -74.50888150185347, -79.43521421402693, -68.68238920718431, -73.99843715876341, -53.551901303231716, -82.17872920632362, -46.6217056363821, 4.943898588418961, -43.282529048621655, -88.41195169091225, -23.439386062324047, 14.454669527709484, -62.24915488809347, -54.33361441642046, -67.23521407693624, -137.79999981075525, -35.606187880039215, -48.096264973282814, -43.71172207593918, 25.67621522396803, -80.79421980679035, -47.61093842983246, -3.3265271112322807, -87.90950589627028, -12.393534012138844, -119.25707807391882, -124.40320423990488, -37.58846212923527, -77.16031432896852, -10.829821266233921, -115.73431136459112, -30.676144629716873, -13.199999958276749, -116.63058944791555, -62.59173683077097, 11.574662245810032, -313.3406648337841, -75.0563830807805, -39.48160910606384, -146.72523325681686, -46.55966315418482, -17.914238840341568, -67.68769542872906, -50.16105078905821, -30.962336868047714, -156.5747563391924, -22.02861036360264, -74.00718190521002, -49.11025156080723, -165.80000004172325, -76.04981672018766, -38.83307036757469, -21.97524218261242, -95.04120447486639, -41.37782669067383, -10.315920703113079, -217.88539186120033, -35.21198604255915, -62.53521404415369, -223.56014812737703, -16.75917784869671, -13.925569340586662, -100.96728973090649, 0.559569388628006, 16.1568396165967, -26.133403040468693, -44.37524202466011, -16.97042828798294, -43.999999828636646, -34.19999989122152, -91.16031442582607, -25.749512761831284, 13.37145870923996, 17.448865249753, -68.38936460018158, -68.36033841222525, -47.08018755167723, -78.07168617099524, -244.26800804585218, -16.837195433676243, -80.11002520471811, -37.49224457889795, -104.17236145585775, -155.2765168249607, -267.21373891830444, -144.65707799047232, -29.82363400608301, -66.84652807563543, -74.56412138789892, -6.258116111159325, -46.23847473412752, -107.0893646851182], "episode_lengths": [242, 224, 257, 243, 259, 241, 256, 246, 261, 254, 266, 261, 239, 256, 247, 232, 242, 279, 233, 216, 259, 237, 235, 287, 234, 247, 246, 211, 262, 240, 230, 268, 227, 276, 277, 233, 260, 241, 283, 240, 221, 276, 262, 223, 372, 267, 236, 298, 242, 234, 261, 252, 235, 297, 236, 265, 232, 293, 258, 246, 236, 270, 246, 225, 313, 234, 255, 318, 224, 226, 274, 216, 216, 246, 243, 229, 231, 230, 261, 243, 219, 226, 249, 252, 246, 249, 333, 228, 259, 240, 269, 282, 349, 295, 235, 252, 252, 218, 252, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6028733464108617, "mean_inference_ms": 7.505660084731303, "mean_action_processing_ms": 0.12534631403139124, "mean_env_wait_ms": 4.917312772142361, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 24395.207, "learn_time_ms": 20815.394, "learn_throughput": 192.165, "update_time_ms": 27.279}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 180, "training_iteration": 12, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-28-28", "timestamp": 1655555308, "time_this_iter_s": 24.190794944763184, "time_total_s": 294.58628511428833, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 294.58628511428833, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 26.944117647058828, "ram_util_percent": 64.37352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 7.5542473793029785, "policy_loss": -0.12087257206439972, "vf_loss": 7.6363654136657715, "vf_explained_var": 0.16665084660053253, "kl": 0.017224494367837906, "entropy": 1.8654208183288574, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 25.67621522396803, "episode_reward_min": -313.3406648337841, "episode_reward_mean": -68.06845045760274, "episode_len_mean": 254.7, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.943898588418961, -43.282529048621655, -88.41195169091225, -23.439386062324047, 14.454669527709484, -62.24915488809347, -54.33361441642046, -67.23521407693624, -137.79999981075525, -35.606187880039215, -48.096264973282814, -43.71172207593918, 25.67621522396803, -80.79421980679035, -47.61093842983246, -3.3265271112322807, -87.90950589627028, -12.393534012138844, -119.25707807391882, -124.40320423990488, -37.58846212923527, -77.16031432896852, -10.829821266233921, -115.73431136459112, -30.676144629716873, -13.199999958276749, -116.63058944791555, -62.59173683077097, 11.574662245810032, -313.3406648337841, -75.0563830807805, -39.48160910606384, -146.72523325681686, -46.55966315418482, -17.914238840341568, -67.68769542872906, -50.16105078905821, -30.962336868047714, -156.5747563391924, -22.02861036360264, -74.00718190521002, -49.11025156080723, -165.80000004172325, -76.04981672018766, -38.83307036757469, -21.97524218261242, -95.04120447486639, -41.37782669067383, -10.315920703113079, -217.88539186120033, -35.21198604255915, -62.53521404415369, -223.56014812737703, -16.75917784869671, -13.925569340586662, -100.96728973090649, 0.559569388628006, 16.1568396165967, -26.133403040468693, -44.37524202466011, -16.97042828798294, -43.999999828636646, -34.19999989122152, -91.16031442582607, -25.749512761831284, 13.37145870923996, 17.448865249753, -68.38936460018158, -68.36033841222525, -47.08018755167723, -78.07168617099524, -244.26800804585218, -16.837195433676243, -80.11002520471811, -37.49224457889795, -104.17236145585775, -155.2765168249607, -267.21373891830444, -144.65707799047232, -29.82363400608301, -66.84652807563543, -74.56412138789892, -6.258116111159325, -46.23847473412752, -107.0893646851182, -81.29646454751492, -24.827458672225475, -23.111686162650585, -223.05924566835165, -40.49144531041384, -209.57078332453966, -109.65747562795877, -132.85636548697948, -54.457208298146725, -26.999716326594353, -24.28588069230318, -171.87763635069132, -26.760338358581066, -46.989364586770535, -35.33232429623604], "episode_lengths": [232, 242, 279, 233, 216, 259, 237, 235, 287, 234, 247, 246, 211, 262, 240, 230, 268, 227, 276, 277, 233, 260, 241, 283, 240, 221, 276, 262, 223, 372, 267, 236, 298, 242, 234, 261, 252, 235, 297, 236, 265, 232, 293, 258, 246, 236, 270, 246, 225, 313, 234, 255, 318, 224, 226, 274, 216, 216, 246, 243, 229, 231, 230, 261, 243, 219, 226, 249, 252, 246, 249, 333, 228, 259, 240, 269, 282, 349, 295, 235, 252, 252, 218, 252, 266, 261, 234, 248, 331, 261, 298, 290, 286, 247, 241, 247, 291, 231, 249, 247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6018675754993967, "mean_inference_ms": 7.492499353719242, "mean_action_processing_ms": 0.125244072758794, "mean_env_wait_ms": 4.894664172847894, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 25.67621522396803, "episode_reward_min": -313.3406648337841, "episode_reward_mean": -68.06845045760274, "episode_len_mean": 254.7, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.943898588418961, -43.282529048621655, -88.41195169091225, -23.439386062324047, 14.454669527709484, -62.24915488809347, -54.33361441642046, -67.23521407693624, -137.79999981075525, -35.606187880039215, -48.096264973282814, -43.71172207593918, 25.67621522396803, -80.79421980679035, -47.61093842983246, -3.3265271112322807, -87.90950589627028, -12.393534012138844, -119.25707807391882, -124.40320423990488, -37.58846212923527, -77.16031432896852, -10.829821266233921, -115.73431136459112, -30.676144629716873, -13.199999958276749, -116.63058944791555, -62.59173683077097, 11.574662245810032, -313.3406648337841, -75.0563830807805, -39.48160910606384, -146.72523325681686, -46.55966315418482, -17.914238840341568, -67.68769542872906, -50.16105078905821, -30.962336868047714, -156.5747563391924, -22.02861036360264, -74.00718190521002, -49.11025156080723, -165.80000004172325, -76.04981672018766, -38.83307036757469, -21.97524218261242, -95.04120447486639, -41.37782669067383, -10.315920703113079, -217.88539186120033, -35.21198604255915, -62.53521404415369, -223.56014812737703, -16.75917784869671, -13.925569340586662, -100.96728973090649, 0.559569388628006, 16.1568396165967, -26.133403040468693, -44.37524202466011, -16.97042828798294, -43.999999828636646, -34.19999989122152, -91.16031442582607, -25.749512761831284, 13.37145870923996, 17.448865249753, -68.38936460018158, -68.36033841222525, -47.08018755167723, -78.07168617099524, -244.26800804585218, -16.837195433676243, -80.11002520471811, -37.49224457889795, -104.17236145585775, -155.2765168249607, -267.21373891830444, -144.65707799047232, -29.82363400608301, -66.84652807563543, -74.56412138789892, -6.258116111159325, -46.23847473412752, -107.0893646851182, -81.29646454751492, -24.827458672225475, -23.111686162650585, -223.05924566835165, -40.49144531041384, -209.57078332453966, -109.65747562795877, -132.85636548697948, -54.457208298146725, -26.999716326594353, -24.28588069230318, -171.87763635069132, -26.760338358581066, -46.989364586770535, -35.33232429623604], "episode_lengths": [232, 242, 279, 233, 216, 259, 237, 235, 287, 234, 247, 246, 211, 262, 240, 230, 268, 227, 276, 277, 233, 260, 241, 283, 240, 221, 276, 262, 223, 372, 267, 236, 298, 242, 234, 261, 252, 235, 297, 236, 265, 232, 293, 258, 246, 236, 270, 246, 225, 313, 234, 255, 318, 224, 226, 274, 216, 216, 246, 243, 229, 231, 230, 261, 243, 219, 226, 249, 252, 246, 249, 333, 228, 259, 240, 269, 282, 349, 295, 235, 252, 252, 218, 252, 266, 261, 234, 248, 331, 261, 298, 290, 286, 247, 241, 247, 291, 231, 249, 247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6018675754993967, "mean_inference_ms": 7.492499353719242, "mean_action_processing_ms": 0.125244072758794, "mean_env_wait_ms": 4.894664172847894, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 24394.592, "learn_time_ms": 20833.971, "learn_throughput": 191.994, "update_time_ms": 27.278}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 195, "training_iteration": 13, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-28-52", "timestamp": 1655555332, "time_this_iter_s": 24.315338373184204, "time_total_s": 318.90162348747253, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 318.90162348747253, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 29.397058823529417, "ram_util_percent": 64.40882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.804205417633057, "policy_loss": -0.10856872797012329, "vf_loss": 6.877524375915527, "vf_explained_var": 0.2540455758571625, "kl": 0.015666741877794266, "entropy": 1.847625494003296, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 17.448865249753, "episode_reward_min": -313.3406648337841, "episode_reward_mean": -76.33009456910193, "episode_len_mean": 258.59, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-87.90950589627028, -12.393534012138844, -119.25707807391882, -124.40320423990488, -37.58846212923527, -77.16031432896852, -10.829821266233921, -115.73431136459112, -30.676144629716873, -13.199999958276749, -116.63058944791555, -62.59173683077097, 11.574662245810032, -313.3406648337841, -75.0563830807805, -39.48160910606384, -146.72523325681686, -46.55966315418482, -17.914238840341568, -67.68769542872906, -50.16105078905821, -30.962336868047714, -156.5747563391924, -22.02861036360264, -74.00718190521002, -49.11025156080723, -165.80000004172325, -76.04981672018766, -38.83307036757469, -21.97524218261242, -95.04120447486639, -41.37782669067383, -10.315920703113079, -217.88539186120033, -35.21198604255915, -62.53521404415369, -223.56014812737703, -16.75917784869671, -13.925569340586662, -100.96728973090649, 0.559569388628006, 16.1568396165967, -26.133403040468693, -44.37524202466011, -16.97042828798294, -43.999999828636646, -34.19999989122152, -91.16031442582607, -25.749512761831284, 13.37145870923996, 17.448865249753, -68.38936460018158, -68.36033841222525, -47.08018755167723, -78.07168617099524, -244.26800804585218, -16.837195433676243, -80.11002520471811, -37.49224457889795, -104.17236145585775, -155.2765168249607, -267.21373891830444, -144.65707799047232, -29.82363400608301, -66.84652807563543, -74.56412138789892, -6.258116111159325, -46.23847473412752, -107.0893646851182, -81.29646454751492, -24.827458672225475, -23.111686162650585, -223.05924566835165, -40.49144531041384, -209.57078332453966, -109.65747562795877, -132.85636548697948, -54.457208298146725, -26.999716326594353, -24.28588069230318, -171.87763635069132, -26.760338358581066, -46.989364586770535, -35.33232429623604, -54.310589745640755, -159.50738912820816, -156.47217158973217, -95.87063977122307, -101.98936452716589, -52.08085595816374, -165.78539169579744, -144.59999984502792, -85.6893645375967, -44.0255990549922, -33.580754689872265, -176.77150697261095, -50.28936453908682, -95.59999993443489, -86.17168606072664, -14.242660030722618], "episode_lengths": [268, 227, 276, 277, 233, 260, 241, 283, 240, 221, 276, 262, 223, 372, 267, 236, 298, 242, 234, 261, 252, 235, 297, 236, 265, 232, 293, 258, 246, 236, 270, 246, 225, 313, 234, 255, 318, 224, 226, 274, 216, 216, 246, 243, 229, 231, 230, 261, 243, 219, 226, 249, 252, 246, 249, 333, 228, 259, 240, 269, 282, 349, 295, 235, 252, 252, 218, 252, 266, 261, 234, 248, 331, 261, 298, 290, 286, 247, 241, 247, 291, 231, 249, 247, 249, 309, 300, 281, 248, 253, 297, 287, 263, 250, 249, 311, 241, 256, 260, 225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.60024520609254, "mean_inference_ms": 7.480113113832959, "mean_action_processing_ms": 0.12538897187444412, "mean_env_wait_ms": 4.873627581700566, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 17.448865249753, "episode_reward_min": -313.3406648337841, "episode_reward_mean": -76.33009456910193, "episode_len_mean": 258.59, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-87.90950589627028, -12.393534012138844, -119.25707807391882, -124.40320423990488, -37.58846212923527, -77.16031432896852, -10.829821266233921, -115.73431136459112, -30.676144629716873, -13.199999958276749, -116.63058944791555, -62.59173683077097, 11.574662245810032, -313.3406648337841, -75.0563830807805, -39.48160910606384, -146.72523325681686, -46.55966315418482, -17.914238840341568, -67.68769542872906, -50.16105078905821, -30.962336868047714, -156.5747563391924, -22.02861036360264, -74.00718190521002, -49.11025156080723, -165.80000004172325, -76.04981672018766, -38.83307036757469, -21.97524218261242, -95.04120447486639, -41.37782669067383, -10.315920703113079, -217.88539186120033, -35.21198604255915, -62.53521404415369, -223.56014812737703, -16.75917784869671, -13.925569340586662, -100.96728973090649, 0.559569388628006, 16.1568396165967, -26.133403040468693, -44.37524202466011, -16.97042828798294, -43.999999828636646, -34.19999989122152, -91.16031442582607, -25.749512761831284, 13.37145870923996, 17.448865249753, -68.38936460018158, -68.36033841222525, -47.08018755167723, -78.07168617099524, -244.26800804585218, -16.837195433676243, -80.11002520471811, -37.49224457889795, -104.17236145585775, -155.2765168249607, -267.21373891830444, -144.65707799047232, -29.82363400608301, -66.84652807563543, -74.56412138789892, -6.258116111159325, -46.23847473412752, -107.0893646851182, -81.29646454751492, -24.827458672225475, -23.111686162650585, -223.05924566835165, -40.49144531041384, -209.57078332453966, -109.65747562795877, -132.85636548697948, -54.457208298146725, -26.999716326594353, -24.28588069230318, -171.87763635069132, -26.760338358581066, -46.989364586770535, -35.33232429623604, -54.310589745640755, -159.50738912820816, -156.47217158973217, -95.87063977122307, -101.98936452716589, -52.08085595816374, -165.78539169579744, -144.59999984502792, -85.6893645375967, -44.0255990549922, -33.580754689872265, -176.77150697261095, -50.28936453908682, -95.59999993443489, -86.17168606072664, -14.242660030722618], "episode_lengths": [268, 227, 276, 277, 233, 260, 241, 283, 240, 221, 276, 262, 223, 372, 267, 236, 298, 242, 234, 261, 252, 235, 297, 236, 265, 232, 293, 258, 246, 236, 270, 246, 225, 313, 234, 255, 318, 224, 226, 274, 216, 216, 246, 243, 229, 231, 230, 261, 243, 219, 226, 249, 252, 246, 249, 333, 228, 259, 240, 269, 282, 349, 295, 235, 252, 252, 218, 252, 266, 261, 234, 248, 331, 261, 298, 290, 286, 247, 241, 247, 291, 231, 249, 247, 249, 309, 300, 281, 248, 253, 297, 287, 263, 250, 249, 311, 241, 256, 260, 225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.60024520609254, "mean_inference_ms": 7.480113113832959, "mean_action_processing_ms": 0.12538897187444412, "mean_env_wait_ms": 4.873627581700566, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 24398.529, "learn_time_ms": 20842.381, "learn_throughput": 191.917, "update_time_ms": 27.18}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 211, "training_iteration": 14, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-29-17", "timestamp": 1655555357, "time_this_iter_s": 24.310555696487427, "time_total_s": 343.21217918395996, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 343.21217918395996, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 27.832352941176474, "ram_util_percent": 64.48529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.299342155456543, "policy_loss": -0.11956974118947983, "vf_loss": 6.381245136260986, "vf_explained_var": 0.2596537470817566, "kl": 0.016740551218390465, "entropy": 1.850246787071228, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 17.448865249753, "episode_reward_min": -295.7202964052558, "episode_reward_mean": -80.94577459342777, "episode_len_mean": 259.92, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.48160910606384, -146.72523325681686, -46.55966315418482, -17.914238840341568, -67.68769542872906, -50.16105078905821, -30.962336868047714, -156.5747563391924, -22.02861036360264, -74.00718190521002, -49.11025156080723, -165.80000004172325, -76.04981672018766, -38.83307036757469, -21.97524218261242, -95.04120447486639, -41.37782669067383, -10.315920703113079, -217.88539186120033, -35.21198604255915, -62.53521404415369, -223.56014812737703, -16.75917784869671, -13.925569340586662, -100.96728973090649, 0.559569388628006, 16.1568396165967, -26.133403040468693, -44.37524202466011, -16.97042828798294, -43.999999828636646, -34.19999989122152, -91.16031442582607, -25.749512761831284, 13.37145870923996, 17.448865249753, -68.38936460018158, -68.36033841222525, -47.08018755167723, -78.07168617099524, -244.26800804585218, -16.837195433676243, -80.11002520471811, -37.49224457889795, -104.17236145585775, -155.2765168249607, -267.21373891830444, -144.65707799047232, -29.82363400608301, -66.84652807563543, -74.56412138789892, -6.258116111159325, -46.23847473412752, -107.0893646851182, -81.29646454751492, -24.827458672225475, -23.111686162650585, -223.05924566835165, -40.49144531041384, -209.57078332453966, -109.65747562795877, -132.85636548697948, -54.457208298146725, -26.999716326594353, -24.28588069230318, -171.87763635069132, -26.760338358581066, -46.989364586770535, -35.33232429623604, -54.310589745640755, -159.50738912820816, -156.47217158973217, -95.87063977122307, -101.98936452716589, -52.08085595816374, -165.78539169579744, -144.59999984502792, -85.6893645375967, -44.0255990549922, -33.580754689872265, -176.77150697261095, -50.28936453908682, -95.59999993443489, -86.17168606072664, -14.242660030722618, -88.56705094128847, -216.56153631210327, -63.017062835395336, -67.88680589944124, -65.868093945086, -159.72060602158308, -208.27099112421274, -295.7202964052558, -119.73663172870874, -46.99229221791029, -1.1680939868092537, -59.308162204921246, -84.31072675436735, -146.22279650717974, -23.413943395018578], "episode_lengths": [236, 298, 242, 234, 261, 252, 235, 297, 236, 265, 232, 293, 258, 246, 236, 270, 246, 225, 313, 234, 255, 318, 224, 226, 274, 216, 216, 246, 243, 229, 231, 230, 261, 243, 219, 226, 249, 252, 246, 249, 333, 228, 259, 240, 269, 282, 349, 295, 235, 252, 252, 218, 252, 266, 261, 234, 248, 331, 261, 298, 290, 286, 247, 241, 247, 291, 231, 249, 247, 249, 309, 300, 281, 248, 253, 297, 287, 263, 250, 249, 311, 241, 256, 260, 225, 268, 319, 257, 254, 246, 290, 309, 346, 256, 254, 222, 255, 269, 285, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6001867029324025, "mean_inference_ms": 7.471744155990719, "mean_action_processing_ms": 0.12505698648811472, "mean_env_wait_ms": 4.85852397965287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 17.448865249753, "episode_reward_min": -295.7202964052558, "episode_reward_mean": -80.94577459342777, "episode_len_mean": 259.92, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-39.48160910606384, -146.72523325681686, -46.55966315418482, -17.914238840341568, -67.68769542872906, -50.16105078905821, -30.962336868047714, -156.5747563391924, -22.02861036360264, -74.00718190521002, -49.11025156080723, -165.80000004172325, -76.04981672018766, -38.83307036757469, -21.97524218261242, -95.04120447486639, -41.37782669067383, -10.315920703113079, -217.88539186120033, -35.21198604255915, -62.53521404415369, -223.56014812737703, -16.75917784869671, -13.925569340586662, -100.96728973090649, 0.559569388628006, 16.1568396165967, -26.133403040468693, -44.37524202466011, -16.97042828798294, -43.999999828636646, -34.19999989122152, -91.16031442582607, -25.749512761831284, 13.37145870923996, 17.448865249753, -68.38936460018158, -68.36033841222525, -47.08018755167723, -78.07168617099524, -244.26800804585218, -16.837195433676243, -80.11002520471811, -37.49224457889795, -104.17236145585775, -155.2765168249607, -267.21373891830444, -144.65707799047232, -29.82363400608301, -66.84652807563543, -74.56412138789892, -6.258116111159325, -46.23847473412752, -107.0893646851182, -81.29646454751492, -24.827458672225475, -23.111686162650585, -223.05924566835165, -40.49144531041384, -209.57078332453966, -109.65747562795877, -132.85636548697948, -54.457208298146725, -26.999716326594353, -24.28588069230318, -171.87763635069132, -26.760338358581066, -46.989364586770535, -35.33232429623604, -54.310589745640755, -159.50738912820816, -156.47217158973217, -95.87063977122307, -101.98936452716589, -52.08085595816374, -165.78539169579744, -144.59999984502792, -85.6893645375967, -44.0255990549922, -33.580754689872265, -176.77150697261095, -50.28936453908682, -95.59999993443489, -86.17168606072664, -14.242660030722618, -88.56705094128847, -216.56153631210327, -63.017062835395336, -67.88680589944124, -65.868093945086, -159.72060602158308, -208.27099112421274, -295.7202964052558, -119.73663172870874, -46.99229221791029, -1.1680939868092537, -59.308162204921246, -84.31072675436735, -146.22279650717974, -23.413943395018578], "episode_lengths": [236, 298, 242, 234, 261, 252, 235, 297, 236, 265, 232, 293, 258, 246, 236, 270, 246, 225, 313, 234, 255, 318, 224, 226, 274, 216, 216, 246, 243, 229, 231, 230, 261, 243, 219, 226, 249, 252, 246, 249, 333, 228, 259, 240, 269, 282, 349, 295, 235, 252, 252, 218, 252, 266, 261, 234, 248, 331, 261, 298, 290, 286, 247, 241, 247, 291, 231, 249, 247, 249, 309, 300, 281, 248, 253, 297, 287, 263, 250, 249, 311, 241, 256, 260, 225, 268, 319, 257, 254, 246, 290, 309, 346, 256, 254, 222, 255, 269, 285, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6001867029324025, "mean_inference_ms": 7.471744155990719, "mean_action_processing_ms": 0.12505698648811472, "mean_env_wait_ms": 4.85852397965287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 24394.485, "learn_time_ms": 20864.622, "learn_throughput": 191.712, "update_time_ms": 26.481}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 226, "training_iteration": 15, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-29-41", "timestamp": 1655555381, "time_this_iter_s": 24.490534782409668, "time_total_s": 367.70271396636963, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 367.70271396636963, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 28.282857142857143, "ram_util_percent": 63.08285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 7.408660411834717, "policy_loss": -0.11413892358541489, "vf_loss": 7.484812259674072, "vf_explained_var": 0.1425168365240097, "kl": 0.01688324101269245, "entropy": 1.8409597873687744, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 17.448865249753, "episode_reward_min": -295.7202964052558, "episode_reward_mean": -83.97625870704651, "episode_len_mean": 261.04, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.37782669067383, -10.315920703113079, -217.88539186120033, -35.21198604255915, -62.53521404415369, -223.56014812737703, -16.75917784869671, -13.925569340586662, -100.96728973090649, 0.559569388628006, 16.1568396165967, -26.133403040468693, -44.37524202466011, -16.97042828798294, -43.999999828636646, -34.19999989122152, -91.16031442582607, -25.749512761831284, 13.37145870923996, 17.448865249753, -68.38936460018158, -68.36033841222525, -47.08018755167723, -78.07168617099524, -244.26800804585218, -16.837195433676243, -80.11002520471811, -37.49224457889795, -104.17236145585775, -155.2765168249607, -267.21373891830444, -144.65707799047232, -29.82363400608301, -66.84652807563543, -74.56412138789892, -6.258116111159325, -46.23847473412752, -107.0893646851182, -81.29646454751492, -24.827458672225475, -23.111686162650585, -223.05924566835165, -40.49144531041384, -209.57078332453966, -109.65747562795877, -132.85636548697948, -54.457208298146725, -26.999716326594353, -24.28588069230318, -171.87763635069132, -26.760338358581066, -46.989364586770535, -35.33232429623604, -54.310589745640755, -159.50738912820816, -156.47217158973217, -95.87063977122307, -101.98936452716589, -52.08085595816374, -165.78539169579744, -144.59999984502792, -85.6893645375967, -44.0255990549922, -33.580754689872265, -176.77150697261095, -50.28936453908682, -95.59999993443489, -86.17168606072664, -14.242660030722618, -88.56705094128847, -216.56153631210327, -63.017062835395336, -67.88680589944124, -65.868093945086, -159.72060602158308, -208.27099112421274, -295.7202964052558, -119.73663172870874, -46.99229221791029, -1.1680939868092537, -59.308162204921246, -84.31072675436735, -146.22279650717974, -23.413943395018578, -102.19157972931862, -61.92745869606733, -97.0610507056117, -10.35745856165886, -253.14066516608, -56.79044249653816, -99.01741614937782, -127.73042427003384, -125.9253990277648, -121.7632183432579, -114.47310439497232, -31.952237255871296, -76.83020535856485, -4.769450828433037, -49.42029141634703, -68.60997036099434], "episode_lengths": [246, 225, 313, 234, 255, 318, 224, 226, 274, 216, 216, 246, 243, 229, 231, 230, 261, 243, 219, 226, 249, 252, 246, 249, 333, 228, 259, 240, 269, 282, 349, 295, 235, 252, 252, 218, 252, 266, 261, 234, 248, 331, 261, 298, 290, 286, 247, 241, 247, 291, 231, 249, 247, 249, 309, 300, 281, 248, 253, 297, 287, 263, 250, 249, 311, 241, 256, 260, 225, 268, 319, 257, 254, 246, 290, 309, 346, 256, 254, 222, 255, 269, 285, 229, 280, 236, 256, 226, 351, 251, 280, 272, 280, 278, 286, 222, 268, 220, 253, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6020926923888602, "mean_inference_ms": 7.4600867917781875, "mean_action_processing_ms": 0.12470654506864161, "mean_env_wait_ms": 4.841670202209011, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 17.448865249753, "episode_reward_min": -295.7202964052558, "episode_reward_mean": -83.97625870704651, "episode_len_mean": 261.04, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.37782669067383, -10.315920703113079, -217.88539186120033, -35.21198604255915, -62.53521404415369, -223.56014812737703, -16.75917784869671, -13.925569340586662, -100.96728973090649, 0.559569388628006, 16.1568396165967, -26.133403040468693, -44.37524202466011, -16.97042828798294, -43.999999828636646, -34.19999989122152, -91.16031442582607, -25.749512761831284, 13.37145870923996, 17.448865249753, -68.38936460018158, -68.36033841222525, -47.08018755167723, -78.07168617099524, -244.26800804585218, -16.837195433676243, -80.11002520471811, -37.49224457889795, -104.17236145585775, -155.2765168249607, -267.21373891830444, -144.65707799047232, -29.82363400608301, -66.84652807563543, -74.56412138789892, -6.258116111159325, -46.23847473412752, -107.0893646851182, -81.29646454751492, -24.827458672225475, -23.111686162650585, -223.05924566835165, -40.49144531041384, -209.57078332453966, -109.65747562795877, -132.85636548697948, -54.457208298146725, -26.999716326594353, -24.28588069230318, -171.87763635069132, -26.760338358581066, -46.989364586770535, -35.33232429623604, -54.310589745640755, -159.50738912820816, -156.47217158973217, -95.87063977122307, -101.98936452716589, -52.08085595816374, -165.78539169579744, -144.59999984502792, -85.6893645375967, -44.0255990549922, -33.580754689872265, -176.77150697261095, -50.28936453908682, -95.59999993443489, -86.17168606072664, -14.242660030722618, -88.56705094128847, -216.56153631210327, -63.017062835395336, -67.88680589944124, -65.868093945086, -159.72060602158308, -208.27099112421274, -295.7202964052558, -119.73663172870874, -46.99229221791029, -1.1680939868092537, -59.308162204921246, -84.31072675436735, -146.22279650717974, -23.413943395018578, -102.19157972931862, -61.92745869606733, -97.0610507056117, -10.35745856165886, -253.14066516608, -56.79044249653816, -99.01741614937782, -127.73042427003384, -125.9253990277648, -121.7632183432579, -114.47310439497232, -31.952237255871296, -76.83020535856485, -4.769450828433037, -49.42029141634703, -68.60997036099434], "episode_lengths": [246, 225, 313, 234, 255, 318, 224, 226, 274, 216, 216, 246, 243, 229, 231, 230, 261, 243, 219, 226, 249, 252, 246, 249, 333, 228, 259, 240, 269, 282, 349, 295, 235, 252, 252, 218, 252, 266, 261, 234, 248, 331, 261, 298, 290, 286, 247, 241, 247, 291, 231, 249, 247, 249, 309, 300, 281, 248, 253, 297, 287, 263, 250, 249, 311, 241, 256, 260, 225, 268, 319, 257, 254, 246, 290, 309, 346, 256, 254, 222, 255, 269, 285, 229, 280, 236, 256, 226, 351, 251, 280, 272, 280, 278, 286, 222, 268, 220, 253, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6020926923888602, "mean_inference_ms": 7.4600867917781875, "mean_action_processing_ms": 0.12470654506864161, "mean_env_wait_ms": 4.841670202209011, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 24337.097, "learn_time_ms": 20834.527, "learn_throughput": 191.989, "update_time_ms": 26.374}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 242, "training_iteration": 16, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-30-06", "timestamp": 1655555406, "time_this_iter_s": 23.972090244293213, "time_total_s": 391.67480421066284, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 391.67480421066284, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 27.35294117647059, "ram_util_percent": 62.3235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.483856678009033, "policy_loss": -0.12106664478778839, "vf_loss": 6.567237377166748, "vf_explained_var": 0.23177003860473633, "kl": 0.016749020665884018, "entropy": 1.819732904434204, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 17.448865249753, "episode_reward_min": -295.7202964052558, "episode_reward_mean": -90.15782293610275, "episode_len_mean": 264.77, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.19999989122152, -91.16031442582607, -25.749512761831284, 13.37145870923996, 17.448865249753, -68.38936460018158, -68.36033841222525, -47.08018755167723, -78.07168617099524, -244.26800804585218, -16.837195433676243, -80.11002520471811, -37.49224457889795, -104.17236145585775, -155.2765168249607, -267.21373891830444, -144.65707799047232, -29.82363400608301, -66.84652807563543, -74.56412138789892, -6.258116111159325, -46.23847473412752, -107.0893646851182, -81.29646454751492, -24.827458672225475, -23.111686162650585, -223.05924566835165, -40.49144531041384, -209.57078332453966, -109.65747562795877, -132.85636548697948, -54.457208298146725, -26.999716326594353, -24.28588069230318, -171.87763635069132, -26.760338358581066, -46.989364586770535, -35.33232429623604, -54.310589745640755, -159.50738912820816, -156.47217158973217, -95.87063977122307, -101.98936452716589, -52.08085595816374, -165.78539169579744, -144.59999984502792, -85.6893645375967, -44.0255990549922, -33.580754689872265, -176.77150697261095, -50.28936453908682, -95.59999993443489, -86.17168606072664, -14.242660030722618, -88.56705094128847, -216.56153631210327, -63.017062835395336, -67.88680589944124, -65.868093945086, -159.72060602158308, -208.27099112421274, -295.7202964052558, -119.73663172870874, -46.99229221791029, -1.1680939868092537, -59.308162204921246, -84.31072675436735, -146.22279650717974, -23.413943395018578, -102.19157972931862, -61.92745869606733, -97.0610507056117, -10.35745856165886, -253.14066516608, -56.79044249653816, -99.01741614937782, -127.73042427003384, -125.9253990277648, -121.7632183432579, -114.47310439497232, -31.952237255871296, -76.83020535856485, -4.769450828433037, -49.42029141634703, -68.60997036099434, -27.010456286370754, -114.64049710333347, -70.8999999910593, -107.60796106606722, -29.34783084690571, -193.58539170771837, -86.18502376973629, -126.22195230424404, -55.54644265025854, -64.96014817804098, -165.9094707146287, -15.99195446074009, -101.38036344945431, -157.98075435310602, -138.18936458975077], "episode_lengths": [230, 261, 243, 219, 226, 249, 252, 246, 249, 333, 228, 259, 240, 269, 282, 349, 295, 235, 252, 252, 218, 252, 266, 261, 234, 248, 331, 261, 298, 290, 286, 247, 241, 247, 291, 231, 249, 247, 249, 309, 300, 281, 248, 253, 297, 287, 263, 250, 249, 311, 241, 256, 260, 225, 268, 319, 257, 254, 246, 290, 309, 346, 256, 254, 222, 255, 269, 285, 229, 280, 236, 256, 226, 351, 251, 280, 272, 280, 278, 286, 222, 268, 220, 253, 244, 253, 280, 245, 276, 244, 308, 276, 283, 250, 256, 298, 235, 286, 301, 278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6028187536520135, "mean_inference_ms": 7.451884939741552, "mean_action_processing_ms": 0.12430557116469357, "mean_env_wait_ms": 4.822174356752311, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 17.448865249753, "episode_reward_min": -295.7202964052558, "episode_reward_mean": -90.15782293610275, "episode_len_mean": 264.77, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.19999989122152, -91.16031442582607, -25.749512761831284, 13.37145870923996, 17.448865249753, -68.38936460018158, -68.36033841222525, -47.08018755167723, -78.07168617099524, -244.26800804585218, -16.837195433676243, -80.11002520471811, -37.49224457889795, -104.17236145585775, -155.2765168249607, -267.21373891830444, -144.65707799047232, -29.82363400608301, -66.84652807563543, -74.56412138789892, -6.258116111159325, -46.23847473412752, -107.0893646851182, -81.29646454751492, -24.827458672225475, -23.111686162650585, -223.05924566835165, -40.49144531041384, -209.57078332453966, -109.65747562795877, -132.85636548697948, -54.457208298146725, -26.999716326594353, -24.28588069230318, -171.87763635069132, -26.760338358581066, -46.989364586770535, -35.33232429623604, -54.310589745640755, -159.50738912820816, -156.47217158973217, -95.87063977122307, -101.98936452716589, -52.08085595816374, -165.78539169579744, -144.59999984502792, -85.6893645375967, -44.0255990549922, -33.580754689872265, -176.77150697261095, -50.28936453908682, -95.59999993443489, -86.17168606072664, -14.242660030722618, -88.56705094128847, -216.56153631210327, -63.017062835395336, -67.88680589944124, -65.868093945086, -159.72060602158308, -208.27099112421274, -295.7202964052558, -119.73663172870874, -46.99229221791029, -1.1680939868092537, -59.308162204921246, -84.31072675436735, -146.22279650717974, -23.413943395018578, -102.19157972931862, -61.92745869606733, -97.0610507056117, -10.35745856165886, -253.14066516608, -56.79044249653816, -99.01741614937782, -127.73042427003384, -125.9253990277648, -121.7632183432579, -114.47310439497232, -31.952237255871296, -76.83020535856485, -4.769450828433037, -49.42029141634703, -68.60997036099434, -27.010456286370754, -114.64049710333347, -70.8999999910593, -107.60796106606722, -29.34783084690571, -193.58539170771837, -86.18502376973629, -126.22195230424404, -55.54644265025854, -64.96014817804098, -165.9094707146287, -15.99195446074009, -101.38036344945431, -157.98075435310602, -138.18936458975077], "episode_lengths": [230, 261, 243, 219, 226, 249, 252, 246, 249, 333, 228, 259, 240, 269, 282, 349, 295, 235, 252, 252, 218, 252, 266, 261, 234, 248, 331, 261, 298, 290, 286, 247, 241, 247, 291, 231, 249, 247, 249, 309, 300, 281, 248, 253, 297, 287, 263, 250, 249, 311, 241, 256, 260, 225, 268, 319, 257, 254, 246, 290, 309, 346, 256, 254, 222, 255, 269, 285, 229, 280, 236, 256, 226, 351, 251, 280, 272, 280, 278, 286, 222, 268, 220, 253, 244, 253, 280, 245, 276, 244, 308, 276, 283, 250, 256, 298, 235, 286, 301, 278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6028187536520135, "mean_inference_ms": 7.451884939741552, "mean_action_processing_ms": 0.12430557116469357, "mean_env_wait_ms": 4.822174356752311, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 68000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 24309.913, "learn_time_ms": 20804.222, "learn_throughput": 192.269, "update_time_ms": 26.198}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 257, "training_iteration": 17, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-30-30", "timestamp": 1655555430, "time_this_iter_s": 24.129561185836792, "time_total_s": 415.80436539649963, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 415.80436539649963, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 28.62058823529412, "ram_util_percent": 62.373529411764714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.507554531097412, "policy_loss": -0.11212851107120514, "vf_loss": 6.581344127655029, "vf_explained_var": 0.2861262261867523, "kl": 0.01703944429755211, "entropy": 1.8057609796524048, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -1.1680939868092537, "episode_reward_min": -295.7202964052558, "episode_reward_mean": -92.28871811024845, "episode_len_mean": 265.92, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.17236145585775, -155.2765168249607, -267.21373891830444, -144.65707799047232, -29.82363400608301, -66.84652807563543, -74.56412138789892, -6.258116111159325, -46.23847473412752, -107.0893646851182, -81.29646454751492, -24.827458672225475, -23.111686162650585, -223.05924566835165, -40.49144531041384, -209.57078332453966, -109.65747562795877, -132.85636548697948, -54.457208298146725, -26.999716326594353, -24.28588069230318, -171.87763635069132, -26.760338358581066, -46.989364586770535, -35.33232429623604, -54.310589745640755, -159.50738912820816, -156.47217158973217, -95.87063977122307, -101.98936452716589, -52.08085595816374, -165.78539169579744, -144.59999984502792, -85.6893645375967, -44.0255990549922, -33.580754689872265, -176.77150697261095, -50.28936453908682, -95.59999993443489, -86.17168606072664, -14.242660030722618, -88.56705094128847, -216.56153631210327, -63.017062835395336, -67.88680589944124, -65.868093945086, -159.72060602158308, -208.27099112421274, -295.7202964052558, -119.73663172870874, -46.99229221791029, -1.1680939868092537, -59.308162204921246, -84.31072675436735, -146.22279650717974, -23.413943395018578, -102.19157972931862, -61.92745869606733, -97.0610507056117, -10.35745856165886, -253.14066516608, -56.79044249653816, -99.01741614937782, -127.73042427003384, -125.9253990277648, -121.7632183432579, -114.47310439497232, -31.952237255871296, -76.83020535856485, -4.769450828433037, -49.42029141634703, -68.60997036099434, -27.010456286370754, -114.64049710333347, -70.8999999910593, -107.60796106606722, -29.34783084690571, -193.58539170771837, -86.18502376973629, -126.22195230424404, -55.54644265025854, -64.96014817804098, -165.9094707146287, -15.99195446074009, -101.38036344945431, -157.98075435310602, -138.18936458975077, -100.57913359999657, -84.32367600500584, -37.46105067431927, -34.71917359530926, -144.62060578167439, -92.40816526859999, -56.39088600128889, -202.36014822870493, -50.249867990612984, -119.08202660828829, -16.425322875380516, -16.170973725616932, -19.197040177881718], "episode_lengths": [269, 282, 349, 295, 235, 252, 252, 218, 252, 266, 261, 234, 248, 331, 261, 298, 290, 286, 247, 241, 247, 291, 231, 249, 247, 249, 309, 300, 281, 248, 253, 297, 287, 263, 250, 249, 311, 241, 256, 260, 225, 268, 319, 257, 254, 246, 290, 309, 346, 256, 254, 222, 255, 269, 285, 229, 280, 236, 256, 226, 351, 251, 280, 272, 280, 278, 286, 222, 268, 220, 253, 244, 253, 280, 245, 276, 244, 308, 276, 283, 250, 256, 298, 235, 286, 301, 278, 273, 261, 240, 237, 297, 278, 249, 319, 244, 269, 232, 225, 226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6037299368461704, "mean_inference_ms": 7.448044831821105, "mean_action_processing_ms": 0.12417500142060471, "mean_env_wait_ms": 4.807345858270295, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -1.1680939868092537, "episode_reward_min": -295.7202964052558, "episode_reward_mean": -92.28871811024845, "episode_len_mean": 265.92, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-104.17236145585775, -155.2765168249607, -267.21373891830444, -144.65707799047232, -29.82363400608301, -66.84652807563543, -74.56412138789892, -6.258116111159325, -46.23847473412752, -107.0893646851182, -81.29646454751492, -24.827458672225475, -23.111686162650585, -223.05924566835165, -40.49144531041384, -209.57078332453966, -109.65747562795877, -132.85636548697948, -54.457208298146725, -26.999716326594353, -24.28588069230318, -171.87763635069132, -26.760338358581066, -46.989364586770535, -35.33232429623604, -54.310589745640755, -159.50738912820816, -156.47217158973217, -95.87063977122307, -101.98936452716589, -52.08085595816374, -165.78539169579744, -144.59999984502792, -85.6893645375967, -44.0255990549922, -33.580754689872265, -176.77150697261095, -50.28936453908682, -95.59999993443489, -86.17168606072664, -14.242660030722618, -88.56705094128847, -216.56153631210327, -63.017062835395336, -67.88680589944124, -65.868093945086, -159.72060602158308, -208.27099112421274, -295.7202964052558, -119.73663172870874, -46.99229221791029, -1.1680939868092537, -59.308162204921246, -84.31072675436735, -146.22279650717974, -23.413943395018578, -102.19157972931862, -61.92745869606733, -97.0610507056117, -10.35745856165886, -253.14066516608, -56.79044249653816, -99.01741614937782, -127.73042427003384, -125.9253990277648, -121.7632183432579, -114.47310439497232, -31.952237255871296, -76.83020535856485, -4.769450828433037, -49.42029141634703, -68.60997036099434, -27.010456286370754, -114.64049710333347, -70.8999999910593, -107.60796106606722, -29.34783084690571, -193.58539170771837, -86.18502376973629, -126.22195230424404, -55.54644265025854, -64.96014817804098, -165.9094707146287, -15.99195446074009, -101.38036344945431, -157.98075435310602, -138.18936458975077, -100.57913359999657, -84.32367600500584, -37.46105067431927, -34.71917359530926, -144.62060578167439, -92.40816526859999, -56.39088600128889, -202.36014822870493, -50.249867990612984, -119.08202660828829, -16.425322875380516, -16.170973725616932, -19.197040177881718], "episode_lengths": [269, 282, 349, 295, 235, 252, 252, 218, 252, 266, 261, 234, 248, 331, 261, 298, 290, 286, 247, 241, 247, 291, 231, 249, 247, 249, 309, 300, 281, 248, 253, 297, 287, 263, 250, 249, 311, 241, 256, 260, 225, 268, 319, 257, 254, 246, 290, 309, 346, 256, 254, 222, 255, 269, 285, 229, 280, 236, 256, 226, 351, 251, 280, 272, 280, 278, 286, 222, 268, 220, 253, 244, 253, 280, 245, 276, 244, 308, 276, 283, 250, 256, 298, 235, 286, 301, 278, 273, 261, 240, 237, 297, 278, 249, 319, 244, 269, 232, 225, 226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6037299368461704, "mean_inference_ms": 7.448044831821105, "mean_action_processing_ms": 0.12417500142060471, "mean_env_wait_ms": 4.807345858270295, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 72000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 24258.287, "learn_time_ms": 20760.09, "learn_throughput": 192.677, "update_time_ms": 26.2}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 270, "training_iteration": 18, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-30-54", "timestamp": 1655555454, "time_this_iter_s": 23.965117692947388, "time_total_s": 439.769483089447, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 439.769483089447, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 29.593939393939394, "ram_util_percent": 62.43939393939394}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.392613410949707, "policy_loss": -0.025909479707479477, "vf_loss": 6.404798984527588, "vf_explained_var": 0.012595444917678833, "kl": 0.0060996077954769135, "entropy": 1.790470838546753, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 925.8687794730067, "episode_reward_min": -342.3690260052681, "episode_reward_mean": -81.15676616474985, "episode_len_mean": 264.6, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-209.57078332453966, -109.65747562795877, -132.85636548697948, -54.457208298146725, -26.999716326594353, -24.28588069230318, -171.87763635069132, -26.760338358581066, -46.989364586770535, -35.33232429623604, -54.310589745640755, -159.50738912820816, -156.47217158973217, -95.87063977122307, -101.98936452716589, -52.08085595816374, -165.78539169579744, -144.59999984502792, -85.6893645375967, -44.0255990549922, -33.580754689872265, -176.77150697261095, -50.28936453908682, -95.59999993443489, -86.17168606072664, -14.242660030722618, -88.56705094128847, -216.56153631210327, -63.017062835395336, -67.88680589944124, -65.868093945086, -159.72060602158308, -208.27099112421274, -295.7202964052558, -119.73663172870874, -46.99229221791029, -1.1680939868092537, -59.308162204921246, -84.31072675436735, -146.22279650717974, -23.413943395018578, -102.19157972931862, -61.92745869606733, -97.0610507056117, -10.35745856165886, -253.14066516608, -56.79044249653816, -99.01741614937782, -127.73042427003384, -125.9253990277648, -121.7632183432579, -114.47310439497232, -31.952237255871296, -76.83020535856485, -4.769450828433037, -49.42029141634703, -68.60997036099434, -27.010456286370754, -114.64049710333347, -70.8999999910593, -107.60796106606722, -29.34783084690571, -193.58539170771837, -86.18502376973629, -126.22195230424404, -55.54644265025854, -64.96014817804098, -165.9094707146287, -15.99195446074009, -101.38036344945431, -157.98075435310602, -138.18936458975077, -100.57913359999657, -84.32367600500584, -37.46105067431927, -34.71917359530926, -144.62060578167439, -92.40816526859999, -56.39088600128889, -202.36014822870493, -50.249867990612984, -119.08202660828829, -16.425322875380516, -16.170973725616932, -19.197040177881718, -30.460551984608173, 1.6183907389640808, -88.22060570120811, -92.32202617824078, -167.30506633222103, -123.42866449058056, -342.3690260052681, -75.79199296236038, -66.10343207418919, -66.61951679736376, -38.28677984327078, -9.724578812718391, -38.685969322919846, 925.8687794730067, -69.89999970793724], "episode_lengths": [298, 290, 286, 247, 241, 247, 291, 231, 249, 247, 249, 309, 300, 281, 248, 253, 297, 287, 263, 250, 249, 311, 241, 256, 260, 225, 268, 319, 257, 254, 246, 290, 309, 346, 256, 254, 222, 255, 269, 285, 229, 280, 236, 256, 226, 351, 251, 280, 272, 280, 278, 286, 222, 268, 220, 253, 244, 253, 280, 245, 276, 244, 308, 276, 283, 250, 256, 298, 235, 286, 301, 278, 273, 261, 240, 237, 297, 278, 249, 319, 244, 269, 232, 225, 226, 239, 209, 265, 272, 313, 284, 382, 262, 262, 251, 235, 221, 235, 194, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6040000671195732, "mean_inference_ms": 7.43781841981332, "mean_action_processing_ms": 0.12353286393864477, "mean_env_wait_ms": 4.79645443838286, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 925.8687794730067, "episode_reward_min": -342.3690260052681, "episode_reward_mean": -81.15676616474985, "episode_len_mean": 264.6, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-209.57078332453966, -109.65747562795877, -132.85636548697948, -54.457208298146725, -26.999716326594353, -24.28588069230318, -171.87763635069132, -26.760338358581066, -46.989364586770535, -35.33232429623604, -54.310589745640755, -159.50738912820816, -156.47217158973217, -95.87063977122307, -101.98936452716589, -52.08085595816374, -165.78539169579744, -144.59999984502792, -85.6893645375967, -44.0255990549922, -33.580754689872265, -176.77150697261095, -50.28936453908682, -95.59999993443489, -86.17168606072664, -14.242660030722618, -88.56705094128847, -216.56153631210327, -63.017062835395336, -67.88680589944124, -65.868093945086, -159.72060602158308, -208.27099112421274, -295.7202964052558, -119.73663172870874, -46.99229221791029, -1.1680939868092537, -59.308162204921246, -84.31072675436735, -146.22279650717974, -23.413943395018578, -102.19157972931862, -61.92745869606733, -97.0610507056117, -10.35745856165886, -253.14066516608, -56.79044249653816, -99.01741614937782, -127.73042427003384, -125.9253990277648, -121.7632183432579, -114.47310439497232, -31.952237255871296, -76.83020535856485, -4.769450828433037, -49.42029141634703, -68.60997036099434, -27.010456286370754, -114.64049710333347, -70.8999999910593, -107.60796106606722, -29.34783084690571, -193.58539170771837, -86.18502376973629, -126.22195230424404, -55.54644265025854, -64.96014817804098, -165.9094707146287, -15.99195446074009, -101.38036344945431, -157.98075435310602, -138.18936458975077, -100.57913359999657, -84.32367600500584, -37.46105067431927, -34.71917359530926, -144.62060578167439, -92.40816526859999, -56.39088600128889, -202.36014822870493, -50.249867990612984, -119.08202660828829, -16.425322875380516, -16.170973725616932, -19.197040177881718, -30.460551984608173, 1.6183907389640808, -88.22060570120811, -92.32202617824078, -167.30506633222103, -123.42866449058056, -342.3690260052681, -75.79199296236038, -66.10343207418919, -66.61951679736376, -38.28677984327078, -9.724578812718391, -38.685969322919846, 925.8687794730067, -69.89999970793724], "episode_lengths": [298, 290, 286, 247, 241, 247, 291, 231, 249, 247, 249, 309, 300, 281, 248, 253, 297, 287, 263, 250, 249, 311, 241, 256, 260, 225, 268, 319, 257, 254, 246, 290, 309, 346, 256, 254, 222, 255, 269, 285, 229, 280, 236, 256, 226, 351, 251, 280, 272, 280, 278, 286, 222, 268, 220, 253, 244, 253, 280, 245, 276, 244, 308, 276, 283, 250, 256, 298, 235, 286, 301, 278, 273, 261, 240, 237, 297, 278, 249, 319, 244, 269, 232, 225, 226, 239, 209, 265, 272, 313, 284, 382, 262, 262, 251, 235, 221, 235, 194, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6040000671195732, "mean_inference_ms": 7.43781841981332, "mean_action_processing_ms": 0.12353286393864477, "mean_env_wait_ms": 4.79645443838286, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 76000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 24229.633, "learn_time_ms": 20734.236, "learn_throughput": 192.918, "update_time_ms": 26.201}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 285, "training_iteration": 19, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-31-18", "timestamp": 1655555478, "time_this_iter_s": 24.117459774017334, "time_total_s": 463.88694286346436, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 463.88694286346436, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 27.008823529411767, "ram_util_percent": 62.502941176470586}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.913581371307373, "policy_loss": -0.13130903244018555, "vf_loss": 7.00331449508667, "vf_explained_var": 0.09770863503217697, "kl": 0.018478063866496086, "entropy": 1.8210546970367432, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 925.8687794730067, "episode_reward_min": -342.3690260052681, "episode_reward_mean": -78.96871453188359, "episode_len_mean": 263.9, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-165.78539169579744, -144.59999984502792, -85.6893645375967, -44.0255990549922, -33.580754689872265, -176.77150697261095, -50.28936453908682, -95.59999993443489, -86.17168606072664, -14.242660030722618, -88.56705094128847, -216.56153631210327, -63.017062835395336, -67.88680589944124, -65.868093945086, -159.72060602158308, -208.27099112421274, -295.7202964052558, -119.73663172870874, -46.99229221791029, -1.1680939868092537, -59.308162204921246, -84.31072675436735, -146.22279650717974, -23.413943395018578, -102.19157972931862, -61.92745869606733, -97.0610507056117, -10.35745856165886, -253.14066516608, -56.79044249653816, -99.01741614937782, -127.73042427003384, -125.9253990277648, -121.7632183432579, -114.47310439497232, -31.952237255871296, -76.83020535856485, -4.769450828433037, -49.42029141634703, -68.60997036099434, -27.010456286370754, -114.64049710333347, -70.8999999910593, -107.60796106606722, -29.34783084690571, -193.58539170771837, -86.18502376973629, -126.22195230424404, -55.54644265025854, -64.96014817804098, -165.9094707146287, -15.99195446074009, -101.38036344945431, -157.98075435310602, -138.18936458975077, -100.57913359999657, -84.32367600500584, -37.46105067431927, -34.71917359530926, -144.62060578167439, -92.40816526859999, -56.39088600128889, -202.36014822870493, -50.249867990612984, -119.08202660828829, -16.425322875380516, -16.170973725616932, -19.197040177881718, -30.460551984608173, 1.6183907389640808, -88.22060570120811, -92.32202617824078, -167.30506633222103, -123.42866449058056, -342.3690260052681, -75.79199296236038, -66.10343207418919, -66.61951679736376, -38.28677984327078, -9.724578812718391, -38.685969322919846, 925.8687794730067, -69.89999970793724, -10.89182873815298, -21.497947700321674, -22.79213321954012, -7.861972831189632, -110.77097401022911, -91.59712662547827, -30.024667412042618, -149.0163382589817, -12.19224450737238, -114.88539166748524, -109.10738577693701, -77.18936459720135, -71.02319089323282, -143.49827241897583, -156.12888804078102, -111.73521408438683], "episode_lengths": [297, 287, 263, 250, 249, 311, 241, 256, 260, 225, 268, 319, 257, 254, 246, 290, 309, 346, 256, 254, 222, 255, 269, 285, 229, 280, 236, 256, 226, 351, 251, 280, 272, 280, 278, 286, 222, 268, 220, 253, 244, 253, 280, 245, 276, 244, 308, 276, 283, 250, 256, 298, 235, 286, 301, 278, 273, 261, 240, 237, 297, 278, 249, 319, 244, 269, 232, 225, 226, 239, 209, 265, 272, 313, 284, 382, 262, 262, 251, 235, 221, 235, 194, 249, 224, 245, 254, 229, 271, 270, 246, 289, 226, 265, 277, 257, 264, 306, 308, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6044258572236783, "mean_inference_ms": 7.432042558974388, "mean_action_processing_ms": 0.12316519893020546, "mean_env_wait_ms": 4.786291594107249, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 925.8687794730067, "episode_reward_min": -342.3690260052681, "episode_reward_mean": -78.96871453188359, "episode_len_mean": 263.9, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-165.78539169579744, -144.59999984502792, -85.6893645375967, -44.0255990549922, -33.580754689872265, -176.77150697261095, -50.28936453908682, -95.59999993443489, -86.17168606072664, -14.242660030722618, -88.56705094128847, -216.56153631210327, -63.017062835395336, -67.88680589944124, -65.868093945086, -159.72060602158308, -208.27099112421274, -295.7202964052558, -119.73663172870874, -46.99229221791029, -1.1680939868092537, -59.308162204921246, -84.31072675436735, -146.22279650717974, -23.413943395018578, -102.19157972931862, -61.92745869606733, -97.0610507056117, -10.35745856165886, -253.14066516608, -56.79044249653816, -99.01741614937782, -127.73042427003384, -125.9253990277648, -121.7632183432579, -114.47310439497232, -31.952237255871296, -76.83020535856485, -4.769450828433037, -49.42029141634703, -68.60997036099434, -27.010456286370754, -114.64049710333347, -70.8999999910593, -107.60796106606722, -29.34783084690571, -193.58539170771837, -86.18502376973629, -126.22195230424404, -55.54644265025854, -64.96014817804098, -165.9094707146287, -15.99195446074009, -101.38036344945431, -157.98075435310602, -138.18936458975077, -100.57913359999657, -84.32367600500584, -37.46105067431927, -34.71917359530926, -144.62060578167439, -92.40816526859999, -56.39088600128889, -202.36014822870493, -50.249867990612984, -119.08202660828829, -16.425322875380516, -16.170973725616932, -19.197040177881718, -30.460551984608173, 1.6183907389640808, -88.22060570120811, -92.32202617824078, -167.30506633222103, -123.42866449058056, -342.3690260052681, -75.79199296236038, -66.10343207418919, -66.61951679736376, -38.28677984327078, -9.724578812718391, -38.685969322919846, 925.8687794730067, -69.89999970793724, -10.89182873815298, -21.497947700321674, -22.79213321954012, -7.861972831189632, -110.77097401022911, -91.59712662547827, -30.024667412042618, -149.0163382589817, -12.19224450737238, -114.88539166748524, -109.10738577693701, -77.18936459720135, -71.02319089323282, -143.49827241897583, -156.12888804078102, -111.73521408438683], "episode_lengths": [297, 287, 263, 250, 249, 311, 241, 256, 260, 225, 268, 319, 257, 254, 246, 290, 309, 346, 256, 254, 222, 255, 269, 285, 229, 280, 236, 256, 226, 351, 251, 280, 272, 280, 278, 286, 222, 268, 220, 253, 244, 253, 280, 245, 276, 244, 308, 276, 283, 250, 256, 298, 235, 286, 301, 278, 273, 261, 240, 237, 297, 278, 249, 319, 244, 269, 232, 225, 226, 239, 209, 265, 272, 313, 284, 382, 262, 262, 251, 235, 221, 235, 194, 249, 224, 245, 254, 229, 271, 270, 246, 289, 226, 265, 277, 257, 264, 306, 308, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6044258572236783, "mean_inference_ms": 7.432042558974388, "mean_action_processing_ms": 0.12316519893020546, "mean_env_wait_ms": 4.786291594107249, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 80000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 24209.808, "learn_time_ms": 20711.913, "learn_throughput": 193.126, "update_time_ms": 26.201}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 301, "training_iteration": 20, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-31-43", "timestamp": 1655555503, "time_this_iter_s": 24.27728772163391, "time_total_s": 488.16423058509827, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 488.16423058509827, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 28.96764705882353, "ram_util_percent": 62.47647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.821645736694336, "policy_loss": -0.12276093661785126, "vf_loss": 6.9061970710754395, "vf_explained_var": 0.13123269379138947, "kl": 0.016982102766633034, "entropy": 1.7844308614730835, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 925.8687794730067, "episode_reward_min": -342.3690260052681, "episode_reward_mean": -75.94709573939443, "episode_len_mean": 263.05, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-208.27099112421274, -295.7202964052558, -119.73663172870874, -46.99229221791029, -1.1680939868092537, -59.308162204921246, -84.31072675436735, -146.22279650717974, -23.413943395018578, -102.19157972931862, -61.92745869606733, -97.0610507056117, -10.35745856165886, -253.14066516608, -56.79044249653816, -99.01741614937782, -127.73042427003384, -125.9253990277648, -121.7632183432579, -114.47310439497232, -31.952237255871296, -76.83020535856485, -4.769450828433037, -49.42029141634703, -68.60997036099434, -27.010456286370754, -114.64049710333347, -70.8999999910593, -107.60796106606722, -29.34783084690571, -193.58539170771837, -86.18502376973629, -126.22195230424404, -55.54644265025854, -64.96014817804098, -165.9094707146287, -15.99195446074009, -101.38036344945431, -157.98075435310602, -138.18936458975077, -100.57913359999657, -84.32367600500584, -37.46105067431927, -34.71917359530926, -144.62060578167439, -92.40816526859999, -56.39088600128889, -202.36014822870493, -50.249867990612984, -119.08202660828829, -16.425322875380516, -16.170973725616932, -19.197040177881718, -30.460551984608173, 1.6183907389640808, -88.22060570120811, -92.32202617824078, -167.30506633222103, -123.42866449058056, -342.3690260052681, -75.79199296236038, -66.10343207418919, -66.61951679736376, -38.28677984327078, -9.724578812718391, -38.685969322919846, 925.8687794730067, -69.89999970793724, -10.89182873815298, -21.497947700321674, -22.79213321954012, -7.861972831189632, -110.77097401022911, -91.59712662547827, -30.024667412042618, -149.0163382589817, -12.19224450737238, -114.88539166748524, -109.10738577693701, -77.18936459720135, -71.02319089323282, -143.49827241897583, -156.12888804078102, -111.73521408438683, -109.55775382369757, -75.67571198195219, -15.860148176550865, -9.272893138229847, -13.139630950987339, -105.88846202939749, -95.2923019900918, -237.42426922917366, -94.99368016421795, -30.127566948533058, -40.44053181260824, -77.70336239039898, -73.9486103579402, -120.46412099897861, -102.36105077713728, -54.06550929695368], "episode_lengths": [309, 346, 256, 254, 222, 255, 269, 285, 229, 280, 236, 256, 226, 351, 251, 280, 272, 280, 278, 286, 222, 268, 220, 253, 244, 253, 280, 245, 276, 244, 308, 276, 283, 250, 256, 298, 235, 286, 301, 278, 273, 261, 240, 237, 297, 278, 249, 319, 244, 269, 232, 225, 226, 239, 209, 265, 272, 313, 284, 382, 262, 262, 251, 235, 221, 235, 194, 249, 224, 245, 254, 229, 271, 270, 246, 289, 226, 265, 277, 257, 264, 306, 308, 266, 278, 249, 223, 238, 225, 269, 273, 327, 266, 247, 265, 268, 270, 279, 261, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.605023851485528, "mean_inference_ms": 7.4254823466902335, "mean_action_processing_ms": 0.12300900379773844, "mean_env_wait_ms": 4.782262699171322, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 925.8687794730067, "episode_reward_min": -342.3690260052681, "episode_reward_mean": -75.94709573939443, "episode_len_mean": 263.05, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-208.27099112421274, -295.7202964052558, -119.73663172870874, -46.99229221791029, -1.1680939868092537, -59.308162204921246, -84.31072675436735, -146.22279650717974, -23.413943395018578, -102.19157972931862, -61.92745869606733, -97.0610507056117, -10.35745856165886, -253.14066516608, -56.79044249653816, -99.01741614937782, -127.73042427003384, -125.9253990277648, -121.7632183432579, -114.47310439497232, -31.952237255871296, -76.83020535856485, -4.769450828433037, -49.42029141634703, -68.60997036099434, -27.010456286370754, -114.64049710333347, -70.8999999910593, -107.60796106606722, -29.34783084690571, -193.58539170771837, -86.18502376973629, -126.22195230424404, -55.54644265025854, -64.96014817804098, -165.9094707146287, -15.99195446074009, -101.38036344945431, -157.98075435310602, -138.18936458975077, -100.57913359999657, -84.32367600500584, -37.46105067431927, -34.71917359530926, -144.62060578167439, -92.40816526859999, -56.39088600128889, -202.36014822870493, -50.249867990612984, -119.08202660828829, -16.425322875380516, -16.170973725616932, -19.197040177881718, -30.460551984608173, 1.6183907389640808, -88.22060570120811, -92.32202617824078, -167.30506633222103, -123.42866449058056, -342.3690260052681, -75.79199296236038, -66.10343207418919, -66.61951679736376, -38.28677984327078, -9.724578812718391, -38.685969322919846, 925.8687794730067, -69.89999970793724, -10.89182873815298, -21.497947700321674, -22.79213321954012, -7.861972831189632, -110.77097401022911, -91.59712662547827, -30.024667412042618, -149.0163382589817, -12.19224450737238, -114.88539166748524, -109.10738577693701, -77.18936459720135, -71.02319089323282, -143.49827241897583, -156.12888804078102, -111.73521408438683, -109.55775382369757, -75.67571198195219, -15.860148176550865, -9.272893138229847, -13.139630950987339, -105.88846202939749, -95.2923019900918, -237.42426922917366, -94.99368016421795, -30.127566948533058, -40.44053181260824, -77.70336239039898, -73.9486103579402, -120.46412099897861, -102.36105077713728, -54.06550929695368], "episode_lengths": [309, 346, 256, 254, 222, 255, 269, 285, 229, 280, 236, 256, 226, 351, 251, 280, 272, 280, 278, 286, 222, 268, 220, 253, 244, 253, 280, 245, 276, 244, 308, 276, 283, 250, 256, 298, 235, 286, 301, 278, 273, 261, 240, 237, 297, 278, 249, 319, 244, 269, 232, 225, 226, 239, 209, 265, 272, 313, 284, 382, 262, 262, 251, 235, 221, 235, 194, 249, 224, 245, 254, 229, 271, 270, 246, 289, 226, 265, 277, 257, 264, 306, 308, 266, 278, 249, 223, 238, 225, 269, 273, 327, 266, 247, 265, 268, 270, 279, 261, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.605023851485528, "mean_inference_ms": 7.4254823466902335, "mean_action_processing_ms": 0.12300900379773844, "mean_env_wait_ms": 4.782262699171322, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 84000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 24190.288, "learn_time_ms": 20668.902, "learn_throughput": 193.527, "update_time_ms": 26.402}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 317, "training_iteration": 21, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-32-07", "timestamp": 1655555527, "time_this_iter_s": 24.240143299102783, "time_total_s": 512.404373884201, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 512.404373884201, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 28.17142857142857, "ram_util_percent": 62.37428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.506784439086914, "policy_loss": -0.12450893223285675, "vf_loss": 6.588493824005127, "vf_explained_var": 0.13927701115608215, "kl": 0.019021637737751007, "entropy": 1.7731469869613647, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 925.8687794730067, "episode_reward_min": -342.3690260052681, "episode_reward_mean": -78.63581831261516, "episode_len_mean": 264.55, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.01741614937782, -127.73042427003384, -125.9253990277648, -121.7632183432579, -114.47310439497232, -31.952237255871296, -76.83020535856485, -4.769450828433037, -49.42029141634703, -68.60997036099434, -27.010456286370754, -114.64049710333347, -70.8999999910593, -107.60796106606722, -29.34783084690571, -193.58539170771837, -86.18502376973629, -126.22195230424404, -55.54644265025854, -64.96014817804098, -165.9094707146287, -15.99195446074009, -101.38036344945431, -157.98075435310602, -138.18936458975077, -100.57913359999657, -84.32367600500584, -37.46105067431927, -34.71917359530926, -144.62060578167439, -92.40816526859999, -56.39088600128889, -202.36014822870493, -50.249867990612984, -119.08202660828829, -16.425322875380516, -16.170973725616932, -19.197040177881718, -30.460551984608173, 1.6183907389640808, -88.22060570120811, -92.32202617824078, -167.30506633222103, -123.42866449058056, -342.3690260052681, -75.79199296236038, -66.10343207418919, -66.61951679736376, -38.28677984327078, -9.724578812718391, -38.685969322919846, 925.8687794730067, -69.89999970793724, -10.89182873815298, -21.497947700321674, -22.79213321954012, -7.861972831189632, -110.77097401022911, -91.59712662547827, -30.024667412042618, -149.0163382589817, -12.19224450737238, -114.88539166748524, -109.10738577693701, -77.18936459720135, -71.02319089323282, -143.49827241897583, -156.12888804078102, -111.73521408438683, -109.55775382369757, -75.67571198195219, -15.860148176550865, -9.272893138229847, -13.139630950987339, -105.88846202939749, -95.2923019900918, -237.42426922917366, -94.99368016421795, -30.127566948533058, -40.44053181260824, -77.70336239039898, -73.9486103579402, -120.46412099897861, -102.36105077713728, -54.06550929695368, -69.67872923612595, -51.858466155827045, -126.97872920334339, -339.9853916838765, -9.16719114035368, -163.7867799848318, -150.69999987632036, -19.213943302631378, -104.18755955994129, -105.79999987781048, -135.38936448842287, -259.5378322005272, -19.942469716072083, -166.18363416939974, -113.07475640624762], "episode_lengths": [280, 272, 280, 278, 286, 222, 268, 220, 253, 244, 253, 280, 245, 276, 244, 308, 276, 283, 250, 256, 298, 235, 286, 301, 278, 273, 261, 240, 237, 297, 278, 249, 319, 244, 269, 232, 225, 226, 239, 209, 265, 272, 313, 284, 382, 262, 262, 251, 235, 221, 235, 194, 249, 224, 245, 254, 229, 271, 270, 246, 289, 226, 265, 277, 257, 264, 306, 308, 266, 278, 249, 223, 238, 225, 269, 273, 327, 266, 247, 265, 268, 270, 279, 261, 250, 257, 255, 275, 372, 230, 301, 277, 236, 278, 265, 267, 360, 240, 294, 268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6053968151056976, "mean_inference_ms": 7.421418638080495, "mean_action_processing_ms": 0.12285207597626614, "mean_env_wait_ms": 4.776940855894453, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 925.8687794730067, "episode_reward_min": -342.3690260052681, "episode_reward_mean": -78.63581831261516, "episode_len_mean": 264.55, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-99.01741614937782, -127.73042427003384, -125.9253990277648, -121.7632183432579, -114.47310439497232, -31.952237255871296, -76.83020535856485, -4.769450828433037, -49.42029141634703, -68.60997036099434, -27.010456286370754, -114.64049710333347, -70.8999999910593, -107.60796106606722, -29.34783084690571, -193.58539170771837, -86.18502376973629, -126.22195230424404, -55.54644265025854, -64.96014817804098, -165.9094707146287, -15.99195446074009, -101.38036344945431, -157.98075435310602, -138.18936458975077, -100.57913359999657, -84.32367600500584, -37.46105067431927, -34.71917359530926, -144.62060578167439, -92.40816526859999, -56.39088600128889, -202.36014822870493, -50.249867990612984, -119.08202660828829, -16.425322875380516, -16.170973725616932, -19.197040177881718, -30.460551984608173, 1.6183907389640808, -88.22060570120811, -92.32202617824078, -167.30506633222103, -123.42866449058056, -342.3690260052681, -75.79199296236038, -66.10343207418919, -66.61951679736376, -38.28677984327078, -9.724578812718391, -38.685969322919846, 925.8687794730067, -69.89999970793724, -10.89182873815298, -21.497947700321674, -22.79213321954012, -7.861972831189632, -110.77097401022911, -91.59712662547827, -30.024667412042618, -149.0163382589817, -12.19224450737238, -114.88539166748524, -109.10738577693701, -77.18936459720135, -71.02319089323282, -143.49827241897583, -156.12888804078102, -111.73521408438683, -109.55775382369757, -75.67571198195219, -15.860148176550865, -9.272893138229847, -13.139630950987339, -105.88846202939749, -95.2923019900918, -237.42426922917366, -94.99368016421795, -30.127566948533058, -40.44053181260824, -77.70336239039898, -73.9486103579402, -120.46412099897861, -102.36105077713728, -54.06550929695368, -69.67872923612595, -51.858466155827045, -126.97872920334339, -339.9853916838765, -9.16719114035368, -163.7867799848318, -150.69999987632036, -19.213943302631378, -104.18755955994129, -105.79999987781048, -135.38936448842287, -259.5378322005272, -19.942469716072083, -166.18363416939974, -113.07475640624762], "episode_lengths": [280, 272, 280, 278, 286, 222, 268, 220, 253, 244, 253, 280, 245, 276, 244, 308, 276, 283, 250, 256, 298, 235, 286, 301, 278, 273, 261, 240, 237, 297, 278, 249, 319, 244, 269, 232, 225, 226, 239, 209, 265, 272, 313, 284, 382, 262, 262, 251, 235, 221, 235, 194, 249, 224, 245, 254, 229, 271, 270, 246, 289, 226, 265, 277, 257, 264, 306, 308, 266, 278, 249, 223, 238, 225, 269, 273, 327, 266, 247, 265, 268, 270, 279, 261, 250, 257, 255, 275, 372, 230, 301, 277, 236, 278, 265, 267, 360, 240, 294, 268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6053968151056976, "mean_inference_ms": 7.421418638080495, "mean_action_processing_ms": 0.12285207597626614, "mean_env_wait_ms": 4.776940855894453, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 88000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 24178.791, "learn_time_ms": 20639.777, "learn_throughput": 193.801, "update_time_ms": 26.136}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 332, "training_iteration": 22, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-32-31", "timestamp": 1655555551, "time_this_iter_s": 24.073825120925903, "time_total_s": 536.478199005127, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 536.478199005127, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 28.59393939393939, "ram_util_percent": 62.14545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 7.198205947875977, "policy_loss": -0.12531107664108276, "vf_loss": 7.283965110778809, "vf_explained_var": 0.022568173706531525, "kl": 0.017578402534127235, "entropy": 1.762576699256897, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 925.8687794730067, "episode_reward_min": -342.3690260052681, "episode_reward_mean": -76.45753000453115, "episode_len_mean": 263.77, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-193.58539170771837, -86.18502376973629, -126.22195230424404, -55.54644265025854, -64.96014817804098, -165.9094707146287, -15.99195446074009, -101.38036344945431, -157.98075435310602, -138.18936458975077, -100.57913359999657, -84.32367600500584, -37.46105067431927, -34.71917359530926, -144.62060578167439, -92.40816526859999, -56.39088600128889, -202.36014822870493, -50.249867990612984, -119.08202660828829, -16.425322875380516, -16.170973725616932, -19.197040177881718, -30.460551984608173, 1.6183907389640808, -88.22060570120811, -92.32202617824078, -167.30506633222103, -123.42866449058056, -342.3690260052681, -75.79199296236038, -66.10343207418919, -66.61951679736376, -38.28677984327078, -9.724578812718391, -38.685969322919846, 925.8687794730067, -69.89999970793724, -10.89182873815298, -21.497947700321674, -22.79213321954012, -7.861972831189632, -110.77097401022911, -91.59712662547827, -30.024667412042618, -149.0163382589817, -12.19224450737238, -114.88539166748524, -109.10738577693701, -77.18936459720135, -71.02319089323282, -143.49827241897583, -156.12888804078102, -111.73521408438683, -109.55775382369757, -75.67571198195219, -15.860148176550865, -9.272893138229847, -13.139630950987339, -105.88846202939749, -95.2923019900918, -237.42426922917366, -94.99368016421795, -30.127566948533058, -40.44053181260824, -77.70336239039898, -73.9486103579402, -120.46412099897861, -102.36105077713728, -54.06550929695368, -69.67872923612595, -51.858466155827045, -126.97872920334339, -339.9853916838765, -9.16719114035368, -163.7867799848318, -150.69999987632036, -19.213943302631378, -104.18755955994129, -105.79999987781048, -135.38936448842287, -259.5378322005272, -19.942469716072083, -166.18363416939974, -113.07475640624762, -37.51970386505127, -23.721994005143642, -71.46719130128622, -263.31722620129585, -47.777525290846825, -43.77872931957245, -42.04266016930342, -54.16504695266485, -38.54783075302839, 7.875323079526424, -71.29765649884939, -98.61007896065712, -53.49223876744509, -23.432316541671753, -90.87475634366274], "episode_lengths": [308, 276, 283, 250, 256, 298, 235, 286, 301, 278, 273, 261, 240, 237, 297, 278, 249, 319, 244, 269, 232, 225, 226, 239, 209, 265, 272, 313, 284, 382, 262, 262, 251, 235, 221, 235, 194, 249, 224, 245, 254, 229, 271, 270, 246, 289, 226, 265, 277, 257, 264, 306, 308, 266, 278, 249, 223, 238, 225, 269, 273, 327, 266, 247, 265, 268, 270, 279, 261, 250, 257, 255, 275, 372, 230, 301, 277, 236, 278, 265, 267, 360, 240, 294, 268, 244, 230, 260, 349, 245, 240, 245, 251, 248, 222, 266, 275, 254, 233, 261]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6054138295080279, "mean_inference_ms": 7.418642182995877, "mean_action_processing_ms": 0.12272429722294724, "mean_env_wait_ms": 4.775317473627206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 925.8687794730067, "episode_reward_min": -342.3690260052681, "episode_reward_mean": -76.45753000453115, "episode_len_mean": 263.77, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-193.58539170771837, -86.18502376973629, -126.22195230424404, -55.54644265025854, -64.96014817804098, -165.9094707146287, -15.99195446074009, -101.38036344945431, -157.98075435310602, -138.18936458975077, -100.57913359999657, -84.32367600500584, -37.46105067431927, -34.71917359530926, -144.62060578167439, -92.40816526859999, -56.39088600128889, -202.36014822870493, -50.249867990612984, -119.08202660828829, -16.425322875380516, -16.170973725616932, -19.197040177881718, -30.460551984608173, 1.6183907389640808, -88.22060570120811, -92.32202617824078, -167.30506633222103, -123.42866449058056, -342.3690260052681, -75.79199296236038, -66.10343207418919, -66.61951679736376, -38.28677984327078, -9.724578812718391, -38.685969322919846, 925.8687794730067, -69.89999970793724, -10.89182873815298, -21.497947700321674, -22.79213321954012, -7.861972831189632, -110.77097401022911, -91.59712662547827, -30.024667412042618, -149.0163382589817, -12.19224450737238, -114.88539166748524, -109.10738577693701, -77.18936459720135, -71.02319089323282, -143.49827241897583, -156.12888804078102, -111.73521408438683, -109.55775382369757, -75.67571198195219, -15.860148176550865, -9.272893138229847, -13.139630950987339, -105.88846202939749, -95.2923019900918, -237.42426922917366, -94.99368016421795, -30.127566948533058, -40.44053181260824, -77.70336239039898, -73.9486103579402, -120.46412099897861, -102.36105077713728, -54.06550929695368, -69.67872923612595, -51.858466155827045, -126.97872920334339, -339.9853916838765, -9.16719114035368, -163.7867799848318, -150.69999987632036, -19.213943302631378, -104.18755955994129, -105.79999987781048, -135.38936448842287, -259.5378322005272, -19.942469716072083, -166.18363416939974, -113.07475640624762, -37.51970386505127, -23.721994005143642, -71.46719130128622, -263.31722620129585, -47.777525290846825, -43.77872931957245, -42.04266016930342, -54.16504695266485, -38.54783075302839, 7.875323079526424, -71.29765649884939, -98.61007896065712, -53.49223876744509, -23.432316541671753, -90.87475634366274], "episode_lengths": [308, 276, 283, 250, 256, 298, 235, 286, 301, 278, 273, 261, 240, 237, 297, 278, 249, 319, 244, 269, 232, 225, 226, 239, 209, 265, 272, 313, 284, 382, 262, 262, 251, 235, 221, 235, 194, 249, 224, 245, 254, 229, 271, 270, 246, 289, 226, 265, 277, 257, 264, 306, 308, 266, 278, 249, 223, 238, 225, 269, 273, 327, 266, 247, 265, 268, 270, 279, 261, 250, 257, 255, 275, 372, 230, 301, 277, 236, 278, 265, 267, 360, 240, 294, 268, 244, 230, 260, 349, 245, 240, 245, 251, 248, 222, 266, 275, 254, 233, 261]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6054138295080279, "mean_inference_ms": 7.418642182995877, "mean_action_processing_ms": 0.12272429722294724, "mean_env_wait_ms": 4.775317473627206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 92000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 24165.493, "learn_time_ms": 20608.685, "learn_throughput": 194.093, "update_time_ms": 26.238}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 347, "training_iteration": 23, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-32-55", "timestamp": 1655555575, "time_this_iter_s": 24.183345794677734, "time_total_s": 560.6615447998047, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 560.6615447998047, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 27.76470588235294, "ram_util_percent": 62.03235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 5.892988681793213, "policy_loss": -0.12327876687049866, "vf_loss": 5.977450847625732, "vf_explained_var": 0.09022871404886246, "kl": 0.017252186313271523, "entropy": 1.7556184530258179, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 925.8687794730067, "episode_reward_min": -342.3690260052681, "episode_reward_mean": -74.503255770877, "episode_len_mean": 262.54, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-92.40816526859999, -56.39088600128889, -202.36014822870493, -50.249867990612984, -119.08202660828829, -16.425322875380516, -16.170973725616932, -19.197040177881718, -30.460551984608173, 1.6183907389640808, -88.22060570120811, -92.32202617824078, -167.30506633222103, -123.42866449058056, -342.3690260052681, -75.79199296236038, -66.10343207418919, -66.61951679736376, -38.28677984327078, -9.724578812718391, -38.685969322919846, 925.8687794730067, -69.89999970793724, -10.89182873815298, -21.497947700321674, -22.79213321954012, -7.861972831189632, -110.77097401022911, -91.59712662547827, -30.024667412042618, -149.0163382589817, -12.19224450737238, -114.88539166748524, -109.10738577693701, -77.18936459720135, -71.02319089323282, -143.49827241897583, -156.12888804078102, -111.73521408438683, -109.55775382369757, -75.67571198195219, -15.860148176550865, -9.272893138229847, -13.139630950987339, -105.88846202939749, -95.2923019900918, -237.42426922917366, -94.99368016421795, -30.127566948533058, -40.44053181260824, -77.70336239039898, -73.9486103579402, -120.46412099897861, -102.36105077713728, -54.06550929695368, -69.67872923612595, -51.858466155827045, -126.97872920334339, -339.9853916838765, -9.16719114035368, -163.7867799848318, -150.69999987632036, -19.213943302631378, -104.18755955994129, -105.79999987781048, -135.38936448842287, -259.5378322005272, -19.942469716072083, -166.18363416939974, -113.07475640624762, -37.51970386505127, -23.721994005143642, -71.46719130128622, -263.31722620129585, -47.777525290846825, -43.77872931957245, -42.04266016930342, -54.16504695266485, -38.54783075302839, 7.875323079526424, -71.29765649884939, -98.61007896065712, -53.49223876744509, -23.432316541671753, -90.87475634366274, -93.23853804171085, -179.04246973246336, -59.69999971240759, -52.44562242925167, -56.89779528975487, -180.38936458528042, -40.73521416634321, -60.400000154972076, -31.216823399066925, -258.9799722209573, -159.21210530400276, -17.942239709198475, -50.15501347929239, -17.21345815807581, -54.65846608579159], "episode_lengths": [278, 249, 319, 244, 269, 232, 225, 226, 239, 209, 265, 272, 313, 284, 382, 262, 262, 251, 235, 221, 235, 194, 249, 224, 245, 254, 229, 271, 270, 246, 289, 226, 265, 277, 257, 264, 306, 308, 266, 278, 249, 223, 238, 225, 269, 273, 327, 266, 247, 265, 268, 270, 279, 261, 250, 257, 255, 275, 372, 230, 301, 277, 236, 278, 265, 267, 360, 240, 294, 268, 244, 230, 260, 349, 245, 240, 245, 251, 248, 222, 266, 275, 254, 233, 261, 281, 315, 243, 249, 254, 292, 241, 254, 231, 341, 302, 236, 243, 228, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6043978017938871, "mean_inference_ms": 7.413113964957145, "mean_action_processing_ms": 0.12269680907262659, "mean_env_wait_ms": 4.777008173815082, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 925.8687794730067, "episode_reward_min": -342.3690260052681, "episode_reward_mean": -74.503255770877, "episode_len_mean": 262.54, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-92.40816526859999, -56.39088600128889, -202.36014822870493, -50.249867990612984, -119.08202660828829, -16.425322875380516, -16.170973725616932, -19.197040177881718, -30.460551984608173, 1.6183907389640808, -88.22060570120811, -92.32202617824078, -167.30506633222103, -123.42866449058056, -342.3690260052681, -75.79199296236038, -66.10343207418919, -66.61951679736376, -38.28677984327078, -9.724578812718391, -38.685969322919846, 925.8687794730067, -69.89999970793724, -10.89182873815298, -21.497947700321674, -22.79213321954012, -7.861972831189632, -110.77097401022911, -91.59712662547827, -30.024667412042618, -149.0163382589817, -12.19224450737238, -114.88539166748524, -109.10738577693701, -77.18936459720135, -71.02319089323282, -143.49827241897583, -156.12888804078102, -111.73521408438683, -109.55775382369757, -75.67571198195219, -15.860148176550865, -9.272893138229847, -13.139630950987339, -105.88846202939749, -95.2923019900918, -237.42426922917366, -94.99368016421795, -30.127566948533058, -40.44053181260824, -77.70336239039898, -73.9486103579402, -120.46412099897861, -102.36105077713728, -54.06550929695368, -69.67872923612595, -51.858466155827045, -126.97872920334339, -339.9853916838765, -9.16719114035368, -163.7867799848318, -150.69999987632036, -19.213943302631378, -104.18755955994129, -105.79999987781048, -135.38936448842287, -259.5378322005272, -19.942469716072083, -166.18363416939974, -113.07475640624762, -37.51970386505127, -23.721994005143642, -71.46719130128622, -263.31722620129585, -47.777525290846825, -43.77872931957245, -42.04266016930342, -54.16504695266485, -38.54783075302839, 7.875323079526424, -71.29765649884939, -98.61007896065712, -53.49223876744509, -23.432316541671753, -90.87475634366274, -93.23853804171085, -179.04246973246336, -59.69999971240759, -52.44562242925167, -56.89779528975487, -180.38936458528042, -40.73521416634321, -60.400000154972076, -31.216823399066925, -258.9799722209573, -159.21210530400276, -17.942239709198475, -50.15501347929239, -17.21345815807581, -54.65846608579159], "episode_lengths": [278, 249, 319, 244, 269, 232, 225, 226, 239, 209, 265, 272, 313, 284, 382, 262, 262, 251, 235, 221, 235, 194, 249, 224, 245, 254, 229, 271, 270, 246, 289, 226, 265, 277, 257, 264, 306, 308, 266, 278, 249, 223, 238, 225, 269, 273, 327, 266, 247, 265, 268, 270, 279, 261, 250, 257, 255, 275, 372, 230, 301, 277, 236, 278, 265, 267, 360, 240, 294, 268, 244, 230, 260, 349, 245, 240, 245, 251, 248, 222, 266, 275, 254, 233, 261, 281, 315, 243, 249, 254, 292, 241, 254, 231, 341, 302, 236, 243, 228, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6043978017938871, "mean_inference_ms": 7.413113964957145, "mean_action_processing_ms": 0.12269680907262659, "mean_env_wait_ms": 4.777008173815082, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 96000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 24166.114, "learn_time_ms": 20609.529, "learn_throughput": 194.085, "update_time_ms": 26.238}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 362, "training_iteration": 24, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-33-20", "timestamp": 1655555600, "time_this_iter_s": 24.31475043296814, "time_total_s": 584.9762952327728, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 584.9762952327728, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 28.65714285714286, "ram_util_percent": 62.08571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.488178730010986, "policy_loss": -0.027461901307106018, "vf_loss": 6.5045061111450195, "vf_explained_var": 0.016095107421278954, "kl": 0.004948904272168875, "entropy": 1.779739499092102, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 285.7142857142857}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 935.8388123735785, "episode_reward_min": -339.9853916838765, "episode_reward_mean": -58.53175297766924, "episode_len_mean": 259.18, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-66.10343207418919, -66.61951679736376, -38.28677984327078, -9.724578812718391, -38.685969322919846, 925.8687794730067, -69.89999970793724, -10.89182873815298, -21.497947700321674, -22.79213321954012, -7.861972831189632, -110.77097401022911, -91.59712662547827, -30.024667412042618, -149.0163382589817, -12.19224450737238, -114.88539166748524, -109.10738577693701, -77.18936459720135, -71.02319089323282, -143.49827241897583, -156.12888804078102, -111.73521408438683, -109.55775382369757, -75.67571198195219, -15.860148176550865, -9.272893138229847, -13.139630950987339, -105.88846202939749, -95.2923019900918, -237.42426922917366, -94.99368016421795, -30.127566948533058, -40.44053181260824, -77.70336239039898, -73.9486103579402, -120.46412099897861, -102.36105077713728, -54.06550929695368, -69.67872923612595, -51.858466155827045, -126.97872920334339, -339.9853916838765, -9.16719114035368, -163.7867799848318, -150.69999987632036, -19.213943302631378, -104.18755955994129, -105.79999987781048, -135.38936448842287, -259.5378322005272, -19.942469716072083, -166.18363416939974, -113.07475640624762, -37.51970386505127, -23.721994005143642, -71.46719130128622, -263.31722620129585, -47.777525290846825, -43.77872931957245, -42.04266016930342, -54.16504695266485, -38.54783075302839, 7.875323079526424, -71.29765649884939, -98.61007896065712, -53.49223876744509, -23.432316541671753, -90.87475634366274, -93.23853804171085, -179.04246973246336, -59.69999971240759, -52.44562242925167, -56.89779528975487, -180.38936458528042, -40.73521416634321, -60.400000154972076, -31.216823399066925, -258.9799722209573, -159.21210530400276, -17.942239709198475, -50.15501347929239, -17.21345815807581, -54.65846608579159, -34.70309688895941, -68.30000022798777, -107.23663191497326, -44.989364475011826, -84.96679939329624, -18.174177832901478, 935.8388123735785, -122.58358668535948, -72.17168600857258, -35.65041537582874, -20.86550921201706, -11.116823352873325, -88.98936440050602, -23.814963072538376, -40.878729321062565, -54.81135868281126], "episode_lengths": [262, 251, 235, 221, 235, 194, 249, 224, 245, 254, 229, 271, 270, 246, 289, 226, 265, 277, 257, 264, 306, 308, 266, 278, 249, 223, 238, 225, 269, 273, 327, 266, 247, 265, 268, 270, 279, 261, 250, 257, 255, 275, 372, 230, 301, 277, 236, 278, 265, 267, 360, 240, 294, 268, 244, 230, 260, 349, 245, 240, 245, 251, 248, 222, 266, 275, 254, 233, 261, 281, 315, 243, 249, 254, 292, 241, 254, 231, 341, 302, 236, 243, 228, 246, 238, 251, 280, 223, 264, 244, 257, 274, 245, 227, 231, 224, 265, 234, 233, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.60472139225951, "mean_inference_ms": 7.413764881293936, "mean_action_processing_ms": 0.12258211781559884, "mean_env_wait_ms": 4.77872769103373, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 935.8388123735785, "episode_reward_min": -339.9853916838765, "episode_reward_mean": -58.53175297766924, "episode_len_mean": 259.18, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-66.10343207418919, -66.61951679736376, -38.28677984327078, -9.724578812718391, -38.685969322919846, 925.8687794730067, -69.89999970793724, -10.89182873815298, -21.497947700321674, -22.79213321954012, -7.861972831189632, -110.77097401022911, -91.59712662547827, -30.024667412042618, -149.0163382589817, -12.19224450737238, -114.88539166748524, -109.10738577693701, -77.18936459720135, -71.02319089323282, -143.49827241897583, -156.12888804078102, -111.73521408438683, -109.55775382369757, -75.67571198195219, -15.860148176550865, -9.272893138229847, -13.139630950987339, -105.88846202939749, -95.2923019900918, -237.42426922917366, -94.99368016421795, -30.127566948533058, -40.44053181260824, -77.70336239039898, -73.9486103579402, -120.46412099897861, -102.36105077713728, -54.06550929695368, -69.67872923612595, -51.858466155827045, -126.97872920334339, -339.9853916838765, -9.16719114035368, -163.7867799848318, -150.69999987632036, -19.213943302631378, -104.18755955994129, -105.79999987781048, -135.38936448842287, -259.5378322005272, -19.942469716072083, -166.18363416939974, -113.07475640624762, -37.51970386505127, -23.721994005143642, -71.46719130128622, -263.31722620129585, -47.777525290846825, -43.77872931957245, -42.04266016930342, -54.16504695266485, -38.54783075302839, 7.875323079526424, -71.29765649884939, -98.61007896065712, -53.49223876744509, -23.432316541671753, -90.87475634366274, -93.23853804171085, -179.04246973246336, -59.69999971240759, -52.44562242925167, -56.89779528975487, -180.38936458528042, -40.73521416634321, -60.400000154972076, -31.216823399066925, -258.9799722209573, -159.21210530400276, -17.942239709198475, -50.15501347929239, -17.21345815807581, -54.65846608579159, -34.70309688895941, -68.30000022798777, -107.23663191497326, -44.989364475011826, -84.96679939329624, -18.174177832901478, 935.8388123735785, -122.58358668535948, -72.17168600857258, -35.65041537582874, -20.86550921201706, -11.116823352873325, -88.98936440050602, -23.814963072538376, -40.878729321062565, -54.81135868281126], "episode_lengths": [262, 251, 235, 221, 235, 194, 249, 224, 245, 254, 229, 271, 270, 246, 289, 226, 265, 277, 257, 264, 306, 308, 266, 278, 249, 223, 238, 225, 269, 273, 327, 266, 247, 265, 268, 270, 279, 261, 250, 257, 255, 275, 372, 230, 301, 277, 236, 278, 265, 267, 360, 240, 294, 268, 244, 230, 260, 349, 245, 240, 245, 251, 248, 222, 266, 275, 254, 233, 261, 281, 315, 243, 249, 254, 292, 241, 254, 231, 341, 302, 236, 243, 228, 246, 238, 251, 280, 223, 264, 244, 257, 274, 245, 227, 231, 224, 265, 234, 233, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.60472139225951, "mean_inference_ms": 7.413764881293936, "mean_action_processing_ms": 0.12258211781559884, "mean_env_wait_ms": 4.77872769103373, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 100000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 24117.291, "learn_time_ms": 20567.403, "learn_throughput": 194.483, "update_time_ms": 26.537}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "episodes_total": 378, "training_iteration": 25, "trial_id": "7dfca_00005", "experiment_id": "967a5f30f4f94e9e9f25a1b015292a39", "date": "2022-06-18_15-33-44", "timestamp": 1655555624, "time_this_iter_s": 24.002320766448975, "time_total_s": 608.9786159992218, "pid": 29956, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 300, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 608.9786159992218, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 15.495591402053833, "perf": {"cpu_util_percent": 29.906060606060606, "ram_util_percent": 62.054545454545455}}
