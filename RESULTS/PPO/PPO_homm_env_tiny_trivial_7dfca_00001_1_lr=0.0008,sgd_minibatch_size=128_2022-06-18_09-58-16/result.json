{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0, "cur_lr": 0.0007999999797903001, "total_loss": 7.56952428817749, "policy_loss": -0.01482305396348238, "vf_loss": 7.58049201965332, "vf_explained_var": 0.01281594019383192, "kl": 0.0038550435565412045, "entropy": 2.075695753097534, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 978.418315589428, "episode_reward_min": -59.20000001788139, "episode_reward_mean": 52.86211262022456, "episode_len_mean": 221.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.350900657474995, 978.418315589428, -14.43665561825037, -57.667686231434345, -58.78202662616968, -59.20000001788139, -31.35775386542082, -38.20000007748604, 2.408862993121147, -18.709628149867058, 12.333293907344341, -48.11046980321407], "episode_lengths": [245, 62, 238, 245, 241, 242, 238, 227, 220, 232, 213, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6042765589507612, "mean_inference_ms": 7.131729467931496, "mean_action_processing_ms": 0.1141518393994011, "mean_env_wait_ms": 4.889121726847898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 978.418315589428, "episode_reward_min": -59.20000001788139, "episode_reward_mean": 52.86211262022456, "episode_len_mean": 221.0, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32.350900657474995, 978.418315589428, -14.43665561825037, -57.667686231434345, -58.78202662616968, -59.20000001788139, -31.35775386542082, -38.20000007748604, 2.408862993121147, -18.709628149867058, 12.333293907344341, -48.11046980321407], "episode_lengths": [245, 62, 238, 245, 241, 242, 238, 227, 220, 232, 213, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6042765589507612, "mean_inference_ms": 7.131729467931496, "mean_action_processing_ms": 0.1141518393994011, "mean_env_wait_ms": 4.889121726847898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 41800.671, "learn_time_ms": 38155.432, "learn_throughput": 104.834, "update_time_ms": 28.971}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 12, "training_iteration": 1, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_09-59-24", "timestamp": 1655535564, "time_this_iter_s": 41.81266403198242, "time_total_s": 41.81266403198242, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 41.81266403198242, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 19.884745762711866, "ram_util_percent": 62.33220338983052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.5, "cur_lr": 0.0007999999797903001, "total_loss": 7.529829025268555, "policy_loss": -0.05032915994524956, "vf_loss": 7.566808223724365, "vf_explained_var": -0.026369264349341393, "kl": 0.026699639856815338, "entropy": 2.0500500202178955, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 978.418315589428, "episode_reward_min": -109.98307110369205, "episode_reward_mean": -9.000074333338826, "episode_len_mean": 236.8148148148148, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.350900657474995, 978.418315589428, -14.43665561825037, -57.667686231434345, -58.78202662616968, -59.20000001788139, -31.35775386542082, -38.20000007748604, 2.408862993121147, -18.709628149867058, 12.333293907344341, -48.11046980321407, -57.549512915313244, -15.627254776656628, -29.68160919100046, -54.66704856604338, -107.90511903911829, 12.100179314613342, -60.64657287299633, -83.40357530117035, -58.37168608605862, -20.52319110184908, -89.47412467747927, -73.10907270014286, -66.1787291020155, -62.32697032392025, -109.98307110369205], "episode_lengths": [245, 62, 238, 245, 241, 242, 238, 227, 220, 232, 213, 249, 256, 229, 232, 252, 278, 227, 255, 241, 247, 226, 259, 259, 253, 251, 277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6040290684773024, "mean_inference_ms": 7.235379096431651, "mean_action_processing_ms": 0.11798851221940056, "mean_env_wait_ms": 4.998810011684971, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 978.418315589428, "episode_reward_min": -109.98307110369205, "episode_reward_mean": -9.000074333338826, "episode_len_mean": 236.8148148148148, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32.350900657474995, 978.418315589428, -14.43665561825037, -57.667686231434345, -58.78202662616968, -59.20000001788139, -31.35775386542082, -38.20000007748604, 2.408862993121147, -18.709628149867058, 12.333293907344341, -48.11046980321407, -57.549512915313244, -15.627254776656628, -29.68160919100046, -54.66704856604338, -107.90511903911829, 12.100179314613342, -60.64657287299633, -83.40357530117035, -58.37168608605862, -20.52319110184908, -89.47412467747927, -73.10907270014286, -66.1787291020155, -62.32697032392025, -109.98307110369205], "episode_lengths": [245, 62, 238, 245, 241, 242, 238, 227, 220, 232, 213, 249, 256, 229, 232, 252, 278, 227, 255, 241, 247, 226, 259, 259, 253, 251, 277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6040290684773024, "mean_inference_ms": 7.235379096431651, "mean_action_processing_ms": 0.11798851221940056, "mean_env_wait_ms": 4.998810011684971, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 41947.559, "learn_time_ms": 38255.824, "learn_throughput": 104.559, "update_time_ms": 28.478}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 27, "training_iteration": 2, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-00-06", "timestamp": 1655535606, "time_this_iter_s": 42.10444164276123, "time_total_s": 83.91710567474365, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 83.91710567474365, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 20.337288135593226, "ram_util_percent": 62.452542372881354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.75, "cur_lr": 0.0007999999797903001, "total_loss": 7.401566505432129, "policy_loss": -0.05924900248646736, "vf_loss": 7.443348407745361, "vf_explained_var": 0.027329925447702408, "kl": 0.02329072169959545, "entropy": 2.033496856689453, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 978.418315589428, "episode_reward_min": -154.19536235183477, "episode_reward_mean": -32.106468339518806, "episode_len_mean": 242.41463414634146, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.350900657474995, 978.418315589428, -14.43665561825037, -57.667686231434345, -58.78202662616968, -59.20000001788139, -31.35775386542082, -38.20000007748604, 2.408862993121147, -18.709628149867058, 12.333293907344341, -48.11046980321407, -57.549512915313244, -15.627254776656628, -29.68160919100046, -54.66704856604338, -107.90511903911829, 12.100179314613342, -60.64657287299633, -83.40357530117035, -58.37168608605862, -20.52319110184908, -89.47412467747927, -73.10907270014286, -66.1787291020155, -62.32697032392025, -109.98307110369205, -48.07168620824814, -112.52921662479639, -66.35077065974474, -40.023676201701164, -126.38539176434278, -87.39486277848482, -154.19536235183477, -41.47168616205454, -43.116823330521584, -102.9742713496089, -74.95696409791708, -71.6893644630909, -42.76790485531092, -61.4352140724659], "episode_lengths": [245, 62, 238, 245, 241, 242, 238, 227, 220, 232, 213, 249, 256, 229, 232, 252, 278, 227, 255, 241, 247, 226, 259, 259, 253, 251, 277, 237, 275, 250, 236, 264, 260, 297, 227, 242, 265, 261, 253, 241, 237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5965937175177041, "mean_inference_ms": 7.23740013031195, "mean_action_processing_ms": 0.11863565905587144, "mean_env_wait_ms": 4.951950094041421, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 978.418315589428, "episode_reward_min": -154.19536235183477, "episode_reward_mean": -32.106468339518806, "episode_len_mean": 242.41463414634146, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32.350900657474995, 978.418315589428, -14.43665561825037, -57.667686231434345, -58.78202662616968, -59.20000001788139, -31.35775386542082, -38.20000007748604, 2.408862993121147, -18.709628149867058, 12.333293907344341, -48.11046980321407, -57.549512915313244, -15.627254776656628, -29.68160919100046, -54.66704856604338, -107.90511903911829, 12.100179314613342, -60.64657287299633, -83.40357530117035, -58.37168608605862, -20.52319110184908, -89.47412467747927, -73.10907270014286, -66.1787291020155, -62.32697032392025, -109.98307110369205, -48.07168620824814, -112.52921662479639, -66.35077065974474, -40.023676201701164, -126.38539176434278, -87.39486277848482, -154.19536235183477, -41.47168616205454, -43.116823330521584, -102.9742713496089, -74.95696409791708, -71.6893644630909, -42.76790485531092, -61.4352140724659], "episode_lengths": [245, 62, 238, 245, 241, 242, 238, 227, 220, 232, 213, 249, 256, 229, 232, 252, 278, 227, 255, 241, 247, 226, 259, 259, 253, 251, 277, 237, 275, 250, 236, 264, 260, 297, 227, 242, 265, 261, 253, 241, 237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5965937175177041, "mean_inference_ms": 7.23740013031195, "mean_action_processing_ms": 0.11863565905587144, "mean_env_wait_ms": 4.951950094041421, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 41768.924, "learn_time_ms": 38165.641, "learn_throughput": 104.806, "update_time_ms": 28.314}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 41, "training_iteration": 3, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-00-48", "timestamp": 1655535648, "time_this_iter_s": 41.42164921760559, "time_total_s": 125.33875489234924, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 125.33875489234924, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 20.298275862068966, "ram_util_percent": 62.68103448275862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.125, "cur_lr": 0.0007999999797903001, "total_loss": 8.072175025939941, "policy_loss": -0.05669233947992325, "vf_loss": 8.107593536376953, "vf_explained_var": -0.007907493971288204, "kl": 0.01890999637544155, "entropy": 2.020761728286743, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 978.418315589428, "episode_reward_min": -202.09999991208315, "episode_reward_mean": -43.105150898345386, "episode_len_mean": 246.30769230769232, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.350900657474995, 978.418315589428, -14.43665561825037, -57.667686231434345, -58.78202662616968, -59.20000001788139, -31.35775386542082, -38.20000007748604, 2.408862993121147, -18.709628149867058, 12.333293907344341, -48.11046980321407, -57.549512915313244, -15.627254776656628, -29.68160919100046, -54.66704856604338, -107.90511903911829, 12.100179314613342, -60.64657287299633, -83.40357530117035, -58.37168608605862, -20.52319110184908, -89.47412467747927, -73.10907270014286, -66.1787291020155, -62.32697032392025, -109.98307110369205, -48.07168620824814, -112.52921662479639, -66.35077065974474, -40.023676201701164, -126.38539176434278, -87.39486277848482, -154.19536235183477, -41.47168616205454, -43.116823330521584, -102.9742713496089, -74.95696409791708, -71.6893644630909, -42.76790485531092, -61.4352140724659, -14.81476666033268, -60.12498151510954, -37.16014812886715, -110.84825482219458, -81.94224064797163, -53.943372286856174, -93.27000880241394, -85.40116441994905, -98.0083429068327, -202.09999991208315, -87.48936469107866], "episode_lengths": [245, 62, 238, 245, 241, 242, 238, 227, 220, 232, 213, 249, 256, 229, 232, 252, 278, 227, 255, 241, 247, 226, 259, 259, 253, 251, 277, 237, 275, 250, 236, 264, 260, 297, 227, 242, 265, 261, 253, 241, 237, 229, 255, 241, 283, 258, 248, 263, 270, 258, 308, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5888487788217955, "mean_inference_ms": 7.236244264209296, "mean_action_processing_ms": 0.11812525794305057, "mean_env_wait_ms": 4.903311825456088, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 978.418315589428, "episode_reward_min": -202.09999991208315, "episode_reward_mean": -43.105150898345386, "episode_len_mean": 246.30769230769232, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32.350900657474995, 978.418315589428, -14.43665561825037, -57.667686231434345, -58.78202662616968, -59.20000001788139, -31.35775386542082, -38.20000007748604, 2.408862993121147, -18.709628149867058, 12.333293907344341, -48.11046980321407, -57.549512915313244, -15.627254776656628, -29.68160919100046, -54.66704856604338, -107.90511903911829, 12.100179314613342, -60.64657287299633, -83.40357530117035, -58.37168608605862, -20.52319110184908, -89.47412467747927, -73.10907270014286, -66.1787291020155, -62.32697032392025, -109.98307110369205, -48.07168620824814, -112.52921662479639, -66.35077065974474, -40.023676201701164, -126.38539176434278, -87.39486277848482, -154.19536235183477, -41.47168616205454, -43.116823330521584, -102.9742713496089, -74.95696409791708, -71.6893644630909, -42.76790485531092, -61.4352140724659, -14.81476666033268, -60.12498151510954, -37.16014812886715, -110.84825482219458, -81.94224064797163, -53.943372286856174, -93.27000880241394, -85.40116441994905, -98.0083429068327, -202.09999991208315, -87.48936469107866], "episode_lengths": [245, 62, 238, 245, 241, 242, 238, 227, 220, 232, 213, 249, 256, 229, 232, 252, 278, 227, 255, 241, 247, 226, 259, 259, 253, 251, 277, 237, 275, 250, 236, 264, 260, 297, 227, 242, 265, 261, 253, 241, 237, 229, 255, 241, 283, 258, 248, 263, 270, 258, 308, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5888487788217955, "mean_inference_ms": 7.236244264209296, "mean_action_processing_ms": 0.11812525794305057, "mean_env_wait_ms": 4.903311825456088, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 41651.174, "learn_time_ms": 38113.366, "learn_throughput": 104.95, "update_time_ms": 28.477}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 52, "training_iteration": 4, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-01-29", "timestamp": 1655535689, "time_this_iter_s": 41.30891990661621, "time_total_s": 166.64767479896545, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 166.64767479896545, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 19.070689655172416, "ram_util_percent": 62.63965517241378}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.125, "cur_lr": 0.0007999999797903001, "total_loss": 7.073071479797363, "policy_loss": -0.0812591016292572, "vf_loss": 7.129418849945068, "vf_explained_var": 0.09127096831798553, "kl": 0.02214348502457142, "entropy": 2.000633955001831, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 978.418315589428, "episode_reward_min": -210.33778458088636, "episode_reward_mean": -54.50697636787874, "episode_len_mean": 250.15942028985506, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.350900657474995, 978.418315589428, -14.43665561825037, -57.667686231434345, -58.78202662616968, -59.20000001788139, -31.35775386542082, -38.20000007748604, 2.408862993121147, -18.709628149867058, 12.333293907344341, -48.11046980321407, -57.549512915313244, -15.627254776656628, -29.68160919100046, -54.66704856604338, -107.90511903911829, 12.100179314613342, -60.64657287299633, -83.40357530117035, -58.37168608605862, -20.52319110184908, -89.47412467747927, -73.10907270014286, -66.1787291020155, -62.32697032392025, -109.98307110369205, -48.07168620824814, -112.52921662479639, -66.35077065974474, -40.023676201701164, -126.38539176434278, -87.39486277848482, -154.19536235183477, -41.47168616205454, -43.116823330521584, -102.9742713496089, -74.95696409791708, -71.6893644630909, -42.76790485531092, -61.4352140724659, -14.81476666033268, -60.12498151510954, -37.16014812886715, -110.84825482219458, -81.94224064797163, -53.943372286856174, -93.27000880241394, -85.40116441994905, -98.0083429068327, -202.09999991208315, -87.48936469107866, -34.47872916609049, -133.75762003660202, -28.170071810483932, -100.6639306396246, -135.5000001117587, -123.69909754395485, -47.908773973584175, -123.29603060334921, -210.33778458088636, -1.4333526715636253, -113.98936446011066, -120.87427113950253, -94.5922444164753, -24.768093816936016, -93.96412106603384, -96.38514436781406, -35.69489226490259], "episode_lengths": [245, 62, 238, 245, 241, 242, 238, 227, 220, 232, 213, 249, 256, 229, 232, 252, 278, 227, 255, 241, 247, 226, 259, 259, 253, 251, 277, 237, 275, 250, 236, 264, 260, 297, 227, 242, 265, 261, 253, 241, 237, 229, 255, 241, 283, 258, 248, 263, 270, 258, 308, 256, 233, 284, 241, 269, 277, 282, 243, 287, 314, 224, 267, 273, 258, 230, 261, 269, 241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5809939307362313, "mean_inference_ms": 7.2371274514453985, "mean_action_processing_ms": 0.11844800482664307, "mean_env_wait_ms": 4.856053668458128, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 978.418315589428, "episode_reward_min": -210.33778458088636, "episode_reward_mean": -54.50697636787874, "episode_len_mean": 250.15942028985506, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32.350900657474995, 978.418315589428, -14.43665561825037, -57.667686231434345, -58.78202662616968, -59.20000001788139, -31.35775386542082, -38.20000007748604, 2.408862993121147, -18.709628149867058, 12.333293907344341, -48.11046980321407, -57.549512915313244, -15.627254776656628, -29.68160919100046, -54.66704856604338, -107.90511903911829, 12.100179314613342, -60.64657287299633, -83.40357530117035, -58.37168608605862, -20.52319110184908, -89.47412467747927, -73.10907270014286, -66.1787291020155, -62.32697032392025, -109.98307110369205, -48.07168620824814, -112.52921662479639, -66.35077065974474, -40.023676201701164, -126.38539176434278, -87.39486277848482, -154.19536235183477, -41.47168616205454, -43.116823330521584, -102.9742713496089, -74.95696409791708, -71.6893644630909, -42.76790485531092, -61.4352140724659, -14.81476666033268, -60.12498151510954, -37.16014812886715, -110.84825482219458, -81.94224064797163, -53.943372286856174, -93.27000880241394, -85.40116441994905, -98.0083429068327, -202.09999991208315, -87.48936469107866, -34.47872916609049, -133.75762003660202, -28.170071810483932, -100.6639306396246, -135.5000001117587, -123.69909754395485, -47.908773973584175, -123.29603060334921, -210.33778458088636, -1.4333526715636253, -113.98936446011066, -120.87427113950253, -94.5922444164753, -24.768093816936016, -93.96412106603384, -96.38514436781406, -35.69489226490259], "episode_lengths": [245, 62, 238, 245, 241, 242, 238, 227, 220, 232, 213, 249, 256, 229, 232, 252, 278, 227, 255, 241, 247, 226, 259, 259, 253, 251, 277, 237, 275, 250, 236, 264, 260, 297, 227, 242, 265, 261, 253, 241, 237, 229, 255, 241, 283, 258, 248, 263, 270, 258, 308, 256, 233, 284, 241, 269, 277, 282, 243, 287, 314, 224, 267, 273, 258, 230, 261, 269, 241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5809939307362313, "mean_inference_ms": 7.2371274514453985, "mean_action_processing_ms": 0.11844800482664307, "mean_env_wait_ms": 4.856053668458128, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 41582.906, "learn_time_ms": 38065.979, "learn_throughput": 105.081, "update_time_ms": 28.179}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 69, "training_iteration": 5, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-02-11", "timestamp": 1655535731, "time_this_iter_s": 41.31980633735657, "time_total_s": 207.96748113632202, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 207.96748113632202, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 19.179310344827588, "ram_util_percent": 62.73620689655172}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6875, "cur_lr": 0.0007999999797903001, "total_loss": 6.499174118041992, "policy_loss": -0.07250905781984329, "vf_loss": 6.543516159057617, "vf_explained_var": 0.22112074494361877, "kl": 0.01669112592935562, "entropy": 1.981594443321228, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 978.418315589428, "episode_reward_min": -210.33778458088636, "episode_reward_mean": -59.1226067691175, "episode_len_mean": 251.3953488372093, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.350900657474995, 978.418315589428, -14.43665561825037, -57.667686231434345, -58.78202662616968, -59.20000001788139, -31.35775386542082, -38.20000007748604, 2.408862993121147, -18.709628149867058, 12.333293907344341, -48.11046980321407, -57.549512915313244, -15.627254776656628, -29.68160919100046, -54.66704856604338, -107.90511903911829, 12.100179314613342, -60.64657287299633, -83.40357530117035, -58.37168608605862, -20.52319110184908, -89.47412467747927, -73.10907270014286, -66.1787291020155, -62.32697032392025, -109.98307110369205, -48.07168620824814, -112.52921662479639, -66.35077065974474, -40.023676201701164, -126.38539176434278, -87.39486277848482, -154.19536235183477, -41.47168616205454, -43.116823330521584, -102.9742713496089, -74.95696409791708, -71.6893644630909, -42.76790485531092, -61.4352140724659, -14.81476666033268, -60.12498151510954, -37.16014812886715, -110.84825482219458, -81.94224064797163, -53.943372286856174, -93.27000880241394, -85.40116441994905, -98.0083429068327, -202.09999991208315, -87.48936469107866, -34.47872916609049, -133.75762003660202, -28.170071810483932, -100.6639306396246, -135.5000001117587, -123.69909754395485, -47.908773973584175, -123.29603060334921, -210.33778458088636, -1.4333526715636253, -113.98936446011066, -120.87427113950253, -94.5922444164753, -24.768093816936016, -93.96412106603384, -96.38514436781406, -35.69489226490259, -82.17245364189148, -32.588461972773075, -96.38936460018158, -79.85582617670298, -174.86063376814127, -104.76153625547886, -91.7712673842907, -90.4787292405963, -63.81764176487923, -49.954873725771904, -7.516823850572109, -80.5709739625454, -43.11825895309448, -146.56412103772163, -37.63443350791931, -57.360565684735775, -84.14684723317623], "episode_lengths": [245, 62, 238, 245, 241, 242, 238, 227, 220, 232, 213, 249, 256, 229, 232, 252, 278, 227, 255, 241, 247, 226, 259, 259, 253, 251, 277, 237, 275, 250, 236, 264, 260, 297, 227, 242, 265, 261, 253, 241, 237, 229, 255, 241, 283, 258, 248, 263, 270, 258, 308, 256, 233, 284, 241, 269, 277, 282, 243, 287, 314, 224, 267, 273, 258, 230, 261, 269, 241, 257, 231, 261, 270, 293, 272, 262, 263, 239, 258, 223, 253, 239, 290, 245, 236, 267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5779232512527245, "mean_inference_ms": 7.23063344606726, "mean_action_processing_ms": 0.11828078029094224, "mean_env_wait_ms": 4.820774916745584, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 978.418315589428, "episode_reward_min": -210.33778458088636, "episode_reward_mean": -59.1226067691175, "episode_len_mean": 251.3953488372093, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32.350900657474995, 978.418315589428, -14.43665561825037, -57.667686231434345, -58.78202662616968, -59.20000001788139, -31.35775386542082, -38.20000007748604, 2.408862993121147, -18.709628149867058, 12.333293907344341, -48.11046980321407, -57.549512915313244, -15.627254776656628, -29.68160919100046, -54.66704856604338, -107.90511903911829, 12.100179314613342, -60.64657287299633, -83.40357530117035, -58.37168608605862, -20.52319110184908, -89.47412467747927, -73.10907270014286, -66.1787291020155, -62.32697032392025, -109.98307110369205, -48.07168620824814, -112.52921662479639, -66.35077065974474, -40.023676201701164, -126.38539176434278, -87.39486277848482, -154.19536235183477, -41.47168616205454, -43.116823330521584, -102.9742713496089, -74.95696409791708, -71.6893644630909, -42.76790485531092, -61.4352140724659, -14.81476666033268, -60.12498151510954, -37.16014812886715, -110.84825482219458, -81.94224064797163, -53.943372286856174, -93.27000880241394, -85.40116441994905, -98.0083429068327, -202.09999991208315, -87.48936469107866, -34.47872916609049, -133.75762003660202, -28.170071810483932, -100.6639306396246, -135.5000001117587, -123.69909754395485, -47.908773973584175, -123.29603060334921, -210.33778458088636, -1.4333526715636253, -113.98936446011066, -120.87427113950253, -94.5922444164753, -24.768093816936016, -93.96412106603384, -96.38514436781406, -35.69489226490259, -82.17245364189148, -32.588461972773075, -96.38936460018158, -79.85582617670298, -174.86063376814127, -104.76153625547886, -91.7712673842907, -90.4787292405963, -63.81764176487923, -49.954873725771904, -7.516823850572109, -80.5709739625454, -43.11825895309448, -146.56412103772163, -37.63443350791931, -57.360565684735775, -84.14684723317623], "episode_lengths": [245, 62, 238, 245, 241, 242, 238, 227, 220, 232, 213, 249, 256, 229, 232, 252, 278, 227, 255, 241, 247, 226, 259, 259, 253, 251, 277, 237, 275, 250, 236, 264, 260, 297, 227, 242, 265, 261, 253, 241, 237, 229, 255, 241, 283, 258, 248, 263, 270, 258, 308, 256, 233, 284, 241, 269, 277, 282, 243, 287, 314, 224, 267, 273, 258, 230, 261, 269, 241, 257, 231, 261, 270, 293, 272, 262, 263, 239, 258, 223, 253, 239, 290, 245, 236, 267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5779232512527245, "mean_inference_ms": 7.23063344606726, "mean_action_processing_ms": 0.11828078029094224, "mean_env_wait_ms": 4.820774916745584, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 41554.119, "learn_time_ms": 38043.617, "learn_throughput": 105.142, "update_time_ms": 27.813}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 86, "training_iteration": 6, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-02-52", "timestamp": 1655535772, "time_this_iter_s": 41.42116117477417, "time_total_s": 249.3886423110962, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 249.3886423110962, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 19.353448275862068, "ram_util_percent": 62.66724137931035}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6875, "cur_lr": 0.0007999999797903001, "total_loss": 6.7466816902160645, "policy_loss": -0.06684192270040512, "vf_loss": 6.787352085113525, "vf_explained_var": 0.17651084065437317, "kl": 0.01550914254039526, "entropy": 1.975310206413269, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 12.333293907344341, "episode_reward_min": -346.5807541310787, "episode_reward_mean": -73.13984295763075, "episode_len_mean": 254.22, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.667686231434345, -58.78202662616968, -59.20000001788139, -31.35775386542082, -38.20000007748604, 2.408862993121147, -18.709628149867058, 12.333293907344341, -48.11046980321407, -57.549512915313244, -15.627254776656628, -29.68160919100046, -54.66704856604338, -107.90511903911829, 12.100179314613342, -60.64657287299633, -83.40357530117035, -58.37168608605862, -20.52319110184908, -89.47412467747927, -73.10907270014286, -66.1787291020155, -62.32697032392025, -109.98307110369205, -48.07168620824814, -112.52921662479639, -66.35077065974474, -40.023676201701164, -126.38539176434278, -87.39486277848482, -154.19536235183477, -41.47168616205454, -43.116823330521584, -102.9742713496089, -74.95696409791708, -71.6893644630909, -42.76790485531092, -61.4352140724659, -14.81476666033268, -60.12498151510954, -37.16014812886715, -110.84825482219458, -81.94224064797163, -53.943372286856174, -93.27000880241394, -85.40116441994905, -98.0083429068327, -202.09999991208315, -87.48936469107866, -34.47872916609049, -133.75762003660202, -28.170071810483932, -100.6639306396246, -135.5000001117587, -123.69909754395485, -47.908773973584175, -123.29603060334921, -210.33778458088636, -1.4333526715636253, -113.98936446011066, -120.87427113950253, -94.5922444164753, -24.768093816936016, -93.96412106603384, -96.38514436781406, -35.69489226490259, -82.17245364189148, -32.588461972773075, -96.38936460018158, -79.85582617670298, -174.86063376814127, -104.76153625547886, -91.7712673842907, -90.4787292405963, -63.81764176487923, -49.954873725771904, -7.516823850572109, -80.5709739625454, -43.11825895309448, -146.56412103772163, -37.63443350791931, -57.360565684735775, -84.14684723317623, -52.59339193254709, -77.73311395943165, -53.13079446554184, -84.64377900213003, -36.927869617938995, -60.66719111800194, -64.86511031538248, -101.07872971892357, -52.39645944535732, -57.68936461210251, -52.64805893599987, -28.29540330171585, -107.6210915222764, -2.2765686959028244, -346.5807541310787, -91.95796260982752, -26.703710921108723], "episode_lengths": [245, 241, 242, 238, 227, 220, 232, 213, 249, 256, 229, 232, 252, 278, 227, 255, 241, 247, 226, 259, 259, 253, 251, 277, 237, 275, 250, 236, 264, 260, 297, 227, 242, 265, 261, 253, 241, 237, 229, 255, 241, 283, 258, 248, 263, 270, 258, 308, 256, 233, 284, 241, 269, 277, 282, 243, 287, 314, 224, 267, 273, 258, 230, 261, 269, 241, 257, 231, 261, 270, 293, 272, 262, 263, 239, 258, 223, 253, 239, 290, 245, 236, 267, 242, 251, 244, 270, 246, 249, 255, 288, 253, 233, 242, 226, 267, 212, 374, 259, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5774581326452867, "mean_inference_ms": 7.236647302140032, "mean_action_processing_ms": 0.11805996227922363, "mean_env_wait_ms": 4.802936915251434, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 12.333293907344341, "episode_reward_min": -346.5807541310787, "episode_reward_mean": -73.13984295763075, "episode_len_mean": 254.22, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.667686231434345, -58.78202662616968, -59.20000001788139, -31.35775386542082, -38.20000007748604, 2.408862993121147, -18.709628149867058, 12.333293907344341, -48.11046980321407, -57.549512915313244, -15.627254776656628, -29.68160919100046, -54.66704856604338, -107.90511903911829, 12.100179314613342, -60.64657287299633, -83.40357530117035, -58.37168608605862, -20.52319110184908, -89.47412467747927, -73.10907270014286, -66.1787291020155, -62.32697032392025, -109.98307110369205, -48.07168620824814, -112.52921662479639, -66.35077065974474, -40.023676201701164, -126.38539176434278, -87.39486277848482, -154.19536235183477, -41.47168616205454, -43.116823330521584, -102.9742713496089, -74.95696409791708, -71.6893644630909, -42.76790485531092, -61.4352140724659, -14.81476666033268, -60.12498151510954, -37.16014812886715, -110.84825482219458, -81.94224064797163, -53.943372286856174, -93.27000880241394, -85.40116441994905, -98.0083429068327, -202.09999991208315, -87.48936469107866, -34.47872916609049, -133.75762003660202, -28.170071810483932, -100.6639306396246, -135.5000001117587, -123.69909754395485, -47.908773973584175, -123.29603060334921, -210.33778458088636, -1.4333526715636253, -113.98936446011066, -120.87427113950253, -94.5922444164753, -24.768093816936016, -93.96412106603384, -96.38514436781406, -35.69489226490259, -82.17245364189148, -32.588461972773075, -96.38936460018158, -79.85582617670298, -174.86063376814127, -104.76153625547886, -91.7712673842907, -90.4787292405963, -63.81764176487923, -49.954873725771904, -7.516823850572109, -80.5709739625454, -43.11825895309448, -146.56412103772163, -37.63443350791931, -57.360565684735775, -84.14684723317623, -52.59339193254709, -77.73311395943165, -53.13079446554184, -84.64377900213003, -36.927869617938995, -60.66719111800194, -64.86511031538248, -101.07872971892357, -52.39645944535732, -57.68936461210251, -52.64805893599987, -28.29540330171585, -107.6210915222764, -2.2765686959028244, -346.5807541310787, -91.95796260982752, -26.703710921108723], "episode_lengths": [245, 241, 242, 238, 227, 220, 232, 213, 249, 256, 229, 232, 252, 278, 227, 255, 241, 247, 226, 259, 259, 253, 251, 277, 237, 275, 250, 236, 264, 260, 297, 227, 242, 265, 261, 253, 241, 237, 229, 255, 241, 283, 258, 248, 263, 270, 258, 308, 256, 233, 284, 241, 269, 277, 282, 243, 287, 314, 224, 267, 273, 258, 230, 261, 269, 241, 257, 231, 261, 270, 293, 272, 262, 263, 239, 258, 223, 253, 239, 290, 245, 236, 267, 242, 251, 244, 270, 246, 249, 255, 288, 253, 233, 242, 226, 267, 212, 374, 259, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5774581326452867, "mean_inference_ms": 7.236647302140032, "mean_action_processing_ms": 0.11805996227922363, "mean_env_wait_ms": 4.802936915251434, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 41522.874, "learn_time_ms": 38019.251, "learn_throughput": 105.21, "update_time_ms": 27.55}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 103, "training_iteration": 7, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-03-34", "timestamp": 1655535814, "time_this_iter_s": 41.34641170501709, "time_total_s": 290.7350540161133, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 290.7350540161133, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 19.529310344827582, "ram_util_percent": 62.72758620689655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6875, "cur_lr": 0.0007999999797903001, "total_loss": 6.995015621185303, "policy_loss": -0.07354415953159332, "vf_loss": 7.041121006011963, "vf_explained_var": 0.06421025097370148, "kl": 0.01625986024737358, "entropy": 1.9613827466964722, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 23.688022665679455, "episode_reward_min": -346.5807541310787, "episode_reward_mean": -78.53009503409267, "episode_len_mean": 256.59, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.37168608605862, -20.52319110184908, -89.47412467747927, -73.10907270014286, -66.1787291020155, -62.32697032392025, -109.98307110369205, -48.07168620824814, -112.52921662479639, -66.35077065974474, -40.023676201701164, -126.38539176434278, -87.39486277848482, -154.19536235183477, -41.47168616205454, -43.116823330521584, -102.9742713496089, -74.95696409791708, -71.6893644630909, -42.76790485531092, -61.4352140724659, -14.81476666033268, -60.12498151510954, -37.16014812886715, -110.84825482219458, -81.94224064797163, -53.943372286856174, -93.27000880241394, -85.40116441994905, -98.0083429068327, -202.09999991208315, -87.48936469107866, -34.47872916609049, -133.75762003660202, -28.170071810483932, -100.6639306396246, -135.5000001117587, -123.69909754395485, -47.908773973584175, -123.29603060334921, -210.33778458088636, -1.4333526715636253, -113.98936446011066, -120.87427113950253, -94.5922444164753, -24.768093816936016, -93.96412106603384, -96.38514436781406, -35.69489226490259, -82.17245364189148, -32.588461972773075, -96.38936460018158, -79.85582617670298, -174.86063376814127, -104.76153625547886, -91.7712673842907, -90.4787292405963, -63.81764176487923, -49.954873725771904, -7.516823850572109, -80.5709739625454, -43.11825895309448, -146.56412103772163, -37.63443350791931, -57.360565684735775, -84.14684723317623, -52.59339193254709, -77.73311395943165, -53.13079446554184, -84.64377900213003, -36.927869617938995, -60.66719111800194, -64.86511031538248, -101.07872971892357, -52.39645944535732, -57.68936461210251, -52.64805893599987, -28.29540330171585, -107.6210915222764, -2.2765686959028244, -346.5807541310787, -91.95796260982752, -26.703710921108723, -140.9990973174572, -66.20550638437271, -152.5470013320446, -89.89909754693508, -13.459483869373798, -87.74495114386082, -84.55129237473011, 23.688022665679455, -63.03563718497753, -56.511970944702625, -117.49933513998985, -158.08887934684753, -25.701950393617153, -41.38983518630266, -45.0716861858964, -48.206187814474106, -66.46723936498165], "episode_lengths": [247, 226, 259, 259, 253, 251, 277, 237, 275, 250, 236, 264, 260, 297, 227, 242, 265, 261, 253, 241, 237, 229, 255, 241, 283, 258, 248, 263, 270, 258, 308, 256, 233, 284, 241, 269, 277, 282, 243, 287, 314, 224, 267, 273, 258, 230, 261, 269, 241, 257, 231, 261, 270, 293, 272, 262, 263, 239, 258, 223, 253, 239, 290, 245, 236, 267, 242, 251, 244, 270, 246, 249, 255, 288, 253, 233, 242, 226, 267, 212, 374, 259, 236, 274, 242, 303, 250, 232, 270, 260, 211, 246, 250, 278, 289, 236, 239, 248, 240, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.570910157832984, "mean_inference_ms": 7.2346825574323805, "mean_action_processing_ms": 0.11855019724771788, "mean_env_wait_ms": 4.743721812187876, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 23.688022665679455, "episode_reward_min": -346.5807541310787, "episode_reward_mean": -78.53009503409267, "episode_len_mean": 256.59, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.37168608605862, -20.52319110184908, -89.47412467747927, -73.10907270014286, -66.1787291020155, -62.32697032392025, -109.98307110369205, -48.07168620824814, -112.52921662479639, -66.35077065974474, -40.023676201701164, -126.38539176434278, -87.39486277848482, -154.19536235183477, -41.47168616205454, -43.116823330521584, -102.9742713496089, -74.95696409791708, -71.6893644630909, -42.76790485531092, -61.4352140724659, -14.81476666033268, -60.12498151510954, -37.16014812886715, -110.84825482219458, -81.94224064797163, -53.943372286856174, -93.27000880241394, -85.40116441994905, -98.0083429068327, -202.09999991208315, -87.48936469107866, -34.47872916609049, -133.75762003660202, -28.170071810483932, -100.6639306396246, -135.5000001117587, -123.69909754395485, -47.908773973584175, -123.29603060334921, -210.33778458088636, -1.4333526715636253, -113.98936446011066, -120.87427113950253, -94.5922444164753, -24.768093816936016, -93.96412106603384, -96.38514436781406, -35.69489226490259, -82.17245364189148, -32.588461972773075, -96.38936460018158, -79.85582617670298, -174.86063376814127, -104.76153625547886, -91.7712673842907, -90.4787292405963, -63.81764176487923, -49.954873725771904, -7.516823850572109, -80.5709739625454, -43.11825895309448, -146.56412103772163, -37.63443350791931, -57.360565684735775, -84.14684723317623, -52.59339193254709, -77.73311395943165, -53.13079446554184, -84.64377900213003, -36.927869617938995, -60.66719111800194, -64.86511031538248, -101.07872971892357, -52.39645944535732, -57.68936461210251, -52.64805893599987, -28.29540330171585, -107.6210915222764, -2.2765686959028244, -346.5807541310787, -91.95796260982752, -26.703710921108723, -140.9990973174572, -66.20550638437271, -152.5470013320446, -89.89909754693508, -13.459483869373798, -87.74495114386082, -84.55129237473011, 23.688022665679455, -63.03563718497753, -56.511970944702625, -117.49933513998985, -158.08887934684753, -25.701950393617153, -41.38983518630266, -45.0716861858964, -48.206187814474106, -66.46723936498165], "episode_lengths": [247, 226, 259, 259, 253, 251, 277, 237, 275, 250, 236, 264, 260, 297, 227, 242, 265, 261, 253, 241, 237, 229, 255, 241, 283, 258, 248, 263, 270, 258, 308, 256, 233, 284, 241, 269, 277, 282, 243, 287, 314, 224, 267, 273, 258, 230, 261, 269, 241, 257, 231, 261, 270, 293, 272, 262, 263, 239, 258, 223, 253, 239, 290, 245, 236, 267, 242, 251, 244, 270, 246, 249, 255, 288, 253, 233, 242, 226, 267, 212, 374, 259, 236, 274, 242, 303, 250, 232, 270, 260, 211, 246, 250, 278, 289, 236, 239, 248, 240, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.570910157832984, "mean_inference_ms": 7.2346825574323805, "mean_action_processing_ms": 0.11855019724771788, "mean_env_wait_ms": 4.743721812187876, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 41499.748, "learn_time_ms": 37996.412, "learn_throughput": 105.273, "update_time_ms": 27.353}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 120, "training_iteration": 8, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-04-15", "timestamp": 1655535855, "time_this_iter_s": 41.34787583351135, "time_total_s": 332.08292984962463, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 332.08292984962463, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 19.20344827586207, "ram_util_percent": 62.75689655172413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6875, "cur_lr": 0.0007999999797903001, "total_loss": 6.648143291473389, "policy_loss": -0.07596435397863388, "vf_loss": 6.6953959465026855, "vf_explained_var": 0.21859966218471527, "kl": 0.017014745622873306, "entropy": 1.942381739616394, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 23.688022665679455, "episode_reward_min": -346.5807541310787, "episode_reward_mean": -77.36693985939026, "episode_len_mean": 255.32, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.116823330521584, -102.9742713496089, -74.95696409791708, -71.6893644630909, -42.76790485531092, -61.4352140724659, -14.81476666033268, -60.12498151510954, -37.16014812886715, -110.84825482219458, -81.94224064797163, -53.943372286856174, -93.27000880241394, -85.40116441994905, -98.0083429068327, -202.09999991208315, -87.48936469107866, -34.47872916609049, -133.75762003660202, -28.170071810483932, -100.6639306396246, -135.5000001117587, -123.69909754395485, -47.908773973584175, -123.29603060334921, -210.33778458088636, -1.4333526715636253, -113.98936446011066, -120.87427113950253, -94.5922444164753, -24.768093816936016, -93.96412106603384, -96.38514436781406, -35.69489226490259, -82.17245364189148, -32.588461972773075, -96.38936460018158, -79.85582617670298, -174.86063376814127, -104.76153625547886, -91.7712673842907, -90.4787292405963, -63.81764176487923, -49.954873725771904, -7.516823850572109, -80.5709739625454, -43.11825895309448, -146.56412103772163, -37.63443350791931, -57.360565684735775, -84.14684723317623, -52.59339193254709, -77.73311395943165, -53.13079446554184, -84.64377900213003, -36.927869617938995, -60.66719111800194, -64.86511031538248, -101.07872971892357, -52.39645944535732, -57.68936461210251, -52.64805893599987, -28.29540330171585, -107.6210915222764, -2.2765686959028244, -346.5807541310787, -91.95796260982752, -26.703710921108723, -140.9990973174572, -66.20550638437271, -152.5470013320446, -89.89909754693508, -13.459483869373798, -87.74495114386082, -84.55129237473011, 23.688022665679455, -63.03563718497753, -56.511970944702625, -117.49933513998985, -158.08887934684753, -25.701950393617153, -41.38983518630266, -45.0716861858964, -48.206187814474106, -66.46723936498165, -116.09791446477175, -138.11593824625015, -48.87168598175049, -20.705997854471207, -33.360565692186356, -41.24951280653477, -104.48539202660322, -54.142355374991894, -42.34165374189615, -20.955404438078403, -110.55452524870634, -81.90805877000093, -85.30000010877848, -81.0893643796444, -60.89561124145985], "episode_lengths": [242, 265, 261, 253, 241, 237, 229, 255, 241, 283, 258, 248, 263, 270, 258, 308, 256, 233, 284, 241, 269, 277, 282, 243, 287, 314, 224, 267, 273, 258, 230, 261, 269, 241, 257, 231, 261, 270, 293, 272, 262, 263, 239, 258, 223, 253, 239, 290, 245, 236, 267, 242, 251, 244, 270, 246, 249, 255, 288, 253, 233, 242, 226, 267, 212, 374, 259, 236, 274, 242, 303, 250, 232, 270, 260, 211, 246, 250, 278, 289, 236, 239, 248, 240, 246, 272, 284, 228, 228, 220, 245, 254, 239, 244, 217, 268, 266, 244, 251, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5710622487207884, "mean_inference_ms": 7.225639651189304, "mean_action_processing_ms": 0.11798864161829081, "mean_env_wait_ms": 4.694557134279893, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 23.688022665679455, "episode_reward_min": -346.5807541310787, "episode_reward_mean": -77.36693985939026, "episode_len_mean": 255.32, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.116823330521584, -102.9742713496089, -74.95696409791708, -71.6893644630909, -42.76790485531092, -61.4352140724659, -14.81476666033268, -60.12498151510954, -37.16014812886715, -110.84825482219458, -81.94224064797163, -53.943372286856174, -93.27000880241394, -85.40116441994905, -98.0083429068327, -202.09999991208315, -87.48936469107866, -34.47872916609049, -133.75762003660202, -28.170071810483932, -100.6639306396246, -135.5000001117587, -123.69909754395485, -47.908773973584175, -123.29603060334921, -210.33778458088636, -1.4333526715636253, -113.98936446011066, -120.87427113950253, -94.5922444164753, -24.768093816936016, -93.96412106603384, -96.38514436781406, -35.69489226490259, -82.17245364189148, -32.588461972773075, -96.38936460018158, -79.85582617670298, -174.86063376814127, -104.76153625547886, -91.7712673842907, -90.4787292405963, -63.81764176487923, -49.954873725771904, -7.516823850572109, -80.5709739625454, -43.11825895309448, -146.56412103772163, -37.63443350791931, -57.360565684735775, -84.14684723317623, -52.59339193254709, -77.73311395943165, -53.13079446554184, -84.64377900213003, -36.927869617938995, -60.66719111800194, -64.86511031538248, -101.07872971892357, -52.39645944535732, -57.68936461210251, -52.64805893599987, -28.29540330171585, -107.6210915222764, -2.2765686959028244, -346.5807541310787, -91.95796260982752, -26.703710921108723, -140.9990973174572, -66.20550638437271, -152.5470013320446, -89.89909754693508, -13.459483869373798, -87.74495114386082, -84.55129237473011, 23.688022665679455, -63.03563718497753, -56.511970944702625, -117.49933513998985, -158.08887934684753, -25.701950393617153, -41.38983518630266, -45.0716861858964, -48.206187814474106, -66.46723936498165, -116.09791446477175, -138.11593824625015, -48.87168598175049, -20.705997854471207, -33.360565692186356, -41.24951280653477, -104.48539202660322, -54.142355374991894, -42.34165374189615, -20.955404438078403, -110.55452524870634, -81.90805877000093, -85.30000010877848, -81.0893643796444, -60.89561124145985], "episode_lengths": [242, 265, 261, 253, 241, 237, 229, 255, 241, 283, 258, 248, 263, 270, 258, 308, 256, 233, 284, 241, 269, 277, 282, 243, 287, 314, 224, 267, 273, 258, 230, 261, 269, 241, 257, 231, 261, 270, 293, 272, 262, 263, 239, 258, 223, 253, 239, 290, 245, 236, 267, 242, 251, 244, 270, 246, 249, 255, 288, 253, 233, 242, 226, 267, 212, 374, 259, 236, 274, 242, 303, 250, 232, 270, 260, 211, 246, 250, 278, 289, 236, 239, 248, 240, 246, 272, 284, 228, 228, 220, 245, 254, 239, 244, 217, 268, 266, 244, 251, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5710622487207884, "mean_inference_ms": 7.225639651189304, "mean_action_processing_ms": 0.11798864161829081, "mean_env_wait_ms": 4.694557134279893, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 41490.683, "learn_time_ms": 37995.343, "learn_throughput": 105.276, "update_time_ms": 27.533}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 135, "training_iteration": 9, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-04-57", "timestamp": 1655535897, "time_this_iter_s": 41.429158210754395, "time_total_s": 373.512088060379, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 373.512088060379, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 18.57457627118644, "ram_util_percent": 62.8779661016949}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6875, "cur_lr": 0.0007999999797903001, "total_loss": 6.178136348724365, "policy_loss": -0.091636523604393, "vf_loss": 6.23956823348999, "vf_explained_var": 0.0400504432618618, "kl": 0.017898881807923317, "entropy": 1.9447544813156128, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 23.688022665679455, "episode_reward_min": -346.5807541310787, "episode_reward_mean": -77.66111401312054, "episode_len_mean": 254.75, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.0083429068327, -202.09999991208315, -87.48936469107866, -34.47872916609049, -133.75762003660202, -28.170071810483932, -100.6639306396246, -135.5000001117587, -123.69909754395485, -47.908773973584175, -123.29603060334921, -210.33778458088636, -1.4333526715636253, -113.98936446011066, -120.87427113950253, -94.5922444164753, -24.768093816936016, -93.96412106603384, -96.38514436781406, -35.69489226490259, -82.17245364189148, -32.588461972773075, -96.38936460018158, -79.85582617670298, -174.86063376814127, -104.76153625547886, -91.7712673842907, -90.4787292405963, -63.81764176487923, -49.954873725771904, -7.516823850572109, -80.5709739625454, -43.11825895309448, -146.56412103772163, -37.63443350791931, -57.360565684735775, -84.14684723317623, -52.59339193254709, -77.73311395943165, -53.13079446554184, -84.64377900213003, -36.927869617938995, -60.66719111800194, -64.86511031538248, -101.07872971892357, -52.39645944535732, -57.68936461210251, -52.64805893599987, -28.29540330171585, -107.6210915222764, -2.2765686959028244, -346.5807541310787, -91.95796260982752, -26.703710921108723, -140.9990973174572, -66.20550638437271, -152.5470013320446, -89.89909754693508, -13.459483869373798, -87.74495114386082, -84.55129237473011, 23.688022665679455, -63.03563718497753, -56.511970944702625, -117.49933513998985, -158.08887934684753, -25.701950393617153, -41.38983518630266, -45.0716861858964, -48.206187814474106, -66.46723936498165, -116.09791446477175, -138.11593824625015, -48.87168598175049, -20.705997854471207, -33.360565692186356, -41.24951280653477, -104.48539202660322, -54.142355374991894, -42.34165374189615, -20.955404438078403, -110.55452524870634, -81.90805877000093, -85.30000010877848, -81.0893643796444, -60.89561124145985, -108.07217168807983, -76.25943900644779, -28.527458630502224, -114.03470492362976, -5.988461807370186, -29.139590315520763, 4.191655062139034, -91.2535661906004, -145.6172261685133, -155.6747565343976, -131.87042800337076, -37.48160917311907, -15.11304096877575, -29.02209647744894], "episode_lengths": [258, 308, 256, 233, 284, 241, 269, 277, 282, 243, 287, 314, 224, 267, 273, 258, 230, 261, 269, 241, 257, 231, 261, 270, 293, 272, 262, 263, 239, 258, 223, 253, 239, 290, 245, 236, 267, 242, 251, 244, 270, 246, 249, 255, 288, 253, 233, 242, 226, 267, 212, 374, 259, 236, 274, 242, 303, 250, 232, 270, 260, 211, 246, 250, 278, 289, 236, 239, 248, 240, 246, 272, 284, 228, 228, 220, 245, 254, 239, 244, 217, 268, 266, 244, 251, 231, 263, 253, 233, 267, 212, 235, 210, 268, 285, 299, 277, 227, 223, 237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.571805786766867, "mean_inference_ms": 7.220142085848395, "mean_action_processing_ms": 0.11763255794654638, "mean_env_wait_ms": 4.677696126480592, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 23.688022665679455, "episode_reward_min": -346.5807541310787, "episode_reward_mean": -77.66111401312054, "episode_len_mean": 254.75, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-98.0083429068327, -202.09999991208315, -87.48936469107866, -34.47872916609049, -133.75762003660202, -28.170071810483932, -100.6639306396246, -135.5000001117587, -123.69909754395485, -47.908773973584175, -123.29603060334921, -210.33778458088636, -1.4333526715636253, -113.98936446011066, -120.87427113950253, -94.5922444164753, -24.768093816936016, -93.96412106603384, -96.38514436781406, -35.69489226490259, -82.17245364189148, -32.588461972773075, -96.38936460018158, -79.85582617670298, -174.86063376814127, -104.76153625547886, -91.7712673842907, -90.4787292405963, -63.81764176487923, -49.954873725771904, -7.516823850572109, -80.5709739625454, -43.11825895309448, -146.56412103772163, -37.63443350791931, -57.360565684735775, -84.14684723317623, -52.59339193254709, -77.73311395943165, -53.13079446554184, -84.64377900213003, -36.927869617938995, -60.66719111800194, -64.86511031538248, -101.07872971892357, -52.39645944535732, -57.68936461210251, -52.64805893599987, -28.29540330171585, -107.6210915222764, -2.2765686959028244, -346.5807541310787, -91.95796260982752, -26.703710921108723, -140.9990973174572, -66.20550638437271, -152.5470013320446, -89.89909754693508, -13.459483869373798, -87.74495114386082, -84.55129237473011, 23.688022665679455, -63.03563718497753, -56.511970944702625, -117.49933513998985, -158.08887934684753, -25.701950393617153, -41.38983518630266, -45.0716861858964, -48.206187814474106, -66.46723936498165, -116.09791446477175, -138.11593824625015, -48.87168598175049, -20.705997854471207, -33.360565692186356, -41.24951280653477, -104.48539202660322, -54.142355374991894, -42.34165374189615, -20.955404438078403, -110.55452524870634, -81.90805877000093, -85.30000010877848, -81.0893643796444, -60.89561124145985, -108.07217168807983, -76.25943900644779, -28.527458630502224, -114.03470492362976, -5.988461807370186, -29.139590315520763, 4.191655062139034, -91.2535661906004, -145.6172261685133, -155.6747565343976, -131.87042800337076, -37.48160917311907, -15.11304096877575, -29.02209647744894], "episode_lengths": [258, 308, 256, 233, 284, 241, 269, 277, 282, 243, 287, 314, 224, 267, 273, 258, 230, 261, 269, 241, 257, 231, 261, 270, 293, 272, 262, 263, 239, 258, 223, 253, 239, 290, 245, 236, 267, 242, 251, 244, 270, 246, 249, 255, 288, 253, 233, 242, 226, 267, 212, 374, 259, 236, 274, 242, 303, 250, 232, 270, 260, 211, 246, 250, 278, 289, 236, 239, 248, 240, 246, 272, 284, 228, 228, 220, 245, 254, 239, 244, 217, 268, 266, 244, 251, 231, 263, 253, 233, 267, 212, 235, 210, 268, 285, 299, 277, 227, 223, 237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.571805786766867, "mean_inference_ms": 7.220142085848395, "mean_action_processing_ms": 0.11763255794654638, "mean_env_wait_ms": 4.677696126480592, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 41471.334, "learn_time_ms": 37986.589, "learn_throughput": 105.3, "update_time_ms": 27.479}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 149, "training_iteration": 10, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-05-38", "timestamp": 1655535938, "time_this_iter_s": 41.30718684196472, "time_total_s": 414.81927490234375, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 414.81927490234375, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 19.648275862068964, "ram_util_percent": 62.977586206896554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6875, "cur_lr": 0.0007999999797903001, "total_loss": 6.216988563537598, "policy_loss": -0.08534644544124603, "vf_loss": 6.271700859069824, "vf_explained_var": 0.1992647349834442, "kl": 0.01815350539982319, "entropy": 1.9325716495513916, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 23.688022665679455, "episode_reward_min": -346.5807541310787, "episode_reward_mean": -72.4774701422453, "episode_len_mean": 252.49, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.5922444164753, -24.768093816936016, -93.96412106603384, -96.38514436781406, -35.69489226490259, -82.17245364189148, -32.588461972773075, -96.38936460018158, -79.85582617670298, -174.86063376814127, -104.76153625547886, -91.7712673842907, -90.4787292405963, -63.81764176487923, -49.954873725771904, -7.516823850572109, -80.5709739625454, -43.11825895309448, -146.56412103772163, -37.63443350791931, -57.360565684735775, -84.14684723317623, -52.59339193254709, -77.73311395943165, -53.13079446554184, -84.64377900213003, -36.927869617938995, -60.66719111800194, -64.86511031538248, -101.07872971892357, -52.39645944535732, -57.68936461210251, -52.64805893599987, -28.29540330171585, -107.6210915222764, -2.2765686959028244, -346.5807541310787, -91.95796260982752, -26.703710921108723, -140.9990973174572, -66.20550638437271, -152.5470013320446, -89.89909754693508, -13.459483869373798, -87.74495114386082, -84.55129237473011, 23.688022665679455, -63.03563718497753, -56.511970944702625, -117.49933513998985, -158.08887934684753, -25.701950393617153, -41.38983518630266, -45.0716861858964, -48.206187814474106, -66.46723936498165, -116.09791446477175, -138.11593824625015, -48.87168598175049, -20.705997854471207, -33.360565692186356, -41.24951280653477, -104.48539202660322, -54.142355374991894, -42.34165374189615, -20.955404438078403, -110.55452524870634, -81.90805877000093, -85.30000010877848, -81.0893643796444, -60.89561124145985, -108.07217168807983, -76.25943900644779, -28.527458630502224, -114.03470492362976, -5.988461807370186, -29.139590315520763, 4.191655062139034, -91.2535661906004, -145.6172261685133, -155.6747565343976, -131.87042800337076, -37.48160917311907, -15.11304096877575, -29.02209647744894, -60.568682581186295, -16.227458633482456, -47.29536239057779, -94.97872921079397, -16.831289805471897, -40.57782656699419, -77.54674705862999, -14.246928006410599, -116.12431374937296, -93.56375168263912, -141.0422694683075, -5.375793904066086, -49.17011866718531, -100.33202466368675, -169.46105077117682], "episode_lengths": [258, 230, 261, 269, 241, 257, 231, 261, 270, 293, 272, 262, 263, 239, 258, 223, 253, 239, 290, 245, 236, 267, 242, 251, 244, 270, 246, 249, 255, 288, 253, 233, 242, 226, 267, 212, 374, 259, 236, 274, 242, 303, 250, 232, 270, 260, 211, 246, 250, 278, 289, 236, 239, 248, 240, 246, 272, 284, 228, 228, 220, 245, 254, 239, 244, 217, 268, 266, 244, 251, 231, 263, 253, 233, 267, 212, 235, 210, 268, 285, 299, 277, 227, 223, 237, 236, 220, 242, 259, 238, 236, 258, 231, 273, 275, 291, 217, 249, 276, 289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5746425268825464, "mean_inference_ms": 7.215184198486653, "mean_action_processing_ms": 0.11775556165352434, "mean_env_wait_ms": 4.6660016441760215, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 23.688022665679455, "episode_reward_min": -346.5807541310787, "episode_reward_mean": -72.4774701422453, "episode_len_mean": 252.49, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-94.5922444164753, -24.768093816936016, -93.96412106603384, -96.38514436781406, -35.69489226490259, -82.17245364189148, -32.588461972773075, -96.38936460018158, -79.85582617670298, -174.86063376814127, -104.76153625547886, -91.7712673842907, -90.4787292405963, -63.81764176487923, -49.954873725771904, -7.516823850572109, -80.5709739625454, -43.11825895309448, -146.56412103772163, -37.63443350791931, -57.360565684735775, -84.14684723317623, -52.59339193254709, -77.73311395943165, -53.13079446554184, -84.64377900213003, -36.927869617938995, -60.66719111800194, -64.86511031538248, -101.07872971892357, -52.39645944535732, -57.68936461210251, -52.64805893599987, -28.29540330171585, -107.6210915222764, -2.2765686959028244, -346.5807541310787, -91.95796260982752, -26.703710921108723, -140.9990973174572, -66.20550638437271, -152.5470013320446, -89.89909754693508, -13.459483869373798, -87.74495114386082, -84.55129237473011, 23.688022665679455, -63.03563718497753, -56.511970944702625, -117.49933513998985, -158.08887934684753, -25.701950393617153, -41.38983518630266, -45.0716861858964, -48.206187814474106, -66.46723936498165, -116.09791446477175, -138.11593824625015, -48.87168598175049, -20.705997854471207, -33.360565692186356, -41.24951280653477, -104.48539202660322, -54.142355374991894, -42.34165374189615, -20.955404438078403, -110.55452524870634, -81.90805877000093, -85.30000010877848, -81.0893643796444, -60.89561124145985, -108.07217168807983, -76.25943900644779, -28.527458630502224, -114.03470492362976, -5.988461807370186, -29.139590315520763, 4.191655062139034, -91.2535661906004, -145.6172261685133, -155.6747565343976, -131.87042800337076, -37.48160917311907, -15.11304096877575, -29.02209647744894, -60.568682581186295, -16.227458633482456, -47.29536239057779, -94.97872921079397, -16.831289805471897, -40.57782656699419, -77.54674705862999, -14.246928006410599, -116.12431374937296, -93.56375168263912, -141.0422694683075, -5.375793904066086, -49.17011866718531, -100.33202466368675, -169.46105077117682], "episode_lengths": [258, 230, 261, 269, 241, 257, 231, 261, 270, 293, 272, 262, 263, 239, 258, 223, 253, 239, 290, 245, 236, 267, 242, 251, 244, 270, 246, 249, 255, 288, 253, 233, 242, 226, 267, 212, 374, 259, 236, 274, 242, 303, 250, 232, 270, 260, 211, 246, 250, 278, 289, 236, 239, 248, 240, 246, 272, 284, 228, 228, 220, 245, 254, 239, 244, 217, 268, 266, 244, 251, 231, 263, 253, 233, 267, 212, 235, 210, 268, 285, 299, 277, 227, 223, 237, 236, 220, 242, 259, 238, 236, 258, 231, 273, 275, 291, 217, 249, 276, 289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5746425268825464, "mean_inference_ms": 7.215184198486653, "mean_action_processing_ms": 0.11775556165352434, "mean_env_wait_ms": 4.6660016441760215, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 41425.986, "learn_time_ms": 37959.932, "learn_throughput": 105.374, "update_time_ms": 27.178}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 164, "training_iteration": 11, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-06-19", "timestamp": 1655535979, "time_this_iter_s": 41.35720658302307, "time_total_s": 456.1764814853668, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 456.1764814853668, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 19.66724137931034, "ram_util_percent": 63.10517241379311}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6875, "cur_lr": 0.0007999999797903001, "total_loss": 6.058676242828369, "policy_loss": -0.0938224345445633, "vf_loss": 6.12147855758667, "vf_explained_var": 0.1258351057767868, "kl": 0.01838235929608345, "entropy": 1.9242898225784302, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 23.688022665679455, "episode_reward_min": -346.5807541310787, "episode_reward_mean": -68.76002119600773, "episode_len_mean": 250.47, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.360565684735775, -84.14684723317623, -52.59339193254709, -77.73311395943165, -53.13079446554184, -84.64377900213003, -36.927869617938995, -60.66719111800194, -64.86511031538248, -101.07872971892357, -52.39645944535732, -57.68936461210251, -52.64805893599987, -28.29540330171585, -107.6210915222764, -2.2765686959028244, -346.5807541310787, -91.95796260982752, -26.703710921108723, -140.9990973174572, -66.20550638437271, -152.5470013320446, -89.89909754693508, -13.459483869373798, -87.74495114386082, -84.55129237473011, 23.688022665679455, -63.03563718497753, -56.511970944702625, -117.49933513998985, -158.08887934684753, -25.701950393617153, -41.38983518630266, -45.0716861858964, -48.206187814474106, -66.46723936498165, -116.09791446477175, -138.11593824625015, -48.87168598175049, -20.705997854471207, -33.360565692186356, -41.24951280653477, -104.48539202660322, -54.142355374991894, -42.34165374189615, -20.955404438078403, -110.55452524870634, -81.90805877000093, -85.30000010877848, -81.0893643796444, -60.89561124145985, -108.07217168807983, -76.25943900644779, -28.527458630502224, -114.03470492362976, -5.988461807370186, -29.139590315520763, 4.191655062139034, -91.2535661906004, -145.6172261685133, -155.6747565343976, -131.87042800337076, -37.48160917311907, -15.11304096877575, -29.02209647744894, -60.568682581186295, -16.227458633482456, -47.29536239057779, -94.97872921079397, -16.831289805471897, -40.57782656699419, -77.54674705862999, -14.246928006410599, -116.12431374937296, -93.56375168263912, -141.0422694683075, -5.375793904066086, -49.17011866718531, -100.33202466368675, -169.46105077117682, -142.99862760305405, -46.67336896061897, 13.1930997595191, -53.62457858026028, -43.54514288157225, -32.17139910906553, -69.41807825118303, -30.878429904580116, -134.78249344974756, -6.789364509284496, -66.05857906490564, -71.09098822623491, -158.22029303014278, -28.050415471196175, -35.51394335180521, -79.0281957834959, 9.313175067305565, -108.56078691035509, -11.48562953621149, -59.33096135407686], "episode_lengths": [236, 267, 242, 251, 244, 270, 246, 249, 255, 288, 253, 233, 242, 226, 267, 212, 374, 259, 236, 274, 242, 303, 250, 232, 270, 260, 211, 246, 250, 278, 289, 236, 239, 248, 240, 246, 272, 284, 228, 228, 220, 245, 254, 239, 244, 217, 268, 266, 244, 251, 231, 263, 253, 233, 267, 212, 235, 210, 268, 285, 299, 277, 227, 223, 237, 236, 220, 242, 259, 238, 236, 258, 231, 273, 275, 291, 217, 249, 276, 289, 289, 245, 196, 238, 241, 252, 249, 211, 288, 211, 249, 257, 304, 227, 228, 254, 214, 274, 225, 261]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5800555624280023, "mean_inference_ms": 7.210524134981663, "mean_action_processing_ms": 0.11700315957134032, "mean_env_wait_ms": 4.65858286462284, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 23.688022665679455, "episode_reward_min": -346.5807541310787, "episode_reward_mean": -68.76002119600773, "episode_len_mean": 250.47, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.360565684735775, -84.14684723317623, -52.59339193254709, -77.73311395943165, -53.13079446554184, -84.64377900213003, -36.927869617938995, -60.66719111800194, -64.86511031538248, -101.07872971892357, -52.39645944535732, -57.68936461210251, -52.64805893599987, -28.29540330171585, -107.6210915222764, -2.2765686959028244, -346.5807541310787, -91.95796260982752, -26.703710921108723, -140.9990973174572, -66.20550638437271, -152.5470013320446, -89.89909754693508, -13.459483869373798, -87.74495114386082, -84.55129237473011, 23.688022665679455, -63.03563718497753, -56.511970944702625, -117.49933513998985, -158.08887934684753, -25.701950393617153, -41.38983518630266, -45.0716861858964, -48.206187814474106, -66.46723936498165, -116.09791446477175, -138.11593824625015, -48.87168598175049, -20.705997854471207, -33.360565692186356, -41.24951280653477, -104.48539202660322, -54.142355374991894, -42.34165374189615, -20.955404438078403, -110.55452524870634, -81.90805877000093, -85.30000010877848, -81.0893643796444, -60.89561124145985, -108.07217168807983, -76.25943900644779, -28.527458630502224, -114.03470492362976, -5.988461807370186, -29.139590315520763, 4.191655062139034, -91.2535661906004, -145.6172261685133, -155.6747565343976, -131.87042800337076, -37.48160917311907, -15.11304096877575, -29.02209647744894, -60.568682581186295, -16.227458633482456, -47.29536239057779, -94.97872921079397, -16.831289805471897, -40.57782656699419, -77.54674705862999, -14.246928006410599, -116.12431374937296, -93.56375168263912, -141.0422694683075, -5.375793904066086, -49.17011866718531, -100.33202466368675, -169.46105077117682, -142.99862760305405, -46.67336896061897, 13.1930997595191, -53.62457858026028, -43.54514288157225, -32.17139910906553, -69.41807825118303, -30.878429904580116, -134.78249344974756, -6.789364509284496, -66.05857906490564, -71.09098822623491, -158.22029303014278, -28.050415471196175, -35.51394335180521, -79.0281957834959, 9.313175067305565, -108.56078691035509, -11.48562953621149, -59.33096135407686], "episode_lengths": [236, 267, 242, 251, 244, 270, 246, 249, 255, 288, 253, 233, 242, 226, 267, 212, 374, 259, 236, 274, 242, 303, 250, 232, 270, 260, 211, 246, 250, 278, 289, 236, 239, 248, 240, 246, 272, 284, 228, 228, 220, 245, 254, 239, 244, 217, 268, 266, 244, 251, 231, 263, 253, 233, 267, 212, 235, 210, 268, 285, 299, 277, 227, 223, 237, 236, 220, 242, 259, 238, 236, 258, 231, 273, 275, 291, 217, 249, 276, 289, 289, 245, 196, 238, 241, 252, 249, 211, 288, 211, 249, 257, 304, 227, 228, 254, 214, 274, 225, 261]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5800555624280023, "mean_inference_ms": 7.210524134981663, "mean_action_processing_ms": 0.11700315957134032, "mean_env_wait_ms": 4.65858286462284, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 41516.962, "learn_time_ms": 38069.201, "learn_throughput": 105.072, "update_time_ms": 27.078}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 184, "training_iteration": 12, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-07-03", "timestamp": 1655536023, "time_this_iter_s": 43.01519775390625, "time_total_s": 499.19167923927307, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 499.19167923927307, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 22.506666666666668, "ram_util_percent": 63.383333333333326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6875, "cur_lr": 0.0007999999797903001, "total_loss": 6.6477885246276855, "policy_loss": -0.10072848200798035, "vf_loss": 6.712591648101807, "vf_explained_var": 0.1535540521144867, "kl": 0.021289177238941193, "entropy": 1.899244785308838, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 23.688022665679455, "episode_reward_min": -346.5807541310787, "episode_reward_mean": -71.87420269034803, "episode_len_mean": 251.34, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-346.5807541310787, -91.95796260982752, -26.703710921108723, -140.9990973174572, -66.20550638437271, -152.5470013320446, -89.89909754693508, -13.459483869373798, -87.74495114386082, -84.55129237473011, 23.688022665679455, -63.03563718497753, -56.511970944702625, -117.49933513998985, -158.08887934684753, -25.701950393617153, -41.38983518630266, -45.0716861858964, -48.206187814474106, -66.46723936498165, -116.09791446477175, -138.11593824625015, -48.87168598175049, -20.705997854471207, -33.360565692186356, -41.24951280653477, -104.48539202660322, -54.142355374991894, -42.34165374189615, -20.955404438078403, -110.55452524870634, -81.90805877000093, -85.30000010877848, -81.0893643796444, -60.89561124145985, -108.07217168807983, -76.25943900644779, -28.527458630502224, -114.03470492362976, -5.988461807370186, -29.139590315520763, 4.191655062139034, -91.2535661906004, -145.6172261685133, -155.6747565343976, -131.87042800337076, -37.48160917311907, -15.11304096877575, -29.02209647744894, -60.568682581186295, -16.227458633482456, -47.29536239057779, -94.97872921079397, -16.831289805471897, -40.57782656699419, -77.54674705862999, -14.246928006410599, -116.12431374937296, -93.56375168263912, -141.0422694683075, -5.375793904066086, -49.17011866718531, -100.33202466368675, -169.46105077117682, -142.99862760305405, -46.67336896061897, 13.1930997595191, -53.62457858026028, -43.54514288157225, -32.17139910906553, -69.41807825118303, -30.878429904580116, -134.78249344974756, -6.789364509284496, -66.05857906490564, -71.09098822623491, -158.22029303014278, -28.050415471196175, -35.51394335180521, -79.0281957834959, 9.313175067305565, -108.56078691035509, -11.48562953621149, -59.33096135407686, -165.33232000470161, -57.992244586348534, -68.0931378826499, -60.095792800188065, -13.679663874208927, -92.69999983906746, -125.04246961325407, -66.6893644630909, -41.73211099207401, -36.46972815692425, -127.28936439752579, -54.64495787769556, -20.89238741248846, -124.2426598444581, -71.41089545935392, -159.18539179116488], "episode_lengths": [374, 259, 236, 274, 242, 303, 250, 232, 270, 260, 211, 246, 250, 278, 289, 236, 239, 248, 240, 246, 272, 284, 228, 228, 220, 245, 254, 239, 244, 217, 268, 266, 244, 251, 231, 263, 253, 233, 267, 212, 235, 210, 268, 285, 299, 277, 227, 223, 237, 236, 220, 242, 259, 238, 236, 258, 231, 273, 275, 291, 217, 249, 276, 289, 289, 245, 196, 238, 241, 252, 249, 211, 288, 211, 249, 257, 304, 227, 228, 254, 214, 274, 225, 261, 294, 231, 254, 245, 221, 258, 276, 249, 240, 230, 263, 236, 238, 290, 258, 285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5810836623040937, "mean_inference_ms": 7.208530363217684, "mean_action_processing_ms": 0.11683036294002988, "mean_env_wait_ms": 4.652355995941249, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 23.688022665679455, "episode_reward_min": -346.5807541310787, "episode_reward_mean": -71.87420269034803, "episode_len_mean": 251.34, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-346.5807541310787, -91.95796260982752, -26.703710921108723, -140.9990973174572, -66.20550638437271, -152.5470013320446, -89.89909754693508, -13.459483869373798, -87.74495114386082, -84.55129237473011, 23.688022665679455, -63.03563718497753, -56.511970944702625, -117.49933513998985, -158.08887934684753, -25.701950393617153, -41.38983518630266, -45.0716861858964, -48.206187814474106, -66.46723936498165, -116.09791446477175, -138.11593824625015, -48.87168598175049, -20.705997854471207, -33.360565692186356, -41.24951280653477, -104.48539202660322, -54.142355374991894, -42.34165374189615, -20.955404438078403, -110.55452524870634, -81.90805877000093, -85.30000010877848, -81.0893643796444, -60.89561124145985, -108.07217168807983, -76.25943900644779, -28.527458630502224, -114.03470492362976, -5.988461807370186, -29.139590315520763, 4.191655062139034, -91.2535661906004, -145.6172261685133, -155.6747565343976, -131.87042800337076, -37.48160917311907, -15.11304096877575, -29.02209647744894, -60.568682581186295, -16.227458633482456, -47.29536239057779, -94.97872921079397, -16.831289805471897, -40.57782656699419, -77.54674705862999, -14.246928006410599, -116.12431374937296, -93.56375168263912, -141.0422694683075, -5.375793904066086, -49.17011866718531, -100.33202466368675, -169.46105077117682, -142.99862760305405, -46.67336896061897, 13.1930997595191, -53.62457858026028, -43.54514288157225, -32.17139910906553, -69.41807825118303, -30.878429904580116, -134.78249344974756, -6.789364509284496, -66.05857906490564, -71.09098822623491, -158.22029303014278, -28.050415471196175, -35.51394335180521, -79.0281957834959, 9.313175067305565, -108.56078691035509, -11.48562953621149, -59.33096135407686, -165.33232000470161, -57.992244586348534, -68.0931378826499, -60.095792800188065, -13.679663874208927, -92.69999983906746, -125.04246961325407, -66.6893644630909, -41.73211099207401, -36.46972815692425, -127.28936439752579, -54.64495787769556, -20.89238741248846, -124.2426598444581, -71.41089545935392, -159.18539179116488], "episode_lengths": [374, 259, 236, 274, 242, 303, 250, 232, 270, 260, 211, 246, 250, 278, 289, 236, 239, 248, 240, 246, 272, 284, 228, 228, 220, 245, 254, 239, 244, 217, 268, 266, 244, 251, 231, 263, 253, 233, 267, 212, 235, 210, 268, 285, 299, 277, 227, 223, 237, 236, 220, 242, 259, 238, 236, 258, 231, 273, 275, 291, 217, 249, 276, 289, 289, 245, 196, 238, 241, 252, 249, 211, 288, 211, 249, 257, 304, 227, 228, 254, 214, 274, 225, 261, 294, 231, 254, 245, 221, 258, 276, 249, 240, 230, 263, 236, 238, 290, 258, 285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5810836623040937, "mean_inference_ms": 7.208530363217684, "mean_action_processing_ms": 0.11683036294002988, "mean_env_wait_ms": 4.652355995941249, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 41630.885, "learn_time_ms": 38173.532, "learn_throughput": 104.785, "update_time_ms": 27.079}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 200, "training_iteration": 13, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-07-45", "timestamp": 1655536065, "time_this_iter_s": 42.56183052062988, "time_total_s": 541.753509759903, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 541.753509759903, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 22.683333333333334, "ram_util_percent": 63.64333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.53125, "cur_lr": 0.0007999999797903001, "total_loss": 6.0779314041137695, "policy_loss": -0.09185682237148285, "vf_loss": 6.132445335388184, "vf_explained_var": 0.1630057394504547, "kl": 0.014752631075680256, "entropy": 1.8867647647857666, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 13.1930997595191, "episode_reward_min": -182.5833995565772, "episode_reward_mean": -69.50773330658674, "episode_len_mean": 250.18, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.38983518630266, -45.0716861858964, -48.206187814474106, -66.46723936498165, -116.09791446477175, -138.11593824625015, -48.87168598175049, -20.705997854471207, -33.360565692186356, -41.24951280653477, -104.48539202660322, -54.142355374991894, -42.34165374189615, -20.955404438078403, -110.55452524870634, -81.90805877000093, -85.30000010877848, -81.0893643796444, -60.89561124145985, -108.07217168807983, -76.25943900644779, -28.527458630502224, -114.03470492362976, -5.988461807370186, -29.139590315520763, 4.191655062139034, -91.2535661906004, -145.6172261685133, -155.6747565343976, -131.87042800337076, -37.48160917311907, -15.11304096877575, -29.02209647744894, -60.568682581186295, -16.227458633482456, -47.29536239057779, -94.97872921079397, -16.831289805471897, -40.57782656699419, -77.54674705862999, -14.246928006410599, -116.12431374937296, -93.56375168263912, -141.0422694683075, -5.375793904066086, -49.17011866718531, -100.33202466368675, -169.46105077117682, -142.99862760305405, -46.67336896061897, 13.1930997595191, -53.62457858026028, -43.54514288157225, -32.17139910906553, -69.41807825118303, -30.878429904580116, -134.78249344974756, -6.789364509284496, -66.05857906490564, -71.09098822623491, -158.22029303014278, -28.050415471196175, -35.51394335180521, -79.0281957834959, 9.313175067305565, -108.56078691035509, -11.48562953621149, -59.33096135407686, -165.33232000470161, -57.992244586348534, -68.0931378826499, -60.095792800188065, -13.679663874208927, -92.69999983906746, -125.04246961325407, -66.6893644630909, -41.73211099207401, -36.46972815692425, -127.28936439752579, -54.64495787769556, -20.89238741248846, -124.2426598444581, -71.41089545935392, -159.18539179116488, -104.68936448544264, -35.89999982714653, -93.25809658318758, -17.627480812370777, -73.93521407991648, -52.78160920739174, -57.59410425275564, -65.8884619101882, -133.81790781021118, -67.09914464503527, -109.15882147103548, -14.986342951655388, -47.22457877546549, -59.31135872006416, -145.2957845106721, -182.5833995565772], "episode_lengths": [239, 248, 240, 246, 272, 284, 228, 228, 220, 245, 254, 239, 244, 217, 268, 266, 244, 251, 231, 263, 253, 233, 267, 212, 235, 210, 268, 285, 299, 277, 227, 223, 237, 236, 220, 242, 259, 238, 236, 258, 231, 273, 275, 291, 217, 249, 276, 289, 289, 245, 196, 238, 241, 252, 249, 211, 288, 211, 249, 257, 304, 227, 228, 254, 214, 274, 225, 261, 294, 231, 254, 245, 221, 258, 276, 249, 240, 230, 263, 236, 238, 290, 258, 285, 267, 222, 276, 228, 250, 238, 263, 245, 288, 255, 271, 236, 237, 233, 284, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5814384732343523, "mean_inference_ms": 7.209518622839155, "mean_action_processing_ms": 0.11684567120439468, "mean_env_wait_ms": 4.648512609778036, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.1930997595191, "episode_reward_min": -182.5833995565772, "episode_reward_mean": -69.50773330658674, "episode_len_mean": 250.18, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.38983518630266, -45.0716861858964, -48.206187814474106, -66.46723936498165, -116.09791446477175, -138.11593824625015, -48.87168598175049, -20.705997854471207, -33.360565692186356, -41.24951280653477, -104.48539202660322, -54.142355374991894, -42.34165374189615, -20.955404438078403, -110.55452524870634, -81.90805877000093, -85.30000010877848, -81.0893643796444, -60.89561124145985, -108.07217168807983, -76.25943900644779, -28.527458630502224, -114.03470492362976, -5.988461807370186, -29.139590315520763, 4.191655062139034, -91.2535661906004, -145.6172261685133, -155.6747565343976, -131.87042800337076, -37.48160917311907, -15.11304096877575, -29.02209647744894, -60.568682581186295, -16.227458633482456, -47.29536239057779, -94.97872921079397, -16.831289805471897, -40.57782656699419, -77.54674705862999, -14.246928006410599, -116.12431374937296, -93.56375168263912, -141.0422694683075, -5.375793904066086, -49.17011866718531, -100.33202466368675, -169.46105077117682, -142.99862760305405, -46.67336896061897, 13.1930997595191, -53.62457858026028, -43.54514288157225, -32.17139910906553, -69.41807825118303, -30.878429904580116, -134.78249344974756, -6.789364509284496, -66.05857906490564, -71.09098822623491, -158.22029303014278, -28.050415471196175, -35.51394335180521, -79.0281957834959, 9.313175067305565, -108.56078691035509, -11.48562953621149, -59.33096135407686, -165.33232000470161, -57.992244586348534, -68.0931378826499, -60.095792800188065, -13.679663874208927, -92.69999983906746, -125.04246961325407, -66.6893644630909, -41.73211099207401, -36.46972815692425, -127.28936439752579, -54.64495787769556, -20.89238741248846, -124.2426598444581, -71.41089545935392, -159.18539179116488, -104.68936448544264, -35.89999982714653, -93.25809658318758, -17.627480812370777, -73.93521407991648, -52.78160920739174, -57.59410425275564, -65.8884619101882, -133.81790781021118, -67.09914464503527, -109.15882147103548, -14.986342951655388, -47.22457877546549, -59.31135872006416, -145.2957845106721, -182.5833995565772], "episode_lengths": [239, 248, 240, 246, 272, 284, 228, 228, 220, 245, 254, 239, 244, 217, 268, 266, 244, 251, 231, 263, 253, 233, 267, 212, 235, 210, 268, 285, 299, 277, 227, 223, 237, 236, 220, 242, 259, 238, 236, 258, 231, 273, 275, 291, 217, 249, 276, 289, 289, 245, 196, 238, 241, 252, 249, 211, 288, 211, 249, 257, 304, 227, 228, 254, 214, 274, 225, 261, 294, 231, 254, 245, 221, 258, 276, 249, 240, 230, 263, 236, 238, 290, 258, 285, 267, 222, 276, 228, 250, 238, 263, 245, 288, 255, 271, 236, 237, 233, 284, 301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5814384732343523, "mean_inference_ms": 7.209518622839155, "mean_action_processing_ms": 0.11684567120439468, "mean_env_wait_ms": 4.648512609778036, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 41750.815, "learn_time_ms": 38272.969, "learn_throughput": 104.512, "update_time_ms": 26.879}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 216, "training_iteration": 14, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-08-28", "timestamp": 1655536108, "time_this_iter_s": 42.507235527038574, "time_total_s": 584.2607452869415, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 584.2607452869415, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 23.928333333333335, "ram_util_percent": 63.95333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.53125, "cur_lr": 0.0007999999797903001, "total_loss": 6.403829097747803, "policy_loss": -0.10001913458108902, "vf_loss": 6.464794635772705, "vf_explained_var": 0.2181931436061859, "kl": 0.015428646467626095, "entropy": 1.8833656311035156, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 13.1930997595191, "episode_reward_min": -189.2596631422639, "episode_reward_mean": -71.36117452353238, "episode_len_mean": 251.63, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-110.55452524870634, -81.90805877000093, -85.30000010877848, -81.0893643796444, -60.89561124145985, -108.07217168807983, -76.25943900644779, -28.527458630502224, -114.03470492362976, -5.988461807370186, -29.139590315520763, 4.191655062139034, -91.2535661906004, -145.6172261685133, -155.6747565343976, -131.87042800337076, -37.48160917311907, -15.11304096877575, -29.02209647744894, -60.568682581186295, -16.227458633482456, -47.29536239057779, -94.97872921079397, -16.831289805471897, -40.57782656699419, -77.54674705862999, -14.246928006410599, -116.12431374937296, -93.56375168263912, -141.0422694683075, -5.375793904066086, -49.17011866718531, -100.33202466368675, -169.46105077117682, -142.99862760305405, -46.67336896061897, 13.1930997595191, -53.62457858026028, -43.54514288157225, -32.17139910906553, -69.41807825118303, -30.878429904580116, -134.78249344974756, -6.789364509284496, -66.05857906490564, -71.09098822623491, -158.22029303014278, -28.050415471196175, -35.51394335180521, -79.0281957834959, 9.313175067305565, -108.56078691035509, -11.48562953621149, -59.33096135407686, -165.33232000470161, -57.992244586348534, -68.0931378826499, -60.095792800188065, -13.679663874208927, -92.69999983906746, -125.04246961325407, -66.6893644630909, -41.73211099207401, -36.46972815692425, -127.28936439752579, -54.64495787769556, -20.89238741248846, -124.2426598444581, -71.41089545935392, -159.18539179116488, -104.68936448544264, -35.89999982714653, -93.25809658318758, -17.627480812370777, -73.93521407991648, -52.78160920739174, -57.59410425275564, -65.8884619101882, -133.81790781021118, -67.09914464503527, -109.15882147103548, -14.986342951655388, -47.22457877546549, -59.31135872006416, -145.2957845106721, -182.5833995565772, -156.22924971580505, -74.2822845056653, -84.6893645748496, -14.630152389407158, -42.977826572954655, -84.25483179837465, -56.55764897167683, -28.006296254694462, -31.134542055428028, -67.07097367197275, -8.493066854774952, -87.38901388645172, -81.83057647943497, -189.2596631422639], "episode_lengths": [268, 266, 244, 251, 231, 263, 253, 233, 267, 212, 235, 210, 268, 285, 299, 277, 227, 223, 237, 236, 220, 242, 259, 238, 236, 258, 231, 273, 275, 291, 217, 249, 276, 289, 289, 245, 196, 238, 241, 252, 249, 211, 288, 211, 249, 257, 304, 227, 228, 254, 214, 274, 225, 261, 294, 231, 254, 245, 221, 258, 276, 249, 240, 230, 263, 236, 238, 290, 258, 285, 267, 222, 276, 228, 250, 238, 263, 245, 288, 255, 271, 236, 237, 233, 284, 301, 273, 260, 256, 227, 242, 256, 254, 245, 221, 248, 237, 264, 251, 315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5825101263119725, "mean_inference_ms": 7.208831807899571, "mean_action_processing_ms": 0.1166352505945479, "mean_env_wait_ms": 4.650336246042256, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.1930997595191, "episode_reward_min": -189.2596631422639, "episode_reward_mean": -71.36117452353238, "episode_len_mean": 251.63, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-110.55452524870634, -81.90805877000093, -85.30000010877848, -81.0893643796444, -60.89561124145985, -108.07217168807983, -76.25943900644779, -28.527458630502224, -114.03470492362976, -5.988461807370186, -29.139590315520763, 4.191655062139034, -91.2535661906004, -145.6172261685133, -155.6747565343976, -131.87042800337076, -37.48160917311907, -15.11304096877575, -29.02209647744894, -60.568682581186295, -16.227458633482456, -47.29536239057779, -94.97872921079397, -16.831289805471897, -40.57782656699419, -77.54674705862999, -14.246928006410599, -116.12431374937296, -93.56375168263912, -141.0422694683075, -5.375793904066086, -49.17011866718531, -100.33202466368675, -169.46105077117682, -142.99862760305405, -46.67336896061897, 13.1930997595191, -53.62457858026028, -43.54514288157225, -32.17139910906553, -69.41807825118303, -30.878429904580116, -134.78249344974756, -6.789364509284496, -66.05857906490564, -71.09098822623491, -158.22029303014278, -28.050415471196175, -35.51394335180521, -79.0281957834959, 9.313175067305565, -108.56078691035509, -11.48562953621149, -59.33096135407686, -165.33232000470161, -57.992244586348534, -68.0931378826499, -60.095792800188065, -13.679663874208927, -92.69999983906746, -125.04246961325407, -66.6893644630909, -41.73211099207401, -36.46972815692425, -127.28936439752579, -54.64495787769556, -20.89238741248846, -124.2426598444581, -71.41089545935392, -159.18539179116488, -104.68936448544264, -35.89999982714653, -93.25809658318758, -17.627480812370777, -73.93521407991648, -52.78160920739174, -57.59410425275564, -65.8884619101882, -133.81790781021118, -67.09914464503527, -109.15882147103548, -14.986342951655388, -47.22457877546549, -59.31135872006416, -145.2957845106721, -182.5833995565772, -156.22924971580505, -74.2822845056653, -84.6893645748496, -14.630152389407158, -42.977826572954655, -84.25483179837465, -56.55764897167683, -28.006296254694462, -31.134542055428028, -67.07097367197275, -8.493066854774952, -87.38901388645172, -81.83057647943497, -189.2596631422639], "episode_lengths": [268, 266, 244, 251, 231, 263, 253, 233, 267, 212, 235, 210, 268, 285, 299, 277, 227, 223, 237, 236, 220, 242, 259, 238, 236, 258, 231, 273, 275, 291, 217, 249, 276, 289, 289, 245, 196, 238, 241, 252, 249, 211, 288, 211, 249, 257, 304, 227, 228, 254, 214, 274, 225, 261, 294, 231, 254, 245, 221, 258, 276, 249, 240, 230, 263, 236, 238, 290, 258, 285, 267, 222, 276, 228, 250, 238, 263, 245, 288, 255, 271, 236, 237, 233, 284, 301, 273, 260, 256, 227, 242, 256, 254, 245, 221, 248, 237, 264, 251, 315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5825101263119725, "mean_inference_ms": 7.208831807899571, "mean_action_processing_ms": 0.1166352505945479, "mean_env_wait_ms": 4.650336246042256, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 41824.092, "learn_time_ms": 38340.651, "learn_throughput": 104.328, "update_time_ms": 26.878}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 230, "training_iteration": 15, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-09-10", "timestamp": 1655536150, "time_this_iter_s": 42.052613735198975, "time_total_s": 626.3133590221405, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 626.3133590221405, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 21.79491525423729, "ram_util_percent": 63.955932203389835}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.53125, "cur_lr": 0.0007999999797903001, "total_loss": 6.678933143615723, "policy_loss": -0.08783609420061111, "vf_loss": 6.729546070098877, "vf_explained_var": 0.07393553853034973, "kl": 0.014705493114888668, "entropy": 1.8792170286178589, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 13.1930997595191, "episode_reward_min": -189.2596631422639, "episode_reward_mean": -69.14699753560126, "episode_len_mean": 251.53, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.48160917311907, -15.11304096877575, -29.02209647744894, -60.568682581186295, -16.227458633482456, -47.29536239057779, -94.97872921079397, -16.831289805471897, -40.57782656699419, -77.54674705862999, -14.246928006410599, -116.12431374937296, -93.56375168263912, -141.0422694683075, -5.375793904066086, -49.17011866718531, -100.33202466368675, -169.46105077117682, -142.99862760305405, -46.67336896061897, 13.1930997595191, -53.62457858026028, -43.54514288157225, -32.17139910906553, -69.41807825118303, -30.878429904580116, -134.78249344974756, -6.789364509284496, -66.05857906490564, -71.09098822623491, -158.22029303014278, -28.050415471196175, -35.51394335180521, -79.0281957834959, 9.313175067305565, -108.56078691035509, -11.48562953621149, -59.33096135407686, -165.33232000470161, -57.992244586348534, -68.0931378826499, -60.095792800188065, -13.679663874208927, -92.69999983906746, -125.04246961325407, -66.6893644630909, -41.73211099207401, -36.46972815692425, -127.28936439752579, -54.64495787769556, -20.89238741248846, -124.2426598444581, -71.41089545935392, -159.18539179116488, -104.68936448544264, -35.89999982714653, -93.25809658318758, -17.627480812370777, -73.93521407991648, -52.78160920739174, -57.59410425275564, -65.8884619101882, -133.81790781021118, -67.09914464503527, -109.15882147103548, -14.986342951655388, -47.22457877546549, -59.31135872006416, -145.2957845106721, -182.5833995565772, -156.22924971580505, -74.2822845056653, -84.6893645748496, -14.630152389407158, -42.977826572954655, -84.25483179837465, -56.55764897167683, -28.006296254694462, -31.134542055428028, -67.07097367197275, -8.493066854774952, -87.38901388645172, -81.83057647943497, -189.2596631422639, -161.3047522827983, 4.0499521642923355, -107.58631755411625, -72.3884619474411, -12.54170548915863, -13.0130076110363, -162.31313553452492, -21.659792825579643, -162.26105059683323, -37.69664189219475, -38.29626500606537, -102.88160914182663, -72.70118203759193, -54.56499394029379, -27.867143996059895, -37.549901470541954], "episode_lengths": [227, 223, 237, 236, 220, 242, 259, 238, 236, 258, 231, 273, 275, 291, 217, 249, 276, 289, 289, 245, 196, 238, 241, 252, 249, 211, 288, 211, 249, 257, 304, 227, 228, 254, 214, 274, 225, 261, 294, 231, 254, 245, 221, 258, 276, 249, 240, 230, 263, 236, 238, 290, 258, 285, 267, 222, 276, 228, 250, 238, 263, 245, 288, 255, 271, 236, 237, 233, 284, 301, 273, 260, 256, 227, 242, 256, 254, 245, 221, 248, 237, 264, 251, 315, 320, 228, 264, 245, 216, 226, 301, 227, 298, 241, 244, 267, 252, 243, 240, 240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5840071972144244, "mean_inference_ms": 7.215841177891141, "mean_action_processing_ms": 0.11699281997365692, "mean_env_wait_ms": 4.653708607625037, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.1930997595191, "episode_reward_min": -189.2596631422639, "episode_reward_mean": -69.14699753560126, "episode_len_mean": 251.53, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-37.48160917311907, -15.11304096877575, -29.02209647744894, -60.568682581186295, -16.227458633482456, -47.29536239057779, -94.97872921079397, -16.831289805471897, -40.57782656699419, -77.54674705862999, -14.246928006410599, -116.12431374937296, -93.56375168263912, -141.0422694683075, -5.375793904066086, -49.17011866718531, -100.33202466368675, -169.46105077117682, -142.99862760305405, -46.67336896061897, 13.1930997595191, -53.62457858026028, -43.54514288157225, -32.17139910906553, -69.41807825118303, -30.878429904580116, -134.78249344974756, -6.789364509284496, -66.05857906490564, -71.09098822623491, -158.22029303014278, -28.050415471196175, -35.51394335180521, -79.0281957834959, 9.313175067305565, -108.56078691035509, -11.48562953621149, -59.33096135407686, -165.33232000470161, -57.992244586348534, -68.0931378826499, -60.095792800188065, -13.679663874208927, -92.69999983906746, -125.04246961325407, -66.6893644630909, -41.73211099207401, -36.46972815692425, -127.28936439752579, -54.64495787769556, -20.89238741248846, -124.2426598444581, -71.41089545935392, -159.18539179116488, -104.68936448544264, -35.89999982714653, -93.25809658318758, -17.627480812370777, -73.93521407991648, -52.78160920739174, -57.59410425275564, -65.8884619101882, -133.81790781021118, -67.09914464503527, -109.15882147103548, -14.986342951655388, -47.22457877546549, -59.31135872006416, -145.2957845106721, -182.5833995565772, -156.22924971580505, -74.2822845056653, -84.6893645748496, -14.630152389407158, -42.977826572954655, -84.25483179837465, -56.55764897167683, -28.006296254694462, -31.134542055428028, -67.07097367197275, -8.493066854774952, -87.38901388645172, -81.83057647943497, -189.2596631422639, -161.3047522827983, 4.0499521642923355, -107.58631755411625, -72.3884619474411, -12.54170548915863, -13.0130076110363, -162.31313553452492, -21.659792825579643, -162.26105059683323, -37.69664189219475, -38.29626500606537, -102.88160914182663, -72.70118203759193, -54.56499394029379, -27.867143996059895, -37.549901470541954], "episode_lengths": [227, 223, 237, 236, 220, 242, 259, 238, 236, 258, 231, 273, 275, 291, 217, 249, 276, 289, 289, 245, 196, 238, 241, 252, 249, 211, 288, 211, 249, 257, 304, 227, 228, 254, 214, 274, 225, 261, 294, 231, 254, 245, 221, 258, 276, 249, 240, 230, 263, 236, 238, 290, 258, 285, 267, 222, 276, 228, 250, 238, 263, 245, 288, 255, 271, 236, 237, 233, 284, 301, 273, 260, 256, 227, 242, 256, 254, 245, 221, 248, 237, 264, 251, 315, 320, 228, 264, 245, 216, 226, 301, 227, 298, 241, 244, 267, 252, 243, 240, 240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5840071972144244, "mean_inference_ms": 7.215841177891141, "mean_action_processing_ms": 0.11699281997365692, "mean_env_wait_ms": 4.653708607625037, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 41906.193, "learn_time_ms": 38416.46, "learn_throughput": 104.122, "update_time_ms": 26.977}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 246, "training_iteration": 16, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-09-52", "timestamp": 1655536192, "time_this_iter_s": 42.2422080039978, "time_total_s": 668.5555670261383, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 668.5555670261383, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 22.427118644067797, "ram_util_percent": 63.90338983050847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.53125, "cur_lr": 0.0007999999797903001, "total_loss": 6.288805961608887, "policy_loss": -0.08418670296669006, "vf_loss": 6.335858345031738, "vf_explained_var": 0.1688944697380066, "kl": 0.014670522883534431, "entropy": 1.9150089025497437, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 13.1930997595191, "episode_reward_min": -193.84770765900612, "episode_reward_mean": -69.13661385565996, "episode_len_mean": 251.39, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142.99862760305405, -46.67336896061897, 13.1930997595191, -53.62457858026028, -43.54514288157225, -32.17139910906553, -69.41807825118303, -30.878429904580116, -134.78249344974756, -6.789364509284496, -66.05857906490564, -71.09098822623491, -158.22029303014278, -28.050415471196175, -35.51394335180521, -79.0281957834959, 9.313175067305565, -108.56078691035509, -11.48562953621149, -59.33096135407686, -165.33232000470161, -57.992244586348534, -68.0931378826499, -60.095792800188065, -13.679663874208927, -92.69999983906746, -125.04246961325407, -66.6893644630909, -41.73211099207401, -36.46972815692425, -127.28936439752579, -54.64495787769556, -20.89238741248846, -124.2426598444581, -71.41089545935392, -159.18539179116488, -104.68936448544264, -35.89999982714653, -93.25809658318758, -17.627480812370777, -73.93521407991648, -52.78160920739174, -57.59410425275564, -65.8884619101882, -133.81790781021118, -67.09914464503527, -109.15882147103548, -14.986342951655388, -47.22457877546549, -59.31135872006416, -145.2957845106721, -182.5833995565772, -156.22924971580505, -74.2822845056653, -84.6893645748496, -14.630152389407158, -42.977826572954655, -84.25483179837465, -56.55764897167683, -28.006296254694462, -31.134542055428028, -67.07097367197275, -8.493066854774952, -87.38901388645172, -81.83057647943497, -189.2596631422639, -161.3047522827983, 4.0499521642923355, -107.58631755411625, -72.3884619474411, -12.54170548915863, -13.0130076110363, -162.31313553452492, -21.659792825579643, -162.26105059683323, -37.69664189219475, -38.29626500606537, -102.88160914182663, -72.70118203759193, -54.56499394029379, -27.867143996059895, -37.549901470541954, -45.83123508840799, -193.84770765900612, -98.59224436432123, -105.22548338770866, -3.7990973740816116, -122.18209854513407, -8.824578672647476, -51.22457858920097, -31.78936465829611, -36.18846210837364, -49.242523327469826, -25.727469742298126, -38.97950929403305, -23.95228900015354, -57.147324942052364, -99.60997048020363, -33.03876180201769, -98.71802674978971], "episode_lengths": [289, 245, 196, 238, 241, 252, 249, 211, 288, 211, 249, 257, 304, 227, 228, 254, 214, 274, 225, 261, 294, 231, 254, 245, 221, 258, 276, 249, 240, 230, 263, 236, 238, 290, 258, 285, 267, 222, 276, 228, 250, 238, 263, 245, 288, 255, 271, 236, 237, 233, 284, 301, 273, 260, 256, 227, 242, 256, 254, 245, 221, 248, 237, 264, 251, 315, 320, 228, 264, 245, 216, 226, 301, 227, 298, 241, 244, 267, 252, 243, 240, 240, 243, 306, 254, 272, 213, 274, 213, 239, 230, 235, 253, 232, 245, 235, 262, 263, 227, 267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5858676773753847, "mean_inference_ms": 7.221762655470115, "mean_action_processing_ms": 0.1172253258211827, "mean_env_wait_ms": 4.661198838604772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.1930997595191, "episode_reward_min": -193.84770765900612, "episode_reward_mean": -69.13661385565996, "episode_len_mean": 251.39, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142.99862760305405, -46.67336896061897, 13.1930997595191, -53.62457858026028, -43.54514288157225, -32.17139910906553, -69.41807825118303, -30.878429904580116, -134.78249344974756, -6.789364509284496, -66.05857906490564, -71.09098822623491, -158.22029303014278, -28.050415471196175, -35.51394335180521, -79.0281957834959, 9.313175067305565, -108.56078691035509, -11.48562953621149, -59.33096135407686, -165.33232000470161, -57.992244586348534, -68.0931378826499, -60.095792800188065, -13.679663874208927, -92.69999983906746, -125.04246961325407, -66.6893644630909, -41.73211099207401, -36.46972815692425, -127.28936439752579, -54.64495787769556, -20.89238741248846, -124.2426598444581, -71.41089545935392, -159.18539179116488, -104.68936448544264, -35.89999982714653, -93.25809658318758, -17.627480812370777, -73.93521407991648, -52.78160920739174, -57.59410425275564, -65.8884619101882, -133.81790781021118, -67.09914464503527, -109.15882147103548, -14.986342951655388, -47.22457877546549, -59.31135872006416, -145.2957845106721, -182.5833995565772, -156.22924971580505, -74.2822845056653, -84.6893645748496, -14.630152389407158, -42.977826572954655, -84.25483179837465, -56.55764897167683, -28.006296254694462, -31.134542055428028, -67.07097367197275, -8.493066854774952, -87.38901388645172, -81.83057647943497, -189.2596631422639, -161.3047522827983, 4.0499521642923355, -107.58631755411625, -72.3884619474411, -12.54170548915863, -13.0130076110363, -162.31313553452492, -21.659792825579643, -162.26105059683323, -37.69664189219475, -38.29626500606537, -102.88160914182663, -72.70118203759193, -54.56499394029379, -27.867143996059895, -37.549901470541954, -45.83123508840799, -193.84770765900612, -98.59224436432123, -105.22548338770866, -3.7990973740816116, -122.18209854513407, -8.824578672647476, -51.22457858920097, -31.78936465829611, -36.18846210837364, -49.242523327469826, -25.727469742298126, -38.97950929403305, -23.95228900015354, -57.147324942052364, -99.60997048020363, -33.03876180201769, -98.71802674978971], "episode_lengths": [289, 245, 196, 238, 241, 252, 249, 211, 288, 211, 249, 257, 304, 227, 228, 254, 214, 274, 225, 261, 294, 231, 254, 245, 221, 258, 276, 249, 240, 230, 263, 236, 238, 290, 258, 285, 267, 222, 276, 228, 250, 238, 263, 245, 288, 255, 271, 236, 237, 233, 284, 301, 273, 260, 256, 227, 242, 256, 254, 245, 221, 248, 237, 264, 251, 315, 320, 228, 264, 245, 216, 226, 301, 227, 298, 241, 244, 267, 252, 243, 240, 240, 243, 306, 254, 272, 213, 274, 213, 239, 230, 235, 253, 232, 245, 235, 262, 263, 227, 267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5858676773753847, "mean_inference_ms": 7.221762655470115, "mean_action_processing_ms": 0.1172253258211827, "mean_env_wait_ms": 4.661198838604772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 68000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 42043.123, "learn_time_ms": 38538.894, "learn_throughput": 103.791, "update_time_ms": 27.079}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 264, "training_iteration": 17, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-10-35", "timestamp": 1655536235, "time_this_iter_s": 42.717710733413696, "time_total_s": 711.273277759552, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 711.273277759552, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 22.921666666666667, "ram_util_percent": 63.57333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.53125, "cur_lr": 0.0007999999797903001, "total_loss": 7.263334274291992, "policy_loss": -0.10168524086475372, "vf_loss": 7.325889587402344, "vf_explained_var": -0.11716928333044052, "kl": 0.015458764508366585, "entropy": 1.901610016822815, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 9.313175067305565, "episode_reward_min": -193.84770765900612, "episode_reward_mean": -68.38612703688443, "episode_len_mean": 251.34, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.050415471196175, -35.51394335180521, -79.0281957834959, 9.313175067305565, -108.56078691035509, -11.48562953621149, -59.33096135407686, -165.33232000470161, -57.992244586348534, -68.0931378826499, -60.095792800188065, -13.679663874208927, -92.69999983906746, -125.04246961325407, -66.6893644630909, -41.73211099207401, -36.46972815692425, -127.28936439752579, -54.64495787769556, -20.89238741248846, -124.2426598444581, -71.41089545935392, -159.18539179116488, -104.68936448544264, -35.89999982714653, -93.25809658318758, -17.627480812370777, -73.93521407991648, -52.78160920739174, -57.59410425275564, -65.8884619101882, -133.81790781021118, -67.09914464503527, -109.15882147103548, -14.986342951655388, -47.22457877546549, -59.31135872006416, -145.2957845106721, -182.5833995565772, -156.22924971580505, -74.2822845056653, -84.6893645748496, -14.630152389407158, -42.977826572954655, -84.25483179837465, -56.55764897167683, -28.006296254694462, -31.134542055428028, -67.07097367197275, -8.493066854774952, -87.38901388645172, -81.83057647943497, -189.2596631422639, -161.3047522827983, 4.0499521642923355, -107.58631755411625, -72.3884619474411, -12.54170548915863, -13.0130076110363, -162.31313553452492, -21.659792825579643, -162.26105059683323, -37.69664189219475, -38.29626500606537, -102.88160914182663, -72.70118203759193, -54.56499394029379, -27.867143996059895, -37.549901470541954, -45.83123508840799, -193.84770765900612, -98.59224436432123, -105.22548338770866, -3.7990973740816116, -122.18209854513407, -8.824578672647476, -51.22457858920097, -31.78936465829611, -36.18846210837364, -49.242523327469826, -25.727469742298126, -38.97950929403305, -23.95228900015354, -57.147324942052364, -99.60997048020363, -33.03876180201769, -98.71802674978971, -105.83431354910135, -24.494104385375977, -60.44915737956762, -48.87782645970583, -68.26412101835012, -117.17475632578135, -15.527458690106869, -57.059971675276756, -21.089364610612392, -48.86321850866079, 1.4069703593850136, -71.94643273949623, -129.83580695092678], "episode_lengths": [227, 228, 254, 214, 274, 225, 261, 294, 231, 254, 245, 221, 258, 276, 249, 240, 230, 263, 236, 238, 290, 258, 285, 267, 222, 276, 228, 250, 238, 263, 245, 288, 255, 271, 236, 237, 233, 284, 301, 273, 260, 256, 227, 242, 256, 254, 245, 221, 248, 237, 264, 251, 315, 320, 228, 264, 245, 216, 226, 301, 227, 298, 241, 244, 267, 252, 243, 240, 240, 243, 306, 254, 272, 213, 274, 213, 239, 230, 235, 253, 232, 245, 235, 262, 263, 227, 267, 264, 245, 258, 242, 247, 281, 220, 249, 217, 249, 216, 252, 285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5849797321205084, "mean_inference_ms": 7.232737462377458, "mean_action_processing_ms": 0.1174482385964246, "mean_env_wait_ms": 4.665473837862331, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 9.313175067305565, "episode_reward_min": -193.84770765900612, "episode_reward_mean": -68.38612703688443, "episode_len_mean": 251.34, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-28.050415471196175, -35.51394335180521, -79.0281957834959, 9.313175067305565, -108.56078691035509, -11.48562953621149, -59.33096135407686, -165.33232000470161, -57.992244586348534, -68.0931378826499, -60.095792800188065, -13.679663874208927, -92.69999983906746, -125.04246961325407, -66.6893644630909, -41.73211099207401, -36.46972815692425, -127.28936439752579, -54.64495787769556, -20.89238741248846, -124.2426598444581, -71.41089545935392, -159.18539179116488, -104.68936448544264, -35.89999982714653, -93.25809658318758, -17.627480812370777, -73.93521407991648, -52.78160920739174, -57.59410425275564, -65.8884619101882, -133.81790781021118, -67.09914464503527, -109.15882147103548, -14.986342951655388, -47.22457877546549, -59.31135872006416, -145.2957845106721, -182.5833995565772, -156.22924971580505, -74.2822845056653, -84.6893645748496, -14.630152389407158, -42.977826572954655, -84.25483179837465, -56.55764897167683, -28.006296254694462, -31.134542055428028, -67.07097367197275, -8.493066854774952, -87.38901388645172, -81.83057647943497, -189.2596631422639, -161.3047522827983, 4.0499521642923355, -107.58631755411625, -72.3884619474411, -12.54170548915863, -13.0130076110363, -162.31313553452492, -21.659792825579643, -162.26105059683323, -37.69664189219475, -38.29626500606537, -102.88160914182663, -72.70118203759193, -54.56499394029379, -27.867143996059895, -37.549901470541954, -45.83123508840799, -193.84770765900612, -98.59224436432123, -105.22548338770866, -3.7990973740816116, -122.18209854513407, -8.824578672647476, -51.22457858920097, -31.78936465829611, -36.18846210837364, -49.242523327469826, -25.727469742298126, -38.97950929403305, -23.95228900015354, -57.147324942052364, -99.60997048020363, -33.03876180201769, -98.71802674978971, -105.83431354910135, -24.494104385375977, -60.44915737956762, -48.87782645970583, -68.26412101835012, -117.17475632578135, -15.527458690106869, -57.059971675276756, -21.089364610612392, -48.86321850866079, 1.4069703593850136, -71.94643273949623, -129.83580695092678], "episode_lengths": [227, 228, 254, 214, 274, 225, 261, 294, 231, 254, 245, 221, 258, 276, 249, 240, 230, 263, 236, 238, 290, 258, 285, 267, 222, 276, 228, 250, 238, 263, 245, 288, 255, 271, 236, 237, 233, 284, 301, 273, 260, 256, 227, 242, 256, 254, 245, 221, 248, 237, 264, 251, 315, 320, 228, 264, 245, 216, 226, 301, 227, 298, 241, 244, 267, 252, 243, 240, 240, 243, 306, 254, 272, 213, 274, 213, 239, 230, 235, 253, 232, 245, 235, 262, 263, 227, 267, 264, 245, 258, 242, 247, 281, 220, 249, 217, 249, 216, 252, 285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5849797321205084, "mean_inference_ms": 7.232737462377458, "mean_action_processing_ms": 0.1174482385964246, "mean_env_wait_ms": 4.665473837862331, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 72000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 42097.429, "learn_time_ms": 38589.905, "learn_throughput": 103.654, "update_time_ms": 27.277}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 277, "training_iteration": 18, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-11-17", "timestamp": 1655536277, "time_this_iter_s": 41.89192247390747, "time_total_s": 753.1652002334595, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 753.1652002334595, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 22.008474576271187, "ram_util_percent": 63.616949152542375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.53125, "cur_lr": 0.0007999999797903001, "total_loss": 5.945220947265625, "policy_loss": -0.027485109865665436, "vf_loss": 5.9587788581848145, "vf_explained_var": 0.02331174537539482, "kl": 0.005501828622072935, "entropy": 1.8916187286376953, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 962.6378561332822, "episode_reward_min": -215.74673757702112, "episode_reward_mean": -59.490515855327246, "episode_len_mean": 251.19, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-127.28936439752579, -54.64495787769556, -20.89238741248846, -124.2426598444581, -71.41089545935392, -159.18539179116488, -104.68936448544264, -35.89999982714653, -93.25809658318758, -17.627480812370777, -73.93521407991648, -52.78160920739174, -57.59410425275564, -65.8884619101882, -133.81790781021118, -67.09914464503527, -109.15882147103548, -14.986342951655388, -47.22457877546549, -59.31135872006416, -145.2957845106721, -182.5833995565772, -156.22924971580505, -74.2822845056653, -84.6893645748496, -14.630152389407158, -42.977826572954655, -84.25483179837465, -56.55764897167683, -28.006296254694462, -31.134542055428028, -67.07097367197275, -8.493066854774952, -87.38901388645172, -81.83057647943497, -189.2596631422639, -161.3047522827983, 4.0499521642923355, -107.58631755411625, -72.3884619474411, -12.54170548915863, -13.0130076110363, -162.31313553452492, -21.659792825579643, -162.26105059683323, -37.69664189219475, -38.29626500606537, -102.88160914182663, -72.70118203759193, -54.56499394029379, -27.867143996059895, -37.549901470541954, -45.83123508840799, -193.84770765900612, -98.59224436432123, -105.22548338770866, -3.7990973740816116, -122.18209854513407, -8.824578672647476, -51.22457858920097, -31.78936465829611, -36.18846210837364, -49.242523327469826, -25.727469742298126, -38.97950929403305, -23.95228900015354, -57.147324942052364, -99.60997048020363, -33.03876180201769, -98.71802674978971, -105.83431354910135, -24.494104385375977, -60.44915737956762, -48.87782645970583, -68.26412101835012, -117.17475632578135, -15.527458690106869, -57.059971675276756, -21.089364610612392, -48.86321850866079, 1.4069703593850136, -71.94643273949623, -129.83580695092678, 7.28565376251936, -34.63423674553633, -90.78936456143856, -122.75329545885324, -22.586779735982418, 10.90911389887333, 962.6378561332822, -83.63948372006416, -61.74730474501848, -62.58936459571123, -61.288509510457516, -215.74673757702112, -99.36412101984024, -48.868389293551445, -81.99368011951447, -90.1398845538497, -55.613943554461], "episode_lengths": [263, 236, 238, 290, 258, 285, 267, 222, 276, 228, 250, 238, 263, 245, 288, 255, 271, 236, 237, 233, 284, 301, 273, 260, 256, 227, 242, 256, 254, 245, 221, 248, 237, 264, 251, 315, 320, 228, 264, 245, 216, 226, 301, 227, 298, 241, 244, 267, 252, 243, 240, 240, 243, 306, 254, 272, 213, 274, 213, 239, 230, 235, 253, 232, 245, 235, 262, 263, 227, 267, 264, 245, 258, 242, 247, 281, 220, 249, 217, 249, 216, 252, 285, 213, 242, 258, 275, 228, 209, 149, 260, 257, 242, 253, 316, 265, 234, 257, 262, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5854633526742523, "mean_inference_ms": 7.241013927060511, "mean_action_processing_ms": 0.1179700631570457, "mean_env_wait_ms": 4.670334260382862, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 962.6378561332822, "episode_reward_min": -215.74673757702112, "episode_reward_mean": -59.490515855327246, "episode_len_mean": 251.19, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-127.28936439752579, -54.64495787769556, -20.89238741248846, -124.2426598444581, -71.41089545935392, -159.18539179116488, -104.68936448544264, -35.89999982714653, -93.25809658318758, -17.627480812370777, -73.93521407991648, -52.78160920739174, -57.59410425275564, -65.8884619101882, -133.81790781021118, -67.09914464503527, -109.15882147103548, -14.986342951655388, -47.22457877546549, -59.31135872006416, -145.2957845106721, -182.5833995565772, -156.22924971580505, -74.2822845056653, -84.6893645748496, -14.630152389407158, -42.977826572954655, -84.25483179837465, -56.55764897167683, -28.006296254694462, -31.134542055428028, -67.07097367197275, -8.493066854774952, -87.38901388645172, -81.83057647943497, -189.2596631422639, -161.3047522827983, 4.0499521642923355, -107.58631755411625, -72.3884619474411, -12.54170548915863, -13.0130076110363, -162.31313553452492, -21.659792825579643, -162.26105059683323, -37.69664189219475, -38.29626500606537, -102.88160914182663, -72.70118203759193, -54.56499394029379, -27.867143996059895, -37.549901470541954, -45.83123508840799, -193.84770765900612, -98.59224436432123, -105.22548338770866, -3.7990973740816116, -122.18209854513407, -8.824578672647476, -51.22457858920097, -31.78936465829611, -36.18846210837364, -49.242523327469826, -25.727469742298126, -38.97950929403305, -23.95228900015354, -57.147324942052364, -99.60997048020363, -33.03876180201769, -98.71802674978971, -105.83431354910135, -24.494104385375977, -60.44915737956762, -48.87782645970583, -68.26412101835012, -117.17475632578135, -15.527458690106869, -57.059971675276756, -21.089364610612392, -48.86321850866079, 1.4069703593850136, -71.94643273949623, -129.83580695092678, 7.28565376251936, -34.63423674553633, -90.78936456143856, -122.75329545885324, -22.586779735982418, 10.90911389887333, 962.6378561332822, -83.63948372006416, -61.74730474501848, -62.58936459571123, -61.288509510457516, -215.74673757702112, -99.36412101984024, -48.868389293551445, -81.99368011951447, -90.1398845538497, -55.613943554461], "episode_lengths": [263, 236, 238, 290, 258, 285, 267, 222, 276, 228, 250, 238, 263, 245, 288, 255, 271, 236, 237, 233, 284, 301, 273, 260, 256, 227, 242, 256, 254, 245, 221, 248, 237, 264, 251, 315, 320, 228, 264, 245, 216, 226, 301, 227, 298, 241, 244, 267, 252, 243, 240, 240, 243, 306, 254, 272, 213, 274, 213, 239, 230, 235, 253, 232, 245, 235, 262, 263, 227, 267, 264, 245, 258, 242, 247, 281, 220, 249, 217, 249, 216, 252, 285, 213, 242, 258, 275, 228, 209, 149, 260, 257, 242, 253, 316, 265, 234, 257, 262, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5854633526742523, "mean_inference_ms": 7.241013927060511, "mean_action_processing_ms": 0.1179700631570457, "mean_env_wait_ms": 4.670334260382862, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 76000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 42146.447, "learn_time_ms": 38629.428, "learn_throughput": 103.548, "update_time_ms": 27.076}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 294, "training_iteration": 19, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-11-59", "timestamp": 1655536319, "time_this_iter_s": 41.91833209991455, "time_total_s": 795.083532333374, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 795.083532333374, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 22.18135593220339, "ram_util_percent": 63.62203389830509}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.53125, "cur_lr": 0.0007999999797903001, "total_loss": 6.606893062591553, "policy_loss": -0.0949447825551033, "vf_loss": 6.663619518280029, "vf_explained_var": 0.08976323157548904, "kl": 0.015098468400537968, "entropy": 1.8908274173736572, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 962.6378561332822, "episode_reward_min": -215.74673757702112, "episode_reward_mean": -55.15199911437929, "episode_len_mean": 248.43, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.15882147103548, -14.986342951655388, -47.22457877546549, -59.31135872006416, -145.2957845106721, -182.5833995565772, -156.22924971580505, -74.2822845056653, -84.6893645748496, -14.630152389407158, -42.977826572954655, -84.25483179837465, -56.55764897167683, -28.006296254694462, -31.134542055428028, -67.07097367197275, -8.493066854774952, -87.38901388645172, -81.83057647943497, -189.2596631422639, -161.3047522827983, 4.0499521642923355, -107.58631755411625, -72.3884619474411, -12.54170548915863, -13.0130076110363, -162.31313553452492, -21.659792825579643, -162.26105059683323, -37.69664189219475, -38.29626500606537, -102.88160914182663, -72.70118203759193, -54.56499394029379, -27.867143996059895, -37.549901470541954, -45.83123508840799, -193.84770765900612, -98.59224436432123, -105.22548338770866, -3.7990973740816116, -122.18209854513407, -8.824578672647476, -51.22457858920097, -31.78936465829611, -36.18846210837364, -49.242523327469826, -25.727469742298126, -38.97950929403305, -23.95228900015354, -57.147324942052364, -99.60997048020363, -33.03876180201769, -98.71802674978971, -105.83431354910135, -24.494104385375977, -60.44915737956762, -48.87782645970583, -68.26412101835012, -117.17475632578135, -15.527458690106869, -57.059971675276756, -21.089364610612392, -48.86321850866079, 1.4069703593850136, -71.94643273949623, -129.83580695092678, 7.28565376251936, -34.63423674553633, -90.78936456143856, -122.75329545885324, -22.586779735982418, 10.90911389887333, 962.6378561332822, -83.63948372006416, -61.74730474501848, -62.58936459571123, -61.288509510457516, -215.74673757702112, -99.36412101984024, -48.868389293551445, -81.99368011951447, -90.1398845538497, -55.613943554461, -42.4509010463953, -90.20997060090303, -21.452393017709255, -41.581609182059765, -23.30727744847536, 3.94020713865757, -51.44233230501413, -162.7716861590743, -48.5893646851182, -12.62697023153305, -127.06014824658632, -77.03673551976681, -35.00406768172979, -29.99999998509884, -56.99224451184273, -9.819872818887234], "episode_lengths": [271, 236, 237, 233, 284, 301, 273, 260, 256, 227, 242, 256, 254, 245, 221, 248, 237, 264, 251, 315, 320, 228, 264, 245, 216, 226, 301, 227, 298, 241, 244, 267, 252, 243, 240, 240, 243, 306, 254, 272, 213, 274, 213, 239, 230, 235, 253, 232, 245, 235, 262, 263, 227, 267, 264, 245, 258, 242, 247, 281, 220, 249, 217, 249, 216, 252, 285, 213, 242, 258, 275, 228, 209, 149, 260, 257, 242, 253, 316, 265, 234, 257, 262, 246, 241, 264, 228, 234, 225, 201, 240, 282, 234, 228, 266, 256, 236, 230, 239, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5860778365973833, "mean_inference_ms": 7.250696217019724, "mean_action_processing_ms": 0.11836691962855342, "mean_env_wait_ms": 4.6764700378332655, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 962.6378561332822, "episode_reward_min": -215.74673757702112, "episode_reward_mean": -55.15199911437929, "episode_len_mean": 248.43, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.15882147103548, -14.986342951655388, -47.22457877546549, -59.31135872006416, -145.2957845106721, -182.5833995565772, -156.22924971580505, -74.2822845056653, -84.6893645748496, -14.630152389407158, -42.977826572954655, -84.25483179837465, -56.55764897167683, -28.006296254694462, -31.134542055428028, -67.07097367197275, -8.493066854774952, -87.38901388645172, -81.83057647943497, -189.2596631422639, -161.3047522827983, 4.0499521642923355, -107.58631755411625, -72.3884619474411, -12.54170548915863, -13.0130076110363, -162.31313553452492, -21.659792825579643, -162.26105059683323, -37.69664189219475, -38.29626500606537, -102.88160914182663, -72.70118203759193, -54.56499394029379, -27.867143996059895, -37.549901470541954, -45.83123508840799, -193.84770765900612, -98.59224436432123, -105.22548338770866, -3.7990973740816116, -122.18209854513407, -8.824578672647476, -51.22457858920097, -31.78936465829611, -36.18846210837364, -49.242523327469826, -25.727469742298126, -38.97950929403305, -23.95228900015354, -57.147324942052364, -99.60997048020363, -33.03876180201769, -98.71802674978971, -105.83431354910135, -24.494104385375977, -60.44915737956762, -48.87782645970583, -68.26412101835012, -117.17475632578135, -15.527458690106869, -57.059971675276756, -21.089364610612392, -48.86321850866079, 1.4069703593850136, -71.94643273949623, -129.83580695092678, 7.28565376251936, -34.63423674553633, -90.78936456143856, -122.75329545885324, -22.586779735982418, 10.90911389887333, 962.6378561332822, -83.63948372006416, -61.74730474501848, -62.58936459571123, -61.288509510457516, -215.74673757702112, -99.36412101984024, -48.868389293551445, -81.99368011951447, -90.1398845538497, -55.613943554461, -42.4509010463953, -90.20997060090303, -21.452393017709255, -41.581609182059765, -23.30727744847536, 3.94020713865757, -51.44233230501413, -162.7716861590743, -48.5893646851182, -12.62697023153305, -127.06014824658632, -77.03673551976681, -35.00406768172979, -29.99999998509884, -56.99224451184273, -9.819872818887234], "episode_lengths": [271, 236, 237, 233, 284, 301, 273, 260, 256, 227, 242, 256, 254, 245, 221, 248, 237, 264, 251, 315, 320, 228, 264, 245, 216, 226, 301, 227, 298, 241, 244, 267, 252, 243, 240, 240, 243, 306, 254, 272, 213, 274, 213, 239, 230, 235, 253, 232, 245, 235, 262, 263, 227, 267, 264, 245, 258, 242, 247, 281, 220, 249, 217, 249, 216, 252, 285, 213, 242, 258, 275, 228, 209, 149, 260, 257, 242, 253, 316, 265, 234, 257, 262, 246, 241, 264, 228, 234, 225, 201, 240, 282, 234, 228, 266, 256, 236, 230, 239, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5860778365973833, "mean_inference_ms": 7.250696217019724, "mean_action_processing_ms": 0.11836691962855342, "mean_env_wait_ms": 4.6764700378332655, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 80000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 42209.936, "learn_time_ms": 38680.804, "learn_throughput": 103.41, "update_time_ms": 27.075}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 310, "training_iteration": 20, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-12-41", "timestamp": 1655536361, "time_this_iter_s": 41.9430730342865, "time_total_s": 837.0266053676605, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 837.0266053676605, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 22.625862068965517, "ram_util_percent": 63.596551724137925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.53125, "cur_lr": 0.0007999999797903001, "total_loss": 5.692330837249756, "policy_loss": -0.11271845549345016, "vf_loss": 5.762982368469238, "vf_explained_var": 0.45763099193573, "kl": 0.016619201749563217, "entropy": 1.8807483911514282, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 962.6378561332822, "episode_reward_min": -215.74673757702112, "episode_reward_mean": -53.0662860108912, "episode_len_mean": 248.23, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.493066854774952, -87.38901388645172, -81.83057647943497, -189.2596631422639, -161.3047522827983, 4.0499521642923355, -107.58631755411625, -72.3884619474411, -12.54170548915863, -13.0130076110363, -162.31313553452492, -21.659792825579643, -162.26105059683323, -37.69664189219475, -38.29626500606537, -102.88160914182663, -72.70118203759193, -54.56499394029379, -27.867143996059895, -37.549901470541954, -45.83123508840799, -193.84770765900612, -98.59224436432123, -105.22548338770866, -3.7990973740816116, -122.18209854513407, -8.824578672647476, -51.22457858920097, -31.78936465829611, -36.18846210837364, -49.242523327469826, -25.727469742298126, -38.97950929403305, -23.95228900015354, -57.147324942052364, -99.60997048020363, -33.03876180201769, -98.71802674978971, -105.83431354910135, -24.494104385375977, -60.44915737956762, -48.87782645970583, -68.26412101835012, -117.17475632578135, -15.527458690106869, -57.059971675276756, -21.089364610612392, -48.86321850866079, 1.4069703593850136, -71.94643273949623, -129.83580695092678, 7.28565376251936, -34.63423674553633, -90.78936456143856, -122.75329545885324, -22.586779735982418, 10.90911389887333, 962.6378561332822, -83.63948372006416, -61.74730474501848, -62.58936459571123, -61.288509510457516, -215.74673757702112, -99.36412101984024, -48.868389293551445, -81.99368011951447, -90.1398845538497, -55.613943554461, -42.4509010463953, -90.20997060090303, -21.452393017709255, -41.581609182059765, -23.30727744847536, 3.94020713865757, -51.44233230501413, -162.7716861590743, -48.5893646851182, -12.62697023153305, -127.06014824658632, -77.03673551976681, -35.00406768172979, -29.99999998509884, -56.99224451184273, -9.819872818887234, -55.634311489760876, -81.6614056751132, -41.962259747087955, -110.41210505366325, -99.70000004023314, -59.95352956652641, -58.48936441540718, -32.14877649396658, -109.17791374027729, -41.40469882637262, -46.46923665702343, -20.588461995124817, -23.77168619632721, -13.581609383225441, -81.52006683498621, -113.34672003239393], "episode_lengths": [237, 264, 251, 315, 320, 228, 264, 245, 216, 226, 301, 227, 298, 241, 244, 267, 252, 243, 240, 240, 243, 306, 254, 272, 213, 274, 213, 239, 230, 235, 253, 232, 245, 235, 262, 263, 227, 267, 264, 245, 258, 242, 247, 281, 220, 249, 217, 249, 216, 252, 285, 213, 242, 258, 275, 228, 209, 149, 260, 257, 242, 253, 316, 265, 234, 257, 262, 246, 241, 264, 228, 234, 225, 201, 240, 282, 234, 228, 266, 256, 236, 230, 239, 222, 236, 267, 245, 283, 259, 259, 244, 238, 286, 242, 246, 219, 233, 219, 259, 289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5867974806874884, "mean_inference_ms": 7.259256778465157, "mean_action_processing_ms": 0.11866675376845469, "mean_env_wait_ms": 4.684128843513883, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 962.6378561332822, "episode_reward_min": -215.74673757702112, "episode_reward_mean": -53.0662860108912, "episode_len_mean": 248.23, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.493066854774952, -87.38901388645172, -81.83057647943497, -189.2596631422639, -161.3047522827983, 4.0499521642923355, -107.58631755411625, -72.3884619474411, -12.54170548915863, -13.0130076110363, -162.31313553452492, -21.659792825579643, -162.26105059683323, -37.69664189219475, -38.29626500606537, -102.88160914182663, -72.70118203759193, -54.56499394029379, -27.867143996059895, -37.549901470541954, -45.83123508840799, -193.84770765900612, -98.59224436432123, -105.22548338770866, -3.7990973740816116, -122.18209854513407, -8.824578672647476, -51.22457858920097, -31.78936465829611, -36.18846210837364, -49.242523327469826, -25.727469742298126, -38.97950929403305, -23.95228900015354, -57.147324942052364, -99.60997048020363, -33.03876180201769, -98.71802674978971, -105.83431354910135, -24.494104385375977, -60.44915737956762, -48.87782645970583, -68.26412101835012, -117.17475632578135, -15.527458690106869, -57.059971675276756, -21.089364610612392, -48.86321850866079, 1.4069703593850136, -71.94643273949623, -129.83580695092678, 7.28565376251936, -34.63423674553633, -90.78936456143856, -122.75329545885324, -22.586779735982418, 10.90911389887333, 962.6378561332822, -83.63948372006416, -61.74730474501848, -62.58936459571123, -61.288509510457516, -215.74673757702112, -99.36412101984024, -48.868389293551445, -81.99368011951447, -90.1398845538497, -55.613943554461, -42.4509010463953, -90.20997060090303, -21.452393017709255, -41.581609182059765, -23.30727744847536, 3.94020713865757, -51.44233230501413, -162.7716861590743, -48.5893646851182, -12.62697023153305, -127.06014824658632, -77.03673551976681, -35.00406768172979, -29.99999998509884, -56.99224451184273, -9.819872818887234, -55.634311489760876, -81.6614056751132, -41.962259747087955, -110.41210505366325, -99.70000004023314, -59.95352956652641, -58.48936441540718, -32.14877649396658, -109.17791374027729, -41.40469882637262, -46.46923665702343, -20.588461995124817, -23.77168619632721, -13.581609383225441, -81.52006683498621, -113.34672003239393], "episode_lengths": [237, 264, 251, 315, 320, 228, 264, 245, 216, 226, 301, 227, 298, 241, 244, 267, 252, 243, 240, 240, 243, 306, 254, 272, 213, 274, 213, 239, 230, 235, 253, 232, 245, 235, 262, 263, 227, 267, 264, 245, 258, 242, 247, 281, 220, 249, 217, 249, 216, 252, 285, 213, 242, 258, 275, 228, 209, 149, 260, 257, 242, 253, 316, 265, 234, 257, 262, 246, 241, 264, 228, 234, 225, 201, 240, 282, 234, 228, 266, 256, 236, 230, 239, 222, 236, 267, 245, 283, 259, 259, 244, 238, 286, 242, 246, 219, 233, 219, 259, 289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5867974806874884, "mean_inference_ms": 7.259256778465157, "mean_action_processing_ms": 0.11866675376845469, "mean_env_wait_ms": 4.684128843513883, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 84000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 42272.023, "learn_time_ms": 38730.395, "learn_throughput": 103.278, "update_time_ms": 27.177}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 326, "training_iteration": 21, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-13-23", "timestamp": 1655536403, "time_this_iter_s": 41.97806668281555, "time_total_s": 879.0046720504761, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 879.0046720504761, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 22.12203389830508, "ram_util_percent": 63.51864406779661}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.53125, "cur_lr": 0.0007999999797903001, "total_loss": 5.994401931762695, "policy_loss": -0.0930328518152237, "vf_loss": 6.050323486328125, "vf_explained_var": 0.15602678060531616, "kl": 0.014661163091659546, "entropy": 1.8712536096572876, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 962.6378561332822, "episode_reward_min": -215.74673757702112, "episode_reward_mean": -49.078783860579136, "episode_len_mean": 246.13, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72.70118203759193, -54.56499394029379, -27.867143996059895, -37.549901470541954, -45.83123508840799, -193.84770765900612, -98.59224436432123, -105.22548338770866, -3.7990973740816116, -122.18209854513407, -8.824578672647476, -51.22457858920097, -31.78936465829611, -36.18846210837364, -49.242523327469826, -25.727469742298126, -38.97950929403305, -23.95228900015354, -57.147324942052364, -99.60997048020363, -33.03876180201769, -98.71802674978971, -105.83431354910135, -24.494104385375977, -60.44915737956762, -48.87782645970583, -68.26412101835012, -117.17475632578135, -15.527458690106869, -57.059971675276756, -21.089364610612392, -48.86321850866079, 1.4069703593850136, -71.94643273949623, -129.83580695092678, 7.28565376251936, -34.63423674553633, -90.78936456143856, -122.75329545885324, -22.586779735982418, 10.90911389887333, 962.6378561332822, -83.63948372006416, -61.74730474501848, -62.58936459571123, -61.288509510457516, -215.74673757702112, -99.36412101984024, -48.868389293551445, -81.99368011951447, -90.1398845538497, -55.613943554461, -42.4509010463953, -90.20997060090303, -21.452393017709255, -41.581609182059765, -23.30727744847536, 3.94020713865757, -51.44233230501413, -162.7716861590743, -48.5893646851182, -12.62697023153305, -127.06014824658632, -77.03673551976681, -35.00406768172979, -29.99999998509884, -56.99224451184273, -9.819872818887234, -55.634311489760876, -81.6614056751132, -41.962259747087955, -110.41210505366325, -99.70000004023314, -59.95352956652641, -58.48936441540718, -32.14877649396658, -109.17791374027729, -41.40469882637262, -46.46923665702343, -20.588461995124817, -23.77168619632721, -13.581609383225441, -81.52006683498621, -113.34672003239393, -56.526816725730896, -85.4665723964572, -42.86105064302683, -32.496264688670635, -96.09805869311094, -42.256492763757706, -68.59606838971376, -59.222610004246235, -56.74783067405224, -18.047830641269684, -103.42910493165255, -26.41423862427473, -45.16958627104759, -26.86550922691822, -67.71685844659805, -28.199999928474426], "episode_lengths": [252, 243, 240, 240, 243, 306, 254, 272, 213, 274, 213, 239, 230, 235, 253, 232, 245, 235, 262, 263, 227, 267, 264, 245, 258, 242, 247, 281, 220, 249, 217, 249, 216, 252, 285, 213, 242, 258, 275, 228, 209, 149, 260, 257, 242, 253, 316, 265, 234, 257, 262, 246, 241, 264, 228, 234, 225, 201, 240, 282, 234, 228, 266, 256, 236, 230, 239, 222, 236, 267, 245, 283, 259, 259, 244, 238, 286, 242, 246, 219, 233, 219, 259, 289, 238, 264, 238, 223, 276, 229, 260, 254, 253, 230, 272, 230, 261, 234, 255, 217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5877935183055796, "mean_inference_ms": 7.267435181158634, "mean_action_processing_ms": 0.11891540933292927, "mean_env_wait_ms": 4.688209054662378, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 962.6378561332822, "episode_reward_min": -215.74673757702112, "episode_reward_mean": -49.078783860579136, "episode_len_mean": 246.13, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72.70118203759193, -54.56499394029379, -27.867143996059895, -37.549901470541954, -45.83123508840799, -193.84770765900612, -98.59224436432123, -105.22548338770866, -3.7990973740816116, -122.18209854513407, -8.824578672647476, -51.22457858920097, -31.78936465829611, -36.18846210837364, -49.242523327469826, -25.727469742298126, -38.97950929403305, -23.95228900015354, -57.147324942052364, -99.60997048020363, -33.03876180201769, -98.71802674978971, -105.83431354910135, -24.494104385375977, -60.44915737956762, -48.87782645970583, -68.26412101835012, -117.17475632578135, -15.527458690106869, -57.059971675276756, -21.089364610612392, -48.86321850866079, 1.4069703593850136, -71.94643273949623, -129.83580695092678, 7.28565376251936, -34.63423674553633, -90.78936456143856, -122.75329545885324, -22.586779735982418, 10.90911389887333, 962.6378561332822, -83.63948372006416, -61.74730474501848, -62.58936459571123, -61.288509510457516, -215.74673757702112, -99.36412101984024, -48.868389293551445, -81.99368011951447, -90.1398845538497, -55.613943554461, -42.4509010463953, -90.20997060090303, -21.452393017709255, -41.581609182059765, -23.30727744847536, 3.94020713865757, -51.44233230501413, -162.7716861590743, -48.5893646851182, -12.62697023153305, -127.06014824658632, -77.03673551976681, -35.00406768172979, -29.99999998509884, -56.99224451184273, -9.819872818887234, -55.634311489760876, -81.6614056751132, -41.962259747087955, -110.41210505366325, -99.70000004023314, -59.95352956652641, -58.48936441540718, -32.14877649396658, -109.17791374027729, -41.40469882637262, -46.46923665702343, -20.588461995124817, -23.77168619632721, -13.581609383225441, -81.52006683498621, -113.34672003239393, -56.526816725730896, -85.4665723964572, -42.86105064302683, -32.496264688670635, -96.09805869311094, -42.256492763757706, -68.59606838971376, -59.222610004246235, -56.74783067405224, -18.047830641269684, -103.42910493165255, -26.41423862427473, -45.16958627104759, -26.86550922691822, -67.71685844659805, -28.199999928474426], "episode_lengths": [252, 243, 240, 240, 243, 306, 254, 272, 213, 274, 213, 239, 230, 235, 253, 232, 245, 235, 262, 263, 227, 267, 264, 245, 258, 242, 247, 281, 220, 249, 217, 249, 216, 252, 285, 213, 242, 258, 275, 228, 209, 149, 260, 257, 242, 253, 316, 265, 234, 257, 262, 246, 241, 264, 228, 234, 225, 201, 240, 282, 234, 228, 266, 256, 236, 230, 239, 222, 236, 267, 245, 283, 259, 259, 244, 238, 286, 242, 246, 219, 233, 219, 259, 289, 238, 264, 238, 223, 276, 229, 260, 254, 253, 230, 272, 230, 261, 234, 255, 217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5877935183055796, "mean_inference_ms": 7.267435181158634, "mean_action_processing_ms": 0.11891540933292927, "mean_env_wait_ms": 4.688209054662378, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 88000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 42177.979, "learn_time_ms": 38631.926, "learn_throughput": 103.541, "update_time_ms": 27.004}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 342, "training_iteration": 22, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-14-06", "timestamp": 1655536446, "time_this_iter_s": 42.073755741119385, "time_total_s": 921.0784277915955, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 921.0784277915955, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 21.34576271186441, "ram_util_percent": 63.57966101694917}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.53125, "cur_lr": 0.0007999999797903001, "total_loss": 6.428990840911865, "policy_loss": -0.0995858833193779, "vf_loss": 6.487803936004639, "vf_explained_var": -0.024308551102876663, "kl": 0.01610773429274559, "entropy": 1.8860336542129517, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 962.6378561332822, "episode_reward_min": -232.2561755925417, "episode_reward_mean": -52.74578289091587, "episode_len_mean": 248.31, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.97950929403305, -23.95228900015354, -57.147324942052364, -99.60997048020363, -33.03876180201769, -98.71802674978971, -105.83431354910135, -24.494104385375977, -60.44915737956762, -48.87782645970583, -68.26412101835012, -117.17475632578135, -15.527458690106869, -57.059971675276756, -21.089364610612392, -48.86321850866079, 1.4069703593850136, -71.94643273949623, -129.83580695092678, 7.28565376251936, -34.63423674553633, -90.78936456143856, -122.75329545885324, -22.586779735982418, 10.90911389887333, 962.6378561332822, -83.63948372006416, -61.74730474501848, -62.58936459571123, -61.288509510457516, -215.74673757702112, -99.36412101984024, -48.868389293551445, -81.99368011951447, -90.1398845538497, -55.613943554461, -42.4509010463953, -90.20997060090303, -21.452393017709255, -41.581609182059765, -23.30727744847536, 3.94020713865757, -51.44233230501413, -162.7716861590743, -48.5893646851182, -12.62697023153305, -127.06014824658632, -77.03673551976681, -35.00406768172979, -29.99999998509884, -56.99224451184273, -9.819872818887234, -55.634311489760876, -81.6614056751132, -41.962259747087955, -110.41210505366325, -99.70000004023314, -59.95352956652641, -58.48936441540718, -32.14877649396658, -109.17791374027729, -41.40469882637262, -46.46923665702343, -20.588461995124817, -23.77168619632721, -13.581609383225441, -81.52006683498621, -113.34672003239393, -56.526816725730896, -85.4665723964572, -42.86105064302683, -32.496264688670635, -96.09805869311094, -42.256492763757706, -68.59606838971376, -59.222610004246235, -56.74783067405224, -18.047830641269684, -103.42910493165255, -26.41423862427473, -45.16958627104759, -26.86550922691822, -67.71685844659805, -28.199999928474426, -33.70073491334915, -72.80997028201818, -95.4920380115509, -136.20948132872581, -30.946986578404903, -99.48936468362808, 11.912392921745777, -33.9850632250309, -34.96963403373957, -232.2561755925417, -170.53912495821714, -78.17168606817722, -60.55617577582598, -103.59134206920862, -79.87385398894548, -81.1787294074893], "episode_lengths": [245, 235, 262, 263, 227, 267, 264, 245, 258, 242, 247, 281, 220, 249, 217, 249, 216, 252, 285, 213, 242, 258, 275, 228, 209, 149, 260, 257, 242, 253, 316, 265, 234, 257, 262, 246, 241, 264, 228, 234, 225, 201, 240, 282, 234, 228, 266, 256, 236, 230, 239, 222, 236, 267, 245, 283, 259, 259, 244, 238, 286, 242, 246, 219, 233, 219, 259, 289, 238, 264, 238, 223, 276, 229, 260, 254, 253, 230, 272, 230, 261, 234, 255, 217, 239, 253, 271, 282, 243, 273, 223, 240, 242, 309, 296, 253, 253, 269, 255, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5881277734022867, "mean_inference_ms": 7.2750971385785554, "mean_action_processing_ms": 0.11914027460983778, "mean_env_wait_ms": 4.689038860464506, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 962.6378561332822, "episode_reward_min": -232.2561755925417, "episode_reward_mean": -52.74578289091587, "episode_len_mean": 248.31, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-38.97950929403305, -23.95228900015354, -57.147324942052364, -99.60997048020363, -33.03876180201769, -98.71802674978971, -105.83431354910135, -24.494104385375977, -60.44915737956762, -48.87782645970583, -68.26412101835012, -117.17475632578135, -15.527458690106869, -57.059971675276756, -21.089364610612392, -48.86321850866079, 1.4069703593850136, -71.94643273949623, -129.83580695092678, 7.28565376251936, -34.63423674553633, -90.78936456143856, -122.75329545885324, -22.586779735982418, 10.90911389887333, 962.6378561332822, -83.63948372006416, -61.74730474501848, -62.58936459571123, -61.288509510457516, -215.74673757702112, -99.36412101984024, -48.868389293551445, -81.99368011951447, -90.1398845538497, -55.613943554461, -42.4509010463953, -90.20997060090303, -21.452393017709255, -41.581609182059765, -23.30727744847536, 3.94020713865757, -51.44233230501413, -162.7716861590743, -48.5893646851182, -12.62697023153305, -127.06014824658632, -77.03673551976681, -35.00406768172979, -29.99999998509884, -56.99224451184273, -9.819872818887234, -55.634311489760876, -81.6614056751132, -41.962259747087955, -110.41210505366325, -99.70000004023314, -59.95352956652641, -58.48936441540718, -32.14877649396658, -109.17791374027729, -41.40469882637262, -46.46923665702343, -20.588461995124817, -23.77168619632721, -13.581609383225441, -81.52006683498621, -113.34672003239393, -56.526816725730896, -85.4665723964572, -42.86105064302683, -32.496264688670635, -96.09805869311094, -42.256492763757706, -68.59606838971376, -59.222610004246235, -56.74783067405224, -18.047830641269684, -103.42910493165255, -26.41423862427473, -45.16958627104759, -26.86550922691822, -67.71685844659805, -28.199999928474426, -33.70073491334915, -72.80997028201818, -95.4920380115509, -136.20948132872581, -30.946986578404903, -99.48936468362808, 11.912392921745777, -33.9850632250309, -34.96963403373957, -232.2561755925417, -170.53912495821714, -78.17168606817722, -60.55617577582598, -103.59134206920862, -79.87385398894548, -81.1787294074893], "episode_lengths": [245, 235, 262, 263, 227, 267, 264, 245, 258, 242, 247, 281, 220, 249, 217, 249, 216, 252, 285, 213, 242, 258, 275, 228, 209, 149, 260, 257, 242, 253, 316, 265, 234, 257, 262, 246, 241, 264, 228, 234, 225, 201, 240, 282, 234, 228, 266, 256, 236, 230, 239, 222, 236, 267, 245, 283, 259, 259, 244, 238, 286, 242, 246, 219, 233, 219, 259, 289, 238, 264, 238, 223, 276, 229, 260, 254, 253, 230, 272, 230, 261, 234, 255, 217, 239, 253, 271, 282, 243, 273, 223, 240, 242, 309, 296, 253, 253, 269, 255, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5881277734022867, "mean_inference_ms": 7.2750971385785554, "mean_action_processing_ms": 0.11914027460983778, "mean_env_wait_ms": 4.689038860464506, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 92000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 42247.408, "learn_time_ms": 38697.353, "learn_throughput": 103.366, "update_time_ms": 27.004}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 358, "training_iteration": 23, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-14-49", "timestamp": 1655536489, "time_this_iter_s": 43.25516867637634, "time_total_s": 964.3335964679718, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 964.3335964679718, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 24.877049180327873, "ram_util_percent": 63.80655737704917}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.53125, "cur_lr": 0.0007999999797903001, "total_loss": 5.977628707885742, "policy_loss": -0.09172029793262482, "vf_loss": 6.029332160949707, "vf_explained_var": 0.05433717742562294, "kl": 0.015808971598744392, "entropy": 1.8535960912704468, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 962.6378561332822, "episode_reward_min": -272.97596430778503, "episode_reward_mean": -54.971155500113966, "episode_len_mean": 249.48, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.94643273949623, -129.83580695092678, 7.28565376251936, -34.63423674553633, -90.78936456143856, -122.75329545885324, -22.586779735982418, 10.90911389887333, 962.6378561332822, -83.63948372006416, -61.74730474501848, -62.58936459571123, -61.288509510457516, -215.74673757702112, -99.36412101984024, -48.868389293551445, -81.99368011951447, -90.1398845538497, -55.613943554461, -42.4509010463953, -90.20997060090303, -21.452393017709255, -41.581609182059765, -23.30727744847536, 3.94020713865757, -51.44233230501413, -162.7716861590743, -48.5893646851182, -12.62697023153305, -127.06014824658632, -77.03673551976681, -35.00406768172979, -29.99999998509884, -56.99224451184273, -9.819872818887234, -55.634311489760876, -81.6614056751132, -41.962259747087955, -110.41210505366325, -99.70000004023314, -59.95352956652641, -58.48936441540718, -32.14877649396658, -109.17791374027729, -41.40469882637262, -46.46923665702343, -20.588461995124817, -23.77168619632721, -13.581609383225441, -81.52006683498621, -113.34672003239393, -56.526816725730896, -85.4665723964572, -42.86105064302683, -32.496264688670635, -96.09805869311094, -42.256492763757706, -68.59606838971376, -59.222610004246235, -56.74783067405224, -18.047830641269684, -103.42910493165255, -26.41423862427473, -45.16958627104759, -26.86550922691822, -67.71685844659805, -28.199999928474426, -33.70073491334915, -72.80997028201818, -95.4920380115509, -136.20948132872581, -30.946986578404903, -99.48936468362808, 11.912392921745777, -33.9850632250309, -34.96963403373957, -232.2561755925417, -170.53912495821714, -78.17168606817722, -60.55617577582598, -103.59134206920862, -79.87385398894548, -81.1787294074893, -199.43923711776733, -30.557801470160484, -127.55487376451492, -16.250946827232838, 8.831563249230385, -50.158466286957264, -53.46056554466486, -272.97596430778503, 21.860219925642014, -57.08894003927708, 13.710397198796272, -34.6893644630909, -156.20200364291668, -5.969626545906067, -7.150912277400494, -45.48936456441879, -127.6245789527893], "episode_lengths": [252, 285, 213, 242, 258, 275, 228, 209, 149, 260, 257, 242, 253, 316, 265, 234, 257, 262, 246, 241, 264, 228, 234, 225, 201, 240, 282, 234, 228, 266, 256, 236, 230, 239, 222, 236, 267, 245, 283, 259, 259, 244, 238, 286, 242, 246, 219, 233, 219, 259, 289, 238, 264, 238, 223, 276, 229, 260, 254, 253, 230, 272, 230, 261, 234, 255, 217, 239, 253, 271, 282, 243, 273, 223, 240, 242, 309, 296, 253, 253, 269, 255, 256, 310, 242, 293, 232, 218, 238, 244, 342, 211, 250, 217, 231, 293, 241, 237, 230, 275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.589010134866907, "mean_inference_ms": 7.279170098444565, "mean_action_processing_ms": 0.11915051223777408, "mean_env_wait_ms": 4.6936959363492665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 962.6378561332822, "episode_reward_min": -272.97596430778503, "episode_reward_mean": -54.971155500113966, "episode_len_mean": 249.48, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-71.94643273949623, -129.83580695092678, 7.28565376251936, -34.63423674553633, -90.78936456143856, -122.75329545885324, -22.586779735982418, 10.90911389887333, 962.6378561332822, -83.63948372006416, -61.74730474501848, -62.58936459571123, -61.288509510457516, -215.74673757702112, -99.36412101984024, -48.868389293551445, -81.99368011951447, -90.1398845538497, -55.613943554461, -42.4509010463953, -90.20997060090303, -21.452393017709255, -41.581609182059765, -23.30727744847536, 3.94020713865757, -51.44233230501413, -162.7716861590743, -48.5893646851182, -12.62697023153305, -127.06014824658632, -77.03673551976681, -35.00406768172979, -29.99999998509884, -56.99224451184273, -9.819872818887234, -55.634311489760876, -81.6614056751132, -41.962259747087955, -110.41210505366325, -99.70000004023314, -59.95352956652641, -58.48936441540718, -32.14877649396658, -109.17791374027729, -41.40469882637262, -46.46923665702343, -20.588461995124817, -23.77168619632721, -13.581609383225441, -81.52006683498621, -113.34672003239393, -56.526816725730896, -85.4665723964572, -42.86105064302683, -32.496264688670635, -96.09805869311094, -42.256492763757706, -68.59606838971376, -59.222610004246235, -56.74783067405224, -18.047830641269684, -103.42910493165255, -26.41423862427473, -45.16958627104759, -26.86550922691822, -67.71685844659805, -28.199999928474426, -33.70073491334915, -72.80997028201818, -95.4920380115509, -136.20948132872581, -30.946986578404903, -99.48936468362808, 11.912392921745777, -33.9850632250309, -34.96963403373957, -232.2561755925417, -170.53912495821714, -78.17168606817722, -60.55617577582598, -103.59134206920862, -79.87385398894548, -81.1787294074893, -199.43923711776733, -30.557801470160484, -127.55487376451492, -16.250946827232838, 8.831563249230385, -50.158466286957264, -53.46056554466486, -272.97596430778503, 21.860219925642014, -57.08894003927708, 13.710397198796272, -34.6893644630909, -156.20200364291668, -5.969626545906067, -7.150912277400494, -45.48936456441879, -127.6245789527893], "episode_lengths": [252, 285, 213, 242, 258, 275, 228, 209, 149, 260, 257, 242, 253, 316, 265, 234, 257, 262, 246, 241, 264, 228, 234, 225, 201, 240, 282, 234, 228, 266, 256, 236, 230, 239, 222, 236, 267, 245, 283, 259, 259, 244, 238, 286, 242, 246, 219, 233, 219, 259, 289, 238, 264, 238, 223, 276, 229, 260, 254, 253, 230, 272, 230, 261, 234, 255, 217, 239, 253, 271, 282, 243, 273, 223, 240, 242, 309, 296, 253, 253, 269, 255, 256, 310, 242, 293, 232, 218, 238, 244, 342, 211, 250, 217, 231, 293, 241, 237, 230, 275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.589010134866907, "mean_inference_ms": 7.279170098444565, "mean_action_processing_ms": 0.11915051223777408, "mean_env_wait_ms": 4.6936959363492665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 96000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 42298.164, "learn_time_ms": 38735.316, "learn_throughput": 103.265, "update_time_ms": 26.906}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 375, "training_iteration": 24, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-15-32", "timestamp": 1655536532, "time_this_iter_s": 43.01478886604309, "time_total_s": 1007.3483853340149, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 1007.3483853340149, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 24.528333333333332, "ram_util_percent": 63.93333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.53125, "cur_lr": 0.0007999999797903001, "total_loss": 6.713440895080566, "policy_loss": -0.09668604284524918, "vf_loss": 6.768253803253174, "vf_explained_var": 0.12342572212219238, "kl": 0.016542749479413033, "entropy": 1.8569782972335815, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 21.860219925642014, "episode_reward_min": -272.97596430778503, "episode_reward_mean": -62.92139393739402, "episode_len_mean": 249.67, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-90.1398845538497, -55.613943554461, -42.4509010463953, -90.20997060090303, -21.452393017709255, -41.581609182059765, -23.30727744847536, 3.94020713865757, -51.44233230501413, -162.7716861590743, -48.5893646851182, -12.62697023153305, -127.06014824658632, -77.03673551976681, -35.00406768172979, -29.99999998509884, -56.99224451184273, -9.819872818887234, -55.634311489760876, -81.6614056751132, -41.962259747087955, -110.41210505366325, -99.70000004023314, -59.95352956652641, -58.48936441540718, -32.14877649396658, -109.17791374027729, -41.40469882637262, -46.46923665702343, -20.588461995124817, -23.77168619632721, -13.581609383225441, -81.52006683498621, -113.34672003239393, -56.526816725730896, -85.4665723964572, -42.86105064302683, -32.496264688670635, -96.09805869311094, -42.256492763757706, -68.59606838971376, -59.222610004246235, -56.74783067405224, -18.047830641269684, -103.42910493165255, -26.41423862427473, -45.16958627104759, -26.86550922691822, -67.71685844659805, -28.199999928474426, -33.70073491334915, -72.80997028201818, -95.4920380115509, -136.20948132872581, -30.946986578404903, -99.48936468362808, 11.912392921745777, -33.9850632250309, -34.96963403373957, -232.2561755925417, -170.53912495821714, -78.17168606817722, -60.55617577582598, -103.59134206920862, -79.87385398894548, -81.1787294074893, -199.43923711776733, -30.557801470160484, -127.55487376451492, -16.250946827232838, 8.831563249230385, -50.158466286957264, -53.46056554466486, -272.97596430778503, 21.860219925642014, -57.08894003927708, 13.710397198796272, -34.6893644630909, -156.20200364291668, -5.969626545906067, -7.150912277400494, -45.48936456441879, -127.6245789527893, -50.13501851260662, -60.16524150967598, -41.23439455777407, -57.77872933447361, -80.02694342285395, -55.51323144137859, -58.29291082918644, -6.813943438231945, -45.78207256644964, -53.492399744689465, -220.82060580700636, 10.246704660356045, -30.060148008167744, -142.0965156033635, -76.87048856168985, -7.2816091030836105, -25.857178926467896], "episode_lengths": [262, 246, 241, 264, 228, 234, 225, 201, 240, 282, 234, 228, 266, 256, 236, 230, 239, 222, 236, 267, 245, 283, 259, 259, 244, 238, 286, 242, 246, 219, 233, 219, 259, 289, 238, 264, 238, 223, 276, 229, 260, 254, 253, 230, 272, 230, 261, 234, 255, 217, 239, 253, 271, 282, 243, 273, 223, 240, 242, 309, 296, 253, 253, 269, 255, 256, 310, 242, 293, 232, 218, 238, 244, 342, 211, 250, 217, 231, 293, 241, 237, 230, 275, 243, 259, 245, 238, 254, 262, 250, 217, 244, 262, 311, 197, 231, 293, 256, 214, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.590468994578649, "mean_inference_ms": 7.286349965317496, "mean_action_processing_ms": 0.11921682259806338, "mean_env_wait_ms": 4.697261298668943, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 21.860219925642014, "episode_reward_min": -272.97596430778503, "episode_reward_mean": -62.92139393739402, "episode_len_mean": 249.67, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-90.1398845538497, -55.613943554461, -42.4509010463953, -90.20997060090303, -21.452393017709255, -41.581609182059765, -23.30727744847536, 3.94020713865757, -51.44233230501413, -162.7716861590743, -48.5893646851182, -12.62697023153305, -127.06014824658632, -77.03673551976681, -35.00406768172979, -29.99999998509884, -56.99224451184273, -9.819872818887234, -55.634311489760876, -81.6614056751132, -41.962259747087955, -110.41210505366325, -99.70000004023314, -59.95352956652641, -58.48936441540718, -32.14877649396658, -109.17791374027729, -41.40469882637262, -46.46923665702343, -20.588461995124817, -23.77168619632721, -13.581609383225441, -81.52006683498621, -113.34672003239393, -56.526816725730896, -85.4665723964572, -42.86105064302683, -32.496264688670635, -96.09805869311094, -42.256492763757706, -68.59606838971376, -59.222610004246235, -56.74783067405224, -18.047830641269684, -103.42910493165255, -26.41423862427473, -45.16958627104759, -26.86550922691822, -67.71685844659805, -28.199999928474426, -33.70073491334915, -72.80997028201818, -95.4920380115509, -136.20948132872581, -30.946986578404903, -99.48936468362808, 11.912392921745777, -33.9850632250309, -34.96963403373957, -232.2561755925417, -170.53912495821714, -78.17168606817722, -60.55617577582598, -103.59134206920862, -79.87385398894548, -81.1787294074893, -199.43923711776733, -30.557801470160484, -127.55487376451492, -16.250946827232838, 8.831563249230385, -50.158466286957264, -53.46056554466486, -272.97596430778503, 21.860219925642014, -57.08894003927708, 13.710397198796272, -34.6893644630909, -156.20200364291668, -5.969626545906067, -7.150912277400494, -45.48936456441879, -127.6245789527893, -50.13501851260662, -60.16524150967598, -41.23439455777407, -57.77872933447361, -80.02694342285395, -55.51323144137859, -58.29291082918644, -6.813943438231945, -45.78207256644964, -53.492399744689465, -220.82060580700636, 10.246704660356045, -30.060148008167744, -142.0965156033635, -76.87048856168985, -7.2816091030836105, -25.857178926467896], "episode_lengths": [262, 246, 241, 264, 228, 234, 225, 201, 240, 282, 234, 228, 266, 256, 236, 230, 239, 222, 236, 267, 245, 283, 259, 259, 244, 238, 286, 242, 246, 219, 233, 219, 259, 289, 238, 264, 238, 223, 276, 229, 260, 254, 253, 230, 272, 230, 261, 234, 255, 217, 239, 253, 271, 282, 243, 273, 223, 240, 242, 309, 296, 253, 253, 269, 255, 256, 310, 242, 293, 232, 218, 238, 244, 342, 211, 250, 217, 231, 293, 241, 237, 230, 275, 243, 259, 245, 238, 254, 262, 250, 217, 244, 262, 311, 197, 231, 293, 256, 214, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.590468994578649, "mean_inference_ms": 7.286349965317496, "mean_action_processing_ms": 0.11921682259806338, "mean_env_wait_ms": 4.697261298668943, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 100000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 42316.405, "learn_time_ms": 38743.161, "learn_throughput": 103.244, "update_time_ms": 26.906}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "episodes_total": 392, "training_iteration": 25, "trial_id": "7dfca_00001", "experiment_id": "59d016676ded4248a7d3cb7f5697a35c", "date": "2022-06-18_10-16-15", "timestamp": 1655536575, "time_this_iter_s": 42.23601841926575, "time_total_s": 1049.5844037532806, "pid": 33460, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 1049.5844037532806, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 15.349945783615112, "perf": {"cpu_util_percent": 21.991666666666664, "ram_util_percent": 63.800000000000004}}
