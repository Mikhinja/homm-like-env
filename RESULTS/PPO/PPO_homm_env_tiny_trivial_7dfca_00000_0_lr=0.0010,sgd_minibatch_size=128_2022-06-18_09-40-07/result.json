{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0, "cur_lr": 0.0010000000474974513, "total_loss": 7.884820461273193, "policy_loss": -0.04823833703994751, "vf_loss": 7.91546106338501, "vf_explained_var": 0.05123935267329216, "kl": 0.017597544938325882, "entropy": 2.0617499351501465, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -4.403307847678661, "episode_reward_min": -59.722705937922, "episode_reward_mean": -22.208344094455242, "episode_len_mean": 231.66666666666666, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.941113032400608, -4.403307847678661, -59.722705937922, -13.876994758844376, -39.06708940118551, -6.2388535887002945], "episode_lengths": [235, 225, 241, 227, 242, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5681033470082885, "mean_inference_ms": 7.468516291533491, "mean_action_processing_ms": 0.11613565295499319, "mean_env_wait_ms": 5.26721575662276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -4.403307847678661, "episode_reward_min": -59.722705937922, "episode_reward_mean": -22.208344094455242, "episode_len_mean": 231.66666666666666, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.941113032400608, -4.403307847678661, -59.722705937922, -13.876994758844376, -39.06708940118551, -6.2388535887002945], "episode_lengths": [235, 225, 241, 227, 242, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5681033470082885, "mean_inference_ms": 7.468516291533491, "mean_action_processing_ms": 0.11613565295499319, "mean_env_wait_ms": 5.26721575662276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 43479.916, "learn_time_ms": 39374.873, "learn_throughput": 101.588, "update_time_ms": 27.984}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 6, "training_iteration": 1, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-41-18", "timestamp": 1655534478, "time_this_iter_s": 43.488911151885986, "time_total_s": 43.488911151885986, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 43.488911151885986, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 22.860655737704917, "ram_util_percent": 62.137704918032775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0, "cur_lr": 0.0010000000474974513, "total_loss": 7.452427387237549, "policy_loss": -0.059108708053827286, "vf_loss": 7.490738868713379, "vf_explained_var": 0.006627054885029793, "kl": 0.02079656533896923, "entropy": 2.0394275188446045, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -4.403307847678661, "episode_reward_min": -157.67217185348272, "episode_reward_mean": -75.46945562586188, "episode_len_mean": 255.55, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.941113032400608, -4.403307847678661, -59.722705937922, -13.876994758844376, -39.06708940118551, -6.2388535887002945, -157.67217185348272, -124.78538227081299, -78.77947346121073, -136.8973809108138, -29.80718171596527, -90.18160911649466, -78.79909755289555, -52.99914492666721, -72.98846193403006, -130.6893645003438, -111.16105081886053, -126.29999999701977, -62.18936441093683, -122.88936448097229], "episode_lengths": [235, 225, 241, 227, 242, 220, 293, 285, 265, 275, 246, 265, 255, 246, 254, 286, 262, 268, 249, 272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5420124509652309, "mean_inference_ms": 7.56025508571923, "mean_action_processing_ms": 0.12441586473977037, "mean_env_wait_ms": 5.165909773225527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -4.403307847678661, "episode_reward_min": -157.67217185348272, "episode_reward_mean": -75.46945562586188, "episode_len_mean": 255.55, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.941113032400608, -4.403307847678661, -59.722705937922, -13.876994758844376, -39.06708940118551, -6.2388535887002945, -157.67217185348272, -124.78538227081299, -78.77947346121073, -136.8973809108138, -29.80718171596527, -90.18160911649466, -78.79909755289555, -52.99914492666721, -72.98846193403006, -130.6893645003438, -111.16105081886053, -126.29999999701977, -62.18936441093683, -122.88936448097229], "episode_lengths": [235, 225, 241, 227, 242, 220, 293, 285, 265, 275, 246, 265, 255, 246, 254, 286, 262, 268, 249, 272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5420124509652309, "mean_inference_ms": 7.56025508571923, "mean_action_processing_ms": 0.12441586473977037, "mean_env_wait_ms": 5.165909773225527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 43012.601, "learn_time_ms": 39108.138, "learn_throughput": 102.281, "update_time_ms": 28.309}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-42-00", "timestamp": 1655534520, "time_this_iter_s": 42.554283142089844, "time_total_s": 86.04319429397583, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 86.04319429397583, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 22.48833333333333, "ram_util_percent": 62.28166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0010000000474974513, "total_loss": 7.711674690246582, "policy_loss": -0.056316133588552475, "vf_loss": 7.743039608001709, "vf_explained_var": -0.04175126925110817, "kl": 0.01663403958082199, "entropy": 2.0262556076049805, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -4.403307847678661, "episode_reward_min": -157.67217185348272, "episode_reward_mean": -76.73331209666588, "episode_len_mean": 257.2352941176471, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.941113032400608, -4.403307847678661, -59.722705937922, -13.876994758844376, -39.06708940118551, -6.2388535887002945, -157.67217185348272, -124.78538227081299, -78.77947346121073, -136.8973809108138, -29.80718171596527, -90.18160911649466, -78.79909755289555, -52.99914492666721, -72.98846193403006, -130.6893645003438, -111.16105081886053, -126.29999999701977, -62.18936441093683, -122.88936448097229, -140.3893646299839, -81.18936461955309, -75.72745867073536, -36.75720826536417, -99.92114045470953, -145.54356315732002, -88.69224462658167, -73.7716858536005, -7.0061953365802765, -61.45846600085497, -94.42732531577349, -88.09004033356905, -80.57111521810293, -25.998326286673546], "episode_lengths": [235, 225, 241, 227, 242, 220, 293, 285, 265, 275, 246, 265, 255, 246, 254, 286, 262, 268, 249, 272, 283, 257, 252, 240, 267, 291, 267, 255, 221, 257, 272, 267, 267, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5454786007283292, "mean_inference_ms": 7.551110876437825, "mean_action_processing_ms": 0.12705276169011817, "mean_env_wait_ms": 5.082956991290296, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -4.403307847678661, "episode_reward_min": -157.67217185348272, "episode_reward_mean": -76.73331209666588, "episode_len_mean": 257.2352941176471, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.941113032400608, -4.403307847678661, -59.722705937922, -13.876994758844376, -39.06708940118551, -6.2388535887002945, -157.67217185348272, -124.78538227081299, -78.77947346121073, -136.8973809108138, -29.80718171596527, -90.18160911649466, -78.79909755289555, -52.99914492666721, -72.98846193403006, -130.6893645003438, -111.16105081886053, -126.29999999701977, -62.18936441093683, -122.88936448097229, -140.3893646299839, -81.18936461955309, -75.72745867073536, -36.75720826536417, -99.92114045470953, -145.54356315732002, -88.69224462658167, -73.7716858536005, -7.0061953365802765, -61.45846600085497, -94.42732531577349, -88.09004033356905, -80.57111521810293, -25.998326286673546], "episode_lengths": [235, 225, 241, 227, 242, 220, 293, 285, 265, 275, 246, 265, 255, 246, 254, 286, 262, 268, 249, 272, 283, 257, 252, 240, 267, 291, 267, 255, 221, 257, 272, 267, 267, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5454786007283292, "mean_inference_ms": 7.551110876437825, "mean_action_processing_ms": 0.12705276169011817, "mean_env_wait_ms": 5.082956991290296, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 42905.138, "learn_time_ms": 39121.055, "learn_throughput": 102.247, "update_time_ms": 28.201}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 34, "training_iteration": 3, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-42-43", "timestamp": 1655534563, "time_this_iter_s": 42.70021653175354, "time_total_s": 128.74341082572937, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 128.74341082572937, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 23.528333333333332, "ram_util_percent": 62.414999999999985}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0010000000474974513, "total_loss": 6.506606101989746, "policy_loss": -0.01862785965204239, "vf_loss": 6.51473331451416, "vf_explained_var": 0.018505478277802467, "kl": 0.007000562269240618, "entropy": 2.020901918411255, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 925.6296894773841, "episode_reward_min": -185.66880645602942, "episode_reward_mean": -64.91404868165652, "episode_len_mean": 259.0980392156863, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.941113032400608, -4.403307847678661, -59.722705937922, -13.876994758844376, -39.06708940118551, -6.2388535887002945, -157.67217185348272, -124.78538227081299, -78.77947346121073, -136.8973809108138, -29.80718171596527, -90.18160911649466, -78.79909755289555, -52.99914492666721, -72.98846193403006, -130.6893645003438, -111.16105081886053, -126.29999999701977, -62.18936441093683, -122.88936448097229, -140.3893646299839, -81.18936461955309, -75.72745867073536, -36.75720826536417, -99.92114045470953, -145.54356315732002, -88.69224462658167, -73.7716858536005, -7.0061953365802765, -61.45846600085497, -94.42732531577349, -88.09004033356905, -80.57111521810293, -25.998326286673546, -131.65388306230307, -89.04553986340761, 925.6296894773841, -56.73147910088301, -132.6884975656867, -80.63431140780449, -185.66880645602942, -62.43832413852215, -134.30360335856676, -11.678502596914768, -85.98936454206705, -9.413721293210983, -158.97168616950512, -165.4293881803751, -107.47078359872103, -149.78738011419773, -65.40828950703144], "episode_lengths": [235, 225, 241, 227, 242, 220, 293, 285, 265, 275, 246, 265, 255, 246, 254, 286, 262, 268, 249, 272, 283, 257, 252, 240, 267, 291, 267, 255, 221, 257, 272, 267, 267, 239, 293, 273, 171, 243, 287, 252, 305, 252, 286, 236, 260, 226, 281, 296, 263, 292, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5598555307855244, "mean_inference_ms": 7.549850572707997, "mean_action_processing_ms": 0.12736608718234715, "mean_env_wait_ms": 5.026175082090974, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 925.6296894773841, "episode_reward_min": -185.66880645602942, "episode_reward_mean": -64.91404868165652, "episode_len_mean": 259.0980392156863, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.941113032400608, -4.403307847678661, -59.722705937922, -13.876994758844376, -39.06708940118551, -6.2388535887002945, -157.67217185348272, -124.78538227081299, -78.77947346121073, -136.8973809108138, -29.80718171596527, -90.18160911649466, -78.79909755289555, -52.99914492666721, -72.98846193403006, -130.6893645003438, -111.16105081886053, -126.29999999701977, -62.18936441093683, -122.88936448097229, -140.3893646299839, -81.18936461955309, -75.72745867073536, -36.75720826536417, -99.92114045470953, -145.54356315732002, -88.69224462658167, -73.7716858536005, -7.0061953365802765, -61.45846600085497, -94.42732531577349, -88.09004033356905, -80.57111521810293, -25.998326286673546, -131.65388306230307, -89.04553986340761, 925.6296894773841, -56.73147910088301, -132.6884975656867, -80.63431140780449, -185.66880645602942, -62.43832413852215, -134.30360335856676, -11.678502596914768, -85.98936454206705, -9.413721293210983, -158.97168616950512, -165.4293881803751, -107.47078359872103, -149.78738011419773, -65.40828950703144], "episode_lengths": [235, 225, 241, 227, 242, 220, 293, 285, 265, 275, 246, 265, 255, 246, 254, 286, 262, 268, 249, 272, 283, 257, 252, 240, 267, 291, 267, 255, 221, 257, 272, 267, 267, 239, 293, 273, 171, 243, 287, 252, 305, 252, 286, 236, 260, 226, 281, 296, 263, 292, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5598555307855244, "mean_inference_ms": 7.549850572707997, "mean_action_processing_ms": 0.12736608718234715, "mean_env_wait_ms": 5.026175082090974, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 42743.445, "learn_time_ms": 39015.057, "learn_throughput": 102.525, "update_time_ms": 27.644}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 51, "training_iteration": 4, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-43-25", "timestamp": 1655534605, "time_this_iter_s": 42.269360303878784, "time_total_s": 171.01277112960815, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 171.01277112960815, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 22.37457627118644, "ram_util_percent": 62.41864406779661}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0010000000474974513, "total_loss": 6.387972831726074, "policy_loss": -0.06073353439569473, "vf_loss": 6.424722194671631, "vf_explained_var": 0.1267673522233963, "kl": 0.015989772975444794, "entropy": 2.005702257156372, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 925.6296894773841, "episode_reward_min": -185.66880645602942, "episode_reward_mean": -65.33517652451992, "episode_len_mean": 258.5230769230769, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.941113032400608, -4.403307847678661, -59.722705937922, -13.876994758844376, -39.06708940118551, -6.2388535887002945, -157.67217185348272, -124.78538227081299, -78.77947346121073, -136.8973809108138, -29.80718171596527, -90.18160911649466, -78.79909755289555, -52.99914492666721, -72.98846193403006, -130.6893645003438, -111.16105081886053, -126.29999999701977, -62.18936441093683, -122.88936448097229, -140.3893646299839, -81.18936461955309, -75.72745867073536, -36.75720826536417, -99.92114045470953, -145.54356315732002, -88.69224462658167, -73.7716858536005, -7.0061953365802765, -61.45846600085497, -94.42732531577349, -88.09004033356905, -80.57111521810293, -25.998326286673546, -131.65388306230307, -89.04553986340761, 925.6296894773841, -56.73147910088301, -132.6884975656867, -80.63431140780449, -185.66880645602942, -62.43832413852215, -134.30360335856676, -11.678502596914768, -85.98936454206705, -9.413721293210983, -158.97168616950512, -165.4293881803751, -107.47078359872103, -149.78738011419773, -65.40828950703144, -73.18741893023252, -79.01589249074459, -46.07872919738293, -106.92826546728611, -73.51830346137285, -29.375310510396957, -8.50858760625124, -10.768631771206856, -96.68539172410965, -79.33521419763565, -95.00389660149813, -44.76611778885126, -83.89133148640394, -109.10690009593964], "episode_lengths": [235, 225, 241, 227, 242, 220, 293, 285, 265, 275, 246, 265, 255, 246, 254, 286, 262, 268, 249, 272, 283, 257, 252, 240, 267, 291, 267, 255, 221, 257, 272, 267, 267, 239, 293, 273, 171, 243, 287, 252, 305, 252, 286, 236, 260, 226, 281, 296, 263, 292, 252, 268, 264, 240, 274, 257, 243, 238, 230, 257, 257, 275, 235, 271, 281]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5608731382437998, "mean_inference_ms": 7.53826510352471, "mean_action_processing_ms": 0.12665649753132446, "mean_env_wait_ms": 4.9917127600482525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 925.6296894773841, "episode_reward_min": -185.66880645602942, "episode_reward_mean": -65.33517652451992, "episode_len_mean": 258.5230769230769, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.941113032400608, -4.403307847678661, -59.722705937922, -13.876994758844376, -39.06708940118551, -6.2388535887002945, -157.67217185348272, -124.78538227081299, -78.77947346121073, -136.8973809108138, -29.80718171596527, -90.18160911649466, -78.79909755289555, -52.99914492666721, -72.98846193403006, -130.6893645003438, -111.16105081886053, -126.29999999701977, -62.18936441093683, -122.88936448097229, -140.3893646299839, -81.18936461955309, -75.72745867073536, -36.75720826536417, -99.92114045470953, -145.54356315732002, -88.69224462658167, -73.7716858536005, -7.0061953365802765, -61.45846600085497, -94.42732531577349, -88.09004033356905, -80.57111521810293, -25.998326286673546, -131.65388306230307, -89.04553986340761, 925.6296894773841, -56.73147910088301, -132.6884975656867, -80.63431140780449, -185.66880645602942, -62.43832413852215, -134.30360335856676, -11.678502596914768, -85.98936454206705, -9.413721293210983, -158.97168616950512, -165.4293881803751, -107.47078359872103, -149.78738011419773, -65.40828950703144, -73.18741893023252, -79.01589249074459, -46.07872919738293, -106.92826546728611, -73.51830346137285, -29.375310510396957, -8.50858760625124, -10.768631771206856, -96.68539172410965, -79.33521419763565, -95.00389660149813, -44.76611778885126, -83.89133148640394, -109.10690009593964], "episode_lengths": [235, 225, 241, 227, 242, 220, 293, 285, 265, 275, 246, 265, 255, 246, 254, 286, 262, 268, 249, 272, 283, 257, 252, 240, 267, 291, 267, 255, 221, 257, 272, 267, 267, 239, 293, 273, 171, 243, 287, 252, 305, 252, 286, 236, 260, 226, 281, 296, 263, 292, 252, 268, 264, 240, 274, 257, 243, 238, 230, 257, 257, 275, 235, 271, 281]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5608731382437998, "mean_inference_ms": 7.53826510352471, "mean_action_processing_ms": 0.12665649753132446, "mean_env_wait_ms": 4.9917127600482525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 42675.694, "learn_time_ms": 38980.923, "learn_throughput": 102.614, "update_time_ms": 27.711}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 65, "training_iteration": 5, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-44-08", "timestamp": 1655534648, "time_this_iter_s": 42.41469621658325, "time_total_s": 213.4274673461914, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 213.4274673461914, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 21.785, "ram_util_percent": 62.440000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0010000000474974513, "total_loss": 6.99995231628418, "policy_loss": -0.07816895842552185, "vf_loss": 7.051054954528809, "vf_explained_var": 0.23898859322071075, "kl": 0.018043924123048782, "entropy": 1.9951385259628296, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 925.6296894773841, "episode_reward_min": -303.48403691500425, "episode_reward_mean": -70.47774653491086, "episode_len_mean": 259.780487804878, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.941113032400608, -4.403307847678661, -59.722705937922, -13.876994758844376, -39.06708940118551, -6.2388535887002945, -157.67217185348272, -124.78538227081299, -78.77947346121073, -136.8973809108138, -29.80718171596527, -90.18160911649466, -78.79909755289555, -52.99914492666721, -72.98846193403006, -130.6893645003438, -111.16105081886053, -126.29999999701977, -62.18936441093683, -122.88936448097229, -140.3893646299839, -81.18936461955309, -75.72745867073536, -36.75720826536417, -99.92114045470953, -145.54356315732002, -88.69224462658167, -73.7716858536005, -7.0061953365802765, -61.45846600085497, -94.42732531577349, -88.09004033356905, -80.57111521810293, -25.998326286673546, -131.65388306230307, -89.04553986340761, 925.6296894773841, -56.73147910088301, -132.6884975656867, -80.63431140780449, -185.66880645602942, -62.43832413852215, -134.30360335856676, -11.678502596914768, -85.98936454206705, -9.413721293210983, -158.97168616950512, -165.4293881803751, -107.47078359872103, -149.78738011419773, -65.40828950703144, -73.18741893023252, -79.01589249074459, -46.07872919738293, -106.92826546728611, -73.51830346137285, -29.375310510396957, -8.50858760625124, -10.768631771206856, -96.68539172410965, -79.33521419763565, -95.00389660149813, -44.76611778885126, -83.89133148640394, -109.10690009593964, -133.69999989122152, -303.48403691500425, -85.38160905987024, -82.4113586768508, -27.52716840058565, -104.13541208952665, -33.27872923761606, -34.56952582299709, -101.31631007790565, -108.3787292689085, -92.04553996026516, -98.85869357734919, -47.81724060326815, -66.38846207410097, -55.52926219254732, -70.46666394174099, -87.09999997913837], "episode_lengths": [235, 225, 241, 227, 242, 220, 293, 285, 265, 275, 246, 265, 255, 246, 254, 286, 262, 268, 249, 272, 283, 257, 252, 240, 267, 291, 267, 255, 221, 257, 272, 267, 267, 239, 293, 273, 171, 243, 287, 252, 305, 252, 286, 236, 260, 226, 281, 296, 263, 292, 252, 268, 264, 240, 274, 257, 243, 238, 230, 257, 257, 275, 235, 271, 281, 267, 346, 267, 269, 240, 281, 234, 238, 276, 267, 275, 275, 248, 253, 238, 272, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620375921651237, "mean_inference_ms": 7.520804384120538, "mean_action_processing_ms": 0.12626237661518175, "mean_env_wait_ms": 4.955937000153807, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 925.6296894773841, "episode_reward_min": -303.48403691500425, "episode_reward_mean": -70.47774653491086, "episode_len_mean": 259.780487804878, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.941113032400608, -4.403307847678661, -59.722705937922, -13.876994758844376, -39.06708940118551, -6.2388535887002945, -157.67217185348272, -124.78538227081299, -78.77947346121073, -136.8973809108138, -29.80718171596527, -90.18160911649466, -78.79909755289555, -52.99914492666721, -72.98846193403006, -130.6893645003438, -111.16105081886053, -126.29999999701977, -62.18936441093683, -122.88936448097229, -140.3893646299839, -81.18936461955309, -75.72745867073536, -36.75720826536417, -99.92114045470953, -145.54356315732002, -88.69224462658167, -73.7716858536005, -7.0061953365802765, -61.45846600085497, -94.42732531577349, -88.09004033356905, -80.57111521810293, -25.998326286673546, -131.65388306230307, -89.04553986340761, 925.6296894773841, -56.73147910088301, -132.6884975656867, -80.63431140780449, -185.66880645602942, -62.43832413852215, -134.30360335856676, -11.678502596914768, -85.98936454206705, -9.413721293210983, -158.97168616950512, -165.4293881803751, -107.47078359872103, -149.78738011419773, -65.40828950703144, -73.18741893023252, -79.01589249074459, -46.07872919738293, -106.92826546728611, -73.51830346137285, -29.375310510396957, -8.50858760625124, -10.768631771206856, -96.68539172410965, -79.33521419763565, -95.00389660149813, -44.76611778885126, -83.89133148640394, -109.10690009593964, -133.69999989122152, -303.48403691500425, -85.38160905987024, -82.4113586768508, -27.52716840058565, -104.13541208952665, -33.27872923761606, -34.56952582299709, -101.31631007790565, -108.3787292689085, -92.04553996026516, -98.85869357734919, -47.81724060326815, -66.38846207410097, -55.52926219254732, -70.46666394174099, -87.09999997913837], "episode_lengths": [235, 225, 241, 227, 242, 220, 293, 285, 265, 275, 246, 265, 255, 246, 254, 286, 262, 268, 249, 272, 283, 257, 252, 240, 267, 291, 267, 255, 221, 257, 272, 267, 267, 239, 293, 273, 171, 243, 287, 252, 305, 252, 286, 236, 260, 226, 281, 296, 263, 292, 252, 268, 264, 240, 274, 257, 243, 238, 230, 257, 257, 275, 235, 271, 281, 267, 346, 267, 269, 240, 281, 234, 238, 276, 267, 275, 275, 248, 253, 238, 272, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620375921651237, "mean_inference_ms": 7.520804384120538, "mean_action_processing_ms": 0.12626237661518175, "mean_env_wait_ms": 4.955937000153807, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 42621.687, "learn_time_ms": 38951.977, "learn_throughput": 102.691, "update_time_ms": 27.935}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 82, "training_iteration": 6, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-44-50", "timestamp": 1655534690, "time_this_iter_s": 42.36164569854736, "time_total_s": 255.78911304473877, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 255.78911304473877, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 22.29333333333333, "ram_util_percent": 62.54833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0010000000474974513, "total_loss": 6.275791645050049, "policy_loss": -0.09518454968929291, "vf_loss": 6.340500831604004, "vf_explained_var": 0.3787316083908081, "kl": 0.020316775888204575, "entropy": 1.9695366621017456, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 925.6296894773841, "episode_reward_min": -303.48403691500425, "episode_reward_mean": -71.77635360701183, "episode_len_mean": 259.30927835051546, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.941113032400608, -4.403307847678661, -59.722705937922, -13.876994758844376, -39.06708940118551, -6.2388535887002945, -157.67217185348272, -124.78538227081299, -78.77947346121073, -136.8973809108138, -29.80718171596527, -90.18160911649466, -78.79909755289555, -52.99914492666721, -72.98846193403006, -130.6893645003438, -111.16105081886053, -126.29999999701977, -62.18936441093683, -122.88936448097229, -140.3893646299839, -81.18936461955309, -75.72745867073536, -36.75720826536417, -99.92114045470953, -145.54356315732002, -88.69224462658167, -73.7716858536005, -7.0061953365802765, -61.45846600085497, -94.42732531577349, -88.09004033356905, -80.57111521810293, -25.998326286673546, -131.65388306230307, -89.04553986340761, 925.6296894773841, -56.73147910088301, -132.6884975656867, -80.63431140780449, -185.66880645602942, -62.43832413852215, -134.30360335856676, -11.678502596914768, -85.98936454206705, -9.413721293210983, -158.97168616950512, -165.4293881803751, -107.47078359872103, -149.78738011419773, -65.40828950703144, -73.18741893023252, -79.01589249074459, -46.07872919738293, -106.92826546728611, -73.51830346137285, -29.375310510396957, -8.50858760625124, -10.768631771206856, -96.68539172410965, -79.33521419763565, -95.00389660149813, -44.76611778885126, -83.89133148640394, -109.10690009593964, -133.69999989122152, -303.48403691500425, -85.38160905987024, -82.4113586768508, -27.52716840058565, -104.13541208952665, -33.27872923761606, -34.56952582299709, -101.31631007790565, -108.3787292689085, -92.04553996026516, -98.85869357734919, -47.81724060326815, -66.38846207410097, -55.52926219254732, -70.46666394174099, -87.09999997913837, -24.822163991630077, -77.42911242693663, -89.41890753805637, -91.06153654307127, -54.838508039712906, -97.19999995827675, -111.59999987483025, -105.61905693262815, -125.1853916272521, 28.22656210511923, -120.33521410822868, -45.82367617636919, -57.292244620621204, -106.67475640028715, -104.05707788467407], "episode_lengths": [235, 225, 241, 227, 242, 220, 293, 285, 265, 275, 246, 265, 255, 246, 254, 286, 262, 268, 249, 272, 283, 257, 252, 240, 267, 291, 267, 255, 221, 257, 272, 267, 267, 239, 293, 273, 171, 243, 287, 252, 305, 252, 286, 236, 260, 226, 281, 296, 263, 292, 252, 268, 264, 240, 274, 257, 243, 238, 230, 257, 257, 275, 235, 271, 281, 267, 346, 267, 269, 240, 281, 234, 238, 276, 267, 275, 275, 248, 253, 238, 272, 252, 227, 268, 261, 261, 245, 264, 273, 269, 267, 219, 272, 246, 240, 272, 267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5633261083420349, "mean_inference_ms": 7.510583412079536, "mean_action_processing_ms": 0.12573367177823835, "mean_env_wait_ms": 4.927637834619065, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 925.6296894773841, "episode_reward_min": -303.48403691500425, "episode_reward_mean": -71.77635360701183, "episode_len_mean": 259.30927835051546, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.941113032400608, -4.403307847678661, -59.722705937922, -13.876994758844376, -39.06708940118551, -6.2388535887002945, -157.67217185348272, -124.78538227081299, -78.77947346121073, -136.8973809108138, -29.80718171596527, -90.18160911649466, -78.79909755289555, -52.99914492666721, -72.98846193403006, -130.6893645003438, -111.16105081886053, -126.29999999701977, -62.18936441093683, -122.88936448097229, -140.3893646299839, -81.18936461955309, -75.72745867073536, -36.75720826536417, -99.92114045470953, -145.54356315732002, -88.69224462658167, -73.7716858536005, -7.0061953365802765, -61.45846600085497, -94.42732531577349, -88.09004033356905, -80.57111521810293, -25.998326286673546, -131.65388306230307, -89.04553986340761, 925.6296894773841, -56.73147910088301, -132.6884975656867, -80.63431140780449, -185.66880645602942, -62.43832413852215, -134.30360335856676, -11.678502596914768, -85.98936454206705, -9.413721293210983, -158.97168616950512, -165.4293881803751, -107.47078359872103, -149.78738011419773, -65.40828950703144, -73.18741893023252, -79.01589249074459, -46.07872919738293, -106.92826546728611, -73.51830346137285, -29.375310510396957, -8.50858760625124, -10.768631771206856, -96.68539172410965, -79.33521419763565, -95.00389660149813, -44.76611778885126, -83.89133148640394, -109.10690009593964, -133.69999989122152, -303.48403691500425, -85.38160905987024, -82.4113586768508, -27.52716840058565, -104.13541208952665, -33.27872923761606, -34.56952582299709, -101.31631007790565, -108.3787292689085, -92.04553996026516, -98.85869357734919, -47.81724060326815, -66.38846207410097, -55.52926219254732, -70.46666394174099, -87.09999997913837, -24.822163991630077, -77.42911242693663, -89.41890753805637, -91.06153654307127, -54.838508039712906, -97.19999995827675, -111.59999987483025, -105.61905693262815, -125.1853916272521, 28.22656210511923, -120.33521410822868, -45.82367617636919, -57.292244620621204, -106.67475640028715, -104.05707788467407], "episode_lengths": [235, 225, 241, 227, 242, 220, 293, 285, 265, 275, 246, 265, 255, 246, 254, 286, 262, 268, 249, 272, 283, 257, 252, 240, 267, 291, 267, 255, 221, 257, 272, 267, 267, 239, 293, 273, 171, 243, 287, 252, 305, 252, 286, 236, 260, 226, 281, 296, 263, 292, 252, 268, 264, 240, 274, 257, 243, 238, 230, 257, 257, 275, 235, 271, 281, 267, 346, 267, 269, 240, 281, 234, 238, 276, 267, 275, 275, 248, 253, 238, 272, 252, 227, 268, 261, 261, 245, 264, 273, 269, 267, 219, 272, 246, 240, 272, 267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5633261083420349, "mean_inference_ms": 7.510583412079536, "mean_action_processing_ms": 0.12573367177823835, "mean_env_wait_ms": 4.927637834619065, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 42576.017, "learn_time_ms": 38930.791, "learn_throughput": 102.746, "update_time_ms": 27.654}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 97, "training_iteration": 7, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-45-33", "timestamp": 1655534733, "time_this_iter_s": 42.311994791030884, "time_total_s": 298.10110783576965, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 298.10110783576965, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 22.561016949152545, "ram_util_percent": 62.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0010000000474974513, "total_loss": 6.6176252365112305, "policy_loss": -0.09261567145586014, "vf_loss": 6.674837112426758, "vf_explained_var": 0.18166078627109528, "kl": 0.015735063701868057, "entropy": 1.9720827341079712, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 925.6296894773841, "episode_reward_min": -303.48403691500425, "episode_reward_mean": -70.89098063692451, "episode_len_mean": 258.96, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-130.6893645003438, -111.16105081886053, -126.29999999701977, -62.18936441093683, -122.88936448097229, -140.3893646299839, -81.18936461955309, -75.72745867073536, -36.75720826536417, -99.92114045470953, -145.54356315732002, -88.69224462658167, -73.7716858536005, -7.0061953365802765, -61.45846600085497, -94.42732531577349, -88.09004033356905, -80.57111521810293, -25.998326286673546, -131.65388306230307, -89.04553986340761, 925.6296894773841, -56.73147910088301, -132.6884975656867, -80.63431140780449, -185.66880645602942, -62.43832413852215, -134.30360335856676, -11.678502596914768, -85.98936454206705, -9.413721293210983, -158.97168616950512, -165.4293881803751, -107.47078359872103, -149.78738011419773, -65.40828950703144, -73.18741893023252, -79.01589249074459, -46.07872919738293, -106.92826546728611, -73.51830346137285, -29.375310510396957, -8.50858760625124, -10.768631771206856, -96.68539172410965, -79.33521419763565, -95.00389660149813, -44.76611778885126, -83.89133148640394, -109.10690009593964, -133.69999989122152, -303.48403691500425, -85.38160905987024, -82.4113586768508, -27.52716840058565, -104.13541208952665, -33.27872923761606, -34.56952582299709, -101.31631007790565, -108.3787292689085, -92.04553996026516, -98.85869357734919, -47.81724060326815, -66.38846207410097, -55.52926219254732, -70.46666394174099, -87.09999997913837, -24.822163991630077, -77.42911242693663, -89.41890753805637, -91.06153654307127, -54.838508039712906, -97.19999995827675, -111.59999987483025, -105.61905693262815, -125.1853916272521, 28.22656210511923, -120.33521410822868, -45.82367617636919, -57.292244620621204, -106.67475640028715, -104.05707788467407, -48.268203385174274, -74.10330788046122, -17.6787291392684, -15.624578639864922, -46.578729413449764, -144.21772852540016, -74.55723875015974, -107.1504152789712, -73.74951286613941, -15.858466289937496, -81.09417381882668, -47.01727215945721, -74.49999997764826, -61.340110681951046, -52.12199408560991, -30.62408012151718, -51.699999794363976, -66.76719131320715], "episode_lengths": [286, 262, 268, 249, 272, 283, 257, 252, 240, 267, 291, 267, 255, 221, 257, 272, 267, 267, 239, 293, 273, 171, 243, 287, 252, 305, 252, 286, 236, 260, 226, 281, 296, 263, 292, 252, 268, 264, 240, 274, 257, 243, 238, 230, 257, 257, 275, 235, 271, 281, 267, 346, 267, 269, 240, 281, 234, 238, 276, 267, 275, 275, 248, 253, 238, 272, 252, 227, 268, 261, 261, 245, 264, 273, 269, 267, 219, 272, 246, 240, 272, 267, 248, 261, 225, 222, 245, 288, 269, 259, 265, 223, 274, 239, 248, 259, 250, 247, 236, 259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5708997951769006, "mean_inference_ms": 7.487370983057185, "mean_action_processing_ms": 0.1254309909720783, "mean_env_wait_ms": 4.859014178731587, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 925.6296894773841, "episode_reward_min": -303.48403691500425, "episode_reward_mean": -70.89098063692451, "episode_len_mean": 258.96, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-130.6893645003438, -111.16105081886053, -126.29999999701977, -62.18936441093683, -122.88936448097229, -140.3893646299839, -81.18936461955309, -75.72745867073536, -36.75720826536417, -99.92114045470953, -145.54356315732002, -88.69224462658167, -73.7716858536005, -7.0061953365802765, -61.45846600085497, -94.42732531577349, -88.09004033356905, -80.57111521810293, -25.998326286673546, -131.65388306230307, -89.04553986340761, 925.6296894773841, -56.73147910088301, -132.6884975656867, -80.63431140780449, -185.66880645602942, -62.43832413852215, -134.30360335856676, -11.678502596914768, -85.98936454206705, -9.413721293210983, -158.97168616950512, -165.4293881803751, -107.47078359872103, -149.78738011419773, -65.40828950703144, -73.18741893023252, -79.01589249074459, -46.07872919738293, -106.92826546728611, -73.51830346137285, -29.375310510396957, -8.50858760625124, -10.768631771206856, -96.68539172410965, -79.33521419763565, -95.00389660149813, -44.76611778885126, -83.89133148640394, -109.10690009593964, -133.69999989122152, -303.48403691500425, -85.38160905987024, -82.4113586768508, -27.52716840058565, -104.13541208952665, -33.27872923761606, -34.56952582299709, -101.31631007790565, -108.3787292689085, -92.04553996026516, -98.85869357734919, -47.81724060326815, -66.38846207410097, -55.52926219254732, -70.46666394174099, -87.09999997913837, -24.822163991630077, -77.42911242693663, -89.41890753805637, -91.06153654307127, -54.838508039712906, -97.19999995827675, -111.59999987483025, -105.61905693262815, -125.1853916272521, 28.22656210511923, -120.33521410822868, -45.82367617636919, -57.292244620621204, -106.67475640028715, -104.05707788467407, -48.268203385174274, -74.10330788046122, -17.6787291392684, -15.624578639864922, -46.578729413449764, -144.21772852540016, -74.55723875015974, -107.1504152789712, -73.74951286613941, -15.858466289937496, -81.09417381882668, -47.01727215945721, -74.49999997764826, -61.340110681951046, -52.12199408560991, -30.62408012151718, -51.699999794363976, -66.76719131320715], "episode_lengths": [286, 262, 268, 249, 272, 283, 257, 252, 240, 267, 291, 267, 255, 221, 257, 272, 267, 267, 239, 293, 273, 171, 243, 287, 252, 305, 252, 286, 236, 260, 226, 281, 296, 263, 292, 252, 268, 264, 240, 274, 257, 243, 238, 230, 257, 257, 275, 235, 271, 281, 267, 346, 267, 269, 240, 281, 234, 238, 276, 267, 275, 275, 248, 253, 238, 272, 252, 227, 268, 261, 261, 245, 264, 273, 269, 267, 219, 272, 246, 240, 272, 267, 248, 261, 225, 222, 245, 288, 269, 259, 265, 223, 274, 239, 248, 259, 250, 247, 236, 259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5708997951769006, "mean_inference_ms": 7.487370983057185, "mean_action_processing_ms": 0.1254309909720783, "mean_env_wait_ms": 4.859014178731587, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 42579.581, "learn_time_ms": 38933.976, "learn_throughput": 102.738, "update_time_ms": 27.569}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 115, "training_iteration": 8, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-46-16", "timestamp": 1655534776, "time_this_iter_s": 42.614524364471436, "time_total_s": 340.7156322002411, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 340.7156322002411, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 22.665000000000006, "ram_util_percent": 62.78666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0010000000474974513, "total_loss": 5.540400981903076, "policy_loss": -0.09285001456737518, "vf_loss": 5.596719264984131, "vf_explained_var": 0.35081762075424194, "kl": 0.016236256808042526, "entropy": 1.9430094957351685, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 925.6296894773841, "episode_reward_min": -303.48403691500425, "episode_reward_mean": -67.05953416086733, "episode_len_mean": 257.6, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.09004033356905, -80.57111521810293, -25.998326286673546, -131.65388306230307, -89.04553986340761, 925.6296894773841, -56.73147910088301, -132.6884975656867, -80.63431140780449, -185.66880645602942, -62.43832413852215, -134.30360335856676, -11.678502596914768, -85.98936454206705, -9.413721293210983, -158.97168616950512, -165.4293881803751, -107.47078359872103, -149.78738011419773, -65.40828950703144, -73.18741893023252, -79.01589249074459, -46.07872919738293, -106.92826546728611, -73.51830346137285, -29.375310510396957, -8.50858760625124, -10.768631771206856, -96.68539172410965, -79.33521419763565, -95.00389660149813, -44.76611778885126, -83.89133148640394, -109.10690009593964, -133.69999989122152, -303.48403691500425, -85.38160905987024, -82.4113586768508, -27.52716840058565, -104.13541208952665, -33.27872923761606, -34.56952582299709, -101.31631007790565, -108.3787292689085, -92.04553996026516, -98.85869357734919, -47.81724060326815, -66.38846207410097, -55.52926219254732, -70.46666394174099, -87.09999997913837, -24.822163991630077, -77.42911242693663, -89.41890753805637, -91.06153654307127, -54.838508039712906, -97.19999995827675, -111.59999987483025, -105.61905693262815, -125.1853916272521, 28.22656210511923, -120.33521410822868, -45.82367617636919, -57.292244620621204, -106.67475640028715, -104.05707788467407, -48.268203385174274, -74.10330788046122, -17.6787291392684, -15.624578639864922, -46.578729413449764, -144.21772852540016, -74.55723875015974, -107.1504152789712, -73.74951286613941, -15.858466289937496, -81.09417381882668, -47.01727215945721, -74.49999997764826, -61.340110681951046, -52.12199408560991, -30.62408012151718, -51.699999794363976, -66.76719131320715, -144.83476215600967, 25.210573188960552, -26.58160912245512, -210.18539173156023, 5.699276641011238, -90.1893645003438, -18.871108263731003, -66.6707834303379, -151.53015216439962, -203.17475633323193, -69.91682325303555, -8.880707137286663, -23.881609342992306, 6.043444126844406, -75.83431187272072, -21.370428182184696], "episode_lengths": [267, 267, 239, 293, 273, 171, 243, 287, 252, 305, 252, 286, 236, 260, 226, 281, 296, 263, 292, 252, 268, 264, 240, 274, 257, 243, 238, 230, 257, 257, 275, 235, 271, 281, 267, 346, 267, 269, 240, 281, 234, 238, 276, 267, 275, 275, 248, 253, 238, 272, 252, 227, 268, 261, 261, 245, 264, 273, 269, 267, 219, 272, 246, 240, 272, 267, 248, 261, 225, 222, 245, 288, 269, 259, 265, 223, 274, 239, 248, 259, 250, 247, 236, 259, 282, 217, 231, 314, 226, 250, 229, 248, 298, 312, 252, 234, 239, 238, 259, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5754272421807279, "mean_inference_ms": 7.471068524497116, "mean_action_processing_ms": 0.12460228940322762, "mean_env_wait_ms": 4.815343926011082, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 925.6296894773841, "episode_reward_min": -303.48403691500425, "episode_reward_mean": -67.05953416086733, "episode_len_mean": 257.6, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-88.09004033356905, -80.57111521810293, -25.998326286673546, -131.65388306230307, -89.04553986340761, 925.6296894773841, -56.73147910088301, -132.6884975656867, -80.63431140780449, -185.66880645602942, -62.43832413852215, -134.30360335856676, -11.678502596914768, -85.98936454206705, -9.413721293210983, -158.97168616950512, -165.4293881803751, -107.47078359872103, -149.78738011419773, -65.40828950703144, -73.18741893023252, -79.01589249074459, -46.07872919738293, -106.92826546728611, -73.51830346137285, -29.375310510396957, -8.50858760625124, -10.768631771206856, -96.68539172410965, -79.33521419763565, -95.00389660149813, -44.76611778885126, -83.89133148640394, -109.10690009593964, -133.69999989122152, -303.48403691500425, -85.38160905987024, -82.4113586768508, -27.52716840058565, -104.13541208952665, -33.27872923761606, -34.56952582299709, -101.31631007790565, -108.3787292689085, -92.04553996026516, -98.85869357734919, -47.81724060326815, -66.38846207410097, -55.52926219254732, -70.46666394174099, -87.09999997913837, -24.822163991630077, -77.42911242693663, -89.41890753805637, -91.06153654307127, -54.838508039712906, -97.19999995827675, -111.59999987483025, -105.61905693262815, -125.1853916272521, 28.22656210511923, -120.33521410822868, -45.82367617636919, -57.292244620621204, -106.67475640028715, -104.05707788467407, -48.268203385174274, -74.10330788046122, -17.6787291392684, -15.624578639864922, -46.578729413449764, -144.21772852540016, -74.55723875015974, -107.1504152789712, -73.74951286613941, -15.858466289937496, -81.09417381882668, -47.01727215945721, -74.49999997764826, -61.340110681951046, -52.12199408560991, -30.62408012151718, -51.699999794363976, -66.76719131320715, -144.83476215600967, 25.210573188960552, -26.58160912245512, -210.18539173156023, 5.699276641011238, -90.1893645003438, -18.871108263731003, -66.6707834303379, -151.53015216439962, -203.17475633323193, -69.91682325303555, -8.880707137286663, -23.881609342992306, 6.043444126844406, -75.83431187272072, -21.370428182184696], "episode_lengths": [267, 267, 239, 293, 273, 171, 243, 287, 252, 305, 252, 286, 236, 260, 226, 281, 296, 263, 292, 252, 268, 264, 240, 274, 257, 243, 238, 230, 257, 257, 275, 235, 271, 281, 267, 346, 267, 269, 240, 281, 234, 238, 276, 267, 275, 275, 248, 253, 238, 272, 252, 227, 268, 261, 261, 245, 264, 273, 269, 267, 219, 272, 246, 240, 272, 267, 248, 261, 225, 222, 245, 288, 269, 259, 265, 223, 274, 239, 248, 259, 250, 247, 236, 259, 282, 217, 231, 314, 226, 250, 229, 248, 298, 312, 252, 234, 239, 238, 259, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5754272421807279, "mean_inference_ms": 7.471068524497116, "mean_action_processing_ms": 0.12460228940322762, "mean_env_wait_ms": 4.815343926011082, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 42548.603, "learn_time_ms": 38911.031, "learn_throughput": 102.799, "update_time_ms": 27.615}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 131, "training_iteration": 9, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-46-58", "timestamp": 1655534818, "time_this_iter_s": 42.31078314781189, "time_total_s": 383.026415348053, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 383.026415348053, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 22.511864406779665, "ram_util_percent": 62.810169491525436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0010000000474974513, "total_loss": 6.962613105773926, "policy_loss": -0.09954842180013657, "vf_loss": 7.023491382598877, "vf_explained_var": -0.03860372677445412, "kl": 0.017186777666211128, "entropy": 1.945064902305603, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 28.22656210511923, "episode_reward_min": -303.48403691500425, "episode_reward_mean": -78.89516896665096, "episode_len_mean": 259.3, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-165.4293881803751, -107.47078359872103, -149.78738011419773, -65.40828950703144, -73.18741893023252, -79.01589249074459, -46.07872919738293, -106.92826546728611, -73.51830346137285, -29.375310510396957, -8.50858760625124, -10.768631771206856, -96.68539172410965, -79.33521419763565, -95.00389660149813, -44.76611778885126, -83.89133148640394, -109.10690009593964, -133.69999989122152, -303.48403691500425, -85.38160905987024, -82.4113586768508, -27.52716840058565, -104.13541208952665, -33.27872923761606, -34.56952582299709, -101.31631007790565, -108.3787292689085, -92.04553996026516, -98.85869357734919, -47.81724060326815, -66.38846207410097, -55.52926219254732, -70.46666394174099, -87.09999997913837, -24.822163991630077, -77.42911242693663, -89.41890753805637, -91.06153654307127, -54.838508039712906, -97.19999995827675, -111.59999987483025, -105.61905693262815, -125.1853916272521, 28.22656210511923, -120.33521410822868, -45.82367617636919, -57.292244620621204, -106.67475640028715, -104.05707788467407, -48.268203385174274, -74.10330788046122, -17.6787291392684, -15.624578639864922, -46.578729413449764, -144.21772852540016, -74.55723875015974, -107.1504152789712, -73.74951286613941, -15.858466289937496, -81.09417381882668, -47.01727215945721, -74.49999997764826, -61.340110681951046, -52.12199408560991, -30.62408012151718, -51.699999794363976, -66.76719131320715, -144.83476215600967, 25.210573188960552, -26.58160912245512, -210.18539173156023, 5.699276641011238, -90.1893645003438, -18.871108263731003, -66.6707834303379, -151.53015216439962, -203.17475633323193, -69.91682325303555, -8.880707137286663, -23.881609342992306, 6.043444126844406, -75.83431187272072, -21.370428182184696, -58.83978018909693, -103.3676086962223, -21.351079784333706, -85.88936447352171, -177.40842389315367, -27.977629952132702, 6.422173447906971, -44.09471484273672, -165.21831966936588, -211.96321852505207, -73.84303711354733, -215.27094458788633, -85.3680936768651, -76.89999998360872, -231.80000007152557, -18.940950483083725], "episode_lengths": [296, 263, 292, 252, 268, 264, 240, 274, 257, 243, 238, 230, 257, 257, 275, 235, 271, 281, 267, 346, 267, 269, 240, 281, 234, 238, 276, 267, 275, 275, 248, 253, 238, 272, 252, 227, 268, 261, 261, 245, 264, 273, 269, 267, 219, 272, 246, 240, 272, 267, 248, 261, 225, 222, 245, 288, 269, 259, 265, 223, 274, 239, 248, 259, 250, 247, 236, 259, 282, 217, 231, 314, 226, 250, 229, 248, 298, 312, 252, 234, 239, 238, 259, 234, 253, 261, 227, 259, 307, 229, 217, 244, 299, 335, 257, 333, 267, 249, 334, 237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5747025572950359, "mean_inference_ms": 7.455325635358119, "mean_action_processing_ms": 0.12324149684812367, "mean_env_wait_ms": 4.792799536879801, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 28.22656210511923, "episode_reward_min": -303.48403691500425, "episode_reward_mean": -78.89516896665096, "episode_len_mean": 259.3, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-165.4293881803751, -107.47078359872103, -149.78738011419773, -65.40828950703144, -73.18741893023252, -79.01589249074459, -46.07872919738293, -106.92826546728611, -73.51830346137285, -29.375310510396957, -8.50858760625124, -10.768631771206856, -96.68539172410965, -79.33521419763565, -95.00389660149813, -44.76611778885126, -83.89133148640394, -109.10690009593964, -133.69999989122152, -303.48403691500425, -85.38160905987024, -82.4113586768508, -27.52716840058565, -104.13541208952665, -33.27872923761606, -34.56952582299709, -101.31631007790565, -108.3787292689085, -92.04553996026516, -98.85869357734919, -47.81724060326815, -66.38846207410097, -55.52926219254732, -70.46666394174099, -87.09999997913837, -24.822163991630077, -77.42911242693663, -89.41890753805637, -91.06153654307127, -54.838508039712906, -97.19999995827675, -111.59999987483025, -105.61905693262815, -125.1853916272521, 28.22656210511923, -120.33521410822868, -45.82367617636919, -57.292244620621204, -106.67475640028715, -104.05707788467407, -48.268203385174274, -74.10330788046122, -17.6787291392684, -15.624578639864922, -46.578729413449764, -144.21772852540016, -74.55723875015974, -107.1504152789712, -73.74951286613941, -15.858466289937496, -81.09417381882668, -47.01727215945721, -74.49999997764826, -61.340110681951046, -52.12199408560991, -30.62408012151718, -51.699999794363976, -66.76719131320715, -144.83476215600967, 25.210573188960552, -26.58160912245512, -210.18539173156023, 5.699276641011238, -90.1893645003438, -18.871108263731003, -66.6707834303379, -151.53015216439962, -203.17475633323193, -69.91682325303555, -8.880707137286663, -23.881609342992306, 6.043444126844406, -75.83431187272072, -21.370428182184696, -58.83978018909693, -103.3676086962223, -21.351079784333706, -85.88936447352171, -177.40842389315367, -27.977629952132702, 6.422173447906971, -44.09471484273672, -165.21831966936588, -211.96321852505207, -73.84303711354733, -215.27094458788633, -85.3680936768651, -76.89999998360872, -231.80000007152557, -18.940950483083725], "episode_lengths": [296, 263, 292, 252, 268, 264, 240, 274, 257, 243, 238, 230, 257, 257, 275, 235, 271, 281, 267, 346, 267, 269, 240, 281, 234, 238, 276, 267, 275, 275, 248, 253, 238, 272, 252, 227, 268, 261, 261, 245, 264, 273, 269, 267, 219, 272, 246, 240, 272, 267, 248, 261, 225, 222, 245, 288, 269, 259, 265, 223, 274, 239, 248, 259, 250, 247, 236, 259, 282, 217, 231, 314, 226, 250, 229, 248, 298, 312, 252, 234, 239, 238, 259, 234, 253, 261, 227, 259, 307, 229, 217, 244, 299, 335, 257, 333, 267, 249, 334, 237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5747025572950359, "mean_inference_ms": 7.455325635358119, "mean_action_processing_ms": 0.12324149684812367, "mean_env_wait_ms": 4.792799536879801, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 42510.033, "learn_time_ms": 38877.654, "learn_throughput": 102.887, "update_time_ms": 27.585}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 147, "training_iteration": 10, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-47-40", "timestamp": 1655534860, "time_this_iter_s": 42.172890424728394, "time_total_s": 425.1993057727814, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 425.1993057727814, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 21.838983050847457, "ram_util_percent": 62.83898305084747}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0010000000474974513, "total_loss": 6.610995292663574, "policy_loss": -0.08542357385158539, "vf_loss": 6.656282424926758, "vf_explained_var": 0.22412627935409546, "kl": 0.017838485538959503, "entropy": 1.938958764076233, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 28.22656210511923, "episode_reward_min": -303.48403691500425, "episode_reward_mean": -75.64864153727889, "episode_len_mean": 257.87, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.76611778885126, -83.89133148640394, -109.10690009593964, -133.69999989122152, -303.48403691500425, -85.38160905987024, -82.4113586768508, -27.52716840058565, -104.13541208952665, -33.27872923761606, -34.56952582299709, -101.31631007790565, -108.3787292689085, -92.04553996026516, -98.85869357734919, -47.81724060326815, -66.38846207410097, -55.52926219254732, -70.46666394174099, -87.09999997913837, -24.822163991630077, -77.42911242693663, -89.41890753805637, -91.06153654307127, -54.838508039712906, -97.19999995827675, -111.59999987483025, -105.61905693262815, -125.1853916272521, 28.22656210511923, -120.33521410822868, -45.82367617636919, -57.292244620621204, -106.67475640028715, -104.05707788467407, -48.268203385174274, -74.10330788046122, -17.6787291392684, -15.624578639864922, -46.578729413449764, -144.21772852540016, -74.55723875015974, -107.1504152789712, -73.74951286613941, -15.858466289937496, -81.09417381882668, -47.01727215945721, -74.49999997764826, -61.340110681951046, -52.12199408560991, -30.62408012151718, -51.699999794363976, -66.76719131320715, -144.83476215600967, 25.210573188960552, -26.58160912245512, -210.18539173156023, 5.699276641011238, -90.1893645003438, -18.871108263731003, -66.6707834303379, -151.53015216439962, -203.17475633323193, -69.91682325303555, -8.880707137286663, -23.881609342992306, 6.043444126844406, -75.83431187272072, -21.370428182184696, -58.83978018909693, -103.3676086962223, -21.351079784333706, -85.88936447352171, -177.40842389315367, -27.977629952132702, 6.422173447906971, -44.09471484273672, -165.21831966936588, -211.96321852505207, -73.84303711354733, -215.27094458788633, -85.3680936768651, -76.89999998360872, -231.80000007152557, -18.940950483083725, -3.764606721699238, -54.8650242164731, -99.86021871864796, -111.20690026134253, -56.42457865178585, 7.222173392772675, -4.978249296545982, -18.449027612805367, -98.39028399437666, 0.4437124505639076, -77.33854285627604, -38.1884620860219, -227.84951271861792, -37.89643798023462, -40.30278114974499], "episode_lengths": [235, 271, 281, 267, 346, 267, 269, 240, 281, 234, 238, 276, 267, 275, 275, 248, 253, 238, 272, 252, 227, 268, 261, 261, 245, 264, 273, 269, 267, 219, 272, 246, 240, 272, 267, 248, 261, 225, 222, 245, 288, 269, 259, 265, 223, 274, 239, 248, 259, 250, 247, 236, 259, 282, 217, 231, 314, 226, 250, 229, 248, 298, 312, 252, 234, 239, 238, 259, 234, 253, 261, 227, 259, 307, 229, 217, 244, 299, 335, 257, 333, 267, 249, 334, 237, 232, 251, 272, 277, 243, 219, 224, 234, 259, 229, 255, 238, 332, 256, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5786774952854682, "mean_inference_ms": 7.446934863416597, "mean_action_processing_ms": 0.12300842291691685, "mean_env_wait_ms": 4.77543953541043, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 28.22656210511923, "episode_reward_min": -303.48403691500425, "episode_reward_mean": -75.64864153727889, "episode_len_mean": 257.87, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.76611778885126, -83.89133148640394, -109.10690009593964, -133.69999989122152, -303.48403691500425, -85.38160905987024, -82.4113586768508, -27.52716840058565, -104.13541208952665, -33.27872923761606, -34.56952582299709, -101.31631007790565, -108.3787292689085, -92.04553996026516, -98.85869357734919, -47.81724060326815, -66.38846207410097, -55.52926219254732, -70.46666394174099, -87.09999997913837, -24.822163991630077, -77.42911242693663, -89.41890753805637, -91.06153654307127, -54.838508039712906, -97.19999995827675, -111.59999987483025, -105.61905693262815, -125.1853916272521, 28.22656210511923, -120.33521410822868, -45.82367617636919, -57.292244620621204, -106.67475640028715, -104.05707788467407, -48.268203385174274, -74.10330788046122, -17.6787291392684, -15.624578639864922, -46.578729413449764, -144.21772852540016, -74.55723875015974, -107.1504152789712, -73.74951286613941, -15.858466289937496, -81.09417381882668, -47.01727215945721, -74.49999997764826, -61.340110681951046, -52.12199408560991, -30.62408012151718, -51.699999794363976, -66.76719131320715, -144.83476215600967, 25.210573188960552, -26.58160912245512, -210.18539173156023, 5.699276641011238, -90.1893645003438, -18.871108263731003, -66.6707834303379, -151.53015216439962, -203.17475633323193, -69.91682325303555, -8.880707137286663, -23.881609342992306, 6.043444126844406, -75.83431187272072, -21.370428182184696, -58.83978018909693, -103.3676086962223, -21.351079784333706, -85.88936447352171, -177.40842389315367, -27.977629952132702, 6.422173447906971, -44.09471484273672, -165.21831966936588, -211.96321852505207, -73.84303711354733, -215.27094458788633, -85.3680936768651, -76.89999998360872, -231.80000007152557, -18.940950483083725, -3.764606721699238, -54.8650242164731, -99.86021871864796, -111.20690026134253, -56.42457865178585, 7.222173392772675, -4.978249296545982, -18.449027612805367, -98.39028399437666, 0.4437124505639076, -77.33854285627604, -38.1884620860219, -227.84951271861792, -37.89643798023462, -40.30278114974499], "episode_lengths": [235, 271, 281, 267, 346, 267, 269, 240, 281, 234, 238, 276, 267, 275, 275, 248, 253, 238, 272, 252, 227, 268, 261, 261, 245, 264, 273, 269, 267, 219, 272, 246, 240, 272, 267, 248, 261, 225, 222, 245, 288, 269, 259, 265, 223, 274, 239, 248, 259, 250, 247, 236, 259, 282, 217, 231, 314, 226, 250, 229, 248, 298, 312, 252, 234, 239, 238, 259, 234, 253, 261, 227, 259, 307, 229, 217, 244, 299, 335, 257, 333, 267, 249, 334, 237, 232, 251, 272, 277, 243, 219, 224, 234, 259, 229, 255, 238, 332, 256, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5786774952854682, "mean_inference_ms": 7.446934863416597, "mean_action_processing_ms": 0.12300842291691685, "mean_env_wait_ms": 4.77543953541043, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 42396.036, "learn_time_ms": 38815.533, "learn_throughput": 103.052, "update_time_ms": 27.683}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 162, "training_iteration": 11, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-48-23", "timestamp": 1655534903, "time_this_iter_s": 42.350958585739136, "time_total_s": 467.5502643585205, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 467.5502643585205, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 22.95333333333333, "ram_util_percent": 62.93999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0010000000474974513, "total_loss": 7.268853187561035, "policy_loss": -0.10877083241939545, "vf_loss": 7.3365559577941895, "vf_explained_var": 0.10262225568294525, "kl": 0.018252644687891006, "entropy": 1.9238487482070923, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 28.22656210511923, "episode_reward_min": -243.5286839455366, "episode_reward_mean": -72.02066282898187, "episode_len_mean": 256.63, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.52926219254732, -70.46666394174099, -87.09999997913837, -24.822163991630077, -77.42911242693663, -89.41890753805637, -91.06153654307127, -54.838508039712906, -97.19999995827675, -111.59999987483025, -105.61905693262815, -125.1853916272521, 28.22656210511923, -120.33521410822868, -45.82367617636919, -57.292244620621204, -106.67475640028715, -104.05707788467407, -48.268203385174274, -74.10330788046122, -17.6787291392684, -15.624578639864922, -46.578729413449764, -144.21772852540016, -74.55723875015974, -107.1504152789712, -73.74951286613941, -15.858466289937496, -81.09417381882668, -47.01727215945721, -74.49999997764826, -61.340110681951046, -52.12199408560991, -30.62408012151718, -51.699999794363976, -66.76719131320715, -144.83476215600967, 25.210573188960552, -26.58160912245512, -210.18539173156023, 5.699276641011238, -90.1893645003438, -18.871108263731003, -66.6707834303379, -151.53015216439962, -203.17475633323193, -69.91682325303555, -8.880707137286663, -23.881609342992306, 6.043444126844406, -75.83431187272072, -21.370428182184696, -58.83978018909693, -103.3676086962223, -21.351079784333706, -85.88936447352171, -177.40842389315367, -27.977629952132702, 6.422173447906971, -44.09471484273672, -165.21831966936588, -211.96321852505207, -73.84303711354733, -215.27094458788633, -85.3680936768651, -76.89999998360872, -231.80000007152557, -18.940950483083725, -3.764606721699238, -54.8650242164731, -99.86021871864796, -111.20690026134253, -56.42457865178585, 7.222173392772675, -4.978249296545982, -18.449027612805367, -98.39028399437666, 0.4437124505639076, -77.33854285627604, -38.1884620860219, -227.84951271861792, -37.89643798023462, -40.30278114974499, -56.02607487887144, -64.17168597877026, -41.31263883411884, -38.49320024251938, -16.377364084124565, -42.42199417203665, -52.06393078714609, -107.78936450183392, -99.43578937649727, -17.43371646106243, -74.1274694353342, -22.92367609590292, -107.0867800116539, -76.90778198093176, -243.5286839455366, -114.3764650374651, -19.782678373157978], "episode_lengths": [238, 272, 252, 227, 268, 261, 261, 245, 264, 273, 269, 267, 219, 272, 246, 240, 272, 267, 248, 261, 225, 222, 245, 288, 269, 259, 265, 223, 274, 239, 248, 259, 250, 247, 236, 259, 282, 217, 231, 314, 226, 250, 229, 248, 298, 312, 252, 234, 239, 238, 259, 234, 253, 261, 227, 259, 307, 229, 217, 244, 299, 335, 257, 333, 267, 249, 334, 237, 232, 251, 272, 277, 243, 219, 224, 234, 259, 229, 255, 238, 332, 256, 242, 249, 249, 252, 239, 226, 233, 249, 272, 279, 230, 256, 238, 272, 273, 347, 293, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5828316309955635, "mean_inference_ms": 7.440377855740398, "mean_action_processing_ms": 0.12285137425378762, "mean_env_wait_ms": 4.760429739106662, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 28.22656210511923, "episode_reward_min": -243.5286839455366, "episode_reward_mean": -72.02066282898187, "episode_len_mean": 256.63, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-55.52926219254732, -70.46666394174099, -87.09999997913837, -24.822163991630077, -77.42911242693663, -89.41890753805637, -91.06153654307127, -54.838508039712906, -97.19999995827675, -111.59999987483025, -105.61905693262815, -125.1853916272521, 28.22656210511923, -120.33521410822868, -45.82367617636919, -57.292244620621204, -106.67475640028715, -104.05707788467407, -48.268203385174274, -74.10330788046122, -17.6787291392684, -15.624578639864922, -46.578729413449764, -144.21772852540016, -74.55723875015974, -107.1504152789712, -73.74951286613941, -15.858466289937496, -81.09417381882668, -47.01727215945721, -74.49999997764826, -61.340110681951046, -52.12199408560991, -30.62408012151718, -51.699999794363976, -66.76719131320715, -144.83476215600967, 25.210573188960552, -26.58160912245512, -210.18539173156023, 5.699276641011238, -90.1893645003438, -18.871108263731003, -66.6707834303379, -151.53015216439962, -203.17475633323193, -69.91682325303555, -8.880707137286663, -23.881609342992306, 6.043444126844406, -75.83431187272072, -21.370428182184696, -58.83978018909693, -103.3676086962223, -21.351079784333706, -85.88936447352171, -177.40842389315367, -27.977629952132702, 6.422173447906971, -44.09471484273672, -165.21831966936588, -211.96321852505207, -73.84303711354733, -215.27094458788633, -85.3680936768651, -76.89999998360872, -231.80000007152557, -18.940950483083725, -3.764606721699238, -54.8650242164731, -99.86021871864796, -111.20690026134253, -56.42457865178585, 7.222173392772675, -4.978249296545982, -18.449027612805367, -98.39028399437666, 0.4437124505639076, -77.33854285627604, -38.1884620860219, -227.84951271861792, -37.89643798023462, -40.30278114974499, -56.02607487887144, -64.17168597877026, -41.31263883411884, -38.49320024251938, -16.377364084124565, -42.42199417203665, -52.06393078714609, -107.78936450183392, -99.43578937649727, -17.43371646106243, -74.1274694353342, -22.92367609590292, -107.0867800116539, -76.90778198093176, -243.5286839455366, -114.3764650374651, -19.782678373157978], "episode_lengths": [238, 272, 252, 227, 268, 261, 261, 245, 264, 273, 269, 267, 219, 272, 246, 240, 272, 267, 248, 261, 225, 222, 245, 288, 269, 259, 265, 223, 274, 239, 248, 259, 250, 247, 236, 259, 282, 217, 231, 314, 226, 250, 229, 248, 298, 312, 252, 234, 239, 238, 259, 234, 253, 261, 227, 259, 307, 229, 217, 244, 299, 335, 257, 333, 267, 249, 334, 237, 232, 251, 272, 277, 243, 219, 224, 234, 259, 229, 255, 238, 332, 256, 242, 249, 249, 252, 239, 226, 233, 249, 272, 279, 230, 256, 238, 272, 273, 347, 293, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5828316309955635, "mean_inference_ms": 7.440377855740398, "mean_action_processing_ms": 0.12285137425378762, "mean_env_wait_ms": 4.760429739106662, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 42408.791, "learn_time_ms": 38826.755, "learn_throughput": 103.022, "update_time_ms": 27.617}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 179, "training_iteration": 12, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-49-06", "timestamp": 1655534946, "time_this_iter_s": 42.683857440948486, "time_total_s": 510.234121799469, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 510.234121799469, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 23.01, "ram_util_percent": 62.95666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0010000000474974513, "total_loss": 7.340068340301514, "policy_loss": -0.11762749403715134, "vf_loss": 7.415987014770508, "vf_explained_var": 0.05795741826295853, "kl": 0.01853707619011402, "entropy": 1.9032472372055054, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 25.210573188960552, "episode_reward_min": -243.5286839455366, "episode_reward_mean": -73.83620308481157, "episode_len_mean": 258.07, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.82367617636919, -57.292244620621204, -106.67475640028715, -104.05707788467407, -48.268203385174274, -74.10330788046122, -17.6787291392684, -15.624578639864922, -46.578729413449764, -144.21772852540016, -74.55723875015974, -107.1504152789712, -73.74951286613941, -15.858466289937496, -81.09417381882668, -47.01727215945721, -74.49999997764826, -61.340110681951046, -52.12199408560991, -30.62408012151718, -51.699999794363976, -66.76719131320715, -144.83476215600967, 25.210573188960552, -26.58160912245512, -210.18539173156023, 5.699276641011238, -90.1893645003438, -18.871108263731003, -66.6707834303379, -151.53015216439962, -203.17475633323193, -69.91682325303555, -8.880707137286663, -23.881609342992306, 6.043444126844406, -75.83431187272072, -21.370428182184696, -58.83978018909693, -103.3676086962223, -21.351079784333706, -85.88936447352171, -177.40842389315367, -27.977629952132702, 6.422173447906971, -44.09471484273672, -165.21831966936588, -211.96321852505207, -73.84303711354733, -215.27094458788633, -85.3680936768651, -76.89999998360872, -231.80000007152557, -18.940950483083725, -3.764606721699238, -54.8650242164731, -99.86021871864796, -111.20690026134253, -56.42457865178585, 7.222173392772675, -4.978249296545982, -18.449027612805367, -98.39028399437666, 0.4437124505639076, -77.33854285627604, -38.1884620860219, -227.84951271861792, -37.89643798023462, -40.30278114974499, -56.02607487887144, -64.17168597877026, -41.31263883411884, -38.49320024251938, -16.377364084124565, -42.42199417203665, -52.06393078714609, -107.78936450183392, -99.43578937649727, -17.43371646106243, -74.1274694353342, -22.92367609590292, -107.0867800116539, -76.90778198093176, -243.5286839455366, -114.3764650374651, -19.782678373157978, -44.07872923463583, -104.17872924357653, -81.8827237188816, -83.18846210092306, -58.83521398156881, -73.1499302238226, -80.58936457335949, -144.69933526962996, -14.56962563842535, -137.36140593886375, -94.68685150146484, -106.23043750971556, -52.0125907510519, -188.46988094598055], "episode_lengths": [246, 240, 272, 267, 248, 261, 225, 222, 245, 288, 269, 259, 265, 223, 274, 239, 248, 259, 250, 247, 236, 259, 282, 217, 231, 314, 226, 250, 229, 248, 298, 312, 252, 234, 239, 238, 259, 234, 253, 261, 227, 259, 307, 229, 217, 244, 299, 335, 257, 333, 267, 249, 334, 237, 232, 251, 272, 277, 243, 219, 224, 234, 259, 229, 255, 238, 332, 256, 242, 249, 249, 252, 239, 226, 233, 249, 272, 279, 230, 256, 238, 272, 273, 347, 293, 242, 243, 274, 262, 265, 239, 252, 258, 301, 239, 288, 271, 279, 247, 314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5847454721481301, "mean_inference_ms": 7.436676197802138, "mean_action_processing_ms": 0.12276002006047122, "mean_env_wait_ms": 4.7536501925838, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 25.210573188960552, "episode_reward_min": -243.5286839455366, "episode_reward_mean": -73.83620308481157, "episode_len_mean": 258.07, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.82367617636919, -57.292244620621204, -106.67475640028715, -104.05707788467407, -48.268203385174274, -74.10330788046122, -17.6787291392684, -15.624578639864922, -46.578729413449764, -144.21772852540016, -74.55723875015974, -107.1504152789712, -73.74951286613941, -15.858466289937496, -81.09417381882668, -47.01727215945721, -74.49999997764826, -61.340110681951046, -52.12199408560991, -30.62408012151718, -51.699999794363976, -66.76719131320715, -144.83476215600967, 25.210573188960552, -26.58160912245512, -210.18539173156023, 5.699276641011238, -90.1893645003438, -18.871108263731003, -66.6707834303379, -151.53015216439962, -203.17475633323193, -69.91682325303555, -8.880707137286663, -23.881609342992306, 6.043444126844406, -75.83431187272072, -21.370428182184696, -58.83978018909693, -103.3676086962223, -21.351079784333706, -85.88936447352171, -177.40842389315367, -27.977629952132702, 6.422173447906971, -44.09471484273672, -165.21831966936588, -211.96321852505207, -73.84303711354733, -215.27094458788633, -85.3680936768651, -76.89999998360872, -231.80000007152557, -18.940950483083725, -3.764606721699238, -54.8650242164731, -99.86021871864796, -111.20690026134253, -56.42457865178585, 7.222173392772675, -4.978249296545982, -18.449027612805367, -98.39028399437666, 0.4437124505639076, -77.33854285627604, -38.1884620860219, -227.84951271861792, -37.89643798023462, -40.30278114974499, -56.02607487887144, -64.17168597877026, -41.31263883411884, -38.49320024251938, -16.377364084124565, -42.42199417203665, -52.06393078714609, -107.78936450183392, -99.43578937649727, -17.43371646106243, -74.1274694353342, -22.92367609590292, -107.0867800116539, -76.90778198093176, -243.5286839455366, -114.3764650374651, -19.782678373157978, -44.07872923463583, -104.17872924357653, -81.8827237188816, -83.18846210092306, -58.83521398156881, -73.1499302238226, -80.58936457335949, -144.69933526962996, -14.56962563842535, -137.36140593886375, -94.68685150146484, -106.23043750971556, -52.0125907510519, -188.46988094598055], "episode_lengths": [246, 240, 272, 267, 248, 261, 225, 222, 245, 288, 269, 259, 265, 223, 274, 239, 248, 259, 250, 247, 236, 259, 282, 217, 231, 314, 226, 250, 229, 248, 298, 312, 252, 234, 239, 238, 259, 234, 253, 261, 227, 259, 307, 229, 217, 244, 299, 335, 257, 333, 267, 249, 334, 237, 232, 251, 272, 277, 243, 219, 224, 234, 259, 229, 255, 238, 332, 256, 242, 249, 249, 252, 239, 226, 233, 249, 272, 279, 230, 256, 238, 272, 273, 347, 293, 242, 243, 274, 262, 265, 239, 252, 258, 301, 239, 288, 271, 279, 247, 314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5847454721481301, "mean_inference_ms": 7.436676197802138, "mean_action_processing_ms": 0.12276002006047122, "mean_env_wait_ms": 4.7536501925838, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 42356.638, "learn_time_ms": 38777.499, "learn_throughput": 103.153, "update_time_ms": 27.417}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 193, "training_iteration": 13, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-49-48", "timestamp": 1655534988, "time_this_iter_s": 42.18068861961365, "time_total_s": 552.4148104190826, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 552.4148104190826, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 23.183050847457626, "ram_util_percent": 63.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0010000000474974513, "total_loss": 6.733459949493408, "policy_loss": -0.12217867374420166, "vf_loss": 6.811949729919434, "vf_explained_var": 0.29845961928367615, "kl": 0.019417475908994675, "entropy": 1.8782259225845337, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 25.210573188960552, "episode_reward_min": -243.5286839455366, "episode_reward_mean": -74.12738983333111, "episode_len_mean": 258.35, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-74.49999997764826, -61.340110681951046, -52.12199408560991, -30.62408012151718, -51.699999794363976, -66.76719131320715, -144.83476215600967, 25.210573188960552, -26.58160912245512, -210.18539173156023, 5.699276641011238, -90.1893645003438, -18.871108263731003, -66.6707834303379, -151.53015216439962, -203.17475633323193, -69.91682325303555, -8.880707137286663, -23.881609342992306, 6.043444126844406, -75.83431187272072, -21.370428182184696, -58.83978018909693, -103.3676086962223, -21.351079784333706, -85.88936447352171, -177.40842389315367, -27.977629952132702, 6.422173447906971, -44.09471484273672, -165.21831966936588, -211.96321852505207, -73.84303711354733, -215.27094458788633, -85.3680936768651, -76.89999998360872, -231.80000007152557, -18.940950483083725, -3.764606721699238, -54.8650242164731, -99.86021871864796, -111.20690026134253, -56.42457865178585, 7.222173392772675, -4.978249296545982, -18.449027612805367, -98.39028399437666, 0.4437124505639076, -77.33854285627604, -38.1884620860219, -227.84951271861792, -37.89643798023462, -40.30278114974499, -56.02607487887144, -64.17168597877026, -41.31263883411884, -38.49320024251938, -16.377364084124565, -42.42199417203665, -52.06393078714609, -107.78936450183392, -99.43578937649727, -17.43371646106243, -74.1274694353342, -22.92367609590292, -107.0867800116539, -76.90778198093176, -243.5286839455366, -114.3764650374651, -19.782678373157978, -44.07872923463583, -104.17872924357653, -81.8827237188816, -83.18846210092306, -58.83521398156881, -73.1499302238226, -80.58936457335949, -144.69933526962996, -14.56962563842535, -137.36140593886375, -94.68685150146484, -106.23043750971556, -52.0125907510519, -188.46988094598055, -82.21272129565477, -36.863001219928265, -37.226819947361946, -68.82742933183908, -86.4747563675046, -88.51682319492102, -38.078729286789894, -181.00261159986258, -30.24211448431015, -70.35775369405746, -24.346453100442886, -87.36105065792799, -27.689364574849606, -160.58539159595966, 1.1202342733740807, -70.20000000298023], "episode_lengths": [248, 259, 250, 247, 236, 259, 282, 217, 231, 314, 226, 250, 229, 248, 298, 312, 252, 234, 239, 238, 259, 234, 253, 261, 227, 259, 307, 229, 217, 244, 299, 335, 257, 333, 267, 249, 334, 237, 232, 251, 272, 277, 243, 219, 224, 234, 259, 229, 255, 238, 332, 256, 242, 249, 249, 252, 239, 226, 233, 249, 272, 279, 230, 256, 238, 272, 273, 347, 293, 242, 243, 274, 262, 265, 239, 252, 258, 301, 239, 288, 271, 279, 247, 314, 253, 252, 244, 264, 257, 265, 242, 309, 237, 253, 237, 255, 229, 299, 223, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5857256871534786, "mean_inference_ms": 7.428615340627353, "mean_action_processing_ms": 0.12282257156252835, "mean_env_wait_ms": 4.744173444430411, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 25.210573188960552, "episode_reward_min": -243.5286839455366, "episode_reward_mean": -74.12738983333111, "episode_len_mean": 258.35, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-74.49999997764826, -61.340110681951046, -52.12199408560991, -30.62408012151718, -51.699999794363976, -66.76719131320715, -144.83476215600967, 25.210573188960552, -26.58160912245512, -210.18539173156023, 5.699276641011238, -90.1893645003438, -18.871108263731003, -66.6707834303379, -151.53015216439962, -203.17475633323193, -69.91682325303555, -8.880707137286663, -23.881609342992306, 6.043444126844406, -75.83431187272072, -21.370428182184696, -58.83978018909693, -103.3676086962223, -21.351079784333706, -85.88936447352171, -177.40842389315367, -27.977629952132702, 6.422173447906971, -44.09471484273672, -165.21831966936588, -211.96321852505207, -73.84303711354733, -215.27094458788633, -85.3680936768651, -76.89999998360872, -231.80000007152557, -18.940950483083725, -3.764606721699238, -54.8650242164731, -99.86021871864796, -111.20690026134253, -56.42457865178585, 7.222173392772675, -4.978249296545982, -18.449027612805367, -98.39028399437666, 0.4437124505639076, -77.33854285627604, -38.1884620860219, -227.84951271861792, -37.89643798023462, -40.30278114974499, -56.02607487887144, -64.17168597877026, -41.31263883411884, -38.49320024251938, -16.377364084124565, -42.42199417203665, -52.06393078714609, -107.78936450183392, -99.43578937649727, -17.43371646106243, -74.1274694353342, -22.92367609590292, -107.0867800116539, -76.90778198093176, -243.5286839455366, -114.3764650374651, -19.782678373157978, -44.07872923463583, -104.17872924357653, -81.8827237188816, -83.18846210092306, -58.83521398156881, -73.1499302238226, -80.58936457335949, -144.69933526962996, -14.56962563842535, -137.36140593886375, -94.68685150146484, -106.23043750971556, -52.0125907510519, -188.46988094598055, -82.21272129565477, -36.863001219928265, -37.226819947361946, -68.82742933183908, -86.4747563675046, -88.51682319492102, -38.078729286789894, -181.00261159986258, -30.24211448431015, -70.35775369405746, -24.346453100442886, -87.36105065792799, -27.689364574849606, -160.58539159595966, 1.1202342733740807, -70.20000000298023], "episode_lengths": [248, 259, 250, 247, 236, 259, 282, 217, 231, 314, 226, 250, 229, 248, 298, 312, 252, 234, 239, 238, 259, 234, 253, 261, 227, 259, 307, 229, 217, 244, 299, 335, 257, 333, 267, 249, 334, 237, 232, 251, 272, 277, 243, 219, 224, 234, 259, 229, 255, 238, 332, 256, 242, 249, 249, 252, 239, 226, 233, 249, 272, 279, 230, 256, 238, 272, 273, 347, 293, 242, 243, 274, 262, 265, 239, 252, 258, 301, 239, 288, 271, 279, 247, 314, 253, 252, 244, 264, 257, 265, 242, 309, 237, 253, 237, 255, 229, 299, 223, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5857256871534786, "mean_inference_ms": 7.428615340627353, "mean_action_processing_ms": 0.12282257156252835, "mean_env_wait_ms": 4.744173444430411, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 42393.806, "learn_time_ms": 38823.342, "learn_throughput": 103.031, "update_time_ms": 27.438}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 209, "training_iteration": 14, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-50-31", "timestamp": 1655535031, "time_this_iter_s": 42.64203643798828, "time_total_s": 595.0568468570709, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 595.0568468570709, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 22.84666666666667, "ram_util_percent": 62.81666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0010000000474974513, "total_loss": 6.978495121002197, "policy_loss": -0.04974997043609619, "vf_loss": 7.003619194030762, "vf_explained_var": -0.0006845991592854261, "kl": 0.010944860987365246, "entropy": 1.8680269718170166, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 992.2453534007072, "episode_reward_min": -243.5286839455366, "episode_reward_mean": -53.87724614284932, "episode_len_mean": 257.6, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-69.91682325303555, -8.880707137286663, -23.881609342992306, 6.043444126844406, -75.83431187272072, -21.370428182184696, -58.83978018909693, -103.3676086962223, -21.351079784333706, -85.88936447352171, -177.40842389315367, -27.977629952132702, 6.422173447906971, -44.09471484273672, -165.21831966936588, -211.96321852505207, -73.84303711354733, -215.27094458788633, -85.3680936768651, -76.89999998360872, -231.80000007152557, -18.940950483083725, -3.764606721699238, -54.8650242164731, -99.86021871864796, -111.20690026134253, -56.42457865178585, 7.222173392772675, -4.978249296545982, -18.449027612805367, -98.39028399437666, 0.4437124505639076, -77.33854285627604, -38.1884620860219, -227.84951271861792, -37.89643798023462, -40.30278114974499, -56.02607487887144, -64.17168597877026, -41.31263883411884, -38.49320024251938, -16.377364084124565, -42.42199417203665, -52.06393078714609, -107.78936450183392, -99.43578937649727, -17.43371646106243, -74.1274694353342, -22.92367609590292, -107.0867800116539, -76.90778198093176, -243.5286839455366, -114.3764650374651, -19.782678373157978, -44.07872923463583, -104.17872924357653, -81.8827237188816, -83.18846210092306, -58.83521398156881, -73.1499302238226, -80.58936457335949, -144.69933526962996, -14.56962563842535, -137.36140593886375, -94.68685150146484, -106.23043750971556, -52.0125907510519, -188.46988094598055, -82.21272129565477, -36.863001219928265, -37.226819947361946, -68.82742933183908, -86.4747563675046, -88.51682319492102, -38.078729286789894, -181.00261159986258, -30.24211448431015, -70.35775369405746, -24.346453100442886, -87.36105065792799, -27.689364574849606, -160.58539159595966, 1.1202342733740807, -70.20000000298023, -51.10406335443258, 992.2453534007072, -59.3471183180809, -120.83612128347158, 929.5103316381574, -62.97872909903526, 12.119516968727112, -27.39336048811674, -109.12409347295761, -72.81804927438498, -101.7893646210432, -63.16393060237169, -200.44961135089397, -98.81128880381584, -28.926556281745434, -130.29999985545874], "episode_lengths": [252, 234, 239, 238, 259, 234, 253, 261, 227, 259, 307, 229, 217, 244, 299, 335, 257, 333, 267, 249, 334, 237, 232, 251, 272, 277, 243, 219, 224, 234, 259, 229, 255, 238, 332, 256, 242, 249, 249, 252, 239, 226, 233, 249, 272, 279, 230, 256, 238, 272, 273, 347, 293, 242, 243, 274, 262, 265, 239, 252, 258, 301, 239, 288, 271, 279, 247, 314, 253, 252, 244, 264, 257, 265, 242, 309, 237, 253, 237, 255, 229, 299, 223, 252, 257, 100, 275, 274, 227, 257, 229, 236, 279, 251, 276, 254, 321, 267, 250, 278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5862417563976375, "mean_inference_ms": 7.423049078078028, "mean_action_processing_ms": 0.12282827935647318, "mean_env_wait_ms": 4.738551808888264, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 992.2453534007072, "episode_reward_min": -243.5286839455366, "episode_reward_mean": -53.87724614284932, "episode_len_mean": 257.6, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-69.91682325303555, -8.880707137286663, -23.881609342992306, 6.043444126844406, -75.83431187272072, -21.370428182184696, -58.83978018909693, -103.3676086962223, -21.351079784333706, -85.88936447352171, -177.40842389315367, -27.977629952132702, 6.422173447906971, -44.09471484273672, -165.21831966936588, -211.96321852505207, -73.84303711354733, -215.27094458788633, -85.3680936768651, -76.89999998360872, -231.80000007152557, -18.940950483083725, -3.764606721699238, -54.8650242164731, -99.86021871864796, -111.20690026134253, -56.42457865178585, 7.222173392772675, -4.978249296545982, -18.449027612805367, -98.39028399437666, 0.4437124505639076, -77.33854285627604, -38.1884620860219, -227.84951271861792, -37.89643798023462, -40.30278114974499, -56.02607487887144, -64.17168597877026, -41.31263883411884, -38.49320024251938, -16.377364084124565, -42.42199417203665, -52.06393078714609, -107.78936450183392, -99.43578937649727, -17.43371646106243, -74.1274694353342, -22.92367609590292, -107.0867800116539, -76.90778198093176, -243.5286839455366, -114.3764650374651, -19.782678373157978, -44.07872923463583, -104.17872924357653, -81.8827237188816, -83.18846210092306, -58.83521398156881, -73.1499302238226, -80.58936457335949, -144.69933526962996, -14.56962563842535, -137.36140593886375, -94.68685150146484, -106.23043750971556, -52.0125907510519, -188.46988094598055, -82.21272129565477, -36.863001219928265, -37.226819947361946, -68.82742933183908, -86.4747563675046, -88.51682319492102, -38.078729286789894, -181.00261159986258, -30.24211448431015, -70.35775369405746, -24.346453100442886, -87.36105065792799, -27.689364574849606, -160.58539159595966, 1.1202342733740807, -70.20000000298023, -51.10406335443258, 992.2453534007072, -59.3471183180809, -120.83612128347158, 929.5103316381574, -62.97872909903526, 12.119516968727112, -27.39336048811674, -109.12409347295761, -72.81804927438498, -101.7893646210432, -63.16393060237169, -200.44961135089397, -98.81128880381584, -28.926556281745434, -130.29999985545874], "episode_lengths": [252, 234, 239, 238, 259, 234, 253, 261, 227, 259, 307, 229, 217, 244, 299, 335, 257, 333, 267, 249, 334, 237, 232, 251, 272, 277, 243, 219, 224, 234, 259, 229, 255, 238, 332, 256, 242, 249, 249, 252, 239, 226, 233, 249, 272, 279, 230, 256, 238, 272, 273, 347, 293, 242, 243, 274, 262, 265, 239, 252, 258, 301, 239, 288, 271, 279, 247, 314, 253, 252, 244, 264, 257, 265, 242, 309, 237, 253, 237, 255, 229, 299, 223, 252, 257, 100, 275, 274, 227, 257, 229, 236, 279, 251, 276, 254, 321, 267, 250, 278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5862417563976375, "mean_inference_ms": 7.423049078078028, "mean_action_processing_ms": 0.12282827935647318, "mean_env_wait_ms": 4.738551808888264, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 42372.882, "learn_time_ms": 38807.014, "learn_throughput": 103.074, "update_time_ms": 27.139}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 225, "training_iteration": 15, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-51-13", "timestamp": 1655535073, "time_this_iter_s": 42.20646834373474, "time_total_s": 637.2633152008057, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 637.2633152008057, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 22.816949152542374, "ram_util_percent": 62.76101694915255}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0010000000474974513, "total_loss": 6.1839680671691895, "policy_loss": -0.10620252043008804, "vf_loss": 6.24648904800415, "vf_explained_var": 0.3096157908439636, "kl": 0.01941395178437233, "entropy": 1.880475401878357, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 992.2453534007072, "episode_reward_min": -243.5286839455366, "episode_reward_mean": -56.630599398836495, "episode_len_mean": 259.81, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.09471484273672, -165.21831966936588, -211.96321852505207, -73.84303711354733, -215.27094458788633, -85.3680936768651, -76.89999998360872, -231.80000007152557, -18.940950483083725, -3.764606721699238, -54.8650242164731, -99.86021871864796, -111.20690026134253, -56.42457865178585, 7.222173392772675, -4.978249296545982, -18.449027612805367, -98.39028399437666, 0.4437124505639076, -77.33854285627604, -38.1884620860219, -227.84951271861792, -37.89643798023462, -40.30278114974499, -56.02607487887144, -64.17168597877026, -41.31263883411884, -38.49320024251938, -16.377364084124565, -42.42199417203665, -52.06393078714609, -107.78936450183392, -99.43578937649727, -17.43371646106243, -74.1274694353342, -22.92367609590292, -107.0867800116539, -76.90778198093176, -243.5286839455366, -114.3764650374651, -19.782678373157978, -44.07872923463583, -104.17872924357653, -81.8827237188816, -83.18846210092306, -58.83521398156881, -73.1499302238226, -80.58936457335949, -144.69933526962996, -14.56962563842535, -137.36140593886375, -94.68685150146484, -106.23043750971556, -52.0125907510519, -188.46988094598055, -82.21272129565477, -36.863001219928265, -37.226819947361946, -68.82742933183908, -86.4747563675046, -88.51682319492102, -38.078729286789894, -181.00261159986258, -30.24211448431015, -70.35775369405746, -24.346453100442886, -87.36105065792799, -27.689364574849606, -160.58539159595966, 1.1202342733740807, -70.20000000298023, -51.10406335443258, 992.2453534007072, -59.3471183180809, -120.83612128347158, 929.5103316381574, -62.97872909903526, 12.119516968727112, -27.39336048811674, -109.12409347295761, -72.81804927438498, -101.7893646210432, -63.16393060237169, -200.44961135089397, -98.81128880381584, -28.926556281745434, -130.29999985545874, -25.923676006495953, -19.15649424493313, -37.00369539111853, -9.515033647418022, -178.28689796477556, -148.0211777240038, -104.96273390948772, -88.96140599250793, -94.27168609201908, -108.15497802942991, -29.68354383111, -37.18683950603008, -56.459312461316586], "episode_lengths": [244, 299, 335, 257, 333, 267, 249, 334, 237, 232, 251, 272, 277, 243, 219, 224, 234, 259, 229, 255, 238, 332, 256, 242, 249, 249, 252, 239, 226, 233, 249, 272, 279, 230, 256, 238, 272, 273, 347, 293, 242, 243, 274, 262, 265, 239, 252, 258, 301, 239, 288, 271, 279, 247, 314, 253, 252, 244, 264, 257, 265, 242, 309, 237, 253, 237, 255, 229, 299, 223, 252, 257, 100, 275, 274, 227, 257, 229, 236, 279, 251, 276, 254, 321, 267, 250, 278, 242, 242, 248, 236, 305, 290, 295, 266, 272, 295, 223, 250, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5867940075870414, "mean_inference_ms": 7.418349843247734, "mean_action_processing_ms": 0.12330588247436625, "mean_env_wait_ms": 4.733942837304947, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 992.2453534007072, "episode_reward_min": -243.5286839455366, "episode_reward_mean": -56.630599398836495, "episode_len_mean": 259.81, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.09471484273672, -165.21831966936588, -211.96321852505207, -73.84303711354733, -215.27094458788633, -85.3680936768651, -76.89999998360872, -231.80000007152557, -18.940950483083725, -3.764606721699238, -54.8650242164731, -99.86021871864796, -111.20690026134253, -56.42457865178585, 7.222173392772675, -4.978249296545982, -18.449027612805367, -98.39028399437666, 0.4437124505639076, -77.33854285627604, -38.1884620860219, -227.84951271861792, -37.89643798023462, -40.30278114974499, -56.02607487887144, -64.17168597877026, -41.31263883411884, -38.49320024251938, -16.377364084124565, -42.42199417203665, -52.06393078714609, -107.78936450183392, -99.43578937649727, -17.43371646106243, -74.1274694353342, -22.92367609590292, -107.0867800116539, -76.90778198093176, -243.5286839455366, -114.3764650374651, -19.782678373157978, -44.07872923463583, -104.17872924357653, -81.8827237188816, -83.18846210092306, -58.83521398156881, -73.1499302238226, -80.58936457335949, -144.69933526962996, -14.56962563842535, -137.36140593886375, -94.68685150146484, -106.23043750971556, -52.0125907510519, -188.46988094598055, -82.21272129565477, -36.863001219928265, -37.226819947361946, -68.82742933183908, -86.4747563675046, -88.51682319492102, -38.078729286789894, -181.00261159986258, -30.24211448431015, -70.35775369405746, -24.346453100442886, -87.36105065792799, -27.689364574849606, -160.58539159595966, 1.1202342733740807, -70.20000000298023, -51.10406335443258, 992.2453534007072, -59.3471183180809, -120.83612128347158, 929.5103316381574, -62.97872909903526, 12.119516968727112, -27.39336048811674, -109.12409347295761, -72.81804927438498, -101.7893646210432, -63.16393060237169, -200.44961135089397, -98.81128880381584, -28.926556281745434, -130.29999985545874, -25.923676006495953, -19.15649424493313, -37.00369539111853, -9.515033647418022, -178.28689796477556, -148.0211777240038, -104.96273390948772, -88.96140599250793, -94.27168609201908, -108.15497802942991, -29.68354383111, -37.18683950603008, -56.459312461316586], "episode_lengths": [244, 299, 335, 257, 333, 267, 249, 334, 237, 232, 251, 272, 277, 243, 219, 224, 234, 259, 229, 255, 238, 332, 256, 242, 249, 249, 252, 239, 226, 233, 249, 272, 279, 230, 256, 238, 272, 273, 347, 293, 242, 243, 274, 262, 265, 239, 252, 258, 301, 239, 288, 271, 279, 247, 314, 253, 252, 244, 264, 257, 265, 242, 309, 237, 253, 237, 255, 229, 299, 223, 252, 257, 100, 275, 274, 227, 257, 229, 236, 279, 251, 276, 254, 321, 267, 250, 278, 242, 242, 248, 236, 305, 290, 295, 266, 272, 295, 223, 250, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5867940075870414, "mean_inference_ms": 7.418349843247734, "mean_action_processing_ms": 0.12330588247436625, "mean_env_wait_ms": 4.733942837304947, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 42389.929, "learn_time_ms": 38821.872, "learn_throughput": 103.035, "update_time_ms": 26.831}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 238, "training_iteration": 16, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-51-56", "timestamp": 1655535116, "time_this_iter_s": 42.532111167907715, "time_total_s": 679.7954263687134, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 679.7954263687134, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 23.440000000000005, "ram_util_percent": 62.820000000000014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0010000000474974513, "total_loss": 6.516944408416748, "policy_loss": -0.11392571032047272, "vf_loss": 6.5879902839660645, "vf_explained_var": 0.09045317023992538, "kl": 0.019057482481002808, "entropy": 1.8614870309829712, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 992.2453534007072, "episode_reward_min": -243.5286839455366, "episode_reward_mean": -52.31361912064254, "episode_len_mean": 257.88, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.39028399437666, 0.4437124505639076, -77.33854285627604, -38.1884620860219, -227.84951271861792, -37.89643798023462, -40.30278114974499, -56.02607487887144, -64.17168597877026, -41.31263883411884, -38.49320024251938, -16.377364084124565, -42.42199417203665, -52.06393078714609, -107.78936450183392, -99.43578937649727, -17.43371646106243, -74.1274694353342, -22.92367609590292, -107.0867800116539, -76.90778198093176, -243.5286839455366, -114.3764650374651, -19.782678373157978, -44.07872923463583, -104.17872924357653, -81.8827237188816, -83.18846210092306, -58.83521398156881, -73.1499302238226, -80.58936457335949, -144.69933526962996, -14.56962563842535, -137.36140593886375, -94.68685150146484, -106.23043750971556, -52.0125907510519, -188.46988094598055, -82.21272129565477, -36.863001219928265, -37.226819947361946, -68.82742933183908, -86.4747563675046, -88.51682319492102, -38.078729286789894, -181.00261159986258, -30.24211448431015, -70.35775369405746, -24.346453100442886, -87.36105065792799, -27.689364574849606, -160.58539159595966, 1.1202342733740807, -70.20000000298023, -51.10406335443258, 992.2453534007072, -59.3471183180809, -120.83612128347158, 929.5103316381574, -62.97872909903526, 12.119516968727112, -27.39336048811674, -109.12409347295761, -72.81804927438498, -101.7893646210432, -63.16393060237169, -200.44961135089397, -98.81128880381584, -28.926556281745434, -130.29999985545874, -25.923676006495953, -19.15649424493313, -37.00369539111853, -9.515033647418022, -178.28689796477556, -148.0211777240038, -104.96273390948772, -88.96140599250793, -94.27168609201908, -108.15497802942991, -29.68354383111, -37.18683950603008, -56.459312461316586, -57.18936463445425, -3.6936802193522453, -29.283654645085335, -55.10599774122238, -31.941025398671627, -104.38936453312635, -32.24722724407911, -133.43134911358356, -37.3298574090004, -115.26412086933851, -37.7631743401289, -67.29999975860119, -62.79626487195492, -53.32405784726143, -40.458466142416, -160.27168621867895, -12.238392233848572], "episode_lengths": [259, 229, 255, 238, 332, 256, 242, 249, 249, 252, 239, 226, 233, 249, 272, 279, 230, 256, 238, 272, 273, 347, 293, 242, 243, 274, 262, 265, 239, 252, 258, 301, 239, 288, 271, 279, 247, 314, 253, 252, 244, 264, 257, 265, 242, 309, 237, 253, 237, 255, 229, 299, 223, 252, 257, 100, 275, 274, 227, 257, 229, 236, 279, 251, 276, 254, 321, 267, 250, 278, 242, 242, 248, 236, 305, 290, 295, 266, 272, 295, 223, 250, 266, 257, 233, 234, 255, 253, 260, 237, 293, 246, 278, 241, 253, 261, 249, 245, 287, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5869540684761693, "mean_inference_ms": 7.414412887702196, "mean_action_processing_ms": 0.12337223782229664, "mean_env_wait_ms": 4.7288910141652885, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 992.2453534007072, "episode_reward_min": -243.5286839455366, "episode_reward_mean": -52.31361912064254, "episode_len_mean": 257.88, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-98.39028399437666, 0.4437124505639076, -77.33854285627604, -38.1884620860219, -227.84951271861792, -37.89643798023462, -40.30278114974499, -56.02607487887144, -64.17168597877026, -41.31263883411884, -38.49320024251938, -16.377364084124565, -42.42199417203665, -52.06393078714609, -107.78936450183392, -99.43578937649727, -17.43371646106243, -74.1274694353342, -22.92367609590292, -107.0867800116539, -76.90778198093176, -243.5286839455366, -114.3764650374651, -19.782678373157978, -44.07872923463583, -104.17872924357653, -81.8827237188816, -83.18846210092306, -58.83521398156881, -73.1499302238226, -80.58936457335949, -144.69933526962996, -14.56962563842535, -137.36140593886375, -94.68685150146484, -106.23043750971556, -52.0125907510519, -188.46988094598055, -82.21272129565477, -36.863001219928265, -37.226819947361946, -68.82742933183908, -86.4747563675046, -88.51682319492102, -38.078729286789894, -181.00261159986258, -30.24211448431015, -70.35775369405746, -24.346453100442886, -87.36105065792799, -27.689364574849606, -160.58539159595966, 1.1202342733740807, -70.20000000298023, -51.10406335443258, 992.2453534007072, -59.3471183180809, -120.83612128347158, 929.5103316381574, -62.97872909903526, 12.119516968727112, -27.39336048811674, -109.12409347295761, -72.81804927438498, -101.7893646210432, -63.16393060237169, -200.44961135089397, -98.81128880381584, -28.926556281745434, -130.29999985545874, -25.923676006495953, -19.15649424493313, -37.00369539111853, -9.515033647418022, -178.28689796477556, -148.0211777240038, -104.96273390948772, -88.96140599250793, -94.27168609201908, -108.15497802942991, -29.68354383111, -37.18683950603008, -56.459312461316586, -57.18936463445425, -3.6936802193522453, -29.283654645085335, -55.10599774122238, -31.941025398671627, -104.38936453312635, -32.24722724407911, -133.43134911358356, -37.3298574090004, -115.26412086933851, -37.7631743401289, -67.29999975860119, -62.79626487195492, -53.32405784726143, -40.458466142416, -160.27168621867895, -12.238392233848572], "episode_lengths": [259, 229, 255, 238, 332, 256, 242, 249, 249, 252, 239, 226, 233, 249, 272, 279, 230, 256, 238, 272, 273, 347, 293, 242, 243, 274, 262, 265, 239, 252, 258, 301, 239, 288, 271, 279, 247, 314, 253, 252, 244, 264, 257, 265, 242, 309, 237, 253, 237, 255, 229, 299, 223, 252, 257, 100, 275, 274, 227, 257, 229, 236, 279, 251, 276, 254, 321, 267, 250, 278, 242, 242, 248, 236, 305, 290, 295, 266, 272, 295, 223, 250, 266, 257, 233, 234, 255, 253, 260, 237, 293, 246, 278, 241, 253, 261, 249, 245, 287, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5869540684761693, "mean_inference_ms": 7.414412887702196, "mean_action_processing_ms": 0.12337223782229664, "mean_env_wait_ms": 4.7288910141652885, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 68000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 42378.232, "learn_time_ms": 38811.775, "learn_throughput": 103.062, "update_time_ms": 26.931}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 255, "training_iteration": 17, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-52-38", "timestamp": 1655535158, "time_this_iter_s": 42.19602823257446, "time_total_s": 721.9914546012878, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 721.9914546012878, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 21.157627118644072, "ram_util_percent": 62.90338983050848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0010000000474974513, "total_loss": 6.721906661987305, "policy_loss": -0.11558131873607635, "vf_loss": 6.79252815246582, "vf_explained_var": 0.19931435585021973, "kl": 0.01998234912753105, "entropy": 1.848925232887268, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 992.2453534007072, "episode_reward_min": -243.5286839455366, "episode_reward_mean": -53.434098517894746, "episode_len_mean": 259.24, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.78936450183392, -99.43578937649727, -17.43371646106243, -74.1274694353342, -22.92367609590292, -107.0867800116539, -76.90778198093176, -243.5286839455366, -114.3764650374651, -19.782678373157978, -44.07872923463583, -104.17872924357653, -81.8827237188816, -83.18846210092306, -58.83521398156881, -73.1499302238226, -80.58936457335949, -144.69933526962996, -14.56962563842535, -137.36140593886375, -94.68685150146484, -106.23043750971556, -52.0125907510519, -188.46988094598055, -82.21272129565477, -36.863001219928265, -37.226819947361946, -68.82742933183908, -86.4747563675046, -88.51682319492102, -38.078729286789894, -181.00261159986258, -30.24211448431015, -70.35775369405746, -24.346453100442886, -87.36105065792799, -27.689364574849606, -160.58539159595966, 1.1202342733740807, -70.20000000298023, -51.10406335443258, 992.2453534007072, -59.3471183180809, -120.83612128347158, 929.5103316381574, -62.97872909903526, 12.119516968727112, -27.39336048811674, -109.12409347295761, -72.81804927438498, -101.7893646210432, -63.16393060237169, -200.44961135089397, -98.81128880381584, -28.926556281745434, -130.29999985545874, -25.923676006495953, -19.15649424493313, -37.00369539111853, -9.515033647418022, -178.28689796477556, -148.0211777240038, -104.96273390948772, -88.96140599250793, -94.27168609201908, -108.15497802942991, -29.68354383111, -37.18683950603008, -56.459312461316586, -57.18936463445425, -3.6936802193522453, -29.283654645085335, -55.10599774122238, -31.941025398671627, -104.38936453312635, -32.24722724407911, -133.43134911358356, -37.3298574090004, -115.26412086933851, -37.7631743401289, -67.29999975860119, -62.79626487195492, -53.32405784726143, -40.458466142416, -160.27168621867895, -12.238392233848572, -42.224578730762005, 5.4126060381531715, -158.82745879888535, -77.89914471656084, -118.82236614823341, -73.92829938977957, -6.513040706515312, 25.05604860931635, -38.364606596529484, -54.214354783296585, -59.31160504370928, -91.7999999821186, -61.605702966451645, -189.39463382214308], "episode_lengths": [272, 279, 230, 256, 238, 272, 273, 347, 293, 242, 243, 274, 262, 265, 239, 252, 258, 301, 239, 288, 271, 279, 247, 314, 253, 252, 244, 264, 257, 265, 242, 309, 237, 253, 237, 255, 229, 299, 223, 252, 257, 100, 275, 274, 227, 257, 229, 236, 279, 251, 276, 254, 321, 267, 250, 278, 242, 242, 248, 236, 305, 290, 295, 266, 272, 295, 223, 250, 266, 257, 233, 234, 255, 253, 260, 237, 293, 246, 278, 241, 253, 261, 249, 245, 287, 232, 247, 211, 302, 258, 291, 251, 239, 225, 252, 258, 263, 260, 263, 324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5865362105009576, "mean_inference_ms": 7.411565053874486, "mean_action_processing_ms": 0.12331852674109486, "mean_env_wait_ms": 4.727082833312808, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 992.2453534007072, "episode_reward_min": -243.5286839455366, "episode_reward_mean": -53.434098517894746, "episode_len_mean": 259.24, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-107.78936450183392, -99.43578937649727, -17.43371646106243, -74.1274694353342, -22.92367609590292, -107.0867800116539, -76.90778198093176, -243.5286839455366, -114.3764650374651, -19.782678373157978, -44.07872923463583, -104.17872924357653, -81.8827237188816, -83.18846210092306, -58.83521398156881, -73.1499302238226, -80.58936457335949, -144.69933526962996, -14.56962563842535, -137.36140593886375, -94.68685150146484, -106.23043750971556, -52.0125907510519, -188.46988094598055, -82.21272129565477, -36.863001219928265, -37.226819947361946, -68.82742933183908, -86.4747563675046, -88.51682319492102, -38.078729286789894, -181.00261159986258, -30.24211448431015, -70.35775369405746, -24.346453100442886, -87.36105065792799, -27.689364574849606, -160.58539159595966, 1.1202342733740807, -70.20000000298023, -51.10406335443258, 992.2453534007072, -59.3471183180809, -120.83612128347158, 929.5103316381574, -62.97872909903526, 12.119516968727112, -27.39336048811674, -109.12409347295761, -72.81804927438498, -101.7893646210432, -63.16393060237169, -200.44961135089397, -98.81128880381584, -28.926556281745434, -130.29999985545874, -25.923676006495953, -19.15649424493313, -37.00369539111853, -9.515033647418022, -178.28689796477556, -148.0211777240038, -104.96273390948772, -88.96140599250793, -94.27168609201908, -108.15497802942991, -29.68354383111, -37.18683950603008, -56.459312461316586, -57.18936463445425, -3.6936802193522453, -29.283654645085335, -55.10599774122238, -31.941025398671627, -104.38936453312635, -32.24722724407911, -133.43134911358356, -37.3298574090004, -115.26412086933851, -37.7631743401289, -67.29999975860119, -62.79626487195492, -53.32405784726143, -40.458466142416, -160.27168621867895, -12.238392233848572, -42.224578730762005, 5.4126060381531715, -158.82745879888535, -77.89914471656084, -118.82236614823341, -73.92829938977957, -6.513040706515312, 25.05604860931635, -38.364606596529484, -54.214354783296585, -59.31160504370928, -91.7999999821186, -61.605702966451645, -189.39463382214308], "episode_lengths": [272, 279, 230, 256, 238, 272, 273, 347, 293, 242, 243, 274, 262, 265, 239, 252, 258, 301, 239, 288, 271, 279, 247, 314, 253, 252, 244, 264, 257, 265, 242, 309, 237, 253, 237, 255, 229, 299, 223, 252, 257, 100, 275, 274, 227, 257, 229, 236, 279, 251, 276, 254, 321, 267, 250, 278, 242, 242, 248, 236, 305, 290, 295, 266, 272, 295, 223, 250, 266, 257, 233, 234, 255, 253, 260, 237, 293, 246, 278, 241, 253, 261, 249, 245, 287, 232, 247, 211, 302, 258, 291, 251, 239, 225, 252, 258, 263, 260, 263, 324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5865362105009576, "mean_inference_ms": 7.411565053874486, "mean_action_processing_ms": 0.12331852674109486, "mean_env_wait_ms": 4.727082833312808, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 72000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 42340.568, "learn_time_ms": 38786.206, "learn_throughput": 103.129, "update_time_ms": 26.931}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 269, "training_iteration": 18, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-53-20", "timestamp": 1655535200, "time_this_iter_s": 42.23888325691223, "time_total_s": 764.2303378582001, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 764.2303378582001, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 22.428813559322034, "ram_util_percent": 62.89322033898305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0010000000474974513, "total_loss": 6.9436726570129395, "policy_loss": -0.04699564352631569, "vf_loss": 6.967467308044434, "vf_explained_var": -0.013121780939400196, "kl": 0.010311557911336422, "entropy": 1.864344835281372, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 992.2453534007072, "episode_reward_min": -213.85617545247078, "episode_reward_mean": -41.515950477421285, "episode_len_mean": 258.12, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-80.58936457335949, -144.69933526962996, -14.56962563842535, -137.36140593886375, -94.68685150146484, -106.23043750971556, -52.0125907510519, -188.46988094598055, -82.21272129565477, -36.863001219928265, -37.226819947361946, -68.82742933183908, -86.4747563675046, -88.51682319492102, -38.078729286789894, -181.00261159986258, -30.24211448431015, -70.35775369405746, -24.346453100442886, -87.36105065792799, -27.689364574849606, -160.58539159595966, 1.1202342733740807, -70.20000000298023, -51.10406335443258, 992.2453534007072, -59.3471183180809, -120.83612128347158, 929.5103316381574, -62.97872909903526, 12.119516968727112, -27.39336048811674, -109.12409347295761, -72.81804927438498, -101.7893646210432, -63.16393060237169, -200.44961135089397, -98.81128880381584, -28.926556281745434, -130.29999985545874, -25.923676006495953, -19.15649424493313, -37.00369539111853, -9.515033647418022, -178.28689796477556, -148.0211777240038, -104.96273390948772, -88.96140599250793, -94.27168609201908, -108.15497802942991, -29.68354383111, -37.18683950603008, -56.459312461316586, -57.18936463445425, -3.6936802193522453, -29.283654645085335, -55.10599774122238, -31.941025398671627, -104.38936453312635, -32.24722724407911, -133.43134911358356, -37.3298574090004, -115.26412086933851, -37.7631743401289, -67.29999975860119, -62.79626487195492, -53.32405784726143, -40.458466142416, -160.27168621867895, -12.238392233848572, -42.224578730762005, 5.4126060381531715, -158.82745879888535, -77.89914471656084, -118.82236614823341, -73.92829938977957, -6.513040706515312, 25.05604860931635, -38.364606596529484, -54.214354783296585, -59.31160504370928, -91.7999999821186, -61.605702966451645, -189.39463382214308, -95.95329535007477, -51.593751691281796, -0.4332568943500519, -150.7707834392786, 1.6573116481304169, -46.93431157618761, -79.72716955840588, -105.66982369869947, -110.39059150964022, -62.37097381800413, -213.85617545247078, -98.83431165665388, 12.576323799788952, 949.5980361327529, -35.105372846126556, -49.083243764936924], "episode_lengths": [258, 301, 239, 288, 271, 279, 247, 314, 253, 252, 244, 264, 257, 265, 242, 309, 237, 253, 237, 255, 229, 299, 223, 252, 257, 100, 275, 274, 227, 257, 229, 236, 279, 251, 276, 254, 321, 267, 250, 278, 242, 242, 248, 236, 305, 290, 295, 266, 272, 295, 223, 250, 266, 257, 233, 234, 255, 253, 260, 237, 293, 246, 278, 241, 253, 261, 249, 245, 287, 232, 247, 211, 302, 258, 291, 251, 239, 225, 252, 258, 263, 260, 263, 324, 272, 252, 221, 297, 232, 254, 260, 287, 278, 265, 320, 273, 223, 198, 237, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5871049152308205, "mean_inference_ms": 7.40529639263756, "mean_action_processing_ms": 0.12330105423835265, "mean_env_wait_ms": 4.723870453623857, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 992.2453534007072, "episode_reward_min": -213.85617545247078, "episode_reward_mean": -41.515950477421285, "episode_len_mean": 258.12, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-80.58936457335949, -144.69933526962996, -14.56962563842535, -137.36140593886375, -94.68685150146484, -106.23043750971556, -52.0125907510519, -188.46988094598055, -82.21272129565477, -36.863001219928265, -37.226819947361946, -68.82742933183908, -86.4747563675046, -88.51682319492102, -38.078729286789894, -181.00261159986258, -30.24211448431015, -70.35775369405746, -24.346453100442886, -87.36105065792799, -27.689364574849606, -160.58539159595966, 1.1202342733740807, -70.20000000298023, -51.10406335443258, 992.2453534007072, -59.3471183180809, -120.83612128347158, 929.5103316381574, -62.97872909903526, 12.119516968727112, -27.39336048811674, -109.12409347295761, -72.81804927438498, -101.7893646210432, -63.16393060237169, -200.44961135089397, -98.81128880381584, -28.926556281745434, -130.29999985545874, -25.923676006495953, -19.15649424493313, -37.00369539111853, -9.515033647418022, -178.28689796477556, -148.0211777240038, -104.96273390948772, -88.96140599250793, -94.27168609201908, -108.15497802942991, -29.68354383111, -37.18683950603008, -56.459312461316586, -57.18936463445425, -3.6936802193522453, -29.283654645085335, -55.10599774122238, -31.941025398671627, -104.38936453312635, -32.24722724407911, -133.43134911358356, -37.3298574090004, -115.26412086933851, -37.7631743401289, -67.29999975860119, -62.79626487195492, -53.32405784726143, -40.458466142416, -160.27168621867895, -12.238392233848572, -42.224578730762005, 5.4126060381531715, -158.82745879888535, -77.89914471656084, -118.82236614823341, -73.92829938977957, -6.513040706515312, 25.05604860931635, -38.364606596529484, -54.214354783296585, -59.31160504370928, -91.7999999821186, -61.605702966451645, -189.39463382214308, -95.95329535007477, -51.593751691281796, -0.4332568943500519, -150.7707834392786, 1.6573116481304169, -46.93431157618761, -79.72716955840588, -105.66982369869947, -110.39059150964022, -62.37097381800413, -213.85617545247078, -98.83431165665388, 12.576323799788952, 949.5980361327529, -35.105372846126556, -49.083243764936924], "episode_lengths": [258, 301, 239, 288, 271, 279, 247, 314, 253, 252, 244, 264, 257, 265, 242, 309, 237, 253, 237, 255, 229, 299, 223, 252, 257, 100, 275, 274, 227, 257, 229, 236, 279, 251, 276, 254, 321, 267, 250, 278, 242, 242, 248, 236, 305, 290, 295, 266, 272, 295, 223, 250, 266, 257, 233, 234, 255, 253, 260, 237, 293, 246, 278, 241, 253, 261, 249, 245, 287, 232, 247, 211, 302, 258, 291, 251, 239, 225, 252, 258, 263, 260, 263, 324, 272, 252, 221, 297, 232, 254, 260, 287, 278, 265, 320, 273, 223, 198, 237, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5871049152308205, "mean_inference_ms": 7.40529639263756, "mean_action_processing_ms": 0.12330105423835265, "mean_env_wait_ms": 4.723870453623857, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 76000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 42326.25, "learn_time_ms": 38775.494, "learn_throughput": 103.158, "update_time_ms": 26.824}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 285, "training_iteration": 19, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-54-03", "timestamp": 1655535243, "time_this_iter_s": 42.16862177848816, "time_total_s": 806.3989596366882, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 806.3989596366882, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 21.665000000000003, "ram_util_percent": 62.94500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0010000000474974513, "total_loss": 6.461276054382324, "policy_loss": -0.02390916272997856, "vf_loss": 6.466606616973877, "vf_explained_var": 0.0557430274784565, "kl": 0.008257143199443817, "entropy": 1.856149673461914, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 992.2453534007072, "episode_reward_min": -213.85617545247078, "episode_reward_mean": -26.874681308493017, "episode_len_mean": 255.77, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.24211448431015, -70.35775369405746, -24.346453100442886, -87.36105065792799, -27.689364574849606, -160.58539159595966, 1.1202342733740807, -70.20000000298023, -51.10406335443258, 992.2453534007072, -59.3471183180809, -120.83612128347158, 929.5103316381574, -62.97872909903526, 12.119516968727112, -27.39336048811674, -109.12409347295761, -72.81804927438498, -101.7893646210432, -63.16393060237169, -200.44961135089397, -98.81128880381584, -28.926556281745434, -130.29999985545874, -25.923676006495953, -19.15649424493313, -37.00369539111853, -9.515033647418022, -178.28689796477556, -148.0211777240038, -104.96273390948772, -88.96140599250793, -94.27168609201908, -108.15497802942991, -29.68354383111, -37.18683950603008, -56.459312461316586, -57.18936463445425, -3.6936802193522453, -29.283654645085335, -55.10599774122238, -31.941025398671627, -104.38936453312635, -32.24722724407911, -133.43134911358356, -37.3298574090004, -115.26412086933851, -37.7631743401289, -67.29999975860119, -62.79626487195492, -53.32405784726143, -40.458466142416, -160.27168621867895, -12.238392233848572, -42.224578730762005, 5.4126060381531715, -158.82745879888535, -77.89914471656084, -118.82236614823341, -73.92829938977957, -6.513040706515312, 25.05604860931635, -38.364606596529484, -54.214354783296585, -59.31160504370928, -91.7999999821186, -61.605702966451645, -189.39463382214308, -95.95329535007477, -51.593751691281796, -0.4332568943500519, -150.7707834392786, 1.6573116481304169, -46.93431157618761, -79.72716955840588, -105.66982369869947, -110.39059150964022, -62.37097381800413, -213.85617545247078, -98.83431165665388, 12.576323799788952, 949.5980361327529, -35.105372846126556, -49.083243764936924, -74.06550929695368, -71.36933283507824, 904.0249491333961, -81.23521409928799, -76.6113586500287, -45.204826928675175, -43.534311421215534, -59.28448911011219, -103.4961705505848, -79.8339784219861, -28.38160914927721, -50.018813252449036, -12.425670728087425, -44.86393083631992, -28.968093879520893, -78.42710745334625], "episode_lengths": [237, 253, 237, 255, 229, 299, 223, 252, 257, 100, 275, 274, 227, 257, 229, 236, 279, 251, 276, 254, 321, 267, 250, 278, 242, 242, 248, 236, 305, 290, 295, 266, 272, 295, 223, 250, 266, 257, 233, 234, 255, 253, 260, 237, 293, 246, 278, 241, 253, 261, 249, 245, 287, 232, 247, 211, 302, 258, 291, 251, 239, 225, 252, 258, 263, 260, 263, 324, 272, 252, 221, 297, 232, 254, 260, 287, 278, 265, 320, 273, 223, 198, 237, 256, 270, 264, 205, 260, 262, 249, 244, 256, 277, 267, 233, 264, 233, 241, 250, 273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5887979006481019, "mean_inference_ms": 7.398405278690372, "mean_action_processing_ms": 0.12314694927514963, "mean_env_wait_ms": 4.717598195475376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 992.2453534007072, "episode_reward_min": -213.85617545247078, "episode_reward_mean": -26.874681308493017, "episode_len_mean": 255.77, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30.24211448431015, -70.35775369405746, -24.346453100442886, -87.36105065792799, -27.689364574849606, -160.58539159595966, 1.1202342733740807, -70.20000000298023, -51.10406335443258, 992.2453534007072, -59.3471183180809, -120.83612128347158, 929.5103316381574, -62.97872909903526, 12.119516968727112, -27.39336048811674, -109.12409347295761, -72.81804927438498, -101.7893646210432, -63.16393060237169, -200.44961135089397, -98.81128880381584, -28.926556281745434, -130.29999985545874, -25.923676006495953, -19.15649424493313, -37.00369539111853, -9.515033647418022, -178.28689796477556, -148.0211777240038, -104.96273390948772, -88.96140599250793, -94.27168609201908, -108.15497802942991, -29.68354383111, -37.18683950603008, -56.459312461316586, -57.18936463445425, -3.6936802193522453, -29.283654645085335, -55.10599774122238, -31.941025398671627, -104.38936453312635, -32.24722724407911, -133.43134911358356, -37.3298574090004, -115.26412086933851, -37.7631743401289, -67.29999975860119, -62.79626487195492, -53.32405784726143, -40.458466142416, -160.27168621867895, -12.238392233848572, -42.224578730762005, 5.4126060381531715, -158.82745879888535, -77.89914471656084, -118.82236614823341, -73.92829938977957, -6.513040706515312, 25.05604860931635, -38.364606596529484, -54.214354783296585, -59.31160504370928, -91.7999999821186, -61.605702966451645, -189.39463382214308, -95.95329535007477, -51.593751691281796, -0.4332568943500519, -150.7707834392786, 1.6573116481304169, -46.93431157618761, -79.72716955840588, -105.66982369869947, -110.39059150964022, -62.37097381800413, -213.85617545247078, -98.83431165665388, 12.576323799788952, 949.5980361327529, -35.105372846126556, -49.083243764936924, -74.06550929695368, -71.36933283507824, 904.0249491333961, -81.23521409928799, -76.6113586500287, -45.204826928675175, -43.534311421215534, -59.28448911011219, -103.4961705505848, -79.8339784219861, -28.38160914927721, -50.018813252449036, -12.425670728087425, -44.86393083631992, -28.968093879520893, -78.42710745334625], "episode_lengths": [237, 253, 237, 255, 229, 299, 223, 252, 257, 100, 275, 274, 227, 257, 229, 236, 279, 251, 276, 254, 321, 267, 250, 278, 242, 242, 248, 236, 305, 290, 295, 266, 272, 295, 223, 250, 266, 257, 233, 234, 255, 253, 260, 237, 293, 246, 278, 241, 253, 261, 249, 245, 287, 232, 247, 211, 302, 258, 291, 251, 239, 225, 252, 258, 263, 260, 263, 324, 272, 252, 221, 297, 232, 254, 260, 287, 278, 265, 320, 273, 223, 198, 237, 256, 270, 264, 205, 260, 262, 249, 244, 256, 277, 267, 233, 264, 233, 241, 250, 273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5887979006481019, "mean_inference_ms": 7.398405278690372, "mean_action_processing_ms": 0.12314694927514963, "mean_env_wait_ms": 4.717598195475376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 80000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 42325.92, "learn_time_ms": 38787.387, "learn_throughput": 103.126, "update_time_ms": 26.69}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 301, "training_iteration": 20, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-54-45", "timestamp": 1655535285, "time_this_iter_s": 42.17060303688049, "time_total_s": 848.5695626735687, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 848.5695626735687, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 22.1135593220339, "ram_util_percent": 62.983050847457626}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0010000000474974513, "total_loss": 7.343172073364258, "policy_loss": -0.1193384975194931, "vf_loss": 7.411171913146973, "vf_explained_var": 0.17146062850952148, "kl": 0.022817201912403107, "entropy": 1.866678237915039, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 949.5980361327529, "episode_reward_min": -247.10906794667244, "episode_reward_mean": -48.70577845327556, "episode_len_mean": 258.6, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.39336048811674, -109.12409347295761, -72.81804927438498, -101.7893646210432, -63.16393060237169, -200.44961135089397, -98.81128880381584, -28.926556281745434, -130.29999985545874, -25.923676006495953, -19.15649424493313, -37.00369539111853, -9.515033647418022, -178.28689796477556, -148.0211777240038, -104.96273390948772, -88.96140599250793, -94.27168609201908, -108.15497802942991, -29.68354383111, -37.18683950603008, -56.459312461316586, -57.18936463445425, -3.6936802193522453, -29.283654645085335, -55.10599774122238, -31.941025398671627, -104.38936453312635, -32.24722724407911, -133.43134911358356, -37.3298574090004, -115.26412086933851, -37.7631743401289, -67.29999975860119, -62.79626487195492, -53.32405784726143, -40.458466142416, -160.27168621867895, -12.238392233848572, -42.224578730762005, 5.4126060381531715, -158.82745879888535, -77.89914471656084, -118.82236614823341, -73.92829938977957, -6.513040706515312, 25.05604860931635, -38.364606596529484, -54.214354783296585, -59.31160504370928, -91.7999999821186, -61.605702966451645, -189.39463382214308, -95.95329535007477, -51.593751691281796, -0.4332568943500519, -150.7707834392786, 1.6573116481304169, -46.93431157618761, -79.72716955840588, -105.66982369869947, -110.39059150964022, -62.37097381800413, -213.85617545247078, -98.83431165665388, 12.576323799788952, 949.5980361327529, -35.105372846126556, -49.083243764936924, -74.06550929695368, -71.36933283507824, 904.0249491333961, -81.23521409928799, -76.6113586500287, -45.204826928675175, -43.534311421215534, -59.28448911011219, -103.4961705505848, -79.8339784219861, -28.38160914927721, -50.018813252449036, -12.425670728087425, -44.86393083631992, -28.968093879520893, -78.42710745334625, -247.10906794667244, -31.855871453881264, -45.40618781000376, -12.778591856360435, -45.34068953990936, -20.689364477992058, -55.22300448268652, -100.04903264343739, 26.821224339306355, 29.496396757662296, -95.37168601900339, -158.27614449709654, -46.29850201308727, -158.81394323706627, -52.267973482608795], "episode_lengths": [236, 279, 251, 276, 254, 321, 267, 250, 278, 242, 242, 248, 236, 305, 290, 295, 266, 272, 295, 223, 250, 266, 257, 233, 234, 255, 253, 260, 237, 293, 246, 278, 241, 253, 261, 249, 245, 287, 232, 247, 211, 302, 258, 291, 251, 239, 225, 252, 258, 263, 260, 263, 324, 272, 252, 221, 297, 232, 254, 260, 287, 278, 265, 320, 273, 223, 198, 237, 256, 270, 264, 205, 260, 262, 249, 244, 256, 277, 267, 233, 264, 233, 241, 250, 273, 335, 245, 257, 232, 252, 236, 259, 282, 215, 211, 262, 285, 256, 291, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5888767605649026, "mean_inference_ms": 7.399896064921656, "mean_action_processing_ms": 0.12310242456630492, "mean_env_wait_ms": 4.719276551018763, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 949.5980361327529, "episode_reward_min": -247.10906794667244, "episode_reward_mean": -48.70577845327556, "episode_len_mean": 258.6, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27.39336048811674, -109.12409347295761, -72.81804927438498, -101.7893646210432, -63.16393060237169, -200.44961135089397, -98.81128880381584, -28.926556281745434, -130.29999985545874, -25.923676006495953, -19.15649424493313, -37.00369539111853, -9.515033647418022, -178.28689796477556, -148.0211777240038, -104.96273390948772, -88.96140599250793, -94.27168609201908, -108.15497802942991, -29.68354383111, -37.18683950603008, -56.459312461316586, -57.18936463445425, -3.6936802193522453, -29.283654645085335, -55.10599774122238, -31.941025398671627, -104.38936453312635, -32.24722724407911, -133.43134911358356, -37.3298574090004, -115.26412086933851, -37.7631743401289, -67.29999975860119, -62.79626487195492, -53.32405784726143, -40.458466142416, -160.27168621867895, -12.238392233848572, -42.224578730762005, 5.4126060381531715, -158.82745879888535, -77.89914471656084, -118.82236614823341, -73.92829938977957, -6.513040706515312, 25.05604860931635, -38.364606596529484, -54.214354783296585, -59.31160504370928, -91.7999999821186, -61.605702966451645, -189.39463382214308, -95.95329535007477, -51.593751691281796, -0.4332568943500519, -150.7707834392786, 1.6573116481304169, -46.93431157618761, -79.72716955840588, -105.66982369869947, -110.39059150964022, -62.37097381800413, -213.85617545247078, -98.83431165665388, 12.576323799788952, 949.5980361327529, -35.105372846126556, -49.083243764936924, -74.06550929695368, -71.36933283507824, 904.0249491333961, -81.23521409928799, -76.6113586500287, -45.204826928675175, -43.534311421215534, -59.28448911011219, -103.4961705505848, -79.8339784219861, -28.38160914927721, -50.018813252449036, -12.425670728087425, -44.86393083631992, -28.968093879520893, -78.42710745334625, -247.10906794667244, -31.855871453881264, -45.40618781000376, -12.778591856360435, -45.34068953990936, -20.689364477992058, -55.22300448268652, -100.04903264343739, 26.821224339306355, 29.496396757662296, -95.37168601900339, -158.27614449709654, -46.29850201308727, -158.81394323706627, -52.267973482608795], "episode_lengths": [236, 279, 251, 276, 254, 321, 267, 250, 278, 242, 242, 248, 236, 305, 290, 295, 266, 272, 295, 223, 250, 266, 257, 233, 234, 255, 253, 260, 237, 293, 246, 278, 241, 253, 261, 249, 245, 287, 232, 247, 211, 302, 258, 291, 251, 239, 225, 252, 258, 263, 260, 263, 324, 272, 252, 221, 297, 232, 254, 260, 287, 278, 265, 320, 273, 223, 198, 237, 256, 270, 264, 205, 260, 262, 249, 244, 256, 277, 267, 233, 264, 233, 241, 250, 273, 335, 245, 257, 232, 252, 236, 259, 282, 215, 211, 262, 285, 256, 291, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5888767605649026, "mean_inference_ms": 7.399896064921656, "mean_action_processing_ms": 0.12310242456630492, "mean_env_wait_ms": 4.719276551018763, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 84000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 42329.539, "learn_time_ms": 38791.606, "learn_throughput": 103.115, "update_time_ms": 26.591}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 316, "training_iteration": 21, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-55-27", "timestamp": 1655535327, "time_this_iter_s": 42.386138916015625, "time_total_s": 890.9557015895844, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 890.9557015895844, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 21.84237288135593, "ram_util_percent": 63.02881355932204}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.375, "cur_lr": 0.0010000000474974513, "total_loss": 5.75665807723999, "policy_loss": -0.11516480147838593, "vf_loss": 5.819857597351074, "vf_explained_var": 0.3592279553413391, "kl": 0.015396889299154282, "entropy": 1.8604332208633423, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 949.5980361327529, "episode_reward_min": -247.10906794667244, "episode_reward_mean": -45.39836583688855, "episode_len_mean": 257.14, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.96273390948772, -88.96140599250793, -94.27168609201908, -108.15497802942991, -29.68354383111, -37.18683950603008, -56.459312461316586, -57.18936463445425, -3.6936802193522453, -29.283654645085335, -55.10599774122238, -31.941025398671627, -104.38936453312635, -32.24722724407911, -133.43134911358356, -37.3298574090004, -115.26412086933851, -37.7631743401289, -67.29999975860119, -62.79626487195492, -53.32405784726143, -40.458466142416, -160.27168621867895, -12.238392233848572, -42.224578730762005, 5.4126060381531715, -158.82745879888535, -77.89914471656084, -118.82236614823341, -73.92829938977957, -6.513040706515312, 25.05604860931635, -38.364606596529484, -54.214354783296585, -59.31160504370928, -91.7999999821186, -61.605702966451645, -189.39463382214308, -95.95329535007477, -51.593751691281796, -0.4332568943500519, -150.7707834392786, 1.6573116481304169, -46.93431157618761, -79.72716955840588, -105.66982369869947, -110.39059150964022, -62.37097381800413, -213.85617545247078, -98.83431165665388, 12.576323799788952, 949.5980361327529, -35.105372846126556, -49.083243764936924, -74.06550929695368, -71.36933283507824, 904.0249491333961, -81.23521409928799, -76.6113586500287, -45.204826928675175, -43.534311421215534, -59.28448911011219, -103.4961705505848, -79.8339784219861, -28.38160914927721, -50.018813252449036, -12.425670728087425, -44.86393083631992, -28.968093879520893, -78.42710745334625, -247.10906794667244, -31.855871453881264, -45.40618781000376, -12.778591856360435, -45.34068953990936, -20.689364477992058, -55.22300448268652, -100.04903264343739, 26.821224339306355, 29.496396757662296, -95.37168601900339, -158.27614449709654, -46.29850201308727, -158.81394323706627, -52.267973482608795, 8.840483136475086, 28.46131956577301, -125.69224464148283, -64.17614460736513, -49.937060967087746, -14.105997547507286, -182.86642003804445, -99.8787292689085, -17.222228057682514, -18.55027251690626, -153.97168608754873, -1.809459649026394, -30.184726797044277, -110.47782681882381, -88.37097379565239], "episode_lengths": [295, 266, 272, 295, 223, 250, 266, 257, 233, 234, 255, 253, 260, 237, 293, 246, 278, 241, 253, 261, 249, 245, 287, 232, 247, 211, 302, 258, 291, 251, 239, 225, 252, 258, 263, 260, 263, 324, 272, 252, 221, 297, 232, 254, 260, 287, 278, 265, 320, 273, 223, 198, 237, 256, 270, 264, 205, 260, 262, 249, 244, 256, 277, 267, 233, 264, 233, 241, 250, 273, 335, 245, 257, 232, 252, 236, 259, 282, 215, 211, 262, 285, 256, 291, 269, 224, 216, 279, 255, 252, 232, 317, 270, 239, 234, 291, 229, 242, 279, 270]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5895278064837169, "mean_inference_ms": 7.40015788135793, "mean_action_processing_ms": 0.12301904228249523, "mean_env_wait_ms": 4.717641087646454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 949.5980361327529, "episode_reward_min": -247.10906794667244, "episode_reward_mean": -45.39836583688855, "episode_len_mean": 257.14, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-104.96273390948772, -88.96140599250793, -94.27168609201908, -108.15497802942991, -29.68354383111, -37.18683950603008, -56.459312461316586, -57.18936463445425, -3.6936802193522453, -29.283654645085335, -55.10599774122238, -31.941025398671627, -104.38936453312635, -32.24722724407911, -133.43134911358356, -37.3298574090004, -115.26412086933851, -37.7631743401289, -67.29999975860119, -62.79626487195492, -53.32405784726143, -40.458466142416, -160.27168621867895, -12.238392233848572, -42.224578730762005, 5.4126060381531715, -158.82745879888535, -77.89914471656084, -118.82236614823341, -73.92829938977957, -6.513040706515312, 25.05604860931635, -38.364606596529484, -54.214354783296585, -59.31160504370928, -91.7999999821186, -61.605702966451645, -189.39463382214308, -95.95329535007477, -51.593751691281796, -0.4332568943500519, -150.7707834392786, 1.6573116481304169, -46.93431157618761, -79.72716955840588, -105.66982369869947, -110.39059150964022, -62.37097381800413, -213.85617545247078, -98.83431165665388, 12.576323799788952, 949.5980361327529, -35.105372846126556, -49.083243764936924, -74.06550929695368, -71.36933283507824, 904.0249491333961, -81.23521409928799, -76.6113586500287, -45.204826928675175, -43.534311421215534, -59.28448911011219, -103.4961705505848, -79.8339784219861, -28.38160914927721, -50.018813252449036, -12.425670728087425, -44.86393083631992, -28.968093879520893, -78.42710745334625, -247.10906794667244, -31.855871453881264, -45.40618781000376, -12.778591856360435, -45.34068953990936, -20.689364477992058, -55.22300448268652, -100.04903264343739, 26.821224339306355, 29.496396757662296, -95.37168601900339, -158.27614449709654, -46.29850201308727, -158.81394323706627, -52.267973482608795, 8.840483136475086, 28.46131956577301, -125.69224464148283, -64.17614460736513, -49.937060967087746, -14.105997547507286, -182.86642003804445, -99.8787292689085, -17.222228057682514, -18.55027251690626, -153.97168608754873, -1.809459649026394, -30.184726797044277, -110.47782681882381, -88.37097379565239], "episode_lengths": [295, 266, 272, 295, 223, 250, 266, 257, 233, 234, 255, 253, 260, 237, 293, 246, 278, 241, 253, 261, 249, 245, 287, 232, 247, 211, 302, 258, 291, 251, 239, 225, 252, 258, 263, 260, 263, 324, 272, 252, 221, 297, 232, 254, 260, 287, 278, 265, 320, 273, 223, 198, 237, 256, 270, 264, 205, 260, 262, 249, 244, 256, 277, 267, 233, 264, 233, 241, 250, 273, 335, 245, 257, 232, 252, 236, 259, 282, 215, 211, 262, 285, 256, 291, 269, 224, 216, 279, 255, 252, 232, 317, 270, 239, 234, 291, 229, 242, 279, 270]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5895278064837169, "mean_inference_ms": 7.40015788135793, "mean_action_processing_ms": 0.12301904228249523, "mean_env_wait_ms": 4.717641087646454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 88000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 42221.024, "learn_time_ms": 38710.477, "learn_throughput": 103.331, "update_time_ms": 26.691}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 331, "training_iteration": 22, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-56-09", "timestamp": 1655535369, "time_this_iter_s": 41.59768462181091, "time_total_s": 932.5533862113953, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 932.5533862113953, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 19.715254237288136, "ram_util_percent": 62.96101694915253}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.375, "cur_lr": 0.0010000000474974513, "total_loss": 6.869687080383301, "policy_loss": -0.10981767624616623, "vf_loss": 6.93140983581543, "vf_explained_var": 0.1242525577545166, "kl": 0.01425036322325468, "entropy": 1.860770583152771, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 949.5980361327529, "episode_reward_min": -247.10906794667244, "episode_reward_mean": -45.79573419354856, "episode_len_mean": 257.22, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.7631743401289, -67.29999975860119, -62.79626487195492, -53.32405784726143, -40.458466142416, -160.27168621867895, -12.238392233848572, -42.224578730762005, 5.4126060381531715, -158.82745879888535, -77.89914471656084, -118.82236614823341, -73.92829938977957, -6.513040706515312, 25.05604860931635, -38.364606596529484, -54.214354783296585, -59.31160504370928, -91.7999999821186, -61.605702966451645, -189.39463382214308, -95.95329535007477, -51.593751691281796, -0.4332568943500519, -150.7707834392786, 1.6573116481304169, -46.93431157618761, -79.72716955840588, -105.66982369869947, -110.39059150964022, -62.37097381800413, -213.85617545247078, -98.83431165665388, 12.576323799788952, 949.5980361327529, -35.105372846126556, -49.083243764936924, -74.06550929695368, -71.36933283507824, 904.0249491333961, -81.23521409928799, -76.6113586500287, -45.204826928675175, -43.534311421215534, -59.28448911011219, -103.4961705505848, -79.8339784219861, -28.38160914927721, -50.018813252449036, -12.425670728087425, -44.86393083631992, -28.968093879520893, -78.42710745334625, -247.10906794667244, -31.855871453881264, -45.40618781000376, -12.778591856360435, -45.34068953990936, -20.689364477992058, -55.22300448268652, -100.04903264343739, 26.821224339306355, 29.496396757662296, -95.37168601900339, -158.27614449709654, -46.29850201308727, -158.81394323706627, -52.267973482608795, 8.840483136475086, 28.46131956577301, -125.69224464148283, -64.17614460736513, -49.937060967087746, -14.105997547507286, -182.86642003804445, -99.8787292689085, -17.222228057682514, -18.55027251690626, -153.97168608754873, -1.809459649026394, -30.184726797044277, -110.47782681882381, -88.37097379565239, 21.252135254442692, -36.321994073688984, -27.968093648552895, -45.070141449570656, -13.478729225695133, -45.35329523682594, -13.834523320198059, -46.75433622300625, -115.25707793235779, -185.68214212357998, -115.24783096462488, -167.48894713819027, -44.70263100415468, -172.80000000447035, -58.118136800825596, -70.53003800660372, -21.937195397913456], "episode_lengths": [241, 253, 261, 249, 245, 287, 232, 247, 211, 302, 258, 291, 251, 239, 225, 252, 258, 263, 260, 263, 324, 272, 252, 221, 297, 232, 254, 260, 287, 278, 265, 320, 273, 223, 198, 237, 256, 270, 264, 205, 260, 262, 249, 244, 256, 277, 267, 233, 264, 233, 241, 250, 273, 335, 245, 257, 232, 252, 236, 259, 282, 215, 211, 262, 285, 256, 291, 269, 224, 216, 279, 255, 252, 232, 317, 270, 239, 234, 291, 229, 242, 279, 270, 225, 241, 237, 255, 219, 246, 242, 262, 275, 320, 292, 307, 241, 308, 250, 261, 240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5914573912985709, "mean_inference_ms": 7.393475769584629, "mean_action_processing_ms": 0.12276669382487565, "mean_env_wait_ms": 4.712310348324055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 949.5980361327529, "episode_reward_min": -247.10906794667244, "episode_reward_mean": -45.79573419354856, "episode_len_mean": 257.22, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-37.7631743401289, -67.29999975860119, -62.79626487195492, -53.32405784726143, -40.458466142416, -160.27168621867895, -12.238392233848572, -42.224578730762005, 5.4126060381531715, -158.82745879888535, -77.89914471656084, -118.82236614823341, -73.92829938977957, -6.513040706515312, 25.05604860931635, -38.364606596529484, -54.214354783296585, -59.31160504370928, -91.7999999821186, -61.605702966451645, -189.39463382214308, -95.95329535007477, -51.593751691281796, -0.4332568943500519, -150.7707834392786, 1.6573116481304169, -46.93431157618761, -79.72716955840588, -105.66982369869947, -110.39059150964022, -62.37097381800413, -213.85617545247078, -98.83431165665388, 12.576323799788952, 949.5980361327529, -35.105372846126556, -49.083243764936924, -74.06550929695368, -71.36933283507824, 904.0249491333961, -81.23521409928799, -76.6113586500287, -45.204826928675175, -43.534311421215534, -59.28448911011219, -103.4961705505848, -79.8339784219861, -28.38160914927721, -50.018813252449036, -12.425670728087425, -44.86393083631992, -28.968093879520893, -78.42710745334625, -247.10906794667244, -31.855871453881264, -45.40618781000376, -12.778591856360435, -45.34068953990936, -20.689364477992058, -55.22300448268652, -100.04903264343739, 26.821224339306355, 29.496396757662296, -95.37168601900339, -158.27614449709654, -46.29850201308727, -158.81394323706627, -52.267973482608795, 8.840483136475086, 28.46131956577301, -125.69224464148283, -64.17614460736513, -49.937060967087746, -14.105997547507286, -182.86642003804445, -99.8787292689085, -17.222228057682514, -18.55027251690626, -153.97168608754873, -1.809459649026394, -30.184726797044277, -110.47782681882381, -88.37097379565239, 21.252135254442692, -36.321994073688984, -27.968093648552895, -45.070141449570656, -13.478729225695133, -45.35329523682594, -13.834523320198059, -46.75433622300625, -115.25707793235779, -185.68214212357998, -115.24783096462488, -167.48894713819027, -44.70263100415468, -172.80000000447035, -58.118136800825596, -70.53003800660372, -21.937195397913456], "episode_lengths": [241, 253, 261, 249, 245, 287, 232, 247, 211, 302, 258, 291, 251, 239, 225, 252, 258, 263, 260, 263, 324, 272, 252, 221, 297, 232, 254, 260, 287, 278, 265, 320, 273, 223, 198, 237, 256, 270, 264, 205, 260, 262, 249, 244, 256, 277, 267, 233, 264, 233, 241, 250, 273, 335, 245, 257, 232, 252, 236, 259, 282, 215, 211, 262, 285, 256, 291, 269, 224, 216, 279, 255, 252, 232, 317, 270, 239, 234, 291, 229, 242, 279, 270, 225, 241, 237, 255, 219, 246, 242, 262, 275, 320, 292, 307, 241, 308, 250, 261, 240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5914573912985709, "mean_inference_ms": 7.393475769584629, "mean_action_processing_ms": 0.12276669382487565, "mean_env_wait_ms": 4.712310348324055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 92000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 42163.813, "learn_time_ms": 38662.363, "learn_throughput": 103.46, "update_time_ms": 26.99}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 348, "training_iteration": 23, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-56-51", "timestamp": 1655535411, "time_this_iter_s": 41.606569051742554, "time_total_s": 974.1599552631378, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 974.1599552631378, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 19.696551724137933, "ram_util_percent": 62.991379310344826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.375, "cur_lr": 0.0010000000474974513, "total_loss": 6.678925514221191, "policy_loss": -0.1104147732257843, "vf_loss": 6.737185478210449, "vf_explained_var": -0.15034882724285126, "kl": 0.015453217551112175, "entropy": 1.8434566259384155, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 949.5980361327529, "episode_reward_min": -247.10906794667244, "episode_reward_mean": -48.19088343672454, "episode_len_mean": 258.91, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.214354783296585, -59.31160504370928, -91.7999999821186, -61.605702966451645, -189.39463382214308, -95.95329535007477, -51.593751691281796, -0.4332568943500519, -150.7707834392786, 1.6573116481304169, -46.93431157618761, -79.72716955840588, -105.66982369869947, -110.39059150964022, -62.37097381800413, -213.85617545247078, -98.83431165665388, 12.576323799788952, 949.5980361327529, -35.105372846126556, -49.083243764936924, -74.06550929695368, -71.36933283507824, 904.0249491333961, -81.23521409928799, -76.6113586500287, -45.204826928675175, -43.534311421215534, -59.28448911011219, -103.4961705505848, -79.8339784219861, -28.38160914927721, -50.018813252449036, -12.425670728087425, -44.86393083631992, -28.968093879520893, -78.42710745334625, -247.10906794667244, -31.855871453881264, -45.40618781000376, -12.778591856360435, -45.34068953990936, -20.689364477992058, -55.22300448268652, -100.04903264343739, 26.821224339306355, 29.496396757662296, -95.37168601900339, -158.27614449709654, -46.29850201308727, -158.81394323706627, -52.267973482608795, 8.840483136475086, 28.46131956577301, -125.69224464148283, -64.17614460736513, -49.937060967087746, -14.105997547507286, -182.86642003804445, -99.8787292689085, -17.222228057682514, -18.55027251690626, -153.97168608754873, -1.809459649026394, -30.184726797044277, -110.47782681882381, -88.37097379565239, 21.252135254442692, -36.321994073688984, -27.968093648552895, -45.070141449570656, -13.478729225695133, -45.35329523682594, -13.834523320198059, -46.75433622300625, -115.25707793235779, -185.68214212357998, -115.24783096462488, -167.48894713819027, -44.70263100415468, -172.80000000447035, -58.118136800825596, -70.53003800660372, -21.937195397913456, -94.97652466595173, -40.60000014305115, -34.66550924628973, -108.56991286575794, -56.750415451824665, -56.93521397560835, -47.846540965139866, -75.6906771287322, -136.95817112922668, -28.90570856630802, -93.69583978503942, -28.64133346825838, -49.436631850898266, -205.99445989727974, -48.629257798194885, -51.48160923272371], "episode_lengths": [258, 263, 260, 263, 324, 272, 252, 221, 297, 232, 254, 260, 287, 278, 265, 320, 273, 223, 198, 237, 256, 270, 264, 205, 260, 262, 249, 244, 256, 277, 267, 233, 264, 233, 241, 250, 273, 335, 245, 257, 232, 252, 236, 259, 282, 215, 211, 262, 285, 256, 291, 269, 224, 216, 279, 255, 252, 232, 317, 270, 239, 234, 291, 229, 242, 279, 270, 225, 241, 237, 255, 219, 246, 242, 262, 275, 320, 292, 307, 241, 308, 250, 261, 240, 277, 249, 242, 275, 251, 246, 262, 266, 300, 249, 269, 245, 248, 327, 255, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5923310476309073, "mean_inference_ms": 7.389068499122735, "mean_action_processing_ms": 0.1226047068569257, "mean_env_wait_ms": 4.711049332587099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 949.5980361327529, "episode_reward_min": -247.10906794667244, "episode_reward_mean": -48.19088343672454, "episode_len_mean": 258.91, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.214354783296585, -59.31160504370928, -91.7999999821186, -61.605702966451645, -189.39463382214308, -95.95329535007477, -51.593751691281796, -0.4332568943500519, -150.7707834392786, 1.6573116481304169, -46.93431157618761, -79.72716955840588, -105.66982369869947, -110.39059150964022, -62.37097381800413, -213.85617545247078, -98.83431165665388, 12.576323799788952, 949.5980361327529, -35.105372846126556, -49.083243764936924, -74.06550929695368, -71.36933283507824, 904.0249491333961, -81.23521409928799, -76.6113586500287, -45.204826928675175, -43.534311421215534, -59.28448911011219, -103.4961705505848, -79.8339784219861, -28.38160914927721, -50.018813252449036, -12.425670728087425, -44.86393083631992, -28.968093879520893, -78.42710745334625, -247.10906794667244, -31.855871453881264, -45.40618781000376, -12.778591856360435, -45.34068953990936, -20.689364477992058, -55.22300448268652, -100.04903264343739, 26.821224339306355, 29.496396757662296, -95.37168601900339, -158.27614449709654, -46.29850201308727, -158.81394323706627, -52.267973482608795, 8.840483136475086, 28.46131956577301, -125.69224464148283, -64.17614460736513, -49.937060967087746, -14.105997547507286, -182.86642003804445, -99.8787292689085, -17.222228057682514, -18.55027251690626, -153.97168608754873, -1.809459649026394, -30.184726797044277, -110.47782681882381, -88.37097379565239, 21.252135254442692, -36.321994073688984, -27.968093648552895, -45.070141449570656, -13.478729225695133, -45.35329523682594, -13.834523320198059, -46.75433622300625, -115.25707793235779, -185.68214212357998, -115.24783096462488, -167.48894713819027, -44.70263100415468, -172.80000000447035, -58.118136800825596, -70.53003800660372, -21.937195397913456, -94.97652466595173, -40.60000014305115, -34.66550924628973, -108.56991286575794, -56.750415451824665, -56.93521397560835, -47.846540965139866, -75.6906771287322, -136.95817112922668, -28.90570856630802, -93.69583978503942, -28.64133346825838, -49.436631850898266, -205.99445989727974, -48.629257798194885, -51.48160923272371], "episode_lengths": [258, 263, 260, 263, 324, 272, 252, 221, 297, 232, 254, 260, 287, 278, 265, 320, 273, 223, 198, 237, 256, 270, 264, 205, 260, 262, 249, 244, 256, 277, 267, 233, 264, 233, 241, 250, 273, 335, 245, 257, 232, 252, 236, 259, 282, 215, 211, 262, 285, 256, 291, 269, 224, 216, 279, 255, 252, 232, 317, 270, 239, 234, 291, 229, 242, 279, 270, 225, 241, 237, 255, 219, 246, 242, 262, 275, 320, 292, 307, 241, 308, 250, 261, 240, 277, 249, 242, 275, 251, 246, 262, 266, 300, 249, 269, 245, 248, 327, 255, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5923310476309073, "mean_inference_ms": 7.389068499122735, "mean_action_processing_ms": 0.1226047068569257, "mean_env_wait_ms": 4.711049332587099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 96000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 42074.364, "learn_time_ms": 38575.234, "learn_throughput": 103.693, "update_time_ms": 27.169}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 364, "training_iteration": 24, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-57-33", "timestamp": 1655535453, "time_this_iter_s": 41.745553970336914, "time_total_s": 1015.9055092334747, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 1015.9055092334747, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 19.491525423728813, "ram_util_percent": 63.010169491525424}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.375, "cur_lr": 0.0010000000474974513, "total_loss": 5.9524383544921875, "policy_loss": -0.1010817363858223, "vf_loss": 6.004693984985352, "vf_explained_var": 0.19111089408397675, "kl": 0.014467068947851658, "entropy": 1.8395512104034424, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 125.0}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 949.5980361327529, "episode_reward_min": -247.10906794667244, "episode_reward_mean": -43.313651334419845, "episode_len_mean": 256.43, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.83431165665388, 12.576323799788952, 949.5980361327529, -35.105372846126556, -49.083243764936924, -74.06550929695368, -71.36933283507824, 904.0249491333961, -81.23521409928799, -76.6113586500287, -45.204826928675175, -43.534311421215534, -59.28448911011219, -103.4961705505848, -79.8339784219861, -28.38160914927721, -50.018813252449036, -12.425670728087425, -44.86393083631992, -28.968093879520893, -78.42710745334625, -247.10906794667244, -31.855871453881264, -45.40618781000376, -12.778591856360435, -45.34068953990936, -20.689364477992058, -55.22300448268652, -100.04903264343739, 26.821224339306355, 29.496396757662296, -95.37168601900339, -158.27614449709654, -46.29850201308727, -158.81394323706627, -52.267973482608795, 8.840483136475086, 28.46131956577301, -125.69224464148283, -64.17614460736513, -49.937060967087746, -14.105997547507286, -182.86642003804445, -99.8787292689085, -17.222228057682514, -18.55027251690626, -153.97168608754873, -1.809459649026394, -30.184726797044277, -110.47782681882381, -88.37097379565239, 21.252135254442692, -36.321994073688984, -27.968093648552895, -45.070141449570656, -13.478729225695133, -45.35329523682594, -13.834523320198059, -46.75433622300625, -115.25707793235779, -185.68214212357998, -115.24783096462488, -167.48894713819027, -44.70263100415468, -172.80000000447035, -58.118136800825596, -70.53003800660372, -21.937195397913456, -94.97652466595173, -40.60000014305115, -34.66550924628973, -108.56991286575794, -56.750415451824665, -56.93521397560835, -47.846540965139866, -75.6906771287322, -136.95817112922668, -28.90570856630802, -93.69583978503942, -28.64133346825838, -49.436631850898266, -205.99445989727974, -48.629257798194885, -51.48160923272371, -37.41331148892641, 17.123855382204056, -112.46519338339567, -45.07872910052538, -43.705542020499706, -30.404100321233273, -39.44341050833464, -107.83017263561487, -78.26105058193207, -153.89999990165234, -24.327339500188828, -37.059307888150215, -6.276176042854786, -80.58677996695042, -75.8610862120986, -29.157563537359238], "episode_lengths": [273, 223, 198, 237, 256, 270, 264, 205, 260, 262, 249, 244, 256, 277, 267, 233, 264, 233, 241, 250, 273, 335, 245, 257, 232, 252, 236, 259, 282, 215, 211, 262, 285, 256, 291, 269, 224, 216, 279, 255, 252, 232, 317, 270, 239, 234, 291, 229, 242, 279, 270, 225, 241, 237, 255, 219, 246, 242, 262, 275, 320, 292, 307, 241, 308, 250, 261, 240, 277, 249, 242, 275, 251, 246, 262, 266, 300, 249, 269, 245, 248, 327, 255, 252, 248, 217, 282, 247, 245, 243, 241, 288, 266, 288, 259, 241, 231, 256, 262, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5931291010859032, "mean_inference_ms": 7.385644707001907, "mean_action_processing_ms": 0.12256129632885066, "mean_env_wait_ms": 4.709383448855578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 949.5980361327529, "episode_reward_min": -247.10906794667244, "episode_reward_mean": -43.313651334419845, "episode_len_mean": 256.43, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-98.83431165665388, 12.576323799788952, 949.5980361327529, -35.105372846126556, -49.083243764936924, -74.06550929695368, -71.36933283507824, 904.0249491333961, -81.23521409928799, -76.6113586500287, -45.204826928675175, -43.534311421215534, -59.28448911011219, -103.4961705505848, -79.8339784219861, -28.38160914927721, -50.018813252449036, -12.425670728087425, -44.86393083631992, -28.968093879520893, -78.42710745334625, -247.10906794667244, -31.855871453881264, -45.40618781000376, -12.778591856360435, -45.34068953990936, -20.689364477992058, -55.22300448268652, -100.04903264343739, 26.821224339306355, 29.496396757662296, -95.37168601900339, -158.27614449709654, -46.29850201308727, -158.81394323706627, -52.267973482608795, 8.840483136475086, 28.46131956577301, -125.69224464148283, -64.17614460736513, -49.937060967087746, -14.105997547507286, -182.86642003804445, -99.8787292689085, -17.222228057682514, -18.55027251690626, -153.97168608754873, -1.809459649026394, -30.184726797044277, -110.47782681882381, -88.37097379565239, 21.252135254442692, -36.321994073688984, -27.968093648552895, -45.070141449570656, -13.478729225695133, -45.35329523682594, -13.834523320198059, -46.75433622300625, -115.25707793235779, -185.68214212357998, -115.24783096462488, -167.48894713819027, -44.70263100415468, -172.80000000447035, -58.118136800825596, -70.53003800660372, -21.937195397913456, -94.97652466595173, -40.60000014305115, -34.66550924628973, -108.56991286575794, -56.750415451824665, -56.93521397560835, -47.846540965139866, -75.6906771287322, -136.95817112922668, -28.90570856630802, -93.69583978503942, -28.64133346825838, -49.436631850898266, -205.99445989727974, -48.629257798194885, -51.48160923272371, -37.41331148892641, 17.123855382204056, -112.46519338339567, -45.07872910052538, -43.705542020499706, -30.404100321233273, -39.44341050833464, -107.83017263561487, -78.26105058193207, -153.89999990165234, -24.327339500188828, -37.059307888150215, -6.276176042854786, -80.58677996695042, -75.8610862120986, -29.157563537359238], "episode_lengths": [273, 223, 198, 237, 256, 270, 264, 205, 260, 262, 249, 244, 256, 277, 267, 233, 264, 233, 241, 250, 273, 335, 245, 257, 232, 252, 236, 259, 282, 215, 211, 262, 285, 256, 291, 269, 224, 216, 279, 255, 252, 232, 317, 270, 239, 234, 291, 229, 242, 279, 270, 225, 241, 237, 255, 219, 246, 242, 262, 275, 320, 292, 307, 241, 308, 250, 261, 240, 277, 249, 242, 275, 251, 246, 262, 266, 300, 249, 269, 245, 248, 327, 255, 252, 248, 217, 282, 247, 245, 243, 241, 288, 266, 288, 259, 241, 231, 256, 262, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5931291010859032, "mean_inference_ms": 7.385644707001907, "mean_action_processing_ms": 0.12256129632885066, "mean_env_wait_ms": 4.709383448855578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 100000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 42055.595, "learn_time_ms": 38546.472, "learn_throughput": 103.771, "update_time_ms": 27.566}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "episodes_total": 380, "training_iteration": 25, "trial_id": "7dfca_00000", "experiment_id": "d7c209a54f0e455abd35fa5b3e028c07", "date": "2022-06-18_09-58-15", "timestamp": 1655535495, "time_this_iter_s": 42.01877760887146, "time_total_s": 1057.9242868423462, "pid": 50320, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 1057.9242868423462, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 15.673500061035156, "perf": {"cpu_util_percent": 19.439655172413794, "ram_util_percent": 63.108620689655176}}
