{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0, "cur_lr": 0.0007999999797903001, "total_loss": 7.770480632781982, "policy_loss": -0.05433255806565285, "vf_loss": 7.808453559875488, "vf_explained_var": 0.04054022580385208, "kl": 0.016360219568014145, "entropy": 2.0628297328948975, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -27.21394331008196, "episode_reward_min": -80.64553665369749, "episode_reward_mean": -50.84641038030386, "episode_len_mean": 242.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.74397340416908, -42.8321273252368, -61.97872921824455, -40.86292444169521, -49.29224453866482, -47.99248404800892, -50.7761444747448, -27.21394331008196, -80.64553665369749, -46.12599638849497], "episode_lengths": [248, 244, 243, 241, 244, 243, 241, 232, 243, 241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5434457999301621, "mean_inference_ms": 7.112513120430874, "mean_action_processing_ms": 0.12107655346631052, "mean_env_wait_ms": 4.820489313497962, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -27.21394331008196, "episode_reward_min": -80.64553665369749, "episode_reward_mean": -50.84641038030386, "episode_len_mean": 242.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.74397340416908, -42.8321273252368, -61.97872921824455, -40.86292444169521, -49.29224453866482, -47.99248404800892, -50.7761444747448, -27.21394331008196, -80.64553665369749, -46.12599638849497], "episode_lengths": [248, 244, 243, 241, 244, 243, 241, 232, 243, 241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5434457999301621, "mean_inference_ms": 7.112513120430874, "mean_action_processing_ms": 0.12107655346631052, "mean_env_wait_ms": 4.820489313497962, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 26614.934, "learn_time_ms": 22525.597, "learn_throughput": 177.576, "update_time_ms": 26.471}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 10, "training_iteration": 1, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-28-32", "timestamp": 1655537312, "time_this_iter_s": 26.624929189682007, "time_total_s": 26.624929189682007, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 26.624929189682007, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 25.292105263157893, "ram_util_percent": 62.83157894736844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0, "cur_lr": 0.0007999999797903001, "total_loss": 7.492949962615967, "policy_loss": -0.06287685036659241, "vf_loss": 7.536649703979492, "vf_explained_var": -0.045259423553943634, "kl": 0.019177857786417007, "entropy": 2.031768560409546, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -14.46663298457861, "episode_reward_min": -216.28539165109396, "episode_reward_mean": -62.82396721907637, "episode_len_mean": 247.63636363636363, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.74397340416908, -42.8321273252368, -61.97872921824455, -40.86292444169521, -49.29224453866482, -47.99248404800892, -50.7761444747448, -27.21394331008196, -80.64553665369749, -46.12599638849497, -216.28539165109396, -38.33103724569082, -60.34068300575018, -68.50924603641033, -18.675044238567352, -14.46663298457861, -16.81135879456997, -125.72457878291607, -91.08077459782362, -97.34656513482332, -73.08333387225866, -53.00852867215872], "episode_lengths": [248, 244, 243, 241, 244, 243, 241, 232, 243, 241, 307, 232, 252, 261, 233, 228, 227, 273, 261, 257, 255, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525357542632322, "mean_inference_ms": 7.181633766403288, "mean_action_processing_ms": 0.12304846638831313, "mean_env_wait_ms": 4.927264197466365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -14.46663298457861, "episode_reward_min": -216.28539165109396, "episode_reward_mean": -62.82396721907637, "episode_len_mean": 247.63636363636363, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.74397340416908, -42.8321273252368, -61.97872921824455, -40.86292444169521, -49.29224453866482, -47.99248404800892, -50.7761444747448, -27.21394331008196, -80.64553665369749, -46.12599638849497, -216.28539165109396, -38.33103724569082, -60.34068300575018, -68.50924603641033, -18.675044238567352, -14.46663298457861, -16.81135879456997, -125.72457878291607, -91.08077459782362, -97.34656513482332, -73.08333387225866, -53.00852867215872], "episode_lengths": [248, 244, 243, 241, 244, 243, 241, 232, 243, 241, 307, 232, 252, 261, 233, 228, 227, 273, 261, 257, 255, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525357542632322, "mean_inference_ms": 7.181633766403288, "mean_action_processing_ms": 0.12304846638831313, "mean_env_wait_ms": 4.927264197466365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 26724.568, "learn_time_ms": 22840.269, "learn_throughput": 175.129, "update_time_ms": 27.227}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 22, "training_iteration": 2, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-28-59", "timestamp": 1655537339, "time_this_iter_s": 26.844193935394287, "time_total_s": 53.469123125076294, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 53.469123125076294, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 30.23243243243243, "ram_util_percent": 63.03783783783784}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0, "cur_lr": 0.0007999999797903001, "total_loss": 8.342787742614746, "policy_loss": -0.06998312473297119, "vf_loss": 8.392159461975098, "vf_explained_var": -0.010189678519964218, "kl": 0.020612455904483795, "entropy": 2.0173676013946533, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 9.487086974084377, "episode_reward_min": -216.28539165109396, "episode_reward_mean": -67.22695807884965, "episode_len_mean": 250.33333333333334, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.74397340416908, -42.8321273252368, -61.97872921824455, -40.86292444169521, -49.29224453866482, -47.99248404800892, -50.7761444747448, -27.21394331008196, -80.64553665369749, -46.12599638849497, -216.28539165109396, -38.33103724569082, -60.34068300575018, -68.50924603641033, -18.675044238567352, -14.46663298457861, -16.81135879456997, -125.72457878291607, -91.08077459782362, -97.34656513482332, -73.08333387225866, -53.00852867215872, -101.25608486682177, -118.46105070412159, -10.561050727963448, -122.82604984939098, -78.50725572556257, -7.824514515697956, -171.5948626846075, -57.696264922618866, -78.2500963434577, -76.27524197846651, 9.487086974084377, -59.79999990016222, -102.1990974843502, -62.278729289770126], "episode_lengths": [248, 244, 243, 241, 244, 243, 241, 232, 243, 241, 307, 232, 252, 261, 233, 228, 227, 273, 261, 257, 255, 242, 264, 270, 223, 274, 255, 229, 307, 245, 261, 262, 219, 248, 265, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523003097825581, "mean_inference_ms": 7.247300753659859, "mean_action_processing_ms": 0.12078337945649145, "mean_env_wait_ms": 4.876430761045131, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 9.487086974084377, "episode_reward_min": -216.28539165109396, "episode_reward_mean": -67.22695807884965, "episode_len_mean": 250.33333333333334, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.74397340416908, -42.8321273252368, -61.97872921824455, -40.86292444169521, -49.29224453866482, -47.99248404800892, -50.7761444747448, -27.21394331008196, -80.64553665369749, -46.12599638849497, -216.28539165109396, -38.33103724569082, -60.34068300575018, -68.50924603641033, -18.675044238567352, -14.46663298457861, -16.81135879456997, -125.72457878291607, -91.08077459782362, -97.34656513482332, -73.08333387225866, -53.00852867215872, -101.25608486682177, -118.46105070412159, -10.561050727963448, -122.82604984939098, -78.50725572556257, -7.824514515697956, -171.5948626846075, -57.696264922618866, -78.2500963434577, -76.27524197846651, 9.487086974084377, -59.79999990016222, -102.1990974843502, -62.278729289770126], "episode_lengths": [248, 244, 243, 241, 244, 243, 241, 232, 243, 241, 307, 232, 252, 261, 233, 228, 227, 273, 261, 257, 255, 242, 264, 270, 223, 274, 255, 229, 307, 245, 261, 262, 219, 248, 265, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523003097825581, "mean_inference_ms": 7.247300753659859, "mean_action_processing_ms": 0.12078337945649145, "mean_env_wait_ms": 4.876430761045131, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 26593.644, "learn_time_ms": 22818.01, "learn_throughput": 175.3, "update_time_ms": 27.48}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 36, "training_iteration": 3, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-29-25", "timestamp": 1655537365, "time_this_iter_s": 26.341792345046997, "time_total_s": 79.81091547012329, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 79.81091547012329, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 28.402702702702705, "ram_util_percent": 63.351351351351376}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 7.06852912902832, "policy_loss": -0.08058296889066696, "vf_loss": 7.122793674468994, "vf_explained_var": 0.160541370511055, "kl": 0.017546018585562706, "entropy": 1.9954414367675781, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 9.487086974084377, "episode_reward_min": -279.34295539557934, "episode_reward_mean": -76.84044360805233, "episode_len_mean": 256.0377358490566, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.74397340416908, -42.8321273252368, -61.97872921824455, -40.86292444169521, -49.29224453866482, -47.99248404800892, -50.7761444747448, -27.21394331008196, -80.64553665369749, -46.12599638849497, -216.28539165109396, -38.33103724569082, -60.34068300575018, -68.50924603641033, -18.675044238567352, -14.46663298457861, -16.81135879456997, -125.72457878291607, -91.08077459782362, -97.34656513482332, -73.08333387225866, -53.00852867215872, -101.25608486682177, -118.46105070412159, -10.561050727963448, -122.82604984939098, -78.50725572556257, -7.824514515697956, -171.5948626846075, -57.696264922618866, -78.2500963434577, -76.27524197846651, 9.487086974084377, -59.79999990016222, -102.1990974843502, -62.278729289770126, -32.77782670408487, -23.793673038482666, -82.36131177842617, -176.139062397182, -279.34295539557934, -82.4275192245841, -198.89445261657238, -79.25487396121025, -56.63614872843027, -61.263371132314205, -26.870428331196308, -146.0876069366932, -130.36014830321074, -43.33505704253912, -93.03521425276995, -141.65071055293083, 1.857340008020401], "episode_lengths": [248, 244, 243, 241, 244, 243, 241, 232, 243, 241, 307, 232, 252, 261, 233, 228, 227, 273, 261, 257, 255, 242, 264, 270, 223, 274, 255, 229, 307, 245, 261, 262, 219, 248, 265, 242, 241, 230, 255, 305, 351, 264, 327, 262, 250, 241, 229, 289, 294, 251, 263, 294, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559001838927314, "mean_inference_ms": 7.28396424132813, "mean_action_processing_ms": 0.12053019443601357, "mean_env_wait_ms": 4.851396501247749, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 9.487086974084377, "episode_reward_min": -279.34295539557934, "episode_reward_mean": -76.84044360805233, "episode_len_mean": 256.0377358490566, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.74397340416908, -42.8321273252368, -61.97872921824455, -40.86292444169521, -49.29224453866482, -47.99248404800892, -50.7761444747448, -27.21394331008196, -80.64553665369749, -46.12599638849497, -216.28539165109396, -38.33103724569082, -60.34068300575018, -68.50924603641033, -18.675044238567352, -14.46663298457861, -16.81135879456997, -125.72457878291607, -91.08077459782362, -97.34656513482332, -73.08333387225866, -53.00852867215872, -101.25608486682177, -118.46105070412159, -10.561050727963448, -122.82604984939098, -78.50725572556257, -7.824514515697956, -171.5948626846075, -57.696264922618866, -78.2500963434577, -76.27524197846651, 9.487086974084377, -59.79999990016222, -102.1990974843502, -62.278729289770126, -32.77782670408487, -23.793673038482666, -82.36131177842617, -176.139062397182, -279.34295539557934, -82.4275192245841, -198.89445261657238, -79.25487396121025, -56.63614872843027, -61.263371132314205, -26.870428331196308, -146.0876069366932, -130.36014830321074, -43.33505704253912, -93.03521425276995, -141.65071055293083, 1.857340008020401], "episode_lengths": [248, 244, 243, 241, 244, 243, 241, 232, 243, 241, 307, 232, 252, 261, 233, 228, 227, 273, 261, 257, 255, 242, 264, 270, 223, 274, 255, 229, 307, 245, 261, 262, 219, 248, 265, 242, 241, 230, 255, 305, 351, 264, 327, 262, 250, 241, 229, 289, 294, 251, 263, 294, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559001838927314, "mean_inference_ms": 7.28396424132813, "mean_action_processing_ms": 0.12053019443601357, "mean_env_wait_ms": 4.851396501247749, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 26529.978, "learn_time_ms": 22822.167, "learn_throughput": 175.268, "update_time_ms": 27.357}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 53, "training_iteration": 4, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-29-52", "timestamp": 1655537392, "time_this_iter_s": 26.34899401664734, "time_total_s": 106.15990948677063, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 106.15990948677063, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 28.078378378378375, "ram_util_percent": 63.26486486486488}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 7.510964870452881, "policy_loss": -0.07811571657657623, "vf_loss": 7.563591957092285, "vf_explained_var": 0.02917233295738697, "kl": 0.016992250457406044, "entropy": 1.9762014150619507, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 9.487086974084377, "episode_reward_min": -279.34295539557934, "episode_reward_mean": -78.2448280868468, "episode_len_mean": 256.5223880597015, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.74397340416908, -42.8321273252368, -61.97872921824455, -40.86292444169521, -49.29224453866482, -47.99248404800892, -50.7761444747448, -27.21394331008196, -80.64553665369749, -46.12599638849497, -216.28539165109396, -38.33103724569082, -60.34068300575018, -68.50924603641033, -18.675044238567352, -14.46663298457861, -16.81135879456997, -125.72457878291607, -91.08077459782362, -97.34656513482332, -73.08333387225866, -53.00852867215872, -101.25608486682177, -118.46105070412159, -10.561050727963448, -122.82604984939098, -78.50725572556257, -7.824514515697956, -171.5948626846075, -57.696264922618866, -78.2500963434577, -76.27524197846651, 9.487086974084377, -59.79999990016222, -102.1990974843502, -62.278729289770126, -32.77782670408487, -23.793673038482666, -82.36131177842617, -176.139062397182, -279.34295539557934, -82.4275192245841, -198.89445261657238, -79.25487396121025, -56.63614872843027, -61.263371132314205, -26.870428331196308, -146.0876069366932, -130.36014830321074, -43.33505704253912, -93.03521425276995, -141.65071055293083, 1.857340008020401, -39.18760685622692, -78.77475640177727, -31.370783410966396, -20.460459619760513, -68.47206322103739, -114.16226065158844, -35.88448987901211, -118.20000000298023, -101.92531210929155, -106.75846616923809, -160.47872922569513, -79.35846592485905, -80.32018083333969, -134.50639628618956], "episode_lengths": [248, 244, 243, 241, 244, 243, 241, 232, 243, 241, 307, 232, 252, 261, 233, 228, 227, 273, 261, 257, 255, 242, 264, 270, 223, 274, 255, 229, 307, 245, 261, 262, 219, 248, 265, 242, 241, 230, 255, 305, 351, 264, 327, 262, 250, 241, 229, 289, 294, 251, 263, 294, 212, 248, 244, 232, 236, 246, 281, 239, 253, 275, 268, 296, 250, 258, 291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5579524804318159, "mean_inference_ms": 7.302458216572543, "mean_action_processing_ms": 0.12062755813253685, "mean_env_wait_ms": 4.825295010587414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 9.487086974084377, "episode_reward_min": -279.34295539557934, "episode_reward_mean": -78.2448280868468, "episode_len_mean": 256.5223880597015, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.74397340416908, -42.8321273252368, -61.97872921824455, -40.86292444169521, -49.29224453866482, -47.99248404800892, -50.7761444747448, -27.21394331008196, -80.64553665369749, -46.12599638849497, -216.28539165109396, -38.33103724569082, -60.34068300575018, -68.50924603641033, -18.675044238567352, -14.46663298457861, -16.81135879456997, -125.72457878291607, -91.08077459782362, -97.34656513482332, -73.08333387225866, -53.00852867215872, -101.25608486682177, -118.46105070412159, -10.561050727963448, -122.82604984939098, -78.50725572556257, -7.824514515697956, -171.5948626846075, -57.696264922618866, -78.2500963434577, -76.27524197846651, 9.487086974084377, -59.79999990016222, -102.1990974843502, -62.278729289770126, -32.77782670408487, -23.793673038482666, -82.36131177842617, -176.139062397182, -279.34295539557934, -82.4275192245841, -198.89445261657238, -79.25487396121025, -56.63614872843027, -61.263371132314205, -26.870428331196308, -146.0876069366932, -130.36014830321074, -43.33505704253912, -93.03521425276995, -141.65071055293083, 1.857340008020401, -39.18760685622692, -78.77475640177727, -31.370783410966396, -20.460459619760513, -68.47206322103739, -114.16226065158844, -35.88448987901211, -118.20000000298023, -101.92531210929155, -106.75846616923809, -160.47872922569513, -79.35846592485905, -80.32018083333969, -134.50639628618956], "episode_lengths": [248, 244, 243, 241, 244, 243, 241, 232, 243, 241, 307, 232, 252, 261, 233, 228, 227, 273, 261, 257, 255, 242, 264, 270, 223, 274, 255, 229, 307, 245, 261, 262, 219, 248, 265, 242, 241, 230, 255, 305, 351, 264, 327, 262, 250, 241, 229, 289, 294, 251, 263, 294, 212, 248, 244, 232, 236, 246, 281, 239, 253, 275, 268, 296, 250, 258, 291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5579524804318159, "mean_inference_ms": 7.302458216572543, "mean_action_processing_ms": 0.12062755813253685, "mean_env_wait_ms": 4.825295010587414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 26551.3, "learn_time_ms": 22877.589, "learn_throughput": 174.844, "update_time_ms": 27.083}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 67, "training_iteration": 5, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-30-19", "timestamp": 1655537419, "time_this_iter_s": 26.646583795547485, "time_total_s": 132.80649328231812, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 132.80649328231812, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 29.48378378378378, "ram_util_percent": 63.235135135135145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 7.238240718841553, "policy_loss": -0.03454655408859253, "vf_loss": 7.2616286277771, "vf_explained_var": 0.012742746621370316, "kl": 0.007438810542225838, "entropy": 1.960914134979248, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 971.5917282253504, "episode_reward_min": -279.34295539557934, "episode_reward_mean": -67.89692109455186, "episode_len_mean": 256.68674698795184, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.74397340416908, -42.8321273252368, -61.97872921824455, -40.86292444169521, -49.29224453866482, -47.99248404800892, -50.7761444747448, -27.21394331008196, -80.64553665369749, -46.12599638849497, -216.28539165109396, -38.33103724569082, -60.34068300575018, -68.50924603641033, -18.675044238567352, -14.46663298457861, -16.81135879456997, -125.72457878291607, -91.08077459782362, -97.34656513482332, -73.08333387225866, -53.00852867215872, -101.25608486682177, -118.46105070412159, -10.561050727963448, -122.82604984939098, -78.50725572556257, -7.824514515697956, -171.5948626846075, -57.696264922618866, -78.2500963434577, -76.27524197846651, 9.487086974084377, -59.79999990016222, -102.1990974843502, -62.278729289770126, -32.77782670408487, -23.793673038482666, -82.36131177842617, -176.139062397182, -279.34295539557934, -82.4275192245841, -198.89445261657238, -79.25487396121025, -56.63614872843027, -61.263371132314205, -26.870428331196308, -146.0876069366932, -130.36014830321074, -43.33505704253912, -93.03521425276995, -141.65071055293083, 1.857340008020401, -39.18760685622692, -78.77475640177727, -31.370783410966396, -20.460459619760513, -68.47206322103739, -114.16226065158844, -35.88448987901211, -118.20000000298023, -101.92531210929155, -106.75846616923809, -160.47872922569513, -79.35846592485905, -80.32018083333969, -134.50639628618956, -65.11345829069614, -44.67872916907072, -268.23490458726883, -29.63202451914549, -16.519728861749172, -136.11428623646498, 971.5917282253504, -8.577826716005802, -195.75244031101465, -74.18448954075575, -90.08678000420332, -128.71304079145193, -33.41135859489441, -110.34266006946564, -113.98094443231821, -49.290025129914284], "episode_lengths": [248, 244, 243, 241, 244, 243, 241, 232, 243, 241, 307, 232, 252, 261, 233, 228, 227, 273, 261, 257, 255, 242, 264, 270, 223, 274, 255, 229, 307, 245, 261, 262, 219, 248, 265, 242, 241, 230, 255, 305, 351, 264, 327, 262, 250, 241, 229, 289, 294, 251, 263, 294, 212, 248, 244, 232, 236, 246, 281, 239, 253, 275, 268, 296, 250, 258, 291, 252, 242, 333, 233, 226, 296, 148, 213, 320, 258, 262, 292, 240, 281, 278, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5587924708861839, "mean_inference_ms": 7.3076529608325265, "mean_action_processing_ms": 0.12125890861009192, "mean_env_wait_ms": 4.811357179440032, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 971.5917282253504, "episode_reward_min": -279.34295539557934, "episode_reward_mean": -67.89692109455186, "episode_len_mean": 256.68674698795184, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.74397340416908, -42.8321273252368, -61.97872921824455, -40.86292444169521, -49.29224453866482, -47.99248404800892, -50.7761444747448, -27.21394331008196, -80.64553665369749, -46.12599638849497, -216.28539165109396, -38.33103724569082, -60.34068300575018, -68.50924603641033, -18.675044238567352, -14.46663298457861, -16.81135879456997, -125.72457878291607, -91.08077459782362, -97.34656513482332, -73.08333387225866, -53.00852867215872, -101.25608486682177, -118.46105070412159, -10.561050727963448, -122.82604984939098, -78.50725572556257, -7.824514515697956, -171.5948626846075, -57.696264922618866, -78.2500963434577, -76.27524197846651, 9.487086974084377, -59.79999990016222, -102.1990974843502, -62.278729289770126, -32.77782670408487, -23.793673038482666, -82.36131177842617, -176.139062397182, -279.34295539557934, -82.4275192245841, -198.89445261657238, -79.25487396121025, -56.63614872843027, -61.263371132314205, -26.870428331196308, -146.0876069366932, -130.36014830321074, -43.33505704253912, -93.03521425276995, -141.65071055293083, 1.857340008020401, -39.18760685622692, -78.77475640177727, -31.370783410966396, -20.460459619760513, -68.47206322103739, -114.16226065158844, -35.88448987901211, -118.20000000298023, -101.92531210929155, -106.75846616923809, -160.47872922569513, -79.35846592485905, -80.32018083333969, -134.50639628618956, -65.11345829069614, -44.67872916907072, -268.23490458726883, -29.63202451914549, -16.519728861749172, -136.11428623646498, 971.5917282253504, -8.577826716005802, -195.75244031101465, -74.18448954075575, -90.08678000420332, -128.71304079145193, -33.41135859489441, -110.34266006946564, -113.98094443231821, -49.290025129914284], "episode_lengths": [248, 244, 243, 241, 244, 243, 241, 232, 243, 241, 307, 232, 252, 261, 233, 228, 227, 273, 261, 257, 255, 242, 264, 270, 223, 274, 255, 229, 307, 245, 261, 262, 219, 248, 265, 242, 241, 230, 255, 305, 351, 264, 327, 262, 250, 241, 229, 289, 294, 251, 263, 294, 212, 248, 244, 232, 236, 246, 281, 239, 253, 275, 268, 296, 250, 258, 291, 252, 242, 333, 233, 226, 296, 148, 213, 320, 258, 262, 292, 240, 281, 278, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5587924708861839, "mean_inference_ms": 7.3076529608325265, "mean_action_processing_ms": 0.12125890861009192, "mean_env_wait_ms": 4.811357179440032, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 26504.312, "learn_time_ms": 22853.667, "learn_throughput": 175.027, "update_time_ms": 26.897}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 83, "training_iteration": 6, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-30-45", "timestamp": 1655537445, "time_this_iter_s": 26.27936625480652, "time_total_s": 159.08585953712463, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 159.08585953712463, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 27.435135135135138, "ram_util_percent": 63.22162162162163}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 7.358070373535156, "policy_loss": -0.08030504733324051, "vf_loss": 7.413964748382568, "vf_explained_var": 0.32184305787086487, "kl": 0.01627391204237938, "entropy": 1.9588991403579712, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 971.5917282253504, "episode_reward_min": -443.8853020295501, "episode_reward_mean": -77.41453022755606, "episode_len_mean": 260.96907216494844, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.74397340416908, -42.8321273252368, -61.97872921824455, -40.86292444169521, -49.29224453866482, -47.99248404800892, -50.7761444747448, -27.21394331008196, -80.64553665369749, -46.12599638849497, -216.28539165109396, -38.33103724569082, -60.34068300575018, -68.50924603641033, -18.675044238567352, -14.46663298457861, -16.81135879456997, -125.72457878291607, -91.08077459782362, -97.34656513482332, -73.08333387225866, -53.00852867215872, -101.25608486682177, -118.46105070412159, -10.561050727963448, -122.82604984939098, -78.50725572556257, -7.824514515697956, -171.5948626846075, -57.696264922618866, -78.2500963434577, -76.27524197846651, 9.487086974084377, -59.79999990016222, -102.1990974843502, -62.278729289770126, -32.77782670408487, -23.793673038482666, -82.36131177842617, -176.139062397182, -279.34295539557934, -82.4275192245841, -198.89445261657238, -79.25487396121025, -56.63614872843027, -61.263371132314205, -26.870428331196308, -146.0876069366932, -130.36014830321074, -43.33505704253912, -93.03521425276995, -141.65071055293083, 1.857340008020401, -39.18760685622692, -78.77475640177727, -31.370783410966396, -20.460459619760513, -68.47206322103739, -114.16226065158844, -35.88448987901211, -118.20000000298023, -101.92531210929155, -106.75846616923809, -160.47872922569513, -79.35846592485905, -80.32018083333969, -134.50639628618956, -65.11345829069614, -44.67872916907072, -268.23490458726883, -29.63202451914549, -16.519728861749172, -136.11428623646498, 971.5917282253504, -8.577826716005802, -195.75244031101465, -74.18448954075575, -90.08678000420332, -128.71304079145193, -33.41135859489441, -110.34266006946564, -113.98094443231821, -49.290025129914284, -93.49224452674389, -98.31773342937231, -116.95847051590681, -114.21970339119434, -64.6783356666565, -88.96363599598408, -67.46809373050928, -443.8853020295501, -55.113721400499344, -291.9132533669472, -140.7548280134797, -136.29700222611427, -124.44538835436106, -37.2572685778141], "episode_lengths": [248, 244, 243, 241, 244, 243, 241, 232, 243, 241, 307, 232, 252, 261, 233, 228, 227, 273, 261, 257, 255, 242, 264, 270, 223, 274, 255, 229, 307, 245, 261, 262, 219, 248, 265, 242, 241, 230, 255, 305, 351, 264, 327, 262, 250, 241, 229, 289, 294, 251, 263, 294, 212, 248, 244, 232, 236, 246, 281, 239, 253, 275, 268, 296, 250, 258, 291, 252, 242, 333, 233, 226, 296, 148, 213, 320, 258, 262, 292, 240, 281, 278, 244, 255, 265, 278, 280, 253, 265, 254, 443, 252, 356, 288, 287, 288, 245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5594337150738838, "mean_inference_ms": 7.314189508202373, "mean_action_processing_ms": 0.12115279941138399, "mean_env_wait_ms": 4.797277766400015, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 971.5917282253504, "episode_reward_min": -443.8853020295501, "episode_reward_mean": -77.41453022755606, "episode_len_mean": 260.96907216494844, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.74397340416908, -42.8321273252368, -61.97872921824455, -40.86292444169521, -49.29224453866482, -47.99248404800892, -50.7761444747448, -27.21394331008196, -80.64553665369749, -46.12599638849497, -216.28539165109396, -38.33103724569082, -60.34068300575018, -68.50924603641033, -18.675044238567352, -14.46663298457861, -16.81135879456997, -125.72457878291607, -91.08077459782362, -97.34656513482332, -73.08333387225866, -53.00852867215872, -101.25608486682177, -118.46105070412159, -10.561050727963448, -122.82604984939098, -78.50725572556257, -7.824514515697956, -171.5948626846075, -57.696264922618866, -78.2500963434577, -76.27524197846651, 9.487086974084377, -59.79999990016222, -102.1990974843502, -62.278729289770126, -32.77782670408487, -23.793673038482666, -82.36131177842617, -176.139062397182, -279.34295539557934, -82.4275192245841, -198.89445261657238, -79.25487396121025, -56.63614872843027, -61.263371132314205, -26.870428331196308, -146.0876069366932, -130.36014830321074, -43.33505704253912, -93.03521425276995, -141.65071055293083, 1.857340008020401, -39.18760685622692, -78.77475640177727, -31.370783410966396, -20.460459619760513, -68.47206322103739, -114.16226065158844, -35.88448987901211, -118.20000000298023, -101.92531210929155, -106.75846616923809, -160.47872922569513, -79.35846592485905, -80.32018083333969, -134.50639628618956, -65.11345829069614, -44.67872916907072, -268.23490458726883, -29.63202451914549, -16.519728861749172, -136.11428623646498, 971.5917282253504, -8.577826716005802, -195.75244031101465, -74.18448954075575, -90.08678000420332, -128.71304079145193, -33.41135859489441, -110.34266006946564, -113.98094443231821, -49.290025129914284, -93.49224452674389, -98.31773342937231, -116.95847051590681, -114.21970339119434, -64.6783356666565, -88.96363599598408, -67.46809373050928, -443.8853020295501, -55.113721400499344, -291.9132533669472, -140.7548280134797, -136.29700222611427, -124.44538835436106, -37.2572685778141], "episode_lengths": [248, 244, 243, 241, 244, 243, 241, 232, 243, 241, 307, 232, 252, 261, 233, 228, 227, 273, 261, 257, 255, 242, 264, 270, 223, 274, 255, 229, 307, 245, 261, 262, 219, 248, 265, 242, 241, 230, 255, 305, 351, 264, 327, 262, 250, 241, 229, 289, 294, 251, 263, 294, 212, 248, 244, 232, 236, 246, 281, 239, 253, 275, 268, 296, 250, 258, 291, 252, 242, 333, 233, 226, 296, 148, 213, 320, 258, 262, 292, 240, 281, 278, 244, 255, 265, 278, 280, 253, 265, 254, 443, 252, 356, 288, 287, 288, 245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5594337150738838, "mean_inference_ms": 7.314189508202373, "mean_action_processing_ms": 0.12115279941138399, "mean_env_wait_ms": 4.797277766400015, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 26470.75, "learn_time_ms": 22842.117, "learn_throughput": 175.115, "update_time_ms": 27.05}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 97, "training_iteration": 7, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-31-11", "timestamp": 1655537471, "time_this_iter_s": 26.28037691116333, "time_total_s": 185.36623644828796, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 185.36623644828796, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 28.116216216216216, "ram_util_percent": 63.189189189189165}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 6.01544713973999, "policy_loss": -0.09545615315437317, "vf_loss": 6.08422327041626, "vf_explained_var": -0.09816737473011017, "kl": 0.017786314710974693, "entropy": 1.9509598016738892, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 971.5917282253504, "episode_reward_min": -443.8853020295501, "episode_reward_mean": -82.58825252600015, "episode_len_mean": 263.79, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-68.50924603641033, -18.675044238567352, -14.46663298457861, -16.81135879456997, -125.72457878291607, -91.08077459782362, -97.34656513482332, -73.08333387225866, -53.00852867215872, -101.25608486682177, -118.46105070412159, -10.561050727963448, -122.82604984939098, -78.50725572556257, -7.824514515697956, -171.5948626846075, -57.696264922618866, -78.2500963434577, -76.27524197846651, 9.487086974084377, -59.79999990016222, -102.1990974843502, -62.278729289770126, -32.77782670408487, -23.793673038482666, -82.36131177842617, -176.139062397182, -279.34295539557934, -82.4275192245841, -198.89445261657238, -79.25487396121025, -56.63614872843027, -61.263371132314205, -26.870428331196308, -146.0876069366932, -130.36014830321074, -43.33505704253912, -93.03521425276995, -141.65071055293083, 1.857340008020401, -39.18760685622692, -78.77475640177727, -31.370783410966396, -20.460459619760513, -68.47206322103739, -114.16226065158844, -35.88448987901211, -118.20000000298023, -101.92531210929155, -106.75846616923809, -160.47872922569513, -79.35846592485905, -80.32018083333969, -134.50639628618956, -65.11345829069614, -44.67872916907072, -268.23490458726883, -29.63202451914549, -16.519728861749172, -136.11428623646498, 971.5917282253504, -8.577826716005802, -195.75244031101465, -74.18448954075575, -90.08678000420332, -128.71304079145193, -33.41135859489441, -110.34266006946564, -113.98094443231821, -49.290025129914284, -93.49224452674389, -98.31773342937231, -116.95847051590681, -114.21970339119434, -64.6783356666565, -88.96363599598408, -67.46809373050928, -443.8853020295501, -55.113721400499344, -291.9132533669472, -140.7548280134797, -136.29700222611427, -124.44538835436106, -37.2572685778141, -44.506187841296196, -138.6748420894146, -93.98846200853586, -98.17809738218784, -94.98562952876091, -98.99166793376207, -303.94156727939844, -81.06760877370834, -69.42367605865002, -174.96757511794567, -24.799820750951767, -40.74657294154167, -165.45456495136023, -35.19686695933342, -83.25797495245934, -24.855921663343906], "episode_lengths": [261, 233, 228, 227, 273, 261, 257, 255, 242, 264, 270, 223, 274, 255, 229, 307, 245, 261, 262, 219, 248, 265, 242, 241, 230, 255, 305, 351, 264, 327, 262, 250, 241, 229, 289, 294, 251, 263, 294, 212, 248, 244, 232, 236, 246, 281, 239, 253, 275, 268, 296, 250, 258, 291, 252, 242, 333, 233, 226, 296, 148, 213, 320, 258, 262, 292, 240, 281, 278, 244, 255, 265, 278, 280, 253, 265, 254, 443, 252, 356, 288, 287, 288, 245, 240, 286, 265, 260, 272, 262, 355, 258, 260, 310, 244, 241, 277, 241, 261, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.561615029703461, "mean_inference_ms": 7.340488544202831, "mean_action_processing_ms": 0.12143342021353332, "mean_env_wait_ms": 4.776300795748143, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 971.5917282253504, "episode_reward_min": -443.8853020295501, "episode_reward_mean": -82.58825252600015, "episode_len_mean": 263.79, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-68.50924603641033, -18.675044238567352, -14.46663298457861, -16.81135879456997, -125.72457878291607, -91.08077459782362, -97.34656513482332, -73.08333387225866, -53.00852867215872, -101.25608486682177, -118.46105070412159, -10.561050727963448, -122.82604984939098, -78.50725572556257, -7.824514515697956, -171.5948626846075, -57.696264922618866, -78.2500963434577, -76.27524197846651, 9.487086974084377, -59.79999990016222, -102.1990974843502, -62.278729289770126, -32.77782670408487, -23.793673038482666, -82.36131177842617, -176.139062397182, -279.34295539557934, -82.4275192245841, -198.89445261657238, -79.25487396121025, -56.63614872843027, -61.263371132314205, -26.870428331196308, -146.0876069366932, -130.36014830321074, -43.33505704253912, -93.03521425276995, -141.65071055293083, 1.857340008020401, -39.18760685622692, -78.77475640177727, -31.370783410966396, -20.460459619760513, -68.47206322103739, -114.16226065158844, -35.88448987901211, -118.20000000298023, -101.92531210929155, -106.75846616923809, -160.47872922569513, -79.35846592485905, -80.32018083333969, -134.50639628618956, -65.11345829069614, -44.67872916907072, -268.23490458726883, -29.63202451914549, -16.519728861749172, -136.11428623646498, 971.5917282253504, -8.577826716005802, -195.75244031101465, -74.18448954075575, -90.08678000420332, -128.71304079145193, -33.41135859489441, -110.34266006946564, -113.98094443231821, -49.290025129914284, -93.49224452674389, -98.31773342937231, -116.95847051590681, -114.21970339119434, -64.6783356666565, -88.96363599598408, -67.46809373050928, -443.8853020295501, -55.113721400499344, -291.9132533669472, -140.7548280134797, -136.29700222611427, -124.44538835436106, -37.2572685778141, -44.506187841296196, -138.6748420894146, -93.98846200853586, -98.17809738218784, -94.98562952876091, -98.99166793376207, -303.94156727939844, -81.06760877370834, -69.42367605865002, -174.96757511794567, -24.799820750951767, -40.74657294154167, -165.45456495136023, -35.19686695933342, -83.25797495245934, -24.855921663343906], "episode_lengths": [261, 233, 228, 227, 273, 261, 257, 255, 242, 264, 270, 223, 274, 255, 229, 307, 245, 261, 262, 219, 248, 265, 242, 241, 230, 255, 305, 351, 264, 327, 262, 250, 241, 229, 289, 294, 251, 263, 294, 212, 248, 244, 232, 236, 246, 281, 239, 253, 275, 268, 296, 250, 258, 291, 252, 242, 333, 233, 226, 296, 148, 213, 320, 258, 262, 292, 240, 281, 278, 244, 255, 265, 278, 280, 253, 265, 254, 443, 252, 356, 288, 287, 288, 245, 240, 286, 265, 260, 272, 262, 355, 258, 260, 310, 244, 241, 277, 241, 261, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.561615029703461, "mean_inference_ms": 7.340488544202831, "mean_action_processing_ms": 0.12143342021353332, "mean_env_wait_ms": 4.776300795748143, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 26441.057, "learn_time_ms": 22832.337, "learn_throughput": 175.19, "update_time_ms": 26.915}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 113, "training_iteration": 8, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-31-38", "timestamp": 1655537498, "time_this_iter_s": 26.244203567504883, "time_total_s": 211.61044001579285, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 211.61044001579285, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 27.81351351351351, "ram_util_percent": 63.13243243243244}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 6.89769172668457, "policy_loss": -0.108677439391613, "vf_loss": 6.976928234100342, "vf_explained_var": 0.15289567410945892, "kl": 0.019627399742603302, "entropy": 1.9432833194732666, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 971.5917282253504, "episode_reward_min": -443.8853020295501, "episode_reward_mean": -81.02873112522066, "episode_len_mean": 262.88, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.696264922618866, -78.2500963434577, -76.27524197846651, 9.487086974084377, -59.79999990016222, -102.1990974843502, -62.278729289770126, -32.77782670408487, -23.793673038482666, -82.36131177842617, -176.139062397182, -279.34295539557934, -82.4275192245841, -198.89445261657238, -79.25487396121025, -56.63614872843027, -61.263371132314205, -26.870428331196308, -146.0876069366932, -130.36014830321074, -43.33505704253912, -93.03521425276995, -141.65071055293083, 1.857340008020401, -39.18760685622692, -78.77475640177727, -31.370783410966396, -20.460459619760513, -68.47206322103739, -114.16226065158844, -35.88448987901211, -118.20000000298023, -101.92531210929155, -106.75846616923809, -160.47872922569513, -79.35846592485905, -80.32018083333969, -134.50639628618956, -65.11345829069614, -44.67872916907072, -268.23490458726883, -29.63202451914549, -16.519728861749172, -136.11428623646498, 971.5917282253504, -8.577826716005802, -195.75244031101465, -74.18448954075575, -90.08678000420332, -128.71304079145193, -33.41135859489441, -110.34266006946564, -113.98094443231821, -49.290025129914284, -93.49224452674389, -98.31773342937231, -116.95847051590681, -114.21970339119434, -64.6783356666565, -88.96363599598408, -67.46809373050928, -443.8853020295501, -55.113721400499344, -291.9132533669472, -140.7548280134797, -136.29700222611427, -124.44538835436106, -37.2572685778141, -44.506187841296196, -138.6748420894146, -93.98846200853586, -98.17809738218784, -94.98562952876091, -98.99166793376207, -303.94156727939844, -81.06760877370834, -69.42367605865002, -174.96757511794567, -24.799820750951767, -40.74657294154167, -165.45456495136023, -35.19686695933342, -83.25797495245934, -24.855921663343906, -69.45846597850323, -59.79909735172987, -104.60000000149012, -44.0490281060338, -49.559792906045914, -43.02457865327597, -118.28135974705219, -69.92967875301838, -27.461787961423397, -79.24554039537907, -49.005997598171234, -144.38828268647194, -36.35041534155607, -9.435214146971703, -92.7893645092845, -16.40618797391653], "episode_lengths": [245, 261, 262, 219, 248, 265, 242, 241, 230, 255, 305, 351, 264, 327, 262, 250, 241, 229, 289, 294, 251, 263, 294, 212, 248, 244, 232, 236, 246, 281, 239, 253, 275, 268, 296, 250, 258, 291, 252, 242, 333, 233, 226, 296, 148, 213, 320, 258, 262, 292, 240, 281, 278, 244, 255, 265, 278, 280, 253, 265, 254, 443, 252, 356, 288, 287, 288, 245, 240, 286, 265, 260, 272, 262, 355, 258, 260, 310, 244, 241, 277, 241, 261, 244, 252, 254, 262, 244, 243, 236, 282, 247, 237, 257, 241, 270, 234, 217, 259, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5651377464409958, "mean_inference_ms": 7.346223710017048, "mean_action_processing_ms": 0.12116339356826873, "mean_env_wait_ms": 4.743347979825674, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 971.5917282253504, "episode_reward_min": -443.8853020295501, "episode_reward_mean": -81.02873112522066, "episode_len_mean": 262.88, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.696264922618866, -78.2500963434577, -76.27524197846651, 9.487086974084377, -59.79999990016222, -102.1990974843502, -62.278729289770126, -32.77782670408487, -23.793673038482666, -82.36131177842617, -176.139062397182, -279.34295539557934, -82.4275192245841, -198.89445261657238, -79.25487396121025, -56.63614872843027, -61.263371132314205, -26.870428331196308, -146.0876069366932, -130.36014830321074, -43.33505704253912, -93.03521425276995, -141.65071055293083, 1.857340008020401, -39.18760685622692, -78.77475640177727, -31.370783410966396, -20.460459619760513, -68.47206322103739, -114.16226065158844, -35.88448987901211, -118.20000000298023, -101.92531210929155, -106.75846616923809, -160.47872922569513, -79.35846592485905, -80.32018083333969, -134.50639628618956, -65.11345829069614, -44.67872916907072, -268.23490458726883, -29.63202451914549, -16.519728861749172, -136.11428623646498, 971.5917282253504, -8.577826716005802, -195.75244031101465, -74.18448954075575, -90.08678000420332, -128.71304079145193, -33.41135859489441, -110.34266006946564, -113.98094443231821, -49.290025129914284, -93.49224452674389, -98.31773342937231, -116.95847051590681, -114.21970339119434, -64.6783356666565, -88.96363599598408, -67.46809373050928, -443.8853020295501, -55.113721400499344, -291.9132533669472, -140.7548280134797, -136.29700222611427, -124.44538835436106, -37.2572685778141, -44.506187841296196, -138.6748420894146, -93.98846200853586, -98.17809738218784, -94.98562952876091, -98.99166793376207, -303.94156727939844, -81.06760877370834, -69.42367605865002, -174.96757511794567, -24.799820750951767, -40.74657294154167, -165.45456495136023, -35.19686695933342, -83.25797495245934, -24.855921663343906, -69.45846597850323, -59.79909735172987, -104.60000000149012, -44.0490281060338, -49.559792906045914, -43.02457865327597, -118.28135974705219, -69.92967875301838, -27.461787961423397, -79.24554039537907, -49.005997598171234, -144.38828268647194, -36.35041534155607, -9.435214146971703, -92.7893645092845, -16.40618797391653], "episode_lengths": [245, 261, 262, 219, 248, 265, 242, 241, 230, 255, 305, 351, 264, 327, 262, 250, 241, 229, 289, 294, 251, 263, 294, 212, 248, 244, 232, 236, 246, 281, 239, 253, 275, 268, 296, 250, 258, 291, 252, 242, 333, 233, 226, 296, 148, 213, 320, 258, 262, 292, 240, 281, 278, 244, 255, 265, 278, 280, 253, 265, 254, 443, 252, 356, 288, 287, 288, 245, 240, 286, 265, 260, 272, 262, 355, 258, 260, 310, 244, 241, 277, 241, 261, 244, 252, 254, 262, 244, 243, 236, 282, 247, 237, 257, 241, 270, 234, 217, 259, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5651377464409958, "mean_inference_ms": 7.346223710017048, "mean_action_processing_ms": 0.12116339356826873, "mean_env_wait_ms": 4.743347979825674, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 26438.504, "learn_time_ms": 22824.167, "learn_throughput": 175.253, "update_time_ms": 27.035}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 129, "training_iteration": 9, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-32-04", "timestamp": 1655537524, "time_this_iter_s": 26.429075479507446, "time_total_s": 238.0395154953003, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 238.0395154953003, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 28.654054054054054, "ram_util_percent": 62.99189189189189}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 6.2623114585876465, "policy_loss": -0.10992339253425598, "vf_loss": 6.342804431915283, "vf_explained_var": 0.29097113013267517, "kl": 0.019620047882199287, "entropy": 1.9405896663665771, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 971.5917282253504, "episode_reward_min": -443.8853020295501, "episode_reward_mean": -78.03448802091181, "episode_len_mean": 261.78, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.870428331196308, -146.0876069366932, -130.36014830321074, -43.33505704253912, -93.03521425276995, -141.65071055293083, 1.857340008020401, -39.18760685622692, -78.77475640177727, -31.370783410966396, -20.460459619760513, -68.47206322103739, -114.16226065158844, -35.88448987901211, -118.20000000298023, -101.92531210929155, -106.75846616923809, -160.47872922569513, -79.35846592485905, -80.32018083333969, -134.50639628618956, -65.11345829069614, -44.67872916907072, -268.23490458726883, -29.63202451914549, -16.519728861749172, -136.11428623646498, 971.5917282253504, -8.577826716005802, -195.75244031101465, -74.18448954075575, -90.08678000420332, -128.71304079145193, -33.41135859489441, -110.34266006946564, -113.98094443231821, -49.290025129914284, -93.49224452674389, -98.31773342937231, -116.95847051590681, -114.21970339119434, -64.6783356666565, -88.96363599598408, -67.46809373050928, -443.8853020295501, -55.113721400499344, -291.9132533669472, -140.7548280134797, -136.29700222611427, -124.44538835436106, -37.2572685778141, -44.506187841296196, -138.6748420894146, -93.98846200853586, -98.17809738218784, -94.98562952876091, -98.99166793376207, -303.94156727939844, -81.06760877370834, -69.42367605865002, -174.96757511794567, -24.799820750951767, -40.74657294154167, -165.45456495136023, -35.19686695933342, -83.25797495245934, -24.855921663343906, -69.45846597850323, -59.79909735172987, -104.60000000149012, -44.0490281060338, -49.559792906045914, -43.02457865327597, -118.28135974705219, -69.92967875301838, -27.461787961423397, -79.24554039537907, -49.005997598171234, -144.38828268647194, -36.35041534155607, -9.435214146971703, -92.7893645092845, -16.40618797391653, -153.7999999821186, -22.14215748757124, -71.39963007718325, -43.70193450897932, -92.43431157618761, -50.6139432489872, -56.031307838857174, -82.25363389402628, -0.5700717717409134, -62.6000000461936, -24.658466048538685, -49.81394337117672, -80.88846188783646, -43.10221494734287, -116.34970287233591, -203.18539182841778, -46.93405610322952], "episode_lengths": [229, 289, 294, 251, 263, 294, 212, 248, 244, 232, 236, 246, 281, 239, 253, 275, 268, 296, 250, 258, 291, 252, 242, 333, 233, 226, 296, 148, 213, 320, 258, 262, 292, 240, 281, 278, 244, 255, 265, 278, 280, 253, 265, 254, 443, 252, 356, 288, 287, 288, 245, 240, 286, 265, 260, 272, 262, 355, 258, 260, 310, 244, 241, 277, 241, 261, 244, 252, 254, 262, 244, 243, 236, 282, 247, 237, 257, 241, 270, 234, 217, 259, 233, 287, 225, 274, 245, 256, 244, 258, 271, 233, 249, 235, 243, 256, 237, 282, 317, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5681005283583995, "mean_inference_ms": 7.350745408426228, "mean_action_processing_ms": 0.12134948918570622, "mean_env_wait_ms": 4.72909633914994, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 971.5917282253504, "episode_reward_min": -443.8853020295501, "episode_reward_mean": -78.03448802091181, "episode_len_mean": 261.78, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.870428331196308, -146.0876069366932, -130.36014830321074, -43.33505704253912, -93.03521425276995, -141.65071055293083, 1.857340008020401, -39.18760685622692, -78.77475640177727, -31.370783410966396, -20.460459619760513, -68.47206322103739, -114.16226065158844, -35.88448987901211, -118.20000000298023, -101.92531210929155, -106.75846616923809, -160.47872922569513, -79.35846592485905, -80.32018083333969, -134.50639628618956, -65.11345829069614, -44.67872916907072, -268.23490458726883, -29.63202451914549, -16.519728861749172, -136.11428623646498, 971.5917282253504, -8.577826716005802, -195.75244031101465, -74.18448954075575, -90.08678000420332, -128.71304079145193, -33.41135859489441, -110.34266006946564, -113.98094443231821, -49.290025129914284, -93.49224452674389, -98.31773342937231, -116.95847051590681, -114.21970339119434, -64.6783356666565, -88.96363599598408, -67.46809373050928, -443.8853020295501, -55.113721400499344, -291.9132533669472, -140.7548280134797, -136.29700222611427, -124.44538835436106, -37.2572685778141, -44.506187841296196, -138.6748420894146, -93.98846200853586, -98.17809738218784, -94.98562952876091, -98.99166793376207, -303.94156727939844, -81.06760877370834, -69.42367605865002, -174.96757511794567, -24.799820750951767, -40.74657294154167, -165.45456495136023, -35.19686695933342, -83.25797495245934, -24.855921663343906, -69.45846597850323, -59.79909735172987, -104.60000000149012, -44.0490281060338, -49.559792906045914, -43.02457865327597, -118.28135974705219, -69.92967875301838, -27.461787961423397, -79.24554039537907, -49.005997598171234, -144.38828268647194, -36.35041534155607, -9.435214146971703, -92.7893645092845, -16.40618797391653, -153.7999999821186, -22.14215748757124, -71.39963007718325, -43.70193450897932, -92.43431157618761, -50.6139432489872, -56.031307838857174, -82.25363389402628, -0.5700717717409134, -62.6000000461936, -24.658466048538685, -49.81394337117672, -80.88846188783646, -43.10221494734287, -116.34970287233591, -203.18539182841778, -46.93405610322952], "episode_lengths": [229, 289, 294, 251, 263, 294, 212, 248, 244, 232, 236, 246, 281, 239, 253, 275, 268, 296, 250, 258, 291, 252, 242, 333, 233, 226, 296, 148, 213, 320, 258, 262, 292, 240, 281, 278, 244, 255, 265, 278, 280, 253, 265, 254, 443, 252, 356, 288, 287, 288, 245, 240, 286, 265, 260, 272, 262, 355, 258, 260, 310, 244, 241, 277, 241, 261, 244, 252, 254, 262, 244, 243, 236, 282, 247, 237, 257, 241, 270, 234, 217, 259, 233, 287, 225, 274, 245, 256, 244, 258, 271, 233, 249, 235, 243, 256, 237, 282, 317, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5681005283583995, "mean_inference_ms": 7.350745408426228, "mean_action_processing_ms": 0.12134948918570622, "mean_env_wait_ms": 4.72909633914994, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 26430.057, "learn_time_ms": 22817.911, "learn_throughput": 175.301, "update_time_ms": 26.928}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 146, "training_iteration": 10, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-32-31", "timestamp": 1655537551, "time_this_iter_s": 26.364028215408325, "time_total_s": 264.4035437107086, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 264.4035437107086, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 29.07368421052632, "ram_util_percent": 63.081578947368406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 7.362180709838867, "policy_loss": -0.10990080237388611, "vf_loss": 7.442878246307373, "vf_explained_var": 0.06357906013727188, "kl": 0.01946910284459591, "entropy": 1.9362624883651733, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 971.5917282253504, "episode_reward_min": -443.8853020295501, "episode_reward_mean": -76.49060332134366, "episode_len_mean": 261.13, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.75846616923809, -160.47872922569513, -79.35846592485905, -80.32018083333969, -134.50639628618956, -65.11345829069614, -44.67872916907072, -268.23490458726883, -29.63202451914549, -16.519728861749172, -136.11428623646498, 971.5917282253504, -8.577826716005802, -195.75244031101465, -74.18448954075575, -90.08678000420332, -128.71304079145193, -33.41135859489441, -110.34266006946564, -113.98094443231821, -49.290025129914284, -93.49224452674389, -98.31773342937231, -116.95847051590681, -114.21970339119434, -64.6783356666565, -88.96363599598408, -67.46809373050928, -443.8853020295501, -55.113721400499344, -291.9132533669472, -140.7548280134797, -136.29700222611427, -124.44538835436106, -37.2572685778141, -44.506187841296196, -138.6748420894146, -93.98846200853586, -98.17809738218784, -94.98562952876091, -98.99166793376207, -303.94156727939844, -81.06760877370834, -69.42367605865002, -174.96757511794567, -24.799820750951767, -40.74657294154167, -165.45456495136023, -35.19686695933342, -83.25797495245934, -24.855921663343906, -69.45846597850323, -59.79909735172987, -104.60000000149012, -44.0490281060338, -49.559792906045914, -43.02457865327597, -118.28135974705219, -69.92967875301838, -27.461787961423397, -79.24554039537907, -49.005997598171234, -144.38828268647194, -36.35041534155607, -9.435214146971703, -92.7893645092845, -16.40618797391653, -153.7999999821186, -22.14215748757124, -71.39963007718325, -43.70193450897932, -92.43431157618761, -50.6139432489872, -56.031307838857174, -82.25363389402628, -0.5700717717409134, -62.6000000461936, -24.658466048538685, -49.81394337117672, -80.88846188783646, -43.10221494734287, -116.34970287233591, -203.18539182841778, -46.93405610322952, -1.260148175060749, -123.8884621411562, -107.06019562482834, -54.38936460018158, -89.05041531473398, -8.268093883991241, -76.3980952501297, -19.58160937577486, -18.01135866343975, -166.77377209067345, -132.9229950606823, -3.4953622817993164, -54.30853012949228, -79.89129002392292, -18.242030531167984, -79.98936446011066], "episode_lengths": [268, 296, 250, 258, 291, 252, 242, 333, 233, 226, 296, 148, 213, 320, 258, 262, 292, 240, 281, 278, 244, 255, 265, 278, 280, 253, 265, 254, 443, 252, 356, 288, 287, 288, 245, 240, 286, 265, 260, 272, 262, 355, 258, 260, 310, 244, 241, 277, 241, 261, 244, 252, 254, 262, 244, 243, 236, 282, 247, 237, 257, 241, 270, 234, 217, 259, 233, 287, 225, 274, 245, 256, 244, 258, 271, 233, 249, 235, 243, 256, 237, 282, 317, 246, 216, 279, 277, 239, 267, 220, 268, 233, 225, 299, 279, 223, 247, 248, 248, 253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5684428582009354, "mean_inference_ms": 7.345866348609612, "mean_action_processing_ms": 0.12124353636142841, "mean_env_wait_ms": 4.715710147330121, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 971.5917282253504, "episode_reward_min": -443.8853020295501, "episode_reward_mean": -76.49060332134366, "episode_len_mean": 261.13, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.75846616923809, -160.47872922569513, -79.35846592485905, -80.32018083333969, -134.50639628618956, -65.11345829069614, -44.67872916907072, -268.23490458726883, -29.63202451914549, -16.519728861749172, -136.11428623646498, 971.5917282253504, -8.577826716005802, -195.75244031101465, -74.18448954075575, -90.08678000420332, -128.71304079145193, -33.41135859489441, -110.34266006946564, -113.98094443231821, -49.290025129914284, -93.49224452674389, -98.31773342937231, -116.95847051590681, -114.21970339119434, -64.6783356666565, -88.96363599598408, -67.46809373050928, -443.8853020295501, -55.113721400499344, -291.9132533669472, -140.7548280134797, -136.29700222611427, -124.44538835436106, -37.2572685778141, -44.506187841296196, -138.6748420894146, -93.98846200853586, -98.17809738218784, -94.98562952876091, -98.99166793376207, -303.94156727939844, -81.06760877370834, -69.42367605865002, -174.96757511794567, -24.799820750951767, -40.74657294154167, -165.45456495136023, -35.19686695933342, -83.25797495245934, -24.855921663343906, -69.45846597850323, -59.79909735172987, -104.60000000149012, -44.0490281060338, -49.559792906045914, -43.02457865327597, -118.28135974705219, -69.92967875301838, -27.461787961423397, -79.24554039537907, -49.005997598171234, -144.38828268647194, -36.35041534155607, -9.435214146971703, -92.7893645092845, -16.40618797391653, -153.7999999821186, -22.14215748757124, -71.39963007718325, -43.70193450897932, -92.43431157618761, -50.6139432489872, -56.031307838857174, -82.25363389402628, -0.5700717717409134, -62.6000000461936, -24.658466048538685, -49.81394337117672, -80.88846188783646, -43.10221494734287, -116.34970287233591, -203.18539182841778, -46.93405610322952, -1.260148175060749, -123.8884621411562, -107.06019562482834, -54.38936460018158, -89.05041531473398, -8.268093883991241, -76.3980952501297, -19.58160937577486, -18.01135866343975, -166.77377209067345, -132.9229950606823, -3.4953622817993164, -54.30853012949228, -79.89129002392292, -18.242030531167984, -79.98936446011066], "episode_lengths": [268, 296, 250, 258, 291, 252, 242, 333, 233, 226, 296, 148, 213, 320, 258, 262, 292, 240, 281, 278, 244, 255, 265, 278, 280, 253, 265, 254, 443, 252, 356, 288, 287, 288, 245, 240, 286, 265, 260, 272, 262, 355, 258, 260, 310, 244, 241, 277, 241, 261, 244, 252, 254, 262, 244, 243, 236, 282, 247, 237, 257, 241, 270, 234, 217, 259, 233, 287, 225, 274, 245, 256, 244, 258, 271, 233, 249, 235, 243, 256, 237, 282, 317, 246, 216, 279, 277, 239, 267, 220, 268, 233, 225, 299, 279, 223, 247, 248, 248, 253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5684428582009354, "mean_inference_ms": 7.345866348609612, "mean_action_processing_ms": 0.12124353636142841, "mean_env_wait_ms": 4.715710147330121, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 26389.362, "learn_time_ms": 22837.314, "learn_throughput": 175.152, "update_time_ms": 27.179}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 162, "training_iteration": 11, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-32-57", "timestamp": 1655537577, "time_this_iter_s": 26.217978715896606, "time_total_s": 290.6215224266052, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 290.6215224266052, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 27.624324324324327, "ram_util_percent": 63.13783783783781}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5, "cur_lr": 0.0007999999797903001, "total_loss": 6.701806545257568, "policy_loss": -0.12079747766256332, "vf_loss": 6.791872024536133, "vf_explained_var": 0.20037584006786346, "kl": 0.020487992092967033, "entropy": 1.9168505668640137, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -0.5700717717409134, "episode_reward_min": -443.8853020295501, "episode_reward_mean": -84.40960907183587, "episode_len_mean": 261.16, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-128.71304079145193, -33.41135859489441, -110.34266006946564, -113.98094443231821, -49.290025129914284, -93.49224452674389, -98.31773342937231, -116.95847051590681, -114.21970339119434, -64.6783356666565, -88.96363599598408, -67.46809373050928, -443.8853020295501, -55.113721400499344, -291.9132533669472, -140.7548280134797, -136.29700222611427, -124.44538835436106, -37.2572685778141, -44.506187841296196, -138.6748420894146, -93.98846200853586, -98.17809738218784, -94.98562952876091, -98.99166793376207, -303.94156727939844, -81.06760877370834, -69.42367605865002, -174.96757511794567, -24.799820750951767, -40.74657294154167, -165.45456495136023, -35.19686695933342, -83.25797495245934, -24.855921663343906, -69.45846597850323, -59.79909735172987, -104.60000000149012, -44.0490281060338, -49.559792906045914, -43.02457865327597, -118.28135974705219, -69.92967875301838, -27.461787961423397, -79.24554039537907, -49.005997598171234, -144.38828268647194, -36.35041534155607, -9.435214146971703, -92.7893645092845, -16.40618797391653, -153.7999999821186, -22.14215748757124, -71.39963007718325, -43.70193450897932, -92.43431157618761, -50.6139432489872, -56.031307838857174, -82.25363389402628, -0.5700717717409134, -62.6000000461936, -24.658466048538685, -49.81394337117672, -80.88846188783646, -43.10221494734287, -116.34970287233591, -203.18539182841778, -46.93405610322952, -1.260148175060749, -123.8884621411562, -107.06019562482834, -54.38936460018158, -89.05041531473398, -8.268093883991241, -76.3980952501297, -19.58160937577486, -18.01135866343975, -166.77377209067345, -132.9229950606823, -3.4953622817993164, -54.30853012949228, -79.89129002392292, -18.242030531167984, -79.98936446011066, -127.82367618381977, -151.0000000372529, -99.99224470555782, -34.42943976074457, -229.10188154876232, -36.397992357611656, -86.40690023452044, -44.053214617073536, -32.18294421583414, -31.486779995262623, -25.72498159855604, -74.05107965320349, -56.48677372932434, -81.31394343078136, -66.3168233782053, -133.8570780530572], "episode_lengths": [292, 240, 281, 278, 244, 255, 265, 278, 280, 253, 265, 254, 443, 252, 356, 288, 287, 288, 245, 240, 286, 265, 260, 272, 262, 355, 258, 260, 310, 244, 241, 277, 241, 261, 244, 252, 254, 262, 244, 243, 236, 282, 247, 237, 257, 241, 270, 234, 217, 259, 233, 287, 225, 274, 245, 256, 244, 258, 271, 233, 249, 235, 243, 256, 237, 282, 317, 246, 216, 279, 277, 239, 267, 220, 268, 233, 225, 299, 279, 223, 247, 248, 248, 253, 288, 283, 255, 239, 335, 238, 267, 253, 238, 229, 237, 242, 254, 254, 252, 285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5721096310283167, "mean_inference_ms": 7.350302855397163, "mean_action_processing_ms": 0.12106120416673866, "mean_env_wait_ms": 4.714945730248064, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -0.5700717717409134, "episode_reward_min": -443.8853020295501, "episode_reward_mean": -84.40960907183587, "episode_len_mean": 261.16, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-128.71304079145193, -33.41135859489441, -110.34266006946564, -113.98094443231821, -49.290025129914284, -93.49224452674389, -98.31773342937231, -116.95847051590681, -114.21970339119434, -64.6783356666565, -88.96363599598408, -67.46809373050928, -443.8853020295501, -55.113721400499344, -291.9132533669472, -140.7548280134797, -136.29700222611427, -124.44538835436106, -37.2572685778141, -44.506187841296196, -138.6748420894146, -93.98846200853586, -98.17809738218784, -94.98562952876091, -98.99166793376207, -303.94156727939844, -81.06760877370834, -69.42367605865002, -174.96757511794567, -24.799820750951767, -40.74657294154167, -165.45456495136023, -35.19686695933342, -83.25797495245934, -24.855921663343906, -69.45846597850323, -59.79909735172987, -104.60000000149012, -44.0490281060338, -49.559792906045914, -43.02457865327597, -118.28135974705219, -69.92967875301838, -27.461787961423397, -79.24554039537907, -49.005997598171234, -144.38828268647194, -36.35041534155607, -9.435214146971703, -92.7893645092845, -16.40618797391653, -153.7999999821186, -22.14215748757124, -71.39963007718325, -43.70193450897932, -92.43431157618761, -50.6139432489872, -56.031307838857174, -82.25363389402628, -0.5700717717409134, -62.6000000461936, -24.658466048538685, -49.81394337117672, -80.88846188783646, -43.10221494734287, -116.34970287233591, -203.18539182841778, -46.93405610322952, -1.260148175060749, -123.8884621411562, -107.06019562482834, -54.38936460018158, -89.05041531473398, -8.268093883991241, -76.3980952501297, -19.58160937577486, -18.01135866343975, -166.77377209067345, -132.9229950606823, -3.4953622817993164, -54.30853012949228, -79.89129002392292, -18.242030531167984, -79.98936446011066, -127.82367618381977, -151.0000000372529, -99.99224470555782, -34.42943976074457, -229.10188154876232, -36.397992357611656, -86.40690023452044, -44.053214617073536, -32.18294421583414, -31.486779995262623, -25.72498159855604, -74.05107965320349, -56.48677372932434, -81.31394343078136, -66.3168233782053, -133.8570780530572], "episode_lengths": [292, 240, 281, 278, 244, 255, 265, 278, 280, 253, 265, 254, 443, 252, 356, 288, 287, 288, 245, 240, 286, 265, 260, 272, 262, 355, 258, 260, 310, 244, 241, 277, 241, 261, 244, 252, 254, 262, 244, 243, 236, 282, 247, 237, 257, 241, 270, 234, 217, 259, 233, 287, 225, 274, 245, 256, 244, 258, 271, 233, 249, 235, 243, 256, 237, 282, 317, 246, 216, 279, 277, 239, 267, 220, 268, 233, 225, 299, 279, 223, 247, 248, 248, 253, 288, 283, 255, 239, 335, 238, 267, 253, 238, 229, 237, 242, 254, 254, 252, 285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5721096310283167, "mean_inference_ms": 7.350302855397163, "mean_action_processing_ms": 0.12106120416673866, "mean_env_wait_ms": 4.714945730248064, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 26324.041, "learn_time_ms": 22790.085, "learn_throughput": 175.515, "update_time_ms": 27.08}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 178, "training_iteration": 12, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-33-23", "timestamp": 1655537603, "time_this_iter_s": 26.191989421844482, "time_total_s": 316.8135118484497, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 316.8135118484497, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 27.26388888888889, "ram_util_percent": 63.22500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.8214569091796875, "policy_loss": -0.12006673216819763, "vf_loss": 6.90351676940918, "vf_explained_var": 0.04856636002659798, "kl": 0.016891926527023315, "entropy": 1.903795838356018, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -0.5700717717409134, "episode_reward_min": -303.94156727939844, "episode_reward_mean": -82.2344404436648, "episode_len_mean": 259.19, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-140.7548280134797, -136.29700222611427, -124.44538835436106, -37.2572685778141, -44.506187841296196, -138.6748420894146, -93.98846200853586, -98.17809738218784, -94.98562952876091, -98.99166793376207, -303.94156727939844, -81.06760877370834, -69.42367605865002, -174.96757511794567, -24.799820750951767, -40.74657294154167, -165.45456495136023, -35.19686695933342, -83.25797495245934, -24.855921663343906, -69.45846597850323, -59.79909735172987, -104.60000000149012, -44.0490281060338, -49.559792906045914, -43.02457865327597, -118.28135974705219, -69.92967875301838, -27.461787961423397, -79.24554039537907, -49.005997598171234, -144.38828268647194, -36.35041534155607, -9.435214146971703, -92.7893645092845, -16.40618797391653, -153.7999999821186, -22.14215748757124, -71.39963007718325, -43.70193450897932, -92.43431157618761, -50.6139432489872, -56.031307838857174, -82.25363389402628, -0.5700717717409134, -62.6000000461936, -24.658466048538685, -49.81394337117672, -80.88846188783646, -43.10221494734287, -116.34970287233591, -203.18539182841778, -46.93405610322952, -1.260148175060749, -123.8884621411562, -107.06019562482834, -54.38936460018158, -89.05041531473398, -8.268093883991241, -76.3980952501297, -19.58160937577486, -18.01135866343975, -166.77377209067345, -132.9229950606823, -3.4953622817993164, -54.30853012949228, -79.89129002392292, -18.242030531167984, -79.98936446011066, -127.82367618381977, -151.0000000372529, -99.99224470555782, -34.42943976074457, -229.10188154876232, -36.397992357611656, -86.40690023452044, -44.053214617073536, -32.18294421583414, -31.486779995262623, -25.72498159855604, -74.05107965320349, -56.48677372932434, -81.31394343078136, -66.3168233782053, -133.8570780530572, -167.36273351311684, -236.67993718385696, -113.43521419912577, -106.19999998062849, -121.27475634217262, -134.16855704784393, -170.209067851305, -130.0716859549284, -10.927458725869656, -50.014944203197956, -64.0853375941515, -36.08936442434788, -79.63521414995193, -113.78802455216646, -119.28936453163624], "episode_lengths": [288, 287, 288, 245, 240, 286, 265, 260, 272, 262, 355, 258, 260, 310, 244, 241, 277, 241, 261, 244, 252, 254, 262, 244, 243, 236, 282, 247, 237, 257, 241, 270, 234, 217, 259, 233, 287, 225, 274, 245, 256, 244, 258, 271, 233, 249, 235, 243, 256, 237, 282, 317, 246, 216, 279, 277, 239, 267, 220, 268, 233, 225, 299, 279, 223, 247, 248, 248, 253, 288, 283, 255, 239, 335, 238, 267, 253, 238, 229, 237, 242, 254, 254, 252, 285, 296, 350, 272, 264, 276, 287, 288, 275, 227, 238, 240, 236, 223, 286, 281]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5751179025041991, "mean_inference_ms": 7.352756978579258, "mean_action_processing_ms": 0.12077142874517845, "mean_env_wait_ms": 4.706335881759498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -0.5700717717409134, "episode_reward_min": -303.94156727939844, "episode_reward_mean": -82.2344404436648, "episode_len_mean": 259.19, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-140.7548280134797, -136.29700222611427, -124.44538835436106, -37.2572685778141, -44.506187841296196, -138.6748420894146, -93.98846200853586, -98.17809738218784, -94.98562952876091, -98.99166793376207, -303.94156727939844, -81.06760877370834, -69.42367605865002, -174.96757511794567, -24.799820750951767, -40.74657294154167, -165.45456495136023, -35.19686695933342, -83.25797495245934, -24.855921663343906, -69.45846597850323, -59.79909735172987, -104.60000000149012, -44.0490281060338, -49.559792906045914, -43.02457865327597, -118.28135974705219, -69.92967875301838, -27.461787961423397, -79.24554039537907, -49.005997598171234, -144.38828268647194, -36.35041534155607, -9.435214146971703, -92.7893645092845, -16.40618797391653, -153.7999999821186, -22.14215748757124, -71.39963007718325, -43.70193450897932, -92.43431157618761, -50.6139432489872, -56.031307838857174, -82.25363389402628, -0.5700717717409134, -62.6000000461936, -24.658466048538685, -49.81394337117672, -80.88846188783646, -43.10221494734287, -116.34970287233591, -203.18539182841778, -46.93405610322952, -1.260148175060749, -123.8884621411562, -107.06019562482834, -54.38936460018158, -89.05041531473398, -8.268093883991241, -76.3980952501297, -19.58160937577486, -18.01135866343975, -166.77377209067345, -132.9229950606823, -3.4953622817993164, -54.30853012949228, -79.89129002392292, -18.242030531167984, -79.98936446011066, -127.82367618381977, -151.0000000372529, -99.99224470555782, -34.42943976074457, -229.10188154876232, -36.397992357611656, -86.40690023452044, -44.053214617073536, -32.18294421583414, -31.486779995262623, -25.72498159855604, -74.05107965320349, -56.48677372932434, -81.31394343078136, -66.3168233782053, -133.8570780530572, -167.36273351311684, -236.67993718385696, -113.43521419912577, -106.19999998062849, -121.27475634217262, -134.16855704784393, -170.209067851305, -130.0716859549284, -10.927458725869656, -50.014944203197956, -64.0853375941515, -36.08936442434788, -79.63521414995193, -113.78802455216646, -119.28936453163624], "episode_lengths": [288, 287, 288, 245, 240, 286, 265, 260, 272, 262, 355, 258, 260, 310, 244, 241, 277, 241, 261, 244, 252, 254, 262, 244, 243, 236, 282, 247, 237, 257, 241, 270, 234, 217, 259, 233, 287, 225, 274, 245, 256, 244, 258, 271, 233, 249, 235, 243, 256, 237, 282, 317, 246, 216, 279, 277, 239, 267, 220, 268, 233, 225, 299, 279, 223, 247, 248, 248, 253, 288, 283, 255, 239, 335, 238, 267, 253, 238, 229, 237, 242, 254, 254, 252, 285, 296, 350, 272, 264, 276, 287, 288, 275, 227, 238, 240, 236, 223, 286, 281]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5751179025041991, "mean_inference_ms": 7.352756978579258, "mean_action_processing_ms": 0.12077142874517845, "mean_env_wait_ms": 4.706335881759498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 26323.219, "learn_time_ms": 22780.067, "learn_throughput": 175.592, "update_time_ms": 26.98}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 193, "training_iteration": 13, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-33-50", "timestamp": 1655537630, "time_this_iter_s": 26.33356523513794, "time_total_s": 343.14707708358765, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 343.14707708358765, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 27.04594594594595, "ram_util_percent": 63.25945945945947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.399141311645508, "policy_loss": -0.11983312666416168, "vf_loss": 6.480829238891602, "vf_explained_var": 0.08822929114103317, "kl": 0.016953740268945694, "entropy": 1.8797950744628906, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 4.440108671784401, "episode_reward_min": -236.67993718385696, "episode_reward_mean": -73.51983871437609, "episode_len_mean": 254.74, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.74657294154167, -165.45456495136023, -35.19686695933342, -83.25797495245934, -24.855921663343906, -69.45846597850323, -59.79909735172987, -104.60000000149012, -44.0490281060338, -49.559792906045914, -43.02457865327597, -118.28135974705219, -69.92967875301838, -27.461787961423397, -79.24554039537907, -49.005997598171234, -144.38828268647194, -36.35041534155607, -9.435214146971703, -92.7893645092845, -16.40618797391653, -153.7999999821186, -22.14215748757124, -71.39963007718325, -43.70193450897932, -92.43431157618761, -50.6139432489872, -56.031307838857174, -82.25363389402628, -0.5700717717409134, -62.6000000461936, -24.658466048538685, -49.81394337117672, -80.88846188783646, -43.10221494734287, -116.34970287233591, -203.18539182841778, -46.93405610322952, -1.260148175060749, -123.8884621411562, -107.06019562482834, -54.38936460018158, -89.05041531473398, -8.268093883991241, -76.3980952501297, -19.58160937577486, -18.01135866343975, -166.77377209067345, -132.9229950606823, -3.4953622817993164, -54.30853012949228, -79.89129002392292, -18.242030531167984, -79.98936446011066, -127.82367618381977, -151.0000000372529, -99.99224470555782, -34.42943976074457, -229.10188154876232, -36.397992357611656, -86.40690023452044, -44.053214617073536, -32.18294421583414, -31.486779995262623, -25.72498159855604, -74.05107965320349, -56.48677372932434, -81.31394343078136, -66.3168233782053, -133.8570780530572, -167.36273351311684, -236.67993718385696, -113.43521419912577, -106.19999998062849, -121.27475634217262, -134.16855704784393, -170.209067851305, -130.0716859549284, -10.927458725869656, -50.014944203197956, -64.0853375941515, -36.08936442434788, -79.63521414995193, -113.78802455216646, -119.28936453163624, -107.36105085164309, -48.462737798690796, -97.36593739688396, 4.440108671784401, -29.997960150241852, -51.644847489893436, -56.999355621635914, -98.48256053030491, -55.39574145525694, -106.73987541347742, -39.58422743529081, 2.465688534080982, 0.4392441511154175, -46.824981696903706, -59.305214524269104], "episode_lengths": [241, 277, 241, 261, 244, 252, 254, 262, 244, 243, 236, 282, 247, 237, 257, 241, 270, 234, 217, 259, 233, 287, 225, 274, 245, 256, 244, 258, 271, 233, 249, 235, 243, 256, 237, 282, 317, 246, 216, 279, 277, 239, 267, 220, 268, 233, 225, 299, 279, 223, 247, 248, 248, 253, 288, 283, 255, 239, 335, 238, 267, 253, 238, 229, 237, 242, 254, 254, 252, 285, 296, 350, 272, 264, 276, 287, 288, 275, 227, 238, 240, 236, 223, 286, 281, 275, 247, 249, 230, 236, 251, 257, 270, 253, 266, 237, 215, 204, 237, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5775910220591082, "mean_inference_ms": 7.353700557937776, "mean_action_processing_ms": 0.12079724690205121, "mean_env_wait_ms": 4.70807428074611, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 4.440108671784401, "episode_reward_min": -236.67993718385696, "episode_reward_mean": -73.51983871437609, "episode_len_mean": 254.74, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.74657294154167, -165.45456495136023, -35.19686695933342, -83.25797495245934, -24.855921663343906, -69.45846597850323, -59.79909735172987, -104.60000000149012, -44.0490281060338, -49.559792906045914, -43.02457865327597, -118.28135974705219, -69.92967875301838, -27.461787961423397, -79.24554039537907, -49.005997598171234, -144.38828268647194, -36.35041534155607, -9.435214146971703, -92.7893645092845, -16.40618797391653, -153.7999999821186, -22.14215748757124, -71.39963007718325, -43.70193450897932, -92.43431157618761, -50.6139432489872, -56.031307838857174, -82.25363389402628, -0.5700717717409134, -62.6000000461936, -24.658466048538685, -49.81394337117672, -80.88846188783646, -43.10221494734287, -116.34970287233591, -203.18539182841778, -46.93405610322952, -1.260148175060749, -123.8884621411562, -107.06019562482834, -54.38936460018158, -89.05041531473398, -8.268093883991241, -76.3980952501297, -19.58160937577486, -18.01135866343975, -166.77377209067345, -132.9229950606823, -3.4953622817993164, -54.30853012949228, -79.89129002392292, -18.242030531167984, -79.98936446011066, -127.82367618381977, -151.0000000372529, -99.99224470555782, -34.42943976074457, -229.10188154876232, -36.397992357611656, -86.40690023452044, -44.053214617073536, -32.18294421583414, -31.486779995262623, -25.72498159855604, -74.05107965320349, -56.48677372932434, -81.31394343078136, -66.3168233782053, -133.8570780530572, -167.36273351311684, -236.67993718385696, -113.43521419912577, -106.19999998062849, -121.27475634217262, -134.16855704784393, -170.209067851305, -130.0716859549284, -10.927458725869656, -50.014944203197956, -64.0853375941515, -36.08936442434788, -79.63521414995193, -113.78802455216646, -119.28936453163624, -107.36105085164309, -48.462737798690796, -97.36593739688396, 4.440108671784401, -29.997960150241852, -51.644847489893436, -56.999355621635914, -98.48256053030491, -55.39574145525694, -106.73987541347742, -39.58422743529081, 2.465688534080982, 0.4392441511154175, -46.824981696903706, -59.305214524269104], "episode_lengths": [241, 277, 241, 261, 244, 252, 254, 262, 244, 243, 236, 282, 247, 237, 257, 241, 270, 234, 217, 259, 233, 287, 225, 274, 245, 256, 244, 258, 271, 233, 249, 235, 243, 256, 237, 282, 317, 246, 216, 279, 277, 239, 267, 220, 268, 233, 225, 299, 279, 223, 247, 248, 248, 253, 288, 283, 255, 239, 335, 238, 267, 253, 238, 229, 237, 242, 254, 254, 252, 285, 296, 350, 272, 264, 276, 287, 288, 275, 227, 238, 240, 236, 223, 286, 281, 275, 247, 249, 230, 236, 251, 257, 270, 253, 266, 237, 215, 204, 237, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5775910220591082, "mean_inference_ms": 7.353700557937776, "mean_action_processing_ms": 0.12079724690205121, "mean_env_wait_ms": 4.70807428074611, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 26302.495, "learn_time_ms": 22766.339, "learn_throughput": 175.698, "update_time_ms": 26.98}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 208, "training_iteration": 14, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-34-16", "timestamp": 1655537656, "time_this_iter_s": 26.141740560531616, "time_total_s": 369.28881764411926, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 369.28881764411926, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 27.57297297297297, "ram_util_percent": 63.36756756756759}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 5.9513840675354, "policy_loss": -0.1254667490720749, "vf_loss": 6.038476467132568, "vf_explained_var": 0.22975826263427734, "kl": 0.01705532893538475, "entropy": 1.9036139249801636, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 30.670457139611244, "episode_reward_min": -240.02786161005497, "episode_reward_mean": -73.32397731125354, "episode_len_mean": 255.18, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-144.38828268647194, -36.35041534155607, -9.435214146971703, -92.7893645092845, -16.40618797391653, -153.7999999821186, -22.14215748757124, -71.39963007718325, -43.70193450897932, -92.43431157618761, -50.6139432489872, -56.031307838857174, -82.25363389402628, -0.5700717717409134, -62.6000000461936, -24.658466048538685, -49.81394337117672, -80.88846188783646, -43.10221494734287, -116.34970287233591, -203.18539182841778, -46.93405610322952, -1.260148175060749, -123.8884621411562, -107.06019562482834, -54.38936460018158, -89.05041531473398, -8.268093883991241, -76.3980952501297, -19.58160937577486, -18.01135866343975, -166.77377209067345, -132.9229950606823, -3.4953622817993164, -54.30853012949228, -79.89129002392292, -18.242030531167984, -79.98936446011066, -127.82367618381977, -151.0000000372529, -99.99224470555782, -34.42943976074457, -229.10188154876232, -36.397992357611656, -86.40690023452044, -44.053214617073536, -32.18294421583414, -31.486779995262623, -25.72498159855604, -74.05107965320349, -56.48677372932434, -81.31394343078136, -66.3168233782053, -133.8570780530572, -167.36273351311684, -236.67993718385696, -113.43521419912577, -106.19999998062849, -121.27475634217262, -134.16855704784393, -170.209067851305, -130.0716859549284, -10.927458725869656, -50.014944203197956, -64.0853375941515, -36.08936442434788, -79.63521414995193, -113.78802455216646, -119.28936453163624, -107.36105085164309, -48.462737798690796, -97.36593739688396, 4.440108671784401, -29.997960150241852, -51.644847489893436, -56.999355621635914, -98.48256053030491, -55.39574145525694, -106.73987541347742, -39.58422743529081, 2.465688534080982, 0.4392441511154175, -46.824981696903706, -59.305214524269104, -80.25743516534567, -60.223048001527786, -0.515399619936943, -10.67215321213007, -87.11349380761385, -96.50444428622723, -101.5601246803999, -75.99118652939796, -66.29963058978319, 30.670457139611244, -240.02786161005497, -80.5197031646967, -1.132737047970295, -90.92655620723963, -7.447830781340599, -75.81994104385376], "episode_lengths": [270, 234, 217, 259, 233, 287, 225, 274, 245, 256, 244, 258, 271, 233, 249, 235, 243, 256, 237, 282, 317, 246, 216, 279, 277, 239, 267, 220, 268, 233, 225, 299, 279, 223, 247, 248, 248, 253, 288, 283, 255, 239, 335, 238, 267, 253, 238, 229, 237, 242, 254, 254, 252, 285, 296, 350, 272, 264, 276, 287, 288, 275, 227, 238, 240, 236, 223, 286, 281, 275, 247, 249, 230, 236, 251, 257, 270, 253, 266, 237, 215, 204, 237, 248, 257, 266, 230, 220, 259, 272, 276, 261, 259, 206, 333, 255, 215, 259, 227, 268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5805816235805392, "mean_inference_ms": 7.353569388178365, "mean_action_processing_ms": 0.12076460069066455, "mean_env_wait_ms": 4.709831289994714, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 30.670457139611244, "episode_reward_min": -240.02786161005497, "episode_reward_mean": -73.32397731125354, "episode_len_mean": 255.18, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-144.38828268647194, -36.35041534155607, -9.435214146971703, -92.7893645092845, -16.40618797391653, -153.7999999821186, -22.14215748757124, -71.39963007718325, -43.70193450897932, -92.43431157618761, -50.6139432489872, -56.031307838857174, -82.25363389402628, -0.5700717717409134, -62.6000000461936, -24.658466048538685, -49.81394337117672, -80.88846188783646, -43.10221494734287, -116.34970287233591, -203.18539182841778, -46.93405610322952, -1.260148175060749, -123.8884621411562, -107.06019562482834, -54.38936460018158, -89.05041531473398, -8.268093883991241, -76.3980952501297, -19.58160937577486, -18.01135866343975, -166.77377209067345, -132.9229950606823, -3.4953622817993164, -54.30853012949228, -79.89129002392292, -18.242030531167984, -79.98936446011066, -127.82367618381977, -151.0000000372529, -99.99224470555782, -34.42943976074457, -229.10188154876232, -36.397992357611656, -86.40690023452044, -44.053214617073536, -32.18294421583414, -31.486779995262623, -25.72498159855604, -74.05107965320349, -56.48677372932434, -81.31394343078136, -66.3168233782053, -133.8570780530572, -167.36273351311684, -236.67993718385696, -113.43521419912577, -106.19999998062849, -121.27475634217262, -134.16855704784393, -170.209067851305, -130.0716859549284, -10.927458725869656, -50.014944203197956, -64.0853375941515, -36.08936442434788, -79.63521414995193, -113.78802455216646, -119.28936453163624, -107.36105085164309, -48.462737798690796, -97.36593739688396, 4.440108671784401, -29.997960150241852, -51.644847489893436, -56.999355621635914, -98.48256053030491, -55.39574145525694, -106.73987541347742, -39.58422743529081, 2.465688534080982, 0.4392441511154175, -46.824981696903706, -59.305214524269104, -80.25743516534567, -60.223048001527786, -0.515399619936943, -10.67215321213007, -87.11349380761385, -96.50444428622723, -101.5601246803999, -75.99118652939796, -66.29963058978319, 30.670457139611244, -240.02786161005497, -80.5197031646967, -1.132737047970295, -90.92655620723963, -7.447830781340599, -75.81994104385376], "episode_lengths": [270, 234, 217, 259, 233, 287, 225, 274, 245, 256, 244, 258, 271, 233, 249, 235, 243, 256, 237, 282, 317, 246, 216, 279, 277, 239, 267, 220, 268, 233, 225, 299, 279, 223, 247, 248, 248, 253, 288, 283, 255, 239, 335, 238, 267, 253, 238, 229, 237, 242, 254, 254, 252, 285, 296, 350, 272, 264, 276, 287, 288, 275, 227, 238, 240, 236, 223, 286, 281, 275, 247, 249, 230, 236, 251, 257, 270, 253, 266, 237, 215, 204, 237, 248, 257, 266, 230, 220, 259, 272, 276, 261, 259, 206, 333, 255, 215, 259, 227, 268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5805816235805392, "mean_inference_ms": 7.353569388178365, "mean_action_processing_ms": 0.12076460069066455, "mean_env_wait_ms": 4.709831289994714, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 26263.225, "learn_time_ms": 22727.37, "learn_throughput": 175.999, "update_time_ms": 26.978}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 224, "training_iteration": 15, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-34-42", "timestamp": 1655537682, "time_this_iter_s": 26.253885984420776, "time_total_s": 395.54270362854004, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 395.54270362854004, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 28.33783783783784, "ram_util_percent": 63.4891891891892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.129834175109863, "policy_loss": -0.11353443562984467, "vf_loss": 6.205203533172607, "vf_explained_var": 0.4776712954044342, "kl": 0.01696234941482544, "entropy": 1.8928375244140625, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 30.670457139611244, "episode_reward_min": -296.02029640227556, "episode_reward_mean": -74.28996877826751, "episode_len_mean": 255.13, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.81394337117672, -80.88846188783646, -43.10221494734287, -116.34970287233591, -203.18539182841778, -46.93405610322952, -1.260148175060749, -123.8884621411562, -107.06019562482834, -54.38936460018158, -89.05041531473398, -8.268093883991241, -76.3980952501297, -19.58160937577486, -18.01135866343975, -166.77377209067345, -132.9229950606823, -3.4953622817993164, -54.30853012949228, -79.89129002392292, -18.242030531167984, -79.98936446011066, -127.82367618381977, -151.0000000372529, -99.99224470555782, -34.42943976074457, -229.10188154876232, -36.397992357611656, -86.40690023452044, -44.053214617073536, -32.18294421583414, -31.486779995262623, -25.72498159855604, -74.05107965320349, -56.48677372932434, -81.31394343078136, -66.3168233782053, -133.8570780530572, -167.36273351311684, -236.67993718385696, -113.43521419912577, -106.19999998062849, -121.27475634217262, -134.16855704784393, -170.209067851305, -130.0716859549284, -10.927458725869656, -50.014944203197956, -64.0853375941515, -36.08936442434788, -79.63521414995193, -113.78802455216646, -119.28936453163624, -107.36105085164309, -48.462737798690796, -97.36593739688396, 4.440108671784401, -29.997960150241852, -51.644847489893436, -56.999355621635914, -98.48256053030491, -55.39574145525694, -106.73987541347742, -39.58422743529081, 2.465688534080982, 0.4392441511154175, -46.824981696903706, -59.305214524269104, -80.25743516534567, -60.223048001527786, -0.515399619936943, -10.67215321213007, -87.11349380761385, -96.50444428622723, -101.5601246803999, -75.99118652939796, -66.29963058978319, 30.670457139611244, -240.02786161005497, -80.5197031646967, -1.132737047970295, -90.92655620723963, -7.447830781340599, -75.81994104385376, -31.003208488225937, -14.611358635127544, 12.757340095937252, -20.691587775945663, 8.631517149508, -296.02029640227556, -57.383462972939014, -23.86286461353302, -17.48755945265293, -40.878729201853275, -81.26771503686905, -94.58304488658905, -79.57738910615444, -35.029439844191074, -241.088024482131, -44.07824418693781], "episode_lengths": [243, 256, 237, 282, 317, 246, 216, 279, 277, 239, 267, 220, 268, 233, 225, 299, 279, 223, 247, 248, 248, 253, 288, 283, 255, 239, 335, 238, 267, 253, 238, 229, 237, 242, 254, 254, 252, 285, 296, 350, 272, 264, 276, 287, 288, 275, 227, 238, 240, 236, 223, 286, 281, 275, 247, 249, 230, 236, 251, 257, 270, 253, 266, 237, 215, 204, 237, 248, 257, 266, 230, 220, 259, 272, 276, 261, 259, 206, 333, 255, 215, 259, 227, 268, 227, 228, 214, 242, 205, 347, 248, 242, 235, 240, 255, 268, 254, 232, 309, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5825482468151761, "mean_inference_ms": 7.3497230312493445, "mean_action_processing_ms": 0.12082663154362068, "mean_env_wait_ms": 4.713116883323276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 30.670457139611244, "episode_reward_min": -296.02029640227556, "episode_reward_mean": -74.28996877826751, "episode_len_mean": 255.13, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.81394337117672, -80.88846188783646, -43.10221494734287, -116.34970287233591, -203.18539182841778, -46.93405610322952, -1.260148175060749, -123.8884621411562, -107.06019562482834, -54.38936460018158, -89.05041531473398, -8.268093883991241, -76.3980952501297, -19.58160937577486, -18.01135866343975, -166.77377209067345, -132.9229950606823, -3.4953622817993164, -54.30853012949228, -79.89129002392292, -18.242030531167984, -79.98936446011066, -127.82367618381977, -151.0000000372529, -99.99224470555782, -34.42943976074457, -229.10188154876232, -36.397992357611656, -86.40690023452044, -44.053214617073536, -32.18294421583414, -31.486779995262623, -25.72498159855604, -74.05107965320349, -56.48677372932434, -81.31394343078136, -66.3168233782053, -133.8570780530572, -167.36273351311684, -236.67993718385696, -113.43521419912577, -106.19999998062849, -121.27475634217262, -134.16855704784393, -170.209067851305, -130.0716859549284, -10.927458725869656, -50.014944203197956, -64.0853375941515, -36.08936442434788, -79.63521414995193, -113.78802455216646, -119.28936453163624, -107.36105085164309, -48.462737798690796, -97.36593739688396, 4.440108671784401, -29.997960150241852, -51.644847489893436, -56.999355621635914, -98.48256053030491, -55.39574145525694, -106.73987541347742, -39.58422743529081, 2.465688534080982, 0.4392441511154175, -46.824981696903706, -59.305214524269104, -80.25743516534567, -60.223048001527786, -0.515399619936943, -10.67215321213007, -87.11349380761385, -96.50444428622723, -101.5601246803999, -75.99118652939796, -66.29963058978319, 30.670457139611244, -240.02786161005497, -80.5197031646967, -1.132737047970295, -90.92655620723963, -7.447830781340599, -75.81994104385376, -31.003208488225937, -14.611358635127544, 12.757340095937252, -20.691587775945663, 8.631517149508, -296.02029640227556, -57.383462972939014, -23.86286461353302, -17.48755945265293, -40.878729201853275, -81.26771503686905, -94.58304488658905, -79.57738910615444, -35.029439844191074, -241.088024482131, -44.07824418693781], "episode_lengths": [243, 256, 237, 282, 317, 246, 216, 279, 277, 239, 267, 220, 268, 233, 225, 299, 279, 223, 247, 248, 248, 253, 288, 283, 255, 239, 335, 238, 267, 253, 238, 229, 237, 242, 254, 254, 252, 285, 296, 350, 272, 264, 276, 287, 288, 275, 227, 238, 240, 236, 223, 286, 281, 275, 247, 249, 230, 236, 251, 257, 270, 253, 266, 237, 215, 204, 237, 248, 257, 266, 230, 220, 259, 272, 276, 261, 259, 206, 333, 255, 215, 259, 227, 268, 227, 228, 214, 242, 205, 347, 248, 242, 235, 240, 255, 268, 254, 232, 309, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5825482468151761, "mean_inference_ms": 7.3497230312493445, "mean_action_processing_ms": 0.12082663154362068, "mean_env_wait_ms": 4.713116883323276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 26271.302, "learn_time_ms": 22736.969, "learn_throughput": 175.925, "update_time_ms": 27.057}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 240, "training_iteration": 16, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-35-09", "timestamp": 1655537709, "time_this_iter_s": 26.362139463424683, "time_total_s": 421.9048430919647, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 421.9048430919647, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 28.56756756756757, "ram_util_percent": 63.51081081081081}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.390715599060059, "policy_loss": -0.13266481459140778, "vf_loss": 6.481675148010254, "vf_explained_var": 0.32555899024009705, "kl": 0.018535755574703217, "entropy": 1.9010995626449585, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 30.670457139611244, "episode_reward_min": -502.06852620095015, "episode_reward_mean": -75.24131522297859, "episode_len_mean": 255.19, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-166.77377209067345, -132.9229950606823, -3.4953622817993164, -54.30853012949228, -79.89129002392292, -18.242030531167984, -79.98936446011066, -127.82367618381977, -151.0000000372529, -99.99224470555782, -34.42943976074457, -229.10188154876232, -36.397992357611656, -86.40690023452044, -44.053214617073536, -32.18294421583414, -31.486779995262623, -25.72498159855604, -74.05107965320349, -56.48677372932434, -81.31394343078136, -66.3168233782053, -133.8570780530572, -167.36273351311684, -236.67993718385696, -113.43521419912577, -106.19999998062849, -121.27475634217262, -134.16855704784393, -170.209067851305, -130.0716859549284, -10.927458725869656, -50.014944203197956, -64.0853375941515, -36.08936442434788, -79.63521414995193, -113.78802455216646, -119.28936453163624, -107.36105085164309, -48.462737798690796, -97.36593739688396, 4.440108671784401, -29.997960150241852, -51.644847489893436, -56.999355621635914, -98.48256053030491, -55.39574145525694, -106.73987541347742, -39.58422743529081, 2.465688534080982, 0.4392441511154175, -46.824981696903706, -59.305214524269104, -80.25743516534567, -60.223048001527786, -0.515399619936943, -10.67215321213007, -87.11349380761385, -96.50444428622723, -101.5601246803999, -75.99118652939796, -66.29963058978319, 30.670457139611244, -240.02786161005497, -80.5197031646967, -1.132737047970295, -90.92655620723963, -7.447830781340599, -75.81994104385376, -31.003208488225937, -14.611358635127544, 12.757340095937252, -20.691587775945663, 8.631517149508, -296.02029640227556, -57.383462972939014, -23.86286461353302, -17.48755945265293, -40.878729201853275, -81.26771503686905, -94.58304488658905, -79.57738910615444, -35.029439844191074, -241.088024482131, -44.07824418693781, -32.233639404177666, 5.518546983599663, -12.579828023910522, -48.35258340835571, -16.15041532367468, -33.76809383183718, -30.1709887906909, -16.624981455504894, -81.3213892057538, -117.74385786056519, -87.87614447623491, -502.06852620095015, -159.74518470466137, 19.710686542093754, -19.90975935012102], "episode_lengths": [299, 279, 223, 247, 248, 248, 253, 288, 283, 255, 239, 335, 238, 267, 253, 238, 229, 237, 242, 254, 254, 252, 285, 296, 350, 272, 264, 276, 287, 288, 275, 227, 238, 240, 236, 223, 286, 281, 275, 247, 249, 230, 236, 251, 257, 270, 253, 266, 237, 215, 204, 237, 248, 257, 266, 230, 220, 259, 272, 276, 261, 259, 206, 333, 255, 215, 259, 227, 268, 227, 228, 214, 242, 205, 347, 248, 242, 235, 240, 255, 268, 254, 232, 309, 239, 231, 224, 234, 250, 228, 228, 244, 223, 256, 270, 254, 436, 304, 210, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5837250009557889, "mean_inference_ms": 7.349247185383226, "mean_action_processing_ms": 0.12105160310940055, "mean_env_wait_ms": 4.709063310054147, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 30.670457139611244, "episode_reward_min": -502.06852620095015, "episode_reward_mean": -75.24131522297859, "episode_len_mean": 255.19, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-166.77377209067345, -132.9229950606823, -3.4953622817993164, -54.30853012949228, -79.89129002392292, -18.242030531167984, -79.98936446011066, -127.82367618381977, -151.0000000372529, -99.99224470555782, -34.42943976074457, -229.10188154876232, -36.397992357611656, -86.40690023452044, -44.053214617073536, -32.18294421583414, -31.486779995262623, -25.72498159855604, -74.05107965320349, -56.48677372932434, -81.31394343078136, -66.3168233782053, -133.8570780530572, -167.36273351311684, -236.67993718385696, -113.43521419912577, -106.19999998062849, -121.27475634217262, -134.16855704784393, -170.209067851305, -130.0716859549284, -10.927458725869656, -50.014944203197956, -64.0853375941515, -36.08936442434788, -79.63521414995193, -113.78802455216646, -119.28936453163624, -107.36105085164309, -48.462737798690796, -97.36593739688396, 4.440108671784401, -29.997960150241852, -51.644847489893436, -56.999355621635914, -98.48256053030491, -55.39574145525694, -106.73987541347742, -39.58422743529081, 2.465688534080982, 0.4392441511154175, -46.824981696903706, -59.305214524269104, -80.25743516534567, -60.223048001527786, -0.515399619936943, -10.67215321213007, -87.11349380761385, -96.50444428622723, -101.5601246803999, -75.99118652939796, -66.29963058978319, 30.670457139611244, -240.02786161005497, -80.5197031646967, -1.132737047970295, -90.92655620723963, -7.447830781340599, -75.81994104385376, -31.003208488225937, -14.611358635127544, 12.757340095937252, -20.691587775945663, 8.631517149508, -296.02029640227556, -57.383462972939014, -23.86286461353302, -17.48755945265293, -40.878729201853275, -81.26771503686905, -94.58304488658905, -79.57738910615444, -35.029439844191074, -241.088024482131, -44.07824418693781, -32.233639404177666, 5.518546983599663, -12.579828023910522, -48.35258340835571, -16.15041532367468, -33.76809383183718, -30.1709887906909, -16.624981455504894, -81.3213892057538, -117.74385786056519, -87.87614447623491, -502.06852620095015, -159.74518470466137, 19.710686542093754, -19.90975935012102], "episode_lengths": [299, 279, 223, 247, 248, 248, 253, 288, 283, 255, 239, 335, 238, 267, 253, 238, 229, 237, 242, 254, 254, 252, 285, 296, 350, 272, 264, 276, 287, 288, 275, 227, 238, 240, 236, 223, 286, 281, 275, 247, 249, 230, 236, 251, 257, 270, 253, 266, 237, 215, 204, 237, 248, 257, 266, 230, 220, 259, 272, 276, 261, 259, 206, 333, 255, 215, 259, 227, 268, 227, 228, 214, 242, 205, 347, 248, 242, 235, 240, 255, 268, 254, 232, 309, 239, 231, 224, 234, 250, 228, 228, 244, 223, 256, 270, 254, 436, 304, 210, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5837250009557889, "mean_inference_ms": 7.349247185383226, "mean_action_processing_ms": 0.12105160310940055, "mean_env_wait_ms": 4.709063310054147, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 68000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 26275.655, "learn_time_ms": 22730.851, "learn_throughput": 175.972, "update_time_ms": 26.958}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 255, "training_iteration": 17, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-35-35", "timestamp": 1655537735, "time_this_iter_s": 26.322911977767944, "time_total_s": 448.22775506973267, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 448.22775506973267, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 26.90810810810811, "ram_util_percent": 63.52162162162161}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.5802531242370605, "policy_loss": -0.12289053946733475, "vf_loss": 6.663821220397949, "vf_explained_var": 0.2229044884443283, "kl": 0.017476769164204597, "entropy": 1.8789278268814087, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 30.670457139611244, "episode_reward_min": -502.06852620095015, "episode_reward_mean": -72.73309307478368, "episode_len_mean": 253.64, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.18294421583414, -31.486779995262623, -25.72498159855604, -74.05107965320349, -56.48677372932434, -81.31394343078136, -66.3168233782053, -133.8570780530572, -167.36273351311684, -236.67993718385696, -113.43521419912577, -106.19999998062849, -121.27475634217262, -134.16855704784393, -170.209067851305, -130.0716859549284, -10.927458725869656, -50.014944203197956, -64.0853375941515, -36.08936442434788, -79.63521414995193, -113.78802455216646, -119.28936453163624, -107.36105085164309, -48.462737798690796, -97.36593739688396, 4.440108671784401, -29.997960150241852, -51.644847489893436, -56.999355621635914, -98.48256053030491, -55.39574145525694, -106.73987541347742, -39.58422743529081, 2.465688534080982, 0.4392441511154175, -46.824981696903706, -59.305214524269104, -80.25743516534567, -60.223048001527786, -0.515399619936943, -10.67215321213007, -87.11349380761385, -96.50444428622723, -101.5601246803999, -75.99118652939796, -66.29963058978319, 30.670457139611244, -240.02786161005497, -80.5197031646967, -1.132737047970295, -90.92655620723963, -7.447830781340599, -75.81994104385376, -31.003208488225937, -14.611358635127544, 12.757340095937252, -20.691587775945663, 8.631517149508, -296.02029640227556, -57.383462972939014, -23.86286461353302, -17.48755945265293, -40.878729201853275, -81.26771503686905, -94.58304488658905, -79.57738910615444, -35.029439844191074, -241.088024482131, -44.07824418693781, -32.233639404177666, 5.518546983599663, -12.579828023910522, -48.35258340835571, -16.15041532367468, -33.76809383183718, -30.1709887906909, -16.624981455504894, -81.3213892057538, -117.74385786056519, -87.87614447623491, -502.06852620095015, -159.74518470466137, 19.710686542093754, -19.90975935012102, -37.63690038770437, -41.57168619334698, -58.29999993741512, -8.857208244502544, -45.339780017733574, -139.5329476967454, -100.22514820843935, -5.913943484425545, -76.66321504861116, -61.76105070859194, -164.45334351062775, -88.33431142568588, -185.4799210652709, -22.930513359606266, -57.00650991499424], "episode_lengths": [238, 229, 237, 242, 254, 254, 252, 285, 296, 350, 272, 264, 276, 287, 288, 275, 227, 238, 240, 236, 223, 286, 281, 275, 247, 249, 230, 236, 251, 257, 270, 253, 266, 237, 215, 204, 237, 248, 257, 266, 230, 220, 259, 272, 276, 261, 259, 206, 333, 255, 215, 259, 227, 268, 227, 228, 214, 242, 205, 347, 248, 242, 235, 240, 255, 268, 254, 232, 309, 239, 231, 224, 234, 250, 228, 228, 244, 223, 256, 270, 254, 436, 304, 210, 219, 249, 228, 235, 224, 237, 278, 273, 220, 239, 237, 304, 262, 320, 232, 262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5845270447364883, "mean_inference_ms": 7.347587640715853, "mean_action_processing_ms": 0.12123550214790266, "mean_env_wait_ms": 4.709115275214182, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 30.670457139611244, "episode_reward_min": -502.06852620095015, "episode_reward_mean": -72.73309307478368, "episode_len_mean": 253.64, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32.18294421583414, -31.486779995262623, -25.72498159855604, -74.05107965320349, -56.48677372932434, -81.31394343078136, -66.3168233782053, -133.8570780530572, -167.36273351311684, -236.67993718385696, -113.43521419912577, -106.19999998062849, -121.27475634217262, -134.16855704784393, -170.209067851305, -130.0716859549284, -10.927458725869656, -50.014944203197956, -64.0853375941515, -36.08936442434788, -79.63521414995193, -113.78802455216646, -119.28936453163624, -107.36105085164309, -48.462737798690796, -97.36593739688396, 4.440108671784401, -29.997960150241852, -51.644847489893436, -56.999355621635914, -98.48256053030491, -55.39574145525694, -106.73987541347742, -39.58422743529081, 2.465688534080982, 0.4392441511154175, -46.824981696903706, -59.305214524269104, -80.25743516534567, -60.223048001527786, -0.515399619936943, -10.67215321213007, -87.11349380761385, -96.50444428622723, -101.5601246803999, -75.99118652939796, -66.29963058978319, 30.670457139611244, -240.02786161005497, -80.5197031646967, -1.132737047970295, -90.92655620723963, -7.447830781340599, -75.81994104385376, -31.003208488225937, -14.611358635127544, 12.757340095937252, -20.691587775945663, 8.631517149508, -296.02029640227556, -57.383462972939014, -23.86286461353302, -17.48755945265293, -40.878729201853275, -81.26771503686905, -94.58304488658905, -79.57738910615444, -35.029439844191074, -241.088024482131, -44.07824418693781, -32.233639404177666, 5.518546983599663, -12.579828023910522, -48.35258340835571, -16.15041532367468, -33.76809383183718, -30.1709887906909, -16.624981455504894, -81.3213892057538, -117.74385786056519, -87.87614447623491, -502.06852620095015, -159.74518470466137, 19.710686542093754, -19.90975935012102, -37.63690038770437, -41.57168619334698, -58.29999993741512, -8.857208244502544, -45.339780017733574, -139.5329476967454, -100.22514820843935, -5.913943484425545, -76.66321504861116, -61.76105070859194, -164.45334351062775, -88.33431142568588, -185.4799210652709, -22.930513359606266, -57.00650991499424], "episode_lengths": [238, 229, 237, 242, 254, 254, 252, 285, 296, 350, 272, 264, 276, 287, 288, 275, 227, 238, 240, 236, 223, 286, 281, 275, 247, 249, 230, 236, 251, 257, 270, 253, 266, 237, 215, 204, 237, 248, 257, 266, 230, 220, 259, 272, 276, 261, 259, 206, 333, 255, 215, 259, 227, 268, 227, 228, 214, 242, 205, 347, 248, 242, 235, 240, 255, 268, 254, 232, 309, 239, 231, 224, 234, 250, 228, 228, 244, 223, 256, 270, 254, 436, 304, 210, 219, 249, 228, 235, 224, 237, 278, 273, 220, 239, 237, 304, 262, 320, 232, 262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5845270447364883, "mean_inference_ms": 7.347587640715853, "mean_action_processing_ms": 0.12123550214790266, "mean_env_wait_ms": 4.709115275214182, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 72000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 26310.103, "learn_time_ms": 22733.413, "learn_throughput": 175.952, "update_time_ms": 26.959}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 270, "training_iteration": 18, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-36-02", "timestamp": 1655537762, "time_this_iter_s": 26.587688207626343, "time_total_s": 474.815443277359, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 474.815443277359, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 28.26052631578947, "ram_util_percent": 63.59473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.678216457366943, "policy_loss": -0.13821642100811005, "vf_loss": 6.774397373199463, "vf_explained_var": -0.046231191605329514, "kl": 0.018682416528463364, "entropy": 1.8740402460098267, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 30.670457139611244, "episode_reward_min": -502.06852620095015, "episode_reward_mean": -72.14028515346348, "episode_len_mean": 253.57, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.927458725869656, -50.014944203197956, -64.0853375941515, -36.08936442434788, -79.63521414995193, -113.78802455216646, -119.28936453163624, -107.36105085164309, -48.462737798690796, -97.36593739688396, 4.440108671784401, -29.997960150241852, -51.644847489893436, -56.999355621635914, -98.48256053030491, -55.39574145525694, -106.73987541347742, -39.58422743529081, 2.465688534080982, 0.4392441511154175, -46.824981696903706, -59.305214524269104, -80.25743516534567, -60.223048001527786, -0.515399619936943, -10.67215321213007, -87.11349380761385, -96.50444428622723, -101.5601246803999, -75.99118652939796, -66.29963058978319, 30.670457139611244, -240.02786161005497, -80.5197031646967, -1.132737047970295, -90.92655620723963, -7.447830781340599, -75.81994104385376, -31.003208488225937, -14.611358635127544, 12.757340095937252, -20.691587775945663, 8.631517149508, -296.02029640227556, -57.383462972939014, -23.86286461353302, -17.48755945265293, -40.878729201853275, -81.26771503686905, -94.58304488658905, -79.57738910615444, -35.029439844191074, -241.088024482131, -44.07824418693781, -32.233639404177666, 5.518546983599663, -12.579828023910522, -48.35258340835571, -16.15041532367468, -33.76809383183718, -30.1709887906909, -16.624981455504894, -81.3213892057538, -117.74385786056519, -87.87614447623491, -502.06852620095015, -159.74518470466137, 19.710686542093754, -19.90975935012102, -37.63690038770437, -41.57168619334698, -58.29999993741512, -8.857208244502544, -45.339780017733574, -139.5329476967454, -100.22514820843935, -5.913943484425545, -76.66321504861116, -61.76105070859194, -164.45334351062775, -88.33431142568588, -185.4799210652709, -22.930513359606266, -57.00650991499424, -92.96321851015091, -48.59909735620022, -49.227458760142326, -92.0102159306407, -125.83561702817678, -115.94644241034985, 1.755875438451767, -282.8329567760229, -90.74993028491735, -152.29789335280657, -61.8308272883296, -2.0169317573308945, -68.36390362679958, -157.97685627639294, -113.84321580827236, -168.8028742671013], "episode_lengths": [227, 238, 240, 236, 223, 286, 281, 275, 247, 249, 230, 236, 251, 257, 270, 253, 266, 237, 215, 204, 237, 248, 257, 266, 230, 220, 259, 272, 276, 261, 259, 206, 333, 255, 215, 259, 227, 268, 227, 228, 214, 242, 205, 347, 248, 242, 235, 240, 255, 268, 254, 232, 309, 239, 231, 224, 234, 250, 228, 228, 244, 223, 256, 270, 254, 436, 304, 210, 219, 249, 228, 235, 224, 237, 278, 273, 220, 239, 237, 304, 262, 320, 232, 262, 268, 251, 250, 264, 275, 288, 227, 353, 249, 295, 256, 220, 257, 280, 267, 292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5860496973635458, "mean_inference_ms": 7.3445020494387645, "mean_action_processing_ms": 0.12135302236377292, "mean_env_wait_ms": 4.710533856183171, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 30.670457139611244, "episode_reward_min": -502.06852620095015, "episode_reward_mean": -72.14028515346348, "episode_len_mean": 253.57, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.927458725869656, -50.014944203197956, -64.0853375941515, -36.08936442434788, -79.63521414995193, -113.78802455216646, -119.28936453163624, -107.36105085164309, -48.462737798690796, -97.36593739688396, 4.440108671784401, -29.997960150241852, -51.644847489893436, -56.999355621635914, -98.48256053030491, -55.39574145525694, -106.73987541347742, -39.58422743529081, 2.465688534080982, 0.4392441511154175, -46.824981696903706, -59.305214524269104, -80.25743516534567, -60.223048001527786, -0.515399619936943, -10.67215321213007, -87.11349380761385, -96.50444428622723, -101.5601246803999, -75.99118652939796, -66.29963058978319, 30.670457139611244, -240.02786161005497, -80.5197031646967, -1.132737047970295, -90.92655620723963, -7.447830781340599, -75.81994104385376, -31.003208488225937, -14.611358635127544, 12.757340095937252, -20.691587775945663, 8.631517149508, -296.02029640227556, -57.383462972939014, -23.86286461353302, -17.48755945265293, -40.878729201853275, -81.26771503686905, -94.58304488658905, -79.57738910615444, -35.029439844191074, -241.088024482131, -44.07824418693781, -32.233639404177666, 5.518546983599663, -12.579828023910522, -48.35258340835571, -16.15041532367468, -33.76809383183718, -30.1709887906909, -16.624981455504894, -81.3213892057538, -117.74385786056519, -87.87614447623491, -502.06852620095015, -159.74518470466137, 19.710686542093754, -19.90975935012102, -37.63690038770437, -41.57168619334698, -58.29999993741512, -8.857208244502544, -45.339780017733574, -139.5329476967454, -100.22514820843935, -5.913943484425545, -76.66321504861116, -61.76105070859194, -164.45334351062775, -88.33431142568588, -185.4799210652709, -22.930513359606266, -57.00650991499424, -92.96321851015091, -48.59909735620022, -49.227458760142326, -92.0102159306407, -125.83561702817678, -115.94644241034985, 1.755875438451767, -282.8329567760229, -90.74993028491735, -152.29789335280657, -61.8308272883296, -2.0169317573308945, -68.36390362679958, -157.97685627639294, -113.84321580827236, -168.8028742671013], "episode_lengths": [227, 238, 240, 236, 223, 286, 281, 275, 247, 249, 230, 236, 251, 257, 270, 253, 266, 237, 215, 204, 237, 248, 257, 266, 230, 220, 259, 272, 276, 261, 259, 206, 333, 255, 215, 259, 227, 268, 227, 228, 214, 242, 205, 347, 248, 242, 235, 240, 255, 268, 254, 232, 309, 239, 231, 224, 234, 250, 228, 228, 244, 223, 256, 270, 254, 436, 304, 210, 219, 249, 228, 235, 224, 237, 278, 273, 220, 239, 237, 304, 262, 320, 232, 262, 268, 251, 250, 264, 275, 288, 227, 353, 249, 295, 256, 220, 257, 280, 267, 292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5860496973635458, "mean_inference_ms": 7.3445020494387645, "mean_action_processing_ms": 0.12135302236377292, "mean_env_wait_ms": 4.710533856183171, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 76000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 26298.397, "learn_time_ms": 22737.502, "learn_throughput": 175.921, "update_time_ms": 26.858}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 286, "training_iteration": 19, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-36-29", "timestamp": 1655537789, "time_this_iter_s": 26.31201434135437, "time_total_s": 501.1274576187134, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 501.1274576187134, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 28.15675675675676, "ram_util_percent": 63.635135135135144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.650781154632568, "policy_loss": -0.04180193692445755, "vf_loss": 6.6715989112854, "vf_explained_var": 0.02523643895983696, "kl": 0.009326514787971973, "entropy": 1.8801651000976562, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 942.4120050743222, "episode_reward_min": -502.06852620095015, "episode_reward_mean": -55.19816924989223, "episode_len_mean": 254.66, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.73987541347742, -39.58422743529081, 2.465688534080982, 0.4392441511154175, -46.824981696903706, -59.305214524269104, -80.25743516534567, -60.223048001527786, -0.515399619936943, -10.67215321213007, -87.11349380761385, -96.50444428622723, -101.5601246803999, -75.99118652939796, -66.29963058978319, 30.670457139611244, -240.02786161005497, -80.5197031646967, -1.132737047970295, -90.92655620723963, -7.447830781340599, -75.81994104385376, -31.003208488225937, -14.611358635127544, 12.757340095937252, -20.691587775945663, 8.631517149508, -296.02029640227556, -57.383462972939014, -23.86286461353302, -17.48755945265293, -40.878729201853275, -81.26771503686905, -94.58304488658905, -79.57738910615444, -35.029439844191074, -241.088024482131, -44.07824418693781, -32.233639404177666, 5.518546983599663, -12.579828023910522, -48.35258340835571, -16.15041532367468, -33.76809383183718, -30.1709887906909, -16.624981455504894, -81.3213892057538, -117.74385786056519, -87.87614447623491, -502.06852620095015, -159.74518470466137, 19.710686542093754, -19.90975935012102, -37.63690038770437, -41.57168619334698, -58.29999993741512, -8.857208244502544, -45.339780017733574, -139.5329476967454, -100.22514820843935, -5.913943484425545, -76.66321504861116, -61.76105070859194, -164.45334351062775, -88.33431142568588, -185.4799210652709, -22.930513359606266, -57.00650991499424, -92.96321851015091, -48.59909735620022, -49.227458760142326, -92.0102159306407, -125.83561702817678, -115.94644241034985, 1.755875438451767, -282.8329567760229, -90.74993028491735, -152.29789335280657, -61.8308272883296, -2.0169317573308945, -68.36390362679958, -157.97685627639294, -113.84321580827236, -168.8028742671013, -52.79999979585409, -10.670045137405396, -208.102618008852, -134.0713912025094, -161.52541875839233, -53.27784235030413, -44.83668917417526, -132.07872917503119, -99.07824406027794, 932.5059405043721, -57.48188501596451, -50.224578723311424, -137.98100940138102, -3.7494263350963593, -49.928268887102604, 942.4120050743222], "episode_lengths": [266, 237, 215, 204, 237, 248, 257, 266, 230, 220, 259, 272, 276, 261, 259, 206, 333, 255, 215, 259, 227, 268, 227, 228, 214, 242, 205, 347, 248, 242, 235, 240, 255, 268, 254, 232, 309, 239, 231, 224, 234, 250, 228, 228, 244, 223, 256, 270, 254, 436, 304, 210, 219, 249, 228, 235, 224, 237, 278, 273, 220, 239, 237, 304, 262, 320, 232, 262, 268, 251, 250, 264, 275, 288, 227, 353, 249, 295, 256, 220, 257, 280, 267, 292, 231, 226, 322, 275, 309, 248, 246, 269, 264, 260, 256, 240, 291, 225, 235, 211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5876484574443842, "mean_inference_ms": 7.343015732024472, "mean_action_processing_ms": 0.12131548425971034, "mean_env_wait_ms": 4.709043419136588, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 942.4120050743222, "episode_reward_min": -502.06852620095015, "episode_reward_mean": -55.19816924989223, "episode_len_mean": 254.66, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.73987541347742, -39.58422743529081, 2.465688534080982, 0.4392441511154175, -46.824981696903706, -59.305214524269104, -80.25743516534567, -60.223048001527786, -0.515399619936943, -10.67215321213007, -87.11349380761385, -96.50444428622723, -101.5601246803999, -75.99118652939796, -66.29963058978319, 30.670457139611244, -240.02786161005497, -80.5197031646967, -1.132737047970295, -90.92655620723963, -7.447830781340599, -75.81994104385376, -31.003208488225937, -14.611358635127544, 12.757340095937252, -20.691587775945663, 8.631517149508, -296.02029640227556, -57.383462972939014, -23.86286461353302, -17.48755945265293, -40.878729201853275, -81.26771503686905, -94.58304488658905, -79.57738910615444, -35.029439844191074, -241.088024482131, -44.07824418693781, -32.233639404177666, 5.518546983599663, -12.579828023910522, -48.35258340835571, -16.15041532367468, -33.76809383183718, -30.1709887906909, -16.624981455504894, -81.3213892057538, -117.74385786056519, -87.87614447623491, -502.06852620095015, -159.74518470466137, 19.710686542093754, -19.90975935012102, -37.63690038770437, -41.57168619334698, -58.29999993741512, -8.857208244502544, -45.339780017733574, -139.5329476967454, -100.22514820843935, -5.913943484425545, -76.66321504861116, -61.76105070859194, -164.45334351062775, -88.33431142568588, -185.4799210652709, -22.930513359606266, -57.00650991499424, -92.96321851015091, -48.59909735620022, -49.227458760142326, -92.0102159306407, -125.83561702817678, -115.94644241034985, 1.755875438451767, -282.8329567760229, -90.74993028491735, -152.29789335280657, -61.8308272883296, -2.0169317573308945, -68.36390362679958, -157.97685627639294, -113.84321580827236, -168.8028742671013, -52.79999979585409, -10.670045137405396, -208.102618008852, -134.0713912025094, -161.52541875839233, -53.27784235030413, -44.83668917417526, -132.07872917503119, -99.07824406027794, 932.5059405043721, -57.48188501596451, -50.224578723311424, -137.98100940138102, -3.7494263350963593, -49.928268887102604, 942.4120050743222], "episode_lengths": [266, 237, 215, 204, 237, 248, 257, 266, 230, 220, 259, 272, 276, 261, 259, 206, 333, 255, 215, 259, 227, 268, 227, 228, 214, 242, 205, 347, 248, 242, 235, 240, 255, 268, 254, 232, 309, 239, 231, 224, 234, 250, 228, 228, 244, 223, 256, 270, 254, 436, 304, 210, 219, 249, 228, 235, 224, 237, 278, 273, 220, 239, 237, 304, 262, 320, 232, 262, 268, 251, 250, 264, 275, 288, 227, 353, 249, 295, 256, 220, 257, 280, 267, 292, 231, 226, 322, 275, 309, 248, 246, 269, 264, 260, 256, 240, 291, 225, 235, 211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5876484574443842, "mean_inference_ms": 7.343015732024472, "mean_action_processing_ms": 0.12131548425971034, "mean_env_wait_ms": 4.709043419136588, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 80000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 26290.433, "learn_time_ms": 22737.749, "learn_throughput": 175.919, "update_time_ms": 26.958}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 302, "training_iteration": 20, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-36-55", "timestamp": 1655537815, "time_this_iter_s": 26.286383390426636, "time_total_s": 527.41384100914, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 527.41384100914, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 28.324324324324323, "ram_util_percent": 63.3081081081081}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 5.410558700561523, "policy_loss": -0.13480094075202942, "vf_loss": 5.505594730377197, "vf_explained_var": 0.2796916961669922, "kl": 0.017673222348093987, "entropy": 1.8858743906021118, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 942.4120050743222, "episode_reward_min": -502.06852620095015, "episode_reward_mean": -58.09604353390634, "episode_len_mean": 255.46, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-240.02786161005497, -80.5197031646967, -1.132737047970295, -90.92655620723963, -7.447830781340599, -75.81994104385376, -31.003208488225937, -14.611358635127544, 12.757340095937252, -20.691587775945663, 8.631517149508, -296.02029640227556, -57.383462972939014, -23.86286461353302, -17.48755945265293, -40.878729201853275, -81.26771503686905, -94.58304488658905, -79.57738910615444, -35.029439844191074, -241.088024482131, -44.07824418693781, -32.233639404177666, 5.518546983599663, -12.579828023910522, -48.35258340835571, -16.15041532367468, -33.76809383183718, -30.1709887906909, -16.624981455504894, -81.3213892057538, -117.74385786056519, -87.87614447623491, -502.06852620095015, -159.74518470466137, 19.710686542093754, -19.90975935012102, -37.63690038770437, -41.57168619334698, -58.29999993741512, -8.857208244502544, -45.339780017733574, -139.5329476967454, -100.22514820843935, -5.913943484425545, -76.66321504861116, -61.76105070859194, -164.45334351062775, -88.33431142568588, -185.4799210652709, -22.930513359606266, -57.00650991499424, -92.96321851015091, -48.59909735620022, -49.227458760142326, -92.0102159306407, -125.83561702817678, -115.94644241034985, 1.755875438451767, -282.8329567760229, -90.74993028491735, -152.29789335280657, -61.8308272883296, -2.0169317573308945, -68.36390362679958, -157.97685627639294, -113.84321580827236, -168.8028742671013, -52.79999979585409, -10.670045137405396, -208.102618008852, -134.0713912025094, -161.52541875839233, -53.27784235030413, -44.83668917417526, -132.07872917503119, -99.07824406027794, 932.5059405043721, -57.48188501596451, -50.224578723311424, -137.98100940138102, -3.7494263350963593, -49.928268887102604, 942.4120050743222, -96.22457855194807, -27.250415228307247, -69.06075600534678, -117.56056555360556, -43.2856295183301, -103.38202650845051, -62.600228041410446, -82.38887958973646, -169.70033250004053, -6.593680202960968, -42.97632475942373, -75.5464424714446, -30.928197599947453, -39.985877223312855, -82.64763359725475, -37.67168618738651], "episode_lengths": [333, 255, 215, 259, 227, 268, 227, 228, 214, 242, 205, 347, 248, 242, 235, 240, 255, 268, 254, 232, 309, 239, 231, 224, 234, 250, 228, 228, 244, 223, 256, 270, 254, 436, 304, 210, 219, 249, 228, 235, 224, 237, 278, 273, 220, 239, 237, 304, 262, 320, 232, 262, 268, 251, 250, 264, 275, 288, 227, 353, 249, 295, 256, 220, 257, 280, 267, 292, 231, 226, 322, 275, 309, 248, 246, 269, 264, 260, 256, 240, 291, 225, 235, 211, 253, 238, 251, 263, 240, 270, 242, 253, 307, 224, 252, 250, 230, 238, 258, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5886712218892078, "mean_inference_ms": 7.344881263909143, "mean_action_processing_ms": 0.1213464997220823, "mean_env_wait_ms": 4.707749926952921, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 942.4120050743222, "episode_reward_min": -502.06852620095015, "episode_reward_mean": -58.09604353390634, "episode_len_mean": 255.46, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-240.02786161005497, -80.5197031646967, -1.132737047970295, -90.92655620723963, -7.447830781340599, -75.81994104385376, -31.003208488225937, -14.611358635127544, 12.757340095937252, -20.691587775945663, 8.631517149508, -296.02029640227556, -57.383462972939014, -23.86286461353302, -17.48755945265293, -40.878729201853275, -81.26771503686905, -94.58304488658905, -79.57738910615444, -35.029439844191074, -241.088024482131, -44.07824418693781, -32.233639404177666, 5.518546983599663, -12.579828023910522, -48.35258340835571, -16.15041532367468, -33.76809383183718, -30.1709887906909, -16.624981455504894, -81.3213892057538, -117.74385786056519, -87.87614447623491, -502.06852620095015, -159.74518470466137, 19.710686542093754, -19.90975935012102, -37.63690038770437, -41.57168619334698, -58.29999993741512, -8.857208244502544, -45.339780017733574, -139.5329476967454, -100.22514820843935, -5.913943484425545, -76.66321504861116, -61.76105070859194, -164.45334351062775, -88.33431142568588, -185.4799210652709, -22.930513359606266, -57.00650991499424, -92.96321851015091, -48.59909735620022, -49.227458760142326, -92.0102159306407, -125.83561702817678, -115.94644241034985, 1.755875438451767, -282.8329567760229, -90.74993028491735, -152.29789335280657, -61.8308272883296, -2.0169317573308945, -68.36390362679958, -157.97685627639294, -113.84321580827236, -168.8028742671013, -52.79999979585409, -10.670045137405396, -208.102618008852, -134.0713912025094, -161.52541875839233, -53.27784235030413, -44.83668917417526, -132.07872917503119, -99.07824406027794, 932.5059405043721, -57.48188501596451, -50.224578723311424, -137.98100940138102, -3.7494263350963593, -49.928268887102604, 942.4120050743222, -96.22457855194807, -27.250415228307247, -69.06075600534678, -117.56056555360556, -43.2856295183301, -103.38202650845051, -62.600228041410446, -82.38887958973646, -169.70033250004053, -6.593680202960968, -42.97632475942373, -75.5464424714446, -30.928197599947453, -39.985877223312855, -82.64763359725475, -37.67168618738651], "episode_lengths": [333, 255, 215, 259, 227, 268, 227, 228, 214, 242, 205, 347, 248, 242, 235, 240, 255, 268, 254, 232, 309, 239, 231, 224, 234, 250, 228, 228, 244, 223, 256, 270, 254, 436, 304, 210, 219, 249, 228, 235, 224, 237, 278, 273, 220, 239, 237, 304, 262, 320, 232, 262, 268, 251, 250, 264, 275, 288, 227, 353, 249, 295, 256, 220, 257, 280, 267, 292, 231, 226, 322, 275, 309, 248, 246, 269, 264, 260, 256, 240, 291, 225, 235, 211, 253, 238, 251, 263, 240, 270, 242, 253, 307, 224, 252, 250, 230, 238, 258, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5886712218892078, "mean_inference_ms": 7.344881263909143, "mean_action_processing_ms": 0.1213464997220823, "mean_env_wait_ms": 4.707749926952921, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 84000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 26320.671, "learn_time_ms": 22758.492, "learn_throughput": 175.759, "update_time_ms": 26.958}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 318, "training_iteration": 21, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-37-22", "timestamp": 1655537842, "time_this_iter_s": 26.520365476608276, "time_total_s": 553.9342064857483, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 553.9342064857483, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 27.908108108108106, "ram_util_percent": 63.19459459459458}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.252736568450928, "policy_loss": -0.12367740273475647, "vf_loss": 6.338279724121094, "vf_explained_var": 0.06852646172046661, "kl": 0.016948483884334564, "entropy": 1.8944627046585083, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 942.4120050743222, "episode_reward_min": -502.06852620095015, "episode_reward_mean": -55.599933698326346, "episode_len_mean": 253.65, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-81.26771503686905, -94.58304488658905, -79.57738910615444, -35.029439844191074, -241.088024482131, -44.07824418693781, -32.233639404177666, 5.518546983599663, -12.579828023910522, -48.35258340835571, -16.15041532367468, -33.76809383183718, -30.1709887906909, -16.624981455504894, -81.3213892057538, -117.74385786056519, -87.87614447623491, -502.06852620095015, -159.74518470466137, 19.710686542093754, -19.90975935012102, -37.63690038770437, -41.57168619334698, -58.29999993741512, -8.857208244502544, -45.339780017733574, -139.5329476967454, -100.22514820843935, -5.913943484425545, -76.66321504861116, -61.76105070859194, -164.45334351062775, -88.33431142568588, -185.4799210652709, -22.930513359606266, -57.00650991499424, -92.96321851015091, -48.59909735620022, -49.227458760142326, -92.0102159306407, -125.83561702817678, -115.94644241034985, 1.755875438451767, -282.8329567760229, -90.74993028491735, -152.29789335280657, -61.8308272883296, -2.0169317573308945, -68.36390362679958, -157.97685627639294, -113.84321580827236, -168.8028742671013, -52.79999979585409, -10.670045137405396, -208.102618008852, -134.0713912025094, -161.52541875839233, -53.27784235030413, -44.83668917417526, -132.07872917503119, -99.07824406027794, 932.5059405043721, -57.48188501596451, -50.224578723311424, -137.98100940138102, -3.7494263350963593, -49.928268887102604, 942.4120050743222, -96.22457855194807, -27.250415228307247, -69.06075600534678, -117.56056555360556, -43.2856295183301, -103.38202650845051, -62.600228041410446, -82.38887958973646, -169.70033250004053, -6.593680202960968, -42.97632475942373, -75.5464424714446, -30.928197599947453, -39.985877223312855, -82.64763359725475, -37.67168618738651, -53.59999992698431, -22.323675893247128, -9.901733838021755, 12.644139289855957, -137.52745847404003, -8.763332337141037, -15.970973707735538, -61.814660251140594, -0.6080660223960876, 2.2155101746320724, -27.486780121922493, -115.97168607264757, -179.53106570243835, 20.235896833240986, -32.73521412909031, -95.67475641518831], "episode_lengths": [255, 268, 254, 232, 309, 239, 231, 224, 234, 250, 228, 228, 244, 223, 256, 270, 254, 436, 304, 210, 219, 249, 228, 235, 224, 237, 278, 273, 220, 239, 237, 304, 262, 320, 232, 262, 268, 251, 250, 264, 275, 288, 227, 353, 249, 295, 256, 220, 257, 280, 267, 292, 231, 226, 322, 275, 309, 248, 246, 269, 264, 260, 256, 240, 291, 225, 235, 211, 253, 238, 251, 263, 240, 270, 242, 253, 307, 224, 252, 250, 230, 238, 258, 224, 226, 233, 234, 205, 280, 216, 220, 255, 227, 216, 231, 264, 303, 211, 224, 259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5890083851938513, "mean_inference_ms": 7.345097456209305, "mean_action_processing_ms": 0.12118545685280999, "mean_env_wait_ms": 4.704488591024057, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 942.4120050743222, "episode_reward_min": -502.06852620095015, "episode_reward_mean": -55.599933698326346, "episode_len_mean": 253.65, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-81.26771503686905, -94.58304488658905, -79.57738910615444, -35.029439844191074, -241.088024482131, -44.07824418693781, -32.233639404177666, 5.518546983599663, -12.579828023910522, -48.35258340835571, -16.15041532367468, -33.76809383183718, -30.1709887906909, -16.624981455504894, -81.3213892057538, -117.74385786056519, -87.87614447623491, -502.06852620095015, -159.74518470466137, 19.710686542093754, -19.90975935012102, -37.63690038770437, -41.57168619334698, -58.29999993741512, -8.857208244502544, -45.339780017733574, -139.5329476967454, -100.22514820843935, -5.913943484425545, -76.66321504861116, -61.76105070859194, -164.45334351062775, -88.33431142568588, -185.4799210652709, -22.930513359606266, -57.00650991499424, -92.96321851015091, -48.59909735620022, -49.227458760142326, -92.0102159306407, -125.83561702817678, -115.94644241034985, 1.755875438451767, -282.8329567760229, -90.74993028491735, -152.29789335280657, -61.8308272883296, -2.0169317573308945, -68.36390362679958, -157.97685627639294, -113.84321580827236, -168.8028742671013, -52.79999979585409, -10.670045137405396, -208.102618008852, -134.0713912025094, -161.52541875839233, -53.27784235030413, -44.83668917417526, -132.07872917503119, -99.07824406027794, 932.5059405043721, -57.48188501596451, -50.224578723311424, -137.98100940138102, -3.7494263350963593, -49.928268887102604, 942.4120050743222, -96.22457855194807, -27.250415228307247, -69.06075600534678, -117.56056555360556, -43.2856295183301, -103.38202650845051, -62.600228041410446, -82.38887958973646, -169.70033250004053, -6.593680202960968, -42.97632475942373, -75.5464424714446, -30.928197599947453, -39.985877223312855, -82.64763359725475, -37.67168618738651, -53.59999992698431, -22.323675893247128, -9.901733838021755, 12.644139289855957, -137.52745847404003, -8.763332337141037, -15.970973707735538, -61.814660251140594, -0.6080660223960876, 2.2155101746320724, -27.486780121922493, -115.97168607264757, -179.53106570243835, 20.235896833240986, -32.73521412909031, -95.67475641518831], "episode_lengths": [255, 268, 254, 232, 309, 239, 231, 224, 234, 250, 228, 228, 244, 223, 256, 270, 254, 436, 304, 210, 219, 249, 228, 235, 224, 237, 278, 273, 220, 239, 237, 304, 262, 320, 232, 262, 268, 251, 250, 264, 275, 288, 227, 353, 249, 295, 256, 220, 257, 280, 267, 292, 231, 226, 322, 275, 309, 248, 246, 269, 264, 260, 256, 240, 291, 225, 235, 211, 253, 238, 251, 263, 240, 270, 242, 253, 307, 224, 252, 250, 230, 238, 258, 224, 226, 233, 234, 205, 280, 216, 220, 255, 227, 216, 231, 264, 303, 211, 224, 259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5890083851938513, "mean_inference_ms": 7.345097456209305, "mean_action_processing_ms": 0.12118545685280999, "mean_env_wait_ms": 4.704488591024057, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 88000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 26337.314, "learn_time_ms": 22769.937, "learn_throughput": 175.67, "update_time_ms": 26.958}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 334, "training_iteration": 22, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-37-48", "timestamp": 1655537868, "time_this_iter_s": 26.358415842056274, "time_total_s": 580.2926223278046, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 580.2926223278046, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 27.66756756756757, "ram_util_percent": 63.24054054054053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 5.822169780731201, "policy_loss": -0.12371058762073517, "vf_loss": 5.905806064605713, "vf_explained_var": 0.2522488832473755, "kl": 0.017810937017202377, "entropy": 1.887407898902893, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 942.4120050743222, "episode_reward_min": -502.06852620095015, "episode_reward_mean": -55.484549630656836, "episode_len_mean": 254.34, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.74385786056519, -87.87614447623491, -502.06852620095015, -159.74518470466137, 19.710686542093754, -19.90975935012102, -37.63690038770437, -41.57168619334698, -58.29999993741512, -8.857208244502544, -45.339780017733574, -139.5329476967454, -100.22514820843935, -5.913943484425545, -76.66321504861116, -61.76105070859194, -164.45334351062775, -88.33431142568588, -185.4799210652709, -22.930513359606266, -57.00650991499424, -92.96321851015091, -48.59909735620022, -49.227458760142326, -92.0102159306407, -125.83561702817678, -115.94644241034985, 1.755875438451767, -282.8329567760229, -90.74993028491735, -152.29789335280657, -61.8308272883296, -2.0169317573308945, -68.36390362679958, -157.97685627639294, -113.84321580827236, -168.8028742671013, -52.79999979585409, -10.670045137405396, -208.102618008852, -134.0713912025094, -161.52541875839233, -53.27784235030413, -44.83668917417526, -132.07872917503119, -99.07824406027794, 932.5059405043721, -57.48188501596451, -50.224578723311424, -137.98100940138102, -3.7494263350963593, -49.928268887102604, 942.4120050743222, -96.22457855194807, -27.250415228307247, -69.06075600534678, -117.56056555360556, -43.2856295183301, -103.38202650845051, -62.600228041410446, -82.38887958973646, -169.70033250004053, -6.593680202960968, -42.97632475942373, -75.5464424714446, -30.928197599947453, -39.985877223312855, -82.64763359725475, -37.67168618738651, -53.59999992698431, -22.323675893247128, -9.901733838021755, 12.644139289855957, -137.52745847404003, -8.763332337141037, -15.970973707735538, -61.814660251140594, -0.6080660223960876, 2.2155101746320724, -27.486780121922493, -115.97168607264757, -179.53106570243835, 20.235896833240986, -32.73521412909031, -95.67475641518831, -4.033943675458431, -155.29733990877867, -37.02943988889456, -105.47692404687405, -51.15966300666332, -59.201927810907364, -83.12745872884989, -115.08936461061239, 11.083176650106907, -24.6680938154459, -90.03322257846594, -63.86550913751125, 7.836053602397442, -57.367191165685654, -2.337975114583969], "episode_lengths": [270, 254, 436, 304, 210, 219, 249, 228, 235, 224, 237, 278, 273, 220, 239, 237, 304, 262, 320, 232, 262, 268, 251, 250, 264, 275, 288, 227, 353, 249, 295, 256, 220, 257, 280, 267, 292, 231, 226, 322, 275, 309, 248, 246, 269, 264, 260, 256, 240, 291, 225, 235, 211, 253, 238, 251, 263, 240, 270, 242, 253, 307, 224, 252, 250, 230, 238, 258, 224, 226, 233, 234, 205, 280, 216, 220, 255, 227, 216, 231, 264, 303, 211, 224, 259, 237, 307, 242, 285, 248, 245, 259, 259, 205, 229, 256, 245, 234, 264, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5907349135332225, "mean_inference_ms": 7.346182323648101, "mean_action_processing_ms": 0.1211087963221816, "mean_env_wait_ms": 4.70535024832603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 942.4120050743222, "episode_reward_min": -502.06852620095015, "episode_reward_mean": -55.484549630656836, "episode_len_mean": 254.34, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.74385786056519, -87.87614447623491, -502.06852620095015, -159.74518470466137, 19.710686542093754, -19.90975935012102, -37.63690038770437, -41.57168619334698, -58.29999993741512, -8.857208244502544, -45.339780017733574, -139.5329476967454, -100.22514820843935, -5.913943484425545, -76.66321504861116, -61.76105070859194, -164.45334351062775, -88.33431142568588, -185.4799210652709, -22.930513359606266, -57.00650991499424, -92.96321851015091, -48.59909735620022, -49.227458760142326, -92.0102159306407, -125.83561702817678, -115.94644241034985, 1.755875438451767, -282.8329567760229, -90.74993028491735, -152.29789335280657, -61.8308272883296, -2.0169317573308945, -68.36390362679958, -157.97685627639294, -113.84321580827236, -168.8028742671013, -52.79999979585409, -10.670045137405396, -208.102618008852, -134.0713912025094, -161.52541875839233, -53.27784235030413, -44.83668917417526, -132.07872917503119, -99.07824406027794, 932.5059405043721, -57.48188501596451, -50.224578723311424, -137.98100940138102, -3.7494263350963593, -49.928268887102604, 942.4120050743222, -96.22457855194807, -27.250415228307247, -69.06075600534678, -117.56056555360556, -43.2856295183301, -103.38202650845051, -62.600228041410446, -82.38887958973646, -169.70033250004053, -6.593680202960968, -42.97632475942373, -75.5464424714446, -30.928197599947453, -39.985877223312855, -82.64763359725475, -37.67168618738651, -53.59999992698431, -22.323675893247128, -9.901733838021755, 12.644139289855957, -137.52745847404003, -8.763332337141037, -15.970973707735538, -61.814660251140594, -0.6080660223960876, 2.2155101746320724, -27.486780121922493, -115.97168607264757, -179.53106570243835, 20.235896833240986, -32.73521412909031, -95.67475641518831, -4.033943675458431, -155.29733990877867, -37.02943988889456, -105.47692404687405, -51.15966300666332, -59.201927810907364, -83.12745872884989, -115.08936461061239, 11.083176650106907, -24.6680938154459, -90.03322257846594, -63.86550913751125, 7.836053602397442, -57.367191165685654, -2.337975114583969], "episode_lengths": [270, 254, 436, 304, 210, 219, 249, 228, 235, 224, 237, 278, 273, 220, 239, 237, 304, 262, 320, 232, 262, 268, 251, 250, 264, 275, 288, 227, 353, 249, 295, 256, 220, 257, 280, 267, 292, 231, 226, 322, 275, 309, 248, 246, 269, 264, 260, 256, 240, 291, 225, 235, 211, 253, 238, 251, 263, 240, 270, 242, 253, 307, 224, 252, 250, 230, 238, 258, 224, 226, 233, 234, 205, 280, 216, 220, 255, 227, 216, 231, 264, 303, 211, 224, 259, 237, 307, 242, 285, 248, 245, 259, 259, 205, 229, 256, 245, 234, 264, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5907349135332225, "mean_inference_ms": 7.346182323648101, "mean_action_processing_ms": 0.1211087963221816, "mean_env_wait_ms": 4.70535024832603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 92000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 26348.433, "learn_time_ms": 22789.253, "learn_throughput": 175.521, "update_time_ms": 26.958}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 349, "training_iteration": 23, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-38-15", "timestamp": 1655537895, "time_this_iter_s": 26.444758415222168, "time_total_s": 606.7373807430267, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 606.7373807430267, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 28.0027027027027, "ram_util_percent": 63.227027027027006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 6.597018241882324, "policy_loss": -0.14714284241199493, "vf_loss": 6.702855110168457, "vf_explained_var": 0.08226342499256134, "kl": 0.01835828647017479, "entropy": 1.8852444887161255, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 942.4120050743222, "episode_reward_min": -308.8163235336542, "episode_reward_mean": -51.867912253215906, "episode_len_mean": 253.45, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-164.45334351062775, -88.33431142568588, -185.4799210652709, -22.930513359606266, -57.00650991499424, -92.96321851015091, -48.59909735620022, -49.227458760142326, -92.0102159306407, -125.83561702817678, -115.94644241034985, 1.755875438451767, -282.8329567760229, -90.74993028491735, -152.29789335280657, -61.8308272883296, -2.0169317573308945, -68.36390362679958, -157.97685627639294, -113.84321580827236, -168.8028742671013, -52.79999979585409, -10.670045137405396, -208.102618008852, -134.0713912025094, -161.52541875839233, -53.27784235030413, -44.83668917417526, -132.07872917503119, -99.07824406027794, 932.5059405043721, -57.48188501596451, -50.224578723311424, -137.98100940138102, -3.7494263350963593, -49.928268887102604, 942.4120050743222, -96.22457855194807, -27.250415228307247, -69.06075600534678, -117.56056555360556, -43.2856295183301, -103.38202650845051, -62.600228041410446, -82.38887958973646, -169.70033250004053, -6.593680202960968, -42.97632475942373, -75.5464424714446, -30.928197599947453, -39.985877223312855, -82.64763359725475, -37.67168618738651, -53.59999992698431, -22.323675893247128, -9.901733838021755, 12.644139289855957, -137.52745847404003, -8.763332337141037, -15.970973707735538, -61.814660251140594, -0.6080660223960876, 2.2155101746320724, -27.486780121922493, -115.97168607264757, -179.53106570243835, 20.235896833240986, -32.73521412909031, -95.67475641518831, -4.033943675458431, -155.29733990877867, -37.02943988889456, -105.47692404687405, -51.15966300666332, -59.201927810907364, -83.12745872884989, -115.08936461061239, 11.083176650106907, -24.6680938154459, -90.03322257846594, -63.86550913751125, 7.836053602397442, -57.367191165685654, -2.337975114583969, -5.08070657402277, -5.234067887067795, -106.99245282262564, -0.961050733923912, -94.17042832821608, -23.281609259545803, -51.79506742209196, -66.80000015348196, -64.683044873178, -21.006035916507244, -44.489364601671696, -107.90690027177334, -308.8163235336542, -9.01951701939106, -33.63435895740986, -137.8999998793006], "episode_lengths": [304, 262, 320, 232, 262, 268, 251, 250, 264, 275, 288, 227, 353, 249, 295, 256, 220, 257, 280, 267, 292, 231, 226, 322, 275, 309, 248, 246, 269, 264, 260, 256, 240, 291, 225, 235, 211, 253, 238, 251, 263, 240, 270, 242, 253, 307, 224, 252, 250, 230, 238, 258, 224, 226, 233, 234, 205, 280, 216, 220, 255, 227, 216, 231, 264, 303, 211, 224, 259, 237, 307, 242, 285, 248, 245, 259, 259, 205, 229, 256, 245, 234, 264, 229, 225, 224, 282, 217, 267, 229, 246, 249, 251, 235, 237, 250, 362, 232, 239, 279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.591888098515652, "mean_inference_ms": 7.3448365731255, "mean_action_processing_ms": 0.12091235937919205, "mean_env_wait_ms": 4.711779301469732, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 942.4120050743222, "episode_reward_min": -308.8163235336542, "episode_reward_mean": -51.867912253215906, "episode_len_mean": 253.45, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-164.45334351062775, -88.33431142568588, -185.4799210652709, -22.930513359606266, -57.00650991499424, -92.96321851015091, -48.59909735620022, -49.227458760142326, -92.0102159306407, -125.83561702817678, -115.94644241034985, 1.755875438451767, -282.8329567760229, -90.74993028491735, -152.29789335280657, -61.8308272883296, -2.0169317573308945, -68.36390362679958, -157.97685627639294, -113.84321580827236, -168.8028742671013, -52.79999979585409, -10.670045137405396, -208.102618008852, -134.0713912025094, -161.52541875839233, -53.27784235030413, -44.83668917417526, -132.07872917503119, -99.07824406027794, 932.5059405043721, -57.48188501596451, -50.224578723311424, -137.98100940138102, -3.7494263350963593, -49.928268887102604, 942.4120050743222, -96.22457855194807, -27.250415228307247, -69.06075600534678, -117.56056555360556, -43.2856295183301, -103.38202650845051, -62.600228041410446, -82.38887958973646, -169.70033250004053, -6.593680202960968, -42.97632475942373, -75.5464424714446, -30.928197599947453, -39.985877223312855, -82.64763359725475, -37.67168618738651, -53.59999992698431, -22.323675893247128, -9.901733838021755, 12.644139289855957, -137.52745847404003, -8.763332337141037, -15.970973707735538, -61.814660251140594, -0.6080660223960876, 2.2155101746320724, -27.486780121922493, -115.97168607264757, -179.53106570243835, 20.235896833240986, -32.73521412909031, -95.67475641518831, -4.033943675458431, -155.29733990877867, -37.02943988889456, -105.47692404687405, -51.15966300666332, -59.201927810907364, -83.12745872884989, -115.08936461061239, 11.083176650106907, -24.6680938154459, -90.03322257846594, -63.86550913751125, 7.836053602397442, -57.367191165685654, -2.337975114583969, -5.08070657402277, -5.234067887067795, -106.99245282262564, -0.961050733923912, -94.17042832821608, -23.281609259545803, -51.79506742209196, -66.80000015348196, -64.683044873178, -21.006035916507244, -44.489364601671696, -107.90690027177334, -308.8163235336542, -9.01951701939106, -33.63435895740986, -137.8999998793006], "episode_lengths": [304, 262, 320, 232, 262, 268, 251, 250, 264, 275, 288, 227, 353, 249, 295, 256, 220, 257, 280, 267, 292, 231, 226, 322, 275, 309, 248, 246, 269, 264, 260, 256, 240, 291, 225, 235, 211, 253, 238, 251, 263, 240, 270, 242, 253, 307, 224, 252, 250, 230, 238, 258, 224, 226, 233, 234, 205, 280, 216, 220, 255, 227, 216, 231, 264, 303, 211, 224, 259, 237, 307, 242, 285, 248, 245, 259, 259, 205, 229, 256, 245, 234, 264, 229, 225, 224, 282, 217, 267, 229, 246, 249, 251, 235, 237, 250, 362, 232, 239, 279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.591888098515652, "mean_inference_ms": 7.3448365731255, "mean_action_processing_ms": 0.12091235937919205, "mean_env_wait_ms": 4.711779301469732, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 96000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 26380.33, "learn_time_ms": 22798.061, "learn_throughput": 175.454, "update_time_ms": 27.058}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 365, "training_iteration": 24, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-38-41", "timestamp": 1655537921, "time_this_iter_s": 26.46170449256897, "time_total_s": 633.1990852355957, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 633.1990852355957, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 27.305405405405406, "ram_util_percent": 62.91891891891893}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.25, "cur_lr": 0.0007999999797903001, "total_loss": 7.03702449798584, "policy_loss": -0.14130926132202148, "vf_loss": 7.13379430770874, "vf_explained_var": 0.1626623123884201, "kl": 0.019795307889580727, "entropy": 1.863422155380249, "entropy_coeff": 0.0}, "custom_metrics": {}, "num_agent_steps_trained": 250.0}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 942.4120050743222, "episode_reward_min": -308.8163235336542, "episode_reward_mean": -49.97330883525312, "episode_len_mean": 251.51, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-68.36390362679958, -157.97685627639294, -113.84321580827236, -168.8028742671013, -52.79999979585409, -10.670045137405396, -208.102618008852, -134.0713912025094, -161.52541875839233, -53.27784235030413, -44.83668917417526, -132.07872917503119, -99.07824406027794, 932.5059405043721, -57.48188501596451, -50.224578723311424, -137.98100940138102, -3.7494263350963593, -49.928268887102604, 942.4120050743222, -96.22457855194807, -27.250415228307247, -69.06075600534678, -117.56056555360556, -43.2856295183301, -103.38202650845051, -62.600228041410446, -82.38887958973646, -169.70033250004053, -6.593680202960968, -42.97632475942373, -75.5464424714446, -30.928197599947453, -39.985877223312855, -82.64763359725475, -37.67168618738651, -53.59999992698431, -22.323675893247128, -9.901733838021755, 12.644139289855957, -137.52745847404003, -8.763332337141037, -15.970973707735538, -61.814660251140594, -0.6080660223960876, 2.2155101746320724, -27.486780121922493, -115.97168607264757, -179.53106570243835, 20.235896833240986, -32.73521412909031, -95.67475641518831, -4.033943675458431, -155.29733990877867, -37.02943988889456, -105.47692404687405, -51.15966300666332, -59.201927810907364, -83.12745872884989, -115.08936461061239, 11.083176650106907, -24.6680938154459, -90.03322257846594, -63.86550913751125, 7.836053602397442, -57.367191165685654, -2.337975114583969, -5.08070657402277, -5.234067887067795, -106.99245282262564, -0.961050733923912, -94.17042832821608, -23.281609259545803, -51.79506742209196, -66.80000015348196, -64.683044873178, -21.006035916507244, -44.489364601671696, -107.90690027177334, -308.8163235336542, -9.01951701939106, -33.63435895740986, -137.8999998793006, -64.13435909152031, -17.026556007564068, -31.460338331758976, -95.78936470299959, -156.24491763859987, -31.725957289338112, -155.24554001539946, -220.15133477002382, -10.418262615799904, -174.39799484610558, -133.69999968260527, -18.906580589711666, 6.559539407491684, -0.21330618858337402, -57.64194767177105, -219.76014825701714, -61.04190320521593], "episode_lengths": [257, 280, 267, 292, 231, 226, 322, 275, 309, 248, 246, 269, 264, 260, 256, 240, 291, 225, 235, 211, 253, 238, 251, 263, 240, 270, 242, 253, 307, 224, 252, 250, 230, 238, 258, 224, 226, 233, 234, 205, 280, 216, 220, 255, 227, 216, 231, 264, 303, 211, 224, 259, 237, 307, 242, 285, 248, 245, 259, 259, 205, 229, 256, 245, 234, 264, 229, 225, 224, 282, 217, 267, 229, 246, 249, 251, 235, 237, 250, 362, 232, 239, 279, 255, 232, 229, 256, 293, 247, 293, 314, 233, 312, 277, 221, 214, 216, 252, 303, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5935480729788051, "mean_inference_ms": 7.344663162527995, "mean_action_processing_ms": 0.12079083527287297, "mean_env_wait_ms": 4.716937021799896, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 942.4120050743222, "episode_reward_min": -308.8163235336542, "episode_reward_mean": -49.97330883525312, "episode_len_mean": 251.51, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-68.36390362679958, -157.97685627639294, -113.84321580827236, -168.8028742671013, -52.79999979585409, -10.670045137405396, -208.102618008852, -134.0713912025094, -161.52541875839233, -53.27784235030413, -44.83668917417526, -132.07872917503119, -99.07824406027794, 932.5059405043721, -57.48188501596451, -50.224578723311424, -137.98100940138102, -3.7494263350963593, -49.928268887102604, 942.4120050743222, -96.22457855194807, -27.250415228307247, -69.06075600534678, -117.56056555360556, -43.2856295183301, -103.38202650845051, -62.600228041410446, -82.38887958973646, -169.70033250004053, -6.593680202960968, -42.97632475942373, -75.5464424714446, -30.928197599947453, -39.985877223312855, -82.64763359725475, -37.67168618738651, -53.59999992698431, -22.323675893247128, -9.901733838021755, 12.644139289855957, -137.52745847404003, -8.763332337141037, -15.970973707735538, -61.814660251140594, -0.6080660223960876, 2.2155101746320724, -27.486780121922493, -115.97168607264757, -179.53106570243835, 20.235896833240986, -32.73521412909031, -95.67475641518831, -4.033943675458431, -155.29733990877867, -37.02943988889456, -105.47692404687405, -51.15966300666332, -59.201927810907364, -83.12745872884989, -115.08936461061239, 11.083176650106907, -24.6680938154459, -90.03322257846594, -63.86550913751125, 7.836053602397442, -57.367191165685654, -2.337975114583969, -5.08070657402277, -5.234067887067795, -106.99245282262564, -0.961050733923912, -94.17042832821608, -23.281609259545803, -51.79506742209196, -66.80000015348196, -64.683044873178, -21.006035916507244, -44.489364601671696, -107.90690027177334, -308.8163235336542, -9.01951701939106, -33.63435895740986, -137.8999998793006, -64.13435909152031, -17.026556007564068, -31.460338331758976, -95.78936470299959, -156.24491763859987, -31.725957289338112, -155.24554001539946, -220.15133477002382, -10.418262615799904, -174.39799484610558, -133.69999968260527, -18.906580589711666, 6.559539407491684, -0.21330618858337402, -57.64194767177105, -219.76014825701714, -61.04190320521593], "episode_lengths": [257, 280, 267, 292, 231, 226, 322, 275, 309, 248, 246, 269, 264, 260, 256, 240, 291, 225, 235, 211, 253, 238, 251, 263, 240, 270, 242, 253, 307, 224, 252, 250, 230, 238, 258, 224, 226, 233, 234, 205, 280, 216, 220, 255, 227, 216, 231, 264, 303, 211, 224, 259, 237, 307, 242, 285, 248, 245, 259, 259, 205, 229, 256, 245, 234, 264, 229, 225, 224, 282, 217, 267, 229, 246, 249, 251, 235, 237, 250, 362, 232, 239, 279, 255, 232, 229, 256, 293, 247, 293, 314, 233, 312, 277, 221, 214, 216, 252, 303, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5935480729788051, "mean_inference_ms": 7.344663162527995, "mean_action_processing_ms": 0.12079083527287297, "mean_env_wait_ms": 4.716937021799896, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 100000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 26406.6, "learn_time_ms": 22813.636, "learn_throughput": 175.334, "update_time_ms": 27.158}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "episodes_total": 382, "training_iteration": 25, "trial_id": "7dfca_00003", "experiment_id": "c940c9a696664778845e63fe574d23dd", "date": "2022-06-18_10-39-08", "timestamp": 1655537948, "time_this_iter_s": 26.51858878135681, "time_total_s": 659.7176740169525, "pid": 55632, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 250, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 0, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": null, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 0, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 1.0, "sgd_minibatch_size": 256, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "lambda": 1.0}, "time_since_restore": 659.7176740169525, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 14.70377802848816, "perf": {"cpu_util_percent": 28.363157894736833, "ram_util_percent": 62.80789473684214}}
