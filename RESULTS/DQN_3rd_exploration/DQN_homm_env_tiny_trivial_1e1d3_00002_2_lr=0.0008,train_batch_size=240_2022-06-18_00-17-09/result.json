{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": 0.14360924065113068, "min_q": -1.4514460563659668, "max_q": 1.820753812789917, "mean_td_error": 0.6228387355804443}, "td_error": [1.7298014163970947, 0.2733191251754761, -0.46688851714134216, 2.833160877227783, 2.4308300018310547, -0.032936155796051025, -6.271026611328125, 1.8607373237609863, 1.2330349683761597, 1.194972276687622, -3.6101222038269043, -0.7774661779403687, -0.10497221350669861, -0.15039314329624176, -0.35105180740356445, 0.733072817325592, -0.5505191087722778, 1.1984890699386597, 0.18024608492851257, 4.392829895019531, -0.08974635601043701, -0.0013511180877685547, -0.28116583824157715, -1.0283124446868896, 0.3921526074409485, 0.8225345611572266, 3.8881938457489014, 2.1840076446533203, 0.9264113306999207, 0.22722457349300385, 0.6552103757858276, 1.434438943862915, -1.095192551612854, 0.6711570024490356, 2.707386016845703, 0.7002216577529907, 0.8893977403640747, 3.0172767639160156, 2.4133496284484863, 1.1161439418792725, 0.16552019119262695, -1.8566956520080566, -1.8299541473388672, 0.9554992914199829, 0.6587879657745361, 2.4582743644714355, 1.0663243532180786, 0.35754525661468506, 1.194972276687622, 0.35099124908447266, -0.9760379195213318, 1.3136425018310547, 0.20658285915851593, 0.29836609959602356, -1.3851290941238403, 2.788590669631958, 1.0350596904754639, 1.7329213619232178, -1.8566956520080566, 2.087679386138916, -0.30909463763237, 0.35110464692115784, 0.4670904278755188, -0.9354698657989502, -0.4090151786804199, 1.0998114347457886, 0.6247196197509766, 2.6730802059173584, -1.0283124446868896, 0.4570966362953186, -0.5505191087722778, 0.48927637934684753, 1.6442455053329468, 0.7565430998802185, 0.9922198057174683, 2.0344343185424805, 0.8691040277481079, 0.3588193356990814, 0.5767356157302856, 4.600953102111816, 0.009897306561470032, 1.7311573028564453, 1.3967560529708862, -0.2979583144187927, -0.10062391310930252, 1.5720462799072266, 0.21510730683803558, 2.4308300018310547, 2.0845022201538086, 0.5304677486419678, -1.2976378202438354, -0.06898017972707748, 0.5819293856620789, 4.093329906463623, -0.4838753342628479, -0.4285958409309387, 2.259234666824341, 1.0367114543914795, 1.2330349683761597, 1.7545480728149414, -0.7808347940444946, 0.9064065217971802, 1.763697862625122, -0.222243994474411, 2.0740668773651123, 0.5229419469833374, 1.2312387228012085, -0.5945069789886475, 0.23224815726280212, 2.087679386138916, 0.5245803594589233, 0.39889633655548096, -1.6170707941055298, 1.3590140342712402, 2.1049764156341553, 0.7412091493606567, 1.0998114347457886, -0.4557584822177887, 1.724413514137268, -0.535059928894043, 0.5802212357521057, 0.21225802600383759, 0.5617417097091675, -6.329071521759033, 0.19041922688484192, 1.4346390962600708, -0.15039314329624176, -0.10497221350669861, 0.7136921286582947, -0.5505191087722778, -0.8136494159698486, -4.222860336303711, 1.6691168546676636, 0.6617164611816406, 7.115863800048828, 4.371710777282715, -0.3661884665489197, -0.10071516036987305, 2.3459360599517822, 2.833160877227783, 0.33821141719818115, 1.9339938163757324, -0.2998966574668884, 0.5617417097091675, 1.6897770166397095, 3.619730234146118, 1.4395697116851807, 1.5609521865844727, 0.23612678050994873, 0.5103256702423096, -1.3697328567504883, 0.19172698259353638, 0.2114628553390503, -0.4474654793739319, 0.18024608492851257, -0.25582781434059143, 4.123716831207275, 2.356354236602783, -0.6181897521018982, 0.7599276900291443, -1.9901459217071533, 0.14797648787498474, 0.9869732856750488, -0.045858681201934814, 0.4276973605155945, 1.0331144332885742, 3.5925960540771484, 1.3701685667037964, -0.7833220958709717, -0.016855835914611816, 2.1840076446533203, -0.3208847939968109, 1.7311573028564453, -0.13091954588890076, -0.12229721248149872, 0.9778570532798767, 0.22590595483779907, 1.7078237533569336, 0.23612678050994873, 0.4880872070789337, 0.9858945608139038, 0.815211832523346, 2.6194729804992676, -0.045858681201934814, 2.7030506134033203, 0.05949293076992035, 1.2886439561843872, 0.15738394856452942, -0.18217545747756958, 0.3588193356990814, -0.29121845960617065, -0.4640735387802124, 0.1767098307609558, 1.6291956901550293, -4.922595977783203, 0.6711570024490356, -2.4726481437683105, 0.31299054622650146, 3.210592746734619, -2.2326183319091797, 1.7078237533569336, 2.456368923187256, -2.3815739154815674, 2.6874594688415527, 1.0787129402160645, 1.5061607360839844, 3.826080322265625, -0.20928838849067688, 0.25055158138275146, 0.8363176584243774, 1.2956023216247559, -1.1845544576644897, 0.3937978148460388, 0.566702127456665, 0.6617164611816406, 0.009230852127075195, 2.1665263175964355, 0.04522627592086792, 1.0787129402160645, -0.5010466575622559, -0.4474654793739319, 0.319368839263916, 1.2205679416656494, 0.289240300655365, 0.11607681959867477, -0.7614193558692932, 1.6983286142349243, 3.0368902683258057, -6.329071521759033, 3.4802663326263428, 1.434438943862915, 0.6650763154029846, -0.09774091839790344, 2.45554256439209, 0.29488450288772583, 0.2530432939529419, 1.5335326194763184, 1.2539913654327393, 0.5252462029457092, -0.24262681603431702], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 240, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 240, "last_target_update_ts": 1024, "num_target_updates": 1}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 240, "num_env_steps_sampled": 1024, "num_env_steps_trained": 240, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 240, "timesteps_total": 1024, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 176.516, "learn_time_ms": 96.954, "learn_throughput": 2475.404, "synch_weights_time_ms": 19.988}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 240, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 240, "last_target_update_ts": 1024, "num_target_updates": 1}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-17-39", "timestamp": 1655500659, "time_this_iter_s": 2.8896212577819824, "time_total_s": 2.8896212577819824, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 2.8896212577819824, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 44.82000000000001, "ram_util_percent": 58.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -2.0680348873138428, "min_q": -3.3279590606689453, "max_q": -0.9309448003768921, "mean_td_error": -0.35312849283218384}, "td_error": [0.22456002235412598, -0.6029152870178223, -0.004010915756225586, 1.880537748336792, -0.7690436840057373, 2.0558457374572754, -0.4069335460662842, 0.0897681713104248, -1.511366367340088, -0.9968435168266296, 0.7413830757141113, -0.7102414965629578, -1.087761402130127, -0.23380720615386963, 0.3036118745803833, 1.8735096454620361, 1.5144879817962646, 0.5154843330383301, 2.1450905799865723, -1.650754690170288, 1.369992733001709, -1.0595760345458984, -6.59495735168457, 0.19695377349853516, -0.7014697790145874, -0.4368792772293091, 0.3254512548446655, -1.7753280401229858, -0.13341474533081055, -0.025228261947631836, -0.12597453594207764, -0.32531046867370605, 1.9968621730804443, -1.6272485256195068, -0.5796666145324707, -5.385519027709961, 0.7413830757141113, 0.6265192031860352, 1.3281457424163818, 1.7863314151763916, -0.09850215911865234, 0.5647830963134766, -0.559323787689209, -0.4622422456741333, -1.1040722131729126, 0.4491572380065918, 0.9852237701416016, -0.05872464179992676, 0.24105679988861084, -1.4792321920394897, -6.01425838470459, -4.912110805511475, 2.1451728343963623, -0.17743229866027832, -0.5560064315795898, 0.15956568717956543, 1.5144879817962646, 1.5791752338409424, 1.532835841178894, 1.1359617710113525, -0.02265489101409912, 0.014389276504516602, 1.4310286045074463, -0.7102414965629578, -0.4597059488296509, 1.7849615812301636, 1.0299842357635498, 0.012930631637573242, -0.012774109840393066, 0.7255345582962036, -0.6038229465484619, -0.3907661437988281, 1.3411381244659424, -1.5831841230392456, -0.6445530652999878, 1.5562725067138672, -0.5444068908691406, -0.02265489101409912, -1.0438547134399414, 0.8190528154373169, -0.536067008972168, 0.5615081787109375, 0.0431060791015625, -1.3043380975723267, 0.3453342914581299, -0.7450544834136963, -0.14432048797607422, 1.405747652053833, 1.7768497467041016, 1.6085513830184937, 0.04868578910827637, -10.34922981262207, -0.5733788013458252, 0.39557182788848877, -0.7102414965629578, -0.6967692375183105, 0.6325781345367432, -0.6316356658935547, 1.017505168914795, 0.14329075813293457, -0.49820446968078613, 1.3194427490234375, 1.5144879817962646, -0.25534236431121826, -0.2058417797088623, -1.3004578351974487, 0.14136993885040283, -0.26464784145355225, -1.5831841230392456, 1.6672077178955078, -0.5925147533416748, -1.4018923044204712, 0.3630943298339844, -4.784816741943359, 1.9261497259140015, -0.34524238109588623, -4.772396087646484, -0.030186891555786133, -0.09850215911865234, -0.8262616991996765, -0.7351773977279663, -1.0438547134399414, -0.6192591190338135, 0.12560486793518066, -0.4536573886871338, -11.442123413085938, -0.34833478927612305, -0.7489383220672607, -11.442123413085938, 1.8375954627990723, 1.6788793802261353, -5.162579536437988, -0.22312402725219727, 0.6047523021697998, -0.23207342624664307, -0.49907147884368896, -0.028508424758911133, -0.9705418348312378, 0.3405630588531494, -0.9689439535140991, -0.15527796745300293, 0.44461965560913086, -1.498313307762146, -0.7102414965629578, -0.13355350494384766, -0.008916378021240234, 1.572002649307251, 0.02866506576538086, -0.6774415969848633, -0.5100481510162354, 1.880537748336792, 2.127004623413086, 1.4190280437469482, 4.418313026428223, -1.3408350944519043, 0.05341029167175293, -5.14886474609375, -0.31403791904449463, -0.6673262119293213, 2.1358628273010254, -0.6967692375183105, -10.34922981262207, -0.256763219833374, 1.4765946865081787, 1.9968621730804443, -6.77789831161499, 0.8980739116668701, 0.03126668930053711, 0.7055153846740723, -0.34239983558654785, 1.5694408416748047, -0.7313336133956909, 0.6191155910491943, 1.3480619192123413, -0.5271724462509155, -0.7938573360443115, -0.6541941165924072, -0.854060173034668, 0.17551302909851074, -0.3467165231704712, 0.15956568717956543, -0.9743898510932922, -0.5606508255004883, -5.14886474609375, 1.7906770706176758, 0.4077742099761963, 0.05090141296386719, 2.191530704498291, -0.8618924617767334, 2.1358628273010254, 0.6296080350875854, -0.6984816789627075, -0.1799710988998413, -0.011908292770385742, -0.3851604461669922, -0.3298764228820801, -0.7099167108535767, -0.1906975507736206, -1.7753280401229858, 0.7255345582962036, -0.445789098739624, 1.680421233177185, -1.1263742446899414, -1.150065302848816, 0.7413830757141113, 1.0247092247009277, 1.7768497467041016, -0.3187817335128784, -0.4371662139892578, -0.8734624981880188, -0.8948325514793396, 0.6777160167694092, 1.3909121751785278, -0.028508424758911133, 1.7351129055023193, 0.11594235897064209, -1.0107722282409668, 1.6251378059387207, -10.34922981262207, 1.7695462703704834, -1.3965377807617188, -0.32531046867370605, -0.6803263425827026, -0.32407712936401367, 1.4190280437469482, 1.3480619192123413, 0.6290040016174316, -6.01425838470459, 1.572002649307251, 0.03294873237609863, -0.8570475578308105, -0.29447805881500244, 0.8639671802520752, -0.751379132270813, -0.08282935619354248, -0.9438398480415344, -1.285844326019287, -0.49907147884368896, 0.17385613918304443, -1.3693032264709473], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 4080, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 4080, "last_target_update_ts": 2048, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 4080, "num_env_steps_sampled": 2048, "num_env_steps_trained": 4080, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 2048, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 293.849, "learn_time_ms": 69.261, "learn_throughput": 3465.157, "synch_weights_time_ms": 19.588}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 4080, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 4080, "last_target_update_ts": 2048, "num_target_updates": 3}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-17-44", "timestamp": 1655500664, "time_this_iter_s": 4.813603162765503, "time_total_s": 7.703224420547485, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 7.703224420547485, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 33.86666666666667, "ram_util_percent": 58.61666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -1.889565348625183, "min_q": -3.390162706375122, "max_q": -0.47777658700942993, "mean_td_error": 0.0016176144126802683}, "td_error": [2.3524975776672363, 0.8331940174102783, 1.4877350330352783, -0.028756022453308105, -0.6421254873275757, -6.490274906158447, -0.8393279314041138, 0.2962750196456909, 0.19972610473632812, -6.101030349731445, -4.630749702453613, -1.0503239631652832, -0.07301115989685059, -0.16291522979736328, -0.3258020877838135, -5.205197334289551, -0.7835763692855835, -0.20291507244110107, -4.622724533081055, -0.0736854076385498, -0.5688481330871582, 2.018810272216797, -0.44988369941711426, 0.30337095260620117, 1.0247209072113037, 0.05276846885681152, -0.5787795782089233, 2.31455659866333, 2.4581875801086426, -0.06556439399719238, -0.3505690097808838, -0.8994543552398682, -4.915536880493164, 0.321138858795166, -0.1360914707183838, 0.5792514085769653, 0.31797051429748535, 1.8868699073791504, 0.735869288444519, -0.7977015972137451, 1.0181550979614258, -1.5522300004959106, -0.5750176906585693, -0.046334922313690186, 0.7298593521118164, -0.13301324844360352, 0.5226227045059204, -0.45485806465148926, -0.0027785301208496094, -0.25332653522491455, 3.0495855808258057, 0.9835600852966309, -0.29235053062438965, 2.209693431854248, -0.04179668426513672, 0.9716494083404541, -0.5667221546173096, -0.32796192169189453, -0.11036145687103271, 2.3699722290039062, -0.4327726364135742, -10.203981399536133, 0.22296011447906494, -0.3424564599990845, 0.6916029453277588, 0.12870478630065918, 0.42952704429626465, 2.0881965160369873, -0.21589994430541992, 0.10616087913513184, 1.744152307510376, 1.361933708190918, 0.7105202674865723, 1.9032855033874512, 2.158690929412842, 2.508812665939331, 0.36394166946411133, -0.7209006547927856, -0.6519412994384766, -6.163753509521484, 0.4064434766769409, 0.3720524311065674, -0.600761890411377, -0.24974429607391357, 0.5104197263717651, 0.12987565994262695, -0.027319669723510742, 2.4581875801086426, 1.005378007888794, 1.8667383193969727, 2.0032200813293457, 1.0181550979614258, 0.21391987800598145, -0.3383883237838745, -4.638335704803467, 0.3114093542098999, -10.534255981445312, 1.0776126384735107, -0.22663891315460205, 0.22594940662384033, -0.1934179663658142, -0.1440730094909668, 1.5888943672180176, 0.8546934127807617, 0.4360954761505127, 2.377408981323242, -0.8745615482330322, 1.3244647979736328, -0.9672728776931763, 0.5542755126953125, 0.7380543947219849, 0.7984895706176758, 0.06473755836486816, 0.46714484691619873, 0.08624053001403809, 2.660965919494629, 1.4659271240234375, 1.4548835754394531, -0.8393279314041138, 0.8987246751785278, -1.5018749237060547, 0.4202917814254761, 0.5118215084075928, -0.3543715476989746, 1.3069379329681396, -6.490274906158447, -4.66663122177124, -0.5280536413192749, 0.5776073932647705, -0.33159685134887695, -0.05100226402282715, 1.6535875797271729, 0.1514517068862915, 0.9716494083404541, 2.212109327316284, 0.4656277894973755, -0.013765573501586914, 1.3089418411254883, 1.9360826015472412, 0.3757338523864746, -0.6513774394989014, -0.9340260028839111, 0.16685843467712402, 0.16977041959762573, 0.3320751190185547, 1.9360826015472412, -0.31739509105682373, 1.2218513488769531, -2.3305938243865967, -0.07765400409698486, -5.019197463989258, -0.5916945934295654, 2.0843029022216797, -0.2439737319946289, 0.9542808532714844, 0.3219432830810547, 0.42262911796569824, -0.5257456302642822, 0.10204052925109863, 1.007714033126831, -0.3258020877838135, 1.5610814094543457, 1.4054527282714844, 2.377408981323242, 0.641756534576416, 2.269739866256714, 0.3915315866470337, 0.5162674188613892, 0.35941559076309204, 0.29623472690582275, 0.71448814868927, -0.41882097721099854, 2.5082497596740723, -0.6842101812362671, -0.25332653522491455, 1.8718594312667847, -10.203981399536133, -0.14060616493225098, -0.7283480167388916, 0.3480663299560547, 0.3681589365005493, -0.3258020877838135, 2.266406536102295, -5.292910099029541, -0.517115592956543, 1.8314616680145264, 0.5955188870429993, -0.05606961250305176, -0.13837802410125732, 0.6776072978973389, 0.3747847080230713, -0.4508986473083496, 0.4821157455444336, 0.5257248878479004, 0.219809889793396, -0.4798617362976074, 2.5027334690093994, 2.6315197944641113, -0.18178105354309082, 0.2465224266052246, -0.6697118282318115, 0.6146939992904663, 2.1952526569366455, -0.34290385246276855, 1.7704665660858154, -1.0503239631652832, 0.2918837070465088, 0.20995676517486572, 1.3604276180267334, -0.05890989303588867, -6.101030349731445, -0.06950855255126953, 2.3461763858795166, -0.4590322971343994, 1.6850926876068115, -0.36402428150177, -1.283566951751709, -1.0704954862594604, -0.5204460620880127, 2.31455659866333, 0.4575023651123047, 2.0074572563171387, 0.7298593521118164, 0.23420989513397217, -0.2291584014892578, -0.0945279598236084, 0.9898245334625244, 2.419776201248169, -0.7718648910522461, 0.22508257627487183, 0.2387007474899292, 0.25086450576782227, 0.6566967964172363, 2.144397020339966, -0.5180511474609375, 0.7450053691864014, -1.211653232574463, -0.42331552505493164, 0.30681073665618896, -0.44560039043426514], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 7920, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 7920, "last_target_update_ts": 3072, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 7920, "num_env_steps_sampled": 3072, "num_env_steps_trained": 7920, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 3072, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 318.317, "learn_time_ms": 70.236, "learn_throughput": 3417.048, "synch_weights_time_ms": 21.085}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 7920, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 7920, "last_target_update_ts": 3072, "num_target_updates": 5}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-17-49", "timestamp": 1655500669, "time_this_iter_s": 4.9585957527160645, "time_total_s": 12.66182017326355, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 12.66182017326355, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 32.614285714285714, "ram_util_percent": 58.91428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -2.142609119415283, "min_q": -4.0719428062438965, "max_q": 0.16493208706378937, "mean_td_error": 0.5450360774993896}, "td_error": [2.7399280071258545, -0.08883357048034668, 2.974580764770508, 0.046590328216552734, -0.025380611419677734, 0.0008789300918579102, -0.16085457801818848, 0.9857884645462036, 0.26572930812835693, -0.5338678359985352, 0.5124764442443848, 2.0246739387512207, 2.276341199874878, 0.8213081359863281, -0.4859030246734619, 1.958881139755249, -0.11649322509765625, 0.05558896064758301, 2.8100826740264893, 0.1971898078918457, 2.3762764930725098, 1.4398173093795776, 0.283721923828125, 0.7746925354003906, 1.7069242000579834, 0.8017014265060425, 0.28380751609802246, 0.3406991958618164, 1.261122226715088, 0.7251905202865601, 0.044133901596069336, 0.7536635398864746, 1.9262056350708008, -0.1790933609008789, 0.47214841842651367, -0.1763761043548584, 1.1721088886260986, 2.425621271133423, -0.5503871440887451, -0.19969773292541504, 1.1973876953125, 2.5018842220306396, 1.311508059501648, 3.0542149543762207, 1.7261929512023926, -0.27068638801574707, 1.624290943145752, 0.23038816452026367, 0.5637695789337158, -0.6360818147659302, 0.5204837322235107, -4.591460704803467, 1.1176265478134155, -0.32912731170654297, 0.10088348388671875, 2.403331995010376, 0.25831377506256104, -0.5886631608009338, 0.38939571380615234, -6.090623378753662, 0.8175318241119385, 0.5956661701202393, 1.8762168884277344, 0.5833648443222046, 0.7837954163551331, 2.56712007522583, -0.3228158950805664, 2.278564214706421, 0.3758087158203125, -0.2321922779083252, 2.7149014472961426, -2.20888614654541, 2.2693369388580322, 1.7001519203186035, -0.09446048736572266, 2.729459285736084, -0.188462495803833, 0.5925464630126953, 0.8664815425872803, -0.2754518985748291, -1.2089507579803467, 0.22809982299804688, 0.009198665618896484, 2.567751884460449, 0.6984598636627197, -0.5801395773887634, 1.2623646259307861, 0.5527932643890381, -0.09006285667419434, -0.32506322860717773, 1.751840353012085, 1.6256020069122314, 2.2647104263305664, -5.311222076416016, -0.5114400386810303, 0.8387324810028076, 2.247727870941162, -0.028363466262817383, -9.852746963500977, 0.2245558500289917, 2.2764906883239746, -0.6023824214935303, 1.8367462158203125, 0.586477518081665, 2.2889881134033203, 1.751840353012085, 0.5982141494750977, 0.42914390563964844, 0.7206711769104004, -6.2114410400390625, -0.48051804304122925, 0.1947622299194336, -5.317677974700928, 2.482625961303711, 0.6781985759735107, -1.2089507579803467, 2.8292179107666016, 2.1116199493408203, -0.5039401054382324, 1.7074801921844482, 1.5098891258239746, 0.2715315818786621, 2.6726837158203125, -0.5954699516296387, 0.08463835716247559, 0.720473051071167, -0.6694245338439941, -0.13889098167419434, -0.24303483963012695, 1.9700901508331299, 1.622511863708496, -1.2582608461380005, 1.1775728464126587, -0.24159860610961914, 1.3724846839904785, 0.1622319221496582, 2.1001639366149902, -0.08208322525024414, 0.36232852935791016, 2.729459285736084, -0.07746076583862305, 1.5967674255371094, 1.9961895942687988, -0.5987410545349121, 1.0644042491912842, 1.0967891216278076, 1.7771530151367188, 0.5605599880218506, 1.769439935684204, -0.1053922176361084, 2.2409706115722656, 0.3306300640106201, -0.27398014068603516, 1.0021718740463257, 0.274672269821167, 0.18650919198989868, 0.7771365642547607, 2.882957935333252, 0.20206284523010254, 1.4398173093795776, 1.8620076179504395, 1.8962208032608032, 1.7803881168365479, 2.2238075733184814, -0.5100013017654419, 1.032748818397522, -4.770586967468262, 1.3164591789245605, 0.27740395069122314, 0.2018263339996338, 2.944697618484497, -0.026080667972564697, 1.1576378345489502, -0.14847159385681152, 2.0162739753723145, 2.6726837158203125, 0.5426480770111084, 2.729459285736084, -0.3993065357208252, -0.21049106121063232, 0.3164355754852295, -0.3434455394744873, -1.076300859451294, 0.3024613857269287, 0.6315568685531616, 0.31384867429733276, -0.33519184589385986, -0.025380611419677734, -0.5182097554206848, 1.8223202228546143, 0.2616117000579834, 0.0115509033203125, 1.113828182220459, 0.6545562148094177, 1.9605860710144043, 0.3306300640106201, 0.2869832515716553, -5.390789031982422, 0.19800353050231934, 2.3288772106170654, -4.887268543243408, -0.04084062576293945, -0.23225760459899902, 0.38157033920288086, 2.482625961303711, -0.23435431718826294, 0.8905093669891357, 2.768470287322998, -0.1809682846069336, 0.26225805282592773, 2.2693369388580322, 0.2961881160736084, 0.21488142013549805, 0.66273033618927, 2.1782422065734863, 1.9816107749938965, -0.2078801989555359, -0.1484508514404297, 2.157078742980957, 0.619426965713501, 0.04247450828552246, 1.8514132499694824, -0.23300862312316895, -0.23300862312316895, -0.22906494140625, -5.1670331954956055, 0.6965497732162476, 0.2252211570739746, -0.4867594242095947, 1.8382625579833984, 2.596771717071533, 1.33311128616333, 0.5961458683013916, -0.5503871440887451, 2.224552631378174, 2.482625961303711, 1.6400198936462402, 0.6232485771179199, 0.19805288314819336, 2.629244565963745], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 11760, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 11760, "last_target_update_ts": 4096, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -55.67789724469185, "episode_reward_mean": -35.817210857756436, "episode_len_mean": 239.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5989244012053375, "mean_inference_ms": 22.474196982290955, "mean_action_processing_ms": 0.14535705866980644, "mean_env_wait_ms": 5.137642881749669, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -55.67789724469185, "episode_reward_mean": -35.817210857756436, "episode_len_mean": 239.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5989244012053375, "mean_inference_ms": 22.474196982290955, "mean_action_processing_ms": 0.14535705866980644, "mean_env_wait_ms": 5.137642881749669, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 11760, "num_env_steps_sampled": 4096, "num_env_steps_trained": 11760, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 4096, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 366.825, "learn_time_ms": 70.367, "learn_throughput": 3410.7, "synch_weights_time_ms": 20.189}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 11760, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 11760, "last_target_update_ts": 4096, "num_target_updates": 7}, "done": false, "episodes_total": 8, "training_iteration": 4, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-17-55", "timestamp": 1655500675, "time_this_iter_s": 5.693281173706055, "time_total_s": 18.355101346969604, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 18.355101346969604, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 45.52222222222222, "ram_util_percent": 59.64444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -2.129655599594116, "min_q": -4.7914137840271, "max_q": 0.7315229177474976, "mean_td_error": -0.05304022505879402}, "td_error": [0.07807467877864838, 2.281848907470703, 1.2675950527191162, -1.0472153425216675, 0.8116036653518677, -0.5472159385681152, -1.6174588203430176, -1.017137050628662, -0.28752851486206055, 0.5056320428848267, 0.24241513013839722, -0.5554153919219971, -0.2018032670021057, 0.8245260715484619, -0.09176620841026306, 0.9250249862670898, 1.9169878959655762, 0.5945475101470947, 1.4485740661621094, -0.30107420682907104, 1.8997297286987305, -0.2328472137451172, -4.198493003845215, -1.0512070655822754, -0.019212961196899414, -0.5852998495101929, -0.8740193843841553, -1.2576613426208496, -6.0765886306762695, -0.5348300933837891, -0.9527138471603394, -0.7024023532867432, 2.4257900714874268, 3.2925782203674316, 0.05058995634317398, 0.3503321409225464, 1.8001363277435303, -0.7124202251434326, 1.0031185150146484, 0.8386886119842529, -0.5643420219421387, -0.7377080917358398, -0.37276530265808105, -1.4678609371185303, -0.11376416683197021, -0.04817080497741699, 1.741150140762329, -0.36808907985687256, -1.780815601348877, 1.1067718267440796, 0.8647568225860596, 2.151364326477051, 1.309581995010376, 0.18155020475387573, -0.12369254231452942, -0.5794687271118164, 1.553804874420166, -0.1990230232477188, -0.9265444278717041, -0.4642035961151123, -0.6890087127685547, 1.356008529663086, 1.4708032608032227, -0.5068671703338623, -2.672602653503418, 0.8217570781707764, 1.6857867240905762, 1.088745355606079, 2.1961727142333984, -0.46122920513153076, 0.6777849197387695, -0.6442511081695557, 0.4214578866958618, 1.004532814025879, -0.48942112922668457, 2.281848907470703, 0.2010267972946167, -0.32491493225097656, -0.6512607336044312, 0.07893526554107666, -5.302026748657227, 1.6094129085540771, 1.165719985961914, 1.0672240257263184, -0.7559170722961426, -0.30340802669525146, 0.013471841812133789, 0.1590437889099121, 0.9870092868804932, 0.40533873438835144, 1.2224200963974, -0.41239333152770996, 0.511250376701355, -1.49286949634552, 1.4644935131072998, 1.215331792831421, 1.2709760665893555, -1.0533391237258911, 2.111335277557373, 0.6519507169723511, -1.2498005628585815, -0.6406389474868774, -1.5406008958816528, 0.28164052963256836, -0.4225426912307739, 0.8865950107574463, -0.8304240703582764, -0.4696301221847534, 2.1166343688964844, -10.54158878326416, -0.41556811332702637, 1.6517410278320312, -0.1390235424041748, 0.9870092868804932, 1.0054023265838623, 0.4590407609939575, 1.5057473182678223, 1.4485740661621094, -0.1990230232477188, 1.1709532737731934, -0.29163050651550293, -0.3103325366973877, -1.0788476467132568, -0.29543066024780273, -0.8711490631103516, 2.273475170135498, -0.6612257957458496, -0.6065418720245361, 2.4742231369018555, 0.09894028306007385, 1.0736744403839111, 1.0748608112335205, 1.573340892791748, 0.10930943489074707, -5.7093186378479, -0.5156691670417786, 1.9826136827468872, -0.5134007930755615, -0.5679607391357422, 1.088745355606079, -1.7148298025131226, 1.8461511135101318, 1.205963373184204, -0.3891482353210449, -0.4935194253921509, 0.9870092868804932, -1.7743515968322754, 2.212883949279785, 0.4146728515625, -0.6560602188110352, 0.4333043098449707, -0.5548405647277832, 1.7246530055999756, -1.1351276636123657, -0.6664533615112305, -0.2118523120880127, 0.25434446334838867, 1.0670411586761475, -1.2682158946990967, 1.3752496242523193, 0.11059451848268509, -0.9713231325149536, -0.7126114368438721, -0.644951343536377, 0.7958254814147949, 0.258220911026001, -1.2247519493103027, -0.1380293369293213, 1.3345766067504883, 0.669517993927002, 1.1017003059387207, -0.7122175693511963, 1.667090892791748, -0.30525684356689453, -0.9778261184692383, 1.2433607578277588, -0.8376072645187378, -0.5826010704040527, 1.1901946067810059, -0.21097183227539062, 1.7823874950408936, 1.4051671028137207, -6.948826313018799, 0.4146728515625, 1.484264612197876, 1.3939473628997803, -0.4752364158630371, 0.30601996183395386, -0.4519655704498291, -1.9460349082946777, 1.5062499046325684, 0.3869185447692871, -5.992316722869873, 0.7521545886993408, -0.06031695008277893, 1.3108642101287842, 0.642796516418457, 0.26093733310699463, -0.9976682662963867, -0.5066689252853394, -0.19560647010803223, -0.34886598587036133, 1.0986557006835938, -1.0273654460906982, 1.2616641521453857, -0.33279287815093994, -0.6380346417427063, 0.5226126909255981, -0.3193974494934082, -0.33279287815093994, -1.1015875339508057, 0.2461235523223877, -4.602949142456055, 2.226670503616333, -0.5355641841888428, 0.08341169357299805, 1.3232817649841309, 0.8732426166534424, 1.5057473182678223, -0.38019394874572754, -0.4748402535915375, -1.4158543348312378, 1.6771998405456543, -0.35515740513801575, 0.05055427551269531, -1.360543131828308, -0.14281582832336426, 0.005255281925201416, -0.5588198900222778, -1.06522798538208, 0.31525707244873047, 1.4108481407165527, -0.933472752571106, -1.2682158946990967, -6.945457458496094, -0.9584310054779053, 0.7432143688201904, -6.0765886306762695, 0.7600717544555664, -1.0685653686523438], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 15600, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 15600, "last_target_update_ts": 5120, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -142.16105076670647, "episode_reward_mean": -62.25029555056244, "episode_len_mean": 252.1875, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5666707051309401, "mean_inference_ms": 22.441443416624836, "mean_action_processing_ms": 0.13845002663352712, "mean_env_wait_ms": 4.8961821410988815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -142.16105076670647, "episode_reward_mean": -62.25029555056244, "episode_len_mean": 252.1875, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5666707051309401, "mean_inference_ms": 22.441443416624836, "mean_action_processing_ms": 0.13845002663352712, "mean_env_wait_ms": 4.8961821410988815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 15600, "num_env_steps_sampled": 5120, "num_env_steps_trained": 15600, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 5120, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 287.063, "learn_time_ms": 68.668, "learn_throughput": 3495.088, "synch_weights_time_ms": 19.689}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 15600, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 15600, "last_target_update_ts": 5120, "num_target_updates": 9}, "done": false, "episodes_total": 16, "training_iteration": 5, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-18-00", "timestamp": 1655500680, "time_this_iter_s": 5.137547254562378, "time_total_s": 23.492648601531982, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 23.492648601531982, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 37.05714285714286, "ram_util_percent": 59.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -2.304934501647949, "min_q": -5.5770392417907715, "max_q": 0.4684922397136688, "mean_td_error": 0.21136002242565155}, "td_error": [-0.6228295564651489, 0.517084002494812, 0.20165514945983887, 0.043178677558898926, 2.000518798828125, -0.7281455993652344, 1.1871428489685059, -0.5916404724121094, 1.749152421951294, -0.7286784648895264, -0.5315810441970825, 1.7848857641220093, 0.6599441766738892, 2.1854681968688965, -0.3738020658493042, 0.445101261138916, 0.1854621171951294, -0.39800697565078735, 0.21113944053649902, -0.08237171173095703, 0.8614687919616699, -0.5726984739303589, -0.17508697509765625, -0.22770297527313232, 0.010904788970947266, 1.4139676094055176, 0.06294143199920654, 2.241720676422119, 1.6405376195907593, -0.3649024963378906, 1.8834364414215088, 1.7249548435211182, -0.6780645847320557, -0.725703239440918, 1.7826318740844727, -0.348746657371521, -0.47477293014526367, 0.7232022285461426, -0.4289510250091553, -4.711462020874023, 0.3342432975769043, -0.5016059875488281, -0.6868319511413574, -0.5826044082641602, 0.09544134140014648, -0.5925383567810059, 1.2787628173828125, 0.23573917150497437, 1.7570295333862305, -0.12501931190490723, -0.4703495502471924, 1.8834364414215088, -0.12814965844154358, 1.094069480895996, -0.04131460189819336, 2.2443394660949707, -0.4790753722190857, 1.0358095169067383, 2.225428581237793, -0.08708477020263672, 2.0377843379974365, 1.2966890335083008, 2.237029552459717, -0.02550482749938965, -0.444277286529541, -0.37267088890075684, -0.5145089626312256, 1.9866321086883545, -4.9329328536987305, -0.2868616580963135, 1.9911751747131348, 0.1727449893951416, -0.010219395160675049, 0.012678861618041992, -0.896390438079834, 0.6130419969558716, 1.4015957117080688, -2.120407819747925, 1.7902672290802002, -1.4219615459442139, 1.3711901903152466, -1.5367951393127441, -0.9459033012390137, 2.0086264610290527, 0.19886529445648193, 2.225428581237793, -0.25862574577331543, 1.2761070728302002, 0.6756794452667236, -0.06580662727355957, 1.4244639873504639, 0.2072659730911255, -0.6235123872756958, 2.0428543090820312, 0.24020648002624512, -5.161294937133789, -1.0710318088531494, 1.248561978340149, -0.04238700866699219, 2.164118766784668, 1.51625394821167, -0.08854639530181885, -0.0719747543334961, 1.6405376195907593, -6.144686698913574, 1.4485180377960205, 0.24308717250823975, -0.06033205986022949, 1.8834364414215088, 2.0428543090820312, -0.7537696361541748, 0.5965337753295898, -5.6180033683776855, -0.6518795490264893, 2.4190163612365723, -0.7102814316749573, 0.25744104385375977, 2.1690549850463867, 0.08351707458496094, -0.02361440658569336, -0.5326694250106812, 1.1171066761016846, 1.4861555099487305, -0.46077704429626465, 1.6940350532531738, 0.0016713142395019531, -6.097221851348877, 0.5255674719810486, 2.0915262699127197, 1.2739367485046387, -0.4704155921936035, 0.22002780437469482, -0.08854639530181885, -0.5619940757751465, 0.1727449893951416, -1.9591262340545654, 1.7561285495758057, -0.17960011959075928, 1.6218082904815674, 0.10387083888053894, -0.6787803173065186, 0.29754638671875, 0.13759279251098633, -0.4173405170440674, -0.48074567317962646, -1.816590666770935, 1.993499517440796, -0.5016059875488281, 0.5413947105407715, 0.29360663890838623, 1.7757530212402344, 1.3059513568878174, 1.823206901550293, -0.23215532302856445, 0.29360663890838623, 2.036905288696289, -0.7150442600250244, 1.8063006401062012, -0.5137968063354492, 0.08576154708862305, -0.28448593616485596, 1.200036644935608, 2.402893543243408, 0.1747327446937561, 0.30061769485473633, -0.8183046579360962, -0.39105796813964844, 0.24509477615356445, 0.6783285140991211, 1.0358095169067383, -0.7398821115493774, 0.09671986103057861, 1.9857068061828613, 0.6664283275604248, 0.2046205997467041, -0.8830327987670898, -1.4445688724517822, 0.20498618483543396, 1.66359281539917, -0.2293834686279297, -1.4219615459442139, -4.99548864364624, 1.650801181793213, 1.1947126388549805, 1.97135329246521, -5.490391731262207, 1.8407607078552246, 0.6622159481048584, -0.9687677621841431, 2.565333843231201, 2.232684373855591, 1.2925355434417725, -0.23040997982025146, -0.1934959888458252, -0.1481151580810547, -0.17525291442871094, 1.901052474975586, -0.7899185419082642, -0.5824073553085327, 1.209413766860962, -0.16086673736572266, 1.12605619430542, -0.8011424541473389, -0.22971129417419434, -0.18727517127990723, -0.44118738174438477, -1.4676164388656616, 1.5834283828735352, -4.697868347167969, -0.7166825532913208, 2.213531494140625, 1.507155418395996, -0.5382652282714844, -0.06746053695678711, -0.9593234658241272, -0.372988224029541, 1.881988525390625, 1.755194902420044, 1.6932944059371948, -7.316410541534424, -0.05818915367126465, 1.4926633834838867, -0.09625637531280518, 0.049370765686035156, 1.2097728252410889, 1.901834487915039, -1.5140798091888428, 1.7105793952941895, -0.34110307693481445, 1.9424095153808594, -0.1816931962966919, 1.1363838911056519, -0.3433917760848999, 0.9999270439147949, 1.5544970035552979, -1.0864782333374023, 1.1507568359375, 1.7605359554290771, 2.1982219219207764, -0.21616220474243164], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 19440, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 19440, "last_target_update_ts": 6144, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -142.16105076670647, "episode_reward_mean": -62.25029555056244, "episode_len_mean": 252.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5666707051309401, "mean_inference_ms": 22.441443416624836, "mean_action_processing_ms": 0.13845002663352712, "mean_env_wait_ms": 4.8961821410988815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -142.16105076670647, "episode_reward_mean": -62.25029555056244, "episode_len_mean": 252.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5666707051309401, "mean_inference_ms": 22.441443416624836, "mean_action_processing_ms": 0.13845002663352712, "mean_env_wait_ms": 4.8961821410988815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 19440, "num_env_steps_sampled": 6144, "num_env_steps_trained": 19440, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 6144, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 297.193, "learn_time_ms": 69.502, "learn_throughput": 3453.119, "synch_weights_time_ms": 19.589}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 19440, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 19440, "last_target_update_ts": 6144, "num_target_updates": 11}, "done": false, "episodes_total": 16, "training_iteration": 6, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-18-05", "timestamp": 1655500685, "time_this_iter_s": 4.733083963394165, "time_total_s": 28.225732564926147, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 28.225732564926147, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 34.714285714285715, "ram_util_percent": 59.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -2.5907809734344482, "min_q": -5.582633972167969, "max_q": 2.215811014175415, "mean_td_error": 0.16853414475917816}, "td_error": [1.3473224639892578, 1.5412790775299072, 0.0009733438491821289, -0.2645833492279053, -0.4225442409515381, 2.206787109375, 0.30225855112075806, -0.3857208490371704, -0.7342734336853027, 0.12504631280899048, -0.16901445388793945, 0.2663841247558594, 2.2767884731292725, -0.4492748975753784, 1.262763500213623, 1.1620655059814453, -0.9871554374694824, -0.04605984687805176, 1.7510385513305664, 1.9411346912384033, 2.002694606781006, 1.21687650680542, -0.853703498840332, -10.452568054199219, -1.1101677417755127, -0.28243565559387207, 0.7287030220031738, 1.6126790046691895, 1.324434757232666, 1.698517084121704, 1.82958984375, -0.12510180473327637, -1.0586440563201904, 1.2204281091690063, -0.5411169528961182, 1.8467342853546143, 1.347855806350708, 1.9960436820983887, -0.876051664352417, 1.1698064804077148, 1.8788495063781738, 1.4652020931243896, -0.21313762664794922, 1.4351139068603516, 0.105995774269104, 0.025131165981292725, 1.2161777019500732, -0.3595151901245117, -1.0350677967071533, -0.25253379344940186, -1.1615681648254395, -0.1317189335823059, -0.8042268753051758, -0.39396190643310547, 0.41030240058898926, 0.1794130802154541, 0.9912471771240234, 0.16681194305419922, 0.23200255632400513, 1.9390950202941895, 1.2204281091690063, -0.820682942867279, 1.6488585472106934, 1.3518662452697754, -0.17569120228290558, -0.759958028793335, -0.8083992004394531, 1.0711917877197266, 2.594628095626831, 1.6863970756530762, 0.951786994934082, -0.1197350025177002, -0.8687150478363037, 1.707183599472046, -0.8077502250671387, -1.0782175064086914, -0.04199683666229248, 1.9141650199890137, -0.6193227767944336, 1.4820268154144287, 0.8946468830108643, 0.9998725652694702, 1.2253551483154297, -0.8083992004394531, 1.4073395729064941, -0.41983461380004883, -0.49454379081726074, -0.429506778717041, 1.4913009405136108, 2.2783429622650146, 0.37263667583465576, -7.732017517089844, -0.3182861804962158, 1.3993444442749023, -0.5057532787322998, -0.7956137657165527, -0.6403446197509766, -0.3580782413482666, 1.0671944618225098, 0.6776367425918579, 0.9364445209503174, 1.8753528594970703, -0.08969593048095703, -0.23624014854431152, 2.4250237941741943, 2.5954582691192627, -0.2055494785308838, -4.734246730804443, -0.13225436210632324, -0.1895442008972168, -0.14907026290893555, 1.235156536102295, 1.3518662452697754, -0.9782233238220215, -0.5331391096115112, 0.995455265045166, -0.5009632110595703, -1.203536033630371, -1.4036767482757568, -0.7939441204071045, -0.7569200992584229, 0.3974735736846924, -0.42470425367355347, -0.9315306544303894, 0.2845726013183594, -0.7493059635162354, 1.3599402904510498, -0.6173126101493835, 1.7969613075256348, -0.5984213352203369, -0.21312332153320312, 2.981379508972168, -0.2802700996398926, -0.8316168189048767, -4.934547424316406, -1.2920674085617065, -1.406616449356079, -1.4498798847198486, 0.08147454261779785, -0.10840779542922974, 1.3951904773712158, 2.459590435028076, -0.6186950206756592, 0.984004020690918, -0.3609621524810791, -0.9287393093109131, 1.4830412864685059, 1.8989291191101074, 0.42110884189605713, -0.6104062795639038, -0.8078980445861816, -0.4511439800262451, 1.8467342853546143, 1.4652020931243896, 1.513284683227539, 0.0790172815322876, -0.7181053161621094, 0.9147458076477051, 1.8929343223571777, -0.2778639793395996, 1.767606258392334, -1.3566608428955078, 1.1323537826538086, -0.5180087685585022, -0.2580285668373108, 0.2298451066017151, 0.0937117338180542, 1.1165170669555664, 1.3090765476226807, -1.1786494255065918, 0.34192562103271484, 1.235156536102295, 1.159620761871338, 1.1759796142578125, -0.6775624752044678, -0.7841269969940186, -0.42374706268310547, -0.7835990190505981, -4.8221540451049805, -0.12510180473327637, 1.8929343223571777, 0.8316583633422852, -0.4851353168487549, -0.2578822374343872, -1.0595502853393555, -0.1402435302734375, -0.6703205704689026, 1.9026060104370117, -0.4658557176589966, -1.0829341411590576, -0.9963312149047852, 2.4665095806121826, 1.3297526836395264, 1.513284683227539, -0.2647765874862671, -0.2832317352294922, -0.1434156894683838, -0.7321436405181885, 0.9236974716186523, -0.8463648557662964, -0.5123475790023804, -0.5411169528961182, -0.9685750007629395, 1.9413518905639648, -0.7792580127716064, 2.0296871662139893, 0.9719436168670654, 0.44185760617256165, -1.655888557434082, -0.16364359855651855, -1.2538537979125977, -0.9059371948242188, 0.614952564239502, 0.1393260955810547, 1.3518662452697754, 0.723872184753418, 1.1212549209594727, 1.5636167526245117, -0.6321887969970703, 0.2973441779613495, 1.4292569160461426, -0.31840991973876953, -0.3218657970428467, 1.316019058227539, -0.9694561958312988, 1.8015251159667969, -0.5925915241241455, -1.7988929748535156, 1.9413518905639648, 0.8376140594482422, 0.059551358222961426, 0.9912471771240234, -0.21756577491760254, 1.1062231063842773, 1.347855806350708, -0.4138089716434479, 1.2833764553070068, -6.65340518951416, 1.8553638458251953, -0.19034266471862793], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 23280, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 23280, "last_target_update_ts": 7168, "num_target_updates": 13}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -142.16105076670647, "episode_reward_mean": -62.25029555056244, "episode_len_mean": 252.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5666707051309401, "mean_inference_ms": 22.441443416624836, "mean_action_processing_ms": 0.13845002663352712, "mean_env_wait_ms": 4.8961821410988815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -142.16105076670647, "episode_reward_mean": -62.25029555056244, "episode_len_mean": 252.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5666707051309401, "mean_inference_ms": 22.441443416624836, "mean_action_processing_ms": 0.13845002663352712, "mean_env_wait_ms": 4.8961821410988815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 23280, "num_env_steps_sampled": 7168, "num_env_steps_trained": 23280, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 7168, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 298.909, "learn_time_ms": 68.468, "learn_throughput": 3505.273, "synch_weights_time_ms": 19.533}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 23280, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 23280, "last_target_update_ts": 7168, "num_target_updates": 13}, "done": false, "episodes_total": 16, "training_iteration": 7, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-18-10", "timestamp": 1655500690, "time_this_iter_s": 4.71671199798584, "time_total_s": 32.94244456291199, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 32.94244456291199, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 31.200000000000003, "ram_util_percent": 59.98333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -3.3895132541656494, "min_q": -7.684881210327148, "max_q": 2.880791664123535, "mean_td_error": -0.25045087933540344}, "td_error": [-1.0191028118133545, -0.9133405685424805, -0.9595169425010681, 0.470196932554245, -1.1112608909606934, -0.6644041538238525, -10.105646133422852, -0.1619260311126709, -0.07685285806655884, -1.5489869117736816, -6.595164775848389, -0.19665312767028809, 1.0254271030426025, -1.0235257148742676, 0.2040543109178543, 1.0229458808898926, -2.1315762996673584, 0.6438250541687012, 2.3512203693389893, -0.3353698253631592, 0.4304046630859375, -1.9300823211669922, -0.6985782384872437, 0.31569671630859375, 0.30014610290527344, 0.22260522842407227, -0.6580617427825928, -0.08306726813316345, 1.2837238311767578, 1.2939610481262207, 0.6567904949188232, 0.7903356552124023, -0.643042802810669, -1.4783084392547607, 1.8007354736328125, 1.628403663635254, -7.727501392364502, -1.52370023727417, 2.424428939819336, 2.0579142570495605, 0.39336657524108887, -1.5313150882720947, 1.3653960227966309, 2.055277109146118, -0.24914979934692383, -0.5353784561157227, 1.869107961654663, 0.5142378807067871, -0.732755184173584, -0.7802109718322754, 0.999351978302002, -0.25508564710617065, 0.9414286613464355, -0.11778491735458374, 0.8299312591552734, -1.1704955101013184, 1.8196840286254883, -1.3652982711791992, -0.18990302085876465, -0.4025760889053345, -6.597113609313965, 0.7678356170654297, -1.2158184051513672, -4.161593914031982, -0.6241346001625061, -1.3340630531311035, -1.2638795375823975, 1.01493501663208, -1.66209077835083, 1.1745495796203613, 1.6793237924575806, -7.180640697479248, -0.5133404731750488, 0.9901323318481445, 0.21350765228271484, 2.473727226257324, 0.6356778144836426, 0.2498950958251953, -0.5578112602233887, 1.1178879737854004, -0.8299856185913086, 1.775343656539917, 2.016017436981201, -1.0131733417510986, -0.4767646789550781, 0.3454495668411255, 2.0059096813201904, -0.700007438659668, -0.4973912239074707, 1.1129846572875977, -1.1610188484191895, 1.493476390838623, -0.615217924118042, 0.5723190307617188, -0.7663280963897705, -0.6186683177947998, 1.0399556159973145, -0.1177985668182373, 0.6822299957275391, 0.8359737396240234, 0.22608041763305664, 1.4780607223510742, -1.7761929035186768, 2.256223201751709, 0.32056283950805664, -0.5398616790771484, 1.5126564502716064, -0.2060154676437378, -0.2864041328430176, 2.582857608795166, -6.368741989135742, -0.7965517044067383, -0.9096110463142395, -0.17460668087005615, 0.27281904220581055, -2.4001364707946777, -0.42794156074523926, 0.4530453681945801, 2.5973803997039795, 0.42460763454437256, -1.7761929035186768, -0.7054867744445801, -0.9748263359069824, 0.9167242050170898, -1.0235257148742676, -0.4610471725463867, 1.133005142211914, -0.9546656608581543, -1.2804155349731445, -1.6127451658248901, -1.5153093338012695, -0.8598061203956604, 1.7510247230529785, -5.5285186767578125, 1.5442078113555908, 1.3435964584350586, -0.7880369424819946, 0.4854518175125122, 1.6131867170333862, 1.670838713645935, 0.1051783561706543, -1.0030617713928223, -0.8225617408752441, -1.4069340229034424, 0.6482424736022949, 0.19282382726669312, -0.13031554222106934, 1.253774642944336, 1.9158689975738525, -0.0992584228515625, 1.169001579284668, 2.016017436981201, -1.520373821258545, -0.21734464168548584, -0.33551204204559326, 1.4638237953186035, 0.22608041763305664, -0.45406484603881836, -0.6212601661682129, 0.393190860748291, -1.164118766784668, -7.274266242980957, 1.1997325420379639, 1.3987584114074707, -0.5398252010345459, -1.3483397960662842, -0.23094820976257324, 0.9597878456115723, 0.7924864292144775, 3.221588134765625, 0.643883228302002, -1.4010496139526367, -2.3802080154418945, -1.0056605339050293, -0.3962869644165039, 0.9583377838134766, -1.149338960647583, 1.1341915130615234, -6.2928056716918945, -0.1797008514404297, -0.4233675003051758, -1.488542079925537, 0.2855391502380371, 0.7691807746887207, -1.019486665725708, 1.6809158325195312, 1.9635486602783203, 0.18040728569030762, -0.8775968551635742, 0.2690216302871704, 0.6185226440429688, -5.363895416259766, -0.8164515495300293, 0.8891597986221313, -0.4158926010131836, -0.4533385932445526, -0.7076894044876099, -1.6740777492523193, 0.5678160786628723, 0.3457798361778259, 1.0006563663482666, -1.0397710800170898, 0.9154539108276367, 2.3527557849884033, -0.20443153381347656, -0.3740476369857788, 2.2991819381713867, -0.7434433698654175, -0.19715392589569092, 0.2553596496582031, -0.8564867973327637, -0.8151154518127441, -0.17805910110473633, -1.4496269226074219, 0.5094109773635864, 1.4255592823028564, 0.6489090919494629, 0.2735013961791992, -0.6374673843383789, 0.3780650496482849, 0.5375761985778809, -1.4783084392547607, -1.395080327987671, 0.8326106071472168, 0.3647928237915039, 0.6418509483337402, -0.8281669616699219, 1.0754036903381348, -6.699161052703857, -3.2634525299072266, -1.5110688209533691, 0.2798037528991699, -0.7535204887390137, -0.054100990295410156, 1.7526549100875854, 1.2329926490783691, -0.9597010612487793, -0.23374557495117188, -0.5883114337921143, 1.0254271030426025], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 27120, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 27120, "last_target_update_ts": 8192, "num_target_updates": 15}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -142.16105076670647, "episode_reward_mean": -62.25029555056244, "episode_len_mean": 252.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5666707051309401, "mean_inference_ms": 22.441443416624836, "mean_action_processing_ms": 0.13845002663352712, "mean_env_wait_ms": 4.8961821410988815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -142.16105076670647, "episode_reward_mean": -62.25029555056244, "episode_len_mean": 252.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5666707051309401, "mean_inference_ms": 22.441443416624836, "mean_action_processing_ms": 0.13845002663352712, "mean_env_wait_ms": 4.8961821410988815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 27120, "num_env_steps_sampled": 8192, "num_env_steps_trained": 27120, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 8192, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 324.08, "learn_time_ms": 69.391, "learn_throughput": 3458.652, "synch_weights_time_ms": 19.496}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 27120, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 27120, "last_target_update_ts": 8192, "num_target_updates": 15}, "done": false, "episodes_total": 16, "training_iteration": 8, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-18-15", "timestamp": 1655500695, "time_this_iter_s": 5.063620567321777, "time_total_s": 38.006065130233765, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 38.006065130233765, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 30.125, "ram_util_percent": 60.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -4.3313307762146, "min_q": -10.235215187072754, "max_q": 3.341400146484375, "mean_td_error": -0.5926578640937805}, "td_error": [-1.2363905906677246, -0.4559750556945801, 0.42429304122924805, 1.8754148483276367, -0.45618173480033875, -0.4490079879760742, 0.4794425964355469, -7.572267532348633, 0.42964649200439453, -0.5336873531341553, -0.5348858833312988, -1.5474531650543213, -0.27821028232574463, 0.8066420555114746, 0.13682585954666138, 0.8605431318283081, 1.3428568840026855, -2.404904842376709, -0.44002509117126465, 1.3284358978271484, -4.900810241699219, -0.5084717273712158, 0.8430109024047852, 0.6190924644470215, 0.25817131996154785, 1.3284358978271484, -0.6943860054016113, -0.6391899585723877, 1.6325438022613525, 0.7615785598754883, -2.0520949363708496, -1.1280672550201416, 1.2523045539855957, 0.13525390625, -1.302441120147705, -1.2428784370422363, 1.9747123718261719, -1.4099030494689941, -0.7003483772277832, 0.950108528137207, -1.2606909275054932, 0.5682322978973389, -1.8660902976989746, 1.8754119873046875, -0.5055994987487793, 0.6470385789871216, -6.416829586029053, 0.30570220947265625, 1.7280855178833008, -5.287844181060791, 0.4199411869049072, 0.3634371757507324, -0.37182044982910156, -0.0004963874816894531, 0.18679094314575195, -0.7258429527282715, -0.10547018051147461, 0.44293975830078125, -1.8363194465637207, 2.0517876148223877, -8.70826530456543, 1.5451478958129883, -2.3051319122314453, 0.961000919342041, 0.6985071897506714, -8.736553192138672, -6.488243103027344, 2.798321008682251, -1.2799019813537598, -1.8400425910949707, 0.6276841163635254, -2.189131259918213, 0.7207241058349609, 0.8871173858642578, -1.2160367965698242, 0.5443801879882812, -0.9308067560195923, -1.4349956512451172, 0.041132569313049316, 1.3284358978271484, 0.042136192321777344, -0.6514768600463867, -0.9147680997848511, 1.4295823574066162, -1.9216036796569824, -2.0736303329467773, -1.037257194519043, -1.0183818340301514, 1.7271517515182495, 0.351792573928833, -1.0024628639221191, 0.2748594284057617, -1.1280672550201416, -0.11588454246520996, -1.0259547233581543, -0.7494945526123047, 0.4435615539550781, 0.3287665843963623, 0.31690073013305664, -0.31802868843078613, 0.6960675716400146, -0.9469051361083984, -0.9413316249847412, -8.144049644470215, -1.8932218551635742, -1.0962066650390625, -2.5515129566192627, -0.19269788265228271, -0.23327648639678955, -0.5136137008666992, -0.0671471357345581, -1.0084187984466553, -1.2960418462753296, 0.9733448028564453, 0.22013092041015625, -2.044513702392578, -1.6413333415985107, -2.4460325241088867, -1.133735179901123, 0.29364490509033203, -0.7150063514709473, -1.770068645477295, -0.15323448181152344, -0.0057849884033203125, 1.2147951126098633, 1.3284358978271484, -0.1252613067626953, 0.34889256954193115, -1.765965461730957, -1.007828712463379, -2.116096019744873, -1.3891315460205078, 0.2670860290527344, 0.2151956558227539, 0.3241696357727051, 0.5406990051269531, -0.41051197052001953, -0.3481411933898926, -0.9386157989501953, -0.7193845510482788, 0.4958515167236328, -0.048087239265441895, -0.7256240844726562, -5.846710205078125, 0.5547752380371094, -6.691946983337402, 0.5520875453948975, -0.09714174270629883, -0.9357705116271973, 1.0471229553222656, -1.8961677551269531, 0.13525390625, -4.414466381072998, -0.8460750579833984, -0.4862380027770996, 0.3031926155090332, 1.5526589155197144, 1.1141858100891113, -1.2988028526306152, 1.0471229553222656, 0.49393177032470703, -0.19580376148223877, -1.3118338584899902, 1.087857723236084, -1.2078502178192139, 0.22774875164031982, -0.9258725643157959, 2.658393383026123, 1.2330031394958496, -0.23562169075012207, 0.6677742004394531, 1.3257588148117065, 0.5166459083557129, -0.46947598457336426, -1.3425397872924805, 0.5307897329330444, 0.5808154940605164, 1.1094799041748047, -7.914921760559082, 0.43991661071777344, -1.491837978363037, -0.558342456817627, -0.36927318572998047, 1.2330031394958496, 0.6582925319671631, -5.995056629180908, -7.016149997711182, -2.012845516204834, 0.8955783843994141, -0.08379578590393066, 1.0770795345306396, 0.4442291259765625, -2.2764039039611816, -6.209842681884766, 1.3933665752410889, -0.2747516632080078, -0.17614364624023438, -7.250859260559082, 0.9648265838623047, 0.899784505367279, -0.8716349601745605, 1.6122896671295166, 2.195009708404541, -0.24668025970458984, -2.022528886795044, -0.2871805727481842, 0.4492225646972656, 0.0418238639831543, -1.0211453437805176, -7.572267532348633, 0.35529518127441406, -1.2384967803955078, -1.7373027801513672, 2.162257194519043, 0.16721463203430176, 1.8804447650909424, -0.40270042419433594, 1.026099681854248, 1.3563330173492432, -2.087930679321289, -2.040208339691162, -0.0057849884033203125, -0.1472301483154297, -0.13682270050048828, 1.9182559251785278, -1.5059175491333008, -1.5573270320892334, -1.0654582977294922, 0.6055461168289185, -0.1472301483154297, 0.41492319107055664, 1.4198856353759766, -0.9336755275726318, 1.3798437118530273, -0.4152560234069824, -0.5239205360412598, 0.40453195571899414, -0.4851818084716797, 0.6090373992919922, -2.370861530303955], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 30960, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 30960, "last_target_update_ts": 9216, "num_target_updates": 17}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -223.09377865493298, "episode_reward_mean": -99.94539818878879, "episode_len_mean": 269.54545454545456, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5636253514426446, "mean_inference_ms": 22.388965247712164, "mean_action_processing_ms": 0.14124184556133035, "mean_env_wait_ms": 4.788027418284013, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -223.09377865493298, "episode_reward_mean": -99.94539818878879, "episode_len_mean": 269.54545454545456, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5636253514426446, "mean_inference_ms": 22.388965247712164, "mean_action_processing_ms": 0.14124184556133035, "mean_env_wait_ms": 4.788027418284013, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 30960, "num_env_steps_sampled": 9216, "num_env_steps_trained": 30960, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 9216, "agent_timesteps_total": 9216, "timers": {"training_iteration_time_ms": 370.947, "learn_time_ms": 69.835, "learn_throughput": 3436.667, "synch_weights_time_ms": 19.89}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 30960, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 30960, "last_target_update_ts": 9216, "num_target_updates": 17}, "done": false, "episodes_total": 22, "training_iteration": 9, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-18-21", "timestamp": 1655500701, "time_this_iter_s": 5.722282409667969, "time_total_s": 43.72834753990173, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 43.72834753990173, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 30.224999999999998, "ram_util_percent": 60.175000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -3.6813502311706543, "min_q": -9.747271537780762, "max_q": 5.0061211585998535, "mean_td_error": -0.2527734935283661}, "td_error": [-0.614887535572052, -0.39967894554138184, -6.069149971008301, 0.10421895980834961, 0.3582477569580078, 0.780340313911438, 0.5229558944702148, 0.9294849634170532, 1.1464996337890625, -1.0731444358825684, 1.3581688404083252, 0.6173256635665894, 0.42144638299942017, -1.0180091857910156, -0.058309316635131836, 0.5322666168212891, 0.5681562423706055, 1.8904924392700195, 0.014698982238769531, -0.6363781690597534, -0.4394334554672241, -1.3285479545593262, -0.2748527526855469, 1.7150671482086182, 0.82769775390625, -0.11603927612304688, -0.8021814823150635, 0.32712364196777344, 0.712630033493042, -1.2237176895141602, 0.1955704689025879, 1.3408288955688477, -1.0666890144348145, -0.04407191276550293, -1.8584208488464355, -1.582083821296692, -1.3319640159606934, -0.5324611663818359, -1.5348169803619385, -6.8124189376831055, 1.5436582565307617, -0.6095449328422546, -1.0169367790222168, -0.23531889915466309, -0.8121680617332458, -1.1218962669372559, -1.0851879119873047, 0.4648551940917969, 1.521087408065796, -1.2305943965911865, 1.5097968578338623, 0.5483083724975586, -0.02712249755859375, -0.37554872035980225, 1.0252718925476074, 0.4861602783203125, 0.7901496887207031, 0.3111867904663086, -0.06596612930297852, -0.6462945938110352, -5.480971336364746, 1.6964490413665771, 0.48164987564086914, -0.8872385025024414, -3.3899970054626465, -1.2643861770629883, -0.6059198379516602, -0.1617969125509262, 1.2832860946655273, -0.5129754543304443, -0.5504426956176758, -0.5805635452270508, 0.5935878753662109, -0.35413163900375366, -1.1503162384033203, 0.6924173831939697, -0.8696886897087097, -0.15991759300231934, 0.3450576663017273, -6.069149971008301, 0.06993627548217773, 1.8327813148498535, 1.3888769149780273, 1.1835298538208008, -1.2085332870483398, 0.9537210464477539, 1.6117753982543945, 0.015197277069091797, 0.5246641039848328, 0.026026248931884766, -1.1777727603912354, -0.40459537506103516, 0.9138913154602051, -1.097639560699463, -1.604454517364502, -0.23863577842712402, -1.2237176895141602, 0.8771884441375732, -0.21649488806724548, 0.9537010192871094, 0.0072193145751953125, 0.25908851623535156, 0.2347698211669922, 0.9651260375976562, -7.721864223480225, -0.5105870962142944, -0.5604591369628906, 2.124492645263672, -0.06478571891784668, -0.3890833854675293, 4.922844409942627, -0.9287947416305542, -0.15090036392211914, 0.7458972930908203, 0.024998188018798828, 1.8706510066986084, 0.3385615348815918, -0.47380638122558594, -4.930308818817139, -0.29722118377685547, -1.0730366706848145, -0.17631840705871582, 2.176234006881714, 1.5703363418579102, 0.21377885341644287, 1.716558814048767, -0.6785550117492676, -3.0016353130340576, 0.6580085754394531, 0.656498908996582, -7.402772903442383, -1.599653720855713, -0.3488525152206421, 0.18899822235107422, -1.1478270292282104, 1.241438865661621, -0.8077054023742676, 0.5857939720153809, 1.3035452365875244, -0.719826340675354, 1.1879358291625977, 1.5436582565307617, -0.42017459869384766, -0.3660421371459961, -1.0277529954910278, -0.9754412174224854, -0.7406182289123535, 0.3443179130554199, 0.4424067735671997, -10.606184005737305, -1.2032924890518188, -0.7894144058227539, 0.7872167825698853, 0.5220708847045898, 0.7771849632263184, -1.7057161331176758, -6.991327285766602, 0.7702312469482422, 0.7648365497589111, -1.5997405052185059, 1.7325809001922607, 1.8085484504699707, 0.6494119167327881, -7.136773586273193, 0.02360367774963379, -0.8348751068115234, 1.6700180768966675, 0.24503231048583984, 1.8967485427856445, 0.9725618362426758, 1.6528897285461426, -1.123483657836914, 0.6961114406585693, -1.5306864976882935, 0.11728954315185547, 1.8417177200317383, 2.1942436695098877, 1.2178127765655518, -5.963722229003906, -1.122448444366455, -1.0852549076080322, -1.255495548248291, 0.12575578689575195, -0.1675150990486145, -0.521146297454834, -0.14716464281082153, 0.32118529081344604, 0.32727813720703125, -0.28041601181030273, -0.5838805437088013, 0.3872389793395996, 0.7041583061218262, 1.2229127883911133, 0.5220708847045898, -4.547603607177734, 0.8851971626281738, 2.158714532852173, -1.3528099060058594, -0.39980554580688477, -0.26133376359939575, -0.6203268766403198, 0.36165595054626465, 0.7002134323120117, 0.5574657917022705, 1.127762794494629, 0.7771849632263184, 1.4352951049804688, 0.19327306747436523, 0.9330122470855713, 0.43656933307647705, 1.6665964126586914, -0.8277249336242676, 0.3074302673339844, -0.21811628341674805, 1.3193325996398926, 1.8967485427856445, -1.242052435874939, 0.539379358291626, -0.935431957244873, -1.3199715614318848, -0.9327969551086426, -1.5768604278564453, -0.17244911193847656, 1.028306007385254, 0.5601029396057129, 1.3828067779541016, -0.5344929695129395, -0.6416571140289307, 0.599969744682312, 0.4613814353942871, 1.8084094524383545, 0.05655956268310547, -0.253756046295166, 0.47966861724853516, -1.2999768257141113, -0.7810359001159668, 0.5040607452392578, 0.09490728378295898, 0.6580085754394531, -6.543025493621826], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 34800, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 34800, "last_target_update_ts": 10240, "num_target_updates": 19}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -336.33778443932533, "episode_reward_mean": -149.37965648308878, "episode_len_mean": 294.1290322580645, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5505446928344492, "mean_inference_ms": 22.395669083035727, "mean_action_processing_ms": 0.14168228665065682, "mean_env_wait_ms": 4.631678953773852, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -336.33778443932533, "episode_reward_mean": -149.37965648308878, "episode_len_mean": 294.1290322580645, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5505446928344492, "mean_inference_ms": 22.395669083035727, "mean_action_processing_ms": 0.14168228665065682, "mean_env_wait_ms": 4.631678953773852, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 34800, "num_env_steps_sampled": 10240, "num_env_steps_trained": 34800, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 10240, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 344.208, "learn_time_ms": 69.64, "learn_throughput": 3446.283, "synch_weights_time_ms": 20.379}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 34800, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 34800, "last_target_update_ts": 10240, "num_target_updates": 19}, "done": false, "episodes_total": 31, "training_iteration": 10, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-18-27", "timestamp": 1655500707, "time_this_iter_s": 5.437093019485474, "time_total_s": 49.16544055938721, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 49.16544055938721, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 31.037499999999998, "ram_util_percent": 60.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -4.90421724319458, "min_q": -11.535762786865234, "max_q": 4.156311988830566, "mean_td_error": -0.36269423365592957}, "td_error": [-0.5773029327392578, -0.02216857671737671, 1.1610994338989258, -0.455244779586792, -0.9978506565093994, 0.38987040519714355, 0.32379913330078125, -0.011193275451660156, -0.7888271808624268, 1.9150285720825195, -0.2485361099243164, -1.8386168479919434, 0.46209144592285156, 0.2999753952026367, 1.463789939880371, 0.6438255310058594, -1.565902590751648, -0.19001150131225586, -0.4292781352996826, 1.3061466217041016, 0.9077906608581543, 0.31816673278808594, 0.8373432159423828, -0.8349933624267578, -2.547484874725342, -0.4962005615234375, -6.904424667358398, -0.8752944469451904, -0.7411290407180786, 0.9299707412719727, -0.40511465072631836, 0.13075494766235352, -1.5398178100585938, -0.7982120513916016, -0.496889591217041, -1.3023853302001953, -0.2212677001953125, 0.09753292798995972, 1.1958770751953125, 0.38315123319625854, 0.03578662872314453, -0.5919210910797119, -1.7021980285644531, 0.6121463775634766, -0.816932201385498, -0.4685974419116974, -0.2751762866973877, 0.0014243125915527344, -0.39428579807281494, 0.17859458923339844, -0.12788665294647217, 1.62188720703125, -1.4137310981750488, 0.5275415182113647, -0.9413022994995117, 1.1986618041992188, -0.2368631362915039, -7.162359237670898, -1.2830286026000977, -1.6909799575805664, -0.7186908721923828, -5.6470513343811035, 0.7838888168334961, 1.637516736984253, -1.3695476055145264, -1.7101836204528809, 1.055358648300171, -0.9649038314819336, 1.1924793720245361, 0.19516468048095703, 0.2256765365600586, 1.464167594909668, 1.0880041122436523, -1.3702502250671387, 1.2367734909057617, -1.4361966848373413, 0.26222628355026245, -0.6326560974121094, 0.9398574829101562, 0.5707855224609375, 1.0779376029968262, -1.6444809436798096, 0.4060797691345215, -1.3667411804199219, -0.8162035942077637, -1.2928361892700195, -0.46579819917678833, -0.3140387535095215, -0.9743900299072266, 0.21109390258789062, 0.5635004043579102, -0.5176992416381836, 0.8715362548828125, -0.7202937602996826, -1.3359699249267578, -9.942361831665039, 1.0789604187011719, -0.11996078491210938, -1.1316535472869873, 1.4047510623931885, -1.9565813541412354, 0.5590925216674805, 0.24287986755371094, 1.8917694091796875, -1.7249761819839478, 0.3605375289916992, -0.1851179599761963, -1.5213189125061035, -2.9320144653320312, -1.9472100734710693, -0.5773029327392578, 1.5225210189819336, 1.0548241138458252, 0.5514345169067383, 2.252148151397705, -0.9525692462921143, 0.1924305111169815, 0.9099140167236328, 0.4524373710155487, -0.6326560974121094, -0.5664844512939453, -0.056565284729003906, -0.6871142387390137, -2.329281806945801, 0.8143672943115234, -0.6658895015716553, 0.7866573333740234, -0.24692058563232422, 0.3897428512573242, 1.504853367805481, 0.919318675994873, 0.012360572814941406, -1.1844611167907715, 0.6138086318969727, -6.5410943031311035, -0.27501678466796875, 0.7802591323852539, 1.1116828918457031, -1.3834972381591797, -1.435533046722412, 1.197052001953125, 1.463789939880371, 1.177652359008789, -3.004939079284668, -3.260805368423462, 1.7122595310211182, 0.7563824653625488, -0.20183849334716797, -1.6943349838256836, 2.6765949726104736, 0.7399215698242188, 1.7378968000411987, -0.858350932598114, -0.7397871017456055, -1.3437700271606445, -1.330185890197754, 2.083756923675537, 0.0063817501068115234, -0.4768953323364258, 2.1825828552246094, 0.5568554401397705, 0.6426539421081543, -1.4717516899108887, -0.41695404052734375, -0.7827167510986328, -1.8594274520874023, -7.55159854888916, -7.028372287750244, 0.6974477767944336, -0.46332669258117676, 0.8580656051635742, 4.285989284515381, -0.5920573472976685, 1.0789604187011719, -0.20171236991882324, -1.1040951013565063, -1.279557704925537, -1.0143587589263916, -1.971503734588623, 1.1505155563354492, 1.2655974626541138, -10.03335952758789, -0.6272637844085693, 1.637516736984253, -1.683077335357666, -0.44666433334350586, 0.06754195690155029, -0.04599189758300781, -0.34117770195007324, -0.0036916732788085938, -1.3542747497558594, 1.9166345596313477, 1.7967662811279297, 0.19516468048095703, -0.4154033660888672, 0.268282413482666, -0.03956103324890137, 0.23271822929382324, 0.8771982192993164, 0.6138086318969727, -0.5773029327392578, -1.0234451293945312, -1.969994068145752, 0.1549673080444336, 0.5813448429107666, -0.1751689910888672, 0.1896963119506836, -3.3814895153045654, 1.6715593338012695, 0.8665720224380493, -0.2859358787536621, -0.03421163558959961, -7.194928169250488, -2.1830687522888184, 1.87078857421875, 0.8488943576812744, -0.9008035659790039, -0.45518776774406433, 1.2242894172668457, 1.637516736984253, 0.5824402570724487, 0.6043415069580078, 0.5489852428436279, 0.38173747062683105, -1.0696097612380981, -1.5008172988891602, -1.5753755569458008, -0.5426686406135559, -0.1298454999923706, 1.115187168121338, -2.002131462097168, -1.2312860488891602, 0.7153768539428711, 0.8169145584106445, -0.9990291595458984, -1.2871472835540771, 0.1111593246459961, -0.3860464096069336, -0.6208239793777466, 1.8766098022460938], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 38640, "last_target_update_ts": 11264, "num_target_updates": 21}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -378.1921111047268, "episode_reward_mean": -156.53004569001496, "episode_len_mean": 297.28125, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5481814423910604, "mean_inference_ms": 22.402824289703705, "mean_action_processing_ms": 0.14155224178572773, "mean_env_wait_ms": 4.613032686468154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -378.1921111047268, "episode_reward_mean": -156.53004569001496, "episode_len_mean": 297.28125, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5481814423910604, "mean_inference_ms": 22.402824289703705, "mean_action_processing_ms": 0.14155224178572773, "mean_env_wait_ms": 4.613032686468154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 38640, "num_env_steps_sampled": 11264, "num_env_steps_trained": 38640, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 11264, "agent_timesteps_total": 11264, "timers": {"training_iteration_time_ms": 302.065, "learn_time_ms": 69.283, "learn_throughput": 3464.071, "synch_weights_time_ms": 19.389}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 38640, "last_target_update_ts": 11264, "num_target_updates": 21}, "done": false, "episodes_total": 32, "training_iteration": 11, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-18-32", "timestamp": 1655500712, "time_this_iter_s": 4.911994934082031, "time_total_s": 54.07743549346924, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 54.07743549346924, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 33.07142857142856, "ram_util_percent": 60.628571428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.186915874481201, "min_q": -14.587824821472168, "max_q": 5.622020244598389, "mean_td_error": -0.8649880290031433}, "td_error": [-0.5393581390380859, -1.2749080657958984, 1.4177651405334473, 1.308558464050293, 0.1997060775756836, -0.0776904821395874, -1.9891271591186523, -1.3227291107177734, -0.37839412689208984, -0.7022933959960938, -2.5436604022979736, -8.15567684173584, 2.323040246963501, -2.198392868041992, -3.054760217666626, -0.246429443359375, 0.27703237533569336, -1.5748348236083984, -1.7074041366577148, 0.6521303653717041, 0.11278438568115234, -1.636253833770752, -1.2334012985229492, -8.268241882324219, 0.2743716239929199, -0.5802427530288696, 0.4987499713897705, 1.9414160251617432, -0.7334365844726562, -0.7978723049163818, 0.2135019302368164, -2.169668674468994, 1.8893368244171143, -0.3140132427215576, 1.023695945739746, 0.2135019302368164, -0.5389804840087891, -1.7404289245605469, 0.2839488983154297, 0.9348850250244141, -2.0841760635375977, -7.936470031738281, -2.006463050842285, 0.01990032196044922, -0.31241321563720703, -1.6589155197143555, 0.47576141357421875, -1.2455058097839355, -1.3196601867675781, 0.7514762878417969, -0.08325576782226562, -1.9891271591186523, -0.2880563735961914, 0.07570886611938477, -0.7338409423828125, -1.2749080657958984, -2.143601894378662, -0.5306406021118164, -0.3314828872680664, -0.2411479949951172, -1.4025659561157227, -1.3471698760986328, -0.14458370208740234, -1.1882696151733398, 1.7773685455322266, -1.8465147018432617, -0.6371135711669922, -0.8145771026611328, 1.2612076997756958, -0.2411479949951172, -5.26418399810791, -0.9664897918701172, -6.422582626342773, -0.9361295700073242, -3.31715726852417, -1.2537851333618164, -1.3122895956039429, 0.23232495784759521, 0.14270401000976562, -0.44742316007614136, -1.0796689987182617, 0.02659585326910019, -0.06734275817871094, 0.8843494653701782, 0.36678826808929443, -1.189183235168457, -0.08325576782226562, 0.33470678329467773, -0.35280704498291016, 0.16776752471923828, -0.26895999908447266, 0.3147144317626953, -2.1204538345336914, 0.5497008562088013, -0.21342122554779053, -8.230266571044922, -0.8932015895843506, -1.0006918907165527, 0.17567825317382812, -0.6211113929748535, -1.1464834213256836, -0.899010181427002, -1.9842748641967773, -1.0068764686584473, -0.7338409423828125, 0.1596698760986328, -1.3020305633544922, -0.08325576782226562, 0.04145622253417969, 1.170130729675293, 0.5290870666503906, 0.0074596405029296875, -1.2738170623779297, -0.17452430725097656, -1.952773094177246, 0.13983631134033203, 1.705489158630371, -0.7341232299804688, -0.5789704322814941, -0.3166332244873047, -0.08288764953613281, -1.4341113567352295, -0.3905606269836426, -0.14458370208740234, 1.237600564956665, 0.2096463441848755, -1.901996374130249, 0.2839488983154297, 0.0805206298828125, -0.6726658344268799, -1.3178138732910156, 0.0026140213012695312, -6.466813087463379, -4.980027198791504, -0.9523988962173462, 0.8942446708679199, -0.7546210289001465, -1.1533551216125488, 0.1930394172668457, -1.4969940185546875, -1.9621031284332275, -4.677328586578369, -1.3709831237792969, -7.472472190856934, -1.959247350692749, -1.8665103912353516, 0.025130271911621094, -4.735839366912842, -0.13443279266357422, -0.49436214566230774, -11.0603609085083, -4.708338260650635, -0.6750199794769287, 3.328390598297119, 0.3514690399169922, 0.32820987701416016, -1.1894912719726562, 0.1186513900756836, 0.5315790176391602, 1.2374396324157715, -1.510584831237793, 0.006820797920227051, -0.46987056732177734, 0.578801155090332, -0.8295516967773438, -0.15980148315429688, 1.6535515785217285, 1.010791540145874, 0.9517602920532227, -0.015398025512695312, -1.9899601936340332, 0.01990032196044922, -0.17944812774658203, -2.0282211303710938, 1.783470630645752, -2.4388833045959473, 1.276216745376587, 0.6863532066345215, -2.994886636734009, -0.5098004341125488, 1.0411454439163208, -1.9418249130249023, 0.729280948638916, -1.8465147018432617, 0.2606658935546875, 0.2418193817138672, -6.204324722290039, -1.9649739265441895, -0.09324073791503906, 2.598742961883545, -2.4888134002685547, -1.670531988143921, -0.982752799987793, 0.2839488983154297, 0.9952335357666016, -0.7799464464187622, 0.21183466911315918, 0.5271685123443604, 0.39728260040283203, 0.793595552444458, -0.09943246841430664, 0.3295344114303589, -0.8380603790283203, -0.9604268074035645, -0.9930915832519531, 0.27066802978515625, 0.3366565704345703, -0.246429443359375, -1.7841272354125977, -1.528794288635254, -11.76163101196289, 0.8847245573997498, -3.4053807258605957, 0.7959980964660645, -1.7055892944335938, 3.9126198291778564, 0.2647247314453125, -1.4256263971328735, 0.20437169075012207, 0.015611648559570312, -0.8467741012573242, 0.28539466857910156, -0.8533751964569092, 0.8876476287841797, -0.3674201965332031, -1.020881175994873, -0.012915611267089844, 1.7086403369903564, -0.5407459735870361, 0.28414249420166016, -2.351111888885498, -2.5713539123535156, -1.6479215621948242, -0.2783694267272949, -0.5335121154785156, -0.17406845092773438, -0.5389804840087891, -1.8073701858520508, -9.02389907836914, -1.244272232055664], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 42480, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 42480, "last_target_update_ts": 12288, "num_target_updates": 23}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -378.1921111047268, "episode_reward_mean": -156.53004569001496, "episode_len_mean": 297.28125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5481814423910604, "mean_inference_ms": 22.402824289703705, "mean_action_processing_ms": 0.14155224178572773, "mean_env_wait_ms": 4.613032686468154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -378.1921111047268, "episode_reward_mean": -156.53004569001496, "episode_len_mean": 297.28125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5481814423910604, "mean_inference_ms": 22.402824289703705, "mean_action_processing_ms": 0.14155224178572773, "mean_env_wait_ms": 4.613032686468154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 42480, "num_env_steps_sampled": 12288, "num_env_steps_trained": 42480, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 12288, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 308.553, "learn_time_ms": 70.971, "learn_throughput": 3381.64, "synch_weights_time_ms": 19.586}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 42480, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 42480, "last_target_update_ts": 12288, "num_target_updates": 23}, "done": false, "episodes_total": 32, "training_iteration": 12, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-18-37", "timestamp": 1655500717, "time_this_iter_s": 4.92707633972168, "time_total_s": 59.00451183319092, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 59.00451183319092, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 35.457142857142856, "ram_util_percent": 60.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -5.7165632247924805, "min_q": -17.053743362426758, "max_q": 6.927922248840332, "mean_td_error": -0.7657806277275085}, "td_error": [-2.9404077529907227, 3.193112373352051, -0.5394573211669922, -7.066479206085205, 0.20192909240722656, -0.4211606979370117, 0.6522445678710938, -0.7562294006347656, 0.17623043060302734, -0.4211606979370117, 2.0737273693084717, 0.8270959854125977, 0.6405622959136963, 1.4281339645385742, 0.37979555130004883, -0.6731472015380859, -7.482785224914551, -0.43707275390625, -1.3699030876159668, -3.010477066040039, 0.38610363006591797, -0.9013814926147461, -2.664127826690674, -2.7993650436401367, -3.2805473804473877, -5.485186576843262, -0.38044488430023193, 0.44249439239501953, 0.7409130334854126, 0.5436587333679199, 0.6006214618682861, -0.7212228775024414, -4.821184158325195, -1.526723861694336, -1.026620864868164, -3.851740837097168, 0.3037891387939453, 0.05587482452392578, -0.0930166244506836, -0.4211606979370117, -2.398059368133545, -1.2736730575561523, -7.315691947937012, 0.12963581085205078, 1.5932435989379883, 0.6606378555297852, 1.4975645542144775, -2.301137924194336, -0.43661022186279297, -3.264305591583252, -1.659278154373169, 0.4723844528198242, 1.0352356433868408, 1.0269246101379395, 0.6670756340026855, -0.4687623977661133, 0.37586843967437744, 1.317518711090088, 0.9378389120101929, -7.504130840301514, -0.1024012565612793, 2.0408711433410645, -0.8197803497314453, 0.824852466583252, -0.4211606979370117, -0.6746768951416016, -0.0690622329711914, 3.193112373352051, -2.7528562545776367, -5.900607585906982, -7.488658428192139, 0.3637118339538574, 0.5037899017333984, 2.160731315612793, 2.0728092193603516, -2.356605052947998, -1.0087814331054688, 0.35407257080078125, 0.6606378555297852, -9.373817443847656, -0.2778494358062744, -3.862363815307617, 0.619545578956604, -1.1075448989868164, -3.101487159729004, -0.1677379608154297, -1.9113836288452148, -0.07662200927734375, -0.13895320892333984, -1.2193955183029175, 0.4717082977294922, 0.4717082977294922, -0.8744397163391113, -1.357269525527954, -0.8303251266479492, 0.824852466583252, 1.0044578313827515, 0.7483911514282227, -0.4361445903778076, -0.7755804061889648, 1.5021157264709473, 0.05587482452392578, 0.6522445678710938, -0.7127933502197266, -0.5034275054931641, -1.797532081604004, -0.6534652709960938, -0.9277114868164062, 0.6491284370422363, -0.590100109577179, -1.8354535102844238, 1.7848330736160278, 1.499884843826294, -1.1636877059936523, -0.014678001403808594, -3.213700294494629, -0.36350440979003906, -0.14005470275878906, -0.4211606979370117, 0.4044487476348877, -2.967559814453125, -1.6725921630859375, -0.2636549472808838, -2.3236660957336426, -6.861305236816406, -4.96379280090332, -1.1772890090942383, 1.0231103897094727, -0.1849527359008789, -0.5034275054931641, -0.8670082092285156, -0.7590036392211914, 1.499884843826294, -0.9277114868164062, -0.9412651062011719, -1.0094027519226074, 1.840983271598816, 0.7279484272003174, 3.502220869064331, -1.3211379051208496, 1.4983470439910889, -0.9624795913696289, -0.7276339530944824, -1.6467645168304443, 0.20855426788330078, 1.5493431091308594, -8.852232933044434, -1.0921940803527832, 0.38955211639404297, 1.3132708072662354, -0.18928837776184082, 0.799410343170166, 0.5058565139770508, -1.3068981170654297, 2.263338804244995, 1.2031898498535156, -0.014678001403808594, -3.145692825317383, -3.782621383666992, -1.9863719940185547, -7.15147066116333, -1.7448968887329102, 0.304610013961792, -1.1952037811279297, -0.8050436973571777, -1.1680644750595093, 1.0269246101379395, -2.911396026611328, -0.8855130672454834, 0.36759376525878906, -0.5059835910797119, -1.855656623840332, -0.19561481475830078, 0.4525655508041382, -0.8694844245910645, -0.2116866111755371, 1.5021157264709473, -0.5650911331176758, -1.060713291168213, -3.256984233856201, 0.8339715003967285, 0.1919097900390625, 2.263338804244995, -0.45017576217651367, -0.28873348236083984, -0.8690814971923828, -0.7619762420654297, -0.28794431686401367, 1.4473986625671387, 0.5075063705444336, -0.9277114868164062, 0.4059152603149414, 1.0560789108276367, -0.5020833015441895, 1.6685872077941895, -2.739621639251709, -0.8245272636413574, 0.3717234134674072, -0.50958251953125, -1.19683837890625, -3.1187541484832764, 0.8827357292175293, -0.4104878902435303, 1.0011451244354248, 1.6894866228103638, -1.007188081741333, -0.7353754043579102, -0.1223146915435791, -0.7025210857391357, -2.342355728149414, -0.8224430084228516, -1.9110345840454102, -1.9238786697387695, 2.672607421875, -3.770738124847412, -0.02981877326965332, -0.8696384429931641, -1.0288689136505127, -0.05889701843261719, 1.7625919580459595, -1.8102960586547852, -14.476612091064453, -2.540949821472168, -2.9951820373535156, -1.856142520904541, -0.5005278587341309, 0.22621917724609375, -0.16807079315185547, -1.2927474975585938, 0.6755118370056152, 0.24603557586669922, -0.16867923736572266, -1.6372418403625488, 1.0416409969329834, 1.2242012023925781, -0.6534652709960938, 0.456071138381958, 1.511242151260376, -1.0726127624511719, -1.752105712890625], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 46320, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 46320, "last_target_update_ts": 13312, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -378.1921111047268, "episode_reward_mean": -156.53004569001496, "episode_len_mean": 297.28125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5481814423910604, "mean_inference_ms": 22.402824289703705, "mean_action_processing_ms": 0.14155224178572773, "mean_env_wait_ms": 4.613032686468154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -378.1921111047268, "episode_reward_mean": -156.53004569001496, "episode_len_mean": 297.28125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5481814423910604, "mean_inference_ms": 22.402824289703705, "mean_action_processing_ms": 0.14155224178572773, "mean_env_wait_ms": 4.613032686468154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 46320, "num_env_steps_sampled": 13312, "num_env_steps_trained": 46320, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 13312, "agent_timesteps_total": 13312, "timers": {"training_iteration_time_ms": 325.576, "learn_time_ms": 70.297, "learn_throughput": 3414.101, "synch_weights_time_ms": 20.187}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 46320, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 46320, "last_target_update_ts": 13312, "num_target_updates": 25}, "done": false, "episodes_total": 32, "training_iteration": 13, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-18-42", "timestamp": 1655500722, "time_this_iter_s": 5.235812425613403, "time_total_s": 64.24032425880432, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 64.24032425880432, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 33.18571428571428, "ram_util_percent": 60.88571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.762447834014893, "min_q": -19.058542251586914, "max_q": 8.184804916381836, "mean_td_error": -0.22912555932998657}, "td_error": [1.761709213256836, 0.27173328399658203, -0.10046005249023438, -0.4236760139465332, -1.4197006225585938, 1.327955961227417, 2.7583346366882324, -6.11436653137207, -6.385625839233398, -0.3436408042907715, -3.369692802429199, 1.178828477859497, 0.03886890411376953, -0.004427433013916016, 1.0194873809814453, 0.8441413044929504, 0.8439114093780518, 0.6041698455810547, -1.9976167678833008, -0.2725868225097656, 0.9127407073974609, 0.9566717147827148, 1.6683320999145508, -0.8589233160018921, -3.7885210514068604, 0.5385007858276367, -1.2110629081726074, -0.44472646713256836, 0.1717090606689453, 0.4700002670288086, -0.9416007995605469, 0.7763299942016602, -5.675745964050293, 1.353165626525879, 0.46933937072753906, 0.027472257614135742, 0.51275634765625, 0.5334844589233398, 1.8059391975402832, -0.24209117889404297, -7.311697006225586, -0.01975393295288086, 0.005687236785888672, -0.4506998062133789, 0.13034629821777344, -3.1953463554382324, -0.017852783203125, 0.4062614440917969, -1.7825603485107422, -0.017416000366210938, -8.83405590057373, -3.1542139053344727, -0.511012077331543, -0.5452756881713867, -1.2429578304290771, 1.4397954940795898, 0.20627498626708984, -0.9641649723052979, 1.0786457061767578, 0.032047271728515625, 0.7415323257446289, -1.5381078720092773, -0.059627532958984375, 1.8573466539382935, 0.9002561569213867, 0.5201282501220703, -0.14512062072753906, 0.7426576614379883, 2.2846930027008057, 1.8708295822143555, -0.02723407745361328, -1.7831335067749023, 1.4612903594970703, 1.180811882019043, -8.053053855895996, 0.7312631607055664, 0.5805504322052002, 0.4497337341308594, 0.5005683898925781, 1.7843279838562012, -4.098364353179932, 0.8057470321655273, 0.5320930480957031, 1.0722007751464844, 0.5988059043884277, 0.15608692169189453, 0.7262725830078125, 0.9615230560302734, -0.23428630828857422, -1.3314809799194336, 0.17707347869873047, 0.7498350143432617, -5.124878883361816, 1.1396799087524414, 0.4343223571777344, -9.204757690429688, 1.0984745025634766, 0.49500560760498047, -4.302243232727051, -3.573045492172241, 0.4059123992919922, 1.4612903594970703, 0.3693723678588867, -2.160095691680908, 0.40827178955078125, 0.4902665615081787, 0.9142930507659912, 0.6660079956054688, 1.2703371047973633, 1.0723817348480225, -0.44375085830688477, 0.10466766357421875, 0.44718748331069946, 1.0722007751464844, 1.7610797882080078, -0.3867912292480469, -8.577520370483398, 0.1740579605102539, 1.5562419891357422, 1.6749401092529297, -0.19898128509521484, -0.3998870849609375, 1.179459571838379, 0.4696836471557617, 1.5186729431152344, -0.8593058586120605, 1.7215185165405273, 2.2553205490112305, 0.5573902130126953, 0.5131340026855469, -1.532792091369629, 1.5047483444213867, -1.8052635192871094, 1.7409086227416992, 1.3951064348220825, -0.35519981384277344, 1.6646682024002075, -0.43615150451660156, 1.683537483215332, -0.034932613372802734, 1.899740219116211, 1.1797943115234375, 2.267515182495117, 4.534145355224609, 0.8168401718139648, 1.2079968452453613, 3.6737563610076904, -1.1111955642700195, 0.7127199172973633, 0.4526681900024414, 0.5131340026855469, -0.6030988693237305, -0.40356898307800293, -5.053631782531738, -0.22024297714233398, 2.5082712173461914, 0.13383042812347412, -1.0658650398254395, -0.12140464782714844, 0.8432753086090088, 0.26412463188171387, -0.8501033782958984, -7.925854206085205, 0.5798623561859131, 1.3576998710632324, 0.31027817726135254, 2.394315719604492, -0.57183837890625, -14.968655586242676, -3.1779000759124756, 2.8276596069335938, 1.1946773529052734, 0.8168401718139648, 0.9804182052612305, 0.5749568939208984, -2.3255624771118164, -0.019775390625, -3.012058973312378, 1.8636484146118164, -5.3047051429748535, -1.386190414428711, 1.8708295822143555, -1.6997489929199219, 2.4012463092803955, 0.4526681900024414, 0.525586724281311, -1.4419355392456055, 0.8693442344665527, -0.08868026733398438, 1.7297577857971191, 0.8468418121337891, 0.7283082008361816, 0.4343223571777344, 1.4382238388061523, 1.6854310035705566, 0.36899375915527344, 1.137068748474121, 0.261932373046875, -0.8547143936157227, 0.7984918355941772, -3.1675987243652344, 1.5924606323242188, -8.057571411132812, 0.6250839233398438, -0.2490997314453125, 0.06631159782409668, 0.8291463851928711, 0.7506973743438721, 0.4074430465698242, 0.07593607902526855, 0.033501625061035156, -0.3356914520263672, -3.9118523597717285, 1.4893324375152588, 1.2252168655395508, -0.8887701034545898, 0.3224678039550781, 1.5186729431152344, -1.6445093154907227, 0.711733341217041, 0.26900625228881836, -2.051420211791992, -0.0010066032409667969, -0.019003868103027344, 2.713062286376953, 1.3631668090820312, -1.0549421310424805, -0.3391597270965576, 0.10917901992797852, -0.21067047119140625, -0.3842010498046875, 0.22896084189414978, 0.4938945770263672, -0.1172189712524414, -0.07422637939453125, -0.4085664749145508, -1.8103351593017578, 0.640533447265625, -4.757082939147949, 1.333573341369629], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 50160, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 50160, "last_target_update_ts": 14336, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -378.1921111047268, "episode_reward_mean": -156.53004569001496, "episode_len_mean": 297.28125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5481814423910604, "mean_inference_ms": 22.402824289703705, "mean_action_processing_ms": 0.14155224178572773, "mean_env_wait_ms": 4.613032686468154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -378.1921111047268, "episode_reward_mean": -156.53004569001496, "episode_len_mean": 297.28125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5481814423910604, "mean_inference_ms": 22.402824289703705, "mean_action_processing_ms": 0.14155224178572773, "mean_env_wait_ms": 4.613032686468154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 50160, "num_env_steps_sampled": 14336, "num_env_steps_trained": 50160, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 14336, "agent_timesteps_total": 14336, "timers": {"training_iteration_time_ms": 334.152, "learn_time_ms": 69.977, "learn_throughput": 3429.696, "synch_weights_time_ms": 20.388}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 50160, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 50160, "last_target_update_ts": 14336, "num_target_updates": 27}, "done": false, "episodes_total": 32, "training_iteration": 14, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-18-47", "timestamp": 1655500727, "time_this_iter_s": 5.303976774215698, "time_total_s": 69.54430103302002, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 69.54430103302002, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 30.5875, "ram_util_percent": 61.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -7.926713943481445, "min_q": -21.57561492919922, "max_q": 8.357511520385742, "mean_td_error": 0.997894823551178}, "td_error": [1.4295001029968262, 1.0940003395080566, 0.49578139185905457, 0.19791793823242188, 3.27457332611084, 3.9492173194885254, 0.21721982955932617, 1.1896743774414062, 3.0976014137268066, -1.3912816047668457, 2.991771697998047, -0.04725074768066406, 1.89682936668396, 1.740243911743164, -0.080474853515625, 0.33708620071411133, 1.343759536743164, -0.38840246200561523, 0.9365248680114746, 2.0049877166748047, 2.368413209915161, 1.3911552429199219, 0.35849952697753906, -0.14899754524230957, 3.064418315887451, 0.42725372314453125, 3.0064525604248047, 0.6255874633789062, 0.7121238708496094, 0.6229419708251953, 1.06837797164917, 1.5766029357910156, 0.32704591751098633, 2.46893572807312, 0.4095633029937744, 0.42592334747314453, 0.5641212463378906, -17.724184036254883, 2.4063987731933594, 2.5089187622070312, 1.3208999633789062, 0.9978370666503906, 1.1825013160705566, 1.9617080688476562, 0.23432350158691406, 3.950870990753174, -2.425354480743408, 1.883803367614746, 2.2558422088623047, -0.6318130493164062, 1.9294795989990234, -0.4877411127090454, 0.5429247617721558, 3.4389455318450928, 3.0064525604248047, 3.7332277297973633, 2.2504005432128906, 4.306892395019531, 2.4438071250915527, 2.7524490356445312, 3.196531295776367, -2.1267595291137695, 1.054344892501831, 0.43671560287475586, 1.7816810607910156, -0.5471169948577881, -0.4644908905029297, 1.4102973937988281, 0.6637812852859497, 1.7928409576416016, 0.22153854370117188, 1.4284515380859375, 1.5088529586791992, 3.384060859680176, 2.2161741256713867, -0.6108379364013672, -2.2553367614746094, -6.447089195251465, 2.1675820350646973, 2.0958261489868164, -0.28148460388183594, 2.2070770263671875, 1.407475471496582, 5.846163272857666, 0.6924612522125244, 1.655217170715332, 1.343759536743164, 1.1857630014419556, 0.5566654205322266, 3.7854766845703125, 3.8698368072509766, 2.005025863647461, -8.05172348022461, 1.4295001029968262, 1.0616483688354492, -0.8274955749511719, 1.8148984909057617, 0.912738561630249, 2.828542709350586, 1.8262042999267578, -0.1529374122619629, 1.9486627578735352, -0.535853385925293, -2.9721860885620117, 1.137247085571289, 2.1408863067626953, 2.899474859237671, 0.17758941650390625, -0.799633264541626, 4.016033172607422, 2.7524490356445312, -0.017415523529052734, -0.4571075439453125, 1.6053924560546875, 1.309661865234375, 1.1480989456176758, -1.274137258529663, 0.7676230669021606, 3.3497114181518555, 3.3699655532836914, -0.7799777984619141, 0.9046854972839355, 2.3776984214782715, 3.224360466003418, 0.052491188049316406, 4.296867370605469, 4.420637130737305, 0.5080928802490234, 1.4107894897460938, 1.0118465423583984, 1.2685070037841797, 0.43732452392578125, -1.3351274728775024, -10.343828201293945, 0.38480567932128906, 1.8938961029052734, 1.1759767532348633, 0.5987606048583984, 1.1833534240722656, 1.0799005031585693, 1.4627132415771484, -0.7048687934875488, 0.5643730163574219, 1.31634521484375, 0.4837512969970703, -0.16108417510986328, 0.9938735961914062, -1.1499652862548828, -0.7686061859130859, 2.2952346801757812, -0.49163818359375, 0.42434120178222656, 1.2274675369262695, -0.5200004577636719, 2.227510452270508, 1.6177597045898438, 1.213372826576233, 3.1241140365600586, 3.6269044876098633, 0.3649406433105469, 2.5976099967956543, 1.0986061096191406, 2.271838665008545, 2.448300361633301, 1.080080509185791, 1.5809129476547241, 1.430473804473877, -1.1544818878173828, -0.7617168426513672, -1.9458513259887695, 0.9273338317871094, 4.789398193359375, 3.536475658416748, 0.2386322021484375, 0.5564169883728027, 2.3610830307006836, -0.047222137451171875, -0.409942626953125, -4.945213317871094, 1.3618699312210083, 3.8698368072509766, 0.07335337996482849, 1.1564197540283203, 3.6605024337768555, 1.4335895776748657, -8.101569175720215, -2.5676698684692383, 1.2040348052978516, 3.6451897621154785, 0.22577977180480957, 2.6193923950195312, 1.0334033966064453, 1.4586048126220703, 0.6387662887573242, -1.2141132354736328, 0.7400102615356445, 1.6341495513916016, 0.7997226715087891, 3.4209976196289062, 1.3911552429199219, -0.7206549644470215, 1.770747184753418, 4.18284797668457, 1.461801528930664, 1.2685775756835938, 2.5214099884033203, 2.1524229049682617, -8.908596992492676, 4.621595859527588, 1.7877311706542969, 1.9601621627807617, 1.4450297355651855, 1.031325101852417, -0.4705812931060791, 1.5088529586791992, 2.855118751525879, 1.3208999633789062, -0.6843156814575195, 5.228216171264648, 4.19654655456543, 3.000509262084961, -0.6276626586914062, 2.223278045654297, 2.006084680557251, 0.5462028980255127, 1.2195854187011719, 0.618896484375, -0.1406688690185547, 1.1408672332763672, 0.914271354675293, 1.5656042098999023, 4.375026702880859, 0.8054924011230469, 0.6399960517883301, 0.6189572215080261, 0.1043400764465332, 2.0073795318603516, -0.28961658477783203, 2.1362996101379395, 1.0624046325683594], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 54000, "last_target_update_ts": 15360, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -544.4055313915014, "episode_reward_mean": -184.94368666392273, "episode_len_mean": 306.8536585365854, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.546351871649022, "mean_inference_ms": 22.594087805078992, "mean_action_processing_ms": 0.1424170626854876, "mean_env_wait_ms": 4.52564996830337, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -544.4055313915014, "episode_reward_mean": -184.94368666392273, "episode_len_mean": 306.8536585365854, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.546351871649022, "mean_inference_ms": 22.594087805078992, "mean_action_processing_ms": 0.1424170626854876, "mean_env_wait_ms": 4.52564996830337, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 15360, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 15360, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 387.776, "learn_time_ms": 70.029, "learn_throughput": 3427.146, "synch_weights_time_ms": 19.886}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 54000, "last_target_update_ts": 15360, "num_target_updates": 29}, "done": false, "episodes_total": 41, "training_iteration": 15, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-18-54", "timestamp": 1655500734, "time_this_iter_s": 6.12398362159729, "time_total_s": 75.66828465461731, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 75.66828465461731, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.255555555555556, "ram_util_percent": 61.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.816926956176758, "min_q": -23.46959114074707, "max_q": 9.20337200164795, "mean_td_error": 0.10201462358236313}, "td_error": [0.9830398559570312, -1.1562533378601074, 3.407078742980957, 2.222198486328125, -1.5009112358093262, 0.051520347595214844, -0.3527870178222656, 1.5391864776611328, -13.94680118560791, 0.28084611892700195, 0.503361701965332, 1.4692816734313965, -0.3788590431213379, -0.4350433349609375, 0.4975242614746094, -1.010714054107666, 0.6246166229248047, -0.8597065210342407, 1.8913383483886719, -0.9320335388183594, 1.090667724609375, -0.8231525421142578, 0.158447265625, -0.5501613616943359, -1.3655471801757812, 0.2866668701171875, 1.0369762182235718, 0.3645610809326172, -1.216984748840332, 3.692070960998535, 1.128061294555664, -4.412930488586426, 2.147392749786377, -2.1232666969299316, -0.4343700408935547, -0.12736797332763672, -0.7193450927734375, 2.216273307800293, 2.283538818359375, 2.283538818359375, -1.1232633590698242, 0.4703359603881836, 0.8449149131774902, -1.773691177368164, 1.683481216430664, 0.9424104690551758, 1.3526191711425781, -0.045554161071777344, 0.3819580078125, -0.13591766357421875, 0.7405109405517578, 1.411478042602539, -1.6966853141784668, 0.6730594635009766, -5.047214508056641, -0.4629535675048828, 1.6741266250610352, 1.634984016418457, 1.7585830688476562, 1.1654248237609863, 1.2947888374328613, -1.1397426128387451, 0.9382889270782471, 2.443584442138672, 1.8675204515457153, 1.0698823928833008, 0.7925834655761719, 0.041912078857421875, -6.746649742126465, 0.3111429214477539, -1.350912094116211, 1.4647350311279297, -2.1963748931884766, 1.0324163436889648, -1.349508285522461, 1.208456039428711, 2.893949508666992, 0.7622108459472656, -0.1515331268310547, 0.26618385314941406, 1.1727702617645264, 0.3466625213623047, -0.19015121459960938, 0.7648239135742188, -4.412446975708008, 2.05084490776062, 0.07610225677490234, 0.503361701965332, 0.9011712074279785, 1.6107282638549805, 1.0634765625, 1.8712759017944336, -8.590532302856445, 3.489602565765381, -0.3095989227294922, -5.99765682220459, 1.135580062866211, 2.2514758110046387, 1.0387306213378906, -0.057288169860839844, 1.283782958984375, -1.2318668365478516, -0.3442115783691406, 1.1742706298828125, 0.36083412170410156, 1.5784907341003418, 0.7925834655761719, 1.2935123443603516, -0.3010101318359375, 1.9898643493652344, 0.7267237901687622, 0.09082651138305664, -0.14315634965896606, 0.8688681125640869, 0.4137554168701172, 2.524470329284668, 1.283782958984375, -1.5470771789550781, 2.0232276916503906, -0.5841808319091797, 1.1864547729492188, 0.13345909118652344, 0.07717132568359375, 1.3902530670166016, 2.089478015899658, -0.1089329719543457, 0.11506104469299316, -0.8161578178405762, -2.586393356323242, 0.23049545288085938, -1.0939788818359375, 1.6509071588516235, -1.8437581062316895, 1.8854942321777344, 0.4260387420654297, 3.7253341674804688, 1.1276965141296387, 1.8001890182495117, -6.253290176391602, 0.38918304443359375, 1.2979393005371094, 0.3022465705871582, 1.7697668075561523, 0.9973869323730469, -1.405466079711914, -0.7897539138793945, -0.0775754451751709, -0.5766534805297852, 0.015054702758789062, 1.3172683715820312, -0.16372454166412354, 1.2744719982147217, -2.643101692199707, -0.14276504516601562, -1.111663818359375, 1.1872272491455078, -0.33783769607543945, 1.1276965141296387, -5.3163957595825195, 0.8870766162872314, -5.724204063415527, -0.34505748748779297, 0.8058338165283203, 2.8711040019989014, 0.8435420989990234, 3.7933578491210938, 1.0031280517578125, -0.6359727382659912, 0.4972858428955078, 0.5324029922485352, 1.2324256896972656, -8.337875366210938, 1.0501117706298828, 1.0031280517578125, 1.2744719982147217, 2.2143988609313965, 1.374849796295166, 0.7220675945281982, 1.4839943647384644, -1.1295843124389648, 0.041912078857421875, 0.9597153663635254, 0.0076446533203125, 0.4393291473388672, -0.37207746505737305, -0.35392796993255615, 0.42371559143066406, 1.2829322814941406, -5.047214508056641, 0.4957313537597656, 1.2083015441894531, -2.2986745834350586, 0.5806655883789062, 2.9442968368530273, -7.564279556274414, 1.7333307266235352, 1.246145248413086, 1.8043293952941895, -1.7202033996582031, 0.3219308853149414, -0.6097304821014404, 0.1505117416381836, -0.31317615509033203, 0.3985004425048828, 0.9621133804321289, -5.882152557373047, 0.6156892776489258, -7.127932548522949, 0.6200313568115234, -0.5645980834960938, 0.5478515625, -2.1284685134887695, 1.4746711254119873, 0.14121484756469727, 0.9726834297180176, -0.4373140335083008, 1.8741874694824219, -0.4298849105834961, 1.3440666198730469, 1.5233440399169922, 1.8221569061279297, 2.3258438110351562, -0.9969844818115234, 0.49942684173583984, 0.7348423004150391, -0.9611024856567383, 1.7333307266235352, 0.594935417175293, 0.18119001388549805, 2.9442968368530273, 1.5385856628417969, 0.06093788146972656, 0.11507070064544678, 2.9216268062591553, 0.4394359588623047, 0.8015956878662109, 0.07878631353378296, 0.12101781368255615, -1.9155387878417969, -0.17238616943359375], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 57840, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 57840, "last_target_update_ts": 16384, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -544.4055313915014, "episode_reward_mean": -206.79256345347866, "episode_len_mean": 315.5869565217391, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5422946350139412, "mean_inference_ms": 22.647587334356682, "mean_action_processing_ms": 0.14258070513083032, "mean_env_wait_ms": 4.468736541913972, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -544.4055313915014, "episode_reward_mean": -206.79256345347866, "episode_len_mean": 315.5869565217391, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5422946350139412, "mean_inference_ms": 22.647587334356682, "mean_action_processing_ms": 0.14258070513083032, "mean_env_wait_ms": 4.468736541913972, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 57840, "num_env_steps_sampled": 16384, "num_env_steps_trained": 57840, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 16384, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 316.486, "learn_time_ms": 70.705, "learn_throughput": 3394.406, "synch_weights_time_ms": 19.389}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 57840, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 57840, "last_target_update_ts": 16384, "num_target_updates": 31}, "done": false, "episodes_total": 46, "training_iteration": 16, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-18-59", "timestamp": 1655500739, "time_this_iter_s": 5.310842514038086, "time_total_s": 80.9791271686554, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 80.9791271686554, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.228571428571428, "ram_util_percent": 61.35714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -7.771392822265625, "min_q": -25.472248077392578, "max_q": 9.7882080078125, "mean_td_error": -0.359700471162796}, "td_error": [0.4781837463378906, 1.0833854675292969, -1.2306365966796875, 1.3659934997558594, 0.935664176940918, 0.3107261657714844, 0.24477481842041016, -3.1864471435546875, 1.8621759414672852, -1.5815410614013672, 2.485147476196289, -0.4695253372192383, 0.7034153938293457, -0.9950381517410278, -0.9851751327514648, -0.4876136779785156, -3.149937391281128, 0.7432408332824707, 1.1085891723632812, 1.973794937133789, 0.6685028076171875, 1.6606321334838867, -0.03213691711425781, 0.8447437286376953, -0.8314380645751953, 0.23270606994628906, -3.2493667602539062, -1.3039374351501465, -2.662243366241455, -0.9640464782714844, -1.160170555114746, -2.8227362632751465, -0.610137939453125, -2.2524538040161133, -0.6275362968444824, 0.64434814453125, -0.044205665588378906, 2.716874122619629, 1.1127829551696777, -0.1645340919494629, 0.7850828170776367, -0.3096466064453125, 0.3637418746948242, 2.388916492462158, -4.9472975730896, -0.23527145385742188, -1.0517301559448242, -3.3918309211730957, 0.12455558776855469, -0.18712568283081055, -1.4116768836975098, 0.41820061206817627, 0.9029827117919922, 0.9316349029541016, 0.35764122009277344, 2.4434080123901367, 0.8099071979522705, 0.9114389419555664, -1.529304027557373, 0.8062953948974609, -1.0830349922180176, -1.6655092239379883, -2.271270751953125, -0.12397289276123047, -0.10828971862792969, -1.1966924667358398, 0.5668129920959473, -3.147798538208008, 0.6328802108764648, -3.5796854496002197, -0.7667781114578247, 1.7032818794250488, 1.155977725982666, -0.5276241302490234, -1.279465675354004, -1.0336780548095703, 0.5784835815429688, 0.27857398986816406, -0.1771230697631836, -0.044205665588378906, 1.5987462997436523, 0.44930458068847656, -7.601395130157471, 0.9295845031738281, 0.2808566093444824, -2.8642516136169434, 0.9061222076416016, 0.6124304533004761, 0.12500858306884766, -0.2893257141113281, 0.010793447494506836, -0.4566526412963867, -1.279465675354004, 1.9146695137023926, 0.7258815765380859, -0.17536354064941406, -1.1770439147949219, -0.8047084808349609, 0.8883914947509766, 0.48623085021972656, -0.022938251495361328, -0.20988881587982178, -0.792262077331543, 0.7456798553466797, -1.2327218055725098, 0.3913431167602539, -1.632547378540039, 0.27857398986816406, -0.7222919464111328, -0.3137187957763672, 1.8750457763671875, -1.5758552551269531, 0.4682927131652832, 0.4622154235839844, -0.6351959705352783, -0.01149129867553711, 1.7245981693267822, 0.8167743682861328, 0.3324260711669922, 0.13310623168945312, 0.6167854070663452, 0.13418197631835938, 0.6926279067993164, 1.3659934997558594, -0.02229785919189453, 1.0458550453186035, 0.8447437286376953, 0.5511264801025391, 0.8615779876708984, 0.3444404602050781, -3.3195924758911133, -0.6365506649017334, -14.451144218444824, -1.5918655395507812, -1.0241858959197998, 1.0341224670410156, -0.6022383570671082, 0.8488960266113281, 1.0622692108154297, -2.271270751953125, 0.4182429313659668, 0.13310623168945312, -0.6001834869384766, 1.4371743202209473, 1.743936538696289, 0.6249251365661621, 1.7125110626220703, -2.811640501022339, -24.136608123779297, -0.8630952835083008, -1.2037944793701172, 0.759033203125, -0.37392616271972656, -3.13623309135437, 0.2162036895751953, -2.3600826263427734, 1.5156736373901367, 1.4547333717346191, -2.9436187744140625, 2.4080400466918945, 2.077136993408203, 0.08079957962036133, 1.0748200416564941, 1.5189886093139648, -1.0934454202651978, 0.3913431167602539, 0.26396751403808594, 1.960952877998352, -1.1766674518585205, -2.6521921157836914, 1.1119937896728516, -0.2777061462402344, 1.276158332824707, -0.2218608856201172, -1.0293235778808594, 0.6177209615707397, -5.674099922180176, -6.209461212158203, -0.6407337188720703, -0.030098915100097656, -1.3185462951660156, 1.1590137481689453, 0.9010581970214844, 0.5719795227050781, 0.40010929107666016, -0.009813308715820312, 1.2643556594848633, -1.6375658512115479, -0.6096620559692383, 0.5263071060180664, -2.7640581130981445, 1.649641990661621, -0.413543701171875, 0.09138107299804688, 1.1127829551696777, 0.7124342918395996, -2.5271730422973633, -0.949435830116272, 1.973794937133789, -0.09770393371582031, -11.564319610595703, 0.5938968658447266, 1.537191390991211, 2.622546672821045, 0.0034275054931640625, 1.304990291595459, 1.143423080444336, 1.1620960235595703, -0.664555549621582, 1.0656232833862305, -2.58085036277771, 0.5596523284912109, 1.1964969635009766, 1.2545604705810547, -1.203625202178955, 0.23828697204589844, 3.2081680297851562, -1.1554412841796875, 0.7172272205352783, 1.0458550453186035, -0.7612285614013672, -0.6668977737426758, 0.9029827117919922, -0.28925323486328125, 2.450605869293213, 1.2430362701416016, 0.08079957962036133, 0.9010581970214844, -1.7715282440185547, -2.3495962619781494, -0.8203048706054688, -3.0894088745117188, 0.3954448699951172, 0.04374122619628906, 1.1209979057312012, -0.5084619522094727, -0.21372604370117188, -0.9490933418273926, 0.5967470407485962, -6.824781894683838], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 61680, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 61680, "last_target_update_ts": 17408, "num_target_updates": 33}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -216.47063773585126, "episode_len_mean": 318.4468085106383, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5406963302124601, "mean_inference_ms": 22.65643196708854, "mean_action_processing_ms": 0.1429451212934482, "mean_env_wait_ms": 4.45852865637545, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -216.47063773585126, "episode_len_mean": 318.4468085106383, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5406963302124601, "mean_inference_ms": 22.65643196708854, "mean_action_processing_ms": 0.1429451212934482, "mean_env_wait_ms": 4.45852865637545, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 61680, "num_env_steps_sampled": 17408, "num_env_steps_trained": 61680, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 17408, "agent_timesteps_total": 17408, "timers": {"training_iteration_time_ms": 321.491, "learn_time_ms": 71.213, "learn_throughput": 3370.173, "synch_weights_time_ms": 19.789}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 61680, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 61680, "last_target_update_ts": 17408, "num_target_updates": 33}, "done": false, "episodes_total": 47, "training_iteration": 17, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-19-04", "timestamp": 1655500744, "time_this_iter_s": 5.061810493469238, "time_total_s": 86.04093766212463, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 86.04093766212463, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.0125, "ram_util_percent": 61.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -7.184494972229004, "min_q": -27.620784759521484, "max_q": 10.520685195922852, "mean_td_error": -0.14624828100204468}, "td_error": [-0.8441333770751953, 2.4990592002868652, -0.07174015045166016, -1.2311339378356934, 1.5777530670166016, 2.284090042114258, 1.4580554962158203, 0.07574653625488281, 1.7483720779418945, 0.791168212890625, 0.9318504333496094, 2.0001163482666016, -1.223581314086914, -0.09872579574584961, -2.184476137161255, -1.308767318725586, 2.3656935691833496, 4.660428047180176, -2.6852965354919434, 0.8485183715820312, -0.2680187225341797, -0.017459869384765625, -15.39431381225586, -1.2143898010253906, 0.4018688201904297, -0.9997255802154541, 0.9054927825927734, 0.7073898315429688, 2.4302139282226562, 2.6978631019592285, 2.5845470428466797, -0.1580791473388672, 2.547257900238037, 0.29813385009765625, 0.22978699207305908, -6.146492004394531, 1.0640583038330078, 0.5914688110351562, -0.16180849075317383, 2.039706230163574, 1.6967084407806396, -0.7481555938720703, 1.1640729904174805, 0.43189430236816406, -1.9221038818359375, 0.9652252197265625, 0.05698204040527344, 1.522308349609375, -1.2472548484802246, -1.308767318725586, 0.5840263366699219, -4.655089378356934, 1.3170242309570312, -0.05768299102783203, 1.0875940322875977, -0.05768299102783203, 0.2009115219116211, 0.003933429718017578, -0.3215770721435547, 1.7399873733520508, -3.7243824005126953, 1.5389156341552734, 0.21819639205932617, 0.511033296585083, -1.8080921173095703, 0.1508626937866211, -0.530853271484375, -0.03930330276489258, 2.096982479095459, -10.146260261535645, 1.3656291961669922, -1.110886573791504, -0.5915565490722656, 1.1295617818832397, 1.3813767433166504, 1.0929102897644043, -9.139816284179688, 1.1486186981201172, -0.144561767578125, 0.09124171733856201, 1.9486379623413086, 3.4584875106811523, -0.1860804557800293, 0.9597244262695312, -0.9804227352142334, 0.484128475189209, -0.4779644012451172, 1.3625030517578125, 0.7624397277832031, 0.3236064910888672, 1.5992515087127686, 1.3879756927490234, -3.6246118545532227, 0.28789329528808594, -2.769711494445801, 0.8899469375610352, 0.9791774749755859, 1.3394813537597656, 0.5178909301757812, 2.0184850692749023, 1.4061710834503174, 2.6383285522460938, -4.387983322143555, 1.003103256225586, 1.7801127433776855, -1.864366054534912, -7.602341651916504, -5.320120811462402, 0.5316133499145508, 0.5330314636230469, 0.022009849548339844, 0.18214702606201172, -0.005224466323852539, -0.16858386993408203, -0.856297492980957, 0.8612213134765625, 1.1674346923828125, 5.16365385055542, 1.0213565826416016, 3.262269973754883, -9.896252632141113, 0.2783975601196289, 1.335866928100586, -1.4622254371643066, 1.080678939819336, 0.7439002990722656, 3.604764938354492, 0.45617103576660156, -1.493906021118164, -2.7781143188476562, -1.305689811706543, 1.615760326385498, -0.19968891143798828, -0.5462813377380371, -6.899971008300781, -1.3318581581115723, 2.150336265563965, 0.05698204040527344, 1.93812096118927, 0.9191877841949463, -0.1197519302368164, 0.9226059913635254, -0.005224466323852539, 0.5668563842773438, -0.7278709411621094, -0.9324431419372559, -0.32213497161865234, 1.3260178565979004, 3.354323387145996, -9.017406463623047, -0.18539810180664062, 2.025085926055908, 0.6603031158447266, 1.5280838012695312, 0.36452484130859375, 1.2648391723632812, 0.3046567440032959, 1.0097360610961914, -1.4830262660980225, 1.1273059844970703, 0.11672592163085938, 1.1905534267425537, 0.4985027313232422, -0.2335820198059082, 1.8338265419006348, -0.8818683624267578, 1.9321184158325195, -5.723146438598633, 0.2248544692993164, 7.871382236480713, 1.9486379623413086, -10.728126525878906, 1.119624137878418, 1.8590097427368164, 1.011362075805664, -7.052189826965332, 1.1006441116333008, -0.6501264572143555, 1.5249404907226562, 0.38202857971191406, 0.7359218597412109, -0.9764761924743652, 1.2869858741760254, 0.5825634002685547, 2.173243999481201, 0.2248544692993164, -0.4940667152404785, 1.880995750427246, 0.9260983467102051, 1.022486686706543, -0.9082159996032715, 0.8352365493774414, 0.6685771942138672, -1.4403362274169922, -5.96628475189209, 2.2344493865966797, -2.018016815185547, 0.42378807067871094, 1.3260178565979004, 0.9950063228607178, 0.38202857971191406, -6.899971008300781, -1.8393230438232422, -0.6176935434341431, -0.37452125549316406, 2.278064727783203, 0.42409706115722656, -7.366522789001465, 0.7962732315063477, -0.32376670837402344, 1.7569057941436768, 1.6173510551452637, -2.483412265777588, 0.45734184980392456, -4.578132629394531, 1.7396771907806396, 1.440467119216919, -0.6824650764465332, 3.1676368713378906, 1.5273714065551758, -0.5370573997497559, 0.8268518447875977, 0.67138671875, -0.20772194862365723, 2.3431413173675537, 1.3625030517578125, -5.145110130310059, 0.644071102142334, -0.6391665935516357, 1.3445796966552734, 1.5339884757995605, 0.5320773124694824, 0.8730261325836182, -5.638615608215332, 0.8690280914306641, -1.66318941116333, -8.555005073547363, 2.1948204040527344, -4.814746856689453, 0.37804126739501953], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 65520, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 65520, "last_target_update_ts": 18432, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -225.05276686682677, "episode_len_mean": 320.9583333333333, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392018500128435, "mean_inference_ms": 22.66959092622181, "mean_action_processing_ms": 0.1427304857516272, "mean_env_wait_ms": 4.446571090389335, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -225.05276686682677, "episode_len_mean": 320.9583333333333, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392018500128435, "mean_inference_ms": 22.66959092622181, "mean_action_processing_ms": 0.1427304857516272, "mean_env_wait_ms": 4.446571090389335, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 65520, "num_env_steps_sampled": 18432, "num_env_steps_trained": 65520, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 18432, "agent_timesteps_total": 18432, "timers": {"training_iteration_time_ms": 312.787, "learn_time_ms": 71.076, "learn_throughput": 3376.678, "synch_weights_time_ms": 19.726}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 65520, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 65520, "last_target_update_ts": 18432, "num_target_updates": 35}, "done": false, "episodes_total": 48, "training_iteration": 18, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-19-10", "timestamp": 1655500750, "time_this_iter_s": 5.256013870239258, "time_total_s": 91.29695153236389, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 91.29695153236389, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.85714285714286, "ram_util_percent": 61.557142857142864}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.521434783935547, "min_q": -30.235469818115234, "max_q": 9.899673461914062, "mean_td_error": -0.227351576089859}, "td_error": [1.382796287536621, -1.0420198440551758, -1.1413817405700684, 3.047647476196289, -2.418215274810791, 0.21555614471435547, -0.6614978313446045, -0.72589111328125, 3.1793808937072754, -0.7713680267333984, 2.349306106567383, 0.6243038177490234, 1.101712703704834, 1.532268762588501, 1.7965989112854004, 1.2264480590820312, 1.7414236068725586, 0.8075141906738281, 0.8141522407531738, -0.038435935974121094, 0.9992904663085938, -0.20074844360351562, -0.051303863525390625, 3.8450546264648438, -0.09852218627929688, 0.2884254455566406, -1.1241140365600586, 0.7592811584472656, 1.7308673858642578, 0.4141197204589844, 0.0158233642578125, 2.4911880493164062, -0.42923545837402344, -0.038435935974121094, -0.3059682846069336, -0.45494556427001953, 1.167407751083374, -0.034218788146972656, -0.07158088684082031, 2.873030185699463, -8.862960815429688, 2.185528516769409, -1.2169189453125, -0.33306455612182617, -1.2129554748535156, -0.11205673217773438, 0.38953179121017456, 1.9907152652740479, 0.25853919982910156, 0.11856770515441895, -0.8051162958145142, 0.28392791748046875, 0.1913127899169922, 0.5673151016235352, -2.3285534381866455, -1.4117465019226074, -3.8315367698669434, -1.8438854217529297, -0.023927688598632812, 1.5512380599975586, 0.3022289276123047, 1.1509194374084473, -0.26709842681884766, -2.405749559402466, 2.1143670082092285, -1.4743351936340332, -8.13298225402832, 0.17990684509277344, -1.34375, 1.8992903232574463, -0.9089760780334473, -0.04307365417480469, -1.45820951461792, -0.41499900817871094, -0.07158088684082031, 0.6742939949035645, 0.3191390037536621, -0.7525348663330078, 0.11622238159179688, -0.2767972946166992, 1.126173973083496, -0.45602893829345703, -0.07378679513931274, -0.32333850860595703, -0.6531486511230469, 0.2106952667236328, 0.48753249645233154, 1.477590560913086, -2.3146018981933594, -2.1508946418762207, -0.31797313690185547, -2.3661746978759766, 1.2242851257324219, 0.1419672966003418, 1.6135330200195312, -0.9035797119140625, -0.3057727813720703, -0.7553050518035889, -0.8750162124633789, -0.5905628204345703, 1.2590961456298828, 2.356316566467285, -0.24042892456054688, -1.79852294921875, -7.933529853820801, -0.45494556427001953, 0.5898563265800476, -4.960283279418945, -6.867937088012695, -4.854686737060547, 0.46443653106689453, 0.6782124042510986, -0.15380287170410156, 1.067076563835144, -0.13355445861816406, 2.566987991333008, 1.054408073425293, 1.8420906066894531, -1.4723453521728516, -6.683052062988281, -1.5594286918640137, 1.3400497436523438, -0.10933136940002441, -0.2577953338623047, 0.28132009506225586, 0.5228424072265625, -2.1637558937072754, -0.3907032012939453, 0.41025352478027344, 0.4915904998779297, 0.6238207817077637, -0.808161735534668, 0.5911140441894531, 1.2264480590820312, 1.0544490814208984, -2.8041725158691406, 0.17734527587890625, 1.5792369842529297, -0.16767120361328125, -0.3444828987121582, 0.5993747711181641, 0.7876796722412109, 0.07726192474365234, -2.084718704223633, -7.391479015350342, -0.8750162124633789, 0.45603132247924805, -0.5905628204345703, 0.39163684844970703, 1.7487850189208984, 0.628044605255127, -2.3409652709960938, -1.2632598876953125, -0.7541184425354004, 1.4818196296691895, 0.4536594748497009, -0.013216018676757812, 1.8585758209228516, -0.9390344619750977, 1.2821197509765625, -1.4012908935546875, 1.1950860023498535, -0.48650360107421875, 0.5605274438858032, 2.9160897731781006, 1.805917739868164, -0.8640918731689453, 1.7680110931396484, 1.153848648071289, -1.6843738555908203, 0.1485452651977539, -2.396451950073242, 0.9191631078720093, 0.06444975733757019, 1.2033138275146484, 0.05236244201660156, 1.3673007488250732, -0.7561664581298828, -1.219900131225586, -1.5268611907958984, 1.5352859497070312, 0.796760082244873, 1.7263765335083008, 0.9793987274169922, -0.35878944396972656, 0.47223758697509766, -0.30387812852859497, 0.10447120666503906, -0.37511444091796875, 0.2556953430175781, -0.919273853302002, -1.7849501371383667, 0.6995277404785156, -0.759089469909668, 0.6635465621948242, 1.9676876068115234, -0.7539387941360474, 0.32858848571777344, -0.874699592590332, 0.5688962936401367, 0.4887676239013672, 0.5146865844726562, 2.696352243423462, -2.3711307048797607, -1.6689033508300781, 0.018374204635620117, -1.2367572784423828, 0.8419961929321289, 2.58920955657959, -3.246854782104492, 0.6742939949035645, -0.05945777893066406, 0.700049877166748, -0.8750162124633789, -1.4739627838134766, -5.737044334411621, -6.730173110961914, 1.454573631286621, -0.3938732147216797, -2.941601037979126, 1.9182662963867188, -0.9904522895812988, -0.7021541595458984, -1.2810039520263672, 0.6911468505859375, -0.09385490417480469, 0.0699148178100586, -0.8750162124633789, 0.2027111053466797, -0.10576248168945312, 0.49180126190185547, 0.6463947296142578, 0.8347873687744141, 0.012691497802734375, 2.4079418182373047, -9.984696388244629, 0.3206159472465515, 0.4256248474121094, -2.155935287475586, 0.2888374328613281], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 69360, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 69360, "last_target_update_ts": 19456, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -212.90947860338778, "episode_len_mean": 316.64150943396226, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.540727883210913, "mean_inference_ms": 22.751333735920344, "mean_action_processing_ms": 0.14215847498797735, "mean_env_wait_ms": 4.428196915603126, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -212.90947860338778, "episode_len_mean": 316.64150943396226, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.540727883210913, "mean_inference_ms": 22.751333735920344, "mean_action_processing_ms": 0.14215847498797735, "mean_env_wait_ms": 4.428196915603126, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 69360, "num_env_steps_sampled": 19456, "num_env_steps_trained": 69360, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 19456, "agent_timesteps_total": 19456, "timers": {"training_iteration_time_ms": 361.957, "learn_time_ms": 72.798, "learn_throughput": 3296.805, "synch_weights_time_ms": 19.989}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 69360, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 69360, "last_target_update_ts": 19456, "num_target_updates": 37}, "done": false, "episodes_total": 53, "training_iteration": 19, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-19-16", "timestamp": 1655500756, "time_this_iter_s": 5.678860902786255, "time_total_s": 96.97581243515015, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 96.97581243515015, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.08888888888889, "ram_util_percent": 61.67777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -7.870206832885742, "min_q": -33.229034423828125, "max_q": 12.541717529296875, "mean_td_error": -1.1816247701644897}, "td_error": [-1.3591642379760742, -0.5284910202026367, -0.5828151702880859, -9.174489974975586, 0.6744956970214844, -2.4613125324249268, 0.13812875747680664, -0.8975129127502441, 0.9197244644165039, -1.0957920551300049, -3.604175567626953, 0.08581829071044922, -0.26178932189941406, 1.218247890472412, 0.9471368789672852, -0.45499229431152344, 0.7227082252502441, 0.022827625274658203, -9.04371166229248, 0.5979623794555664, 0.3662106990814209, -0.7164974212646484, 1.2872467041015625, -0.7120475769042969, -0.4411764144897461, -2.2128498554229736, 0.8303499221801758, 0.15637969970703125, -0.8907928466796875, -2.259507179260254, -1.6672821044921875, 0.064453125, -3.5082168579101562, 0.20432281494140625, -1.0836105346679688, -1.960540533065796, 0.15070629119873047, -0.2208099365234375, -4.055302619934082, -0.4755897521972656, -13.456398963928223, -0.55682373046875, -1.267669439315796, 1.5622053146362305, -0.4503173828125, 0.8160946369171143, -0.5534629821777344, 1.1738638877868652, -1.5121030807495117, -4.597439765930176, -0.6049308776855469, -1.6395988464355469, -0.007205009460449219, -0.25466489791870117, -0.9919843673706055, -0.5365033149719238, 0.7998718619346619, -15.296478271484375, -2.1975207328796387, 0.4744100570678711, 0.017742156982421875, -0.33026552200317383, -0.8665574193000793, -1.2853565216064453, 0.5350713729858398, -0.9800586700439453, 0.5614290237426758, -6.787524223327637, -1.1408882141113281, -8.041248321533203, 0.29424285888671875, -5.213237762451172, -0.9181032180786133, -3.2179465293884277, -4.658565998077393, -6.8030900955200195, 0.6209554672241211, -0.9006919860839844, -0.5293960571289062, -0.5396237373352051, -0.5743961334228516, -6.042585849761963, -0.0939030647277832, 0.3315330445766449, -1.191917896270752, -7.787775039672852, -1.4097871780395508, -0.629913330078125, 0.7107727527618408, -2.4576683044433594, -3.0278139114379883, -0.9180135726928711, -0.32591819763183594, 0.06633949279785156, -3.278751850128174, -0.9308595657348633, 0.5186076164245605, 0.25127696990966797, -4.861942291259766, -1.5681095123291016, -0.25565075874328613, -0.8251714706420898, 5.29318904876709, 5.020678520202637, -3.070797920227051, -0.34955406188964844, -0.08864396810531616, -1.1602792739868164, -11.085006713867188, -0.4671597480773926, -0.17632007598876953, 0.029851913452148438, -0.5217881202697754, -3.886868953704834, -0.3025655746459961, 0.09337186813354492, -0.27452850341796875, -1.6095142364501953, -1.3454933166503906, 0.8908100128173828, 0.6743841171264648, -0.4783945083618164, 0.1735081672668457, -1.6095142364501953, -0.5954132080078125, -0.5527000427246094, -3.1817030906677246, -0.0008454322814941406, -0.10125160217285156, -1.1892375946044922, -7.3940839767456055, -7.25930118560791, -0.44899463653564453, -1.4008293151855469, -0.476102352142334, 0.40041494369506836, -0.5871238708496094, -0.4090003967285156, -3.6150150299072266, -0.1013956069946289, -0.3295116424560547, -0.7134246826171875, -1.2321014404296875, -1.1028738021850586, -4.482644081115723, -0.16331815719604492, -9.174489974975586, -1.8755626678466797, -1.638911247253418, -2.2399559020996094, 0.8908100128173828, 0.5352503061294556, -0.7951126098632812, 0.1965494155883789, -0.05039167404174805, -2.4143104553222656, -0.7444171905517578, 8.654643058776855, 0.1871623992919922, 0.7320947647094727, -0.2058849334716797, -6.3832292556762695, -0.3025655746459961, -0.6543006896972656, 0.19711017608642578, 0.27471160888671875, -0.953923225402832, 1.453409194946289, -3.1368441581726074, -8.28735065460205, -3.048262119293213, -1.2233572006225586, -1.1114883422851562, -3.2409815788269043, -0.07521915435791016, 0.048699378967285156, 1.3494129180908203, -1.9671764373779297, -1.1408882141113281, -0.7578544616699219, -1.5115776062011719, -1.1883797645568848, -5.673077583312988, -1.818155288696289, -0.9308595657348633, -0.8695136904716492, -0.9006919860839844, -0.2066192626953125, -5.199801445007324, -0.5449752807617188, -2.024770736694336, 0.9045343399047852, -0.317018985748291, -0.2640838623046875, -1.9149246215820312, 1.6963648796081543, 3.7572739124298096, -1.0423569679260254, -1.0251121520996094, 1.584381103515625, -0.016925811767578125, -1.2436590194702148, -0.16920089721679688, -0.5436673164367676, 0.541262149810791, -3.2902350425720215, -0.24756431579589844, 0.6384444236755371, -1.5286808013916016, -6.4769697189331055, 0.4747123718261719, -0.6105136871337891, 0.5778846740722656, -1.3178071975708008, -0.10280799865722656, 0.3239838480949402, 0.07890892028808594, 1.941807746887207, -0.651336669921875, 0.48167717456817627, -0.8359842300415039, 0.042499542236328125, 2.742123603820801, -0.30858373641967773, -0.8775110244750977, -1.935042381286621, -0.6133933067321777, -3.2564754486083984, 0.3315330445766449, 0.5186076164245605, -1.5704479217529297, -1.5468988418579102, -0.9539756774902344, -2.766468048095703, -0.7354145050048828, -0.23822021484375, -0.5565223693847656, 0.17377471923828125, -0.4643254280090332, -1.1562879085540771], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 73200, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 73200, "last_target_update_ts": 20480, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -215.685556989991, "episode_len_mean": 317.27777777777777, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5406878652064386, "mean_inference_ms": 22.75099260395968, "mean_action_processing_ms": 0.14261798322659752, "mean_env_wait_ms": 4.420145139711186, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -215.685556989991, "episode_len_mean": 317.27777777777777, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5406878652064386, "mean_inference_ms": 22.75099260395968, "mean_action_processing_ms": 0.14261798322659752, "mean_env_wait_ms": 4.420145139711186, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 73200, "num_env_steps_sampled": 20480, "num_env_steps_trained": 73200, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 20480, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 350.098, "learn_time_ms": 70.835, "learn_throughput": 3388.156, "synch_weights_time_ms": 19.489}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 73200, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 73200, "last_target_update_ts": 20480, "num_target_updates": 39}, "done": false, "episodes_total": 54, "training_iteration": 20, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-19-21", "timestamp": 1655500761, "time_this_iter_s": 5.427130460739136, "time_total_s": 102.40294289588928, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 102.40294289588928, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.571428571428577, "ram_util_percent": 61.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -10.955916404724121, "min_q": -33.93338394165039, "max_q": 12.197033882141113, "mean_td_error": -1.2375661134719849}, "td_error": [1.6700019836425781, -3.0577869415283203, -0.3916158676147461, -1.166640281677246, -1.457716703414917, -0.08705520629882812, -1.3698463439941406, -1.1245841979980469, -0.22846603393554688, -1.8335449695587158, -1.7834558486938477, -1.4828834533691406, -0.7051396369934082, -1.3230905532836914, -1.219635009765625, -1.5388097763061523, -0.5222759246826172, 0.16530895233154297, -8.187723159790039, 0.3856983184814453, 0.6178555488586426, -2.0517215728759766, 0.6204941272735596, 1.246692419052124, 0.3963038921356201, -1.165684700012207, -0.3689613342285156, -11.162007331848145, -1.0479907989501953, 0.14533042907714844, -3.069260597229004, 0.627894401550293, -1.8312816619873047, -3.9784209728240967, -0.6704959869384766, 0.22065162658691406, 0.5355663299560547, -0.46855926513671875, -0.5420989990234375, 0.6984424591064453, 0.12545442581176758, -0.5304088592529297, 0.36124372482299805, -1.9773225784301758, 0.16567230224609375, -0.44017601013183594, 0.606724739074707, 0.807951807975769, -1.2944793701171875, -0.13079261779785156, -3.108286142349243, 0.27111196517944336, 0.7825222015380859, 0.7542284727096558, -3.713624954223633, -0.5307402610778809, 1.1990089416503906, -2.7154297828674316, -1.8087472915649414, -0.33420276641845703, -0.09243011474609375, 0.14138221740722656, -1.3124570846557617, 0.14138221740722656, 0.7631058692932129, -7.073396682739258, -1.316068172454834, 0.7345943450927734, -0.7701091766357422, -0.011358261108398438, -1.9121532440185547, -1.5608177185058594, 0.06226921081542969, -2.342733383178711, -7.957143306732178, -0.3868226408958435, -2.04266357421875, -0.9061126708984375, -1.7361173629760742, -7.800990104675293, -1.108518123626709, -0.003958702087402344, -1.5727367401123047, -0.8396768569946289, 1.1409149169921875, -1.6221466064453125, -2.0789384841918945, -2.399418830871582, -1.039276123046875, -2.7649316787719727, -1.1759109497070312, 0.009458541870117188, -1.8086261749267578, -27.924091339111328, 1.1163644790649414, 0.28319358825683594, -1.3029041290283203, -0.11811685562133789, -1.58992600440979, 0.04309260845184326, 0.22518205642700195, -1.6295788288116455, 0.5808296203613281, 0.4497356414794922, 1.4709699153900146, 0.6946452260017395, -2.765035629272461, -1.349874496459961, 1.713409423828125, -0.47424793243408203, -0.9376678466796875, -0.6173477172851562, 0.5043239593505859, -0.8063068389892578, -0.08705520629882812, 0.46779632568359375, 9.297872543334961, -0.023062705993652344, -1.032522201538086, -0.30982398986816406, -1.3823986053466797, -0.10876822471618652, 0.15978240966796875, -1.4213571548461914, -0.16646766662597656, -0.8384809494018555, -7.676078796386719, 0.34626007080078125, -1.0865716934204102, -1.1016693115234375, -7.792057991027832, -10.254493713378906, -1.462911605834961, -1.3391313552856445, 0.7469191551208496, -9.299871444702148, -1.3230400085449219, -2.7309935092926025, -1.0174360275268555, 0.3963038921356201, -0.9515089988708496, 0.803640604019165, -1.048783302307129, 1.1123571395874023, -0.4092884063720703, -3.311525821685791, 0.11359119415283203, 0.6728763580322266, 1.5046005249023438, -1.7113065719604492, -0.6324138641357422, -0.814666748046875, -0.4165375828742981, -0.6125750541687012, 0.7100033760070801, -1.3136768341064453, 0.8583898544311523, -0.5122804641723633, -2.046504497528076, -0.14703941345214844, -1.9495258331298828, 1.5370988845825195, -0.4582691192626953, -5.95808219909668, -0.14112377166748047, -2.247873306274414, -0.8479461669921875, -0.415771484375, -2.7154297828674316, -8.354982376098633, -1.062333106994629, 0.9981689453125, 0.030630111694335938, -2.0654678344726562, -0.4061717987060547, -0.7854623794555664, -8.943347930908203, 0.6934700012207031, -1.3359280824661255, -1.6385021209716797, 0.8071403503417969, 0.6566524505615234, -0.7999258041381836, -2.6137828826904297, 1.9794292449951172, 1.0961380004882812, 0.3069725036621094, 0.4562797546386719, -0.7189640998840332, 0.5204620361328125, -0.07620000839233398, -0.09243011474609375, -1.346482276916504, -1.0415301322937012, 1.312509536743164, 0.8838646411895752, -1.0101451873779297, -8.779144287109375, -0.5341835021972656, -0.47424793243408203, -0.7176780700683594, -1.247880220413208, -2.5707855224609375, 1.5678482055664062, 0.04796028137207031, -0.043682098388671875, -4.056405544281006, -0.4375934600830078, 1.0842018127441406, 0.884638786315918, -2.2604217529296875, 0.09518814086914062, -1.9712610244750977, -0.8063068389892578, -3.0321688652038574, -0.5984230041503906, -0.5331172943115234, -1.5429553985595703, -15.641096115112305, -2.0944557189941406, -0.5135073661804199, -0.2201395034790039, -3.713624954223633, -1.2833192348480225, 0.6138930320739746, -0.36482906341552734, -1.3076775074005127, -6.0200910568237305, 0.46787261962890625, -0.23731613159179688, -2.3561172485351562, -0.11415672302246094, -1.8086261749267578, -0.6594381332397461, 0.8071403503417969, -11.818196296691895, -0.7825579643249512, 1.1407279968261719, 0.15238571166992188, -1.3049860000610352], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 77040, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 77040, "last_target_update_ts": 21504, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -225.5243589633455, "episode_len_mean": 320.93333333333334, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5374009538328992, "mean_inference_ms": 22.84864961674591, "mean_action_processing_ms": 0.1423137728113909, "mean_env_wait_ms": 4.390229219020582, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -225.5243589633455, "episode_len_mean": 320.93333333333334, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5374009538328992, "mean_inference_ms": 22.84864961674591, "mean_action_processing_ms": 0.1423137728113909, "mean_env_wait_ms": 4.390229219020582, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 77040, "num_env_steps_sampled": 21504, "num_env_steps_trained": 77040, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 21504, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 351.105, "learn_time_ms": 70.641, "learn_throughput": 3397.454, "synch_weights_time_ms": 19.789}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 77040, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 77040, "last_target_update_ts": 21504, "num_target_updates": 41}, "done": false, "episodes_total": 60, "training_iteration": 21, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-19-27", "timestamp": 1655500767, "time_this_iter_s": 5.668506383895874, "time_total_s": 108.07144927978516, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 108.07144927978516, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.0625, "ram_util_percent": 61.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.853460311889648, "min_q": -36.103675842285156, "max_q": 12.465752601623535, "mean_td_error": -1.3656061887741089}, "td_error": [-2.4628067016601562, -0.4468114376068115, -0.2708263397216797, -2.852907180786133, -0.27838802337646484, -1.1004009246826172, -1.0234425067901611, 0.30782318115234375, 0.041468143463134766, -2.588761806488037, -2.1875295639038086, -2.179898262023926, -0.9229736328125, -1.6991205215454102, -1.0290064811706543, -2.3103294372558594, -1.8767967224121094, 0.9986658096313477, -1.1366157531738281, -0.16461563110351562, -2.350666046142578, 1.9617819786071777, 0.4022998809814453, -2.9354419708251953, 1.0201339721679688, -5.851716995239258, -2.1469030380249023, 0.23976516723632812, -0.47709155082702637, -0.5869739055633545, 0.3601808547973633, 0.297698974609375, -3.1089320182800293, -2.6293134689331055, -3.6011693477630615, 0.2725076675415039, 0.26350975036621094, -0.7355728149414062, -2.72390079498291, -0.3853483200073242, 0.5807504653930664, -0.1810131072998047, -7.397355556488037, -8.909541130065918, -1.8028554916381836, 0.09667205810546875, -0.12972354888916016, -1.2579679489135742, -8.876482963562012, 0.5157070159912109, -8.216243743896484, -2.126154899597168, -1.3614521026611328, -1.0821723937988281, -0.7345753908157349, -0.878570556640625, -0.5338732004165649, -1.1239643096923828, 0.22426795959472656, -5.4402265548706055, 1.6046676635742188, -12.726188659667969, -1.1484565734863281, 0.8563470840454102, -1.9997336864471436, -0.3835735321044922, -0.5626659393310547, -1.248946189880371, 0.07933998107910156, -0.9801139831542969, -0.7692813873291016, 0.45642662048339844, -3.224912166595459, -0.4325904846191406, -1.0440940856933594, -0.5352578163146973, -1.6365795135498047, -2.545825958251953, 0.6345546245574951, -2.6247406005859375, 0.1893758773803711, -0.35167109966278076, -1.2704057693481445, -0.20037460327148438, 1.8926353454589844, -1.0554885864257812, -0.7199435234069824, -1.5180082321166992, -0.3141329288482666, -0.33914637565612793, 1.0646166801452637, -0.037036895751953125, -1.126993179321289, 0.3460901379585266, -1.3018875122070312, 0.2533116340637207, -0.8914741277694702, -2.1262903213500977, -2.3618083000183105, -2.074127435684204, 0.27483558654785156, -1.4693888425827026, -1.1481342315673828, -1.0045700073242188, -1.0385780334472656, 0.7988333702087402, -0.235596165060997, -1.7903175354003906, -9.665950775146484, -0.5946245193481445, 1.6566219329833984, 1.603926181793213, -1.3340896368026733, -0.7671012878417969, -2.5794620513916016, -0.4651679992675781, 0.7321548461914062, -0.6975650787353516, -1.8790035247802734, 0.5396909713745117, -31.542898178100586, -1.2299944162368774, -1.5664215087890625, -0.744847297668457, -1.0652189254760742, -0.6744098663330078, -2.0140180587768555, -0.31390535831451416, -0.6069393157958984, -0.5455904006958008, -2.1769862174987793, -2.852907180786133, -2.2589030265808105, -7.387713432312012, 0.7528266906738281, -8.080984115600586, -2.2563886642456055, 0.17310714721679688, -1.8236417770385742, -1.0628986358642578, -2.7153923511505127, -1.2451438903808594, -0.7774639129638672, -0.6170663833618164, -0.014064788818359375, 0.46718597412109375, -1.7950382232666016, -7.25716495513916, 0.4022998809814453, -0.35570526123046875, -6.467055320739746, -1.3632335662841797, -1.8014955520629883, 0.12929344177246094, -0.6961956024169922, -9.671485900878906, -0.4781208038330078, -0.8377628326416016, 0.75612473487854, -0.4213294982910156, -2.9531798362731934, 0.5420665740966797, -0.8441181182861328, -2.206144332885742, -0.8239507675170898, -0.037036895751953125, -1.5305299758911133, -0.6573810577392578, 0.3148186206817627, -0.8618583679199219, 1.1364107131958008, -6.967006683349609, -4.67639684677124, 0.1271514892578125, -0.05354928970336914, -2.5941457748413086, -0.872528076171875, -1.923492431640625, -0.5337214469909668, -0.4468114376068115, 1.5730891227722168, 0.48854589462280273, -0.7132704257965088, -0.7750622034072876, -2.7592344284057617, -0.6832642555236816, 0.833404541015625, -1.895024299621582, -5.411003589630127, -0.3254985809326172, -0.8084182739257812, 1.016380786895752, -0.31390535831451416, -2.0216846466064453, -1.0242924690246582, -2.0970683097839355, -0.691864013671875, -3.095219612121582, -0.3728790283203125, -0.9177379608154297, -2.323423385620117, -1.6512870788574219, -0.3963947296142578, -1.3085079193115234, -0.21301937103271484, -0.8044528961181641, 0.5157070159912109, 0.09801197052001953, -0.8982944488525391, -0.41382884979248047, -0.35530662536621094, -6.967006683349609, -0.48270511627197266, -1.046294927597046, -0.36762237548828125, 0.32430171966552734, -0.5759811401367188, -0.9772930145263672, 0.1405792236328125, -2.815135955810547, -0.20037460327148438, -0.7262592315673828, -0.9156827926635742, 0.5839046239852905, 1.5147409439086914, 0.5507049560546875, 0.9477500915527344, 0.0045070648193359375, -0.12529659271240234, -1.1451177597045898, -0.9520072937011719, -1.9944896697998047, -1.110886573791504, 0.1321878433227539, 0.4055747985839844, -1.475332260131836, -0.5175222158432007, 2.1202616691589355, -2.4679479598999023, -0.1922149658203125], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 80880, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 80880, "last_target_update_ts": 22528, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": 13.373173050582409, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -228.64182301551577, "episode_len_mean": 321.93650793650795, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5356140081126568, "mean_inference_ms": 22.867988269506835, "mean_action_processing_ms": 0.14259719660944167, "mean_env_wait_ms": 4.37090343368333, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 13.373173050582409, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -228.64182301551577, "episode_len_mean": 321.93650793650795, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5356140081126568, "mean_inference_ms": 22.867988269506835, "mean_action_processing_ms": 0.14259719660944167, "mean_env_wait_ms": 4.37090343368333, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 80880, "num_env_steps_sampled": 22528, "num_env_steps_trained": 80880, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 22528, "agent_timesteps_total": 22528, "timers": {"training_iteration_time_ms": 335.447, "learn_time_ms": 71.563, "learn_throughput": 3353.674, "synch_weights_time_ms": 19.69}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 80880, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 80880, "last_target_update_ts": 22528, "num_target_updates": 43}, "done": false, "episodes_total": 63, "training_iteration": 22, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-19-33", "timestamp": 1655500773, "time_this_iter_s": 5.608239412307739, "time_total_s": 113.6796886920929, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 113.6796886920929, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.775, "ram_util_percent": 62.1125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.628049850463867, "min_q": -38.2398796081543, "max_q": 13.859402656555176, "mean_td_error": -1.4491989612579346}, "td_error": [-1.4513893127441406, 0.7192277908325195, -1.783585548400879, -0.5154579877853394, -1.81658935546875, 1.0400238037109375, -1.6054391860961914, -0.7349395751953125, 1.1229987144470215, -1.6980209350585938, -0.250640869140625, -0.8956871032714844, -0.4506702423095703, -0.7152595520019531, -1.8525967597961426, 7.239425182342529, -0.6486968994140625, 0.20211613178253174, -0.14895987510681152, -2.1912403106689453, 0.5371508598327637, -1.6535072326660156, -0.380169153213501, -2.089787721633911, -2.0930404663085938, -1.4845542907714844, 0.7243194580078125, 0.7897930145263672, 1.1822195053100586, -0.33274078369140625, 0.31223583221435547, -1.4525680541992188, -1.3418350219726562, -0.015161514282226562, -1.698997974395752, -0.9594240188598633, 0.5140838623046875, 0.38028812408447266, -0.7361793518066406, -0.3613243103027344, -0.21469879150390625, -9.907625198364258, -1.1090984344482422, -6.657449722290039, -0.5568575859069824, 0.09432506561279297, -0.4643082618713379, 1.517451286315918, -0.6379337310791016, -6.1458282470703125, -0.4748725891113281, -0.7047767639160156, -0.40311431884765625, 0.7897930145263672, 1.088757038116455, 0.11214256286621094, -0.5646487474441528, -0.24094200134277344, -1.183206558227539, -7.613292694091797, -0.6033840179443359, -8.326315879821777, -1.9008190631866455, -1.6848154067993164, -2.2623252868652344, -1.6173515319824219, -1.487614631652832, -2.377519130706787, -1.4783096313476562, -0.7433133125305176, -0.019176483154296875, -1.217254638671875, 0.35820960998535156, -5.479269504547119, -9.731976509094238, -0.7752914428710938, -2.132711410522461, 2.434155225753784, -7.368038177490234, -1.9445525407791138, -1.0053424835205078, -0.3631141185760498, -0.2572746276855469, -1.0861716270446777, -4.428975582122803, -0.7740745544433594, -0.5239295959472656, -0.18855667114257812, -0.8858013153076172, -0.050347328186035156, -1.6393189430236816, -13.641671180725098, -0.3912382125854492, -0.5829105377197266, -0.649317741394043, -0.5314083099365234, -1.9642441272735596, -1.7579765319824219, -2.2324886322021484, -0.5198164582252502, -2.262415885925293, -1.1355934143066406, -1.414039134979248, 0.46343231201171875, -1.6106834411621094, -1.038944959640503, -1.4368810653686523, -0.5962371826171875, -0.9147100448608398, -1.5941767692565918, 1.3046019077301025, -2.59964656829834, -0.38708823919296265, -0.960660457611084, -0.5646487474441528, -1.0484504699707031, -0.31691932678222656, -1.6325836181640625, -2.042788505554199, -1.1244444847106934, -1.942352294921875, -0.5646487474441528, -1.0596885681152344, -2.6668434143066406, 0.5239334106445312, 0.47517967224121094, -0.6854705810546875, -2.136713981628418, -1.094630241394043, -7.776095867156982, -0.8134918212890625, -1.8232275247573853, -0.36739349365234375, 1.3763923645019531, -0.5199832916259766, -0.9717507362365723, 0.8105616569519043, -0.620819091796875, -1.2715978622436523, 0.0016736984252929688, -1.7604494094848633, 0.7249088287353516, -0.12754058837890625, -1.6606407165527344, -1.0481681823730469, -0.9648513793945312, -1.877608060836792, -1.0803065299987793, -0.2805442810058594, -1.0938854217529297, -8.129764556884766, -2.5167953968048096, -1.0209221839904785, -0.15711498260498047, -1.6828765869140625, -4.200551509857178, -1.9273958206176758, -1.3859138488769531, -1.28143310546875, -0.38672494888305664, -0.6949901580810547, -1.1535158157348633, -0.14895987510681152, -0.3565025329589844, -2.185633659362793, 0.3656597137451172, -0.466033935546875, -2.8594226837158203, -0.4286384582519531, -8.775378227233887, 0.6672382354736328, -27.27836036682129, 1.0311603546142578, -0.7144436836242676, -2.318005084991455, 0.12125110626220703, -0.6040077209472656, -1.6176857948303223, -3.164346694946289, -0.4108390808105469, -0.1365642547607422, -1.244253158569336, -2.4322166442871094, -1.204214334487915, -2.082890033721924, -0.7144436836242676, -2.712343215942383, -1.8925232887268066, -2.105365753173828, -5.1224284172058105, 0.4243440628051758, -0.32510948181152344, -3.8184776306152344, -0.371002197265625, 0.1801128387451172, -0.4300498962402344, -1.8617286682128906, -2.568958282470703, -3.316986083984375, -1.018871784210205, -1.0618383884429932, -1.4525680541992188, 0.38282251358032227, -1.8775668144226074, -1.1308746337890625, -4.309445858001709, -0.2142019271850586, 1.7580111026763916, -1.6628923416137695, -0.1775045394897461, 1.023127794265747, 0.4970836639404297, -1.633394718170166, -1.3698148727416992, -23.583698272705078, -0.4300498962402344, -0.12187361717224121, 0.11805438995361328, -1.3951969146728516, 0.054595947265625, -2.385406017303467, 0.3462557792663574, -1.403360366821289, -1.4815654754638672, 0.37636470794677734, -1.0928478240966797, 0.47771191596984863, -1.0097951889038086, -1.4385924339294434, -0.6760444641113281, -10.73144245147705, -0.09283161163330078, 0.3869814872741699, 1.1229987144470215, -0.41082096099853516, 0.02392292022705078, -1.5184316635131836, -1.1062231063842773, -1.7450766563415527, 0.4839186668395996], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 84720, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 84720, "last_target_update_ts": 23552, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": 16.72385536134243, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -219.3136293263558, "episode_len_mean": 318.5882352941176, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.536097173136002, "mean_inference_ms": 22.921402447308026, "mean_action_processing_ms": 0.14218092577278887, "mean_env_wait_ms": 4.358548027143775, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 16.72385536134243, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -219.3136293263558, "episode_len_mean": 318.5882352941176, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.536097173136002, "mean_inference_ms": 22.921402447308026, "mean_action_processing_ms": 0.14218092577278887, "mean_env_wait_ms": 4.358548027143775, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 84720, "num_env_steps_sampled": 23552, "num_env_steps_trained": 84720, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 23552, "agent_timesteps_total": 23552, "timers": {"training_iteration_time_ms": 338.728, "learn_time_ms": 72.255, "learn_throughput": 3321.559, "synch_weights_time_ms": 20.089}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 84720, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 84720, "last_target_update_ts": 23552, "num_target_updates": 45}, "done": false, "episodes_total": 68, "training_iteration": 23, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-19-38", "timestamp": 1655500778, "time_this_iter_s": 5.463963270187378, "time_total_s": 119.14365196228027, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 119.14365196228027, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.4375, "ram_util_percent": 62.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.981691360473633, "min_q": -37.78194808959961, "max_q": 13.643436431884766, "mean_td_error": -0.37945157289505005}, "td_error": [4.27401065826416, -7.545965194702148, 4.259509086608887, -1.1853532791137695, -0.6880569458007812, 2.655941963195801, -1.5039615631103516, -6.556147575378418, -1.020697832107544, -1.605062484741211, 1.5576419830322266, -0.8480520248413086, 0.7022857666015625, 0.7365894317626953, -0.8119955062866211, 0.1830611228942871, -0.44941985607147217, 1.2915935516357422, 2.969897747039795, 0.7447710037231445, 1.0837535858154297, 1.7989997863769531, -0.38890838623046875, 0.9955506324768066, 0.227142333984375, 0.8756418228149414, -0.5304980278015137, -0.5098819732666016, 0.2587413787841797, 0.3798255920410156, 1.446885108947754, 1.3375883102416992, 1.1797046661376953, -2.635345458984375, 0.3573150634765625, 1.5480213165283203, -0.15958213806152344, -2.266132354736328, -8.082076072692871, -7.113140106201172, 0.16290497779846191, 4.985457897186279, -0.17495155334472656, -4.520549774169922, -2.008971691131592, -0.25733518600463867, -4.1380720138549805, 0.6604127883911133, -6.125906944274902, -0.4918975830078125, 0.2696272134780884, -0.5856189727783203, 2.3375110626220703, 1.032595157623291, 1.1906023025512695, 0.5912666320800781, -0.07697391510009766, -0.05211472511291504, -0.14802968502044678, -5.618691444396973, 0.9971803426742554, 0.9971803426742554, -0.7674541473388672, 2.1474246978759766, 0.15576457977294922, 0.47249794006347656, -0.43436336517333984, 0.0922088623046875, -0.30712270736694336, 0.24564075469970703, 1.983922004699707, 1.8054370880126953, 0.8886680603027344, -0.7873249053955078, -0.6567573547363281, 0.30557650327682495, -2.785491943359375, -0.3438444137573242, 3.691615581512451, 0.5921201705932617, 1.506993293762207, -1.7164225578308105, 0.7019612789154053, -7.315089225769043, 0.7761707305908203, -1.6400327682495117, -0.08970260620117188, 0.08970785140991211, 0.3547382354736328, -0.42615604400634766, 2.138805389404297, 1.4935131072998047, -0.07697391510009766, -0.20176410675048828, -0.6231575012207031, 0.8805704116821289, -2.139211654663086, 0.40502357482910156, -0.7816553115844727, 2.2938294410705566, -0.6055736541748047, 0.6543445587158203, -2.0684814453125, 0.6773958206176758, 2.025425910949707, 0.0766143798828125, 1.2385368347167969, 1.7063770294189453, 2.3787269592285156, 1.0425915718078613, 0.2622203826904297, 0.144378662109375, -4.311992645263672, -0.6055736541748047, -1.0801868438720703, 1.4769588708877563, -0.25854969024658203, -0.5161170959472656, -1.076167106628418, 0.6443824768066406, -7.5499653816223145, -0.7330269813537598, -7.870724678039551, 1.2390937805175781, -0.43225324153900146, 0.6195106506347656, -0.20801734924316406, -1.4420089721679688, 1.568068504333496, -2.2688803672790527, -3.640388011932373, 0.6883373260498047, -0.7590360641479492, -0.5981845855712891, 1.2182931900024414, 0.7365894317626953, -10.62062931060791, -2.0622806549072266, -5.4546403884887695, -2.411726236343384, -0.8837308883666992, 1.0285816192626953, 0.3547382354736328, -0.13411331176757812, -0.39402198791503906, 0.74407958984375, 1.2380104064941406, 0.9899063110351562, -0.7724237442016602, 0.8273115158081055, -0.2389068603515625, -0.4411602020263672, 0.5326900482177734, -1.2571468353271484, -0.6230854988098145, -2.2475109100341797, 1.6178827285766602, 0.7843227386474609, -1.1729787588119507, -0.8870253562927246, -0.37760186195373535, 1.4262466430664062, 2.9427952766418457, -1.2830142974853516, -3.3381757736206055, 0.5095100402832031, 0.7022857666015625, -1.454977035522461, 0.7904529571533203, -21.449071884155273, 2.6669206619262695, -0.4187307357788086, -0.15809917449951172, -1.4459524154663086, 0.2341899871826172, -2.9171934127807617, 0.11655044555664062, 0.4616832733154297, 0.5494804382324219, -0.1678638458251953, 2.3375110626220703, -1.4318923950195312, -1.2899360656738281, -8.886662483215332, 1.3144340515136719, -0.27581310272216797, -3.7836899757385254, 0.5380344390869141, 0.1872844696044922, 0.5251941680908203, 1.460679292678833, 0.7053985595703125, 0.7252912521362305, -0.7596302032470703, -0.6932125091552734, -1.5618715286254883, -0.7940883636474609, 1.065032958984375, -0.3589649200439453, 1.1176929473876953, 0.5479207038879395, -1.4457883834838867, 2.354867935180664, 0.3747367858886719, -0.21846389770507812, -1.6400327682495117, -0.17087411880493164, 0.2341899871826172, 1.4312715530395508, -0.8259868621826172, -0.8009071350097656, -0.8671631813049316, 2.424631118774414, 2.0626726150512695, 0.6984357833862305, 0.21437621116638184, -0.15785598754882812, 0.24344730377197266, -0.2739582061767578, 0.4156970977783203, -1.2395520210266113, 1.0346428155899048, 1.58834969997406, -1.8578691482543945, -1.4578783512115479, 1.6546850204467773, -0.2769641876220703, 0.21437621116638184, 1.4345903396606445, -0.8115959167480469, -0.38124918937683105, 1.2876472473144531, 1.8879585266113281, 2.349278450012207, -0.48413944244384766, 2.2891244888305664, -0.2791585922241211, 0.06573486328125, -7.949650764465332, -1.0764942169189453], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 88560, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 88560, "last_target_update_ts": 24576, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": 16.72385536134243, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -213.98931197396345, "episode_len_mean": 316.9714285714286, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5361017589379269, "mean_inference_ms": 22.930227501753134, "mean_action_processing_ms": 0.14244773347196402, "mean_env_wait_ms": 4.35226948392869, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 16.72385536134243, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -213.98931197396345, "episode_len_mean": 316.9714285714286, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5361017589379269, "mean_inference_ms": 22.930227501753134, "mean_action_processing_ms": 0.14244773347196402, "mean_env_wait_ms": 4.35226948392869, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 88560, "num_env_steps_sampled": 24576, "num_env_steps_trained": 88560, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 24576, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 332.772, "learn_time_ms": 71.872, "learn_throughput": 3339.277, "synch_weights_time_ms": 21.013}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 88560, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 88560, "last_target_update_ts": 24576, "num_target_updates": 47}, "done": false, "episodes_total": 70, "training_iteration": 24, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-19-44", "timestamp": 1655500784, "time_this_iter_s": 5.24156379699707, "time_total_s": 124.38521575927734, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 124.38521575927734, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.575, "ram_util_percent": 62.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -10.637015342712402, "min_q": -40.48286056518555, "max_q": 13.723066329956055, "mean_td_error": -1.4711288213729858}, "td_error": [-2.374563217163086, -0.9540691375732422, 0.3409461975097656, -0.21585845947265625, -2.1645102500915527, -0.2956898808479309, -0.02506732940673828, -1.6036701202392578, -0.6888332366943359, -1.147169828414917, -2.374204158782959, -1.3748481273651123, -0.40332984924316406, 0.6193084716796875, -0.19069290161132812, -2.490239143371582, 0.5947675704956055, -1.044632911682129, -2.603285789489746, -5.6907758712768555, 0.47588157653808594, -0.6626529693603516, 0.11445808410644531, -1.2063179016113281, 0.1899266242980957, -0.45786285400390625, -0.8235940933227539, 0.09264850616455078, -2.015984535217285, -0.5871841907501221, -1.1267738342285156, -21.714414596557617, 0.12560367584228516, -1.3938989639282227, 0.11294174194335938, 0.0706338882446289, -1.938192367553711, -3.4210619926452637, -2.996547222137451, -1.3370590209960938, -1.0534162521362305, 1.0423610210418701, -0.7395172119140625, -0.8028526306152344, -3.470902442932129, -2.429349422454834, -1.7499358654022217, -1.7054576873779297, 0.08591461181640625, -0.18179339170455933, -1.7159206867218018, -1.1095845699310303, -1.2295494079589844, -0.2717158794403076, -2.035093307495117, -1.748800277709961, -0.8119049072265625, 0.12477493286132812, -0.1497325897216797, -0.1834125518798828, -11.969524383544922, 0.4230966567993164, -0.5229969024658203, -2.6254539489746094, -3.7045958042144775, 0.9476118087768555, 0.8017368316650391, -2.1970365047454834, 0.12694263458251953, -0.8064756393432617, -0.06088733673095703, -1.2817020416259766, -0.6948356628417969, -0.4300117492675781, -17.90871238708496, -1.52424156665802, -0.27716064453125, -0.37575626373291016, -0.6425008773803711, 0.8224821090698242, -0.7149066925048828, -0.22595977783203125, -0.23375320434570312, 0.04109811782836914, -1.7506121397018433, -0.7196598052978516, -0.05989837646484375, -0.45786285400390625, -0.006749153137207031, -0.20682716369628906, -2.246880054473877, -3.470902442932129, -1.908940076828003, -2.7261505126953125, -1.042886734008789, -0.05597400665283203, 0.793269157409668, -0.14615726470947266, -1.9131078720092773, -1.6036701202392578, -0.2721843719482422, -0.12264728546142578, -0.6560335159301758, -1.800366759300232, -11.199084281921387, -3.7403488159179688, -0.8649091720581055, -0.09685134887695312, -0.4136619567871094, 0.6193084716796875, 0.7455329895019531, -0.07117938995361328, -1.7610282897949219, -0.8571319580078125, -0.9999141693115234, 0.9245007634162903, -1.0094270706176758, 2.579021453857422, -0.6413266658782959, -0.7443957328796387, 0.65594482421875, -7.0575666427612305, 1.1635355949401855, -6.363465309143066, -0.7924003601074219, 2.51515793800354, -1.5919418334960938, 0.49564170837402344, -0.42637205123901367, -0.43161964416503906, -2.2518773078918457, -8.14104175567627, -0.46868324279785156, -0.567112922668457, 0.20714354515075684, -1.430068016052246, -1.3355293273925781, -0.7623424530029297, -0.9155294895172119, -1.3065919876098633, -2.1529111862182617, -2.0488944053649902, -0.9047203063964844, -0.775665283203125, -0.4735736846923828, -0.05662965774536133, 1.068831443786621, -0.40378665924072266, -7.427338600158691, -0.7366024255752563, -0.33503198623657227, -1.7712750434875488, -0.9323005676269531, -11.105850219726562, -1.0409096479415894, -1.7713232040405273, 0.27291297912597656, -2.0342063903808594, -0.957275390625, -0.7481460571289062, -1.4397010803222656, -0.72296142578125, -0.7513389587402344, -4.086789131164551, 1.2550535202026367, -1.7388973236083984, -0.7015457153320312, -0.3957376480102539, -2.2437655925750732, -0.401214599609375, -1.2859126329421997, -1.5967192649841309, 0.13408660888671875, -0.26111507415771484, -0.405187726020813, -7.843299865722656, -3.388535499572754, -2.1113033294677734, -8.196340560913086, -4.757744789123535, 0.911163330078125, -0.266573429107666, -1.347297191619873, -2.8949267864227295, -1.1310267448425293, 2.319593906402588, -0.21893882751464844, -0.8951129913330078, 0.40075206756591797, -0.5477750301361084, 0.4080390930175781, -0.6560335159301758, -0.09691548347473145, 0.7162656784057617, -0.15147113800048828, -4.592050552368164, -0.6348800659179688, -0.7106385231018066, -0.6771011352539062, -0.7766866683959961, 2.2825870513916016, -2.6017589569091797, -0.7882938385009766, -3.670699119567871, -1.422800064086914, -0.8571319580078125, -0.07851123809814453, -0.6919116973876953, -0.24942588806152344, -1.6547927856445312, -1.0232086181640625, -6.1790313720703125, -1.9569101333618164, -2.0859298706054688, -0.6624605655670166, -0.18001556396484375, -3.139331817626953, -1.1499319076538086, -1.1471118927001953, -1.0213737487792969, -7.714576721191406, -2.7722225189208984, -0.6870155334472656, -2.7941675186157227, 0.0025634765625, -6.137112617492676, 1.2170629501342773, 0.00901341438293457, -3.7784297466278076, -5.259591102600098, 3.7379093170166016, -3.204632520675659, -7.204241752624512, 0.26206207275390625, -0.022464990615844727, -2.4191861152648926, -0.7679738998413086, -7.137377738952637, -1.149742603302002, -0.3922910690307617], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 92400, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 92400, "last_target_update_ts": 25600, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": 16.72385536134243, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -204.26748180776835, "episode_len_mean": 312.2, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5342492423408355, "mean_inference_ms": 22.971628276600736, "mean_action_processing_ms": 0.14239018513043608, "mean_env_wait_ms": 4.33474504396094, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 16.72385536134243, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -204.26748180776835, "episode_len_mean": 312.2, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5342492423408355, "mean_inference_ms": 22.971628276600736, "mean_action_processing_ms": 0.14239018513043608, "mean_env_wait_ms": 4.33474504396094, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 92400, "num_env_steps_sampled": 25600, "num_env_steps_trained": 92400, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 25600, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 342.142, "learn_time_ms": 72.172, "learn_throughput": 3325.371, "synch_weights_time_ms": 20.19}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 92400, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 92400, "last_target_update_ts": 25600, "num_target_updates": 49}, "done": false, "episodes_total": 75, "training_iteration": 25, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-19-49", "timestamp": 1655500789, "time_this_iter_s": 5.403466701507568, "time_total_s": 129.7886824607849, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 129.7886824607849, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 26.585714285714285, "ram_util_percent": 62.471428571428575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.255348205566406, "min_q": -40.99394226074219, "max_q": 16.233243942260742, "mean_td_error": -1.5962620973587036}, "td_error": [-1.831705093383789, -0.09156227111816406, -2.5580263137817383, -1.1259442567825317, -0.6230249404907227, -1.277724266052246, -2.1279921531677246, 0.6866817474365234, -1.0439801216125488, 0.0731363296508789, -2.197439193725586, -0.040556907653808594, -0.40610599517822266, -2.6447651386260986, -0.9944210052490234, -3.160238265991211, -0.855506420135498, -1.1119670867919922, -1.3695974349975586, -1.674570083618164, 0.5295801162719727, 0.10267829895019531, -4.713024139404297, -2.2060399055480957, -0.61773681640625, -2.143625497817993, -0.349884033203125, 0.19507789611816406, -1.6417999267578125, -1.3141498565673828, 0.740325927734375, -0.07122802734375, -0.8133506774902344, 0.13320446014404297, -1.1939697265625, -0.8249092102050781, -1.2607219219207764, -0.6041477918624878, -0.7894411087036133, 0.18773460388183594, -0.6977516412734985, -1.0847716331481934, 3.274486541748047, -1.6637983322143555, -0.7979660034179688, -3.4878110885620117, -0.32305407524108887, -1.1968793869018555, -23.049072265625, -0.3920607566833496, -3.4668993949890137, -0.09349441528320312, -4.141577243804932, -1.7379150390625, -0.02903461456298828, -0.040093421936035156, -2.5222527980804443, -1.0387110710144043, -3.19293212890625, -0.3920607566833496, -4.301589012145996, -2.023261070251465, -0.3920607566833496, -1.230682373046875, 0.22957229614257812, -0.07318782806396484, -1.0572881698608398, -2.061302661895752, -0.3017892837524414, -10.16301155090332, -6.128751754760742, -0.24963760375976562, -1.7832071781158447, -1.2099323272705078, -3.3970909118652344, -0.8068523406982422, -0.33289670944213867, -2.0431175231933594, -2.143688201904297, -0.5041413307189941, 1.1490592956542969, -0.9934015274047852, -0.343170166015625, 5.924223899841309, 0.0453948974609375, -16.484323501586914, 0.4279285669326782, -1.9138774871826172, -0.009698867797851562, -7.9189324378967285, -1.623262882232666, 0.4988517761230469, -6.349293231964111, -1.0169486999511719, -0.9848222732543945, -1.7033205032348633, -9.876726150512695, -0.13391876220703125, -1.175588607788086, -3.1678810119628906, -1.0915002822875977, 0.5295801162719727, -0.22649288177490234, -0.4258546829223633, -0.9008430242538452, -2.083977699279785, 2.463453769683838, -0.7929801940917969, 0.3717445135116577, -2.298611640930176, -0.33489513397216797, 0.44620513916015625, -0.7332830429077148, -1.0648231506347656, -1.0437803268432617, -2.0566649436950684, -0.05996894836425781, -0.8120346069335938, -0.4126248359680176, 0.2877998352050781, -1.169785499572754, -1.3066143989562988, -1.1518373489379883, -1.679403305053711, -0.14923429489135742, 0.2970466613769531, -3.305450439453125, -1.2572557926177979, -0.9199180603027344, -3.411693572998047, -0.7854366302490234, -2.7804388999938965, -1.700526237487793, -1.1348953247070312, -1.0087156295776367, -1.6926898956298828, -2.144929885864258, -0.6037817001342773, -1.2877473831176758, -1.0217838287353516, -26.281719207763672, -2.5233631134033203, -1.6551761627197266, -1.3676843643188477, 0.0453948974609375, -1.0584105253219604, -0.9328756332397461, 0.5855876207351685, -1.3117847442626953, 0.6411209106445312, 0.620765745639801, -1.8650932312011719, -1.9918880462646484, -0.6230249404907227, -0.6950039863586426, -2.0660581588745117, 0.12722671031951904, -1.5446786880493164, -1.1238402128219604, -0.45201778411865234, -1.2515869140625, -5.815619468688965, -3.2143917083740234, -1.8597514629364014, -2.679145097732544, -0.34308576583862305, -0.12209510803222656, -1.0806231498718262, -2.653731346130371, 0.15205049514770508, -2.284392833709717, -1.093775749206543, -1.7312932014465332, -1.7077488899230957, -2.2139892578125, -0.5684523582458496, -2.793438673019409, -1.4451420307159424, -0.19875001907348633, -1.6261844635009766, -0.6754970550537109, -0.14370501041412354, 1.0456676483154297, 0.5634469985961914, -1.4968907833099365, -2.560492515563965, -1.6607675552368164, -0.991960883140564, -1.3117847442626953, -3.1869654655456543, -7.286074161529541, -3.769216537475586, -1.5302629470825195, -0.14905452728271484, -0.9572105407714844, -1.5005979537963867, -2.305126667022705, -6.249958038330078, -0.5322213172912598, -0.22417068481445312, 2.171112060546875, -0.6037817001342773, -1.4140901565551758, -1.5342369079589844, -1.811300277709961, -0.7510967254638672, 0.2513294219970703, -3.43282413482666, -1.471552848815918, -0.5122051239013672, 0.4590187072753906, -1.4138803482055664, 0.07622909545898438, -0.9784297943115234, -0.16605567932128906, -3.2734503746032715, -2.1646323204040527, -2.8302927017211914, -0.43320369720458984, -1.2471370697021484, -1.475625991821289, -2.998624801635742, -1.2083935737609863, -0.9383659362792969, -0.8383898735046387, -4.574160099029541, -1.3683891296386719, -1.125209093093872, 0.04675769805908203, -0.5592830181121826, -5.254332542419434, -0.21265149116516113, 0.08367729187011719, -0.6471023559570312, -2.8532590866088867, 0.4312739372253418, -2.4764232635498047, -1.0030393600463867, -11.171297073364258, 0.22957229614257812], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 96240, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 96240, "last_target_update_ts": 26624, "num_target_updates": 51}, "sampler_results": {"episode_reward_max": 16.72385536134243, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -204.0831895545125, "episode_len_mean": 312.14473684210526, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5339099825052651, "mean_inference_ms": 22.98478780591766, "mean_action_processing_ms": 0.14227806177730978, "mean_env_wait_ms": 4.3320057398499765, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 16.72385536134243, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -204.0831895545125, "episode_len_mean": 312.14473684210526, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5339099825052651, "mean_inference_ms": 22.98478780591766, "mean_action_processing_ms": 0.14227806177730978, "mean_env_wait_ms": 4.3320057398499765, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 96240, "num_env_steps_sampled": 26624, "num_env_steps_trained": 96240, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 26624, "agent_timesteps_total": 26624, "timers": {"training_iteration_time_ms": 318.725, "learn_time_ms": 72.798, "learn_throughput": 3296.786, "synch_weights_time_ms": 19.889}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 96240, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 96240, "last_target_update_ts": 26624, "num_target_updates": 51}, "done": false, "episodes_total": 76, "training_iteration": 26, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-19-55", "timestamp": 1655500795, "time_this_iter_s": 5.150335311889648, "time_total_s": 134.93901777267456, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 134.93901777267456, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.5875, "ram_util_percent": 62.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.206911087036133, "min_q": -39.769405364990234, "max_q": 16.629364013671875, "mean_td_error": -0.27354660630226135}, "td_error": [0.29756736755371094, -0.6726295948028564, 0.4240398406982422, 0.520350456237793, -0.5497283935546875, 1.2439727783203125, -0.9418697357177734, -0.6626377105712891, 1.5786957740783691, 0.8683300018310547, 2.7878456115722656, 0.9931306838989258, 0.7099037170410156, -0.09790515899658203, 0.6038036346435547, -7.499248504638672, 1.8270912170410156, 0.13625335693359375, 0.3951225280761719, 2.5384111404418945, -8.243232727050781, -0.7481822967529297, -2.9039039611816406, -1.5130329132080078, 4.227853298187256, 0.8622870445251465, -0.7855638265609741, -0.16494464874267578, -30.37099838256836, 0.13940906524658203, -0.48511314392089844, 0.5454974174499512, 1.2239131927490234, -0.5890706181526184, -0.1710820198059082, 1.2245750427246094, 1.5711562633514404, -2.614691734313965, 0.42148780822753906, -1.0056915283203125, 1.143270492553711, -0.995979368686676, 0.9897160530090332, 0.3655219078063965, 0.4325141906738281, -4.342033386230469, 0.6572161912918091, -3.12252140045166, 0.9497890472412109, 0.7490978240966797, 0.6569700241088867, -0.10424995422363281, 1.290048599243164, -0.32375192642211914, -2.5938100814819336, 0.9397764205932617, -0.18304181098937988, -0.5637950897216797, -0.984527587890625, 0.15236234664916992, 0.5921821594238281, 2.189589023590088, 0.6899681091308594, -1.3061399459838867, 1.5858216285705566, -0.6472139358520508, -1.9982452392578125, -2.3563995361328125, -0.4001331329345703, -0.4500093460083008, 0.9675657749176025, -0.41943907737731934, 0.6809453964233398, 1.8688859939575195, -1.139068603515625, -0.6977591514587402, 0.39859867095947266, 0.46166419982910156, -0.13283586502075195, -0.6577038764953613, -0.3479471206665039, 0.6069660186767578, 0.5514307022094727, 0.40435791015625, -0.49793243408203125, 1.5627021789550781, -0.9790201187133789, -0.5124673843383789, -0.7855638265609741, 0.23550033569335938, -7.8699493408203125, -0.04723405838012695, 1.0636177062988281, -1.8240776062011719, -0.16011524200439453, 0.17003917694091797, 0.570805549621582, 0.04295539855957031, 0.5771560668945312, 0.02517414093017578, -1.5897979736328125, -0.8739500045776367, -1.5132611989974976, 1.164330005645752, 6.444554328918457, -0.020078659057617188, 0.7256302833557129, 0.16742491722106934, -6.343318939208984, -0.9940447807312012, -0.16148996353149414, -0.10519981384277344, 1.9803085327148438, 1.0638370513916016, 0.07465553283691406, -0.14014041423797607, -0.9500089883804321, 0.025228500366210938, 0.7961130142211914, -0.6370754241943359, -0.6114883422851562, -0.5491094589233398, -0.42098426818847656, 1.025768518447876, 0.8027243614196777, -0.5944286584854126, 0.17467689514160156, 1.8547115325927734, -2.3988418579101562, 1.3764009475708008, -0.2348480224609375, -7.3726806640625, -0.5968897342681885, -0.9211807250976562, 0.14822769165039062, 1.1846485137939453, 0.807342529296875, 0.24778616428375244, 2.1415648460388184, 1.6165199279785156, -0.22495126724243164, -1.9763755798339844, 1.053135871887207, -0.30988502502441406, 0.32153940200805664, -0.08445167541503906, 1.104990005493164, 0.49298858642578125, -0.21076560020446777, -1.949906349182129, 0.304654598236084, -0.09329795837402344, 1.8092079162597656, 2.484469413757324, 0.9931306838989258, -0.04123878479003906, 1.5285911560058594, -0.39116382598876953, 1.0857057571411133, 0.008150935173034668, 0.0929412841796875, 2.133305311203003, -0.1506967544555664, 0.22567510604858398, 2.087725877761841, -0.4001331329345703, 2.511320114135742, -0.46191978454589844, -1.770967960357666, -1.5893821716308594, 0.6978092193603516, 0.7389507293701172, 1.265775203704834, 1.9349100589752197, 0.5448827743530273, 0.029143333435058594, -0.6013832092285156, -10.152996063232422, -0.04232454299926758, -0.6516714096069336, 1.254058837890625, 0.22169208526611328, -0.29422473907470703, -1.947502613067627, 2.6041336059570312, 0.4681839942932129, 1.2192084789276123, 0.9353327751159668, -0.6624469757080078, -2.651651382446289, 0.3333601951599121, -1.2886662483215332, -0.6952877044677734, 0.5776948928833008, 0.5529595613479614, -0.6109375953674316, -0.3591175079345703, 0.43045997619628906, -1.7318696975708008, -0.6718077659606934, -1.084965705871582, 1.0280108451843262, -0.31293678283691406, 0.3532891273498535, -0.7818374633789062, 0.8065192699432373, 0.4739549160003662, 0.500605583190918, -0.13826560974121094, -6.931757926940918, -0.29353761672973633, 0.1371917724609375, -0.7740089893341064, -0.17720413208007812, 0.7788991928100586, -0.3750171661376953, -1.6548383235931396, -1.7937068939208984, -0.4665689468383789, 1.3811492919921875, 0.6572161912918091, -1.483926773071289, 0.16533541679382324, 1.918135404586792, -0.4520587921142578, -3.716480255126953, 0.41538143157958984, 0.2625236511230469, 0.2659168243408203, -4.61775541305542, 2.1098642349243164, -0.45171165466308594, 0.8624401092529297, 0.695162296295166, -0.8229656219482422, 1.1873817443847656, 1.3134279251098633, -0.43062329292297363, -0.7677345275878906, -2.5088024139404297], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 100080, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 100080, "last_target_update_ts": 27648, "num_target_updates": 53}, "sampler_results": {"episode_reward_max": 16.72385536134243, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -205.06152524361386, "episode_len_mean": 312.3375, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321015013244966, "mean_inference_ms": 23.0245830843688, "mean_action_processing_ms": 0.14197119355490528, "mean_env_wait_ms": 4.321193014126833, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 16.72385536134243, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -205.06152524361386, "episode_len_mean": 312.3375, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321015013244966, "mean_inference_ms": 23.0245830843688, "mean_action_processing_ms": 0.14197119355490528, "mean_env_wait_ms": 4.321193014126833, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 100080, "num_env_steps_sampled": 27648, "num_env_steps_trained": 100080, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 27648, "agent_timesteps_total": 27648, "timers": {"training_iteration_time_ms": 326.632, "learn_time_ms": 72.656, "learn_throughput": 3303.236, "synch_weights_time_ms": 20.288}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 100080, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 100080, "last_target_update_ts": 27648, "num_target_updates": 53}, "done": false, "episodes_total": 80, "training_iteration": 27, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-20-00", "timestamp": 1655500800, "time_this_iter_s": 5.3013482093811035, "time_total_s": 140.24036598205566, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 140.24036598205566, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.3875, "ram_util_percent": 62.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.902948379516602, "min_q": -43.08181381225586, "max_q": 16.291906356811523, "mean_td_error": -1.3722834587097168}, "td_error": [0.1967754364013672, -2.0875396728515625, -0.9851627349853516, -0.4450693130493164, -0.8440933227539062, -0.13437557220458984, -0.8087329864501953, -0.9423189163208008, -0.10046577453613281, 0.43390560150146484, -1.132725715637207, -0.2009831666946411, -0.46486377716064453, -0.34100788831710815, 0.949714183807373, 0.2355210781097412, -1.190744400024414, -1.615875244140625, -1.0016789436340332, -1.9775819778442383, -1.471571922302246, -1.0703727006912231, -0.24769973754882812, -0.21079063415527344, -0.6560344696044922, -2.2887582778930664, -0.7040262222290039, -1.3704729080200195, -0.7634735107421875, -1.0259075164794922, 0.021152496337890625, 0.5536260604858398, -2.267566680908203, -1.4036731719970703, -1.7497797012329102, -1.2872138023376465, -0.18328285217285156, -0.9951000213623047, -6.37537956237793, -0.8757495880126953, -1.3077406883239746, -0.855743408203125, -1.0757865905761719, -0.8198175430297852, -0.5140523910522461, -1.0853214263916016, -3.9707577228546143, -7.808595657348633, -0.3637552261352539, -6.938179016113281, -0.72784423828125, 0.848251223564148, -1.211435317993164, -0.1164712905883789, 0.025854527950286865, -1.6161680221557617, 1.1054248809814453, -0.28829383850097656, -1.6987695693969727, -0.7223707437515259, -0.38885974884033203, -1.243478775024414, -1.1199150085449219, -0.18379592895507812, -1.880258321762085, -1.9273300170898438, -0.2858543395996094, -1.4606266021728516, -6.938179016113281, -3.239084243774414, -4.9222517013549805, -3.367119312286377, -0.9752063751220703, -1.1722564697265625, 0.6451444625854492, -0.7912797927856445, -0.8535614013671875, -2.4004199504852295, -0.3937406539916992, -1.515567421913147, -2.627380847930908, 8.087718963623047, -2.1573333740234375, -2.526388645172119, -1.1595640182495117, -1.620553970336914, 0.2400197982788086, -0.48121118545532227, -0.306826114654541, -0.5684776306152344, -0.4328441619873047, -1.3952480554580688, -0.32711100578308105, 0.26180076599121094, 1.5441627502441406, -10.505071640014648, -0.5882148742675781, -1.705362319946289, -1.4985198974609375, -3.1017208099365234, -7.602987766265869, -2.1275711059570312, -1.121328353881836, -0.5129423141479492, -1.0479180812835693, -0.7229104042053223, -2.7623062133789062, -2.752743721008301, -0.4138317108154297, 0.8787631988525391, -1.8850688934326172, -2.465603828430176, -0.6170635223388672, -0.39463651180267334, -1.3585290908813477, -0.22497224807739258, -1.0186195373535156, -7.665559768676758, 0.004609107971191406, -1.0280847549438477, -5.179645538330078, -1.4418444633483887, 0.15242671966552734, 0.11615705490112305, -6.380302429199219, -0.5524024963378906, -2.217416763305664, -0.8817205429077148, -2.068479537963867, -1.8979706764221191, -8.594636917114258, -2.024974822998047, 0.2237396240234375, -1.9177970886230469, -2.6690921783447266, -0.28827810287475586, -1.4747200012207031, -0.6241331100463867, 0.6439790725708008, -0.5163488388061523, -1.131758451461792, -0.41901302337646484, -1.257425308227539, -0.2988872528076172, -1.7068958282470703, -3.8676414489746094, -0.10190677642822266, -0.5369777679443359, -4.4151105880737305, -0.28222084045410156, -3.962204933166504, -0.9157991409301758, -0.7241706848144531, -2.3722095489501953, -1.2628109455108643, 0.021152496337890625, -0.9423189163208008, -2.0828495025634766, -0.545332670211792, -0.8018176555633545, 0.08980941772460938, -1.5918617248535156, -0.5874788761138916, -2.3922014236450195, -0.9599462747573853, -1.750558853149414, -2.1159534454345703, -0.7450733184814453, -0.26868438720703125, -2.5478134155273438, -2.207369804382324, 0.935936450958252, 2.9143524169921875, -0.107421875, -1.3248014450073242, 0.01904773712158203, -0.14045757055282593, -1.0229463577270508, -2.2132856845855713, -0.0041217803955078125, -7.082895278930664, -1.6607112884521484, 1.7971296310424805, -9.823305130004883, -0.44077157974243164, -0.32871437072753906, -0.13869237899780273, 0.6686114072799683, -0.8267636299133301, -0.5674858093261719, -0.732330322265625, -1.4353599548339844, -1.3917031288146973, -0.2009831666946411, 2.1524930000305176, 1.6533268690109253, -0.28829383850097656, -0.4328441619873047, -0.9020004272460938, -2.0545473098754883, 1.2616550922393799, -1.0915851593017578, -7.976322174072266, -0.5401554107666016, -0.2988872528076172, 1.0750494003295898, -2.827134132385254, -0.8344841003417969, -5.31843376159668, -1.8936119079589844, -1.738197922706604, -0.4327859878540039, -2.3320627212524414, -14.004310607910156, -1.2431964874267578, -1.3988313674926758, -0.7973709106445312, -0.5037322044372559, -1.5803718566894531, 0.9969887733459473, -1.6434574127197266, -0.8982720375061035, 11.944329261779785, -1.1755962371826172, -1.232004165649414, -10.522329330444336, -1.3803634643554688, -0.5140523910522461, -0.038570404052734375, -1.6532139778137207, -1.6607112884521484, -2.2961254119873047, -0.8306964635848999, -2.177061080932617, -2.950021743774414, -1.1325206756591797, -1.9647979736328125, -6.263486385345459, -0.107421875, -2.0254998207092285], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 103920, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 103920, "last_target_update_ts": 28672, "num_target_updates": 55}, "sampler_results": {"episode_reward_max": 16.72385536134243, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -206.01809187107776, "episode_len_mean": 312.71084337349396, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.533025390333056, "mean_inference_ms": 23.04669782517664, "mean_action_processing_ms": 0.14180307226454464, "mean_env_wait_ms": 4.313663944095246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 16.72385536134243, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -206.01809187107776, "episode_len_mean": 312.71084337349396, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.533025390333056, "mean_inference_ms": 23.04669782517664, "mean_action_processing_ms": 0.14180307226454464, "mean_env_wait_ms": 4.313663944095246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 103920, "num_env_steps_sampled": 28672, "num_env_steps_trained": 103920, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 28672, "agent_timesteps_total": 28672, "timers": {"training_iteration_time_ms": 343.463, "learn_time_ms": 73.394, "learn_throughput": 3270.039, "synch_weights_time_ms": 20.584}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 103920, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 103920, "last_target_update_ts": 28672, "num_target_updates": 55}, "done": false, "episodes_total": 83, "training_iteration": 28, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-20-06", "timestamp": 1655500806, "time_this_iter_s": 5.453669309616089, "time_total_s": 145.69403529167175, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 145.69403529167175, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.828571428571426, "ram_util_percent": 63.02857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.076556205749512, "min_q": -43.06399917602539, "max_q": 18.10904312133789, "mean_td_error": -1.0335838794708252}, "td_error": [-1.6136150360107422, -0.6291542053222656, 1.3580036163330078, 0.4512295722961426, -0.22299575805664062, 0.19342041015625, 0.19680404663085938, 0.16118144989013672, 1.0880508422851562, 0.40499114990234375, 0.6515274047851562, -1.1108307838439941, -1.1755366325378418, 0.10347938537597656, 0.15034866333007812, -7.8462982177734375, -1.7608356475830078, -0.9909420013427734, -1.18157958984375, 1.079340934753418, -0.4754467010498047, 0.0684976577758789, -0.2881126403808594, -1.5329713821411133, -0.6536464691162109, -0.6276435852050781, -0.5609159469604492, -0.33373451232910156, -0.4271831512451172, 1.5418357849121094, -1.231536865234375, -0.9347686767578125, -2.3097238540649414, 1.2202407121658325, -6.0335187911987305, -1.4273700714111328, -1.3093128204345703, 1.4083690643310547, -8.226648330688477, -0.8950464129447937, 1.71905517578125, -6.543425559997559, -2.3233680725097656, -0.6074485778808594, -2.5501880645751953, -1.8715620040893555, -1.0588507652282715, -0.6542942523956299, 0.8868284225463867, 0.5270376205444336, -2.8090620040893555, 0.16615772247314453, -1.2113094329833984, -0.5645408630371094, -2.4620494842529297, 2.9215903282165527, -1.233902931213379, 6.341209411621094, -0.7154899835586548, 0.9153823852539062, -0.9090631008148193, 0.9027137756347656, -6.959482192993164, -1.5035514831542969, 1.0020694732666016, -0.2136363983154297, 0.7920665740966797, -1.4379527568817139, -1.7390861511230469, 0.6961631774902344, -2.623350143432617, -3.118802070617676, -19.740249633789062, -0.4972238540649414, -0.3604259490966797, -7.798973083496094, 0.13472461700439453, 1.5418357849121094, -1.1357860565185547, -0.35662841796875, -0.8055529594421387, 0.31865596771240234, -2.055347442626953, 0.128509521484375, 0.4300346374511719, -0.4119434356689453, 0.8546848297119141, -0.4161357879638672, 0.023955345153808594, -1.9856605529785156, 0.2194819450378418, -1.3557677268981934, 0.5859565734863281, -0.8319531083106995, -0.3364753723144531, -0.44988250732421875, -1.127058744430542, -6.1521806716918945, -0.6080577373504639, -7.158490180969238, -1.0739030838012695, -1.7599809169769287, 0.35950660705566406, 0.2604942321777344, -1.1106467247009277, -0.4443016052246094, 11.991686820983887, -1.249502420425415, 0.7090568542480469, -0.27435505390167236, -1.8026918172836304, 0.45226335525512695, -0.3367023468017578, 0.16179466247558594, -0.5551376342773438, -0.9965295791625977, -10.527676582336426, -0.6819515228271484, 0.40943145751953125, 0.1623070240020752, 0.7233047485351562, 1.866114616394043, -0.016820907592773438, -0.9666881561279297, 1.3203010559082031, -1.5743162631988525, -17.955127716064453, -0.5011215209960938, -4.508823394775391, -0.0957498550415039, -1.0502629280090332, 0.1621408462524414, -0.3357830047607422, -0.1220703125, -0.5124001502990723, -0.43862342834472656, -1.4558687210083008, 1.0475988388061523, -2.3048434257507324, -2.6780128479003906, -0.6366043090820312, 0.29108238220214844, -1.3565995693206787, 0.44000303745269775, -0.02312016487121582, 2.9859371185302734, -1.0435543060302734, 0.3067035675048828, -7.0003342628479, -0.364532470703125, -1.5191593170166016, 0.18194007873535156, -0.16311264038085938, -0.2214670181274414, -0.32259154319763184, 0.36389923095703125, 0.21228313446044922, 0.7657680511474609, -0.19443607330322266, -1.7300217151641846, -1.0241100788116455, 0.27576911449432373, 0.30655860900878906, 1.8318328857421875, 1.0974230766296387, -0.4038963317871094, -7.108870029449463, -1.4878859519958496, 0.7712841033935547, -0.16739845275878906, 0.2504463195800781, -1.4379527568817139, -1.191385269165039, -2.7227470874786377, -1.7366771697998047, -0.05329132080078125, -0.6543402671813965, -0.9925289154052734, 0.038552284240722656, -3.746124267578125, -0.46189790964126587, 0.0859375, -0.8439178466796875, -0.7226943969726562, -6.088014602661133, -0.39973974227905273, -2.8684916496276855, -1.8349590301513672, -0.3985726833343506, -1.2397041320800781, -0.7814512252807617, -1.124674677848816, -1.4775934219360352, -0.19443607330322266, -0.48668861389160156, -6.151558876037598, 1.0880508422851562, 0.2469005584716797, -0.5519475936889648, 0.40430545806884766, -0.22245752811431885, 0.21428585052490234, -0.8320026397705078, 1.675248146057129, -0.5154056549072266, -0.03162574768066406, -1.319040298461914, -2.938453197479248, -1.1200733184814453, -1.0563817024230957, -0.8294878005981445, -1.3319168090820312, -1.9037505388259888, -3.373485565185547, -0.3941488265991211, -0.08933067321777344, -2.362123727798462, 1.189566731452942, -0.7613605260848999, 0.7756671905517578, 1.2744827270507812, 0.1913433074951172, -0.4841804504394531, -0.30721378326416016, 0.573641300201416, -0.31802940368652344, 0.3386354446411133, -1.3665246963500977, -1.1565971374511719, -0.6453762054443359, 1.5996017456054688, 1.7820050716400146, -2.76259708404541, -1.2055330276489258, -0.4468841552734375, -34.64713668823242, 0.8477878570556641, -0.16347968578338623, 0.22213077545166016, -0.16347968578338623], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 107760, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 107760, "last_target_update_ts": 29696, "num_target_updates": 57}, "sampler_results": {"episode_reward_max": 44.98954364657402, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -201.55925900313292, "episode_len_mean": 310.85393258426967, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321026462383402, "mean_inference_ms": 23.069290638367814, "mean_action_processing_ms": 0.14150835320979585, "mean_env_wait_ms": 4.298853352134873, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 44.98954364657402, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -201.55925900313292, "episode_len_mean": 310.85393258426967, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321026462383402, "mean_inference_ms": 23.069290638367814, "mean_action_processing_ms": 0.14150835320979585, "mean_env_wait_ms": 4.298853352134873, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 107760, "num_env_steps_sampled": 29696, "num_env_steps_trained": 107760, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 29696, "agent_timesteps_total": 29696, "timers": {"training_iteration_time_ms": 334.787, "learn_time_ms": 73.314, "learn_throughput": 3273.595, "synch_weights_time_ms": 20.688}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 107760, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 107760, "last_target_update_ts": 29696, "num_target_updates": 57}, "done": false, "episodes_total": 89, "training_iteration": 29, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-20-11", "timestamp": 1655500811, "time_this_iter_s": 5.536829948425293, "time_total_s": 151.23086524009705, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 151.23086524009705, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.275, "ram_util_percent": 63.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.933794021606445, "min_q": -42.66582489013672, "max_q": 17.569332122802734, "mean_td_error": -0.07862839102745056}, "td_error": [2.2176742553710938, -1.8044331073760986, 0.3197188377380371, 0.02245807647705078, -0.1476764678955078, 0.41191959381103516, 0.08228683471679688, -2.5329480171203613, -0.08064591884613037, -0.7229628562927246, 1.1256294250488281, 1.3854484558105469, 1.0029358863830566, -0.11449241638183594, -5.7412109375, 0.6033725738525391, -0.2648897171020508, -7.197044372558594, 0.6596713066101074, -1.3042845726013184, 0.965022087097168, -0.323272705078125, -1.2070093154907227, 0.14541244506835938, -1.0567121505737305, 0.47911834716796875, 0.6736068725585938, 2.921855926513672, 0.26163148880004883, -0.9788841009140015, 0.6033725738525391, -8.456825256347656, 1.593149185180664, -0.32129573822021484, 3.492554187774658, 0.14404940605163574, -0.5654290914535522, 1.0590190887451172, 0.5269680023193359, -0.25725746154785156, 0.5601692199707031, 0.15838193893432617, 1.3174982070922852, 1.1136322021484375, 1.3288078308105469, -0.04990577697753906, 0.5655755996704102, -0.323272705078125, -0.03813004493713379, 0.19378018379211426, 1.4882421493530273, 3.1944475173950195, -7.330600738525391, -0.5715246200561523, -0.39301013946533203, 0.9800567626953125, 3.028517007827759, -1.188227653503418, 0.574641227722168, -0.04990577697753906, -0.5922231674194336, 1.33243989944458, 0.08286166191101074, 0.5592203140258789, 1.230966567993164, 1.0739006996154785, 0.14640569686889648, 1.3808250427246094, 0.6581630706787109, 2.510129928588867, -1.2562155723571777, 1.3958133459091187, -0.1446704864501953, -0.6461868286132812, -3.8819589614868164, -4.751466751098633, -0.8992128372192383, -0.06742167472839355, -0.5513410568237305, -0.5845832824707031, -0.14580821990966797, -0.5810105800628662, 1.8770583868026733, 1.593149185180664, 1.2159786224365234, 1.8810615539550781, -1.9201222658157349, -0.05870246887207031, 1.3534883260726929, 1.067124366760254, 2.664216995239258, -7.348944664001465, -2.949108600616455, 0.03865623474121094, 1.5795440673828125, 1.942556381225586, -12.98266315460205, 1.0719985961914062, 1.2409124374389648, 1.0748767852783203, 1.2516422271728516, -0.8080927133560181, -5.05490779876709, -2.047797203063965, 0.09764957427978516, 0.3689451217651367, 1.957198143005371, -0.5690593719482422, 1.7721824645996094, -0.18996238708496094, 0.4150642156600952, 0.7004413604736328, -1.2924513816833496, 2.128277063369751, 2.2555437088012695, 1.2909560203552246, -5.076988220214844, 1.4600343704223633, 2.5655555725097656, 1.3056342601776123, 0.9182167053222656, 1.7178001403808594, 0.1892414093017578, -1.0612211227416992, 0.8482866287231445, 0.0791056752204895, 0.22963714599609375, 0.810877799987793, 0.09307551383972168, 1.1143016815185547, 1.2159786224365234, 1.5220527648925781, -0.8348933458328247, 1.4849128723144531, 0.4599571228027344, 1.7732086181640625, -1.418324589729309, 0.21216416358947754, 0.9694366455078125, -0.47131919860839844, 1.049428939819336, 0.2120504379272461, -0.9368705749511719, -0.6394824981689453, 0.021139144897460938, 0.4527740478515625, 0.7708702087402344, -0.5878715515136719, -8.808269500732422, -4.7017717361450195, 1.8463764190673828, -5.935422420501709, 0.21084022521972656, -0.023708820343017578, 0.06020784378051758, 0.9106378555297852, -1.4134149551391602, 1.4618687629699707, 1.9850378036499023, -0.04345417022705078, -0.044506072998046875, 0.2017974853515625, -0.18296551704406738, 0.11373519897460938, 0.3475379943847656, 2.14147686958313, 0.8497915267944336, -2.3385095596313477, 0.8067054748535156, 1.6326866149902344, 1.5123634338378906, 0.3263359069824219, 3.305971145629883, 0.38515645265579224, 1.249917984008789, 0.7564029693603516, 0.6342639923095703, -0.04268836975097656, 1.593149185180664, 0.6159979104995728, -1.3715449571609497, 2.799078941345215, 2.5655555725097656, 1.1864643096923828, -0.2964959144592285, 0.4786796569824219, -0.6733617782592773, 0.7598304748535156, -0.520824670791626, -0.21653270721435547, 0.624936580657959, 1.8978676795959473, 0.3475379943847656, 0.42722511291503906, 1.020751953125, 0.3658599853515625, 1.313014030456543, 1.1121692657470703, -6.746399879455566, -2.2078216075897217, 1.8344135284423828, 2.018709659576416, -8.465546607971191, -0.955902099609375, -1.153524398803711, 1.754551887512207, 2.544156789779663, 0.5857148766517639, -5.890783309936523, -1.5157432556152344, -1.7182843685150146, 2.17645263671875, -2.137605667114258, -11.79884147644043, 0.48358631134033203, 0.6688356995582581, 1.5861053466796875, 1.569063663482666, 0.8972043991088867, 4.940359115600586, -2.3109278678894043, 1.7721824645996094, -0.5508346557617188, 0.04349517822265625, -4.769082069396973, 0.7114548683166504, 2.4989233016967773, 1.2355725765228271, 1.3976402282714844, 1.5419425964355469, -4.7017717361450195, 0.2743816375732422, -0.34690093994140625, -5.427302360534668, -0.16162681579589844, 1.4618687629699707, 1.4787664413452148, -0.01925373077392578, 1.8331408500671387, 0.9521722793579102], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 111600, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 111600, "last_target_update_ts": 30720, "num_target_updates": 59}, "sampler_results": {"episode_reward_max": 44.98954364657402, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -200.40780682501557, "episode_len_mean": 310.2307692307692, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5316262597155109, "mean_inference_ms": 23.095406441742373, "mean_action_processing_ms": 0.1415656660605252, "mean_env_wait_ms": 4.295839862751194, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 44.98954364657402, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -200.40780682501557, "episode_len_mean": 310.2307692307692, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5316262597155109, "mean_inference_ms": 23.095406441742373, "mean_action_processing_ms": 0.1415656660605252, "mean_env_wait_ms": 4.295839862751194, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 111600, "num_env_steps_sampled": 30720, "num_env_steps_trained": 111600, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 30720, "agent_timesteps_total": 30720, "timers": {"training_iteration_time_ms": 318.66, "learn_time_ms": 73.983, "learn_throughput": 3243.968, "synch_weights_time_ms": 20.489}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 111600, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 111600, "last_target_update_ts": 30720, "num_target_updates": 59}, "done": false, "episodes_total": 91, "training_iteration": 30, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-20-17", "timestamp": 1655500817, "time_this_iter_s": 5.300830364227295, "time_total_s": 156.53169560432434, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 156.53169560432434, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.262500000000003, "ram_util_percent": 63.1375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.837485313415527, "min_q": -43.49505615234375, "max_q": 21.81341552734375, "mean_td_error": -0.6465445160865784}, "td_error": [1.0542869567871094, -1.1025657653808594, -0.15148544311523438, -1.556732177734375, 1.9702949523925781, 2.1357288360595703, 1.0687408447265625, 2.0957794189453125, 1.992326259613037, 1.1307785511016846, -0.340604305267334, -0.3082265853881836, -5.679142951965332, 1.6111326217651367, 0.9584712982177734, 1.3089752197265625, -1.3069725036621094, -4.821547031402588, -1.2885303497314453, -0.25427573919296265, 0.5751991271972656, -0.5887289047241211, -2.9998416900634766, 5.146640300750732, 0.9559788107872009, -2.211475372314453, 0.047118186950683594, -0.6995587348937988, 1.120631217956543, 0.7396774291992188, 1.328378677368164, 0.0500335693359375, -0.6154255867004395, -0.6857461929321289, -5.513460159301758, -0.874237060546875, 1.1307785511016846, 0.3384284973144531, -1.0831046104431152, -2.311617374420166, 1.035308837890625, -0.5674470663070679, -0.22664451599121094, 1.203033447265625, -0.42099571228027344, -0.45604705810546875, 0.3332490921020508, -1.8273754119873047, 0.5901126861572266, -0.28400421142578125, 0.8651237487792969, -0.7404699325561523, 1.0591392517089844, -1.4340429306030273, -0.15793228149414062, -3.596001148223877, 0.18758797645568848, 0.4227266311645508, -0.4818744659423828, -0.8288218975067139, -1.3779048919677734, -0.41044628620147705, 1.224203109741211, -3.324399948120117, 0.6157798767089844, 0.14476776123046875, -2.9792137145996094, -0.5118207931518555, -1.3959331512451172, -0.04096031188964844, 1.1307785511016846, -0.9243080615997314, -1.1722103357315063, -2.28875732421875, -0.6092264652252197, -0.24636852741241455, -0.43845367431640625, 1.035308837890625, 1.1400470733642578, -0.9172067642211914, 0.11409759521484375, -4.250434875488281, 0.9664280414581299, -3.0836167335510254, 1.4097957611083984, 0.7712891697883606, -8.836884498596191, 1.1381072998046875, 0.5627260208129883, -0.5474166870117188, -30.391693115234375, 0.00870513916015625, -0.2523307800292969, -2.3124871253967285, -3.012982130050659, 0.8840265274047852, -11.985564231872559, 1.2431068420410156, -0.8011846542358398, 0.6050319671630859, -0.42511558532714844, -0.7580604553222656, -11.905193328857422, 0.1952066421508789, 2.0334854125976562, 2.3639326095581055, 1.3795075416564941, -6.735302448272705, 0.40433597564697266, 0.5526981353759766, -0.5901041030883789, 0.67486572265625, 0.6582622528076172, 1.7305068969726562, 0.3727283477783203, -0.9191558361053467, 1.0680122375488281, -1.5398216247558594, 0.8360500335693359, -1.0115867853164673, -0.05327796936035156, 0.7065811157226562, 1.9882030487060547, -1.3257986307144165, 0.41590404510498047, -0.09862232208251953, -1.3577549457550049, -0.7230100631713867, 2.7405929565429688, 0.16424179077148438, -1.0982475280761719, 1.1092681884765625, -2.9792137145996094, 0.5219802856445312, -0.1639547348022461, -0.7295637130737305, 1.9506263732910156, -1.7243661880493164, -1.9718663692474365, 0.07641983032226562, 0.8594722747802734, -0.7558929920196533, -0.3726310729980469, -12.313638687133789, 0.7163922786712646, -3.1100940704345703, 2.5813140869140625, -1.4406347274780273, 0.8702754974365234, 1.142251968383789, 0.34877490997314453, -0.3473358154296875, -0.8349037170410156, -2.198939561843872, 1.1294746398925781, -1.1246747970581055, -3.423736095428467, 1.1500053405761719, -0.37029457092285156, 0.44470930099487305, -2.149911880493164, 1.3089752197265625, 0.036231040954589844, 0.6572641730308533, -1.0466632843017578, 0.14586830139160156, -1.9833035469055176, -0.5470705032348633, 1.1125483512878418, 1.2718658447265625, -1.3200187683105469, 1.0530967712402344, -0.09115219116210938, -0.3232002258300781, 0.4730796813964844, -7.219581604003906, -6.518187999725342, 0.5937137603759766, -0.934356689453125, -1.3691320419311523, 0.14150381088256836, 0.009105682373046875, -0.35457801818847656, 0.6727981567382812, 0.0054168701171875, 0.30606555938720703, 0.009685516357421875, 3.0772948265075684, 0.4398975372314453, -0.29407835006713867, 0.11291694641113281, 1.328378677368164, 1.1927108764648438, -6.478668212890625, 0.9478282928466797, -7.364789009094238, 0.21166753768920898, 0.3039640188217163, 0.9712934494018555, 0.9725799560546875, -0.20599651336669922, -0.10567760467529297, 0.6727981567382812, -5.507438659667969, -0.027703285217285156, 0.0755014419555664, 0.43461036682128906, 0.1404857635498047, -1.2772293090820312, -1.1316909790039062, 1.3902015686035156, -0.06438636779785156, 0.9711589813232422, 0.03435373306274414, 0.45076465606689453, -2.6310336589813232, -0.16642284393310547, -5.27769136428833, -0.7411420345306396, 0.2801094055175781, -2.7134337425231934, -0.6144943237304688, 1.6749076843261719, 0.036231040954589844, 1.472677230834961, -1.3578119277954102, -0.25670433044433594, 1.5283451080322266, 0.2217874526977539, -1.972830057144165, -0.7573528289794922, 1.8740253448486328, -1.4891643524169922, -8.380961418151855, -0.3530874252319336, -1.0056943893432617, 0.604973316192627, 2.0022144317626953, -1.7669415473937988, 2.7016074657440186], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 115440, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 115440, "last_target_update_ts": 31744, "num_target_updates": 61}, "sampler_results": {"episode_reward_max": 44.98954364657402, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -196.96461618895594, "episode_len_mean": 308.81052631578945, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5304383288856086, "mean_inference_ms": 23.12880275637246, "mean_action_processing_ms": 0.14129230637544718, "mean_env_wait_ms": 4.290347876958315, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 44.98954364657402, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -196.96461618895594, "episode_len_mean": 308.81052631578945, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5304383288856086, "mean_inference_ms": 23.12880275637246, "mean_action_processing_ms": 0.14129230637544718, "mean_env_wait_ms": 4.290347876958315, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 115440, "num_env_steps_sampled": 31744, "num_env_steps_trained": 115440, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 31744, "agent_timesteps_total": 31744, "timers": {"training_iteration_time_ms": 345.056, "learn_time_ms": 72.625, "learn_throughput": 3304.647, "synch_weights_time_ms": 20.651}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 115440, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 115440, "last_target_update_ts": 31744, "num_target_updates": 61}, "done": false, "episodes_total": 95, "training_iteration": 31, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-20-22", "timestamp": 1655500822, "time_this_iter_s": 5.405152797698975, "time_total_s": 161.93684840202332, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 161.93684840202332, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.2125, "ram_util_percent": 63.2625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.665346145629883, "min_q": -45.04978942871094, "max_q": 23.628032684326172, "mean_td_error": -0.09391199797391891}, "td_error": [-3.2626724243164062, -24.169347763061523, -0.7355928421020508, 0.5376148223876953, 1.8511486053466797, -0.23041915893554688, 0.8061714172363281, 2.1748695373535156, -0.4637603759765625, 0.11284732818603516, -0.04710197448730469, -0.04334664344787598, 0.7487479448318481, 1.5825109481811523, -0.8397312164306641, -1.9342479705810547, -0.31420326232910156, 1.1486320495605469, 1.3408946990966797, -0.8362636566162109, 7.439918041229248, -1.2904281616210938, 2.764526844024658, -1.1792116165161133, 1.7571897506713867, 0.5807027816772461, 0.5845237970352173, -10.458253860473633, 0.2154407501220703, 0.07506942749023438, 0.8569278717041016, -4.930971622467041, 2.626707077026367, 0.2301645278930664, 0.6446056365966797, 0.5978965759277344, 1.7553300857543945, 0.4331808090209961, -0.8702287673950195, -0.05743408203125, -1.7690457105636597, 1.863001823425293, -0.5571918487548828, -0.8300399780273438, 1.9542412757873535, 0.24932289123535156, -1.8372859954833984, 3.043905258178711, -0.9711713790893555, -3.8162496089935303, -0.6825944185256958, 2.286487579345703, -0.7184009552001953, -0.2816009521484375, -0.5813179016113281, -0.7417583465576172, -1.5349540710449219, -0.8054301738739014, 1.0516166687011719, 0.8175952434539795, -0.091339111328125, -0.8867969512939453, 0.3023052215576172, -0.4797821044921875, 1.689096450805664, 0.31117820739746094, 0.22518253326416016, 3.2221739292144775, 0.05116081237792969, 2.264643669128418, 2.1833648681640625, -4.298725128173828, 1.560384750366211, 4.115504741668701, -0.7524089813232422, 1.0770835876464844, 0.5297117233276367, 0.23143815994262695, 0.5978965759277344, 0.32493019104003906, -1.5926406383514404, 0.3721790313720703, 1.1215076446533203, -7.812149524688721, 0.024389266967773438, -0.017597198486328125, 2.2479686737060547, 1.740209937095642, 0.3043251037597656, -4.70639705657959, -0.6739616394042969, -8.251678466796875, 3.003542900085449, 1.0532970428466797, 3.043905258178711, 7.992188930511475, -0.562220573425293, -0.017597198486328125, 0.22341537475585938, -9.260490417480469, 0.6989102363586426, -1.1154365539550781, 0.4539985656738281, -0.1212158203125, -0.23082351684570312, 3.496572494506836, 1.0420074462890625, -0.4966554641723633, 3.8424224853515625, 0.85504150390625, 1.6347637176513672, 3.8974685668945312, -1.9743061065673828, 3.8424224853515625, 0.47988319396972656, -2.1667919158935547, 0.4687004089355469, 0.5295131206512451, 6.196283340454102, 2.8840103149414062, 1.5766539573669434, -1.9216117858886719, -0.009943485260009766, 0.048297882080078125, 2.6941022872924805, 0.28363037109375, 0.8785157203674316, -0.5129060745239258, 1.5962028503417969, -1.2372970581054688, 0.8785157203674316, -2.4672534465789795, 1.9641151428222656, -2.0351040363311768, 1.308328628540039, -0.3031501770019531, 1.473743200302124, 1.6307401657104492, 1.0601997375488281, -1.575331211090088, 0.9614057540893555, 1.717869758605957, -0.6739616394042969, 0.2180767059326172, 1.081111192703247, -7.722450256347656, 1.0907363891601562, 0.9951468706130981, -0.3320198059082031, -1.0947898626327515, 0.6060794591903687, -3.278583526611328, 0.32656097412109375, -1.0244859457015991, -0.37449169158935547, 2.5482563972473145, -0.6103055477142334, 0.1562638282775879, -5.171837329864502, 1.2306976318359375, 1.6094436645507812, -8.078628540039062, -0.6975927352905273, 0.11725425720214844, -1.8363609313964844, 0.6099166870117188, -0.23495697975158691, -0.2688465118408203, 1.28131103515625, 0.28171539306640625, -0.30085253715515137, 1.2880573272705078, 0.10404586791992188, -0.3026742935180664, 1.2260818481445312, 0.7905998229980469, 0.6825428009033203, -0.31565380096435547, 1.0238094329833984, -0.1526041030883789, 0.2944374084472656, 0.49810791015625, -1.4665346145629883, 1.2539215087890625, 1.0668554306030273, 1.5124483108520508, -0.9987506866455078, 0.1516876220703125, 1.0008106231689453, -1.4918155670166016, 0.28171539306640625, 1.8907289505004883, -0.08807563781738281, -1.589235782623291, 0.22518253326416016, -0.5325908660888672, 2.0421302318573, 2.7264504432678223, -2.0518064498901367, -0.15212059020996094, -0.8126540184020996, -9.489442825317383, 0.5330238342285156, 1.0006189346313477, -0.6750650405883789, 0.38038039207458496, 0.8600292205810547, -1.270176887512207, -7.570189952850342, -0.32134056091308594, -1.7738943099975586, 1.2928152084350586, -1.5817146301269531, -2.2503223419189453, -0.5908966064453125, 1.093515396118164, 0.08491325378417969, 1.0169086456298828, 1.253676414489746, 0.6407451629638672, -0.7628641128540039, 1.0113563537597656, 0.8411617279052734, -0.028005599975585938, -1.1212631464004517, -0.1773052215576172, -1.3794703483581543, -1.045933723449707, 0.3827991485595703, -0.34893035888671875, 2.684661865234375, -1.7906522750854492, 0.9845619201660156, -0.5571918487548828, -0.31895923614501953, -1.914071798324585, -0.536677360534668, 3.077352523803711, 0.040561676025390625, -0.7483158111572266], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 119280, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 119280, "last_target_update_ts": 32768, "num_target_updates": 63}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -186.44465117424727, "episode_len_mean": 307.16, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5308631993469548, "mean_inference_ms": 23.14808566533091, "mean_action_processing_ms": 0.14086659311300256, "mean_env_wait_ms": 4.281315905934573, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -186.44465117424727, "episode_len_mean": 307.16, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.487387269735336, 13.373173050582409, -23.175300426781178, -44.09618305414915, -52.79999990016222, -47.968389227986336, -54.70570278912783, -55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446], "episode_lengths": [232, 211, 245, 251, 234, 244, 247, 248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5308631993469548, "mean_inference_ms": 23.14808566533091, "mean_action_processing_ms": 0.14086659311300256, "mean_env_wait_ms": 4.281315905934573, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 119280, "num_env_steps_sampled": 32768, "num_env_steps_trained": 119280, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 32768, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 338.716, "learn_time_ms": 74.085, "learn_throughput": 3239.509, "synch_weights_time_ms": 20.347}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 119280, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 119280, "last_target_update_ts": 32768, "num_target_updates": 63}, "done": false, "episodes_total": 100, "training_iteration": 32, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-20-28", "timestamp": 1655500828, "time_this_iter_s": 5.2983238697052, "time_total_s": 167.23517227172852, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 167.23517227172852, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.599999999999994, "ram_util_percent": 63.385714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.857102394104004, "min_q": -47.27126693725586, "max_q": 24.026988983154297, "mean_td_error": -1.1544151306152344}, "td_error": [1.7595176696777344, 0.881805419921875, -2.371866226196289, -0.49810171127319336, -5.550870895385742, -1.1293516159057617, 0.6633377075195312, -2.0441393852233887, 1.9090933799743652, -0.8024654388427734, -0.9356365203857422, -0.9168100357055664, -0.9114022254943848, -0.08673477172851562, 0.9801349639892578, -0.024793624877929688, -12.487848281860352, -0.07024574279785156, -2.2799155712127686, 1.3415470123291016, 0.7528302669525146, -0.8842487335205078, -0.35150146484375, -4.837845802307129, 1.3880715370178223, 0.9121055603027344, -7.464687347412109, -0.08651542663574219, 0.2130126953125, -6.981696128845215, -0.31414794921875, -1.4508891105651855, -0.24600601196289062, -2.124283790588379, -0.4488410949707031, -1.1024856567382812, 0.1138916015625, -0.7535190582275391, -0.5569594502449036, 0.617009162902832, -4.400979518890381, 0.5288581848144531, -2.585775375366211, -2.3141767978668213, 0.9882621765136719, -5.202508926391602, -32.16331481933594, 6.323732852935791, -1.1376428604125977, -0.8430213928222656, -0.8885765075683594, 1.0817813873291016, 1.0747051239013672, 2.411341428756714, 0.5316486358642578, -0.5204524993896484, 0.08091259002685547, -0.2868618965148926, 1.0274991989135742, -1.0208110809326172, 0.7598833441734314, -0.12524127960205078, -0.32338905334472656, -3.974191188812256, -2.107025146484375, 0.08980703353881836, -1.4614982604980469, 0.4598121643066406, -0.23284339904785156, 0.3035249710083008, -8.126419067382812, -1.000326156616211, -5.795148849487305, 1.0264899730682373, 0.029727935791015625, 1.4918098449707031, 0.28791236877441406, -0.7906723022460938, -0.4189033508300781, 1.442514419555664, -0.4261627197265625, 0.17481422424316406, 1.185941457748413, -5.604122161865234, -11.462799072265625, -0.31476593017578125, -30.960988998413086, 0.8201503753662109, -2.6693098545074463, 10.367935180664062, -0.251800537109375, -0.4908294677734375, -0.5108489990234375, 1.2514197826385498, -1.2690367698669434, -0.9984302520751953, -13.832592964172363, -0.5782594680786133, 1.0679750442504883, -7.92928409576416, 2.1799302101135254, -0.5472745895385742, -1.1934905052185059, -0.22867774963378906, -6.97169828414917, -1.4293098449707031, -1.5411968231201172, 0.44751524925231934, -2.178457260131836, -1.2673757076263428, 1.212087869644165, 0.7911067008972168, -4.600638389587402, 0.699099063873291, 0.4110832214355469, 1.4494616985321045, 0.7907381057739258, 0.4335958957672119, 1.18756103515625, 0.10410881042480469, -2.547088623046875, -0.38249778747558594, 0.3744816780090332, 0.11166572570800781, 1.0148921012878418, -0.22638607025146484, 0.8632190227508545, 0.7040863037109375, -1.1866531372070312, 0.1138916015625, -0.48987793922424316, -6.156886100769043, 6.060540199279785, -0.7291627526283264, -0.21921920776367188, 0.4188389778137207, -3.5645084381103516, 1.699563980102539, -2.057527542114258, -0.7776641845703125, -1.3163471221923828, 0.7700986862182617, -0.10817527770996094, 1.2955970764160156, 1.8953717947006226, -7.6649580001831055, -1.7798347473144531, 0.24549457430839539, -1.5511789321899414, 2.0380983352661133, -1.8326797485351562, -0.0803070068359375, -0.5065155029296875, 0.6967463493347168, -0.7740240097045898, 2.054854393005371, -18.19622802734375, -0.6958656311035156, -3.2747154235839844, 0.6388078331947327, -0.4014301300048828, 0.789093017578125, 1.3185272216796875, -9.171989440917969, 0.6480953693389893, -0.8065013885498047, 0.22548389434814453, 1.6746867895126343, 2.0389318466186523, -0.7335586547851562, -2.7168712615966797, 0.7584018707275391, -1.2583808898925781, -0.27977466583251953, 1.349100112915039, 1.7336435317993164, 0.6854265928268433, 0.2306652069091797, 0.626617431640625, 0.8128259181976318, -0.739220142364502, 0.15076637268066406, 0.8565578460693359, 2.0540523529052734, 0.29120466113090515, -0.35242366790771484, -0.4571208953857422, -0.7684440612792969, -1.2200889587402344, 3.775888681411743, 1.1869537830352783, 1.8982486724853516, -0.7534866333007812, -0.7044563293457031, 0.9556655883789062, -0.1059122085571289, -0.8144493103027344, -0.5802240371704102, -1.2884573936462402, -1.6190567016601562, -0.5785706043243408, 1.019989013671875, -0.32917118072509766, -0.9669647216796875, -0.5906696319580078, -0.08604812622070312, -1.4355888366699219, -1.365072250366211, 0.1769390106201172, 0.5201320648193359, -32.16331481933594, 0.8800230026245117, -1.8710498809814453, -1.4333629608154297, -14.68626880645752, -0.0017614364624023438, -1.6999917030334473, -0.7534866333007812, -0.9617347717285156, 1.1301803588867188, -0.07332611083984375, 0.696894645690918, -1.8838238716125488, -1.0810813903808594, 0.15912246704101562, -3.6759424209594727, -1.5699529647827148, 0.9962043762207031, -6.506496429443359, -1.538137435913086, -0.6714267730712891, 0.19660186767578125, -0.23284339904785156, 0.5236625671386719, -2.058778762817383, 1.3681297302246094, 0.2113051414489746, -0.29143524169921875, 2.1799302101135254, 1.8644509315490723], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 123120, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 123120, "last_target_update_ts": 33792, "num_target_updates": 65}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -191.50952316120268, "episode_len_mean": 309.56, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477], "episode_lengths": [248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5253050666837429, "mean_inference_ms": 23.24738671953586, "mean_action_processing_ms": 0.14034502654021577, "mean_env_wait_ms": 4.209373269587309, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -191.50952316120268, "episode_len_mean": 309.56, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477], "episode_lengths": [248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5253050666837429, "mean_inference_ms": 23.24738671953586, "mean_action_processing_ms": 0.14034502654021577, "mean_env_wait_ms": 4.209373269587309, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 123120, "num_env_steps_sampled": 33792, "num_env_steps_trained": 123120, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 33792, "agent_timesteps_total": 33792, "timers": {"training_iteration_time_ms": 353.601, "learn_time_ms": 73.844, "learn_throughput": 3250.112, "synch_weights_time_ms": 20.487}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 123120, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 123120, "last_target_update_ts": 33792, "num_target_updates": 65}, "done": false, "episodes_total": 107, "training_iteration": 33, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-20-33", "timestamp": 1655500833, "time_this_iter_s": 5.452607154846191, "time_total_s": 172.6877794265747, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 172.6877794265747, "timesteps_since_restore": 0, "iterations_since_restore": 33, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.075, "ram_util_percent": 63.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -10.652032852172852, "min_q": -46.845027923583984, "max_q": 24.302671432495117, "mean_td_error": -1.940406084060669}, "td_error": [-0.48429298400878906, -1.7624835968017578, -2.340242385864258, -1.763155221939087, -5.637137413024902, -2.057964324951172, -1.9086017608642578, -1.8364238739013672, 1.3051719665527344, -0.13419723510742188, -0.21605873107910156, -2.0373542308807373, -1.9603157043457031, -16.207929611206055, 0.16774940490722656, -1.5778732299804688, -0.9613490104675293, -0.04728507995605469, -0.8696101903915405, -2.531186103820801, -2.0332508087158203, 1.2453508377075195, -6.046830177307129, -0.9160919189453125, 0.02398681640625, -1.546884536743164, -2.4429001808166504, -3.544161796569824, -3.4321978092193604, -1.068441390991211, -1.0813803672790527, -2.2562255859375, 0.2527155876159668, -3.807478904724121, -0.1897411346435547, -0.73150634765625, -7.588199615478516, 3.5205636024475098, -8.91834831237793, -17.39851188659668, -26.4952335357666, -2.012321710586548, -7.885859966278076, -2.4302845001220703, -1.3124504089355469, -1.5279369354248047, -1.0195417404174805, -0.18145465850830078, -0.9339275360107422, -1.865844488143921, -0.6753215789794922, -0.48259449005126953, -2.2100777626037598, -1.9774889945983887, -0.830660343170166, -0.8951587677001953, -2.4915661811828613, -1.3124504089355469, -2.5063037872314453, -0.6864013671875, -1.7846438884735107, -2.2024223804473877, -0.06149864196777344, -1.8252878189086914, -2.246685028076172, 0.3878974914550781, -1.726959228515625, -1.8158080577850342, 0.3617534637451172, -0.03473949432373047, -2.499195098876953, -0.9957089424133301, 0.9116216897964478, -1.7800116539001465, -1.242049217224121, -2.593325614929199, -8.524179458618164, -3.8168935775756836, 0.49289703369140625, -2.455195903778076, -2.1372475624084473, -2.502696990966797, -0.7158031463623047, -7.5012288093566895, -0.4752006530761719, -1.3643741607666016, -0.29102063179016113, -1.5149760246276855, -1.376164436340332, -9.208295822143555, -3.421231985092163, -7.142449378967285, -2.3273143768310547, -1.4102740287780762, -0.9425048828125, -1.6062602996826172, 0.29868507385253906, -1.3363940715789795, -2.5415399074554443, -1.5805211067199707, -1.5397605895996094, -2.570647716522217, 2.574354648590088, -0.3325892686843872, -0.40280914306640625, -1.3788528442382812, -1.5011835098266602, -0.641627311706543, -1.8068242073059082, -2.9231348037719727, -1.6167898178100586, -3.563344955444336, -1.5778732299804688, -1.3633403778076172, -0.033901214599609375, -1.8510708808898926, -1.193532943725586, -1.2826480865478516, -2.614140748977661, -2.2955098152160645, -2.082286834716797, -2.0575637817382812, -1.9765715599060059, 0.3853001594543457, 1.2732410430908203, -0.9898691177368164, -1.0488548278808594, 4.504033088684082, -5.6181440353393555, -1.472879409790039, -0.2447519302368164, -0.18580245971679688, -2.0087833404541016, -2.0327091217041016, -0.8296909332275391, -1.5664939880371094, 1.3841190338134766, -2.996185302734375, -0.9615368247032166, 0.5096015930175781, -1.9031734466552734, -1.028696060180664, -5.196840286254883, 0.6349296569824219, -3.2718358039855957, 0.079559326171875, -0.3325892686843872, -0.8216146230697632, 0.053041696548461914, -1.1445064544677734, 0.32103919982910156, 0.5137901306152344, -1.3352586030960083, -6.90988826751709, -3.8521366119384766, -16.207929611206055, -0.3956489562988281, -1.396493911743164, -1.1970787048339844, -4.632608413696289, -3.117382049560547, -1.4652376174926758, 0.13018035888671875, -7.139965057373047, -1.0320687294006348, -5.449764251708984, -2.2169628143310547, -0.4621696472167969, -1.5711374282836914, -0.8527030944824219, -1.281198501586914, -1.4512807130813599, -1.9023380279541016, -1.7846438884735107, -1.7588181495666504, -2.2237377166748047, -0.24523353576660156, -3.161891460418701, -1.0695743560791016, -1.9536073207855225, -1.5102357864379883, -2.3298168182373047, -2.452110767364502, -0.8466482162475586, -1.9005460739135742, 0.3032236099243164, -2.546548843383789, -2.6635913848876953, -2.097865104675293, -2.259410858154297, -1.7786246538162231, -1.4039421081542969, 0.5563278198242188, -0.7412509918212891, -1.3965559005737305, -1.3892765045166016, -0.5272130966186523, -7.652175426483154, -0.35168027877807617, -0.08506393432617188, -10.27627182006836, -0.49257326126098633, -0.49206024408340454, -1.0410842895507812, -2.1744236946105957, 1.1628875732421875, -11.583396911621094, 0.16269779205322266, -1.0834884643554688, -3.3831841945648193, -2.078197479248047, -3.3287220001220703, -2.0512123107910156, -1.267256736755371, -2.2412095069885254, -1.9121003150939941, -0.9781627655029297, -1.4069452285766602, -2.2819442749023438, -2.250149965286255, -1.1689424514770508, -0.2802295684814453, -0.8069067001342773, -2.2473888397216797, -0.5812034606933594, 1.1778535842895508, 0.6973228454589844, -0.38828563690185547, -1.6653003692626953, -1.3838896751403809, -1.8397130966186523, -0.44087886810302734, -2.100998878479004, 14.471397399902344, -1.0475921630859375, -1.0334339141845703, -1.3885574340820312, -1.8640618324279785, -1.7232398986816406, -2.9488420486450195], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 126960, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 126960, "last_target_update_ts": 34816, "num_target_updates": 67}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -191.50952316120268, "episode_len_mean": 309.56, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477], "episode_lengths": [248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5253050666837429, "mean_inference_ms": 23.24738671953586, "mean_action_processing_ms": 0.14034502654021577, "mean_env_wait_ms": 4.209373269587309, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -191.50952316120268, "episode_len_mean": 309.56, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-55.67789724469185, -79.03499457985163, -90.51762688905, -72.72229658067226, -68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477], "episode_lengths": [248, 261, 270, 262, 258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5253050666837429, "mean_inference_ms": 23.24738671953586, "mean_action_processing_ms": 0.14034502654021577, "mean_env_wait_ms": 4.209373269587309, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 126960, "num_env_steps_sampled": 34816, "num_env_steps_trained": 126960, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 34816, "agent_timesteps_total": 34816, "timers": {"training_iteration_time_ms": 317.056, "learn_time_ms": 74.771, "learn_throughput": 3209.797, "synch_weights_time_ms": 19.989}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 126960, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 126960, "last_target_update_ts": 34816, "num_target_updates": 67}, "done": false, "episodes_total": 107, "training_iteration": 34, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-20-39", "timestamp": 1655500839, "time_this_iter_s": 5.045660018920898, "time_total_s": 177.7334394454956, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 177.7334394454956, "timesteps_since_restore": 0, "iterations_since_restore": 34, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 31.0375, "ram_util_percent": 63.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -10.377716064453125, "min_q": -48.78005599975586, "max_q": 25.885787963867188, "mean_td_error": -0.8270110487937927}, "td_error": [0.37731194496154785, -0.8269214630126953, -0.9497604370117188, 1.2168445587158203, -0.5126991271972656, -0.41074705123901367, -0.6913261413574219, -1.4751205444335938, -0.7690696716308594, -0.9154367446899414, 0.5063552856445312, -1.2534303665161133, -0.2168436050415039, 0.6355924606323242, -6.4021897315979, -0.6909408569335938, 0.02203845977783203, -0.4129619598388672, -1.0196784734725952, -0.220947265625, -1.1697673797607422, -0.7903556823730469, 3.5655975341796875, 0.5098881721496582, -0.26151466369628906, -1.572535514831543, -1.8006315231323242, -0.24385929107666016, -1.5650100708007812, -0.3084077835083008, 0.0244293212890625, -0.517852783203125, 0.8618183135986328, -1.9071733951568604, 0.4940643310546875, -0.059632301330566406, -1.649698257446289, -0.8671424388885498, -0.9765325784683228, -2.820554256439209, -0.10132193565368652, -1.1527754068374634, 0.4098052978515625, 0.10975980758666992, -2.0110855102539062, 0.00344085693359375, -0.5294570922851562, -1.1341133117675781, 0.30758047103881836, -1.1073665618896484, -1.0276594161987305, -0.5886945724487305, -0.9702873229980469, -0.3912086486816406, -1.3343830108642578, -0.7532997131347656, -1.0983123779296875, -4.753364562988281, -5.744863510131836, -2.6362476348876953, 1.0097187757492065, -5.356653213500977, -0.5879323482513428, 1.8990938663482666, 0.48241233825683594, -1.4299697875976562, -0.569244384765625, -1.8375163078308105, -0.8295879364013672, 0.6233377456665039, 1.267578125, -0.610870361328125, -2.776630401611328, -1.3549461364746094, -0.06058835983276367, -0.7761473655700684, -0.8983535766601562, 0.25537109375, -1.584003210067749, -0.9270057678222656, -0.6819133758544922, -1.2482528686523438, -1.1277847290039062, 0.5560436248779297, 0.859525203704834, 0.3533973693847656, -0.6350760459899902, -0.700894832611084, 0.4665203094482422, 0.11532163619995117, -2.5141983032226562, 0.3519667387008667, -0.15352630615234375, -1.5296440124511719, -0.5701823234558105, -0.18752288818359375, -1.7254714965820312, 0.16571426391601562, -1.1749417781829834, -9.617382049560547, -5.009264945983887, 0.04100179672241211, -1.3499393463134766, -0.6356182098388672, -0.5765018463134766, 1.2519340515136719, 0.2777843475341797, -0.2967338562011719, 0.6028347015380859, -2.0367558002471924, 0.48437929153442383, -2.151217460632324, -1.2680168151855469, -1.1523888111114502, -0.7448348999023438, 0.7610511779785156, 0.43881988525390625, -2.366823673248291, -0.22982943058013916, -2.0242767333984375, -1.227799415588379, -0.9969520568847656, -0.2482997477054596, -1.2157385349273682, -0.4963645935058594, -8.164019584655762, -0.9558379650115967, 1.1915574073791504, -2.3049259185791016, -1.768967866897583, -0.9587516784667969, -0.48141026496887207, -0.006876230239868164, 0.18205547332763672, -0.8214101791381836, -6.711824417114258, -1.727874755859375, -0.13836097717285156, 0.2794981002807617, 1.353226661682129, 1.4831714630126953, 0.009675979614257812, 1.0149612426757812, -1.3119697570800781, -1.8459739685058594, -2.6060755252838135, 0.3102402687072754, 0.70977783203125, -1.1494808197021484, -0.295135498046875, -1.1610946655273438, -1.674770712852478, 0.0244293212890625, 0.4971790313720703, -1.967874526977539, 0.879490852355957, -0.6133813858032227, -0.827545166015625, 0.5594902038574219, -1.5844783782958984, -0.3571195602416992, -1.4995012283325195, 4.622011184692383, 0.036434173583984375, 0.2349853515625, -0.7448348999023438, -0.7516164779663086, -3.6832284927368164, 0.1148233413696289, 0.2420039176940918, -0.7160062789916992, 0.8108110427856445, 0.6182568073272705, -0.3688206672668457, -5.803567886352539, -0.8658595085144043, -0.45462650060653687, -1.1728534698486328, -0.3784008026123047, -0.09718799591064453, -0.5674426555633545, -1.09375, 0.1026296615600586, -1.3322343826293945, 0.06061363220214844, -0.40329551696777344, -1.3201005458831787, 0.1891765594482422, -0.36957740783691406, -1.641408920288086, -2.990096092224121, -5.779975891113281, -0.9068622589111328, -0.6677217483520508, 0.8580608367919922, 0.5079193115234375, -1.9494540691375732, -1.9149627685546875, -0.5549230575561523, 0.28476905822753906, -0.02231311798095703, -3.1477928161621094, -1.8076896667480469, -1.0276594161987305, -0.4904441833496094, -2.858410120010376, 0.5063552856445312, -0.9892463684082031, -1.5259733200073242, 0.1816420555114746, -1.3748654127120972, -0.8814258575439453, -0.9152660369873047, 0.1406559944152832, -7.007415771484375, -1.2933120727539062, -0.7513754367828369, 0.09413766860961914, -0.44641590118408203, -0.2817420959472656, 1.6083335876464844, -0.046357154846191406, -1.620182991027832, -1.6062535047531128, 0.1999826431274414, 1.5100538730621338, -0.4963645935058594, 0.5676150321960449, -0.8790647983551025, -0.657806396484375, -2.9335155487060547, -2.425588607788086, -1.3957290649414062, 0.7160701751708984, -5.997501373291016, -0.1885356903076172, 1.3123893737792969, 0.25537109375, 0.18804645538330078, 0.38959503173828125], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 130800, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 130800, "last_target_update_ts": 35840, "num_target_updates": 69}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -189.16311358809472, "episode_len_mean": 308.77, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141], "episode_lengths": [258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5233360220815281, "mean_inference_ms": 23.30123509867274, "mean_action_processing_ms": 0.1408332307688536, "mean_env_wait_ms": 4.189998693036122, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -189.16311358809472, "episode_len_mean": 308.77, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-68.59655977785587, -90.5466294363141, -142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141], "episode_lengths": [258, 276, 269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5233360220815281, "mean_inference_ms": 23.30123509867274, "mean_action_processing_ms": 0.1408332307688536, "mean_env_wait_ms": 4.189998693036122, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 130800, "num_env_steps_sampled": 35840, "num_env_steps_trained": 130800, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 35840, "agent_timesteps_total": 35840, "timers": {"training_iteration_time_ms": 356.562, "learn_time_ms": 75.293, "learn_throughput": 3187.526, "synch_weights_time_ms": 20.096}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 130800, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 130800, "last_target_update_ts": 35840, "num_target_updates": 69}, "done": false, "episodes_total": 111, "training_iteration": 35, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-20-44", "timestamp": 1655500844, "time_this_iter_s": 5.487442493438721, "time_total_s": 183.22088193893433, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 183.22088193893433, "timesteps_since_restore": 0, "iterations_since_restore": 35, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.3, "ram_util_percent": 63.82857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.740059852600098, "min_q": -48.82282638549805, "max_q": 24.18631935119629, "mean_td_error": -4.985498905181885}, "td_error": [0.26094865798950195, -1.9076366424560547, -0.4169178009033203, -4.4378204345703125, -998.093505859375, -0.8732711672782898, 0.013155579566955566, 0.9242234230041504, -0.14944934844970703, -0.010129928588867188, -0.6592063903808594, 0.10147285461425781, -0.3363685607910156, -0.3379322290420532, 0.41499805450439453, -1.6658172607421875, -0.2811150550842285, -0.16727256774902344, -2.4151763916015625, -10.30151653289795, -1.2430286407470703, 1.0842552185058594, -1.7652759552001953, 0.3960762023925781, -1.4538209438323975, -1.1623554229736328, -0.9102506637573242, 0.9315576553344727, 1.0073184967041016, -1.4857044219970703, 1.4721853733062744, 0.2492656707763672, 0.4451766014099121, -2.1798858642578125, -0.6421051025390625, -0.4077787399291992, -0.7892858982086182, 0.2542780637741089, 2.5520153045654297, -0.8909540176391602, -0.4394264221191406, 0.13446998596191406, -0.7250428199768066, 0.2270958423614502, -0.28682804107666016, 0.21319198608398438, 1.3968334197998047, 0.23843955993652344, -2.1921963691711426, 0.8834686279296875, -1.3782823085784912, -0.7548866271972656, -0.2661252021789551, -0.8446989059448242, -0.9891300201416016, -1.7451090812683105, -1.2316741943359375, 0.10017776489257812, -2.0957980155944824, -1.4546546936035156, -1.4007062911987305, -0.08896636962890625, 1.1923646926879883, 0.34569859504699707, -0.22554779052734375, -2.1092376708984375, 0.07432436943054199, -0.608123779296875, -2.2837295532226562, -0.16754364967346191, -0.3106651306152344, 0.5256938934326172, -6.550559043884277, 0.9971599578857422, -1.7228450775146484, 0.7340736389160156, 2.350008964538574, 2.38006591796875, -0.42401742935180664, -0.23776626586914062, -0.3428497314453125, -0.377532958984375, -1.818277359008789, 0.8854150772094727, -1.554987907409668, 1.1423072814941406, -5.910304069519043, -5.518645286560059, -1.9171276092529297, -0.3193798065185547, 1.9139213562011719, -0.5771293640136719, -3.6504015922546387, -0.5129175186157227, -0.5473957061767578, -7.755903244018555, -1.0347061157226562, -1.1974554061889648, -1.5469465255737305, -0.7155380249023438, -7.419153213500977, 1.023167610168457, -1.0427393913269043, -4.538969993591309, -0.48699951171875, -0.7228536605834961, -1.404423713684082, -0.7864837646484375, -0.13820314407348633, 3.945402145385742, 0.8929128646850586, -1.2234725952148438, 0.36331892013549805, -2.330162286758423, -0.4086799621582031, -1.9518499374389648, -0.1472787857055664, 0.6620705127716064, -0.5172748565673828, -0.7117376327514648, -0.6151237487792969, -0.9648923873901367, -0.2549552917480469, -0.9745254516601562, 0.3682544231414795, -1.3367061614990234, -1.043198585510254, 0.20223426818847656, -0.22892653942108154, 0.03038787841796875, -11.57581901550293, 1.228053092956543, -0.9639620780944824, -0.20328330993652344, -1.5497970581054688, 2.750731945037842, 0.41499805450439453, -0.7621192932128906, -1.1276130676269531, 0.7403392791748047, 0.9039173126220703, 0.39708590507507324, -0.7535161972045898, -1.923868179321289, 0.292205810546875, -0.6365046501159668, -0.8932819366455078, -6.777314186096191, 0.5465106964111328, -3.855635643005371, -1.4558911323547363, -0.6274144649505615, -0.5788288116455078, -1.7846107482910156, -1.921356201171875, -2.8427133560180664, 1.6827430725097656, -3.259763717651367, -5.813047409057617, -0.4394264221191406, 1.3242006301879883, 0.38570913672447205, -1.4699811935424805, -1.1674587726593018, -1.122182846069336, 0.5669841766357422, 4.904676914215088, -1.3204214572906494, 0.023973941802978516, -2.3354811668395996, 0.20781898498535156, -5.887749195098877, -1.0799808502197266, -3.2936840057373047, -1.307145118713379, -4.242667198181152, -0.1256256103515625, 0.5575313568115234, 0.3778243064880371, -2.605215072631836, -0.3134307861328125, -0.8947582244873047, 0.05675077438354492, 0.019213438034057617, -1.732771873474121, -0.3051471710205078, 11.524518966674805, -1.8432426452636719, -11.435808181762695, -1.0221500396728516, -0.9175319671630859, -2.9598655700683594, -0.5593633651733398, -0.2896766662597656, -7.070716857910156, 0.3673248291015625, 0.6384735107421875, 0.9281823635101318, -0.7425155639648438, 0.27273011207580566, -1.0440139770507812, -0.8427174091339111, -2.3647689819335938, -1.4808349609375, 0.1553950309753418, 0.5011446475982666, 1.205446481704712, 1.8135676383972168, 0.22594547271728516, -1.2744479179382324, -1.5497970581054688, -8.373575210571289, 0.17142486572265625, 0.1845245361328125, -8.896099090576172, 0.1988391876220703, 2.031078338623047, -0.5874214172363281, -0.9798202514648438, 1.812145471572876, -0.9630470275878906, -1.2418127059936523, -0.9983682632446289, 0.804173469543457, 1.1774224042892456, -0.8374686241149902, 0.1842813491821289, -0.27108001708984375, 0.11696517467498779, -1.6587634086608887, 1.0100879669189453, -0.2664194107055664, -1.494049072265625, -1.212693214416504, -1.1649951934814453, 1.205446481704712, 1.2558393478393555, 0.2958080768585205, -2.4424076080322266, 0.48717784881591797], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 134640, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 134640, "last_target_update_ts": 36864, "num_target_updates": 71}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -190.94219625003635, "episode_len_mean": 309.47, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036], "episode_lengths": [269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.523427880398208, "mean_inference_ms": 23.323029293590324, "mean_action_processing_ms": 0.1407618447265672, "mean_env_wait_ms": 4.177079074578824, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -190.94219625003635, "episode_len_mean": 309.47, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142.16105076670647, -70.29445978999138, -95.59342412650585, -192.5310805439949, -174.3729988411069, -197.89955069869757, -223.09377865493298, -193.69536247849464, -221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036], "episode_lengths": [269, 268, 259, 320, 316, 313, 341, 295, 310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.523427880398208, "mean_inference_ms": 23.323029293590324, "mean_action_processing_ms": 0.1407618447265672, "mean_env_wait_ms": 4.177079074578824, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 134640, "num_env_steps_sampled": 36864, "num_env_steps_trained": 134640, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 36864, "agent_timesteps_total": 36864, "timers": {"training_iteration_time_ms": 365.86, "learn_time_ms": 76.874, "learn_throughput": 3121.982, "synch_weights_time_ms": 19.812}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 134640, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 134640, "last_target_update_ts": 36864, "num_target_updates": 71}, "done": false, "episodes_total": 113, "training_iteration": 36, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-20-50", "timestamp": 1655500850, "time_this_iter_s": 5.800769567489624, "time_total_s": 189.02165150642395, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 189.02165150642395, "timesteps_since_restore": 0, "iterations_since_restore": 36, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.177777777777777, "ram_util_percent": 63.91111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.51607894897461, "min_q": -49.76700973510742, "max_q": 26.65863800048828, "mean_td_error": -0.8352708220481873}, "td_error": [1.0706758499145508, 1.0049614906311035, 1.406524658203125, 0.8303403854370117, -2.332465171813965, 1.8120651245117188, -0.8447055816650391, -18.270322799682617, -1.2691497802734375, 0.3983879089355469, -0.002945423126220703, -0.0894927978515625, -0.41709327697753906, 0.016338825225830078, 0.5134773254394531, 1.1258983612060547, -0.0887289047241211, 4.411368370056152, -0.8097610473632812, -0.8168182373046875, -0.5231790542602539, -1.418294906616211, -0.07096481323242188, -1.3940563201904297, -7.9369916915893555, 0.7979755401611328, 0.5277366638183594, -0.7708542346954346, 1.0490570068359375, -0.2154790163040161, -6.866382598876953, 0.7335314750671387, -0.1360454559326172, -2.491140365600586, -4.466727256774902, 0.8691883087158203, 0.9562721252441406, -6.198157787322998, 0.8581686019897461, -0.5805344581604004, 0.2957725524902344, -0.20805561542510986, 0.9532895088195801, 0.21929264068603516, 1.0824246406555176, -0.3266162872314453, -2.053126335144043, -0.8378868103027344, -4.9203386306762695, -0.032291412353515625, -0.39461326599121094, -0.6144982576370239, -0.3823871612548828, -1.232980728149414, -0.45626163482666016, -0.7287313938140869, 1.2039384841918945, 0.5859184265136719, 0.22240591049194336, -0.14705276489257812, -0.0887289047241211, -1.1008515357971191, -0.7026815414428711, -0.4951000213623047, -0.11527252197265625, -0.6913152933120728, -0.23106956481933594, 0.23125191032886505, -1.6590867042541504, 0.3409442901611328, -1.5669479370117188, 0.6179394721984863, -0.725128173828125, -9.90629768371582, -2.2184743881225586, 0.4462871551513672, -0.016020774841308594, 1.2939376831054688, 1.7915740013122559, 1.0160493850708008, 0.3556709289550781, 0.29006195068359375, -32.7316780090332, 2.115184783935547, -3.4011125564575195, -0.4596443176269531, -0.08444499969482422, -0.28790950775146484, -5.717254638671875, -2.735088348388672, 0.6068077087402344, 1.529367208480835, 0.37751340866088867, -0.5188694000244141, -3.86806583404541, -1.7135887145996094, 0.6063108444213867, -1.0319818258285522, 0.6958789825439453, -0.39650464057922363, 0.09449958801269531, 0.9117412567138672, 0.9287052154541016, 0.2134256362915039, -0.2078399658203125, -1.5390770435333252, -0.09964656829833984, -1.6333837509155273, -1.4650983810424805, -0.7933588027954102, 1.3897132873535156, -2.485844612121582, 0.06984186172485352, -1.5278520584106445, -6.756296634674072, 1.2045936584472656, -6.502257823944092, -1.1446809768676758, -0.2278900146484375, -1.6970643997192383, 2.1757235527038574, -0.09087371826171875, 1.6101722717285156, 0.8733005523681641, -0.18352651596069336, -0.5886192321777344, -0.5784404277801514, -2.1500415802001953, 2.115184783935547, -0.4359252452850342, 1.3782691955566406, -0.2660951614379883, -0.536433219909668, -1.4338607788085938, -1.3699266910552979, -1.241842269897461, -3.429605484008789, -2.2777976989746094, 0.7101302146911621, -2.103120803833008, -1.0123348236083984, 0.8267555236816406, -0.09809017181396484, 0.7101302146911621, -0.6839179992675781, 0.7714424133300781, -2.3591742515563965, -4.260964870452881, 1.9682629108428955, 2.7672014236450195, 0.8837623596191406, -12.144115447998047, -0.05046653747558594, -0.7397587299346924, -6.857522010803223, -1.3059892654418945, -0.43500280380249023, 0.7673740386962891, -8.102176666259766, -2.397860527038574, -1.1315603256225586, 0.18200159072875977, -1.6065001487731934, 0.7913093566894531, 0.943763017654419, 1.5017595291137695, -1.9269819259643555, 0.18079900741577148, 0.87872314453125, -0.8659934997558594, 0.8493251800537109, -2.1877946853637695, 0.2113037109375, -2.0311880111694336, 0.8079910278320312, -1.7153759002685547, -1.7148205041885376, 0.03575944900512695, 1.4607391357421875, -0.16831612586975098, -1.5256726741790771, -0.4614138603210449, -1.2704486846923828, -0.8192033767700195, 0.63323974609375, 0.8588275909423828, 0.514002799987793, 2.0747737884521484, -5.315523147583008, -0.2278900146484375, -1.1879830360412598, 0.5330982208251953, 1.103353500366211, 0.22391128540039062, -0.21757888793945312, 0.8588275909423828, -1.36248779296875, -0.5063977241516113, -0.4878091812133789, 1.1462745666503906, 2.3630237579345703, 1.2692465782165527, -1.1147565841674805, -0.5485210418701172, 0.4091777801513672, -2.566577911376953, 0.1261274814605713, -0.18644142150878906, -0.4150700569152832, -1.6731610298156738, -0.6272258758544922, 0.5241203308105469, -0.22031211853027344, -1.6679458618164062, 0.018157958984375, -1.859644889831543, -1.4701998233795166, 1.55419921875, -10.715595245361328, 1.1783809661865234, -0.5808939933776855, -0.5904712677001953, -3.2061986923217773, 1.0220317840576172, -1.114192008972168, -0.05899524688720703, 0.4217071533203125, -0.15782642364501953, -13.420146942138672, -1.1178474426269531, -0.38760948181152344, 0.9283771514892578, -1.0923984050750732, 1.6524734497070312, -0.6115169525146484, 1.0577335357666016, -0.052886009216308594, -0.47402143478393555, -0.06564712524414062, 12.33951473236084], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 138480, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 138480, "last_target_update_ts": 37888, "num_target_updates": 73}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -182.9782485269755, "episode_len_mean": 305.99, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374], "episode_lengths": [310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.523307066031916, "mean_inference_ms": 23.44965602259119, "mean_action_processing_ms": 0.14019937024197474, "mean_env_wait_ms": 4.14727032608142, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -182.9782485269755, "episode_len_mean": 305.99, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-221.20126012712717, -305.9759941101074, -252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374], "episode_lengths": [310, 372, 339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.523307066031916, "mean_inference_ms": 23.44965602259119, "mean_action_processing_ms": 0.14019937024197474, "mean_env_wait_ms": 4.14727032608142, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 138480, "num_env_steps_sampled": 37888, "num_env_steps_trained": 138480, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 37888, "agent_timesteps_total": 37888, "timers": {"training_iteration_time_ms": 346.924, "learn_time_ms": 77.711, "learn_throughput": 3088.376, "synch_weights_time_ms": 20.487}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 138480, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 138480, "last_target_update_ts": 37888, "num_target_updates": 73}, "done": false, "episodes_total": 121, "training_iteration": 37, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-20-56", "timestamp": 1655500856, "time_this_iter_s": 5.690710783004761, "time_total_s": 194.7123622894287, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 194.7123622894287, "timesteps_since_restore": 0, "iterations_since_restore": 37, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.575000000000003, "ram_util_percent": 64.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.22512435913086, "min_q": -51.87665557861328, "max_q": 25.477018356323242, "mean_td_error": -0.4408365786075592}, "td_error": [1.1324386596679688, 2.1761715412139893, 0.20866680145263672, -0.20244932174682617, -0.39851951599121094, 0.2290210723876953, 0.848114013671875, -0.8610477447509766, -0.4642930030822754, 0.8223018646240234, -0.14553451538085938, -1.3109502792358398, -7.6151933670043945, -1.6380729675292969, 0.9320716857910156, -0.3847346305847168, -6.622705936431885, -5.387016296386719, -0.6930912137031555, -2.0116844177246094, 0.7164306640625, 1.4870702028274536, 5.239956855773926, 1.0329017639160156, 0.48375749588012695, 0.4316902160644531, -0.6280784606933594, 0.32233119010925293, 0.40917491912841797, -0.5164012908935547, 0.4755403995513916, 0.7318363189697266, -2.5945816040039062, 0.24989891052246094, 0.5349979400634766, 1.5056591033935547, -0.1381521224975586, -1.7212104797363281, 1.6675777435302734, 1.8206253051757812, -0.5325058698654175, -0.2450324296951294, 0.4912099838256836, -2.170280933380127, 0.3313274383544922, -1.6707522869110107, 0.4235086441040039, 1.4399662017822266, 0.1599717140197754, -0.7651729583740234, -0.9111387729644775, -0.38193511962890625, 0.6224498748779297, -0.6585712432861328, -0.7868995666503906, 1.6508917808532715, -0.2938346862792969, -0.38891124725341797, -2.2373886108398438, -0.4257926940917969, 0.7409820556640625, 0.8987827301025391, 1.914276123046875, -0.12182784080505371, 0.9814825057983398, 0.28827476501464844, -0.715571403503418, -0.13253021240234375, 0.31876039505004883, -7.89268159866333, 0.8669757843017578, 0.8413982391357422, -4.125408172607422, -1.3400468826293945, -1.0607433319091797, 0.5786762237548828, 0.848114013671875, 0.020000934600830078, -0.16830205917358398, 1.553314208984375, -1.9762511253356934, 0.07633018493652344, -0.6186819076538086, 1.0697860717773438, -0.3915548324584961, 0.03940582275390625, 0.9878787994384766, -8.00954818725586, -0.5229377746582031, -5.262274742126465, 0.287322998046875, 0.019400596618652344, 0.7379417419433594, -0.4218294620513916, 0.27963829040527344, -3.011960983276367, -0.23248863220214844, 0.7219123840332031, -1.4844188690185547, -2.7898707389831543, 0.6507415771484375, -6.6664652824401855, -1.5228538513183594, 0.6230459213256836, 0.6647171974182129, -5.586234092712402, -1.9671030044555664, 1.2164028882980347, 0.8173904418945312, 19.875761032104492, -0.2642059326171875, 0.9960231781005859, 0.6463508605957031, 0.8099632263183594, 0.7228832244873047, 5.900587558746338, -2.0717763900756836, 0.1731419563293457, -6.688064098358154, 0.32581424713134766, 0.24256157875061035, 0.5768871307373047, 0.09045982360839844, -6.416830062866211, 1.1698837280273438, 0.06503486633300781, -0.4587974548339844, -0.18373489379882812, 1.5335636138916016, -0.11603641510009766, -1.3292697668075562, 0.1466236114501953, 0.8410911560058594, -2.1721630096435547, 1.0863122940063477, -1.497014045715332, -0.1969994306564331, -4.5983686447143555, -8.027260780334473, -3.0437164306640625, 0.9413280487060547, -1.1064975261688232, 0.5803384780883789, 0.2342967987060547, 0.1466236114501953, 0.6441912651062012, 2.1405606269836426, 0.6548099517822266, 0.13034915924072266, -2.831470489501953, 0.7227134704589844, 2.1243648529052734, -1.9190607070922852, 1.4657347202301025, 0.9513721466064453, 1.0571885108947754, 0.011743545532226562, 0.9609174728393555, -0.40578746795654297, 0.29907703399658203, -0.6362733840942383, 0.5164871215820312, -1.2775001525878906, -1.3793449401855469, 1.153717041015625, 0.11066079139709473, -0.7856273651123047, 0.4784526824951172, 6.521629810333252, 0.646327018737793, -5.839651107788086, 1.4276232719421387, 0.041965484619140625, -2.3808491230010986, -1.4447746276855469, 0.3807840347290039, 0.33508825302124023, -0.8889772891998291, -1.2270793914794922, 0.9471635818481445, -11.93932056427002, -0.5131614208221436, -1.1106605529785156, -0.7094755172729492, -1.409773349761963, 1.1332511901855469, -7.764142990112305, 0.9803361892700195, -0.11232185363769531, 0.68581223487854, 0.9286670684814453, -3.222799301147461, -0.06938552856445312, -0.6977767944335938, 1.2560052871704102, 0.4457435607910156, -2.3410539627075195, 0.6360273361206055, -0.007433891296386719, 1.776191234588623, 0.772606372833252, -1.2191143035888672, -1.730360984802246, 0.36945533752441406, 0.09937477111816406, -0.8316724300384521, -10.930530548095703, -0.5118331909179688, 0.767911434173584, 3.6447277069091797, 1.5180110931396484, 0.2787208557128906, -5.955023765563965, -0.04536247253417969, -0.13724708557128906, 0.26450347900390625, 0.9867551326751709, -6.910952568054199, 0.04100227355957031, 1.931417465209961, 0.9320716857910156, 0.20699429512023926, 0.5164909362792969, 0.7385387420654297, 0.23237037658691406, 0.22228050231933594, 0.7513628005981445, -3.65925931930542, 1.153717041015625, -0.5435323715209961, -0.5643196105957031, -1.9173834323883057, 0.6165790557861328, 0.6833653450012207, -1.6487789154052734, 1.7695825099945068, -1.193680763244629, -1.2122890949249268, -0.32211875915527344, -10.348214149475098], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 142320, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 142320, "last_target_update_ts": 38912, "num_target_updates": 75}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -183.0196901769191, "episode_len_mean": 305.84, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505], "episode_lengths": [339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5229280265444882, "mean_inference_ms": 23.48898614679334, "mean_action_processing_ms": 0.14037176754763445, "mean_env_wait_ms": 4.14412593584692, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -183.0196901769191, "episode_len_mean": 305.84, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-252.4876751601696, -282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505], "episode_lengths": [339, 364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5229280265444882, "mean_inference_ms": 23.48898614679334, "mean_action_processing_ms": 0.14037176754763445, "mean_env_wait_ms": 4.14412593584692, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 142320, "num_env_steps_sampled": 38912, "num_env_steps_trained": 142320, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 38912, "agent_timesteps_total": 38912, "timers": {"training_iteration_time_ms": 337.649, "learn_time_ms": 77.679, "learn_throughput": 3089.645, "synch_weights_time_ms": 20.489}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 142320, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 142320, "last_target_update_ts": 38912, "num_target_updates": 75}, "done": false, "episodes_total": 123, "training_iteration": 38, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-21-02", "timestamp": 1655500862, "time_this_iter_s": 5.661405563354492, "time_total_s": 200.3737678527832, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 200.3737678527832, "timesteps_since_restore": 0, "iterations_since_restore": 38, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.875, "ram_util_percent": 64.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.138692855834961, "min_q": -52.5469856262207, "max_q": 29.457706451416016, "mean_td_error": -5.6258625984191895}, "td_error": [-0.39424747228622437, -0.25391578674316406, -2.1881351470947266, -0.7994298934936523, 0.5658912658691406, -0.19232940673828125, -0.30292797088623047, 0.8260993957519531, -0.16917133331298828, -0.2188100814819336, 9.559074401855469, -0.7095789313316345, -1.787745475769043, 1.5135993957519531, -0.0541229248046875, -1.1614813804626465, -3.67781925201416, -2.475229263305664, -1.2401466369628906, -0.6653366088867188, -0.7192425727844238, -0.8351716995239258, -0.4022998809814453, -0.9357662200927734, -0.3283700942993164, 0.1538017988204956, -10.298698425292969, 0.1528075933456421, -4.936779975891113, 0.33948326110839844, 0.45301342010498047, -8.778388977050781, -0.3621482849121094, 1.042790412902832, -0.10732269287109375, -0.9964659214019775, -1.8215725421905518, -0.9148597717285156, 0.5400028228759766, -0.7374968528747559, -0.6525259017944336, 0.7449855804443359, -1.0886287689208984, -0.19223976135253906, -0.8718805313110352, -0.90191650390625, 0.038883209228515625, -6.07124137878418, -0.6402072906494141, 0.9818038940429688, -0.2479381561279297, -0.2291727066040039, -0.5128850936889648, -0.9687652587890625, -1.4294548034667969, -1.108576774597168, -2.5184669494628906, -0.8832838535308838, -0.0010063648223876953, -0.12275886535644531, -0.28026556968688965, 0.08501815795898438, -1.654693603515625, -1.1898384094238281, -1.1100215911865234, -0.6318564414978027, -2.435903549194336, -0.3368237018585205, 0.26948070526123047, -2.3493499755859375, -0.7832419872283936, -2.0794315338134766, -1.920541763305664, -1.1090917587280273, -1.5421552658081055, -2.869032382965088, -2.9066267013549805, 0.7567195892333984, 0.6856751441955566, -0.8864994049072266, -2.7937164306640625, -1.1675128936767578, -0.8506455421447754, -0.2793283462524414, -3.1693177223205566, -1.1173901557922363, -1.7475957870483398, -1.3677085638046265, -2.0363731384277344, -2.1703453063964844, 0.07648658752441406, -0.17333221435546875, -1.698777198791504, -0.19921398162841797, -2.617380142211914, -0.32573699951171875, -1.6194343566894531, -1.7392308712005615, 0.025745868682861328, -0.5506095886230469, -1.8212562799453735, -0.9524908065795898, -2.7736432552337646, -0.3794708251953125, 0.44301748275756836, -1.4481792449951172, 0.027856826782226562, -0.3988819122314453, -0.7052268981933594, -1.2232112884521484, 1.0592350959777832, -6.423006057739258, 0.21850967407226562, 0.5709948539733887, -1.3000812530517578, -0.328704833984375, -0.34264564514160156, 3.902374267578125, -9.293083190917969, -1.672675609588623, -3.583103895187378, 1.2267370223999023, -1.3710002899169922, -10.651338577270508, -0.30106210708618164, -4.020215034484863, -0.7298245429992676, -13.105582237243652, -0.7493114471435547, -0.348516047000885, -0.30292797088623047, 6.805517673492432, -1.2854652404785156, -1.1354433298110962, -0.22991323471069336, 0.8336520195007324, -1.4668521881103516, -1.5171966552734375, -6.803250312805176, 0.1958465576171875, 0.29848670959472656, -0.13104820251464844, -1.0698356628417969, -8.570672988891602, -3.8812503814697266, 0.8956451416015625, 0.13346338272094727, -8.195802688598633, -0.3833179473876953, -4.598719120025635, -0.8732213973999023, -1.5989688634872437, -4.221413612365723, -2.3779706954956055, -8.114442825317383, 0.17688274383544922, -999.9454345703125, -0.3805408477783203, -1.317331314086914, 0.16626548767089844, -2.165872573852539, -0.8810524940490723, -0.3876495361328125, -1.448117733001709, -3.566102981567383, 2.1727895736694336, -1.6071052551269531, 0.5658912658691406, -1.08917236328125, -2.1243515014648438, -1.9575109481811523, -0.5055065155029297, -9.034771919250488, -0.4100303649902344, -1.5343999862670898, -0.7075119018554688, -0.11923408508300781, 0.44795000553131104, -5.169406890869141, -0.7483673095703125, -2.1686859130859375, -2.1855406761169434, -2.0429792404174805, -0.8064374923706055, -0.9893712997436523, 2.3834896087646484, 0.3504343032836914, -0.3134646415710449, -9.173957824707031, 0.7711136341094971, 0.6450271606445312, -2.0527725219726562, -2.348055839538574, -1.6352591514587402, -5.272254467010498, 0.0020112991333007812, -0.2788534164428711, -13.928871154785156, -2.1831836700439453, -3.4130101203918457, -0.30106210708618164, -1.6374282836914062, -2.4471235275268555, -0.3423595428466797, -1.389932632446289, -1.3116207122802734, 0.12030506134033203, 0.304379940032959, -1.9169912338256836, -8.439558029174805, -2.3480796813964844, -0.5339136123657227, -2.722757339477539, -0.9020957946777344, -1.8808784484863281, -0.8145160675048828, -0.5015363693237305, -2.509341239929199, -2.2069931030273438, -0.8949236869812012, -1.5799636840820312, -8.616214752197266, -0.5708103179931641, 0.6296901702880859, -2.307802200317383, -1.838953971862793, 0.883209228515625, 1.6241931915283203, 0.046973228454589844, -7.265895843505859, -7.738815784454346, 0.5459136962890625, -0.08504962921142578, -1.0432929992675781, -0.1610889434814453, -0.8867864608764648, -1.5194664001464844, -1.24176025390625, -6.105799674987793, -2.2160491943359375], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 146160, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 146160, "last_target_update_ts": 39936, "num_target_updates": 77}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -180.39881342425943, "episode_len_mean": 304.74, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244], "episode_lengths": [364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5228074642837924, "mean_inference_ms": 23.49724981810034, "mean_action_processing_ms": 0.14005606785840274, "mean_env_wait_ms": 4.142868983989717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -180.39881342425943, "episode_len_mean": 304.74, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-282.59198312461376, -288.95153803378344, -275.9021665304899, -216.97507874667645, -336.33778443932533, -216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244], "episode_lengths": [364, 357, 370, 327, 364, 336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5228074642837924, "mean_inference_ms": 23.49724981810034, "mean_action_processing_ms": 0.14005606785840274, "mean_env_wait_ms": 4.142868983989717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 146160, "num_env_steps_sampled": 39936, "num_env_steps_trained": 146160, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 39936, "agent_timesteps_total": 39936, "timers": {"training_iteration_time_ms": 339.973, "learn_time_ms": 76.8, "learn_throughput": 3124.989, "synch_weights_time_ms": 20.189}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 146160, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 146160, "last_target_update_ts": 39936, "num_target_updates": 77}, "done": false, "episodes_total": 124, "training_iteration": 39, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-21-08", "timestamp": 1655500868, "time_this_iter_s": 5.520493507385254, "time_total_s": 205.89426136016846, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 205.89426136016846, "timesteps_since_restore": 0, "iterations_since_restore": 39, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.725, "ram_util_percent": 64.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.380141258239746, "min_q": -49.25657272338867, "max_q": 32.50552749633789, "mean_td_error": -0.6602700352668762}, "td_error": [-4.261688232421875, 0.1630086898803711, 1.0820331573486328, -2.9566268920898438, 0.40747547149658203, -4.428291320800781, 0.3365030288696289, -0.21128463745117188, 0.932227611541748, 0.5290045738220215, 0.8788642883300781, 0.06017431616783142, 0.9364496469497681, 1.1821823120117188, -4.516949653625488, -0.2603187561035156, 0.9457356929779053, 1.4454116821289062, -8.80613899230957, -17.175193786621094, 0.6370449066162109, -5.343925476074219, -0.5260467529296875, -1.4481487274169922, 0.013003349304199219, -0.7698907852172852, 1.111654281616211, 0.03363990783691406, -0.4253678321838379, 0.7357559204101562, 0.4160032272338867, 0.46597766876220703, 0.29119300842285156, -0.6218719482421875, -0.5436825752258301, 1.6095314025878906, -0.5072212219238281, -0.41745805740356445, -0.1103053092956543, 0.2338855266571045, -0.7041397094726562, -1.577383041381836, 0.1305394172668457, 0.02238178253173828, -0.35501575469970703, -8.004526138305664, -0.8775711059570312, 0.9457356929779053, -1.3984336853027344, -0.7690486907958984, -8.13972282409668, 0.664398193359375, -0.4978647232055664, 0.24317646026611328, -0.32268333435058594, -1.3984336853027344, -0.7218189239501953, 0.7808120250701904, 0.27611827850341797, -0.5893783569335938, -6.640815258026123, -1.0855158567428589, -0.12763071060180664, 0.013337135314941406, 1.8238983154296875, -1.160714030265808, 0.1271800994873047, 0.529139518737793, 0.020097732543945312, -0.25649356842041016, 11.211372375488281, 1.0141124725341797, -5.775586128234863, -0.4092996120452881, -0.1146087646484375, -1.8917794227600098, -0.13459014892578125, -0.18993902206420898, 0.06534290313720703, -3.2769737243652344, -0.039361000061035156, -9.421220779418945, 2.4791250228881836, -0.4835090637207031, 1.206838607788086, -0.7973449230194092, -1.0400867462158203, -1.196995735168457, 1.307471752166748, 0.9340295791625977, 0.9520740509033203, 0.5688686370849609, -0.020599365234375, 0.4832329750061035, 0.9750881195068359, -1.5615079402923584, -1.9132843017578125, 0.1146550178527832, -7.667049407958984, 1.0075397491455078, -0.07299041748046875, -0.19427108764648438, 0.1147623062133789, 0.7099409103393555, -9.428352355957031, 0.7685470581054688, -0.034275054931640625, 0.18885469436645508, 0.5011818408966064, -0.8495922088623047, -2.187253952026367, -0.6054534912109375, -7.906669616699219, -1.3924264907836914, -0.5266094207763672, -0.5638751983642578, -4.079693794250488, 0.8384151458740234, -0.24947738647460938, 0.4819679260253906, 0.6440621614456177, -5.891424179077148, 1.3129596710205078, -0.35515689849853516, 19.118881225585938, 1.697052001953125, 1.7041473388671875, -0.7443056106567383, -0.052997589111328125, 0.26724815368652344, -5.0572028160095215, -7.274026393890381, 0.6759424209594727, 0.10742759704589844, 0.17956829071044922, -0.8360986709594727, 0.8029937744140625, -0.9219236373901367, -22.711618423461914, -1.0778865814208984, 0.5545444488525391, -0.5174655914306641, 0.3767509460449219, -2.5211334228515625, -0.6662464141845703, -2.7738208770751953, 0.547698974609375, 0.6507506370544434, -1.6559906005859375, 0.7725015878677368, -1.3263044357299805, 1.1843605041503906, -4.758945465087891, 0.5159873962402344, -1.1438655853271484, -0.6686365604400635, -0.1693553924560547, -0.3898744583129883, -0.053836822509765625, 2.4791250228881836, -1.719827651977539, -0.318622350692749, -6.402116775512695, 0.4237194061279297, 0.817631721496582, -6.060018539428711, 0.6480922698974609, -1.4977998733520508, 7.501058101654053, -0.026097893714904785, -0.6060276031494141, -0.29462194442749023, 0.6094741821289062, 0.3481941223144531, -0.43274879455566406, -0.3832845687866211, -0.28304100036621094, -1.828329086303711, -0.3020944595336914, -1.5047245025634766, -6.78915548324585, 1.7860660552978516, 0.1635901927947998, 1.2143211364746094, -1.4159526824951172, -5.268486499786377, 0.4257011413574219, -0.8269081115722656, -0.021312713623046875, 1.3267593383789062, 0.8083381652832031, 2.125676155090332, 1.6138458251953125, 0.5539875030517578, 0.03357887268066406, 0.12459897994995117, -2.6708221435546875, -1.2747726440429688, 1.6983203887939453, 0.5094084739685059, -0.6955528259277344, 1.0338592529296875, 0.014896392822265625, 0.9098739624023438, 0.8528509140014648, -5.404760360717773, 1.3931388854980469, -0.42809629440307617, 1.1613855361938477, 1.0466461181640625, -0.07993888854980469, -0.20217132568359375, 1.2469229698181152, -1.7408504486083984, -0.3678760528564453, -0.657191276550293, -0.2651939392089844, 0.2498455047607422, -0.11956310272216797, -3.5909194946289062, 0.3114767074584961, -0.6753749847412109, -0.23677635192871094, -0.015468597412109375, -4.101535797119141, -0.21853256225585938, 0.454071044921875, 0.44748497009277344, -0.5003910064697266, 0.10903167724609375, 1.3082990646362305, 0.9991378784179688, -2.7802348136901855, -0.9803605079650879, 1.476698875427246, 2.0561773777008057, 1.1247193813323975, 0.5688686370849609, -2.589827537536621, 1.6262187957763672], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 150000, "last_target_update_ts": 40960, "num_target_updates": 79}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -170.9180110963434, "episode_len_mean": 299.49, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218], "episode_lengths": [336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5232909998337469, "mean_inference_ms": 23.569133695314207, "mean_action_processing_ms": 0.1394866238042963, "mean_env_wait_ms": 4.138361855724877, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -170.9180110963434, "episode_len_mean": 299.49, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-216.06084562838078, -256.68752504885197, -378.1921111047268, -326.7300293967128, -544.4055313915014, -263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218], "episode_lengths": [336, 359, 395, 348, 433, 350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5232909998337469, "mean_inference_ms": 23.569133695314207, "mean_action_processing_ms": 0.1394866238042963, "mean_env_wait_ms": 4.138361855724877, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 150000, "num_env_steps_sampled": 40960, "num_env_steps_trained": 150000, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 40960, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 361.829, "learn_time_ms": 76.148, "learn_throughput": 3151.743, "synch_weights_time_ms": 20.205}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 150000, "last_target_update_ts": 40960, "num_target_updates": 79}, "done": false, "episodes_total": 129, "training_iteration": 40, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-21-13", "timestamp": 1655500873, "time_this_iter_s": 5.674374103546143, "time_total_s": 211.5686354637146, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 211.5686354637146, "timesteps_since_restore": 0, "iterations_since_restore": 40, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 26.725, "ram_util_percent": 64.48750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.166001319885254, "min_q": -55.760379791259766, "max_q": 31.106157302856445, "mean_td_error": -5.2199273109436035}, "td_error": [-1.204005479812622, -0.48174285888671875, 0.16248512268066406, 1.7536289691925049, -1.4818401336669922, 0.3672523498535156, 0.20217418670654297, 0.34850645065307617, -0.05049705505371094, -0.48011350631713867, -0.455902099609375, 0.0720224380493164, -11.077417373657227, -1.719304084777832, -1.9029803276062012, 0.3668651580810547, -0.830230712890625, -0.3914337158203125, -1.16837739944458, -0.23384666442871094, -0.39167213439941406, -11.465791702270508, -1.900766372680664, -1.051264762878418, -0.20177650451660156, -1.2896966934204102, -0.8126907348632812, -0.4766216278076172, -0.9730443954467773, -0.2309703826904297, 1.1435413360595703, 0.3392515182495117, -1.3020210266113281, -0.742034912109375, -1.8570327758789062, 0.3741455078125, -0.29097747802734375, -0.24013519287109375, 0.2486032247543335, -0.04370307922363281, 0.2464427947998047, -1002.56787109375, -1.9554214477539062, -1.4098930358886719, -1.194772720336914, -0.5991001129150391, -0.1954479217529297, 0.09881973266601562, 0.392486572265625, -1.9490423202514648, -0.4568319320678711, 1.1599884033203125, 0.11967134475708008, -1.727752685546875, -1.0029716491699219, -0.05858135223388672, 0.6454505920410156, -1.669839859008789, -1.4782123565673828, -0.30646324157714844, -1.9029803276062012, -0.5222549438476562, -0.21816635131835938, -0.11006355285644531, 1.1251347064971924, 0.18254661560058594, -0.7172431945800781, 0.7138233184814453, -0.003658294677734375, -1.1074714660644531, 0.5478954315185547, -1.2491865158081055, 0.7692832946777344, 0.6611309051513672, -1.1160602569580078, -0.7495036125183105, 0.1867363452911377, 0.07408332824707031, -1.2726225852966309, -2.0403804779052734, 1.245077133178711, 0.1338815689086914, -0.21036720275878906, -0.12774658203125, -1.3446636199951172, -1.5633199214935303, 0.6303038597106934, 0.06544303894042969, 0.6444377899169922, -0.4696693420410156, -0.44533705711364746, 0.9273171424865723, -0.7417793273925781, -3.0195159912109375, -0.08366262912750244, -0.08373832702636719, -1.3872432708740234, -0.32825469970703125, -2.3619232177734375, -4.653881072998047, 0.2021636962890625, 2.3910140991210938, -0.9511804580688477, -3.166867256164551, -0.47954845428466797, -0.6891474723815918, -5.319517135620117, -1.7682523727416992, 0.4483642578125, 0.6594619750976562, -1.8505382537841797, -0.8526344299316406, 0.06597518920898438, -0.3405764102935791, -0.5957450866699219, -0.3119776248931885, -0.8775205612182617, 0.8070278167724609, -0.4423694610595703, 3.143308639526367, -2.4061031341552734, -0.7847213745117188, 0.8263087272644043, 0.1929159164428711, -0.7700824737548828, 1.4143218994140625, -6.8236083984375, 1.0400829315185547, -4.217594146728516, -0.14395904541015625, -1.6248455047607422, -8.385324478149414, -1.3450303077697754, -1.1259288787841797, -0.9857559204101562, -1.368445634841919, -6.991767883300781, -0.3066387176513672, -0.3576817512512207, -0.7861270904541016, -17.04134178161621, -0.11943626403808594, 0.9101066589355469, -0.7909665107727051, -0.23709869384765625, -9.202730178833008, -3.325275421142578, -11.587589263916016, -1.5582361221313477, 0.19994831085205078, -0.70556640625, -0.1883544921875, 0.24380111694335938, -2.062154769897461, -1.8897829055786133, -0.817047119140625, -0.5410459041595459, -0.5869970321655273, -1.13641357421875, -1.4526758193969727, 15.297453880310059, -0.3627510070800781, 0.5254325866699219, -8.628044128417969, -1.0372142791748047, -0.5679244995117188, 2.2648849487304688, 0.047512054443359375, -1.86865234375, -0.21908950805664062, -1.6143302917480469, -0.7204217910766602, -0.2647838592529297, -1.4782123565673828, -1.3101015090942383, 1.2523670196533203, -1.7248992919921875, 0.24692153930664062, -0.6094741821289062, -0.4977402687072754, -0.9458961486816406, -4.312566757202148, 0.31373053789138794, 0.15257644653320312, 0.3342900276184082, -0.8696556091308594, -1.9877777099609375, -0.20894813537597656, -1.2408431768417358, -0.16229248046875, -3.9869370460510254, -4.624689102172852, 0.4075937271118164, -1.3954920768737793, -0.2704896926879883, -0.7578449249267578, -0.009185791015625, -0.9743986129760742, -1.3450303077697754, -3.0878777503967285, -2.576690673828125, -2.5655574798583984, -7.028321266174316, 0.3220806121826172, -0.47470521926879883, -1.2958731651306152, -0.32443809509277344, -0.7172431945800781, 0.8422287702560425, -0.6824684143066406, -0.42499780654907227, -4.573178768157959, -0.3695859909057617, -0.1753101348876953, -0.7851552963256836, -0.4086790084838867, -12.989198684692383, 0.34163665771484375, 0.07369613647460938, -3.0721492767333984, 0.05804443359375, -1.371999740600586, -0.12774658203125, -1.6307649612426758, -7.981315612792969, -1.056502342224121, -1.2850236892700195, 0.005712032318115234, -1.1934795379638672, 0.1233816146850586, -0.5127928256988525, 0.24422550201416016, -0.14634990692138672, -0.40790748596191406, -1.2053656578063965, -0.5057382583618164, 0.5728092193603516, -0.5869970321655273, -2.364482879638672, -0.3158245086669922], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 153840, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 153840, "last_target_update_ts": 41984, "num_target_updates": 81}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -156.56372096195818, "episode_len_mean": 293.55, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925], "episode_lengths": [350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5242969603264155, "mean_inference_ms": 23.64460448564291, "mean_action_processing_ms": 0.13968888521031514, "mean_env_wait_ms": 4.141521749995966, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -661.6620547249913, "episode_reward_mean": -156.56372096195818, "episode_len_mean": 293.55, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-263.6964292526245, -172.54415245354176, -245.5721571817994, -215.05161288380623, -226.3276824951172, -278.37513717263937, -301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925], "episode_lengths": [350, 291, 341, 296, 315, 356, 338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5242969603264155, "mean_inference_ms": 23.64460448564291, "mean_action_processing_ms": 0.13968888521031514, "mean_env_wait_ms": 4.141521749995966, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 153840, "num_env_steps_sampled": 41984, "num_env_steps_trained": 153840, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 41984, "agent_timesteps_total": 41984, "timers": {"training_iteration_time_ms": 343.843, "learn_time_ms": 76.27, "learn_throughput": 3146.701, "synch_weights_time_ms": 20.489}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 153840, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 153840, "last_target_update_ts": 41984, "num_target_updates": 81}, "done": false, "episodes_total": 134, "training_iteration": 41, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-21-19", "timestamp": 1655500879, "time_this_iter_s": 5.560654401779175, "time_total_s": 217.12928986549377, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 217.12928986549377, "timesteps_since_restore": 0, "iterations_since_restore": 41, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.9125, "ram_util_percent": 64.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.689305305480957, "min_q": -55.109230041503906, "max_q": 31.831912994384766, "mean_td_error": -0.9575859308242798}, "td_error": [-0.12271595001220703, -1.103235125541687, -0.5391721725463867, 5.320009231567383, -0.6544971466064453, -0.6567196846008301, -0.5595929622650146, -0.3142528533935547, -2.525867462158203, -0.19980430603027344, 1.528578758239746, -0.13348960876464844, -3.6487045288085938, 1.176590919494629, 0.13039398193359375, 0.3280477523803711, -0.4847574234008789, 1.176590919494629, -0.714695930480957, -1.8382225036621094, -0.1013174057006836, -0.22662746906280518, 0.7607154846191406, -5.37283182144165, 0.28496456146240234, -0.20933151245117188, -0.7506294250488281, -0.9434318542480469, -0.33128929138183594, -0.5006413459777832, -1.1360735893249512, -1.2657041549682617, -0.7649497985839844, 0.14559173583984375, -2.744513511657715, 1.0170907974243164, 0.8511199951171875, -1.1840753555297852, -0.44617366790771484, -7.563913345336914, -0.6712617874145508, -20.49835777282715, -10.797146797180176, -1.519052505493164, -0.5254044532775879, 0.11153650283813477, -0.2801833152770996, 0.651443362236023, -2.307384490966797, -1.0919623374938965, -0.5425119400024414, 0.8655176162719727, 0.4402809143066406, -1.0465774536132812, -0.1383298635482788, 0.7025661468505859, -0.04564380645751953, 0.8514628410339355, -0.2216629981994629, -0.887580156326294, 0.16549921035766602, 1.9024362564086914, -2.9727706909179688, -0.5263872146606445, 1.432910680770874, 0.027410507202148438, -1.2388708591461182, -0.7590923309326172, -0.22447562217712402, -1.0349922180175781, 0.6918060779571533, -0.15402889251708984, 0.5959053039550781, -1.9759941101074219, -0.2535839080810547, -0.03399658203125, -0.33130455017089844, -0.27094078063964844, -1.3199529647827148, 0.7481288909912109, -0.6165428161621094, 1.0170907974243164, -0.21375370025634766, -0.2839939594268799, -2.726376533508301, -1.5752949714660645, 0.019330978393554688, -10.697654724121094, -1.5505952835083008, -1.9640464782714844, -1.4719600677490234, 1.0039100646972656, -0.3447895050048828, 0.7654390335083008, 0.2995033264160156, 0.8612747192382812, 0.24759864807128906, -2.8435423374176025, -0.4782280921936035, -1.7890491485595703, -0.9328904151916504, 0.5376262664794922, -2.312929153442383, 0.5706939697265625, -0.7959709167480469, 1.176553726196289, 0.16246795654296875, -4.113702774047852, 1.2319507598876953, -1.0265073776245117, -0.19980430603027344, -2.1406493186950684, 0.4003181457519531, -3.308981418609619, -0.19687414169311523, -1.3018274307250977, -0.23062705993652344, -0.7348991632461548, -0.570035457611084, 0.24960803985595703, -0.4400331974029541, -0.4668149948120117, 2.542997360229492, 0.64697265625, -1.2983818054199219, 1.0532493591308594, 0.3284950256347656, -2.000307083129883, -0.5081939697265625, -4.856161594390869, -0.9195497035980225, -0.492026686668396, 0.03618621826171875, -0.5676307678222656, -0.05290794372558594, 0.14216995239257812, -4.950660705566406, -0.03489851951599121, 6.109426975250244, 2.4377365112304688, 1.0756349563598633, -0.5607967376708984, -2.4472408294677734, 0.4887819290161133, -6.40446662902832, -0.26605796813964844, -0.2452077865600586, -10.20142936706543, 0.4332389831542969, -1.0682249069213867, -1.8526382446289062, 0.5005402565002441, 0.05403327941894531, 0.40261268615722656, -11.027883529663086, -1.6529312133789062, -6.207564353942871, 0.905609130859375, -0.8951244354248047, 0.7458572387695312, -0.3685111999511719, -0.34599781036376953, 0.23436641693115234, 0.055536895990371704, -0.8584480285644531, -0.7698545455932617, -0.0563507080078125, 0.23232078552246094, -1.0170812606811523, -6.33261775970459, -1.358480453491211, -11.186767578125, -4.687774658203125, -0.33283066749572754, -0.006259918212890625, 1.207244873046875, -0.33324193954467773, -13.236141204833984, 11.368579864501953, -1.1296042203903198, -2.33892822265625, -5.481707572937012, 3.259429693222046, 0.2736845016479492, -2.6005053520202637, -1.5207509994506836, -0.6521915793418884, -0.4904212951660156, -0.5607967376708984, 0.38973045349121094, -0.4170494079589844, -0.41059303283691406, 0.14045333862304688, -1.8785037994384766, -0.5440354347229004, -0.21557235717773438, 0.24982833862304688, 0.6439647674560547, -7.202444076538086, -0.3181171417236328, -0.6329468488693237, -0.014729022979736328, -0.10040640830993652, -1.2116994857788086, 0.12225723266601562, -4.834870338439941, -4.636565685272217, 0.10805988311767578, 0.3231964111328125, -1.3675460815429688, -1.6083641052246094, -2.3139095306396484, -1.5717792510986328, -1.257451057434082, -0.20111322402954102, -3.682742118835449, 0.10152816772460938, -2.0582690238952637, 0.13356590270996094, -0.21715092658996582, 0.38112354278564453, -2.53271484375, -0.6286067962646484, -0.4811720848083496, -0.5133004188537598, 0.12883281707763672, -0.9029369354248047, -1.2368717193603516, -0.08195877075195312, -1.3486919403076172, -1.3947067260742188, 0.016923904418945312, -0.5777664184570312, -0.49489372968673706, 0.20217514038085938, 0.64697265625, -1.2675409317016602, -0.8366374969482422, -0.04883074760437012, -1.1408172845840454], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 157680, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 157680, "last_target_update_ts": 43008, "num_target_updates": 83}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -156.7466260829568, "episode_len_mean": 293.3, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477], "episode_lengths": [338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5248856183990092, "mean_inference_ms": 23.66812016161647, "mean_action_processing_ms": 0.1385400743403248, "mean_env_wait_ms": 4.139319101961398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -156.7466260829568, "episode_len_mean": 293.3, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477], "episode_lengths": [338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5248856183990092, "mean_inference_ms": 23.66812016161647, "mean_action_processing_ms": 0.1385400743403248, "mean_env_wait_ms": 4.139319101961398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 157680, "num_env_steps_sampled": 43008, "num_env_steps_trained": 157680, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 43008, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 353.785, "learn_time_ms": 77.74, "learn_throughput": 3087.2, "synch_weights_time_ms": 20.688}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 157680, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 157680, "last_target_update_ts": 43008, "num_target_updates": 83}, "done": false, "episodes_total": 140, "training_iteration": 42, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-21-25", "timestamp": 1655500885, "time_this_iter_s": 5.744068622589111, "time_total_s": 222.87335848808289, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 222.87335848808289, "timesteps_since_restore": 0, "iterations_since_restore": 42, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.455555555555556, "ram_util_percent": 64.38888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -7.997783184051514, "min_q": -52.835487365722656, "max_q": 32.15693664550781, "mean_td_error": -0.9211981296539307}, "td_error": [-1.1743241548538208, -0.5035161972045898, -0.8347997665405273, -1.5191316604614258, 1.0507984161376953, -8.983833312988281, 1.9322328567504883, 1.2232050895690918, 2.1678848266601562, 0.14937210083007812, -0.15221959352493286, -4.927724838256836, -1.5497627258300781, 0.09287691116333008, -3.927654266357422, 14.527823448181152, -1.0889177322387695, 0.6964491605758667, -2.9063096046447754, 0.11862659454345703, 0.2069997787475586, -7.329351425170898, -1.049367904663086, -0.09242820739746094, -0.3079643249511719, 0.2902984619140625, -2.4765472412109375, -7.796494483947754, -0.51220703125, -1.1222717761993408, -0.6286849975585938, -6.414444446563721, -3.080320358276367, 0.9938047528266907, 4.32177209854126, -0.2737159729003906, 0.3800569772720337, -1.12287175655365, -0.4896068572998047, -0.3289756774902344, -1.3001608848571777, 2.011789321899414, 0.02933359146118164, -1.744196891784668, 0.9198226928710938, 0.9131526947021484, -0.38127899169921875, 0.6883106231689453, -1.7334213256835938, -0.2225666046142578, -1.6144613027572632, -0.6100263595581055, -0.5918278694152832, -5.75947380065918, 1.1927680969238281, -1.823206901550293, 0.3976668119430542, -1.6177825927734375, -1.1938362121582031, -2.627007484436035, 0.24777603149414062, -0.356842041015625, -8.446371078491211, -0.0608367919921875, -2.9616408348083496, 0.6372041702270508, -2.289747714996338, 1.017646312713623, -0.1593332290649414, 0.05678844451904297, 0.21310997009277344, 0.304563045501709, -2.0166139602661133, -4.228588104248047, -0.32134246826171875, -0.8241825103759766, -11.047928810119629, -0.31923961639404297, 0.31182003021240234, 1.4830608367919922, -0.0019989013671875, 0.3659200668334961, -0.3878593444824219, 1.3701542615890503, -6.445213317871094, -16.744779586791992, -1.539113998413086, -0.1784878373146057, -0.5283846855163574, -0.18586444854736328, 0.9444637298583984, 0.5876994132995605, -0.3054431676864624, -2.567811965942383, -11.388015747070312, -0.4423084259033203, -0.15500831604003906, 1.5610661506652832, -1.0294952392578125, -0.08409643173217773, -0.8287243843078613, -1.43235182762146, -2.5023322105407715, 0.6629352569580078, -0.21932315826416016, -0.9603252410888672, -0.8163690567016602, -0.3872222900390625, 4.091714859008789, 0.47041893005371094, 0.41005516052246094, -0.41504716873168945, 0.38943201303482056, -0.13776564598083496, 0.47112083435058594, -3.347545623779297, 0.76953125, -1.4855585098266602, 0.1695394515991211, -1.3744688034057617, -1.0429697036743164, -0.4281003475189209, -0.05281257629394531, -1.1023521423339844, -1.2511672973632812, -0.7926645278930664, -0.9220361709594727, -0.8416986465454102, -1.1392345428466797, -2.6216039657592773, 0.14673423767089844, 0.7445545196533203, -2.0996437072753906, -0.40971946716308594, 0.24777603149414062, -0.3027811050415039, 0.12354904413223267, -0.22951889038085938, -1.0167264938354492, 8.93480110168457, -1.3545942306518555, -0.06962394714355469, -6.508330821990967, -0.7958095073699951, -1.3662242889404297, 0.46652984619140625, -5.502742767333984, -0.9933977127075195, -2.086111068725586, 0.11224937438964844, -0.07723808288574219, 0.10354423522949219, -3.103710174560547, 0.8968753814697266, -0.48680901527404785, 0.3739051818847656, -2.1209444999694824, -0.40949058532714844, -0.19419479370117188, 0.44709157943725586, -0.3679332733154297, -0.06535688042640686, 0.24033355712890625, -0.6044158935546875, -1.0378198623657227, 0.29487156867980957, 0.63494873046875, 21.281129837036133, -3.465001106262207, -0.3827533721923828, -0.6025199890136719, 0.195220947265625, -0.7241239547729492, -2.78751802444458, 0.7917404174804688, -1.1486616134643555, -0.04240989685058594, -1.4356865882873535, 0.22060871124267578, 0.7951345443725586, 4.890833377838135, -0.9908714294433594, -2.0279006958007812, 0.4656517505645752, -1.905320167541504, -0.7775192260742188, 0.4227924346923828, -0.3679332733154297, 1.2073287963867188, -1.5712804794311523, -0.9744739532470703, -0.02641439437866211, -1.0820121765136719, -1.7562932968139648, -1.4755992889404297, -1.931948184967041, 0.7046298980712891, 0.12294960021972656, -0.24463462829589844, -0.8884868621826172, 0.2637338638305664, -0.7735557556152344, 0.018561124801635742, -1.5011272430419922, -0.43416404724121094, -8.39748764038086, -0.9979820251464844, -0.05446338653564453, 1.6318979263305664, 0.5987005233764648, -5.8155717849731445, -1.9228744506835938, -2.312501907348633, -2.5656538009643555, 0.5221633911132812, -0.676361083984375, -0.11991310119628906, 0.9958581924438477, -13.958390235900879, 0.15548133850097656, -1.0007801055908203, 0.97412109375, 1.1126289367675781, -1.2746477127075195, -1.3274459838867188, -0.2476731538772583, -3.894625663757324, 0.3635063171386719, -2.547372817993164, -1.7638297080993652, -0.5497732162475586, -0.3287677764892578, -0.45038604736328125, -1.7891311645507812, -3.061039924621582, -1.6376457214355469, -7.293010711669922, -3.8978495597839355, -14.519978523254395, 0.42635393142700195], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 161520, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 161520, "last_target_update_ts": 44032, "num_target_updates": 85}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -156.7466260829568, "episode_len_mean": 293.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477], "episode_lengths": [338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5248856183990092, "mean_inference_ms": 23.66812016161647, "mean_action_processing_ms": 0.1385400743403248, "mean_env_wait_ms": 4.139319101961398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -156.7466260829568, "episode_len_mean": 293.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301.026958912611, -294.6017154827714, -393.888928219676, -344.0807407423854, -474.0226916000247, -423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477], "episode_lengths": [338, 350, 408, 376, 402, 400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5248856183990092, "mean_inference_ms": 23.66812016161647, "mean_action_processing_ms": 0.1385400743403248, "mean_env_wait_ms": 4.139319101961398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 161520, "num_env_steps_sampled": 44032, "num_env_steps_trained": 161520, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 44032, "agent_timesteps_total": 44032, "timers": {"training_iteration_time_ms": 326.461, "learn_time_ms": 78.666, "learn_throughput": 3050.872, "synch_weights_time_ms": 21.608}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 161520, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 161520, "last_target_update_ts": 44032, "num_target_updates": 85}, "done": false, "episodes_total": 140, "training_iteration": 43, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-21-30", "timestamp": 1655500890, "time_this_iter_s": 5.152179479598999, "time_total_s": 228.02553796768188, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 228.02553796768188, "timesteps_since_restore": 0, "iterations_since_restore": 43, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 30.51428571428571, "ram_util_percent": 64.54285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.410240650177002, "min_q": -56.42470932006836, "max_q": 35.20888900756836, "mean_td_error": -1.0162327289581299}, "td_error": [-4.234696388244629, -0.2809429168701172, -0.2837700843811035, -1.5484380722045898, -2.589423179626465, -1.1260709762573242, 2.0994796752929688, 0.09145259857177734, 0.14091277122497559, 0.32370758056640625, -3.573606014251709, -0.5916562080383301, -1.2819011211395264, 0.6037845611572266, -0.22858428955078125, -6.91185188293457, 0.6418299674987793, -0.7186164855957031, 0.7965869903564453, -0.9036769866943359, -1.9894418716430664, -0.6155557632446289, -7.901580810546875, -5.405464172363281, 0.08653223514556885, -3.4825477600097656, -1.5185718536376953, -0.15652084350585938, -0.490264892578125, 0.09797871112823486, -1.2783565521240234, 0.12000364810228348, -1.0414066314697266, 1.320657730102539, -0.2860381603240967, -1.8956775665283203, -2.1193675994873047, 0.9647407531738281, 0.7019367218017578, 1.2588996887207031, -1.241403579711914, -0.6853379011154175, 1.5091533660888672, 0.311495304107666, -0.006881237030029297, 2.249260902404785, 1.0467777252197266, -0.6070437431335449, -0.1251049041748047, -1.3312397003173828, 0.0636301040649414, -0.20122957229614258, -1.148524284362793, -0.03009718656539917, -7.698870658874512, 0.4159107208251953, -14.72388744354248, 0.7758736610412598, -0.670720100402832, -0.43086814880371094, 0.03392744064331055, -0.275299072265625, 1.5224647521972656, -1.6263047456741333, -1.1831960678100586, -1.470697045326233, 0.07053756713867188, 3.1524834632873535, -0.25667858123779297, -1.065835952758789, -1.9343976974487305, 0.19965648651123047, -0.9272546768188477, -0.11525344848632812, -1.137882113456726, -0.5809106826782227, 0.16974544525146484, 1.3523197174072266, -1.611532211303711, -0.8426151275634766, -0.3753366470336914, -7.824118614196777, -1.5622355937957764, -0.44931793212890625, -1.3710232973098755, 0.6965069770812988, 2.045459747314453, 0.6932251453399658, -1.6837902069091797, 1.4653291702270508, -1.3822021484375, -0.7478995323181152, -0.9958915710449219, -0.3632240295410156, 4.633402347564697, -0.1953144073486328, -2.238687515258789, -0.3903017044067383, -10.905058860778809, -12.789690971374512, -2.7210693359375, 0.5925271511077881, -1.8943500518798828, -0.5750603675842285, 1.329742431640625, 2.2248716354370117, -0.05775642395019531, -1.4113388061523438, 0.9703340530395508, -3.039459705352783, -0.3560304641723633, -0.7095470428466797, 1.224308967590332, -6.350803375244141, -7.537139415740967, -5.496155738830566, -0.6556072235107422, 0.3008441925048828, -2.4168553352355957, 0.9814739227294922, 1.1864280700683594, -2.2252302169799805, 0.8924398422241211, -1.4625577926635742, -0.5283317565917969, 0.1027374267578125, -0.5443906784057617, -0.4516744613647461, 0.047557830810546875, 0.0503692626953125, 0.4965829849243164, -0.007198691368103027, -0.8002090454101562, 0.48561859130859375, -0.2583436965942383, 0.4048497676849365, -1.023228645324707, -0.4136505126953125, -0.6845855712890625, -0.5804471969604492, 0.0283355712890625, -3.5890989303588867, 2.640169143676758, -1.7189693450927734, -5.90532112121582, 1.5885562896728516, 0.8989086151123047, -2.3350725173950195, 0.9209136962890625, 1.0858497619628906, -0.28742516040802, -0.0033478736877441406, -5.777927398681641, -0.8728539943695068, -0.6315593719482422, -0.8739433288574219, -4.22807502746582, -0.4616394639015198, -0.4083290100097656, -0.6268138885498047, -0.8966598510742188, 1.3634958267211914, -3.1755714416503906, -1.0575265884399414, -2.099684000015259, -10.014829635620117, -0.9628348350524902, -5.164300441741943, -0.3212718963623047, -0.15470361709594727, -4.355295658111572, -0.9217472076416016, -0.6026434898376465, 3.4465038776397705, -1.4143178462982178, -3.9051642417907715, -1.896148681640625, -0.7997875213623047, -1.1543021202087402, -1.6014232635498047, -0.1834430694580078, -8.999540328979492, -0.19993147253990173, 0.10627853870391846, -0.31189727783203125, -1.3374547958374023, -1.9125280380249023, -7.718395233154297, -0.4868021011352539, -6.701058387756348, 2.5004405975341797, -0.5280046463012695, -2.000882625579834, -1.0409479141235352, -0.22417449951171875, -1.4638347625732422, -0.13638830184936523, 4.118320465087891, -0.9255247116088867, -0.8621740341186523, -0.8970346450805664, 0.9516878128051758, -0.3658332824707031, 0.1575765609741211, -1.6028661727905273, -0.06721639633178711, 1.3394489288330078, 0.32018566131591797, -0.9154214859008789, 2.079133987426758, 0.309237003326416, -0.40152692794799805, 0.12753677368164062, -1.3730411529541016, -0.8748569488525391, 1.195535659790039, -0.19380760192871094, 4.974510192871094, -12.338890075683594, -2.006223678588867, 3.767500162124634, 0.47144222259521484, -0.7095470428466797, 0.22242474555969238, 0.34197258949279785, -0.5643177032470703, -1.6189956665039062, 0.6610012054443359, -2.6965408325195312, -0.4712867736816406, -0.2956275939941406, -1.242152214050293, 0.011920452117919922, 1.4291515350341797, 0.39615631103515625, -0.8254175186157227, -0.20423173904418945, -7.990293502807617, -2.741448402404785, -0.790041446685791], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 165360, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 165360, "last_target_update_ts": 45056, "num_target_updates": 87}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -139.39989894233645, "episode_len_mean": 286.62, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493], "episode_lengths": [400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5245365679265448, "mean_inference_ms": 23.707806876547153, "mean_action_processing_ms": 0.13835493346469935, "mean_env_wait_ms": 4.14868578043464, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -139.39989894233645, "episode_len_mean": 286.62, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-423.1726895943284, -661.6620547249913, -628.412836022675, -129.69914323091507, -45.37042833119631, -102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493], "episode_lengths": [400, 450, 439, 265, 262, 271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5245365679265448, "mean_inference_ms": 23.707806876547153, "mean_action_processing_ms": 0.13835493346469935, "mean_env_wait_ms": 4.14868578043464, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 165360, "num_env_steps_sampled": 45056, "num_env_steps_trained": 165360, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 45056, "agent_timesteps_total": 45056, "timers": {"training_iteration_time_ms": 339.561, "learn_time_ms": 77.886, "learn_throughput": 3081.413, "synch_weights_time_ms": 21.686}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 165360, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 165360, "last_target_update_ts": 45056, "num_target_updates": 87}, "done": false, "episodes_total": 145, "training_iteration": 44, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-21-36", "timestamp": 1655500896, "time_this_iter_s": 5.547764778137207, "time_total_s": 233.5733027458191, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 233.5733027458191, "timesteps_since_restore": 0, "iterations_since_restore": 44, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 30.4375, "ram_util_percent": 64.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.214296340942383, "min_q": -53.22043991088867, "max_q": 28.452608108520508, "mean_td_error": -3.9023025035858154}, "td_error": [0.9592657089233398, -1.2609119415283203, -6.526369094848633, -0.7541723251342773, 1.3597640991210938, 1.4220075607299805, 1.8842487335205078, 0.13084197044372559, 2.390270233154297, -0.6369171142578125, -0.054046630859375, 1.2241973876953125, -0.2539234161376953, -1.400069236755371, 0.9516162872314453, 1.6617984771728516, 3.647287368774414, 0.7949934005737305, 1.4017219543457031, -1.2535302639007568, 0.39037275314331055, -2.3552989959716797, 0.15947961807250977, -0.15423917770385742, 0.15545177459716797, -0.22866535186767578, -0.18546009063720703, 0.204559326171875, -0.20125484466552734, 1.7215759754180908, 0.6662502288818359, 1.0408973693847656, 0.7899596691131592, 0.0910491943359375, 0.13830852508544922, -1.844719648361206, 0.2594623565673828, -0.004055781289935112, -2.646068572998047, 2.164773941040039, 1.1031255722045898, 0.1401057243347168, 1.9463615417480469, 0.7953834533691406, -0.10149955749511719, 0.35617494583129883, 2.188833236694336, 0.8349237442016602, 1.5294971466064453, -0.06064128875732422, -4.0785651206970215, 0.6811332702636719, 1.5065040588378906, 1.7074089050292969, -0.23658931255340576, 0.10703897476196289, -5.226253509521484, 1.0506057739257812, 2.173396110534668, 2.2186222076416016, -1.0290948152542114, 0.06711769104003906, 0.9159918427467346, -6.254856109619141, -1.3260259628295898, -1.5823974609375, -0.6582012176513672, 1.6076641082763672, 1.1747636795043945, 2.256222724914551, -5.271804332733154, -0.5075466632843018, 1.0916061401367188, -0.3468472957611084, -0.7300963401794434, 0.08158683776855469, 1.1556377410888672, 0.981752872467041, -0.06263923645019531, 1.0509734153747559, -1.3240280151367188, 1.6647005081176758, 1.15590238571167, -0.4184079170227051, 0.0035943984985351562, 1.665940284729004, 1.3956022262573242, 2.9885101318359375, 1.3241662979125977, 0.0301055908203125, 0.1345062255859375, -0.623967170715332, 0.37140655517578125, 1.4274101257324219, -3.60404109954834, 1.596822738647461, -0.05278158187866211, -0.5921655893325806, 0.8078083992004395, 2.242158889770508, 0.6016874313354492, 0.4060983657836914, -0.09473037719726562, -0.6412544250488281, 1.8998126983642578, 0.9516162872314453, 0.45681095123291016, 1.13360595703125, -0.158552885055542, 1.3567924499511719, 0.15723800659179688, 6.214170455932617, -0.8511769771575928, -0.7945404052734375, -0.20897817611694336, -0.1590321660041809, -8.484415054321289, 0.038694798946380615, 0.3146292567253113, -3.60404109954834, 2.5667686462402344, 1.2399845123291016, -1.3074321746826172, 1.0661773681640625, -7.170955657958984, 2.6854732036590576, 1.2594184875488281, 0.38072729110717773, 4.784191131591797, -6.245943069458008, 1.2259540557861328, 0.36395883560180664, 0.15970921516418457, 2.844839096069336, 0.8705623149871826, 1.3860225677490234, 1.2601819038391113, -2.4450645446777344, 0.7321681976318359, 2.283550262451172, -0.4720284938812256, 2.183256149291992, 1.2281522750854492, 4.303749084472656, 1.2398324012756348, 2.2810137271881104, 0.87493896484375, 0.9126720428466797, 3.91989803314209, 0.2880678176879883, 0.6840372085571289, -0.2510347366333008, 1.2733173370361328, 4.206718444824219, -0.023988723754882812, 0.8134632110595703, 0.4162430763244629, 3.9388999938964844, 1.3065423965454102, 2.3385753631591797, -0.1612401008605957, 0.1348271369934082, 0.7306885719299316, 1.5365667343139648, 0.4154949188232422, -0.5135164260864258, 0.2615394592285156, 2.2454185485839844, -0.9143428802490234, 1.892878532409668, -0.4326779842376709, 1.272115707397461, 0.15683937072753906, 0.0301055908203125, 0.834565281867981, -0.023985862731933594, -1.448287010192871, 0.027528762817382812, 0.8256844282150269, -2.0608975887298584, 0.6064311265945435, 0.24689769744873047, 1.8174324035644531, 0.6970577239990234, 2.443592071533203, 0.18477189540863037, 2.249683380126953, 1.1896476745605469, 1.1509957313537598, 0.36102771759033203, 4.595676422119141, -0.020830154418945312, 0.17297744750976562, -1.052518606185913, -0.5580267906188965, 1.398226022720337, -0.350771427154541, 2.390270233154297, 0.4766969680786133, -1.7887306213378906, 1.1250427961349487, -2.9087698459625244, -1.0285444259643555, -1.7432518005371094, 0.4257926940917969, 1.077850580215454, -10.856830596923828, 1.0357108116149902, 0.15683937072753906, 0.9519615173339844, 0.2149677276611328, -1.2921104431152344, -1.3600072860717773, 1.0543155670166016, 0.40455472469329834, -4.785797119140625, -1.0324063301086426, 1.751962661743164, 0.029867976903915405, 0.8768711090087891, 0.6168239712715149, 2.1364240646362305, 0.8546886444091797, -0.7013828754425049, 2.1593379974365234, -1.4350757598876953, -0.34755897521972656, -0.31160545349121094, -999.47705078125, -1.7651958465576172, 0.9585018157958984, 0.43267059326171875, 1.987015724182129, 0.2824993133544922, 0.28215789794921875, 1.4842405319213867, -0.0710439682006836, -3.4478187561035156, 0.15320920944213867, -0.6914153099060059], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 169200, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 169200, "last_target_update_ts": 46080, "num_target_updates": 89}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -123.27781588159502, "episode_len_mean": 280.61, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277], "episode_lengths": [271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.527162753706287, "mean_inference_ms": 23.73811756360692, "mean_action_processing_ms": 0.1383817594023344, "mean_env_wait_ms": 4.156120089982576, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -123.27781588159502, "episode_len_mean": 280.61, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-102.98739575594664, -129.2807542681694, -74.33183478564024, -362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277], "episode_lengths": [271, 307, 271, 351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.527162753706287, "mean_inference_ms": 23.73811756360692, "mean_action_processing_ms": 0.1383817594023344, "mean_env_wait_ms": 4.156120089982576, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 169200, "num_env_steps_sampled": 46080, "num_env_steps_trained": 169200, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 46080, "agent_timesteps_total": 46080, "timers": {"training_iteration_time_ms": 355.545, "learn_time_ms": 77.378, "learn_throughput": 3101.66, "synch_weights_time_ms": 20.788}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 169200, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 169200, "last_target_update_ts": 46080, "num_target_updates": 89}, "done": false, "episodes_total": 150, "training_iteration": 45, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-21-42", "timestamp": 1655500902, "time_this_iter_s": 5.617676019668579, "time_total_s": 239.19097876548767, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 239.19097876548767, "timesteps_since_restore": 0, "iterations_since_restore": 45, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.95, "ram_util_percent": 64.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.134065628051758, "min_q": -55.04939651489258, "max_q": 35.15983581542969, "mean_td_error": -4.42767858505249}, "td_error": [-1.0145411491394043, 0.8055953979492188, 0.37688446044921875, 0.6663565635681152, 1.9817543029785156, 0.8490431308746338, 0.2957763671875, -0.7752265930175781, -1.1193923950195312, 0.8487279415130615, 1.4536354541778564, -2.7322473526000977, 0.048003196716308594, -0.24583673477172852, 0.3001437187194824, 0.7529315948486328, -0.7101917266845703, 0.7323241233825684, 0.5085258483886719, 1.6330838203430176, 0.623878002166748, -0.47888946533203125, -1.0076904296875, 0.13442373275756836, -0.138580322265625, 0.4316859245300293, -6.018329620361328, -0.24784278869628906, 0.45802974700927734, -0.6691570281982422, -1.268503189086914, -0.1423506736755371, 0.10616588592529297, 0.7952690124511719, -0.26398468017578125, -1.2593183517456055, 2.3278675079345703, -4.758955001831055, -0.3905820846557617, -0.3913540840148926, 1.619746208190918, -0.006307125091552734, -1.1805458068847656, -22.999038696289062, -1.2971076965332031, 0.5536394119262695, 2.249908447265625, -0.138580322265625, -0.24129486083984375, -0.1486825942993164, -0.8443927764892578, -0.8733549118041992, -2.3220040798187256, -0.02542877197265625, 0.5902466773986816, 0.4692124128341675, -1.0572690963745117, 1.2632659673690796, -2.417313575744629, -0.7227706909179688, 1.0316553115844727, 0.6541557312011719, -0.3197975158691406, 0.39084815979003906, 0.7650070190429688, 19.848575592041016, -1.505502700805664, 0.6670761108398438, 7.345090866088867, 3.368410110473633, 0.36530494689941406, 0.18382549285888672, 0.43745899200439453, -1.7514019012451172, -1.119807243347168, 0.7471346855163574, -0.3220348358154297, 0.9608098268508911, -0.42121636867523193, -1000.7359008789062, 0.19339728355407715, 1.531158447265625, 0.32428741455078125, -0.13970327377319336, 0.14395225048065186, -5.294506072998047, 0.9340598583221436, -2.4143729209899902, -6.467567443847656, 0.3053441047668457, -0.3920097351074219, 0.3759617805480957, -0.8192445039749146, 1.7087507247924805, -0.3054230809211731, -1.2477188110351562, 1.016108512878418, 0.1251811981201172, 0.19791030883789062, 0.27248525619506836, 0.7325267791748047, -3.104973316192627, -4.055852890014648, -1.8272371292114258, 1.481966495513916, -0.7276322841644287, 1.1999213695526123, 1.7435884475708008, -8.493488311767578, -1.2651400566101074, -0.2263031005859375, -0.12539100646972656, -0.8190536499023438, -0.9371328353881836, 0.017124176025390625, 0.8547163009643555, -0.9405279159545898, 1.2789583206176758, 0.3141796588897705, -1.1568565368652344, -1.2331390380859375, 0.00846719741821289, -0.6128365993499756, -0.5729265213012695, 1.169985294342041, 1.0076780319213867, 0.39785194396972656, -2.709158182144165, 0.019741058349609375, -1.6513195037841797, 0.708280086517334, -1.4747085571289062, -0.5242176055908203, 0.517878532409668, -4.1959991455078125, -2.2578563690185547, -0.2588839530944824, 0.03713226318359375, 1.4210224151611328, 0.00846719741821289, -0.44296789169311523, 0.9358615875244141, -1.843846321105957, 2.5017929077148438, 1.3135299682617188, 0.7704367637634277, 1.175551414489746, 0.6735267639160156, -0.4601325988769531, -0.4085683822631836, 0.24847793579101562, -1.1719794273376465, 0.1275320053100586, 0.8558797836303711, 0.34574365615844727, 0.11853694915771484, 0.6732850074768066, 1.1405329704284668, 0.3420705795288086, 0.08667755126953125, -2.517335891723633, 0.9831695556640625, 1.4095549583435059, 2.351923942565918, 1.0880146026611328, -0.4085683822631836, 1.7523579597473145, -1.9463844299316406, -0.37114715576171875, 0.13417887687683105, 0.927278995513916, 0.4587411880493164, -0.7625436782836914, 7.32386589050293, -0.42976444959640503, 1.9846391677856445, 1.041522741317749, 2.1969032287597656, -0.9716320037841797, 1.027493953704834, 2.197493076324463, -1.9351158142089844, -1.0314302444458008, 0.2980344295501709, -0.8548336029052734, 0.4307899475097656, 0.21258926391601562, 0.7986390590667725, -0.31771373748779297, -0.3728351593017578, -7.755496025085449, 0.0445401668548584, 1.793142318725586, 0.8002166748046875, 0.232574462890625, -0.5251849889755249, 1.0428118705749512, 0.5339846611022949, -0.3079862594604492, 1.2234630584716797, -0.9109134674072266, -0.48152828216552734, -1.4594142436981201, 0.41833698749542236, -1.8979568481445312, -7.114927768707275, -11.187691688537598, -10.127934455871582, -0.4394392967224121, 0.11299705505371094, 2.9929356575012207, -0.22193527221679688, 0.59295654296875, -0.5264567136764526, 0.6643695831298828, 0.9995861053466797, -1.722055435180664, -10.716015815734863, 1.9174566268920898, -0.8197999000549316, 1.956824779510498, 0.6470680236816406, 1.0690317153930664, -0.4394392967224121, 0.2689399719238281, 0.6296586990356445, -0.5055246353149414, 0.28629541397094727, -0.9447498321533203, 0.7251558303833008, 0.6004643440246582, 0.5872707366943359, -0.47888946533203125, -0.03791522979736328, -4.575523376464844, -1.142242431640625, 1.3280882835388184, 0.1321582794189453, -2.192229747772217, 1.2527154684066772], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 173040, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 173040, "last_target_update_ts": 47104, "num_target_updates": 91}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -122.43601839698852, "episode_len_mean": 279.9, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903], "episode_lengths": [351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5250865851361076, "mean_inference_ms": 23.76315940949532, "mean_action_processing_ms": 0.1381066256811792, "mean_env_wait_ms": 4.156344668688004, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -122.43601839698852, "episode_len_mean": 279.9, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-362.8177114799619, -257.126959875226, -254.86614605784416, -386.35554149001837, -215.04156755656004, -422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903], "episode_lengths": [351, 343, 337, 374, 314, 393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5250865851361076, "mean_inference_ms": 23.76315940949532, "mean_action_processing_ms": 0.1381066256811792, "mean_env_wait_ms": 4.156344668688004, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 173040, "num_env_steps_sampled": 47104, "num_env_steps_trained": 173040, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 47104, "agent_timesteps_total": 47104, "timers": {"training_iteration_time_ms": 341.987, "learn_time_ms": 78.762, "learn_throughput": 3047.174, "synch_weights_time_ms": 20.188}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 173040, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 173040, "last_target_update_ts": 47104, "num_target_updates": 91}, "done": false, "episodes_total": 153, "training_iteration": 46, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-21-47", "timestamp": 1655500907, "time_this_iter_s": 5.5030176639556885, "time_total_s": 244.69399642944336, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 244.69399642944336, "timesteps_since_restore": 0, "iterations_since_restore": 46, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.612499999999997, "ram_util_percent": 64.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -7.240514278411865, "min_q": -53.777549743652344, "max_q": 33.946868896484375, "mean_td_error": -0.9493328332901001}, "td_error": [-6.4650983810424805, -0.6322331428527832, -0.7725753784179688, -0.05620574951171875, 1.5858864784240723, -2.7830114364624023, 0.3309059143066406, -0.8911933898925781, -0.17735671997070312, -1.4522905349731445, -0.16100120544433594, -1.5903844833374023, -0.4236605167388916, 2.3233869075775146, -5.6905059814453125, -0.016655445098876953, -7.352516174316406, 0.014828205108642578, -0.24022388458251953, -0.01371002197265625, -6.989595890045166, -0.37398433685302734, -0.9348788261413574, 1.631361484527588, 0.38440561294555664, -0.1619863510131836, -1.1007938385009766, -1.200033187866211, 0.38419675827026367, 0.17034637928009033, 6.0976972579956055, -6.626430511474609, -1.1429271697998047, -1.551234245300293, -5.124823570251465, -0.01807117462158203, -0.18400812149047852, 0.5878086090087891, 0.5875437259674072, -0.535576343536377, -0.8287625312805176, -5.531193256378174, -1.8162212371826172, 0.1373591423034668, -0.8220776319503784, -1.4799880981445312, -0.41729736328125, -1.3160057067871094, -0.24158859252929688, -0.5806350708007812, 0.26819872856140137, 0.8032960891723633, -2.208251953125, -0.39546966552734375, 0.012264251708984375, 0.5670355558395386, -0.8142204284667969, -1.6006965637207031, -0.5049629211425781, 0.10029315948486328, 0.970768928527832, 0.8326997756958008, 1.3294453620910645, 0.3466148376464844, -6.570486068725586, 0.37482452392578125, -0.48453760147094727, 1.1570749282836914, -2.4621477127075195, -0.25702476501464844, 0.6302542686462402, -0.28267478942871094, -2.194861888885498, 0.9862773418426514, -0.5498600006103516, -0.9137172698974609, -0.06299591064453125, 2.1421709060668945, -0.4721870422363281, -1.703598976135254, -0.6645793914794922, 0.16000938415527344, -1.3821144104003906, -0.19823884963989258, -11.813610076904297, -7.051416397094727, 1.269632339477539, -0.30035400390625, 0.539700984954834, -0.0497894287109375, 0.4831273555755615, -1.7149057388305664, 0.4131430387496948, 0.250821590423584, -0.52813720703125, -0.5311412811279297, -0.29651641845703125, -0.9807558059692383, -0.41802978515625, -2.3327550888061523, -0.9075069427490234, 1.772463321685791, -8.994952201843262, -0.27957820892333984, -0.20564699172973633, -1.971445083618164, -0.24009132385253906, -1.9807052612304688, -0.9113048315048218, -0.4649085998535156, -3.4110050201416016, -0.9277362823486328, 0.03167247772216797, 1.203385353088379, 0.979961633682251, 1.3933043479919434, -2.215892791748047, 0.10193634033203125, -0.24022293090820312, 1.741011619567871, -8.240683555603027, -1.6098432540893555, -1.399993896484375, -2.182425022125244, 1.3735170364379883, -9.8154296875, 1.4374315738677979, -7.882596969604492, 1.838383674621582, -6.315912246704102, -1.1584663391113281, -6.817972183227539, -1.59856116771698, -1.2707300186157227, -0.6649055480957031, -0.7775182723999023, -7.747788429260254, -11.471912384033203, 2.4909286499023438, -0.46843433380126953, -0.5193500518798828, 0.6255183219909668, 1.9590705633163452, 0.19667816162109375, 0.028911590576171875, 0.8305454254150391, 0.8182840347290039, 0.12076187133789062, -0.42137622833251953, -2.3855738639831543, -1.7149983644485474, -1.9988937377929688, -0.5296525955200195, 0.3037506341934204, 0.3257102966308594, -0.0010051727294921875, -0.2034306526184082, -0.2476215362548828, -0.899754524230957, -0.6486740112304688, 0.9358787536621094, -1.3392143249511719, -0.34920406341552734, 0.3803391456604004, 1.4021224975585938, 0.991701602935791, 0.3269538879394531, 2.4347057342529297, -1.1732902526855469, -1.9557647705078125, -0.5318679809570312, 0.6302719116210938, -0.16010427474975586, 1.3841252326965332, -0.8758540153503418, -0.8675093650817871, -2.1794166564941406, -1.7145214080810547, -0.2526206970214844, -0.653019905090332, 0.18997478485107422, -0.6858882904052734, 0.0196685791015625, -4.0771942138671875, -0.17687702178955078, 0.13483905792236328, -1.006765365600586, 1.1313509941101074, -1.051401138305664, -8.762663841247559, -0.1492605209350586, -0.4063606262207031, 0.9035356044769287, 0.32196617126464844, -0.4721870422363281, -0.37410449981689453, -0.33579158782958984, 0.559337854385376, -0.18400812149047852, -0.15852832794189453, -1.9582014083862305, -0.4876518249511719, -0.6067043542861938, -0.9464397430419922, -0.7308425903320312, -0.738584041595459, -0.40523719787597656, 3.986846923828125, -1.3117542266845703, -0.1490156650543213, -0.12260174751281738, -3.274595260620117, -3.002470016479492, -9.501046180725098, -0.9593086242675781, 0.1597156524658203, 0.09375476837158203, -0.3247784376144409, -0.9847297668457031, 0.03378486633300781, 0.10097980499267578, 0.41020631790161133, 1.2725601196289062, -0.41729736328125, -6.885926246643066, 0.20678424835205078, -1.165632724761963, 0.6902694702148438, -1.489539623260498, -4.8643646240234375, -1.47308349609375, -4.592292785644531, -0.45355224609375, 3.426771640777588, -1.6070785522460938, -0.8431673049926758, 1.1812477111816406, 0.5509738922119141, -0.34590864181518555, -0.4306507110595703], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 176880, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 176880, "last_target_update_ts": 48128, "num_target_updates": 93}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -111.89329296819865, "episode_len_mean": 275.45, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502], "episode_lengths": [393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5265174078168965, "mean_inference_ms": 23.76920513585372, "mean_action_processing_ms": 0.13730322390757585, "mean_env_wait_ms": 4.161394592618993, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -111.89329296819865, "episode_len_mean": 275.45, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-422.2727753967047, -348.77846996486187, -79.34644269943237, -503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502], "episode_lengths": [393, 362, 263, 400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5265174078168965, "mean_inference_ms": 23.76920513585372, "mean_action_processing_ms": 0.13730322390757585, "mean_env_wait_ms": 4.161394592618993, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 176880, "num_env_steps_sampled": 48128, "num_env_steps_trained": 176880, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 48128, "agent_timesteps_total": 48128, "timers": {"training_iteration_time_ms": 363.931, "learn_time_ms": 79.366, "learn_throughput": 3023.948, "synch_weights_time_ms": 20.589}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 176880, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 176880, "last_target_update_ts": 48128, "num_target_updates": 93}, "done": false, "episodes_total": 158, "training_iteration": 47, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-21-53", "timestamp": 1655500913, "time_this_iter_s": 5.636147499084473, "time_total_s": 250.33014392852783, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 250.33014392852783, "timesteps_since_restore": 0, "iterations_since_restore": 47, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.3, "ram_util_percent": 65.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.855866432189941, "min_q": -54.69993591308594, "max_q": 30.603775024414062, "mean_td_error": -0.6537684202194214}, "td_error": [0.5426101684570312, -5.192955017089844, -8.843559265136719, 1.3493261337280273, 0.12041902542114258, -1.1340303421020508, -2.562769651412964, -0.7966904640197754, 0.5673274993896484, -0.7275562286376953, 0.05586051940917969, -1.6922712326049805, -0.10624313354492188, -0.3816767930984497, 0.762908935546875, 0.5227565765380859, 2.008289337158203, -1.4802021980285645, -0.7086727619171143, -0.9312629699707031, -0.5285457372665405, 0.31002163887023926, -1.320803165435791, -3.0810699462890625, 0.3581352233886719, -0.10658645629882812, 0.03091907501220703, 0.042694091796875, -1.6503452062606812, 1.684469223022461, 2.265575408935547, -0.7076797485351562, -0.023725509643554688, -0.30117130279541016, 0.7083654403686523, -1.7905597686767578, -1.579620361328125, 0.7962164878845215, 0.5000957250595093, 1.0628719329833984, 0.6117839813232422, -6.875664710998535, -0.6081466674804688, -6.951509952545166, -1.3236026763916016, -0.508209228515625, -6.086970806121826, -0.5181198120117188, -5.896995544433594, -0.46129417419433594, 1.07373046875, 0.3598670959472656, -0.20740509033203125, 0.5328197479248047, 0.06343841552734375, 0.30055809020996094, -3.360607147216797, 0.12609434127807617, -7.818819999694824, -5.265483856201172, 0.03906679153442383, -0.0712594985961914, 0.8473844528198242, 0.6182403564453125, -0.15616512298583984, -0.5557155609130859, -0.4249858856201172, 0.44294190406799316, 2.4965476989746094, 1.2669322490692139, -0.5752830505371094, -1.3000600337982178, -0.49215126037597656, 1.021982192993164, -0.8713831901550293, -0.270721435546875, -0.8138198852539062, -1.1368484497070312, 0.23519587516784668, 0.7338988780975342, 2.9460830688476562, 0.5211293697357178, -0.9930884838104248, -0.3332850933074951, 0.14426612854003906, -0.1996612548828125, 1.6247787475585938, 0.21694278717041016, -4.188577651977539, -5.724452018737793, -1.804460048675537, 0.10809600353240967, 1.2440762519836426, 0.6906852722167969, -11.696891784667969, -5.892190933227539, -9.730842590332031, -6.9623260498046875, -0.3602724075317383, -5.007246017456055, 1.028167724609375, -0.9178638458251953, -1.4994707107543945, 0.01944732666015625, 0.8202238082885742, -0.7029581069946289, -1.0692253112792969, -0.40862369537353516, 0.29071855545043945, -0.08556175231933594, 0.9991302490234375, 0.28738880157470703, -0.019983291625976562, 1.3702116012573242, 2.3038902282714844, -1.3107402324676514, -1.447871208190918, -0.4249858856201172, 1.0703563690185547, -0.37290579080581665, -6.536101341247559, -0.8249483108520508, -0.03584098815917969, 0.7925262451171875, -0.5822868347167969, 2.7585954666137695, 0.5908660888671875, 2.5266966819763184, -24.221773147583008, 0.13007259368896484, 1.1558189392089844, 1.022993803024292, -0.5667591094970703, 0.45172119140625, -0.9279499053955078, -0.6522339582443237, -0.611912727355957, 0.41748905181884766, 0.44588708877563477, -0.2581901550292969, 0.41910862922668457, -2.1353988647460938, -1.3707475662231445, 0.36882877349853516, -0.6998958587646484, -0.5351588726043701, 0.2346973419189453, 1.5848841667175293, 0.5433878898620605, 0.6343040466308594, 1.765817642211914, -0.9407119750976562, -2.224405288696289, -8.347467422485352, 0.3706626892089844, 1.5566635131835938, 1.2165050506591797, 0.2545332908630371, 2.2219626903533936, -0.8951663970947266, -1.6411056518554688, 0.9635958671569824, 0.134907066822052, 0.29258060455322266, 0.23519587516784668, 0.49788761138916016, 1.8561410903930664, 1.710693359375, 0.5594711303710938, -0.9667253494262695, -6.616839408874512, 0.6343040466308594, 1.2066898345947266, -0.41425323486328125, 0.7213649749755859, -1.5545353889465332, -4.037087440490723, -1.4336457252502441, 1.3734941482543945, -0.8416528701782227, -2.385664939880371, 0.7628583908081055, 2.008289337158203, 0.20640945434570312, -2.410076141357422, 0.6109943389892578, 0.3385932445526123, 0.40473175048828125, 0.2150249481201172, -7.727741241455078, 0.288402795791626, -0.49066734313964844, 1.4387149810791016, 1.7661666870117188, -0.5868988037109375, 1.0064191818237305, -0.7537736892700195, -0.3843522071838379, 0.23366451263427734, 0.49443817138671875, -0.08271408081054688, 1.959303855895996, 0.18090438842773438, -0.24953460693359375, 1.0319910049438477, -0.9156990051269531, 0.05156254768371582, 0.21883773803710938, -0.36794209480285645, 0.4184455871582031, -1.9025475978851318, 1.2503395080566406, 1.6344470977783203, -0.18724536895751953, 0.3103792667388916, -1.8931636810302734, 1.1334114074707031, 1.199615478515625, -0.2581901550292969, -2.445460319519043, -0.257121741771698, 0.8587172031402588, -9.739607810974121, 1.1134910583496094, 0.8695201873779297, 1.1035127639770508, -1.2397232055664062, 0.5568971633911133, -6.360374450683594, 1.2177810668945312, -0.26962757110595703, 2.671548843383789, 1.3117523193359375, 3.350253105163574, 0.16598892211914062, 0.8917713165283203, -1.7630748748779297, 0.1294689178466797, 0.52890944480896, -0.7365550994873047], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 180720, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 180720, "last_target_update_ts": 49152, "num_target_updates": 95}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -111.6263258381933, "episode_len_mean": 274.64, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302], "episode_lengths": [400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5271941341865632, "mean_inference_ms": 23.803637341042155, "mean_action_processing_ms": 0.13746029425024994, "mean_env_wait_ms": 4.16838746857764, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -111.6263258381933, "episode_len_mean": 274.64, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-503.81830156594515, -289.8085679113865, 16.72385536134243, -65.34692863374949, -84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302], "episode_lengths": [400, 363, 245, 269, 276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5271941341865632, "mean_inference_ms": 23.803637341042155, "mean_action_processing_ms": 0.13746029425024994, "mean_env_wait_ms": 4.16838746857764, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 180720, "num_env_steps_sampled": 49152, "num_env_steps_trained": 180720, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 49152, "agent_timesteps_total": 49152, "timers": {"training_iteration_time_ms": 340.338, "learn_time_ms": 79.562, "learn_throughput": 3016.508, "synch_weights_time_ms": 21.388}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 180720, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 180720, "last_target_update_ts": 49152, "num_target_updates": 95}, "done": false, "episodes_total": 161, "training_iteration": 48, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-21-59", "timestamp": 1655500919, "time_this_iter_s": 5.485508918762207, "time_total_s": 255.81565284729004, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 255.81565284729004, "timesteps_since_restore": 0, "iterations_since_restore": 48, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.549999999999997, "ram_util_percent": 65.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.654655933380127, "min_q": -50.46935272216797, "max_q": 34.665470123291016, "mean_td_error": -13.177648544311523}, "td_error": [0.5754528045654297, -0.07329940795898438, -0.8145241737365723, -0.4552628993988037, -1.7466201782226562, -0.8595566749572754, 1.474654197692871, 1.022080421447754, -0.49068450927734375, -1.5921306610107422, 1.3315800428390503, -5.052251815795898, 0.788805365562439, 4.345706462860107, -0.12047386169433594, -1.2641963958740234, 0.8763132095336914, -1.1919002532958984, -0.12329864501953125, 0.24945616722106934, 0.11798858642578125, 1.4090499877929688, 2.72641921043396, 0.4882345199584961, -4.3747758865356445, -0.9724330902099609, -2.116720199584961, -6.583161354064941, 0.7585192322731018, 0.027130126953125, -5.728692054748535, -4.7567596435546875, -0.9133520126342773, -0.33230018615722656, 4.748198509216309, -0.5403671264648438, 0.1263706386089325, -0.35109853744506836, -0.2949104309082031, 1.820366621017456, -3.3023252487182617, -1.375192642211914, 0.9846219420433044, 1.3025493621826172, 1.6617553234100342, -3.3023252487182617, -9.328672409057617, 0.13824939727783203, 1.0680222511291504, -0.5540533065795898, -7.428637981414795, -1.9921140670776367, 0.9025848507881165, 0.005372047424316406, 0.4502096176147461, -0.2225799560546875, 2.4249114990234375, -2.297687530517578, 0.9007625579833984, 2.667478561401367, -0.51922607421875, -2.2389907836914062, -1.3256160020828247, -0.8018789291381836, -0.02178668975830078, -1.191026210784912, 1.6776561737060547, 0.019460678100585938, -0.06222271919250488, -0.8645472526550293, -0.4153175354003906, 0.45677757263183594, -0.21525096893310547, -0.2865767478942871, -7.970396041870117, 0.31984710693359375, 0.11839771270751953, 1.2840933799743652, -2.3126564025878906, -1.3712902069091797, -0.9982051849365234, -0.42644238471984863, 0.4151420593261719, -0.3443450927734375, -1.7250993251800537, -1.1648979187011719, 0.8015538454055786, 0.8070054054260254, 0.9284496307373047, -5.715984344482422, 0.4482450485229492, -0.3356647491455078, 0.6765298843383789, -1.1134033203125, -5.222592830657959, -0.5510196685791016, -0.5055539608001709, -0.9479150772094727, 0.6349639892578125, 1.8583621978759766, -0.3448143005371094, 0.8328642845153809, 1.7347412109375, -0.7804536819458008, 0.6184654235839844, 1.1514835357666016, -0.9087514877319336, -999.0869750976562, 0.24852848052978516, 0.9652214050292969, 0.6156086921691895, 9.780115127563477, -1.219217300415039, -0.23589134216308594, 0.7465801239013672, 3.200101375579834, 0.11660885810852051, -1.2531967163085938, 1.6338615417480469, 0.04477882385253906, 1.2288652658462524, -0.8145241737365723, 0.24743986129760742, 0.4291849136352539, -1.6279547214508057, -1.0067386627197266, -22.912841796875, 2.3913116455078125, 2.602045774459839, -0.668339729309082, -2.125789165496826, 0.09342622756958008, -0.1301727294921875, -0.5302097797393799, 0.6325769424438477, 0.027896881103515625, 2.387300491333008, -0.3400726318359375, -1.0490989685058594, -0.5674757957458496, 0.27306127548217773, 0.3209347724914551, -0.7623777389526367, 0.037878990173339844, -999.0869750976562, 0.27943217754364014, -1.4672517776489258, -0.9555234909057617, -18.22611427307129, -5.2835588455200195, 0.21654319763183594, -0.01932239532470703, 1.1008174419403076, -0.5602455139160156, -3.1508498191833496, -1.2518062591552734, -11.286450386047363, -2.054337501525879, -2.3413963317871094, -0.7765922546386719, -0.2324047088623047, -6.656502723693848, -1.2210960388183594, -0.462604284286499, -10.954869270324707, -1.0588226318359375, -0.8696002960205078, -1.1038665771484375, 1.737741470336914, 0.3285942077636719, 1.2011847496032715, -0.16880273818969727, -1.3503398895263672, -0.750152587890625, 0.5930299758911133, 0.36956238746643066, -1.7438421249389648, -1.259397029876709, 2.5818161964416504, 0.9846219420433044, -0.9366474151611328, -2.3870668411254883, -0.3185427188873291, -4.220197677612305, -0.8917651176452637, -2.2487030029296875, -1.3805265426635742, 0.7255063056945801, -0.20800018310546875, -1.1990337371826172, -0.2374858856201172, -1.1353874206542969, 0.018976211547851562, 0.49266576766967773, 1.8203802108764648, 0.654998779296875, -1.656707763671875, 0.36368227005004883, -0.26046156883239746, -0.5409221649169922, -0.4006633758544922, -0.37688255310058594, -5.539165496826172, -1.8007164001464844, 0.4222249984741211, -0.0467376708984375, -1.0464811325073242, -999.0869750976562, 0.2783374786376953, 1.017333984375, -12.138958930969238, 0.9434127807617188, -0.4364643096923828, -1.3984994888305664, 0.9383004903793335, 2.0690975189208984, 0.1346421241760254, -0.6218338012695312, 0.29013872146606445, -0.1249532699584961, 0.7435297966003418, -1.0608634948730469, 0.8464641571044922, -2.8815383911132812, 0.8360271453857422, -1.2731389999389648, 1.2263071537017822, -9.550966262817383, -0.3166675567626953, 0.16961506009101868, -0.007015228271484375, 3.486440658569336, -0.4586524963378906, -0.5974369049072266, 2.1124749183654785, 0.8479200601577759, 2.147684097290039, -0.14000701904296875, -2.4883506298065186, 6.456988334655762], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 184560, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 184560, "last_target_update_ts": 50176, "num_target_updates": 97}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -105.61283105112612, "episode_len_mean": 271.7, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361], "episode_lengths": [276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5279330771382879, "mean_inference_ms": 23.81650342904621, "mean_action_processing_ms": 0.13721518639665736, "mean_env_wait_ms": 4.171228075027619, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -105.61283105112612, "episode_len_mean": 271.7, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-84.96065376698971, -335.59824638813734, -39.70997078716755, -76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361], "episode_lengths": [276, 346, 246, 277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5279330771382879, "mean_inference_ms": 23.81650342904621, "mean_action_processing_ms": 0.13721518639665736, "mean_env_wait_ms": 4.171228075027619, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 184560, "num_env_steps_sampled": 50176, "num_env_steps_trained": 184560, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 50176, "agent_timesteps_total": 50176, "timers": {"training_iteration_time_ms": 332.925, "learn_time_ms": 79.169, "learn_throughput": 3031.481, "synch_weights_time_ms": 21.266}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 184560, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 184560, "last_target_update_ts": 50176, "num_target_updates": 97}, "done": false, "episodes_total": 165, "training_iteration": 49, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-22-05", "timestamp": 1655500925, "time_this_iter_s": 5.489603519439697, "time_total_s": 261.30525636672974, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 261.30525636672974, "timesteps_since_restore": 0, "iterations_since_restore": 49, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.900000000000002, "ram_util_percent": 65.41250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.362295150756836, "min_q": -53.76677703857422, "max_q": 33.89936447143555, "mean_td_error": -0.4670632481575012}, "td_error": [-0.4181264638900757, -0.11543083190917969, 0.21204054355621338, 0.35181713104248047, 0.9597854614257812, -1.7788715362548828, -3.9993600845336914, -0.3207101821899414, -1.5010547637939453, 0.27111053466796875, 1.6528568267822266, -1.5786266326904297, 0.6536931991577148, 0.2986936569213867, 0.10266590118408203, -0.1745452880859375, 0.9981803894042969, 0.20484387874603271, 0.14413616061210632, 0.7682285308837891, 0.6029539108276367, 0.9836429357528687, -0.40970373153686523, 0.7093234062194824, -1.7474956512451172, 0.3333110809326172, 0.44175243377685547, -0.44711533188819885, -0.3897438049316406, 2.28853702545166, -1.7149810791015625, 0.5899903774261475, -0.004268646240234375, 0.7524795532226562, -3.9163103103637695, -1.255312204360962, -0.3263359069824219, 2.428831100463867, 0.36915266513824463, 0.5262622833251953, -3.900003433227539, 0.4645576477050781, -0.3144111633300781, 1.887746810913086, 0.9445743560791016, -4.754057884216309, -0.9245618581771851, 0.8730318546295166, 1.9348020553588867, -0.543696403503418, 0.5408334732055664, -1.2166862487792969, -3.790904998779297, -2.4918346405029297, -0.44692420959472656, 1.1307287216186523, -0.7585716247558594, 2.7315969467163086, 0.4586503505706787, -0.5908622741699219, -0.9633326530456543, -0.036756277084350586, -0.02450084686279297, -3.7001304626464844, -7.216567516326904, 0.8298721313476562, -5.560140132904053, 8.995012283325195, 0.8677091598510742, -5.703455924987793, 0.6366071701049805, -0.48282814025878906, 0.6308059692382812, -1.1797904968261719, -0.005672454833984375, -0.5344184637069702, -0.26694726943969727, -0.5093955993652344, 0.6842250823974609, 0.7715587615966797, 0.16849613189697266, 1.0687255859375, -0.5013236999511719, 2.7748749256134033, 0.4810669422149658, 0.36586952209472656, -0.17624664306640625, -0.9876670837402344, -0.0008058547973632812, -0.07429313659667969, -0.6666908264160156, -0.33333778381347656, -4.154314041137695, -1.9852104187011719, 1.1539645195007324, -0.9593677520751953, 0.7868061065673828, -0.4036884307861328, -8.645946502685547, 0.16289520263671875, -1.1425375938415527, 0.16985169053077698, -0.20105361938476562, 1.0941104888916016, -0.010455131530761719, 1.3417621850967407, -1.0454216003417969, -0.5948445796966553, -0.2691316604614258, -2.919208526611328, 4.752973556518555, -0.5932350158691406, 0.35688161849975586, 0.44503211975097656, 1.2105369567871094, 1.1845343112945557, -0.3310856223106384, -1.1041889190673828, 0.7106990814208984, -1.6275897026062012, -0.9427757263183594, 0.45639610290527344, -0.8912193775177002, 0.47553491592407227, 0.13172197341918945, 0.06347978115081787, 2.200284004211426, -1.115788459777832, 0.3213663101196289, -1.1645088195800781, 1.4671189785003662, -0.13106924295425415, 0.7461090087890625, -0.16925811767578125, -0.3237590789794922, 0.7549660801887512, 0.21147727966308594, 0.064422607421875, 0.24314212799072266, -0.0750131607055664, -0.8557472229003906, 0.12841224670410156, -2.1455631256103516, -0.8017349243164062, -0.44213104248046875, 2.2034473419189453, -0.3777313232421875, -0.2547229528427124, 0.49607086181640625, 0.2528437077999115, -0.04392099380493164, -3.3331661224365234, -0.08909225463867188, -0.24880123138427734, -0.4739646911621094, -6.819438934326172, -1.1657319068908691, 1.2100462913513184, 1.4023714065551758, 0.8048744201660156, 0.8789246082305908, -0.9074831008911133, 0.13992881774902344, 0.14265775680541992, -0.06313514709472656, -0.31023406982421875, -1.0209784507751465, -0.7611875534057617, 1.495513916015625, -0.6493749618530273, -7.538549423217773, -7.093171119689941, 1.3895750045776367, -0.20697021484375, 0.2979412078857422, 0.9831199645996094, 1.0237598419189453, -2.501549243927002, -2.584225654602051, -1.1299772262573242, -0.07118469476699829, -2.951536178588867, 0.03457450866699219, -6.1869940757751465, -0.2791118621826172, -2.0554771423339844, -1.9817347526550293, 0.15685558319091797, 0.35172271728515625, 0.9284915924072266, -1.2903680801391602, 0.3877706527709961, 1.5185699462890625, -0.6825966835021973, -0.5469970703125, -0.647578239440918, 1.7647218704223633, -1.2398872375488281, -0.18448448181152344, -0.47150135040283203, 0.2409266233444214, 0.18469810485839844, -0.49240970611572266, -5.861922264099121, 0.851682186126709, -0.9376258850097656, 0.2702987492084503, 0.7353670597076416, 2.0028953552246094, 0.7050392627716064, 0.00726318359375, 0.43067169189453125, -21.182098388671875, 1.360952377319336, -0.8384199142456055, 0.8595170974731445, -0.5298490524291992, 0.49973392486572266, 0.04204750061035156, -6.3634033203125, -0.02239990234375, -0.4857492446899414, 0.4228191375732422, -1.1896228790283203, -0.3734588623046875, -0.20764923095703125, 3.977628707885742, -0.7563152313232422, 1.091181755065918, -0.6937360763549805, 0.6606502532958984, -0.18697261810302734, -0.5742959976196289, -1.124359130859375, 0.07479476928710938, -0.32190608978271484, -6.546518325805664, -1.9963302612304688, -0.28177833557128906, 0.03308975696563721], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 188400, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 188400, "last_target_update_ts": 51200, "num_target_updates": 99}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -103.60864042058587, "episode_len_mean": 270.38, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605], "episode_lengths": [277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266906222671497, "mean_inference_ms": 23.839633126615933, "mean_action_processing_ms": 0.13692387909414452, "mean_env_wait_ms": 4.175647527969599, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -103.60864042058587, "episode_len_mean": 270.38, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-76.32025463879108, 10.395210653543472, -44.602618008852005, -70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605], "episode_lengths": [277, 247, 239, 278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266906222671497, "mean_inference_ms": 23.839633126615933, "mean_action_processing_ms": 0.13692387909414452, "mean_env_wait_ms": 4.175647527969599, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 188400, "num_env_steps_sampled": 51200, "num_env_steps_trained": 188400, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 51200, "agent_timesteps_total": 51200, "timers": {"training_iteration_time_ms": 344.221, "learn_time_ms": 79.347, "learn_throughput": 3024.67, "synch_weights_time_ms": 20.588}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 188400, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 188400, "last_target_update_ts": 51200, "num_target_updates": 99}, "done": false, "episodes_total": 168, "training_iteration": 50, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-22-10", "timestamp": 1655500930, "time_this_iter_s": 5.42626428604126, "time_total_s": 266.731520652771, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 266.731520652771, "timesteps_since_restore": 0, "iterations_since_restore": 50, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 30.5625, "ram_util_percent": 65.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.24791431427002, "min_q": -52.17483139038086, "max_q": 31.599706649780273, "mean_td_error": -0.7615145444869995}, "td_error": [0.6928702592849731, -0.17761516571044922, 1.4732704162597656, -2.795381546020508, -3.9366626739501953, 0.0494997501373291, 0.7163963317871094, -6.946022033691406, 1.0785274505615234, 0.29384422302246094, 1.015633225440979, -22.060081481933594, 0.29033756256103516, 0.23260116577148438, -7.083357334136963, -1.5331639051437378, -0.5210695266723633, 0.9556179046630859, -0.6477451324462891, -0.11579036712646484, -0.989466667175293, 0.3149210810661316, 0.2748984396457672, -0.9968323707580566, -6.5255608558654785, 0.47011756896972656, 1.4732704162597656, -0.6636581420898438, -0.7644534111022949, -1.41949462890625, -4.328787803649902, -3.186573028564453, -0.851557731628418, 1.8279533386230469, 0.5453624725341797, -0.3312091827392578, 1.3006463050842285, 0.4084663391113281, -0.3926912844181061, 0.11918997764587402, -0.39215242862701416, 0.271848201751709, 1.6669063568115234, 0.8252692222595215, -9.760455131530762, 0.6012157797813416, 1.5763206481933594, 1.5487360954284668, -1.1704797744750977, 0.9556179046630859, -0.22913742065429688, -0.6700814962387085, 0.058373451232910156, 1.3484554290771484, -1.1271123886108398, 0.3004131317138672, 0.044513702392578125, -0.3694424629211426, -0.6858863830566406, 0.059925079345703125, 0.9673962593078613, 2.144458532333374, -0.6672405004501343, 1.4732704162597656, -0.4446296691894531, -1.8487157821655273, -1.5710535049438477, -1.6989288330078125, -6.8353776931762695, -0.28258705139160156, -1.1785287857055664, 0.6175270080566406, 0.5855797529220581, 0.11396026611328125, 0.5344946384429932, 0.3016166687011719, -0.382796049118042, 0.4599452018737793, 0.8683338165283203, -1.4896478652954102, 0.3536062240600586, -0.07429027557373047, -0.7386474609375, 0.04382944107055664, 1.1558551788330078, -0.6690266132354736, -0.4570748805999756, -0.8841097354888916, -1.2595583200454712, -7.898019790649414, 0.41897010803222656, 0.2896442413330078, -6.48030948638916, -0.03564655780792236, 0.5059318542480469, 1.2215614318847656, -3.0293445587158203, -4.166387557983398, -3.8479671478271484, 0.16537857055664062, -0.4507502019405365, 0.30323779582977295, -0.30818653106689453, 0.499755859375, 0.5974273681640625, 0.014039993286132812, -0.0020618438720703125, 1.0938420295715332, 0.5960369110107422, -1.168182373046875, -0.02568960189819336, 0.802597165107727, -1.3984947204589844, -0.245452880859375, 0.05758976936340332, 1.2734322547912598, 0.26479530334472656, -7.062131881713867, 1.572678565979004, 0.52587890625, 2.248002052307129, 0.437713623046875, -0.04458260536193848, -1.6116740703582764, 0.5984315872192383, 0.55816650390625, -0.9240055084228516, -1.8308935165405273, 1.6782588958740234, -0.46184730529785156, -16.04656219482422, 1.3280115127563477, 4.664040565490723, -1.1268162727355957, -0.03597831726074219, -0.5238146781921387, -0.3241710662841797, 3.0123023986816406, -1.6361961364746094, 0.9163944721221924, -0.29283761978149414, -1.9599571228027344, 0.6736950874328613, 2.814250946044922, 0.932499885559082, -0.48682212829589844, -0.2015838623046875, 0.4853706359863281, 0.8104271292686462, 0.6840734481811523, 0.36824798583984375, -0.7825584411621094, 0.4164079427719116, -10.911825180053711, 0.8900260925292969, 3.634385108947754, -1.6564083099365234, -0.05521965026855469, -0.6446940898895264, 0.5954341888427734, -0.5533943176269531, -0.4756965637207031, 2.3347034454345703, 0.12057071924209595, -0.09846305847167969, -1.2125988006591797, 3.432807683944702, -0.9614120721817017, -0.6149215698242188, -1.565145492553711, 0.1965160369873047, 0.9217910766601562, 0.9217910766601562, -1.6551837921142578, 0.953521728515625, -2.079711437225342, -5.1977128982543945, -0.20984458923339844, -8.608329772949219, 0.3940601348876953, -1.5668390989303589, -0.09846305847167969, -2.780198097229004, 1.1399269104003906, -0.3763962388038635, -8.800994873046875, -0.5552279949188232, -8.635080337524414, -3.5615129470825195, -0.18941330909729004, -0.37427425384521484, -2.1494951248168945, 1.6963642835617065, -0.7010288238525391, 1.0860977172851562, -0.02572154998779297, 0.26602816581726074, -1.1754255294799805, -0.6738520860671997, -0.7214694023132324, 1.310360312461853, -6.322869300842285, 2.270343780517578, 1.1587505340576172, 0.5679717063903809, 2.814087390899658, 0.9024772644042969, -10.749186515808105, 0.4124603271484375, -1.2977228164672852, -0.8628473281860352, -1.8068021535873413, -12.432058334350586, -0.8365402221679688, 1.6332511901855469, 0.30750298500061035, 0.1547679901123047, -0.26406288146972656, 0.5110034942626953, 0.7246555089950562, -2.006521224975586, 2.3347034454345703, 0.41607898473739624, -0.632390022277832, 0.47750282287597656, -0.47393798828125, -1.3570961952209473, 0.6629617214202881, 1.8199882507324219, 0.7249202728271484, -0.892693042755127, -6.621185302734375, -1.3034801483154297, -0.28258705139160156, -6.265390396118164, -0.32190632820129395, 1.7069072723388672, -0.37381744384765625, 1.3484554290771484, 0.7054756879806519], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 192240, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 192240, "last_target_update_ts": 52224, "num_target_updates": 101}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -104.02225812330842, "episode_len_mean": 270.34, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841], "episode_lengths": [278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275521895847781, "mean_inference_ms": 23.838506209440048, "mean_action_processing_ms": 0.13621790232430886, "mean_env_wait_ms": 4.177456297090454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -709.3029132932425, "episode_reward_mean": -104.02225812330842, "episode_len_mean": 270.34, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-70.34951275587082, -94.6607560440898, -79.65239299833775, -51.54401759803295, -190.2612705603242, -93.26650843769312, -320.3398096859455, -428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841], "episode_lengths": [278, 229, 254, 227, 308, 269, 359, 386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275521895847781, "mean_inference_ms": 23.838506209440048, "mean_action_processing_ms": 0.13621790232430886, "mean_env_wait_ms": 4.177456297090454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 192240, "num_env_steps_sampled": 52224, "num_env_steps_trained": 192240, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 52224, "agent_timesteps_total": 52224, "timers": {"training_iteration_time_ms": 361.351, "learn_time_ms": 78.914, "learn_throughput": 3041.286, "synch_weights_time_ms": 21.188}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 192240, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 192240, "last_target_update_ts": 52224, "num_target_updates": 101}, "done": false, "episodes_total": 171, "training_iteration": 51, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-22-16", "timestamp": 1655500936, "time_this_iter_s": 5.521555185317993, "time_total_s": 272.253075838089, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 272.253075838089, "timesteps_since_restore": 0, "iterations_since_restore": 51, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 30.15, "ram_util_percent": 65.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.39629602432251, "min_q": -52.96367263793945, "max_q": 27.136394500732422, "mean_td_error": -0.3773692846298218}, "td_error": [-0.21557044982910156, -1.132075309753418, 0.6951217651367188, -0.9838409423828125, 1.0480098724365234, -0.24998188018798828, 0.2533245086669922, 1.1764392852783203, -0.2836134433746338, 0.5975160598754883, 0.3436126708984375, 1.6450786590576172, 0.19432687759399414, -9.67973804473877, 0.7694015502929688, -0.1968231201171875, -2.2834677696228027, -0.4303703308105469, 0.23989009857177734, 0.08194351196289062, -1.908700942993164, 0.26708984375, 0.6903457641601562, -0.7189905643463135, 2.4325222969055176, 0.31716251373291016, -14.301908493041992, 1.2924747467041016, 0.9561386108398438, -6.204540252685547, 0.46268272399902344, 1.2061293125152588, 0.7484455108642578, 0.10543370246887207, -1.830824851989746, -0.02525186538696289, 0.7294020652770996, -0.3269538879394531, -0.06088542938232422, 0.9864745140075684, 1.2359657287597656, 1.0882511138916016, -5.259060859680176, -0.4351224899291992, 2.125425338745117, -0.7417418956756592, 0.5247316360473633, -4.69364070892334, -0.2444610595703125, 0.8821525573730469, -0.12639999389648438, -0.0744866132736206, -3.335491180419922, -9.428197860717773, -0.20000362396240234, 1.8735461235046387, -0.6540627479553223, 2.266782760620117, 0.4844217300415039, 0.9595909118652344, 0.004925727844238281, -0.3472318649291992, 1.5073671340942383, 0.08292770385742188, -5.708053112030029, 2.884672164916992, 0.21312713623046875, 0.033294677734375, 0.10588884353637695, -1.1132760047912598, 1.3388786315917969, 0.8056427836418152, -0.9168777465820312, 6.651086807250977, -0.9070415496826172, 1.2165136337280273, -1.0939960479736328, 1.7601299285888672, -2.856754779815674, -0.5438313484191895, -1.280487060546875, -1.3096938133239746, -2.862381935119629, -0.38327980041503906, 2.758380889892578, 0.3254023790359497, -5.51887321472168, -0.22038555145263672, -0.337677001953125, -0.4392275810241699, -0.07554054260253906, -1.8519189357757568, -0.015158653259277344, 0.7877511978149414, -14.107379913330078, -6.092942714691162, 0.0882577896118164, 0.6074992418289185, 0.7847733497619629, -6.6103410720825195, 0.024170398712158203, 0.7281255722045898, 1.985635757446289, 1.7035083770751953, 1.829233169555664, 1.229940414428711, -0.8765950202941895, 1.096902847290039, 0.18640518188476562, -0.7722005844116211, 1.5736198425292969, -6.881671905517578, -6.994868278503418, 3.3063764572143555, 0.8924598693847656, -0.2504701614379883, 0.6795234680175781, 0.28632354736328125, 2.412600517272949, 0.9032723903656006, -5.186854362487793, 0.12203598022460938, 0.718120813369751, 0.2889721393585205, -1.019150733947754, 0.7541320323944092, -0.2888822555541992, -7.569921493530273, -1.1170458793640137, 1.010643482208252, 1.5454912185668945, -0.215545654296875, -1.4579153060913086, 0.9139165878295898, 0.9880585670471191, -0.865354061126709, -1.7799224853515625, -0.5997982025146484, 1.1048564910888672, 0.629791259765625, -1.7961046695709229, -1.7081804275512695, -6.265647888183594, 2.1386852264404297, 0.5288543701171875, 0.9601831436157227, 1.4217891693115234, 0.540041446685791, 1.1691761016845703, 0.5735442042350769, 0.08736610412597656, 0.3572869300842285, -0.09332847595214844, 2.615713596343994, 0.26664233207702637, -10.47930908203125, -0.13147211074829102, -0.4799633026123047, 0.2369518280029297, 0.30418848991394043, -0.2768009901046753, -1.25872802734375, -0.663212776184082, 2.235104560852051, 0.25118064880371094, -0.20485305786132812, 1.2840404510498047, 1.9898681640625, -0.14223086833953857, -1.889242172241211, 1.6761665344238281, 1.7097339630126953, 0.5631647109985352, 2.7379322052001953, -1.6360892057418823, -1.1939210891723633, 0.21276557445526123, 0.19275283813476562, -2.904653549194336, 0.5337467193603516, -0.3957040309906006, -1.2481849193572998, 0.9670963287353516, 1.7515089511871338, 0.6765938997268677, -1.2586402893066406, 1.3799437284469604, 0.27405819296836853, -6.497081756591797, 1.1423776149749756, 0.21331024169921875, 0.5148324966430664, 1.1938934326171875, -0.7015186548233032, -3.1140847206115723, 0.2213575839996338, 3.5573196411132812, 0.05136299133300781, 0.05040097236633301, -0.29044437408447266, 0.6910640001296997, -6.121120452880859, 1.7520368099212646, 1.753116488456726, -0.4904193878173828, 2.423290252685547, -0.030611038208007812, 1.3289399147033691, -1.9012188911437988, 0.5581703186035156, -8.098066329956055, -0.2818737030029297, 0.7650539875030518, 1.820394515991211, 0.7839640378952026, 1.5820293426513672, -0.3196086883544922, 0.9443874359130859, -1.2805941104888916, 0.7826266288757324, -0.22984027862548828, 0.8456783294677734, 2.165224075317383, -0.12821388244628906, 1.111093521118164, -0.6213617324829102, -0.10113704204559326, -9.11751937866211, 0.1865195333957672, 2.913590431213379, 0.047008514404296875, -0.0778508186340332, 1.2995738983154297, 0.6140689849853516, -0.4873638153076172, 0.6429586410522461, -0.2609708309173584, -0.014969825744628906, 0.4785146713256836, 0.4975605010986328], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 53248, "num_env_steps_trained": 196080, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 196080, "last_target_update_ts": 53248, "num_target_updates": 103}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -111.61291332021355, "episode_len_mean": 271.63, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515], "episode_lengths": [386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5288319342306014, "mean_inference_ms": 23.86966292343682, "mean_action_processing_ms": 0.13604671308260338, "mean_env_wait_ms": 4.183127937386874, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -111.61291332021355, "episode_len_mean": 271.63, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-428.3939601331949, -52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515], "episode_lengths": [386, 250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5288319342306014, "mean_inference_ms": 23.86966292343682, "mean_action_processing_ms": 0.13604671308260338, "mean_env_wait_ms": 4.183127937386874, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 196080, "num_env_steps_sampled": 53248, "num_env_steps_trained": 196080, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 53248, "agent_timesteps_total": 53248, "timers": {"training_iteration_time_ms": 357.085, "learn_time_ms": 78.204, "learn_throughput": 3068.881, "synch_weights_time_ms": 20.188}, "counters": {"num_env_steps_sampled": 53248, "num_env_steps_trained": 196080, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 196080, "last_target_update_ts": 53248, "num_target_updates": 103}, "done": false, "episodes_total": 178, "training_iteration": 52, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-22-22", "timestamp": 1655500942, "time_this_iter_s": 5.74978494644165, "time_total_s": 278.00286078453064, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 278.00286078453064, "timesteps_since_restore": 0, "iterations_since_restore": 52, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 26.325, "ram_util_percent": 65.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.398025035858154, "min_q": -54.45053482055664, "max_q": 28.497861862182617, "mean_td_error": -0.37962234020233154}, "td_error": [-1.7869186401367188, 1.580103874206543, 0.9158725738525391, 1.0065324306488037, -0.24909019470214844, -3.8103675842285156, -5.332952499389648, 1.2224931716918945, 0.22345876693725586, -1.0152740478515625, -0.8748605251312256, 1.1079578399658203, 2.0643157958984375, 0.06371307373046875, -8.230071067810059, 0.5865321159362793, -1.0107580423355103, -6.5518951416015625, 1.2234792709350586, -0.8336391448974609, 0.85699462890625, 0.8965950012207031, -0.17782878875732422, 1.0050163269042969, 1.1083335876464844, 1.1299076080322266, 1.746881365776062, -1.0108060836791992, -0.3433823585510254, 0.6204166412353516, 0.9277383089065552, 0.7164344191551208, 1.0017776489257812, -40.839595794677734, 8.668560981750488, 0.16417884826660156, 0.16970062255859375, -1.6002960205078125, 0.8260623216629028, 1.2637243270874023, -0.8149950504302979, 0.16118907928466797, 1.0432442426681519, 1.2089903354644775, -3.3624916076660156, -0.889592170715332, -0.8550624847412109, -1.9525508880615234, -1.473928451538086, -4.85496711730957, 0.5651649236679077, 1.650421142578125, -0.6151142120361328, 0.925911545753479, 1.5604796409606934, -0.09295654296875, 0.19229888916015625, 1.99822998046875, -2.315439224243164, 0.06904792785644531, 4.439074516296387, -0.13631343841552734, -12.202705383300781, 0.6454316973686218, -0.1477670669555664, -1.064640998840332, -2.309718132019043, -0.5870687961578369, -1.103043556213379, -0.1334066390991211, -0.26511573791503906, -0.5131411552429199, 2.657350540161133, 0.5979831218719482, 0.9778118133544922, -0.6056169271469116, 1.0296688079833984, -0.45193958282470703, -0.7157831192016602, 0.5905280113220215, 2.211562156677246, 1.6432666778564453, 1.5438613891601562, 0.7051213979721069, -0.1688098907470703, 1.2568721771240234, 1.1078557968139648, -1.0924429893493652, -2.403731346130371, -0.6312370300292969, -5.591846942901611, -0.3289928436279297, -2.1456458568573, -2.018723964691162, 0.7042236328125, 2.0939488410949707, 0.6375503540039062, 0.7424278259277344, 0.5636868476867676, 0.561955451965332, 0.34346529841423035, 0.2626218795776367, -2.4267501831054688, -6.913583755493164, -0.7988696098327637, 1.6151237487792969, -0.09790921211242676, -0.7206134796142578, 0.019653797149658203, 0.4797966182231903, -9.481578826904297, 1.6531600952148438, 2.294917106628418, -0.8299827575683594, 0.9835033416748047, -1.083282470703125, 0.40628671646118164, 2.6610090732574463, -0.22606849670410156, 0.21643352508544922, -0.37322235107421875, 0.9727599620819092, -1.317087173461914, 0.7501684427261353, 0.4669647812843323, 0.9949836730957031, 0.2365736961364746, 0.8356175422668457, 0.6676740050315857, -0.985992431640625, 0.3947584629058838, 1.4139204025268555, 2.6782596111297607, -0.9093112945556641, 0.6423041820526123, 0.4078502655029297, -2.060250759124756, -1.5213260650634766, 1.2072808742523193, -1.1267757415771484, -1.5387344360351562, 0.6408226490020752, -0.3726634979248047, 0.6765308380126953, -5.416292190551758, 0.6204166412353516, 0.5933618545532227, 1.5447616577148438, -0.8336391448974609, 0.8170362710952759, 0.7439966201782227, 0.19809341430664062, -0.3993072509765625, 1.4680671691894531, -0.8335013389587402, 10.74752140045166, 1.0044283866882324, -0.9288406372070312, 0.09030628204345703, -0.7772493362426758, 0.5328598022460938, 1.2883789539337158, -1.5253376960754395, 1.5140976905822754, -1.1532058715820312, 1.4502079486846924, -0.21618175506591797, 0.9065093994140625, 1.5510313510894775, 2.341615676879883, -2.060924530029297, 1.0966379642486572, 0.08675003051757812, -0.2679949998855591, 0.8255363702774048, -1.3550224304199219, 1.0848183631896973, 3.453683853149414, 1.1948904991149902, -0.8076047897338867, 0.17969226837158203, 1.8842031955718994, -7.330881595611572, -2.8191537857055664, -3.7937464714050293, 1.2960352897644043, 0.8811595439910889, 2.290158271789551, -4.974869251251221, -1.4193344116210938, -0.5035362243652344, -10.162406921386719, -7.844635486602783, 4.078799247741699, -0.045047640800476074, 0.031153202056884766, 0.2195115089416504, -0.8693633079528809, 1.162093162536621, 1.8034076690673828, -3.833756446838379, -0.7618007659912109, 1.482090950012207, -0.0013189315795898438, 0.3985481262207031, -2.354947090148926, -0.12519454956054688, 0.5592771768569946, 0.5733833312988281, 0.17882156372070312, -0.404541015625, -1.1528024673461914, 0.30422163009643555, -11.542220115661621, -0.1409454345703125, 0.06371307373046875, -0.5310478210449219, 3.790032386779785, -1.248764991760254, 1.875448226928711, -0.19589805603027344, 0.45857492089271545, -1.9417338371276855, 0.6558085680007935, -0.16269445419311523, 1.0144439935684204, -1.0281944274902344, 0.3166027069091797, 0.08219361305236816, 1.3333625793457031, 0.655308723449707, 1.1899135112762451, 0.33835697174072266, -0.5194168090820312, 1.0729999542236328, 1.4896068572998047, -5.167694091796875, 1.273192048072815, -0.8725738525390625, -1.680715560913086], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 54272, "num_env_steps_trained": 199920, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 199920, "last_target_update_ts": 54272, "num_target_updates": 105}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -108.62078980997205, "episode_len_mean": 270.65, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408], "episode_lengths": [250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5290315822818195, "mean_inference_ms": 23.88020854616501, "mean_action_processing_ms": 0.1362395252886566, "mean_env_wait_ms": 4.185580562611835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -108.62078980997205, "episode_len_mean": 270.65, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-52.599335089325905, -202.81177213788033, -383.32370941340923, -108.44412425905466, -351.7285371571779, -292.2269590049982, 44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408], "episode_lengths": [250, 307, 381, 280, 353, 334, 235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5290315822818195, "mean_inference_ms": 23.88020854616501, "mean_action_processing_ms": 0.1362395252886566, "mean_env_wait_ms": 4.185580562611835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 199920, "num_env_steps_sampled": 54272, "num_env_steps_trained": 199920, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 54272, "agent_timesteps_total": 54272, "timers": {"training_iteration_time_ms": 331.277, "learn_time_ms": 77.89, "learn_throughput": 3081.252, "synch_weights_time_ms": 20.197}, "counters": {"num_env_steps_sampled": 54272, "num_env_steps_trained": 199920, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 199920, "last_target_update_ts": 54272, "num_target_updates": 105}, "done": false, "episodes_total": 179, "training_iteration": 53, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-22-27", "timestamp": 1655500947, "time_this_iter_s": 5.35250997543335, "time_total_s": 283.355370759964, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 283.355370759964, "timesteps_since_restore": 0, "iterations_since_restore": 53, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.337500000000002, "ram_util_percent": 65.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.04797649383545, "min_q": -57.74945831298828, "max_q": 26.801929473876953, "mean_td_error": -4.575021266937256}, "td_error": [-8.818523406982422, 0.034149169921875, -0.9246921539306641, 0.61468905210495, 2.354672431945801, -0.5506154298782349, -4.578385353088379, 1.3220949172973633, 0.5453205108642578, 1.3893318176269531, -1.4239044189453125, -1.5617561340332031, -0.9364280700683594, 0.203078031539917, 1.593407154083252, 1.5862131118774414, -0.9683074951171875, -11.98762321472168, 0.7236423492431641, -0.407440185546875, -1.1008033752441406, -0.14393234252929688, -0.19373130798339844, -1.623870849609375, -0.10563087463378906, 1.5692169666290283, -0.0634007453918457, -0.8398256301879883, -1.2304134368896484, -1.7505979537963867, -0.7065200805664062, 1.0065860748291016, -1.5617561340332031, -0.4385995864868164, 0.3147263526916504, 0.34714508056640625, -5.431550979614258, -2.601471424102783, 0.081695556640625, -6.045047760009766, -0.19373130798339844, -0.6214408874511719, -1.0534331798553467, 0.9843635559082031, 0.8109903335571289, 2.6005640029907227, -5.44272518157959, 0.29862308502197266, 0.41504108905792236, 0.8332791328430176, -1.8937110900878906, -0.6037611961364746, 1.3371458053588867, 1.2317183017730713, 0.035259246826171875, 0.7278327941894531, -0.06836509704589844, -0.9089393615722656, 1.1956582069396973, 0.2587881088256836, 1.04221510887146, -0.5979132652282715, -0.4931488037109375, 0.2687411308288574, 0.7458000183105469, 0.3663139343261719, 1.3835601806640625, -1.3123817443847656, 1.4143905639648438, 0.12812042236328125, 0.2153491973876953, -10.849958419799805, 0.08894896507263184, 0.760223388671875, -5.566812515258789, 0.08646297454833984, -0.2559394836425781, 4.093472003936768, 0.31082677841186523, -1.4345693588256836, 4.649384498596191, 0.4243946075439453, -0.058528900146484375, 0.7366700172424316, 1.006277084350586, -1.232192039489746, 0.13109731674194336, 3.3485093116760254, 0.17343711853027344, -3.569499969482422, -0.9541506767272949, 4.168861389160156, 1.7681846618652344, -0.17420196533203125, -0.4030942916870117, -1.3557524681091309, 0.3456153869628906, 2.818495750427246, 0.36030590534210205, 0.5927200317382812, 0.35162353515625, -0.4237542152404785, 2.0334720611572266, -1.4381046295166016, -2.408212661743164, -1.9763002395629883, 1.3532214164733887, -0.49205589294433594, 2.0334720611572266, 0.5704336166381836, 0.34714508056640625, -1.895334243774414, 0.2648429870605469, 1.8972759246826172, -1.99778413772583, 0.4001438617706299, -0.5646035671234131, -9.754064559936523, 0.2516920566558838, -0.4305877685546875, 0.44361501932144165, 2.1982498168945312, 0.8988533020019531, -0.5288922786712646, -0.17116641998291016, 0.1783757209777832, 0.685138463973999, -1.2083470821380615, -0.745025634765625, -0.5196564197540283, 1.3822181224822998, 0.026472508907318115, -0.5004510879516602, 0.5426088571548462, 1.0996298789978027, -0.9365105628967285, 0.3905537724494934, 1.04842209815979, 2.2498245239257812, -6.272069931030273, 2.5165576934814453, -7.537110328674316, -10.390557289123535, 1.254465103149414, 2.1663646697998047, 0.06342124938964844, 0.011185407638549805, -3.446993827819824, 0.7810754776000977, 1.0838737487792969, 0.48918890953063965, -0.8708028793334961, 0.738560676574707, -7.84139347076416, -1.6387290954589844, 0.055553555488586426, -1.7771034240722656, -0.2651195526123047, 0.7882022857666016, 0.828916072845459, -1.4224910736083984, 0.9497642517089844, -0.06951689720153809, 0.08914512395858765, -0.25483226776123047, 1.0723609924316406, 0.42397356033325195, -0.1049196720123291, -4.195640563964844, -0.3796485662460327, -997.2631225585938, -1.1840147972106934, 0.9137439727783203, 0.23740577697753906, -0.46384716033935547, -0.13406944274902344, 0.8067436218261719, 0.31079864501953125, -2.318470001220703, -0.2649726867675781, 0.856511116027832, 0.23012971878051758, -0.15588903427124023, 1.5840339660644531, -2.940201759338379, -4.435157775878906, -0.09406900405883789, -6.936490058898926, 0.22324752807617188, -1.3837804794311523, -6.079422950744629, -2.3313369750976562, 0.44620656967163086, -0.24515914916992188, -1.1657676696777344, 0.07390208542346954, -0.2249155044555664, 1.1904010772705078, 3.845968246459961, 3.065749168395996, -3.5241808891296387, -0.5537109375, -8.292133331298828, 2.45335054397583, -0.056290388107299805, 2.4059958457946777, 0.8834686279296875, 0.9129734039306641, -0.5651519298553467, 0.33237266540527344, -1.1414794921875, -0.05134391784667969, -4.020761013031006, 1.2193622589111328, 1.1818599700927734, 0.08206844329833984, 2.1337528228759766, 0.3633766174316406, -0.6355209350585938, 0.10033988952636719, -0.8644638061523438, 0.6090564727783203, 0.3733177185058594, 2.0668811798095703, 0.6402149200439453, -0.6941592693328857, 0.054730892181396484, 0.5396135449409485, 2.9091339111328125, 0.9636635780334473, 0.8249921798706055, -7.756464004516602, -0.5111872553825378, 2.3071510791778564, 1.5351085662841797, -0.34713268280029297, -1.7765731811523438, -0.7924184799194336, 0.6560211181640625, -0.4418896436691284], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 55296, "num_env_steps_trained": 203760, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 203760, "last_target_update_ts": 55296, "num_target_updates": 107}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -97.9794310437888, "episode_len_mean": 266.68, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953], "episode_lengths": [235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5299988165466601, "mean_inference_ms": 23.89441001062359, "mean_action_processing_ms": 0.1358942995519821, "mean_env_wait_ms": 4.195262759476192, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -97.9794310437888, "episode_len_mean": 266.68, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.98954364657402, -207.6529878154397, 4.131906174123287, -36.78539182245731, -67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953], "episode_lengths": [235, 325, 230, 234, 248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5299988165466601, "mean_inference_ms": 23.89441001062359, "mean_action_processing_ms": 0.1358942995519821, "mean_env_wait_ms": 4.195262759476192, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 203760, "num_env_steps_sampled": 55296, "num_env_steps_trained": 203760, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 55296, "agent_timesteps_total": 55296, "timers": {"training_iteration_time_ms": 343.643, "learn_time_ms": 78.263, "learn_throughput": 3066.581, "synch_weights_time_ms": 20.595}, "counters": {"num_env_steps_sampled": 55296, "num_env_steps_trained": 203760, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 203760, "last_target_update_ts": 55296, "num_target_updates": 107}, "done": false, "episodes_total": 185, "training_iteration": 54, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-22-33", "timestamp": 1655500953, "time_this_iter_s": 5.575632333755493, "time_total_s": 288.9310030937195, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 288.9310030937195, "timesteps_since_restore": 0, "iterations_since_restore": 54, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.337500000000002, "ram_util_percent": 65.5125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -7.187788963317871, "min_q": -57.806400299072266, "max_q": 30.514690399169922, "mean_td_error": -0.326323002576828}, "td_error": [-8.4219970703125, -1.4362521171569824, 0.09244567155838013, -0.0672563910484314, 1.211329460144043, -0.9509010314941406, -10.39494800567627, 2.2046055793762207, -0.44315338134765625, 0.2440643310546875, 0.8253116607666016, 1.4878044128417969, 0.3770432472229004, 1.0995328426361084, 0.5666437149047852, -0.13222718238830566, -5.976055145263672, 0.2593669891357422, 0.0672454833984375, -1.281540870666504, 0.05260276794433594, 2.315357208251953, 2.442310333251953, 0.07074737548828125, -0.21383953094482422, -0.7511386871337891, -6.777673721313477, 1.7464380264282227, 2.871248483657837, 1.6931533813476562, 1.0137357711791992, 2.007049560546875, -0.45699214935302734, -0.00678253173828125, 0.8745956420898438, -1.9106197357177734, 0.35564613342285156, 0.9188003540039062, -0.8446578979492188, 0.39734363555908203, 0.09257888793945312, -0.6256580352783203, -6.0092573165893555, 0.5237565040588379, 0.9682703018188477, -0.4565652310848236, -1.1021709442138672, -1.8750571012496948, 0.8432259559631348, -0.43607139587402344, -1.3640551567077637, -0.27527904510498047, 2.838970184326172, -1.157416820526123, -20.13720703125, -0.189697265625, -0.6853265762329102, -0.2872295379638672, 2.6080169677734375, -0.04478347301483154, -0.5135684013366699, 0.5747566223144531, -0.5360496044158936, -0.3337554931640625, -1.017202615737915, 1.4050483703613281, -0.09720355272293091, -0.5689053535461426, 0.8275070190429688, 0.5828857421875, 2.326253890991211, -0.8987584114074707, 1.5856246948242188, -0.8777680397033691, -1.0690555572509766, -2.297269821166992, -0.39945030212402344, 0.5944013595581055, 0.11964797973632812, 0.15549850463867188, 0.6148786544799805, -0.41107606887817383, 0.6679897308349609, 0.7323760986328125, 0.9756622314453125, -0.3026876449584961, 1.0222711563110352, 1.6601181030273438, -2.6111717224121094, -0.09041500091552734, -1.1234626770019531, 0.14178752899169922, -0.45686855912208557, 1.5394401550292969, 1.674006462097168, 1.4322266578674316, -4.361265182495117, 2.486558675765991, -9.042508125305176, 0.19760489463806152, 0.27669239044189453, 1.5394401550292969, 0.36264991760253906, 0.899815559387207, -1.0434024333953857, 0.05563545227050781, 0.5422172546386719, -4.693019866943359, -1.105712652206421, -5.242273330688477, -2.0206918716430664, 1.6712579727172852, -11.79561710357666, 1.1129207611083984, -0.4388303756713867, -0.507612943649292, 0.37064409255981445, 1.443160057067871, 0.19349336624145508, -0.13335555791854858, -4.009885787963867, -0.14501094818115234, -0.06550252437591553, -5.823984146118164, -3.4824891090393066, 0.4264669418334961, -0.5148248672485352, 0.5037155151367188, 2.0725841522216797, 0.020869016647338867, -0.663931131362915, -1.1469907760620117, 0.8920135498046875, -1.1617059707641602, 6.201207637786865, -0.0353543758392334, 0.6740379333496094, -5.472807884216309, -0.4293785095214844, 0.5137367248535156, 0.24428002536296844, -0.5008316040039062, -8.796253204345703, -1.6361465454101562, -0.8086161613464355, 0.3938779830932617, 0.5608706474304199, -0.3716459274291992, 0.8109960556030273, -1.4209661483764648, 1.6231365203857422, 0.09350299835205078, -0.19829559326171875, -0.6918938755989075, 2.246312141418457, -0.05857086181640625, -0.39908385276794434, -1.8238563537597656, -1.0495810508728027, 0.053440093994140625, 3.656097412109375, -1.0714998245239258, -0.44315338134765625, 0.2027750015258789, 2.097047805786133, 2.70676326751709, 1.1164979934692383, 0.26959776878356934, -2.0130138397216797, -0.11647319793701172, 0.8733577728271484, -0.1599750518798828, -2.2810873985290527, -2.1927385330200195, -0.33022022247314453, 1.1248722076416016, -0.04465007781982422, 4.101079940795898, 0.35233545303344727, 0.7983083724975586, 1.325751781463623, -0.7461023330688477, 0.5701102614402771, 2.1074485778808594, 0.6725997924804688, -0.48862767219543457, -0.7304508686065674, 1.2592906951904297, -0.6693506240844727, -0.24027156829833984, 0.3789825439453125, 0.22997665405273438, -4.515824794769287, 0.05276775360107422, 0.5856523513793945, 1.8585866689682007, 1.6964302062988281, -0.18674850463867188, 0.6675820350646973, -0.77946937084198, 0.9184093475341797, -0.22896814346313477, -1.0472557544708252, -0.3699474334716797, -0.014258980751037598, -0.7083139419555664, 4.260692596435547, -0.928741455078125, -1.4042840003967285, -0.2945060729980469, -0.7951502799987793, -1.8753089904785156, 1.9296493530273438, -3.2505288124084473, -0.1756610870361328, 0.4152042269706726, 0.7742338180541992, 0.30715465545654297, -0.316129207611084, -1.7990286350250244, -0.36023759841918945, 0.133056640625, 1.6743412017822266, -0.0776987075805664, 1.8465137481689453, 0.3246464729309082, 0.003990650177001953, 1.54461669921875, -1.1518354415893555, -3.819676399230957, -0.5767755508422852, 1.1660690307617188, 1.3617610931396484, -0.08582592010498047, -0.63232421875, -0.5046412944793701, 0.34313488006591797, 0.001132965087890625, 1.7736918926239014, 0.8506362438201904], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 56320, "num_env_steps_trained": 207600, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 207600, "last_target_update_ts": 56320, "num_target_updates": 109}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -96.64147214584052, "episode_len_mean": 265.45, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116], "episode_lengths": [248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5303640744259365, "mean_inference_ms": 23.925769762445466, "mean_action_processing_ms": 0.1357912913758628, "mean_env_wait_ms": 4.199854426978148, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -96.64147214584052, "episode_len_mean": 265.45, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.58539192378521, -230.75097787380219, -113.32695888727903, -51.74085504561663, -133.9258229136467, -175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116], "episode_lengths": [248, 317, 286, 275, 247, 298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5303640744259365, "mean_inference_ms": 23.925769762445466, "mean_action_processing_ms": 0.1357912913758628, "mean_env_wait_ms": 4.199854426978148, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 207600, "num_env_steps_sampled": 56320, "num_env_steps_trained": 207600, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 56320, "agent_timesteps_total": 56320, "timers": {"training_iteration_time_ms": 350.227, "learn_time_ms": 80.356, "learn_throughput": 2986.721, "synch_weights_time_ms": 20.683}, "counters": {"num_env_steps_sampled": 56320, "num_env_steps_trained": 207600, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 207600, "last_target_update_ts": 56320, "num_target_updates": 109}, "done": false, "episodes_total": 189, "training_iteration": 55, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-22-39", "timestamp": 1655500959, "time_this_iter_s": 5.4924116134643555, "time_total_s": 294.42341470718384, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 294.42341470718384, "timesteps_since_restore": 0, "iterations_since_restore": 55, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.174999999999997, "ram_util_percent": 65.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -7.820313930511475, "min_q": -63.35676956176758, "max_q": 30.084318161010742, "mean_td_error": -0.7525989413261414}, "td_error": [-0.4235968589782715, -1.0245780944824219, -6.458725452423096, -13.25860595703125, -45.349761962890625, -1.244771957397461, -0.8838791847229004, 0.11071562767028809, 1.9520269632339478, -2.614487648010254, 2.523721694946289, -0.9975470304489136, 1.3248529434204102, -0.20215022563934326, 5.303333282470703, -0.6913127899169922, 1.5036662817001343, 1.104949951171875, -2.260099411010742, 0.15552616119384766, 0.8063697814941406, -5.785783290863037, -0.10421562194824219, 0.5683355331420898, 0.1777973175048828, -1.80072021484375, -0.5801143646240234, -0.36575746536254883, 1.2554092407226562, -3.306734085083008, 0.49982786178588867, 0.7436587810516357, -0.5396013259887695, 0.09570801258087158, 0.17802715301513672, -0.2324838638305664, -0.5264031887054443, 1.1456246376037598, 2.115886688232422, -0.35794854164123535, 2.8559746742248535, -0.8399620056152344, 1.3194713592529297, -0.21122407913208008, 0.9199924468994141, 1.166473388671875, -1.055715560913086, -0.6017551422119141, -6.790671348571777, -0.8590707778930664, 0.20852279663085938, 2.5000534057617188, 0.2846078872680664, 0.44463348388671875, -0.4576253890991211, 1.8797712326049805, -0.9330778121948242, -0.29043006896972656, -0.9877147674560547, -1.7072639465332031, -0.24344396591186523, -1.1505012512207031, -0.574913501739502, -0.7851510047912598, -1.2163658142089844, 0.7030048370361328, -1.2659797668457031, 1.0676679611206055, -0.9330778121948242, -0.18592166900634766, -0.18622684478759766, 0.4183177947998047, 1.2511036396026611, -1.6789522171020508, -0.08288192749023438, -1.6788702011108398, -1.1782336235046387, 0.38215166330337524, 0.5071088075637817, 1.7648744583129883, -0.19519615173339844, -0.3417243957519531, -0.1391761302947998, -0.6234588623046875, -0.23900985717773438, -0.27892208099365234, -0.5445079803466797, 0.46600472927093506, 0.42870980501174927, -0.9425411224365234, -1.346670150756836, -0.6628561019897461, 0.25982046127319336, -0.5622768402099609, -0.23710894584655762, 0.2602243423461914, 1.4525260925292969, -0.7033767700195312, 0.6972465515136719, -0.6433563232421875, 1.5826644897460938, -1.3463034629821777, -2.35532283782959, -0.6240940093994141, -1.5744476318359375, -6.449350357055664, 1.1456451416015625, 1.8060332536697388, 0.5417871475219727, -0.4394538402557373, 1.2070960998535156, -0.9530620574951172, 0.7002086639404297, 0.01943063735961914, -0.2848224639892578, 0.3567650318145752, -2.225396156311035, 0.337982177734375, -0.46343088150024414, -0.20056819915771484, -1.031611442565918, 0.4629189968109131, -0.30338191986083984, -0.404022216796875, -1.7977943420410156, 1.0489392280578613, 1.7580375671386719, -2.0017452239990234, -11.19485092163086, -1.968775749206543, -0.8612513542175293, 0.23758172988891602, -1.0241508483886719, -1.8048152923583984, -1.1479074954986572, -0.77630615234375, -1.0364742279052734, -7.515876770019531, -1.3328475952148438, 3.948054313659668, -1.8727407455444336, -2.0946147441864014, 0.24672317504882812, -0.9450623989105225, -1.2265270948410034, 0.11887645721435547, -1.1847867965698242, -7.356341361999512, 0.18999958038330078, 5.415712356567383, -0.8703022003173828, -0.09641838073730469, -0.2722039222717285, -2.0947227478027344, -0.6990752220153809, 0.4414803981781006, 1.2991981506347656, -2.500385284423828, -5.821595191955566, -0.1861562728881836, -0.6959543228149414, -1.4246940612792969, 0.3741176128387451, -0.29663848876953125, -0.5172395706176758, -1.3459835052490234, -2.0709304809570312, -0.4488372802734375, 1.9446039199829102, 1.2991981506347656, -0.1805419921875, 0.7870789170265198, -0.5692615509033203, -8.10735034942627, -0.4227175712585449, 0.5780162811279297, -0.8872718811035156, -1.7521190643310547, 0.5156693458557129, 0.32445812225341797, 0.15960454940795898, -2.045452117919922, 0.34481048583984375, 0.2945551872253418, 0.37080955505371094, 0.06434094905853271, 0.7346744537353516, -0.04731321334838867, -0.44192028045654297, -0.1891918182373047, -1.9754772186279297, -0.13741111755371094, -0.7482376098632812, -0.4789714813232422, 0.8553037643432617, -0.1711975336074829, 0.36888587474823, 0.5497379302978516, 0.5504741668701172, 2.9051151275634766, -0.45822906494140625, -0.9629745483398438, -0.14649152755737305, -0.5396013259887695, -0.7232248783111572, 0.6961963176727295, -1.0890617370605469, -2.1317005157470703, 0.3044404983520508, -0.2141876220703125, 0.3527827262878418, 2.3100996017456055, 1.1759033203125, -13.22846508026123, -0.11442947387695312, -4.630558013916016, -2.1728248596191406, 0.5154585838317871, -0.6662282943725586, -0.26533031463623047, 0.09902739524841309, 0.49695253372192383, -1.6655874252319336, 0.8685851097106934, 0.07777786254882812, 0.18649578094482422, -0.026464462280273438, 1.2747697830200195, -2.0941333770751953, -1.1920032501220703, -6.115708351135254, 0.3511638641357422, 0.9889488220214844, -1.1281929016113281, -0.09158611297607422, -0.5072388648986816, -0.9920501708984375, -0.5776281356811523, -1.0585784912109375, -0.5619583129882812], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 211440, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 211440, "last_target_update_ts": 57344, "num_target_updates": 111}, "sampler_results": {"episode_reward_max": 835.847737558186, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -93.35839160270989, "episode_len_mean": 263.57, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573], "episode_lengths": [298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5311802023618545, "mean_inference_ms": 23.939578776885966, "mean_action_processing_ms": 0.13571724985807002, "mean_env_wait_ms": 4.205475327425767, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 835.847737558186, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -93.35839160270989, "episode_len_mean": 263.57, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-175.53448002785444, -656.09366504848, 8.785761445760727, -72.30978695303202, 835.847737558186, -49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573], "episode_lengths": [298, 446, 228, 225, 211, 269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5311802023618545, "mean_inference_ms": 23.939578776885966, "mean_action_processing_ms": 0.13571724985807002, "mean_env_wait_ms": 4.205475327425767, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 211440, "num_env_steps_sampled": 57344, "num_env_steps_trained": 211440, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 57344, "agent_timesteps_total": 57344, "timers": {"training_iteration_time_ms": 340.839, "learn_time_ms": 78.965, "learn_throughput": 3039.332, "synch_weights_time_ms": 20.683}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 211440, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 211440, "last_target_update_ts": 57344, "num_target_updates": 111}, "done": false, "episodes_total": 194, "training_iteration": 56, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-22-44", "timestamp": 1655500964, "time_this_iter_s": 5.568360090255737, "time_total_s": 299.9917747974396, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 299.9917747974396, "timesteps_since_restore": 0, "iterations_since_restore": 56, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.6875, "ram_util_percent": 65.58749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.853031158447266, "min_q": -63.54787063598633, "max_q": 27.45656394958496, "mean_td_error": -0.8476784825325012}, "td_error": [-1.9213533401489258, 0.786736011505127, 0.5732021331787109, 0.27636051177978516, 1.0239276885986328, 1.3344111442565918, 1.9467010498046875, -0.2655935287475586, -0.06988143920898438, 0.15663528442382812, -0.012475967407226562, 0.1588306427001953, 0.184400737285614, -1.1518287658691406, -7.628388404846191, -0.5746889114379883, 0.6723461151123047, 1.85197114944458, -5.549357891082764, -0.21262741088867188, -8.13998794555664, 0.7343101501464844, -7.211400985717773, -2.4291810989379883, 0.7360963821411133, 0.35212230682373047, 0.877777099609375, -0.3483448028564453, 0.7678594589233398, 0.4903593063354492, 0.9730300903320312, -0.06533622741699219, 0.8713550567626953, 0.34659576416015625, 0.4266590476036072, -1.4102134704589844, 0.8475370407104492, -0.2551767826080322, 0.6854400634765625, -2.761777877807617, 1.0610427856445312, -1.1620807647705078, -6.780609607696533, -9.111865997314453, -0.3109250068664551, -2.551534652709961, -0.006503105163574219, -0.9795436859130859, -0.04945564270019531, 0.16490745544433594, -0.9916572570800781, 0.6749210357666016, 0.19680070877075195, -3.793682098388672, 0.3247413635253906, 0.5580635070800781, -0.10912322998046875, -2.3751869201660156, -0.7646656036376953, -0.5996108055114746, -0.20438969135284424, 0.44241857528686523, -1.6822586059570312, 1.7157177925109863, -0.7658710479736328, -0.8607406616210938, -0.3369922637939453, 0.718623161315918, -2.4078540802001953, -0.7108714580535889, -0.9573822021484375, 0.5731639862060547, 0.21330487728118896, -0.41440391540527344, 0.2685532569885254, -6.116682052612305, -0.6687183380126953, 0.7324090003967285, 0.15636372566223145, 0.30908870697021484, -0.624943733215332, -8.872565269470215, -0.6511688232421875, -0.22301769256591797, -0.7409729957580566, 17.261219024658203, -0.9884548187255859, -1.4349298477172852, -0.2749941349029541, 0.6733512878417969, 1.6575927734375, 1.4740571975708008, 0.19350630044937134, 0.9033257961273193, -0.8727540969848633, -0.5086240768432617, 0.2709641456604004, -1.034505844116211, -0.85986328125, 0.19225549697875977, -1.9842586517333984, -2.352344512939453, 0.019582033157348633, 0.28269386291503906, -0.35683441162109375, -0.8911399841308594, 0.2896862030029297, 0.09006595611572266, -21.154678344726562, 0.3060130476951599, 0.4057025909423828, -0.7920856475830078, -0.6571273803710938, -1.5570526123046875, -4.4070281982421875, -7.307915210723877, -3.708883285522461, 0.03607940673828125, 0.6252470016479492, 0.32185888290405273, -4.067928314208984, 0.1915740966796875, 0.1423032283782959, -1.3264570236206055, -0.05905914306640625, -1.3033599853515625, -0.18133878707885742, -8.872565269470215, 0.5651741027832031, -6.629117965698242, 0.12962055206298828, 0.24692535400390625, 0.1798572540283203, 0.09237289428710938, 0.27146148681640625, -0.7807064056396484, -24.357467651367188, -7.661126136779785, -5.018750190734863, 0.2803936004638672, 20.909954071044922, 0.1183929443359375, -0.40314149856567383, 0.2650184631347656, 0.46176111698150635, 2.1166696548461914, -0.05790519714355469, -0.0676736831665039, -0.19670164585113525, -0.5730628967285156, -0.5623106956481934, 0.5361652374267578, 0.22759580612182617, -0.3042945861816406, -0.7620325088500977, -1.397796630859375, -1.2406730651855469, 1.8424606323242188, -0.7313261032104492, -0.019254684448242188, -1.1241989135742188, 0.35671567916870117, -1.2885093688964844, -9.468090057373047, 0.25891780853271484, -3.4843358993530273, -2.8100099563598633, -1.527944564819336, -6.31760835647583, 0.18923377990722656, -1.338545799255371, 0.14171981811523438, 0.5206968784332275, -1.6381816864013672, -0.10642433166503906, 0.25891780853271484, 1.4622704982757568, 0.24767494201660156, -0.2551767826080322, 0.02843761444091797, -6.288861274719238, -0.8503580093383789, -0.9290895462036133, 1.3022804260253906, -0.8344821929931641, -1.0417098999023438, -11.91132640838623, -0.8683586120605469, -0.2733612060546875, 0.40665626525878906, -0.140267014503479, 0.3069305419921875, 1.1843986511230469, -5.358732223510742, 0.9055728912353516, -0.18566513061523438, -0.7950661182403564, -1.7966632843017578, -1.4137799739837646, -1.4704737663269043, -0.32457923889160156, -1.2054836750030518, -0.34777212142944336, -0.6738052368164062, 0.20191073417663574, 1.9567756652832031, 0.4346766471862793, 0.2709641456604004, -0.42110252380371094, -0.9009199142456055, -2.8100099563598633, 1.490096092224121, -1.1789350509643555, 1.1280403137207031, -0.47037649154663086, 2.0517075061798096, -1.399789810180664, -0.09643077850341797, -1.3018779754638672, -0.6113452911376953, -0.18774032592773438, -4.625138282775879, 0.2740612030029297, -0.030686378479003906, -0.9978775978088379, 2.8263473510742188, 0.04161667823791504, -3.2112393379211426, -0.13416099548339844, 0.8498531579971313, -5.199782371520996, -1.6137819290161133, -2.258704662322998, -0.5533666610717773, -1.344283103942871, 0.011885881423950195, -5.307404041290283, -1.319352149963379, 2.039216995239258, 12.237488746643066], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 58368, "num_env_steps_trained": 215280, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 215280, "last_target_update_ts": 58368, "num_target_updates": 113}, "sampler_results": {"episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -96.68333751618862, "episode_len_mean": 262.06, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774], "episode_lengths": [269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5325672458236257, "mean_inference_ms": 23.953149284936288, "mean_action_processing_ms": 0.13532283997343794, "mean_env_wait_ms": 4.215039179120889, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -96.68333751618862, "episode_len_mean": 262.06, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.056626476347446, 18.71363453567028, -1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774], "episode_lengths": [269, 247, 232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5325672458236257, "mean_inference_ms": 23.953149284936288, "mean_action_processing_ms": 0.13532283997343794, "mean_env_wait_ms": 4.215039179120889, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 215280, "num_env_steps_sampled": 58368, "num_env_steps_trained": 215280, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 58368, "agent_timesteps_total": 58368, "timers": {"training_iteration_time_ms": 357.382, "learn_time_ms": 78.419, "learn_throughput": 3060.49, "synch_weights_time_ms": 20.188}, "counters": {"num_env_steps_sampled": 58368, "num_env_steps_trained": 215280, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 215280, "last_target_update_ts": 58368, "num_target_updates": 113}, "done": false, "episodes_total": 199, "training_iteration": 57, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-22-50", "timestamp": 1655500970, "time_this_iter_s": 5.679826736450195, "time_total_s": 305.67160153388977, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 305.67160153388977, "timesteps_since_restore": 0, "iterations_since_restore": 57, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 26.887500000000003, "ram_util_percent": 65.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.304577827453613, "min_q": -66.53241729736328, "max_q": 25.060089111328125, "mean_td_error": -0.2895575165748596}, "td_error": [0.7429008483886719, 0.7300491333007812, -0.7740669250488281, -0.9457511901855469, -0.06310272216796875, -0.6953220367431641, 0.42264866828918457, -0.7740669250488281, -2.695018768310547, -0.03517556190490723, 2.489532470703125, -5.9863972663879395, -0.8646044731140137, 0.25933074951171875, 1.0929679870605469, -0.358428955078125, -0.6810579299926758, 1.0102729797363281, 1.1785049438476562, 0.33376312255859375, 0.45456504821777344, 0.3480186462402344, -0.6945760250091553, -0.12390804290771484, 0.641139030456543, 2.3491249084472656, 0.13824892044067383, -0.4723377227783203, -1.886423110961914, 0.693756103515625, -1.6046600341796875, 0.6672730445861816, -0.19543075561523438, 1.9266204833984375, -1.3123111724853516, -0.4047880172729492, -1.5190167427062988, 1.164689540863037, -0.7777471542358398, -1.3401141166687012, -0.6573772430419922, 0.20628690719604492, -1.3763389587402344, 0.028553009033203125, -0.35517120361328125, 0.3937969207763672, 0.8208370208740234, -2.2421700954437256, 1.2943224906921387, 0.9582653045654297, 0.2814826965332031, -0.7688350677490234, 0.8314056396484375, 1.0779094696044922, 1.0046093463897705, 0.2656586170196533, -0.7557221055030823, -0.07826423645019531, 0.1466217041015625, 1.151604175567627, 1.6409969329833984, 1.2581186294555664, 0.3815760612487793, 1.0913877487182617, 0.708226203918457, -1.366843581199646, 1.0512447357177734, -0.3693552017211914, 1.158585548400879, -0.31706714630126953, -1.1917449235916138, 0.47298431396484375, 1.0070157051086426, -0.8482589721679688, -0.19947612285614014, 0.6418039798736572, -3.0787582397460938, -1.218625545501709, -4.5799102783203125, -0.106781005859375, 0.6621756553649902, -0.4106919765472412, -2.4735937118530273, -0.4567732810974121, -23.017175674438477, 2.0556368827819824, 0.5880250930786133, -0.3355579376220703, 0.41971397399902344, -1.2684249877929688, 0.4447975158691406, -0.14401626586914062, -0.10124588012695312, 1.991678237915039, 0.15607452392578125, -0.36069679260253906, -6.610714912414551, 1.7339258193969727, -11.295456886291504, 0.9209251403808594, 0.14356231689453125, 0.619171142578125, -0.07806921005249023, -0.39934444427490234, 0.9522228240966797, -0.09881210327148438, -0.28650474548339844, 0.6418037414550781, 1.1092309951782227, 0.07247674465179443, -0.07365798950195312, 0.8446083068847656, 1.1912918090820312, -3.132781982421875, 1.483444333076477, -0.986175537109375, 0.32689666748046875, 0.044658660888671875, 0.21282005310058594, -0.7508106231689453, -0.44264650344848633, -0.07964420318603516, -0.5446639060974121, 1.7303295135498047, -0.8489670753479004, 1.0033063888549805, 1.0505352020263672, 1.548604965209961, 0.081787109375, -0.05840492248535156, 0.3136777877807617, 0.04028606414794922, 1.5894994735717773, 1.0913877487182617, -1.7895336151123047, -0.347497820854187, -15.522693634033203, 0.7433071136474609, -2.416128158569336, -0.3190288543701172, -0.42708826065063477, 0.46309804916381836, 1.2581186294555664, -0.6327998638153076, -0.5527071952819824, -4.478260040283203, 1.859405517578125, -1.291238784790039, 1.5935332775115967, -1.1150212287902832, 1.4800467491149902, 1.874007225036621, -1.9083576202392578, 0.42072975635528564, -1.1424999237060547, 0.2976846694946289, 0.47298431396484375, 0.2550506591796875, 1.3540840148925781, -7.132411003112793, -1.0773069858551025, -3.296541213989258, 1.5165748596191406, 0.9582653045654297, -0.09207582473754883, -5.060157775878906, -2.410768508911133, -0.6407299041748047, -0.5459442138671875, -3.1279006004333496, 0.5330238342285156, 1.8486976623535156, 0.5157651901245117, 1.1545219421386719, 0.5834026336669922, -0.18749046325683594, -1.043874740600586, -0.0986490249633789, 0.4741339683532715, 0.8624916076660156, 0.6813068389892578, 0.20628690719604492, 0.2203235626220703, 1.796816349029541, 1.4009947776794434, 0.5104904174804688, 0.5080604553222656, 0.3053053021430969, -0.08035421371459961, -0.7057819366455078, 0.6289932727813721, -0.149749755859375, 1.5418519973754883, 0.7804641723632812, 0.031859397888183594, 0.6529989242553711, -0.11655807495117188, 0.6777780055999756, -0.07232952117919922, -0.7504334449768066, 0.07984256744384766, -0.0002079010009765625, -3.502509117126465, 1.3290379047393799, -11.486820220947266, 0.45758843421936035, 0.877166748046875, 0.3243732452392578, -0.6873512268066406, 1.4145069122314453, 0.36895751953125, 0.43469691276550293, -0.20919537544250488, 1.6531295776367188, -0.5375943183898926, 0.05403327941894531, 0.8665065765380859, 1.6963598728179932, 1.4166483879089355, 0.9431777000427246, 0.6048011779785156, 0.16877961158752441, 0.9530229568481445, -0.008701324462890625, 0.5448558330535889, 1.6638031005859375, 0.46291255950927734, -0.30382347106933594, 0.08431988954544067, 0.6170711517333984, 0.4742584228515625, 1.596888542175293, -0.551276683807373, -4.271730422973633, 0.8873958587646484, -0.01857614517211914, 0.5794477462768555, -1.0373573303222656, -0.4301809072494507, -0.544029712677002], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 59392, "num_env_steps_trained": 219120, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 219120, "last_target_update_ts": 59392, "num_target_updates": 115}, "sampler_results": {"episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -96.2987753945589, "episode_len_mean": 261.52, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005], "episode_lengths": [232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5325020107760768, "mean_inference_ms": 23.958092604852318, "mean_action_processing_ms": 0.1353351633738058, "mean_env_wait_ms": 4.216461179010025, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -96.2987753945589, "episode_len_mean": 261.52, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9601216986775398, -139.24872762709856, -223.23333604633808, -133.88809253275394, -231.26999436318874, -26.460350580513477, -108.28799732029438, 19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005], "episode_lengths": [232, 264, 315, 276, 319, 251, 273, 211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5325020107760768, "mean_inference_ms": 23.958092604852318, "mean_action_processing_ms": 0.1353351633738058, "mean_env_wait_ms": 4.216461179010025, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 219120, "num_env_steps_sampled": 59392, "num_env_steps_trained": 219120, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 59392, "agent_timesteps_total": 59392, "timers": {"training_iteration_time_ms": 335.945, "learn_time_ms": 78.868, "learn_throughput": 3043.071, "synch_weights_time_ms": 20.488}, "counters": {"num_env_steps_sampled": 59392, "num_env_steps_trained": 219120, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 219120, "last_target_update_ts": 59392, "num_target_updates": 115}, "done": false, "episodes_total": 201, "training_iteration": 58, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-22-56", "timestamp": 1655500976, "time_this_iter_s": 5.3331403732299805, "time_total_s": 311.00474190711975, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 311.00474190711975, "timesteps_since_restore": 0, "iterations_since_restore": 58, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.9375, "ram_util_percent": 65.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.264554977416992, "min_q": -66.42142486572266, "max_q": 26.8046817779541, "mean_td_error": -0.38245949149131775}, "td_error": [0.13328945636749268, -3.6399526596069336, 1.1502978801727295, 2.634164810180664, 3.283205032348633, -0.3548722267150879, 0.2705574035644531, -3.1767492294311523, -0.6963119506835938, 0.21776843070983887, -1.8423948287963867, 0.9754066467285156, 0.7825425863265991, -0.43508243560791016, -0.3000030517578125, 1.7922587394714355, -0.8277454376220703, 1.1069564819335938, -0.6808300018310547, -0.06812810897827148, -0.025237083435058594, 0.49753451347351074, -0.2955942153930664, -0.019400596618652344, 1.6031455993652344, 1.2047786712646484, -1.583108901977539, 1.1208515167236328, -0.4172224998474121, -13.01043701171875, 0.7059917449951172, -0.602210521697998, -0.7304840087890625, -3.958655834197998, 0.8780772686004639, 0.42442941665649414, 0.014406323432922363, -0.9612197875976562, 0.3867912292480469, 0.21776843070983887, 3.1391210556030273, 1.7322654724121094, 2.5777740478515625, 0.43447113037109375, -4.055423736572266, 0.08578872680664062, -7.44915771484375, 0.5296995639801025, -0.4746897220611572, 1.182283639907837, -1.0795164108276367, 0.4661293029785156, -0.41144275665283203, 1.026466965675354, -0.9463276863098145, -0.03427314758300781, -10.99533462524414, 1.2257976531982422, 0.4604988098144531, -0.38445496559143066, -4.371802806854248, 2.1087818145751953, 2.867462158203125, -3.7791824340820312, 0.8695545792579651, -0.7966184616088867, 0.14834809303283691, -0.4664020538330078, 2.9943294525146484, -4.633073806762695, 0.020972251892089844, 0.06856763362884521, -9.292194366455078, 0.06747627258300781, 0.8982610702514648, -6.705235481262207, 0.052948951721191406, 1.3287086486816406, 0.17116355895996094, 0.7656173706054688, -0.11748886108398438, 0.35007143020629883, -0.2135028839111328, -0.13331151008605957, 1.0911293029785156, 0.48160266876220703, 0.6670284271240234, 1.2442684173583984, 0.004947662353515625, 1.1510740518569946, 2.012401580810547, -0.3851356506347656, 1.3569755554199219, 0.6227531433105469, 0.49463653564453125, 0.48899078369140625, 1.8226680755615234, 0.1606292724609375, -5.410849571228027, 0.25335693359375, 0.17053866386413574, 0.6505317687988281, 1.2035446166992188, -0.8590130805969238, 0.8959932327270508, 1.6160330772399902, -0.2613048553466797, 0.9021453857421875, -1.1923437118530273, -0.39624595642089844, -6.49379825592041, 2.189756393432617, -1.6044788360595703, 1.690267562866211, 0.11348342895507812, -2.4705052375793457, -3.592522621154785, 1.2406787872314453, 0.2002878189086914, 2.0566701889038086, -0.5455207824707031, -0.3251919746398926, 1.108210563659668, 2.196547508239746, -0.4267735481262207, -5.762453079223633, -1.8878073692321777, -9.521484375, 0.725909948348999, -7.3615312576293945, -0.7931327819824219, 0.8191900253295898, 0.9223098754882812, -0.20833969116210938, -1.340203881263733, -0.05869629979133606, 0.4164693355560303, -2.432760238647461, 2.5919055938720703, 0.37922799587249756, -0.5620851516723633, 0.44509077072143555, 0.9241905212402344, -3.663595199584961, 0.01757049560546875, -1.8750295639038086, 0.5998568534851074, 0.13920211791992188, -1.6044788360595703, 0.17628931999206543, -0.3125343322753906, -0.32610607147216797, -1.2937126159667969, 0.2260303497314453, -1.0664024353027344, -0.5448856353759766, 1.053802490234375, 0.05912017822265625, -8.603882789611816, 2.6815223693847656, -2.899693489074707, -0.6668672561645508, 0.27580738067626953, 1.2837848663330078, 1.7403812408447266, -4.958164215087891, -0.5764913558959961, 0.5562429428100586, 0.5553240776062012, -5.30221700668335, 0.9661874771118164, 0.13410377502441406, 0.7770203351974487, -3.5180587768554688, -6.209389686584473, 2.34145450592041, -0.3235621452331543, -0.40116310119628906, -0.3679046630859375, -5.847889423370361, 1.034786343574524, -0.20512104034423828, 1.211343765258789, 0.022237777709960938, 0.6530828475952148, 2.0566701889038086, 1.5204222202301025, 3.4093189239501953, 2.3079566955566406, 0.0501866340637207, 0.7509317398071289, -1.0294609069824219, 0.39879798889160156, -7.1346588134765625, -0.07042884826660156, 1.7451629638671875, 0.486727774143219, -0.6601982116699219, -3.598125457763672, -0.4819474220275879, 1.2461020946502686, 0.8251214027404785, 0.08363628387451172, -4.569143295288086, 0.5238254070281982, 0.8647943735122681, 0.2002878189086914, -0.5863246917724609, -0.23726654052734375, 0.8839490413665771, 2.005077362060547, -2.818605422973633, 0.04463958740234375, 0.5837440490722656, 0.8014926910400391, 1.1442737579345703, 0.3613557815551758, -1.2674789428710938, 0.1791224479675293, 0.8551225662231445, -1.950107216835022, 1.0686607360839844, 1.2963409423828125, 1.1683235168457031, 0.4518318176269531, 0.40169715881347656, 0.9827365875244141, 2.180393934249878, -0.47461414337158203, -0.5994768142700195, 0.8588018417358398, 0.34762001037597656, 0.9488711357116699, 0.40250205993652344, -1.1329631805419922, 0.6101112365722656, -0.026438534259796143, 0.9887008666992188, 0.40621185302734375, -2.9595375061035156], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 60416, "num_env_steps_trained": 222960, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 222960, "last_target_update_ts": 60416, "num_target_updates": 117}, "sampler_results": {"episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -87.13540560767055, "episode_len_mean": 256.98, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959], "episode_lengths": [211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5332949761280067, "mean_inference_ms": 23.980415801146687, "mean_action_processing_ms": 0.13499356301352702, "mean_env_wait_ms": 4.222746227668627, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -87.13540560767055, "episode_len_mean": 256.98, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.28926406800747, 5.64958480745554, 20.03729046136141, -287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959], "episode_lengths": [211, 245, 233, 345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5332949761280067, "mean_inference_ms": 23.980415801146687, "mean_action_processing_ms": 0.13499356301352702, "mean_env_wait_ms": 4.222746227668627, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 222960, "num_env_steps_sampled": 60416, "num_env_steps_trained": 222960, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 60416, "agent_timesteps_total": 60416, "timers": {"training_iteration_time_ms": 342.644, "learn_time_ms": 78.305, "learn_throughput": 3064.956, "synch_weights_time_ms": 20.656}, "counters": {"num_env_steps_sampled": 60416, "num_env_steps_trained": 222960, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 222960, "last_target_update_ts": 60416, "num_target_updates": 117}, "done": false, "episodes_total": 208, "training_iteration": 59, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-23-01", "timestamp": 1655500981, "time_this_iter_s": 5.574610710144043, "time_total_s": 316.5793526172638, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 316.5793526172638, "timesteps_since_restore": 0, "iterations_since_restore": 59, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.9, "ram_util_percent": 65.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.641121864318848, "min_q": -65.04596710205078, "max_q": 24.2364501953125, "mean_td_error": -1.0348467826843262}, "td_error": [-0.05643272399902344, 1.0485363006591797, 0.8334438800811768, -4.421108245849609, -0.5585975646972656, -0.7870998382568359, 0.020353317260742188, -2.05814266204834, 0.6797657012939453, 0.0445556640625, 1.4210968017578125, 0.43399906158447266, -0.8093395233154297, 0.6081762313842773, 0.7785873413085938, -1.456801414489746, -1.2390222549438477, 0.49045372009277344, -1.177347183227539, 0.02624034881591797, -1.8675289154052734, -0.9617595672607422, 0.5164041519165039, -0.9899635314941406, 0.816364049911499, 0.7785873413085938, -2.0830459594726562, 1.528383731842041, 0.0983881950378418, 2.4843497276306152, -1.4213905334472656, -1.4582958221435547, -1.0547125339508057, 0.01690959930419922, 0.3637845516204834, -0.7948068380355835, 1.967686653137207, -0.6797142028808594, -4.26255464553833, 1.3729190826416016, 0.10572898387908936, 0.14677667617797852, 1.3458120822906494, -0.1839733123779297, -0.7338333129882812, -52.655765533447266, -40.427799224853516, -0.9939994812011719, -0.12392330169677734, 0.1403878927230835, 0.05738377571105957, 0.48247337341308594, 1.0817008018493652, -0.4403810501098633, -0.15918540954589844, -0.638634204864502, -0.167694091796875, 0.49045372009277344, 0.2974627614021301, -0.7576767206192017, -0.4467601776123047, -0.510739803314209, -1.2954864501953125, 2.6505823135375977, -1.7546710968017578, -0.8132419586181641, -0.43616485595703125, 0.20224571228027344, -1.3482589721679688, 0.7434678077697754, -0.12839460372924805, 0.9394267797470093, -0.7951874732971191, -7.545821189880371, 1.4289751052856445, 1.8679237365722656, -0.8025054931640625, -6.553137302398682, -5.913957595825195, 1.9213294982910156, -0.3101992607116699, -0.3503061532974243, -4.911830425262451, -0.09025955200195312, -3.9506654739379883, 0.36838626861572266, -1.167066216468811, -1.1689796447753906, -12.976873397827148, 1.6934800148010254, 0.20165252685546875, 0.2885265350341797, -1.1299352645874023, -5.050346374511719, 1.1941158771514893, 0.04486989974975586, -0.0931243896484375, 0.9098491668701172, -0.5401394367218018, 0.35643434524536133, -0.9405708312988281, -0.6720790863037109, -1.0201644897460938, 0.4055948257446289, -0.09152698516845703, 1.0691337585449219, -0.9379901885986328, -8.7713041305542, 0.16874635219573975, 0.6915435791015625, -1.90740966796875, 0.2836771011352539, 0.7006886005401611, -0.025678634643554688, -0.6383571624755859, 0.1023712158203125, -5.11932373046875, -1.510605812072754, -1.1030349731445312, -0.7830600738525391, -2.714423179626465, 0.915565013885498, -0.83731609582901, 0.3295135498046875, -0.03890717029571533, -1.005648136138916, -0.6296396255493164, -3.184091567993164, 0.27429869771003723, -4.272560119628906, 0.9772825241088867, -4.818515777587891, -0.5647144317626953, -2.205972671508789, 0.4055948257446289, 2.3052597045898438, 0.7921652793884277, 0.10100936889648438, -2.2078094482421875, -1.1385211944580078, -4.709351539611816, 1.1850242614746094, 0.5909380912780762, 0.31862354278564453, -0.6636476516723633, -5.521788597106934, -8.719935417175293, -12.976873397827148, 0.5381901264190674, 0.47200775146484375, -0.4351539611816406, 2.5385398864746094, 0.37814760208129883, 0.7935266494750977, 1.3372020721435547, -1.0418304204940796, 0.9477138519287109, 0.611358642578125, 1.0551624298095703, 3.5983612537384033, 0.1586322784423828, 2.107753038406372, -1.1352782249450684, -2.920968532562256, -1.2760694026947021, -1.1892213821411133, 1.0305910110473633, 0.5463247299194336, -0.3147282004356384, -0.14863157272338867, -0.6843605041503906, 2.3962912559509277, -1.9628047943115234, 4.119876861572266, 0.8198528289794922, -0.09646224975585938, 0.748835563659668, 0.09075379371643066, 0.2471894919872284, 2.304117202758789, 2.1666812896728516, -0.6623306274414062, -0.2145572304725647, 1.7621097564697266, -0.46573829650878906, 1.4802188873291016, 0.8331276178359985, 0.8382420539855957, -1.2659964561462402, -1.1153326034545898, -1.3485383987426758, -4.363269329071045, -0.2195606231689453, 0.9256184101104736, -0.21604394912719727, 0.9330611228942871, 1.1341819763183594, -1.1955642700195312, 0.34458160400390625, 0.8686127662658691, 0.13987159729003906, 1.4477696418762207, 0.3193473815917969, -1.8541221618652344, -0.3011190891265869, -1.5251693725585938, 0.36363697052001953, 0.11064815521240234, 0.36838626861572266, -1.5484695434570312, -7.852094650268555, 1.7621097564697266, 0.6368560791015625, -1.3674144744873047, 1.7341251373291016, -0.37558746337890625, -0.2359762191772461, -1.959254264831543, -16.329029083251953, 1.0710630416870117, -1.1810798645019531, -1.9179277420043945, -2.255218505859375, 0.46051764488220215, 0.4796713590621948, -0.014813423156738281, -1.2091312408447266, 0.03448486328125, 0.9293556213378906, -0.952265739440918, -3.798778533935547, -0.7358970642089844, 0.7469801902770996, -1.0675792694091797, 0.38820648193359375, -0.19043958187103271, -0.23499679565429688, -6.359828948974609, -0.6673011779785156, -2.947249412536621], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 61440, "num_env_steps_trained": 226800, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 226800, "last_target_update_ts": 61440, "num_target_updates": 119}, "sampler_results": {"episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -91.1978322801739, "episode_len_mean": 257.74, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131], "episode_lengths": [345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5340499015773099, "mean_inference_ms": 23.979798671415747, "mean_action_processing_ms": 0.1347293629154835, "mean_env_wait_ms": 4.225433801532467, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -91.1978322801739, "episode_len_mean": 257.74, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-287.3660636022687, -49.685391806066036, 13.611537873744965, 12.210635423660278, 9.700000263750553, -149.96956211328506, -43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131], "episode_lengths": [345, 259, 247, 237, 224, 294, 245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5340499015773099, "mean_inference_ms": 23.979798671415747, "mean_action_processing_ms": 0.1347293629154835, "mean_env_wait_ms": 4.225433801532467, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 226800, "num_env_steps_sampled": 61440, "num_env_steps_trained": 226800, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 61440, "agent_timesteps_total": 61440, "timers": {"training_iteration_time_ms": 345.876, "learn_time_ms": 79.565, "learn_throughput": 3016.403, "synch_weights_time_ms": 20.227}, "counters": {"num_env_steps_sampled": 61440, "num_env_steps_trained": 226800, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 226800, "last_target_update_ts": 61440, "num_target_updates": 119}, "done": false, "episodes_total": 211, "training_iteration": 60, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-23-07", "timestamp": 1655500987, "time_this_iter_s": 5.503777980804443, "time_total_s": 322.08313059806824, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 322.08313059806824, "timesteps_since_restore": 0, "iterations_since_restore": 60, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.325000000000003, "ram_util_percent": 65.4875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.314545631408691, "min_q": -64.49375915527344, "max_q": 29.014089584350586, "mean_td_error": -0.7401087880134583}, "td_error": [0.19286203384399414, 0.9518508911132812, -0.7429187297821045, -0.2738933563232422, -0.5608024597167969, -0.3893852233886719, -2.3246994018554688, -1.4895572662353516, -0.36952877044677734, 0.29386091232299805, -3.679964065551758, -0.5537137985229492, -0.3469963073730469, -0.8684902191162109, 0.07188606262207031, 0.3169097900390625, -1.1141080856323242, 0.39478135108947754, 0.3992600440979004, -6.760526657104492, 7.968855857849121, 1.575058937072754, 5.434288024902344, 0.9890785217285156, -0.6332721710205078, 0.43640708923339844, -0.2782738208770752, 0.7621860504150391, 0.39732885360717773, 0.48134320974349976, -0.42970478534698486, -0.5862555503845215, -0.33272552490234375, -0.4798877239227295, -7.452549457550049, 0.6050806045532227, 0.5768294334411621, -0.8320555686950684, -2.8607969284057617, -0.031080245971679688, -0.08898162841796875, -0.021516084671020508, -2.734980583190918, -0.8310222625732422, 1.1970312595367432, 0.09705758094787598, 0.04576873779296875, -0.6570053100585938, 0.0744781494140625, -1.430008888244629, -0.5937509536743164, -1.1988410949707031, 0.14452171325683594, -1.010756492614746, -0.8813314437866211, -1.0541362762451172, 0.43880224227905273, 0.2474050521850586, -0.21336793899536133, -1.9599814414978027, -1.0163726806640625, -0.5300502777099609, -0.2801227569580078, -0.11754608154296875, -1.1928253173828125, -0.11502695083618164, -1.026468276977539, -0.3197441101074219, -1.761892318725586, -0.33183956146240234, -0.8437957763671875, 1.546116828918457, -1.454200267791748, 0.030069351196289062, 2.1045069694519043, 0.4235072135925293, 0.9333868026733398, 1.3056364059448242, -0.020880460739135742, 0.9234237670898438, -0.3267059326171875, -6.957357406616211, 0.4184713363647461, -0.041185855865478516, -11.991690635681152, 0.14523714780807495, 1.4056129455566406, -0.9015932083129883, 0.05010247230529785, -1.4671173095703125, 0.9414738416671753, 5.288206100463867, -10.933940887451172, -0.7396831512451172, -1.6835966110229492, -0.338134765625, -1.3045339584350586, 0.12417030334472656, -0.6600914001464844, -0.28452014923095703, -2.186786651611328, -0.34678056836128235, -0.25665855407714844, -0.7737808227539062, 4.723667144775391, -0.7680435180664062, 1.305868148803711, -0.8077290058135986, -1.1928253173828125, -1.4328651428222656, 1.0692720413208008, -0.04789924621582031, -0.9462642669677734, 0.3107457160949707, -10.303309440612793, 1.3041810989379883, 0.4418153762817383, -2.1439476013183594, -0.28918933868408203, -1.3119983673095703, 0.08864593505859375, -1.5258054733276367, -0.4177684783935547, -0.08994054794311523, -0.5571010112762451, -2.7066802978515625, -0.1389789581298828, -1.1314640045166016, -0.027035236358642578, 0.6980972290039062, 1.0642671585083008, -0.7551379203796387, -1.2560820579528809, -3.370422840118408, 0.0507054328918457, -0.838043212890625, 0.5803623199462891, -1.2136163711547852, 0.08864593505859375, -7.452549457550049, -0.45217764377593994, -0.14449501037597656, -1.7309398651123047, -0.3620471954345703, -0.15842819213867188, -0.4450216293334961, -2.5007715225219727, 0.7733635902404785, -0.40246331691741943, -0.6264305114746094, 0.6430096626281738, 0.24809789657592773, -0.6400694847106934, 0.7364616394042969, -0.0388331413269043, -1.399881362915039, 0.9518508911132812, -1.3655223846435547, -2.2634806632995605, -0.9668464660644531, -0.012070178985595703, 0.17771339416503906, 0.7818012237548828, -0.30519580841064453, -0.9155006408691406, 0.8890619277954102, 0.2447662353515625, -8.675859451293945, -0.9851541519165039, -0.9830045700073242, -0.32826608419418335, 0.3051466941833496, 0.7763910293579102, 0.7419338226318359, -12.660908699035645, -0.7095966339111328, -2.7337799072265625, -1.8722834587097168, 0.543543815612793, -2.1695117950439453, -3.5095348358154297, 1.9871244430541992, -0.7910337448120117, 0.43683576583862305, 0.0264892578125, -0.9253311157226562, -0.9470853805541992, -0.2517223358154297, 0.06321907043457031, 0.7594423294067383, -1.6146011352539062, -6.932744026184082, -0.3680262565612793, -1.0938806533813477, -0.6654796600341797, -1.9181251525878906, -1.050978660583496, 1.0962448120117188, 1.7952954769134521, -5.136362075805664, -0.8576431274414062, 1.0849361419677734, -0.059317588806152344, -10.48289680480957, -0.3372373580932617, 1.7642805576324463, -1.641434669494629, 9.001806259155273, -6.148359298706055, -0.021844863891601562, 0.43880224227905273, 0.4615292549133301, 1.0860161781311035, 0.08046770095825195, -1.4018797874450684, 0.280181884765625, -4.124578475952148, 0.8999090194702148, 0.28121089935302734, 0.16662979125976562, -0.9105968475341797, -1.1104154586791992, -1.7010536193847656, -7.071755409240723, -0.31052523851394653, 0.015371322631835938, -4.744966506958008, 0.7303942441940308, -0.2891502380371094, -5.617334842681885, 0.4171421527862549, -0.12302017211914062, 0.047974586486816406, -2.1753997802734375, -0.01943349838256836, -0.8500099182128906, -1.6743316650390625, 0.2204681634902954, -0.5627326965332031, 0.2456960678100586], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 62464, "num_env_steps_trained": 230640, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 230640, "last_target_update_ts": 62464, "num_target_updates": 121}, "sampler_results": {"episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -87.31429667301477, "episode_len_mean": 255.37, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264], "episode_lengths": [245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5353570778653854, "mean_inference_ms": 23.975753454717992, "mean_action_processing_ms": 0.1344386867569412, "mean_env_wait_ms": 4.230969377315501, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -87.31429667301477, "episode_len_mean": 255.37, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.36153653264046, -86.83183496445417, -10.345540001988411, -238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264], "episode_lengths": [245, 252, 221, 313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5353570778653854, "mean_inference_ms": 23.975753454717992, "mean_action_processing_ms": 0.1344386867569412, "mean_env_wait_ms": 4.230969377315501, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 230640, "num_env_steps_sampled": 62464, "num_env_steps_trained": 230640, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 62464, "agent_timesteps_total": 62464, "timers": {"training_iteration_time_ms": 337.695, "learn_time_ms": 79.622, "learn_throughput": 3014.228, "synch_weights_time_ms": 20.588}, "counters": {"num_env_steps_sampled": 62464, "num_env_steps_trained": 230640, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 230640, "last_target_update_ts": 62464, "num_target_updates": 121}, "done": false, "episodes_total": 217, "training_iteration": 61, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-23-13", "timestamp": 1655500993, "time_this_iter_s": 5.560908079147339, "time_total_s": 327.6440386772156, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 327.6440386772156, "timesteps_since_restore": 0, "iterations_since_restore": 61, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.612499999999997, "ram_util_percent": 65.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -5.835463523864746, "min_q": -60.05168914794922, "max_q": 33.98342514038086, "mean_td_error": -0.7185343503952026}, "td_error": [1.1025235652923584, 0.13841909170150757, 0.09329700469970703, 1.909468650817871, -0.15053874254226685, -2.2807884216308594, -0.1878504753112793, 0.4110279083251953, 0.1993117332458496, 0.3652932643890381, -2.5230960845947266, 0.12500286102294922, -0.19863414764404297, -0.20214557647705078, -3.7278637886047363, -1.5433311462402344, 0.33278417587280273, 0.7477560043334961, -20.718217849731445, -6.751971244812012, 0.3133971691131592, 0.7306270599365234, -0.5631828308105469, -2.6290812492370605, -0.7171630859375, 0.28401821851730347, 0.789703369140625, -5.293363571166992, -6.603174209594727, 1.859322428703308, -6.178645133972168, 1.489758014678955, -1.2197189331054688, -0.493072509765625, -2.576995849609375, -1.041229248046875, 0.7913401126861572, -2.34149169921875, -0.6636818647384644, -1.0707015991210938, -0.893096923828125, -1.0495290756225586, 0.40111351013183594, 0.19036489725112915, -4.844841480255127, -13.673422813415527, -0.21500492095947266, 0.2312183380126953, -0.11774063110351562, -0.31437015533447266, 0.9723634719848633, -1.9323272705078125, 1.180661678314209, 0.3296394348144531, 0.4672384262084961, -11.612236022949219, -0.8399620056152344, 1.4680595397949219, -13.5817232131958, -4.844841480255127, 0.062027931213378906, 1.180661678314209, -0.2516212463378906, 0.4910106658935547, 1.468595266342163, -5.422481536865234, -1.5266904830932617, 0.7180256843566895, -0.2864980697631836, -0.5463714599609375, 1.2956242561340332, -1.895506739616394, -7.602385520935059, 0.7981324195861816, -0.18281936645507812, 1.1180572509765625, 0.7078509330749512, 0.13644123077392578, -0.14496231079101562, -10.932705879211426, -2.5597362518310547, -0.4511566162109375, 0.5064101219177246, -0.0612943172454834, 3.7269668579101562, 1.1236653327941895, -0.5465030670166016, -0.986339807510376, 0.45956191420555115, 0.08034896850585938, 0.7309889793395996, -0.9502110481262207, 1.0839862823486328, 0.6922256946563721, 0.020485877990722656, 0.5865402221679688, -3.826082229614258, -5.700473785400391, -0.06345367431640625, -0.9668960571289062, 0.2034943699836731, 1.4761216640472412, -0.021282672882080078, 0.48198938369750977, 2.4607248306274414, 0.4398536682128906, -0.38031458854675293, -0.05687713623046875, -0.26339882612228394, -1.2311477661132812, -4.305006980895996, 1.6323285102844238, 1.496333122253418, 1.7699847221374512, -0.4958534240722656, 0.33559179306030273, -1.3232574462890625, 0.8939304351806641, -6.394733428955078, 0.8371000289916992, 0.5405473709106445, -0.19635677337646484, 0.4018135070800781, -3.249889373779297, 0.16165786981582642, -8.817575454711914, 0.8821039199829102, 0.24963641166687012, -0.2820091247558594, -11.150125503540039, 0.2790966033935547, -0.6324672698974609, 0.5970897674560547, 0.5481243133544922, 0.19094610214233398, 0.4398918151855469, -1.049281358718872, -0.11465787887573242, -0.8248472213745117, -0.2829904556274414, 0.4966402053833008, -1.1037979125976562, 7.593330383300781, -0.6113834381103516, -0.4489583969116211, -0.6852383613586426, 1.2611732482910156, 0.5583505630493164, 1.5463190078735352, -1.7271509170532227, -0.1687474250793457, -1.0218608379364014, -0.3788137435913086, 1.154353141784668, 0.2664027214050293, -6.800577163696289, -2.7140254974365234, -0.760498046875, 0.28244972229003906, -0.15250587463378906, 0.5908846855163574, -4.885963439941406, -0.05623340606689453, -10.1475830078125, 0.6447658538818359, -1.2764110565185547, 0.5767623782157898, 0.6518697738647461, -0.1509084701538086, -0.7495765686035156, 0.3038055896759033, 0.7991108894348145, 0.2965278625488281, -0.5372792482376099, -0.024303436279296875, 1.6408467292785645, 0.35222387313842773, -0.5317573547363281, 1.7235698699951172, 0.24032020568847656, 1.046152114868164, 0.6807403564453125, 0.5373134613037109, -0.3279867172241211, 0.45007896423339844, -0.9727268218994141, -2.049687385559082, -2.091446876525879, -1.9350008964538574, -2.1017580032348633, -2.2792797088623047, 0.6650314331054688, -0.6575584411621094, 0.3217802047729492, 0.7259387969970703, 0.9525673389434814, 0.3264029622077942, 0.29204273223876953, 0.29231321811676025, -0.5828762054443359, -6.617579460144043, 0.535743236541748, 0.26949024200439453, -0.08092308044433594, -0.6020102500915527, 0.2602059841156006, -0.3017120361328125, -4.1922454833984375, 0.3565073013305664, 0.46148681640625, -0.0896158218383789, -0.4614577293395996, 0.8611688613891602, 2.592517852783203, 1.4458478689193726, 1.3985872268676758, -0.5828762054443359, 1.8192763328552246, 0.5566673278808594, 0.6927757263183594, 6.925802230834961, 0.1941699981689453, 0.4018135070800781, 0.8360633850097656, 0.2270115613937378, -1.2632408142089844, -0.5892877578735352, 0.6149168014526367, 0.33891725540161133, -0.31599950790405273, -0.22117334604263306, -0.17052364349365234, -0.3618302345275879, 0.8109674453735352, -0.10257196426391602, 0.44643086194992065, 0.3177833557128906, 0.5279121398925781, 0.5067348480224609, 0.1094503402709961], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 63488, "num_env_steps_trained": 234480, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 234480, "last_target_update_ts": 63488, "num_target_updates": 123}, "sampler_results": {"episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -86.26432631343603, "episode_len_mean": 254.71, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555], "episode_lengths": [313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5358173070290282, "mean_inference_ms": 24.003917979687017, "mean_action_processing_ms": 0.1342497883483638, "mean_env_wait_ms": 4.238523282785928, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -86.26432631343603, "episode_len_mean": 254.71, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-238.26063354313374, -85.27475629001856, -446.04666294157505, 9.600000105798244, -191.63471449911594, -74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555], "episode_lengths": [313, 278, 389, 229, 285, 221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5358173070290282, "mean_inference_ms": 24.003917979687017, "mean_action_processing_ms": 0.1342497883483638, "mean_env_wait_ms": 4.238523282785928, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 234480, "num_env_steps_sampled": 63488, "num_env_steps_trained": 234480, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 63488, "agent_timesteps_total": 63488, "timers": {"training_iteration_time_ms": 352.979, "learn_time_ms": 78.901, "learn_throughput": 3041.806, "synch_weights_time_ms": 20.602}, "counters": {"num_env_steps_sampled": 63488, "num_env_steps_trained": 234480, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 234480, "last_target_update_ts": 63488, "num_target_updates": 123}, "done": false, "episodes_total": 220, "training_iteration": 62, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-23-18", "timestamp": 1655500998, "time_this_iter_s": 5.458450078964233, "time_total_s": 333.1024887561798, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 333.1024887561798, "timesteps_since_restore": 0, "iterations_since_restore": 62, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.650000000000002, "ram_util_percent": 65.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -5.8442840576171875, "min_q": -68.2856674194336, "max_q": 27.253625869750977, "mean_td_error": -0.5682543516159058}, "td_error": [-0.5506820678710938, 0.8671424388885498, -11.484075546264648, -0.3799114227294922, 0.7810554504394531, -0.035192251205444336, -13.836213111877441, -0.8449869155883789, 0.9615083932876587, -0.41951751708984375, 0.3449239730834961, -1.7677993774414062, 0.442599892616272, -8.126349449157715, 0.14962339401245117, 1.035294532775879, 0.8915842175483704, 0.6559657454490662, 3.4882688522338867, 0.845053493976593, 0.7895536422729492, 0.2204279899597168, -0.5238895416259766, 1.2518396377563477, -2.4546923637390137, 3.1758155822753906, -14.568014144897461, -1.01800537109375, 1.6673164367675781, 0.026025772094726562, -1.009218692779541, 0.8138089179992676, 0.27826881408691406, 4.382696151733398, 0.4637441635131836, -0.9726829528808594, 1.34600830078125, -2.2514076232910156, 0.7617521286010742, -0.37134742736816406, 0.9143886566162109, 0.19915294647216797, 1.468038558959961, 1.488659381866455, -2.5133767127990723, -2.2154464721679688, 1.0989561080932617, 1.396806001663208, -0.4376811981201172, 0.8556851744651794, -0.7127766609191895, 0.32530784606933594, 0.4781150817871094, 1.351654052734375, 0.7508630752563477, -0.25594139099121094, -0.6647567749023438, 0.3372936248779297, -0.5366497039794922, 0.3956911265850067, 0.09965133666992188, 1.2646484375, 0.0064334869384765625, 0.3526458740234375, -4.160223960876465, -0.11012697219848633, 1.2916603088378906, 0.7121919393539429, 1.331679344177246, -5.997757911682129, 0.3487356901168823, 0.7198233604431152, -0.3309783935546875, -0.36730194091796875, -3.867131233215332, 0.7554330825805664, 1.109893798828125, -0.21541619300842285, 0.4712333679199219, -7.602043151855469, 1.267110824584961, 0.47641754150390625, -0.24525205790996552, -0.08615303039550781, 0.5174708366394043, -0.3280487060546875, -0.2241802215576172, 0.49921727180480957, 0.5394811630249023, -1.0844802856445312, 0.5906805992126465, 0.2745685577392578, 1.4304273128509521, -1.4175262451171875, 0.5909214019775391, 0.5047483444213867, -0.6136751174926758, 0.17376479506492615, 0.07620596885681152, 0.3002033233642578, -0.23935413360595703, -0.12275123596191406, -0.7271294593811035, -0.3041858673095703, 0.5309615135192871, -0.4933028221130371, -0.4932880401611328, 0.8923145532608032, 1.9794731140136719, 1.9303195476531982, 0.510951042175293, -0.9796737432479858, -3.1715002059936523, -0.049008846282958984, 0.53765869140625, -1.0956707000732422, 0.6578159332275391, 1.7820487022399902, 1.6709365844726562, -0.46860504150390625, -0.11116600036621094, -1.9620323181152344, 0.6773734092712402, -0.0684819221496582, -0.6865348815917969, 0.29744577407836914, -1.5359668731689453, 1.3167686462402344, 0.9758830070495605, -7.772791862487793, 0.025079727172851562, -0.04071235656738281, 0.5890216827392578, -1.0632095336914062, -1.3716936111450195, 1.5411086082458496, -0.4383583068847656, 0.5168962478637695, 0.6755803227424622, 1.293172836303711, -1.0854930877685547, 0.5331859588623047, -7.344804763793945, -4.321043014526367, 1.2606165409088135, 0.5162887573242188, -0.08124446868896484, 0.3452017307281494, 0.11254310607910156, -0.5139093399047852, -23.772781372070312, -0.4916229248046875, -0.8729972839355469, 1.6305968761444092, -0.1496753692626953, 0.28681182861328125, 0.14619112014770508, -0.9876174926757812, 1.5011491775512695, 0.27936744689941406, 1.11836838722229, -0.3881797790527344, -2.3970799446105957, -5.164882659912109, 0.06540489196777344, -12.605347633361816, -0.561859130859375, -0.3776092529296875, -9.016457557678223, -10.993696212768555, 2.270449638366699, 0.035007476806640625, -1.0216026306152344, 0.9953746795654297, 0.13237428665161133, -1.4175262451171875, 0.6992511749267578, 0.9110836982727051, 0.21973609924316406, 1.2217063903808594, 0.10099029541015625, -0.6143150329589844, -0.43129920959472656, 0.6960170269012451, 0.5321788787841797, 1.4455031156539917, 0.6618674993515015, 1.3750097751617432, -0.6967096328735352, 0.3072059154510498, -1.5950613021850586, 0.9556045532226562, 0.7507739067077637, 1.9050779342651367, 0.22128570079803467, -0.9405984878540039, 1.0499134063720703, -5.427576541900635, -0.29221343994140625, -0.7843208312988281, -0.8669452667236328, -0.46086668968200684, -14.341989517211914, -0.7263987064361572, -4.16843843460083, -0.9358501434326172, -3.028897285461426, -0.622281551361084, 0.57666015625, 0.7432174682617188, 0.5421676635742188, -0.3706779479980469, 3.1521568298339844, -1.9942702054977417, -0.13129615783691406, -0.04108381271362305, 0.28740501403808594, -0.11012697219848633, -0.5021488666534424, 0.2781829833984375, 1.1106748580932617, -2.284666061401367, 1.5300302505493164, 1.1435909271240234, -0.3309783935546875, 1.6009330749511719, 0.5981121063232422, 0.6336686611175537, -0.3239603042602539, -1.0641098022460938, -3.382870674133301, 1.152602195739746, 0.725257396697998, -0.082855224609375, -0.7521038055419922, 0.35958003997802734, 3.1881542205810547, 0.5583200454711914, 2.5643670558929443, -3.548544406890869], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 238320, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 238320, "last_target_update_ts": 64512, "num_target_updates": 125}, "sampler_results": {"episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -79.68775961562991, "episode_len_mean": 251.79, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375], "episode_lengths": [221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5358856575236697, "mean_inference_ms": 24.004703418147663, "mean_action_processing_ms": 0.13431913077370872, "mean_env_wait_ms": 4.239930775433311, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -79.68775961562991, "episode_len_mean": 251.79, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-74.51682338118553, 4.5000001192092896, -213.01542151719332, 21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375], "episode_lengths": [221, 205, 327, 219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5358856575236697, "mean_inference_ms": 24.004703418147663, "mean_action_processing_ms": 0.13431913077370872, "mean_env_wait_ms": 4.239930775433311, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 238320, "num_env_steps_sampled": 64512, "num_env_steps_trained": 238320, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 64512, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 343.259, "learn_time_ms": 79.788, "learn_throughput": 3007.96, "synch_weights_time_ms": 20.988}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 238320, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 238320, "last_target_update_ts": 64512, "num_target_updates": 125}, "done": false, "episodes_total": 225, "training_iteration": 63, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-23-24", "timestamp": 1655501004, "time_this_iter_s": 5.457033395767212, "time_total_s": 338.559522151947, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 338.559522151947, "timesteps_since_restore": 0, "iterations_since_restore": 63, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.4875, "ram_util_percent": 65.4875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -4.645129203796387, "min_q": -67.86618041992188, "max_q": 27.968706130981445, "mean_td_error": -0.4629620313644409}, "td_error": [-0.0537567138671875, -1.5755443572998047, -2.386678695678711, -5.249128341674805, 0.6194629669189453, 2.504460334777832, -0.438840389251709, -9.212242126464844, 4.283901691436768, 0.6103026866912842, 0.11172604560852051, 2.9007749557495117, 0.44849300384521484, 0.15752124786376953, 1.7522259950637817, 1.625253438949585, -0.9094858169555664, 0.39376068115234375, -0.27966976165771484, 0.37775421142578125, 0.9412803649902344, -0.9805517196655273, 0.7720146179199219, -10.919052124023438, 1.234375, 2.143218994140625, -1.441230297088623, -0.03508949279785156, -0.22607040405273438, -0.0958709716796875, 2.0799078941345215, 1.0868186950683594, -0.1953868865966797, 0.11241436004638672, 0.07851648330688477, 0.3701210021972656, 1.349092960357666, 3.7538795471191406, 0.5022373199462891, 0.2855701446533203, 0.5721549987792969, 0.16076874732971191, -1.2996749877929688, -1.2202868461608887, -0.1573467254638672, 0.06816291809082031, -0.2644667625427246, -0.13159942626953125, 0.7433071136474609, -0.04568380117416382, -0.09982967376708984, -0.4057333469390869, 0.8845639228820801, 14.130823135375977, 0.34764862060546875, 1.366748571395874, -0.006153106689453125, 0.12572702765464783, 0.770801305770874, -1.3571891784667969, -1.1643160581588745, -2.133975028991699, 0.03376197814941406, 0.3798351287841797, 1.104813575744629, -1.906644582748413, 2.813070058822632, -0.7726545333862305, -6.542230606079102, -5.048572540283203, -0.6738681793212891, -0.07573509216308594, 1.5082874298095703, -0.5492522716522217, -0.3548765182495117, -0.438840389251709, 0.13289451599121094, 0.8298559188842773, -2.570436477661133, 0.9021224975585938, -0.35924410820007324, -1.3258018493652344, 1.5846424102783203, 0.47116899490356445, 0.6467944383621216, -0.40008413791656494, -0.1648235321044922, -0.09327316284179688, 1.5846424102783203, 0.5294604301452637, -57.77328872680664, 0.24510860443115234, -0.2840766906738281, 0.5274934768676758, 1.91265869140625, -0.2064342498779297, -0.2109222412109375, 2.2673282623291016, -0.5848312377929688, -0.21220040321350098, -0.2909221649169922, -1.1146087646484375, 0.09158611297607422, 0.5286440849304199, 0.15550708770751953, -5.289087295532227, -0.9657459259033203, 1.528282880783081, 0.4210824966430664, 0.40472412109375, -0.9676480293273926, -0.1535968780517578, 0.24236035346984863, 0.34764862060546875, -0.7656593322753906, 0.98739093542099, 0.4431171417236328, -4.5668230056762695, -2.6841325759887695, 0.15958118438720703, 0.8025369644165039, -8.484546661376953, 0.0836029052734375, -3.1914777755737305, -0.13858604431152344, -0.7222983837127686, -0.0927584171295166, 0.30655670166015625, -0.06391668319702148, -1.1494238376617432, -2.6547417640686035, 0.4306955337524414, 1.3040943145751953, 0.9922504425048828, -0.016045570373535156, -0.3493161201477051, -0.27811741828918457, -0.21420860290527344, 0.2631855010986328, 0.2448444366455078, -0.36364269256591797, -0.036865234375, -1.7716083526611328, 1.668844223022461, -0.3751373291015625, -1.1595687866210938, 1.3540306091308594, 0.1711273193359375, -1.8764045238494873, -0.30138349533081055, -0.5848312377929688, -0.9309659004211426, 1.4023418426513672, 0.612410306930542, -5.304266452789307, -1.678085446357727, 0.8505415916442871, 1.8768845796585083, -4.5528364181518555, -8.832830429077148, 0.7039046287536621, 1.2973103523254395, 1.0105706453323364, -0.4307670593261719, 3.1072378158569336, 0.40301513671875, -1.4717564582824707, 0.9666037559509277, 0.6143169403076172, -0.523104190826416, 0.5865707397460938, 0.032100677490234375, -0.44878673553466797, 0.607342541217804, -0.5678110122680664, -3.174274444580078, 1.1165580749511719, 2.1128599643707275, -0.7717580795288086, 0.16209030151367188, -2.2772512435913086, -0.6513659954071045, -7.577773094177246, 0.8288230895996094, 3.278230667114258, 0.4240231513977051, 0.30814123153686523, 1.040924310684204, 1.08809232711792, 0.6695041656494141, 0.42685937881469727, -0.22916412353515625, 0.6126060485839844, -0.7267570495605469, -0.45032691955566406, -0.8687543869018555, 0.4999656677246094, -2.1586179733276367, -7.132652282714844, 0.27229028940200806, 0.007542610168457031, -0.30297422409057617, 0.7631402015686035, -0.32209014892578125, 0.6249017715454102, 0.8316564559936523, 1.3191074132919312, -0.41854095458984375, -0.18951034545898438, -1.2396689653396606, 0.2581477165222168, -0.5035626888275146, 1.046703815460205, 0.31185197830200195, 0.2579832077026367, -6.777111053466797, 2.4555797576904297, -0.12523412704467773, -0.13547992706298828, 0.12638139724731445, 0.4212226867675781, -0.7259340286254883, 0.9532890319824219, 0.6704940795898438, -0.29929065704345703, 5.616254806518555, -1.127871036529541, 2.546144962310791, -10.280916213989258, 0.5761147737503052, -1.0208349227905273, -0.4613776206970215, 1.249049186706543, -1.1684598922729492, -0.07573509216308594, -1.0207099914550781, 2.0623574256896973, -0.1630573272705078, 0.9477485418319702, -0.5657792091369629], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 65536, "num_env_steps_trained": 242160, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 242160, "last_target_update_ts": 65536, "num_target_updates": 127}, "sampler_results": {"episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -78.71851088665426, "episode_len_mean": 251.42, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626], "episode_lengths": [219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5368645754982966, "mean_inference_ms": 23.997745940591326, "mean_action_processing_ms": 0.13397426211468602, "mean_env_wait_ms": 4.2417885441821745, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -78.71851088665426, "episode_len_mean": 251.42, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.988641194999218, 18.118390768766403, -95.67217180132866, 25.21153800934553, -98.7561755925417, -135.5486105158925, -709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626], "episode_lengths": [219, 228, 268, 215, 288, 278, 436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5368645754982966, "mean_inference_ms": 23.997745940591326, "mean_action_processing_ms": 0.13397426211468602, "mean_env_wait_ms": 4.2417885441821745, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 242160, "num_env_steps_sampled": 65536, "num_env_steps_trained": 242160, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 65536, "agent_timesteps_total": 65536, "timers": {"training_iteration_time_ms": 349.439, "learn_time_ms": 79.668, "learn_throughput": 3012.488, "synch_weights_time_ms": 19.989}, "counters": {"num_env_steps_sampled": 65536, "num_env_steps_trained": 242160, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 242160, "last_target_update_ts": 65536, "num_target_updates": 127}, "done": false, "episodes_total": 228, "training_iteration": 64, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-23-30", "timestamp": 1655501010, "time_this_iter_s": 5.401797294616699, "time_total_s": 343.9613194465637, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 343.9613194465637, "timesteps_since_restore": 0, "iterations_since_restore": 64, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 31.885714285714283, "ram_util_percent": 65.48571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.712252616882324, "min_q": -69.54795837402344, "max_q": 28.69324493408203, "mean_td_error": -4.026571750640869}, "td_error": [2.283977508544922, 2.8769402503967285, 0.8379287719726562, 0.519504964351654, -2.224100112915039, 1.6234607696533203, 1.4525032043457031, 1.0579471588134766, -1.8934307098388672, -0.9020075798034668, 0.004047393798828125, -0.1550769805908203, 0.496915340423584, -2.1096179485321045, 2.6577320098876953, 0.13957977294921875, 0.20800113677978516, 1.0943043231964111, -6.3753533363342285, 1.6648540496826172, 0.6417112350463867, 0.9431122541427612, 0.14729762077331543, -0.4365997314453125, 1.3057012557983398, -0.32632994651794434, 2.3665056228637695, 0.23266220092773438, 1.3799171447753906, 1.989767074584961, -6.593935012817383, -0.10875654220581055, -0.4922456741333008, -0.05418682098388672, 1.6898298263549805, 0.1481800079345703, 0.3466029167175293, 1.7323369979858398, 1.2284164428710938, 1.0509920120239258, 0.4020376205444336, -1.0688810348510742, -8.572912216186523, -0.7508821487426758, 0.6764018535614014, 0.1969335377216339, -10.012737274169922, -0.528864860534668, 0.5664272308349609, 2.087972640991211, 0.03186243772506714, -0.08053255081176758, 0.16358232498168945, 0.4424781799316406, 0.5656890869140625, -0.5370349884033203, -0.445465087890625, 1.0627436637878418, 0.3591136932373047, 0.8126392364501953, -0.021396160125732422, 0.48018455505371094, -0.1946401596069336, 0.4562220573425293, 0.8569736480712891, 2.4722328186035156, 0.014218330383300781, 2.129110336303711, 0.054270267486572266, -2.4218311309814453, -4.701045036315918, 0.7076187133789062, 0.4513263702392578, 0.2982940673828125, 0.2622337341308594, 0.4069375991821289, 0.9831700325012207, -2.770296096801758, 0.8413352966308594, 2.2161169052124023, 0.6039266586303711, 0.7076187133789062, 0.3100895881652832, 1.0047225952148438, 0.5435428619384766, 0.6309454441070557, 0.03427696228027344, 0.5360660552978516, -0.42902421951293945, 0.47925376892089844, -0.19484329223632812, 0.8438310623168945, 1.0521605014801025, 0.3783407211303711, 0.8152875900268555, -0.7840843200683594, 0.2887763977050781, -0.22931599617004395, 0.7061843872070312, 1.7889958620071411, 0.41074419021606445, 0.8176612854003906, 0.11528730392456055, 0.8177652359008789, -0.8250331878662109, -0.24097061157226562, -0.23296475410461426, 2.708963394165039, -3.1338844299316406, -0.08721542358398438, -0.27420997619628906, -0.23836517333984375, 1.3057012557983398, 0.6258783340454102, -4.357660293579102, 0.4267573356628418, -1.330587387084961, 3.886538505554199, -0.04876232147216797, -0.006961822509765625, 0.2942013740539551, 1.8398098945617676, -995.4839477539062, 2.959425449371338, -0.031838417053222656, 0.2285020351409912, 1.6874651908874512, 0.20083236694335938, -0.5634479522705078, 1.3647537231445312, 1.1429719924926758, 0.7510948181152344, -6.543916702270508, 1.1394767761230469, 0.7829141616821289, 0.5842018127441406, 1.8652820587158203, 0.7779960632324219, 2.033763885498047, 0.42537105083465576, -0.573577880859375, 0.40233898162841797, 0.7709999084472656, 0.32323646545410156, 0.9117431640625, 0.6408491134643555, -0.13368606567382812, 6.113827705383301, 0.6309454441070557, 0.8868732452392578, 0.015995264053344727, -0.7522678375244141, 0.873321533203125, 0.33605194091796875, -0.6050262451171875, 2.1047005653381348, -0.4663381576538086, 0.21842384338378906, 0.34529125690460205, 0.6228418350219727, 0.4760169982910156, 0.7492809295654297, 1.6919212341308594, -0.5678718090057373, -0.19264602661132812, 1.2811737060546875, 1.0297088623046875, -2.237786293029785, -0.4530949592590332, 0.15247154235839844, -3.323866844177246, 0.8588709831237793, 0.12068605422973633, 0.3226776123046875, 0.7767202854156494, 0.9619283676147461, 0.19083690643310547, 1.2063426971435547, 0.5017998814582825, 4.094429016113281, 0.27618980407714844, -1.5660114288330078, 0.8750431537628174, -0.06800508499145508, -0.20229005813598633, 1.2527668476104736, 1.179773211479187, -8.396581649780273, -0.021478652954101562, 0.8341841697692871, -0.24097061157226562, 1.8921303749084473, 1.0304155349731445, -0.9305287599563599, 0.6726655960083008, 0.5114803314208984, 0.09776496887207031, 0.3693380355834961, -0.1993119716644287, 0.7061843872070312, 1.7692205905914307, 0.03522491455078125, -0.05946159362792969, -3.051271438598633, -2.4334583282470703, 1.3429327011108398, 0.7938461303710938, -0.6074497699737549, -0.35873985290527344, 2.6763992309570312, -8.493965148925781, 0.6369590759277344, 0.7191275358200073, -1.184865951538086, 1.5681524276733398, 1.4715747833251953, 1.6494174003601074, 0.914456844329834, -2.4475860595703125, -1.6543197631835938, 1.2097139358520508, -0.16853857040405273, -0.30077648162841797, 0.204437255859375, -2.8054704666137695, 0.325101375579834, 0.2569293975830078, 0.07420229911804199, -2.562722682952881, 0.8499698638916016, -0.08714786171913147, -0.20917320251464844, 0.9113979339599609, -0.3364276885986328, -0.10913848876953125, 2.2245874404907227, -0.17418694496154785, 0.4441032409667969, -1.3625574111938477, 0.3523283004760742], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 66560, "num_env_steps_trained": 246000, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 246000, "last_target_update_ts": 66560, "num_target_updates": 129}, "sampler_results": {"episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -79.94140959598124, "episode_len_mean": 250.66, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678], "episode_lengths": [436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5376649475781018, "mean_inference_ms": 23.993234175065954, "mean_action_processing_ms": 0.13362372749320003, "mean_env_wait_ms": 4.245862545827796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 35.03449060767889, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -79.94140959598124, "episode_len_mean": 250.66, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-709.3029132932425, -252.01235119998455, 35.03449060767889, -221.38710739463568, -3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678], "episode_lengths": [436, 340, 229, 334, 230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5376649475781018, "mean_inference_ms": 23.993234175065954, "mean_action_processing_ms": 0.13362372749320003, "mean_env_wait_ms": 4.245862545827796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 246000, "num_env_steps_sampled": 66560, "num_env_steps_trained": 246000, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 66560, "agent_timesteps_total": 66560, "timers": {"training_iteration_time_ms": 347.084, "learn_time_ms": 80.0, "learn_throughput": 2999.99, "synch_weights_time_ms": 21.0}, "counters": {"num_env_steps_sampled": 66560, "num_env_steps_trained": 246000, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 246000, "last_target_update_ts": 66560, "num_target_updates": 129}, "done": false, "episodes_total": 234, "training_iteration": 65, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-23-35", "timestamp": 1655501015, "time_this_iter_s": 5.658802270889282, "time_total_s": 349.620121717453, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 349.620121717453, "timesteps_since_restore": 0, "iterations_since_restore": 65, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.03333333333333, "ram_util_percent": 65.48888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.10531759262085, "min_q": -73.80335235595703, "max_q": 28.07763671875, "mean_td_error": -7.773311138153076}, "td_error": [-0.034749507904052734, 0.10583829879760742, 3.4397926330566406, -0.5862245559692383, 1.492598533630371, 2.216707229614258, 0.19917082786560059, 1.222930908203125, 3.3881142139434814, 0.8089705109596252, 1.9670562744140625, 4.508127689361572, 1.5238990783691406, -0.694016695022583, 0.62261962890625, 0.4885941743850708, 2.6437461376190186, 0.21667718887329102, 0.3920149803161621, 2.2487430572509766, -3.3062686920166016, 0.05121469497680664, 0.022808879613876343, -0.4026370644569397, 0.8311767578125, -0.7961807250976562, 1.5580673217773438, -2.086000442504883, -10.177318572998047, -0.08665704727172852, 1.5451741218566895, 2.6345338821411133, -0.17868256568908691, -0.10830879211425781, 0.7791166305541992, -0.8496475219726562, -6.941266059875488, -1.6629703044891357, 0.4984321594238281, 0.7336466312408447, 1.4814683198928833, 0.03333771228790283, 0.8900535106658936, 1.6034655570983887, 0.6328468322753906, 0.7263079881668091, -0.012875616550445557, 0.5535984039306641, -5.484626770019531, 1.0226778984069824, 3.1214656829833984, -0.6534578800201416, -0.2580021917819977, -10.82497501373291, 2.0936942100524902, 0.11854073405265808, -1.2541637420654297, 0.6374068260192871, -0.9948716163635254, 1.557657241821289, -0.45201563835144043, -0.21088600158691406, -0.7886092662811279, 1.9198493957519531, 1.8736038208007812, -0.3964967727661133, 0.9910826683044434, 0.2486933469772339, 2.9896860122680664, -5.913599967956543, 3.2791762351989746, 0.4039287567138672, 0.23399043083190918, 0.6984903216362, 2.2119598388671875, 1.2820243835449219, 1.9438397884368896, 1.1817913055419922, -0.03511762619018555, 2.0825653076171875, 2.8017215728759766, 1.2435340881347656, 0.1327512264251709, 0.9514873623847961, 2.8592634201049805, 2.3635644912719727, 1.14764404296875, 1.0293197631835938, 0.2042551040649414, 3.1667747497558594, -0.8157641887664795, -8.965190887451172, 3.44315242767334, 2.5922317504882812, 3.927083969116211, -0.50006103515625, 0.3742084503173828, 0.5511958599090576, -0.8922500610351562, 1.9594311714172363, 0.8319768905639648, -0.03366661071777344, 1.8544158935546875, 3.5243911743164062, 0.9379065036773682, 2.398045063018799, 1.0607376098632812, 2.4622983932495117, 1.3129215240478516, 3.245412826538086, 0.058872222900390625, 0.703474760055542, 1.3811365365982056, -0.5545814037322998, 0.15097332000732422, 1.9254159927368164, 1.2106494903564453, 1.4425029754638672, -0.32808494567871094, 4.560259819030762, 0.4884970188140869, 0.6947845220565796, 1.9554624557495117, 2.2150745391845703, 0.5233268737792969, -1.1734189987182617, 3.1565418243408203, 0.2709333896636963, 0.7171404361724854, 1.4010367393493652, 3.121649742126465, -0.22273492813110352, -9.910795211791992, -0.5251874923706055, -0.43671703338623047, 2.3304977416992188, 3.3465747833251953, 0.5202493667602539, -0.044656991958618164, 0.2681159973144531, -0.04886150360107422, -0.4111066460609436, -0.13148975372314453, 2.621447801589966, -0.21874737739562988, 0.28545892238616943, -1.246068000793457, -1.175461769104004, 0.5164773464202881, -0.01359701156616211, 0.24590420722961426, 0.9361801147460938, 0.6884040832519531, 0.3079911470413208, 2.6467323303222656, 1.3237327337265015, -0.19289398193359375, -0.852513313293457, -0.27607059478759766, -0.8410868644714355, -0.46219825744628906, -6.956638336181641, -0.9689526557922363, 1.6582956314086914, 3.114150047302246, -4.396341323852539, -2.002906322479248, 1.587794303894043, -0.3232218027114868, 1.07086181640625, 0.27993297576904297, 3.245412826538086, 0.6088075637817383, -0.013132333755493164, -0.6544466018676758, 1.0453205108642578, 2.3933944702148438, 4.317375183105469, 0.7031738758087158, 0.19899606704711914, 0.33796215057373047, 1.1537818908691406, -1.0107660293579102, 1.2126455307006836, 1.4439888000488281, 1.193838119506836, 0.9946212768554688, 2.3952693939208984, -0.040663719177246094, 1.68988037109375, 3.089000701904297, -0.8890156149864197, -997.123291015625, 2.967266082763672, -1.6583213806152344, 0.2286672592163086, 1.1359825134277344, -0.3140248954296112, 0.8314745426177979, 1.4995489120483398, -0.7427492141723633, -997.123291015625, 1.2115769386291504, -0.23908472061157227, 0.0628652572631836, -0.7394723892211914, 2.027202606201172, 1.420926570892334, -0.10748815536499023, 0.41187024116516113, 4.176267623901367, 1.1550750732421875, -1.534724235534668, 2.304060935974121, -0.635467529296875, 2.901510238647461, 1.0138397216796875, -1.9760284423828125, 0.8381423950195312, 0.5416414141654968, 0.8515109419822693, 1.3784494400024414, 0.47360706329345703, -0.21309471130371094, 1.3784494400024414, 0.3033781051635742, -0.33289486169815063, 1.0113906860351562, 0.25665009021759033, -0.546135425567627, 0.10658687353134155, 1.839212417602539, -0.17007088661193848, 1.4938700199127197, 2.670649528503418, -0.23386383056640625, 0.16106510162353516, 5.691853046417236, 0.8953523635864258, 3.4965381622314453], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 67584, "num_env_steps_trained": 249840, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 249840, "last_target_update_ts": 67584, "num_target_updates": 131}, "sampler_results": {"episode_reward_max": 28.386056430637836, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -71.7535232821852, "episode_len_mean": 247.31, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668], "episode_lengths": [230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5385440997751806, "mean_inference_ms": 24.014678230960655, "mean_action_processing_ms": 0.1337275270963183, "mean_env_wait_ms": 4.250036851407108, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 28.386056430637836, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -71.7535232821852, "episode_len_mean": 247.31, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.835807017982006, -268.35399524122477, -3.478729024529457, -70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668], "episode_lengths": [230, 355, 248, 260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5385440997751806, "mean_inference_ms": 24.014678230960655, "mean_action_processing_ms": 0.1337275270963183, "mean_env_wait_ms": 4.250036851407108, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 249840, "num_env_steps_sampled": 67584, "num_env_steps_trained": 249840, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 67584, "agent_timesteps_total": 67584, "timers": {"training_iteration_time_ms": 347.088, "learn_time_ms": 80.813, "learn_throughput": 2969.831, "synch_weights_time_ms": 20.992}, "counters": {"num_env_steps_sampled": 67584, "num_env_steps_trained": 249840, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 249840, "last_target_update_ts": 67584, "num_target_updates": 131}, "done": false, "episodes_total": 238, "training_iteration": 66, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-23-41", "timestamp": 1655501021, "time_this_iter_s": 5.882142066955566, "time_total_s": 355.50226378440857, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 355.50226378440857, "timesteps_since_restore": 0, "iterations_since_restore": 66, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.275, "ram_util_percent": 65.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.889005661010742, "min_q": -74.64509582519531, "max_q": 30.32270050048828, "mean_td_error": -0.8169387578964233}, "td_error": [-1.5548391342163086, -0.3066377639770508, -0.6893100738525391, -0.5694952011108398, 0.3162417411804199, -0.3759537935256958, -10.815139770507812, -0.3888540267944336, 0.5566542148590088, 4.542084693908691, -0.5459680557250977, -0.19688814878463745, 0.5343782901763916, 0.24074554443359375, 0.06362009048461914, -0.747344970703125, -6.991309642791748, -0.3744173049926758, 0.5154819488525391, -0.07802391052246094, -0.021190643310546875, -5.859380722045898, -0.8836441040039062, -0.44116878509521484, -1.5100741386413574, -0.2559967041015625, -1.645457148551941, -0.1571628898382187, 0.5918431282043457, 0.21090275049209595, -7.415196895599365, -1.1403999328613281, -0.14651107788085938, 0.7446324825286865, -1.841521978378296, -0.6643261909484863, -1.3382422924041748, -8.589784622192383, -0.7765321731567383, 0.3708038330078125, -0.10030937194824219, -1.2973074913024902, 0.8469676971435547, 0.4006316661834717, -0.3516833782196045, -2.6596856117248535, -0.48801136016845703, 0.024621963500976562, 0.7319869995117188, 0.16497802734375, -2.8154220581054688, 0.07454854995012283, -0.8301143646240234, -1.2577781677246094, 1.089005470275879, 0.9218562841415405, -0.6680202484130859, -1.1839122772216797, 0.3620452880859375, 3.4320359230041504, 0.15619659423828125, 0.43762701749801636, -0.18695831298828125, -0.4805755615234375, 0.9043294787406921, -0.14439964294433594, -16.075119018554688, -6.646632194519043, 0.8358936309814453, -0.3697376251220703, -0.5433139801025391, -8.54269027709961, -7.135929107666016, -0.10039889812469482, -6.714666366577148, -1.242403507232666, -1.1349787712097168, 0.16045188903808594, 0.8617439270019531, 0.607980489730835, -0.4299325942993164, -4.167645454406738, -1.0230846405029297, -0.8548688888549805, 0.7662982940673828, -2.221284866333008, -0.6944704055786133, 0.08855915069580078, -0.1673734188079834, 0.1616687774658203, -7.028041839599609, 1.7407069206237793, -1.3413143157958984, 1.7757601737976074, 0.11165058612823486, -0.074432373046875, -0.0018815994262695312, -0.6059179306030273, -4.785388946533203, -0.012653350830078125, -0.25728678703308105, 0.4624333381652832, -0.4329721927642822, -1.528717041015625, -0.5034890174865723, -0.9825162887573242, -0.5662577152252197, 0.13925409317016602, -0.7765884399414062, 0.8168201446533203, -0.30585718154907227, -6.2404279708862305, -0.012033939361572266, -0.8821932077407837, -10.521283149719238, -9.64480972290039, -0.3018159866333008, 0.10093557834625244, -0.5262718200683594, 0.8478584289550781, -0.37754392623901367, -0.5136723518371582, 0.5743980407714844, -1.002744197845459, 0.5015154480934143, -0.6976771354675293, 0.8977603912353516, -0.6428394317626953, -0.2294921875, -1.2321102619171143, -0.47035789489746094, 0.7135219573974609, 0.5573956370353699, -0.6289892196655273, -0.0638580322265625, -0.5606727600097656, -1.2800025939941406, -0.6710391044616699, -0.11871743202209473, 0.7035820484161377, 0.5955467224121094, -0.518162727355957, 0.39444684982299805, 0.8618907928466797, -0.7012786865234375, 0.1271533966064453, 0.07056236267089844, -0.6160404682159424, -0.4901275634765625, -0.27539753913879395, 0.047664642333984375, 0.44380879402160645, 0.4017972946166992, 0.5015154480934143, -1.1342830657958984, 0.15404939651489258, -0.68804931640625, 0.6305575966835022, -0.6983766555786133, 0.3708038330078125, 0.36294788122177124, -2.373218536376953, -0.4714622497558594, -1.0185980796813965, -0.2969503402709961, -0.3283357620239258, 0.09132051467895508, -0.4706878662109375, -0.30547142028808594, 0.6836138963699341, 1.1233367919921875, -0.07577896118164062, 1.3406071662902832, 0.6409463882446289, -1.0421724319458008, 0.83380126953125, -1.5216156244277954, 0.600834846496582, -0.14714431762695312, -0.4008002281188965, 0.9761567115783691, -13.443766593933105, -10.404397964477539, 0.30036163330078125, -1.3601021766662598, 1.6382331848144531, -0.980621337890625, -0.3983583450317383, -0.1195831298828125, -1.823974609375, -0.8536472320556641, -1.6278495788574219, -0.5564140677452087, -1.3519058227539062, 0.48905444145202637, -1.015909194946289, 0.5277409553527832, 0.4508061408996582, -0.6970081329345703, -0.2071075439453125, 0.510615348815918, -0.6996402740478516, 0.16425466537475586, 0.25397276878356934, -0.5220375061035156, -1.12066650390625, -0.49796801805496216, -0.05070972442626953, 0.9879546165466309, -1.0268049240112305, 1.5867815017700195, 0.9656734466552734, -2.2532455921173096, 0.035447120666503906, 0.5922255516052246, -1.4549694061279297, -0.764271080493927, 0.9032344818115234, -0.650977611541748, 0.6700878143310547, -0.049221038818359375, -0.2560920715332031, -2.1334571838378906, 0.8405656814575195, -0.3402395248413086, -0.9103336334228516, -0.519439697265625, -0.8559188842773438, 0.19278907775878906, 0.037274837493896484, -0.26664161682128906, 0.11253213882446289, -1.645457148551941, -1.281813621520996, 0.3645925521850586, -1.5630970001220703, -1.4409894943237305, 0.20199012756347656, 0.050113677978515625, 0.5345563888549805], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 68608, "num_env_steps_trained": 253680, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 253680, "last_target_update_ts": 68608, "num_target_updates": 133}, "sampler_results": {"episode_reward_max": 28.386056430637836, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -70.60405858397483, "episode_len_mean": 246.75, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179], "episode_lengths": [260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5381744388767676, "mean_inference_ms": 24.030556254393428, "mean_action_processing_ms": 0.1339202226411852, "mean_env_wait_ms": 4.254650355767123, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 28.386056430637836, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -70.60405858397483, "episode_len_mean": 246.75, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-70.02119912952185, 2.2000001668930054, -16.849295683205128, 15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179], "episode_lengths": [260, 237, 231, 230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5381744388767676, "mean_inference_ms": 24.030556254393428, "mean_action_processing_ms": 0.1339202226411852, "mean_env_wait_ms": 4.254650355767123, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 253680, "num_env_steps_sampled": 68608, "num_env_steps_trained": 253680, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 68608, "agent_timesteps_total": 68608, "timers": {"training_iteration_time_ms": 344.002, "learn_time_ms": 79.644, "learn_throughput": 3013.398, "synch_weights_time_ms": 20.178}, "counters": {"num_env_steps_sampled": 68608, "num_env_steps_trained": 253680, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 253680, "last_target_update_ts": 68608, "num_target_updates": 133}, "done": false, "episodes_total": 241, "training_iteration": 67, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-23-47", "timestamp": 1655501027, "time_this_iter_s": 5.43456768989563, "time_total_s": 360.9368314743042, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 360.9368314743042, "timesteps_since_restore": 0, "iterations_since_restore": 67, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.4625, "ram_util_percent": 65.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -7.089879512786865, "min_q": -67.79296112060547, "max_q": 34.51189422607422, "mean_td_error": -4.333993434906006}, "td_error": [1.5199756622314453, -1.144120693206787, -0.017118215560913086, 0.4064168334007263, -0.3004283905029297, 0.09965896606445312, 0.11324501037597656, -0.0721597671508789, 0.7058985829353333, -1.39560866355896, 1.0265283584594727, 0.47966575622558594, -1.3625433444976807, 1.21632719039917, 0.44229698181152344, 2.3359603881835938, 0.14278125762939453, 0.8181642293930054, -0.11781692504882812, 0.7007598876953125, -0.4352388381958008, -5.911556243896484, 1.0915679931640625, 0.3157196044921875, 2.607937812805176, 0.5301625728607178, -1.3625433444976807, -1.5874824523925781, 0.14305591583251953, 1.4256914854049683, -3.764232635498047, 0.4185037612915039, 0.22214281558990479, 0.5067281723022461, -0.09126472473144531, 0.7138748168945312, -0.13084173202514648, -3.358126640319824, 0.00997161865234375, -0.019585609436035156, 1.5776939392089844, -0.06846141815185547, 1.8745942115783691, 1.762507438659668, -0.3995628356933594, -0.005951046943664551, -0.028644084930419922, -0.6953840255737305, 0.7059135437011719, 1.492971420288086, 1.9572162628173828, 1.165945053100586, 1.0430974960327148, 0.1822190284729004, -1.4002761840820312, 1.2695560455322266, -1.0127801895141602, 0.31191349029541016, -11.069931983947754, -1.5526084899902344, -0.06467628479003906, 0.39153069257736206, 0.3602724075317383, 0.6811786890029907, 0.1607685089111328, 0.7721872329711914, -0.4523582458496094, 0.2193772792816162, 1.0788536071777344, 0.5097885131835938, 0.6851568222045898, -2.3110790252685547, -0.6580915451049805, 0.27051210403442383, 0.2707061767578125, 0.4722709655761719, -8.880017280578613, -0.0138092041015625, 0.1965780258178711, 0.1935572624206543, 0.7675666809082031, -0.8704233169555664, 0.2698891758918762, 0.10511302947998047, 0.6951084136962891, -1.4041776657104492, -0.019412994384765625, 0.3156803250312805, -0.13002057373523712, -0.26118969917297363, -1.4021739959716797, 0.6475791931152344, 0.5914198160171509, 0.07771247625350952, 0.1638031005859375, -1.7445945739746094, -14.040782928466797, 0.5834121704101562, -0.07100486755371094, -0.11781692504882812, 1.9323697090148926, 0.3228569030761719, -0.8675110340118408, 2.024900197982788, -0.10451698303222656, -1.2944679260253906, -0.1486501693725586, 0.21213912963867188, -0.08089977502822876, 3.6296310424804688, 0.29239851236343384, -0.20035862922668457, -0.9876003265380859, 2.619171142578125, 0.8463592529296875, 0.8584151268005371, 0.5179355144500732, 0.061145782470703125, 1.1361732482910156, 0.25363969802856445, -0.20490455627441406, -0.32991886138916016, 1.0237979888916016, -0.37737512588500977, -1.0218868255615234, 0.2966146469116211, -0.08143258094787598, 2.241058588027954, -1.7464752197265625, -13.322311401367188, 1.6339712142944336, 0.2650108337402344, -1.0423660278320312, 0.020792007446289062, 0.6705389022827148, 1.2300262451171875, -1.1148576736450195, -1.290384292602539, 1.808450698852539, 1.5366826057434082, 0.16722822189331055, 0.8764973878860474, 0.22043251991271973, 0.5520040988922119, 1.0452990531921387, -0.13033688068389893, -0.08991241455078125, -0.16538333892822266, 1.3189592361450195, 0.4786282777786255, 1.3438644409179688, 0.048389434814453125, -0.09989166259765625, 0.9111251831054688, 0.916254997253418, 0.013673782348632812, -0.3022880554199219, 1.6680030822753906, 0.17778491973876953, 0.4383554458618164, -1.2353582382202148, 0.43138575553894043, -0.9172267913818359, 0.011503219604492188, -1.2289047241210938, -0.35799598693847656, -0.5792922973632812, -2.1863231658935547, -0.32616233825683594, 2.8286705017089844, -0.2726154327392578, 0.17648005485534668, 1.598454475402832, 0.38821983337402344, 0.16126370429992676, -2.0444047451019287, -0.3403644561767578, -5.812742233276367, -1.4899693727493286, 0.4441366195678711, -0.10602831840515137, 0.17998605966567993, -0.2812786102294922, -6.803490161895752, 2.162468433380127, -0.3785848617553711, 0.525238037109375, 1.5018301010131836, -0.35068726539611816, 0.015176773071289062, -0.45030832290649414, -0.20740699768066406, -0.7846736907958984, -0.48389625549316406, 1.6757469177246094, -996.084228515625, 0.3759593963623047, 1.7222883701324463, -0.13384246826171875, 0.5913717746734619, -6.9272565841674805, 0.718548595905304, 1.073601484298706, 0.17243075370788574, -6.663703918457031, 0.7890901565551758, -0.04581928253173828, -3.115100860595703, -1.6703310012817383, 0.22655105590820312, -7.847530364990234, -0.49768543243408203, -0.43182802200317383, -1.2702980041503906, -0.03304028511047363, 0.4077794551849365, -0.28391265869140625, 0.4583728313446045, 2.7401771545410156, 2.096066474914551, -0.23227882385253906, -0.10039687156677246, 0.3642082214355469, 0.28000736236572266, 0.6158236265182495, 0.7470769882202148, 2.165534019470215, 0.12668418884277344, 0.4267895221710205, -0.2946929931640625, -0.48389625549316406, 0.4585990905761719, -0.0440216064453125, -0.4935169219970703, 0.3180882930755615, -0.43159782886505127, 0.6101253032684326, 0.8549270629882812, 1.3438644409179688, -0.8979301452636719], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 69632, "num_env_steps_trained": 257520, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 257520, "last_target_update_ts": 69632, "num_target_updates": 135}, "sampler_results": {"episode_reward_max": 28.386056430637836, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -71.7163721267134, "episode_len_mean": 246.35, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693], "episode_lengths": [230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5385658866790334, "mean_inference_ms": 24.02977604216486, "mean_action_processing_ms": 0.13349278865539593, "mean_env_wait_ms": 4.256174126726391, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 28.386056430637836, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -71.7163721267134, "episode_len_mean": 246.35, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.20090277493, -140.15378127247095, 7.100000217556953, 5.200000084936619, -120.26967296749353, -27.98539189249277, 22.778006106615067, -250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693], "episode_lengths": [230, 285, 238, 195, 274, 223, 234, 318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5385658866790334, "mean_inference_ms": 24.02977604216486, "mean_action_processing_ms": 0.13349278865539593, "mean_env_wait_ms": 4.256174126726391, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 257520, "num_env_steps_sampled": 69632, "num_env_steps_trained": 257520, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 69632, "agent_timesteps_total": 69632, "timers": {"training_iteration_time_ms": 350.554, "learn_time_ms": 80.584, "learn_throughput": 2978.262, "synch_weights_time_ms": 20.289}, "counters": {"num_env_steps_sampled": 69632, "num_env_steps_trained": 257520, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 257520, "last_target_update_ts": 69632, "num_target_updates": 135}, "done": false, "episodes_total": 244, "training_iteration": 68, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-23-53", "timestamp": 1655501033, "time_this_iter_s": 5.430967807769775, "time_total_s": 366.367799282074, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 366.367799282074, "timesteps_since_restore": 0, "iterations_since_restore": 68, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.05, "ram_util_percent": 65.66250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.452435493469238, "min_q": -77.7474365234375, "max_q": 32.839691162109375, "mean_td_error": -0.9990478754043579}, "td_error": [0.03540849685668945, -5.622410774230957, -0.16815185546875, -5.863669395446777, -0.26143455505371094, -1.1597728729248047, 0.8761682510375977, -1.343674659729004, -0.04204368591308594, 1.5856471061706543, 0.2438732385635376, 0.8917603492736816, -0.36565399169921875, -0.49661290645599365, 0.11187088489532471, -0.21074724197387695, -0.9385795593261719, -0.5757312774658203, -0.438018798828125, -0.7468357086181641, -1.3967628479003906, -0.5130364894866943, 1.5856471061706543, -1.6653766632080078, 3.3833255767822266, -1.3195576667785645, -0.2431507110595703, -4.165979385375977, 0.25769615173339844, 0.049033164978027344, -2.5316238403320312, -1.034036636352539, -1.177236557006836, -0.5961313247680664, -0.05742311477661133, -0.5938835144042969, -1.334071159362793, -0.0872044563293457, 0.0035544857382774353, 0.026673436164855957, 0.1979731321334839, 1.9994525909423828, -1.7019367218017578, -0.018158912658691406, -0.17529869079589844, -0.7431926727294922, -1.5087089538574219, -0.900787353515625, -1.0415534973144531, -0.5933418273925781, 0.3932304382324219, -1.204422950744629, -0.03163337707519531, 0.29357290267944336, 0.21332968771457672, 0.2316383719444275, 0.31887316703796387, 1.0665719509124756, 0.1811082810163498, -1.3815312385559082, -0.31101560592651367, -0.4178934097290039, -1.362505316734314, -3.1199302673339844, -0.2444826364517212, -2.8095779418945312, -2.184645891189575, -1.8213233947753906, 1.3232449293136597, -2.0159530639648438, 0.7300853729248047, -1.2860050201416016, -0.7339754104614258, -1.876906156539917, -0.6710472106933594, -0.7705364227294922, -1.3631234169006348, -0.546051025390625, -0.6396818161010742, -1.930039882659912, -1.2598953247070312, 0.5840892791748047, -24.847732543945312, -0.5143470764160156, -0.6593170166015625, -1.4987850189208984, -22.241405487060547, -0.022354960441589355, -1.0085639953613281, 0.7791881561279297, 0.4971609115600586, -0.046573638916015625, -0.9494495391845703, -7.605125427246094, 0.023917198181152344, -0.7152156829833984, -0.1862320899963379, 0.5546598434448242, -0.22970867156982422, -0.20401182770729065, -0.31433868408203125, -0.9308290481567383, -1.8006480932235718, 0.3118422329425812, 0.43707704544067383, -1.4272055625915527, -0.7845840454101562, -0.24019813537597656, -0.09388923645019531, -0.4255657196044922, 0.09239768981933594, -0.5538043975830078, -2.6440353393554688, 0.39929628372192383, -0.16565895080566406, -1.545161247253418, -0.24847006797790527, 0.3055610656738281, -2.6300644874572754, -0.7095737457275391, 0.07341814041137695, -6.812575340270996, -0.09270596504211426, 0.1941814422607422, -0.22569942474365234, 0.00045299530029296875, -1.2103891372680664, 0.2010335922241211, 0.3202141523361206, 0.0096282958984375, -3.7357168197631836, 0.24885177612304688, -0.9716529846191406, 0.2627289295196533, 0.17521506547927856, -0.16951417922973633, -0.668978214263916, -0.7355690002441406, -0.06315898895263672, -1.8916435241699219, -4.628459930419922, 0.20894980430603027, -0.903925895690918, -0.8292422294616699, -0.031192779541015625, -0.031818389892578125, -4.389455795288086, -9.865257263183594, 0.37675929069519043, -1.6077919006347656, -2.593290328979492, -0.5947036743164062, 0.3848419189453125, 1.086531639099121, -1.0415534973144531, -2.6616570949554443, -0.005472898483276367, -0.6975836753845215, 0.4834327697753906, -0.1898622065782547, -1.281721591949463, -1.379781723022461, 0.21152544021606445, 0.10692691802978516, 0.28533935546875, -0.30811309814453125, 0.3176288306713104, -1.4046745300292969, -0.9804115295410156, -0.7558612823486328, -1.2522788047790527, -0.27435731887817383, 1.7977066040039062, -1.92205810546875, -0.47010135650634766, -0.8233518600463867, -0.4089202880859375, -0.34519195556640625, -0.04284954071044922, -2.327467679977417, 0.6461448669433594, -0.4879436492919922, -0.1319751739501953, -0.38591670989990234, -6.625906467437744, 0.6028232574462891, -2.005586624145508, 0.24969470500946045, -1.4908618927001953, -0.5382528305053711, -0.19701576232910156, 1.4569454193115234, 0.24694299697875977, -1.789327621459961, -0.002907276153564453, 1.1627082824707031, 1.2812070846557617, -0.017932891845703125, -0.43700456619262695, 0.15021896362304688, 0.7791881561279297, -1.9762325286865234, -0.7845840454101562, 0.20856189727783203, 0.04145216941833496, -1.0082950592041016, -0.97357177734375, 0.33018574118614197, -0.2187049388885498, -0.32219839096069336, -15.347938537597656, -0.545806884765625, 0.46025753021240234, -1.1723690032958984, -0.42159605026245117, 3.457386016845703, -0.2718620300292969, -1.9417610168457031, 0.6429650783538818, -0.6831150054931641, -11.595747947692871, -1.4766998291015625, -3.4471263885498047, -0.6588935852050781, -0.3309955596923828, -4.348690032958984, -2.010183334350586, -1.2617292404174805, 0.9110145568847656, -0.557289183139801, 0.7026953101158142, -2.5374650955200195, -1.0686798095703125, 0.16982603073120117, 2.8466415405273438, -8.867372512817383, -0.19655418395996094, 0.8323125839233398, -0.030402183532714844, -0.03163337707519531], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 70656, "num_env_steps_trained": 261360, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 261360, "last_target_update_ts": 70656, "num_target_updates": 137}, "sampler_results": {"episode_reward_max": 28.386056430637836, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -77.15615487039089, "episode_len_mean": 247.06, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444], "episode_lengths": [318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392796325103932, "mean_inference_ms": 24.038072116953053, "mean_action_processing_ms": 0.13330716571182535, "mean_env_wait_ms": 4.2626685728781615, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 28.386056430637836, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -77.15615487039089, "episode_len_mean": 247.06, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-250.1982424929738, 5.000000037252903, 20.02127081900835, -179.1313673183322, 21.4940023496747, -273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444], "episode_lengths": [318, 226, 221, 301, 210, 324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392796325103932, "mean_inference_ms": 24.038072116953053, "mean_action_processing_ms": 0.13330716571182535, "mean_env_wait_ms": 4.2626685728781615, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 261360, "num_env_steps_sampled": 70656, "num_env_steps_trained": 261360, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 70656, "agent_timesteps_total": 70656, "timers": {"training_iteration_time_ms": 366.241, "learn_time_ms": 81.083, "learn_throughput": 2959.916, "synch_weights_time_ms": 20.183}, "counters": {"num_env_steps_sampled": 70656, "num_env_steps_trained": 261360, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 261360, "last_target_update_ts": 70656, "num_target_updates": 137}, "done": false, "episodes_total": 251, "training_iteration": 69, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-23-59", "timestamp": 1655501039, "time_this_iter_s": 5.752041816711426, "time_total_s": 372.1198410987854, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 372.1198410987854, "timesteps_since_restore": 0, "iterations_since_restore": 69, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.174999999999997, "ram_util_percent": 65.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.517586708068848, "min_q": -75.59382629394531, "max_q": 27.543659210205078, "mean_td_error": -0.00162032141815871}, "td_error": [-0.12621402740478516, 2.2207183837890625, 1.5044212341308594, -2.2535438537597656, 0.6011924743652344, 1.4054927825927734, -0.0065097808837890625, 0.16622447967529297, -0.32300806045532227, -0.0828966498374939, 1.1776580810546875, -0.1687382161617279, -0.4814276695251465, 0.5340728759765625, 0.23886585235595703, 1.3317699432373047, 0.8406219482421875, 0.34464001655578613, -0.16303777694702148, 2.269953727722168, 0.7222537994384766, 0.47029781341552734, 1.8655261993408203, 0.9629573822021484, 0.0975494384765625, -0.05543708801269531, 0.2706446647644043, 0.08791637420654297, -0.23240184783935547, 2.0318288803100586, -7.679515838623047, 1.1793079376220703, -0.1870119571685791, 0.8673973083496094, 1.4318218231201172, 2.1838741302490234, 0.693598747253418, 1.6265230178833008, -0.02818441390991211, -0.09865999221801758, 0.5260152816772461, -0.5150084495544434, 0.26938438415527344, -6.454102516174316, 1.3309786319732666, -1.0649230480194092, 0.27812623977661133, 1.1130256652832031, -0.22236156463623047, -0.03937387466430664, -0.20934486389160156, -0.7642440795898438, 0.6926805377006531, 0.5132880210876465, 0.8719562292098999, 0.7231616973876953, 0.5335683822631836, 0.6984052658081055, 2.132735252380371, 1.6115798950195312, 1.6107025146484375, 1.675894021987915, 0.564399242401123, 1.0059242248535156, -14.981582641601562, -0.46942561864852905, -0.4415619373321533, 1.4927978515625, -0.06874847412109375, 0.34892845153808594, 0.5917973518371582, -0.7885513305664062, 0.03617185354232788, 1.8961639404296875, -0.7138824462890625, 0.8410642147064209, 0.3223259449005127, -1.1699104309082031, 1.0916385650634766, 0.4571533203125, 0.8300094604492188, 0.11937594413757324, -0.5261907577514648, 0.7026219367980957, 1.0779285430908203, 0.584622859954834, -0.21561336517333984, -16.7728271484375, -15.448407173156738, -0.59637451171875, -1.7449342012405396, 0.6241683959960938, -5.495857238769531, 0.39040184020996094, -0.1745140552520752, 1.2434767484664917, 1.068772315979004, 0.11179256439208984, -0.4478569030761719, -0.4478569030761719, 0.5120830535888672, -0.029761791229248047, 2.4501609802246094, 2.3195838928222656, 2.401498794555664, 0.2335376739501953, -0.2201981544494629, 0.8724346160888672, 0.4350109100341797, 2.966093063354492, -8.268179893493652, 0.5604305267333984, -0.012290000915527344, -0.5997530817985535, 1.5044212341308594, 0.0428350567817688, 2.2510433197021484, -4.329808235168457, 5.909543991088867, -0.7052369117736816, 1.9420530796051025, 0.38953399658203125, -0.21607446670532227, 2.881053924560547, -0.22702789306640625, 0.46143054962158203, -0.23077774047851562, 2.6633710861206055, 2.3179264068603516, -0.5440521240234375, 1.359823226928711, 1.1253786087036133, 1.2025151252746582, 0.41225337982177734, -0.6126718521118164, 0.46143054962158203, 1.0260305404663086, -0.1798248291015625, 0.1533747911453247, 2.297727584838867, 1.2907905578613281, -0.337099552154541, 0.01690196990966797, 1.0478744506835938, 1.521571159362793, -0.34657907485961914, 5.37150764465332, 0.40985107421875, 0.04841423034667969, -12.502520561218262, -0.16524505615234375, 0.5641698837280273, -0.594165563583374, 1.0317564010620117, -0.5470318794250488, 1.9670734405517578, 0.7762680053710938, 2.5327510833740234, 0.8673582077026367, 1.4677599668502808, 2.578615188598633, -0.21387648582458496, 0.09434187412261963, -0.1604769229888916, -0.6354111433029175, 1.1591415405273438, 0.14113998413085938, 0.5481090545654297, 1.459554672241211, 0.43911314010620117, 1.6475028991699219, 3.835444450378418, 0.4874839782714844, 0.06077098846435547, 0.6901912689208984, 4.428304672241211, 0.19839000701904297, -0.06393605470657349, -0.6222991943359375, -0.6503886580467224, 0.21743237972259521, 0.004565238952636719, -7.337551116943359, 1.8174400329589844, -0.13674330711364746, 0.5684947967529297, 0.34758901596069336, 1.2334728240966797, 0.8351755142211914, -0.06678533554077148, -0.5731315612792969, 0.7326107025146484, 0.17678451538085938, 0.28065013885498047, -0.5150084495544434, 1.083658218383789, -0.03193354606628418, 1.6461238861083984, 0.15561819076538086, 2.493257522583008, 0.8844387531280518, 1.903724193572998, -0.040094852447509766, -0.17417621612548828, 1.228989839553833, -7.146266937255859, -0.15288066864013672, 0.5943374633789062, -0.056464195251464844, 0.66888427734375, -0.23043614625930786, -0.4581146240234375, 0.5536594390869141, 1.1288976669311523, -0.2883923053741455, 1.0873756408691406, 1.0925531387329102, 1.2192015647888184, 0.07743215560913086, -0.17585134506225586, -0.7612292766571045, 0.5754299163818359, -0.26481103897094727, 2.0435829162597656, 0.5805091857910156, 0.38897109031677246, -0.19612878561019897, -9.59339714050293, 0.867006778717041, 1.8211021423339844, 0.48813724517822266, -6.07098388671875, -0.7961971759796143, 1.1298046112060547, 2.3495025634765625, -0.22674942016601562, 1.2308714389801025, -20.138057708740234, -0.19431543350219727, 1.4593696594238281], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 265200, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 265200, "last_target_update_ts": 71680, "num_target_updates": 139}, "sampler_results": {"episode_reward_max": 28.386056430637836, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -77.4473301564157, "episode_len_mean": 246.94, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997], "episode_lengths": [324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5405559815438572, "mean_inference_ms": 24.048455173959436, "mean_action_processing_ms": 0.1331983306301657, "mean_env_wait_ms": 4.266322053297674, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 28.386056430637836, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -77.4473301564157, "episode_len_mean": 246.94, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-273.7299249768257, -10.5893644541502, 10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997], "episode_lengths": [324, 218, 232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5405559815438572, "mean_inference_ms": 24.048455173959436, "mean_action_processing_ms": 0.1331983306301657, "mean_env_wait_ms": 4.266322053297674, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 265200, "num_env_steps_sampled": 71680, "num_env_steps_trained": 265200, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 71680, "agent_timesteps_total": 71680, "timers": {"training_iteration_time_ms": 336.347, "learn_time_ms": 80.77, "learn_throughput": 2971.403, "synch_weights_time_ms": 20.29}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 265200, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 265200, "last_target_update_ts": 71680, "num_target_updates": 139}, "done": false, "episodes_total": 256, "training_iteration": 70, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-24-04", "timestamp": 1655501044, "time_this_iter_s": 5.49265718460083, "time_total_s": 377.61249828338623, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 377.61249828338623, "timesteps_since_restore": 0, "iterations_since_restore": 70, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.0625, "ram_util_percent": 65.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -7.573793888092041, "min_q": -78.24656677246094, "max_q": 25.99898910522461, "mean_td_error": -8.595494270324707}, "td_error": [-0.2554478645324707, 3.429136276245117, 1.2066242694854736, 0.14434483647346497, -1.6170539855957031, 0.8031482696533203, 0.06351423263549805, 0.5825595855712891, -0.3216133117675781, -0.5945096015930176, 4.121341705322266, -0.5630183219909668, -7.259891033172607, 2.5998430252075195, -6.8782501220703125, -1.1040172576904297, -998.1751098632812, 0.14972400665283203, 0.1454920768737793, -4.953851699829102, -0.42578697204589844, 0.5372388362884521, -16.32774543762207, 1.3374462127685547, 0.3774375915527344, 0.9019222259521484, -0.6095743179321289, 2.3428802490234375, 0.24793314933776855, -0.5670270919799805, -0.052741050720214844, 1.0031242370605469, 0.3483915328979492, -0.23975801467895508, 0.5040044784545898, 1.2878971099853516, 0.7947759628295898, -0.08880805969238281, 0.47933149337768555, 0.5168378353118896, 0.738502025604248, -0.13415050506591797, 0.2759723663330078, -0.46221184730529785, -0.2432727813720703, 0.4712848663330078, -1.156930923461914, -0.8564019203186035, 0.1328144073486328, 0.055484771728515625, 0.9636588096618652, 0.5372388362884521, -3.560159206390381, 0.807462215423584, -0.04571676254272461, -0.5306010246276855, -1.33306884765625, 0.8950920104980469, 0.7068519592285156, -1.474318027496338, 0.20338726043701172, 0.04990959167480469, 0.1318834125995636, -0.9853019714355469, 0.7408008575439453, -0.4997650384902954, -2.2512149810791016, -0.6152384281158447, -0.1190643310546875, -0.4133443832397461, 0.17537546157836914, 1.2674579620361328, 0.7301397323608398, 0.5865359306335449, 0.31672096252441406, 0.6514015197753906, 0.9059439301490784, 0.4141956567764282, -0.23260359466075897, -13.683515548706055, 0.08728599548339844, 1.0033254623413086, -0.16505122184753418, 1.1055622100830078, -0.6086118221282959, 0.07515954971313477, 0.7796072959899902, 1.509765625, -0.005579471588134766, 0.0005435943603515625, 0.872291088104248, 0.13085460662841797, 0.936194896697998, 0.7466926574707031, 0.13997650146484375, -0.06334686279296875, 1.322002649307251, 0.2122669219970703, 2.834242820739746, 1.016923189163208, 0.4098033905029297, -0.2332744598388672, 1.0123510360717773, 0.42952871322631836, -6.440413951873779, -0.1265716552734375, 0.49372196197509766, 0.7877712249755859, 0.27527689933776855, -2.454071044921875, 0.49676036834716797, -6.938906669616699, 0.9265613555908203, -0.3174142837524414, 0.5843801498413086, 0.2653172016143799, 0.19460558891296387, 0.12404966354370117, 0.13686466217041016, 0.04636019468307495, 0.49127960205078125, 2.000645637512207, -1.4765148162841797, -0.1843353509902954, 0.25818055868148804, 0.655734658241272, -0.3964881896972656, 0.16113519668579102, -0.049713134765625, -0.7984724044799805, -998.1751098632812, -0.2563924789428711, 0.11473655700683594, 0.07313251495361328, 0.8254847526550293, 0.1870574951171875, 0.37615692615509033, -0.4430046081542969, 0.08339691162109375, -0.3418235778808594, -6.847156524658203, 0.5187444686889648, 0.14152908325195312, 0.11875724792480469, -0.08619403839111328, 0.07681989669799805, 0.4332681894302368, -0.018396615982055664, -0.2425384521484375, 0.1960408091545105, 0.5710601806640625, -1.2134571075439453, -0.48743104934692383, 0.2703895568847656, 1.0461063385009766, 0.38277578353881836, 0.6239891052246094, 2.48569393157959, 0.05116415023803711, -1.569016456604004, -0.6133174896240234, 0.599210262298584, 0.37384796142578125, 0.8576250076293945, -0.8083383440971375, 1.6384613513946533, 0.5706520080566406, 0.1813960075378418, 0.599210262298584, -1.0626931190490723, 0.1385650634765625, 0.8115940093994141, 0.29055923223495483, 1.0092086791992188, -4.4521589279174805, -1.6934738159179688, 0.4187297821044922, -0.9948844909667969, -0.4902477264404297, 0.006321430206298828, -0.3757591247558594, 1.5443592071533203, -1.3696212768554688, 0.19672107696533203, 1.15594482421875, -1.2597312927246094, 1.307037591934204, -0.8836650848388672, -0.955467939376831, -15.235281944274902, 1.3018121719360352, 0.36304813623428345, 3.9692234992980957, -0.2946033477783203, -4.337526321411133, -0.8247699737548828, -0.6352415084838867, 0.7466926574707031, -0.9653096199035645, 0.3758176565170288, 2.1974716186523438, 2.3339576721191406, 0.5097190141677856, 4.031898498535156, 1.372410774230957, 0.4198627471923828, 0.3084144592285156, -1.9503095149993896, -0.20197486877441406, -14.755802154541016, 1.444075584411621, 1.509969711303711, 0.5635051727294922, 0.7425680160522461, 1.6642570495605469, -3.852518081665039, 0.886317253112793, -0.7245941162109375, 0.037625789642333984, 0.34749674797058105, 0.8138065338134766, -0.9192960262298584, 0.9879946708679199, 0.10391902923583984, 1.1793785095214844, -0.6676120758056641, -1.465982437133789, 0.6527938842773438, -5.339155197143555, 1.1447405815124512, -0.9777908325195312, -0.5746231079101562, 0.3266925811767578, -2.479217529296875, -0.12407493591308594, 0.47655487060546875, -2.5694971084594727, -0.025236129760742188, 0.04350614547729492, 0.19395732879638672], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 72704, "num_env_steps_trained": 269040, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 269040, "last_target_update_ts": 72704, "num_target_updates": 141}, "sampler_results": {"episode_reward_max": 28.386056430637836, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -74.20890921570361, "episode_len_mean": 245.98, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866], "episode_lengths": [232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5398640222206441, "mean_inference_ms": 24.061252087994816, "mean_action_processing_ms": 0.13350820814649453, "mean_env_wait_ms": 4.269129127015175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 28.386056430637836, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -74.20890921570361, "episode_len_mean": 245.98, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.699999831616879, -674.0277869477868, -160.37318794429302, -55.272171802818775, 15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866], "episode_lengths": [232, 431, 274, 253, 203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5398640222206441, "mean_inference_ms": 24.061252087994816, "mean_action_processing_ms": 0.13350820814649453, "mean_env_wait_ms": 4.269129127015175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 269040, "num_env_steps_sampled": 72704, "num_env_steps_trained": 269040, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 72704, "agent_timesteps_total": 72704, "timers": {"training_iteration_time_ms": 337.064, "learn_time_ms": 81.47, "learn_throughput": 2945.861, "synch_weights_time_ms": 20.607}, "counters": {"num_env_steps_sampled": 72704, "num_env_steps_trained": 269040, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 269040, "last_target_update_ts": 72704, "num_target_updates": 141}, "done": false, "episodes_total": 258, "training_iteration": 71, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-24-10", "timestamp": 1655501050, "time_this_iter_s": 5.378680229187012, "time_total_s": 382.99117851257324, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 382.99117851257324, "timesteps_since_restore": 0, "iterations_since_restore": 71, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.424999999999997, "ram_util_percent": 65.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.407779693603516, "min_q": -81.15764617919922, "max_q": 28.46937370300293, "mean_td_error": -4.479940414428711}, "td_error": [-23.413188934326172, 0.7645714282989502, 1.052886962890625, 0.3431816101074219, 0.7823804020881653, -0.231231689453125, -0.13887739181518555, 1.0687799453735352, 0.0697469711303711, -0.12514495849609375, 0.6069788932800293, 0.28879261016845703, 1.4515132904052734, 0.1440887451171875, -0.25188636779785156, -1.9807748794555664, 1.0872316360473633, 0.6156566143035889, 0.3613567352294922, 0.6444926261901855, 1.1778278350830078, 2.2694950103759766, 0.1569671630859375, 0.5317192077636719, -0.03625011444091797, -0.6418027877807617, 0.6261916160583496, 1.001023769378662, -11.609176635742188, -2.6112594604492188, 1.1629714965820312, -0.19714808464050293, 0.1270313262939453, -0.21522140502929688, -1.967289924621582, 0.8885726928710938, 0.42185020446777344, -5.564236640930176, -6.433428764343262, 0.40979671478271484, 2.3779478073120117, 1.300786018371582, 0.825129508972168, -0.3328857421875, 1.6510286331176758, 1.7531328201293945, -0.08876800537109375, -0.15737342834472656, 1.9112396240234375, -0.49629878997802734, -0.034282803535461426, 0.4875602722167969, 0.16660583019256592, -1.9537124633789062, 0.5036201477050781, 0.5003604888916016, 0.377288818359375, -4.677257537841797, 0.7312679290771484, -0.7576358318328857, -0.25019264221191406, 0.6740034818649292, 1.4890708923339844, 0.6246109008789062, 0.55511474609375, -0.08218967914581299, 0.8048553466796875, 0.9756565093994141, -0.45398521423339844, -8.706759452819824, -0.6849155426025391, 1.221456527709961, 0.09429693222045898, 0.34728050231933594, -11.073945999145508, 1.0776424407958984, 0.35732078552246094, 0.12301158905029297, -0.8946094512939453, 1.8242120742797852, 1.8140864372253418, 2.5631628036499023, -9.903940200805664, 0.9086837768554688, -0.5556683540344238, 1.4620532989501953, 0.8555746078491211, 0.18094396591186523, 0.7235202789306641, 0.5483818054199219, -6.18902587890625, 0.17308807373046875, 0.0655670166015625, 0.1646270751953125, 1.3206443786621094, 0.12541770935058594, -1.9374618530273438, -0.04384422302246094, 0.34944868087768555, 0.37085288763046265, 0.05876147747039795, 1.5563945770263672, -0.609255313873291, 1.2498157024383545, 0.12064981460571289, -0.5660247802734375, 0.21027708053588867, 0.8699359893798828, 1.6844606399536133, -0.7163505554199219, 0.6503446102142334, -5.015497207641602, 1.1878137588500977, 0.9085464477539062, -0.1637653112411499, -0.16368865966796875, 0.9121170043945312, -0.04338836669921875, 0.7854599952697754, -2.963441848754883, 0.9559555053710938, 0.929856538772583, -0.6198654174804688, 0.4652671813964844, 2.1240811347961426, 1.8907976150512695, 1.6556453704833984, 1.078226089477539, 0.15024757385253906, -0.19132041931152344, 1.4618825912475586, -0.07370257377624512, 1.9217722415924072, 0.6931610107421875, 0.340474009513855, -10.233733177185059, 0.20110082626342773, 2.1177711486816406, 0.37531566619873047, 0.8683757781982422, 1.211970329284668, 0.7257747650146484, 0.2663388252258301, -0.05604410171508789, -998.2083740234375, 1.389665126800537, 0.5040630102157593, 2.562885284423828, -0.053060054779052734, 0.8794021606445312, 0.4447050094604492, 1.218571662902832, 0.4591212570667267, 0.16571760177612305, 0.2514019012451172, 0.034369468688964844, -0.7738890647888184, 0.6719608306884766, -4.657904624938965, -0.6192240715026855, -0.2695465087890625, -0.27684783935546875, -3.9908370971679688, 0.0791025161743164, 0.17609065771102905, 0.41538572311401367, 1.2425613403320312, 0.08997797966003418, 0.20732593536376953, 0.49117279052734375, 1.8894577026367188, -6.910253524780273, 0.24516916275024414, 2.145874500274658, -4.480727195739746, 1.397468090057373, 0.7128705978393555, 1.8095722198486328, -0.1609814167022705, 1.9736452102661133, 0.046700477600097656, 0.4354286193847656, -0.42020416259765625, 0.9740018844604492, 0.1792135238647461, -11.009712219238281, 1.0902113914489746, 1.8441076278686523, -1.8536605834960938, -0.6046199798583984, 2.5759196281433105, 1.2934597730636597, 0.013238579034805298, 0.14344024658203125, 1.724452018737793, 1.680750846862793, -9.853280067443848, 0.6818671226501465, -0.16501903533935547, 1.3207435607910156, 1.301915168762207, 1.9580121040344238, 0.44868898391723633, -0.06098175048828125, 1.5778651237487793, 1.4890708923339844, -2.242158889770508, -16.281963348388672, 0.665125846862793, 0.9096603393554688, -5.679487228393555, 2.6649742126464844, -3.6140785217285156, -0.18430089950561523, 0.5019569396972656, 1.026865005493164, 0.92333984375, 8.172987937927246, 0.3774445056915283, -5.917523384094238, 0.15556907653808594, 0.7511873245239258, 0.10002875328063965, -10.616900444030762, 0.0447138249874115, 0.0433349609375, -5.1333794593811035, -0.6965875625610352, 2.095458984375, -0.2892768383026123, -0.43764352798461914, 0.17289996147155762, -0.1765453815460205, -0.08218967914581299, 0.0821528434753418, -0.10585916042327881, 1.1327404975891113, 0.7683124542236328, 0.5076885223388672, 1.3517532348632812], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 73728, "num_env_steps_trained": 272880, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 272880, "last_target_update_ts": 73728, "num_target_updates": 143}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -65.68781878754497, "episode_len_mean": 243.25, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605], "episode_lengths": [203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5407395869004786, "mean_inference_ms": 24.038022531431274, "mean_action_processing_ms": 0.13306357306285585, "mean_env_wait_ms": 4.265993153702971, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -65.68781878754497, "episode_len_mean": 243.25, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.810635276138783, -206.13892762362957, 4.700000107288361, -98.17078370600939, -171.47902439534664, 9.800000213086605, -12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605], "episode_lengths": [203, 316, 211, 261, 278, 197, 246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5407395869004786, "mean_inference_ms": 24.038022531431274, "mean_action_processing_ms": 0.13306357306285585, "mean_env_wait_ms": 4.265993153702971, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 272880, "num_env_steps_sampled": 73728, "num_env_steps_trained": 272880, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 73728, "agent_timesteps_total": 73728, "timers": {"training_iteration_time_ms": 347.241, "learn_time_ms": 82.067, "learn_throughput": 2924.438, "synch_weights_time_ms": 20.489}, "counters": {"num_env_steps_sampled": 73728, "num_env_steps_trained": 272880, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 272880, "last_target_update_ts": 73728, "num_target_updates": 143}, "done": false, "episodes_total": 262, "training_iteration": 72, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-24-15", "timestamp": 1655501055, "time_this_iter_s": 5.501419544219971, "time_total_s": 388.4925980567932, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 388.4925980567932, "timesteps_since_restore": 0, "iterations_since_restore": 72, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.2875, "ram_util_percent": 65.63749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.702869415283203, "min_q": -82.52735137939453, "max_q": 24.711585998535156, "mean_td_error": -4.238047122955322}, "td_error": [-0.0372314453125, 0.3153672218322754, 0.5167217254638672, -0.5774312019348145, 0.08442115783691406, -1.0667572021484375, 1.3302993774414062, -3.9639787673950195, 2.246962547302246, 0.286099910736084, 1.3302993774414062, 2.563915967941284, 0.6447992324829102, 0.07631897926330566, 0.21425819396972656, -5.910862922668457, -0.1406841278076172, 0.5934247970581055, -1.3910415172576904, 0.7260017395019531, -1.981903076171875, -9.473824501037598, 0.20070981979370117, -0.7708730697631836, -0.6326618194580078, 1.0940723419189453, 1.6522388458251953, -0.4036402702331543, 1.3162517547607422, 4.188983917236328, -0.9156198501586914, 0.6010634899139404, 0.509312629699707, 0.6332015991210938, -3.5867538452148438, -0.6706418991088867, 0.5363049507141113, 1.20477294921875, 0.718745231628418, 2.1088905334472656, 0.042383670806884766, -0.5045557022094727, 0.4893331527709961, 0.17637908458709717, 0.27398681640625, 0.6689643859863281, 1.6545524597167969, 0.5190849304199219, 0.2004404067993164, 0.07446932792663574, 3.0765395164489746, 0.6691837310791016, -0.32239532470703125, -0.6696376800537109, -0.5260179042816162, 2.199085235595703, 1.6174516677856445, 0.8283729553222656, -0.38253307342529297, 2.560619354248047, 0.2676811218261719, -0.11168479919433594, -6.297145843505859, -1.8165521621704102, -0.6420612335205078, 1.6701658964157104, 0.1256847381591797, -0.4789562225341797, 0.21560239791870117, -1.5750751495361328, 0.18038606643676758, 0.31046557426452637, 0.49238109588623047, 0.8725080490112305, 0.001714944839477539, -0.04507887363433838, 2.768559455871582, 0.1814746856689453, 0.7110261917114258, 1.2523155212402344, 1.0114898681640625, -0.6987876892089844, 0.10757684707641602, 2.8702030181884766, 0.2469501495361328, 1.4697226285934448, 0.19974708557128906, 0.3727455139160156, 0.1686716079711914, 0.2382373809814453, 1.5356979370117188, -0.5769329071044922, 1.0451793670654297, 0.1660013198852539, 1.0361690521240234, 0.5667476654052734, -0.4727153778076172, 0.4588813781738281, -0.712031364440918, -0.29584503173828125, 3.10186767578125, -0.7434115409851074, -2.046664237976074, 0.25719404220581055, 1.3203849792480469, 0.9143314957618713, 0.8941550850868225, 0.5483894348144531, -0.05260467529296875, 0.794403076171875, 1.2658424377441406, -1.5877313613891602, -22.776714324951172, 0.5770683288574219, 2.1728057861328125, 0.38930845260620117, 0.7661848068237305, 0.3365354537963867, 0.28854143619537354, 0.14073729515075684, -0.11018133163452148, 0.3645815849304199, -0.4381828308105469, 5.425084114074707, 0.501014232635498, 0.4147653579711914, 0.9815559387207031, 2.523509979248047, 0.802088737487793, 0.5106334686279297, 0.7688827514648438, 0.6440486907958984, -17.12875747680664, -0.2538604736328125, -0.0051670074462890625, 0.8291301727294922, -0.019396066665649414, 0.22836589813232422, 0.7574639320373535, 2.083284378051758, 0.40703392028808594, 1.4718084335327148, 0.6890144348144531, -0.06142139434814453, -1.6789751052856445, 0.411376953125, 2.5273046493530273, -0.10006797313690186, 1.0959539413452148, -0.6094951629638672, -7.904463768005371, -0.05737495422363281, -0.372011661529541, 0.27160120010375977, 0.2540769577026367, 0.7394828796386719, 0.8487004041671753, 2.836977958679199, 0.20398902893066406, -1.3724479675292969, -0.5852489471435547, 1.412496566772461, 8.475937843322754, -0.10387611389160156, 0.23330307006835938, 0.03976702690124512, -2.9986495971679688, 0.0782480239868164, 0.3018512725830078, 2.2987794876098633, -0.6025924682617188, -0.0822601318359375, -1.3382377624511719, 1.1341986656188965, 0.07670021057128906, 0.7227087020874023, -9.74032211303711, 0.9958648681640625, -0.018585205078125, 0.07549476623535156, -11.93073558807373, -0.42607593536376953, 1.9366083145141602, 2.328418731689453, 0.26708292961120605, 0.18351221084594727, 3.383495330810547, 1.07568359375, -0.08732795715332031, 0.4657144546508789, -0.33303260803222656, -2.5687150955200195, 7.10477352142334, -0.09139633178710938, -0.2213735580444336, 2.75675630569458, 6.548846244812012, -2.04653000831604, 0.7262718677520752, 1.3367269039154053, -0.6198506355285645, 3.0675182342529297, -0.18546295166015625, -1.1452140808105469, -0.5112600326538086, 0.0013599395751953125, 0.21465730667114258, 0.4268221855163574, 0.0876612663269043, 0.8449249267578125, 1.6217212677001953, -0.5038871765136719, 0.0299685001373291, 1.1193962097167969, -0.38253307342529297, -4.914508819580078, -1.215841293334961, 0.7991447448730469, 1.5641326904296875, 0.8048171997070312, 0.15613174438476562, 0.4974784851074219, -1.1201667785644531, 1.397207260131836, 0.6556510925292969, 0.15163516998291016, 0.2469501495361328, 0.16363191604614258, -0.13657164573669434, 0.1489466428756714, 0.1754283905029297, 0.4080827236175537, -0.8491973876953125, -999.9221801757812, -17.191001892089844, 0.18537521362304688, 0.229658842086792, -11.093565940856934, -0.2902488708496094, -1.5092673301696777], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 74752, "num_env_steps_trained": 276720, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 276720, "last_target_update_ts": 74752, "num_target_updates": 145}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -62.76926955439151, "episode_len_mean": 242.23, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935], "episode_lengths": [246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5426994874509216, "mean_inference_ms": 24.04475850998592, "mean_action_processing_ms": 0.13306662867089314, "mean_env_wait_ms": 4.272336622275271, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -62.76926955439151, "episode_len_mean": 242.23, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.100000031292439, -78.67078350484371, -61.11864873021841, 15.67542139440775, -156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935], "episode_lengths": [246, 261, 252, 199, 297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5426994874509216, "mean_inference_ms": 24.04475850998592, "mean_action_processing_ms": 0.13306662867089314, "mean_env_wait_ms": 4.272336622275271, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 276720, "num_env_steps_sampled": 74752, "num_env_steps_trained": 276720, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 74752, "agent_timesteps_total": 74752, "timers": {"training_iteration_time_ms": 356.799, "learn_time_ms": 80.032, "learn_throughput": 2998.803, "synch_weights_time_ms": 20.388}, "counters": {"num_env_steps_sampled": 74752, "num_env_steps_trained": 276720, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 276720, "last_target_update_ts": 74752, "num_target_updates": 145}, "done": false, "episodes_total": 268, "training_iteration": 73, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-24-21", "timestamp": 1655501061, "time_this_iter_s": 5.652536630630493, "time_total_s": 394.1451346874237, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 394.1451346874237, "timesteps_since_restore": 0, "iterations_since_restore": 73, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.075000000000003, "ram_util_percent": 65.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -10.258681297302246, "min_q": -84.42821502685547, "max_q": 27.686494827270508, "mean_td_error": -8.612374305725098}, "td_error": [-0.2934098243713379, -0.8715400695800781, -0.3591775894165039, -2.0734806060791016, 1.178455114364624, -0.06444931030273438, -5.581348419189453, 0.36772918701171875, 0.43196630477905273, -1.6852474212646484, -0.13323211669921875, -0.036182403564453125, 0.775360107421875, -0.7984066009521484, -0.2665996551513672, -0.6368827819824219, 0.205322265625, 0.5426483154296875, -0.6235179901123047, 1.8677902221679688, -0.8884115219116211, 0.14447021484375, -998.5196533203125, 1.8946266174316406, -0.1448230743408203, 0.4592881202697754, 1.536773681640625, -0.18146896362304688, -1.4714365005493164, 0.0069408416748046875, 0.11686474084854126, -0.2496020793914795, -10.327102661132812, -0.6149616241455078, -32.45094299316406, 1.8759384155273438, 0.24677085876464844, 0.34482860565185547, -0.3772859573364258, -0.5397729873657227, -0.8516865968704224, 2.238656997680664, 0.18784713745117188, -2.6953163146972656, -9.05413818359375, -0.8088474273681641, -0.5388545989990234, 0.6492233276367188, -1.5121541023254395, -11.96762752532959, 0.1056051254272461, -0.05803656578063965, 0.14873701333999634, -0.9365768432617188, 5.733423233032227, -0.04263877868652344, -0.030315399169921875, -0.5166034698486328, 2.508695602416992, -0.3868598937988281, -0.9832887649536133, -1.2142581939697266, 0.010770082473754883, 0.8765645027160645, 0.02255105972290039, 1.7282142639160156, 1.658200740814209, -1.3717384338378906, -2.1130499839782715, 1.5574684143066406, 0.6628447771072388, 2.5560379028320312, -0.06713557243347168, 1.0707780122756958, 1.403419017791748, 1.2607288360595703, 0.372387170791626, 1.5595283508300781, 0.27256011962890625, -0.5413653254508972, -0.7309414148330688, 1.1910400390625, -0.522679328918457, -0.8344688415527344, 1.332413673400879, -0.571868896484375, 1.5030460357666016, -6.294610977172852, 0.02635335922241211, 7.192707061767578, 0.39925527572631836, -1.1932430267333984, -0.10870981216430664, -0.35434722900390625, -1.897047996520996, -16.207561492919922, -0.11286568641662598, 0.6539669036865234, 0.43328094482421875, 0.1674509048461914, 0.36015892028808594, -1.2002010345458984, 0.2615221440792084, 1.235924243927002, -0.9639472961425781, 0.9065866470336914, -1.3702926635742188, 0.46997499465942383, 0.699462890625, 5.4155473709106445, -4.355249404907227, -0.38787174224853516, -0.6135205030441284, -1.1989350318908691, -0.050961434841156006, 0.34001731872558594, 0.5578687787055969, 2.0390892028808594, -0.33647727966308594, 0.12771129608154297, 2.23016357421875, -0.1352468729019165, -0.3008852005004883, -0.19821834564208984, 1.8639392852783203, -0.16951274871826172, 0.8134641647338867, 0.6113886833190918, -0.21829986572265625, 3.8843793869018555, -1.8990654945373535, 0.18854713439941406, 0.49808502197265625, -0.3395843505859375, 1.658200740814209, 1.2093582153320312, -0.5771570205688477, -0.7709903717041016, 0.16287195682525635, -1.2031660079956055, -0.6801462173461914, -1.1484832763671875, 1.8248863220214844, -998.5196533203125, -0.34525084495544434, 0.7387065887451172, -7.10111141204834, -0.3284320831298828, -5.87933349609375, 1.4522247314453125, -0.8732194900512695, 0.9395561218261719, -1.4648971557617188, 1.0010604858398438, -0.4288754463195801, 0.06804895401000977, -0.4228248596191406, 1.2445785999298096, -0.41512298583984375, 0.4678535461425781, 0.1668872833251953, 2.002352714538574, -0.7109661102294922, 4.127091407775879, -0.8664073944091797, -0.9346833229064941, 0.2568492889404297, 0.93841552734375, -7.47042179107666, 0.5281734466552734, 1.0859200954437256, -7.63507080078125, -1.0375862121582031, 1.6682815551757812, 1.2837202548980713, -0.13170576095581055, -0.9815158843994141, 1.282827377319336, -1.4620475769042969, -0.20813941955566406, 1.1481571197509766, 0.9308565855026245, -1.6185302734375, 0.22698974609375, -0.7996997833251953, 0.45736443996429443, -0.5110721588134766, -0.4947214126586914, -0.10631561279296875, 1.5859527587890625, 3.9014511108398438, 2.729137420654297, 0.3419523239135742, 0.3599586486816406, 1.0536048412322998, 0.6954755783081055, -0.9476885795593262, -1.8321614265441895, -0.2371692657470703, 2.082305908203125, 0.7366104125976562, 0.41199684143066406, 6.02545166015625, -0.742027997970581, 1.6777958869934082, -0.034531593322753906, 0.17934799194335938, -0.7330036163330078, 2.6409873962402344, -0.6876764297485352, 2.0611610412597656, -0.9157291650772095, -0.05481600761413574, 0.62078857421875, 3.556039810180664, 0.0026726722717285156, 0.024721145629882812, 0.6201627254486084, -0.336885929107666, 2.995929718017578, 2.4327621459960938, -7.205890655517578, 0.06957745552062988, 0.38309669494628906, -0.659581184387207, -0.5662288665771484, 0.030727386474609375, -0.595169186592102, -1.1210594177246094, -0.06444931030273438, 0.3599586486816406, 0.060298919677734375, -1.3235979080200195, 0.7716339230537415, -0.7644515037536621, -0.6950511932373047, -5.097481727600098, 0.4461517333984375, 1.2537612915039062, -0.747624397277832], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 75776, "num_env_steps_trained": 280560, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 280560, "last_target_update_ts": 75776, "num_target_updates": 147}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -66.11911363050342, "episode_len_mean": 242.44, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742], "episode_lengths": [297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5429041052228831, "mean_inference_ms": 24.071577465621445, "mean_action_processing_ms": 0.13331451187415205, "mean_env_wait_ms": 4.278874950519388, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -850.8671916723251, "episode_reward_mean": -66.11911363050342, "episode_len_mean": 242.44, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156.6514906808734, 17.510635264217854, 5.400000117719173, -850.8671916723251, 15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742], "episode_lengths": [297, 236, 226, 450, 215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5429041052228831, "mean_inference_ms": 24.071577465621445, "mean_action_processing_ms": 0.13331451187415205, "mean_env_wait_ms": 4.278874950519388, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 280560, "num_env_steps_sampled": 75776, "num_env_steps_trained": 280560, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 75776, "agent_timesteps_total": 75776, "timers": {"training_iteration_time_ms": 358.781, "learn_time_ms": 81.019, "learn_throughput": 2962.268, "synch_weights_time_ms": 20.389}, "counters": {"num_env_steps_sampled": 75776, "num_env_steps_trained": 280560, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 280560, "last_target_update_ts": 75776, "num_target_updates": 147}, "done": false, "episodes_total": 272, "training_iteration": 74, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-24-27", "timestamp": 1655501067, "time_this_iter_s": 5.58199667930603, "time_total_s": 399.72713136672974, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 399.72713136672974, "timesteps_since_restore": 0, "iterations_since_restore": 74, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.775, "ram_util_percent": 65.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -10.125655174255371, "min_q": -80.54167175292969, "max_q": 29.709455490112305, "mean_td_error": -8.631293296813965}, "td_error": [-0.477447509765625, -0.7136774063110352, 0.6393814086914062, 2.75213623046875, 0.540156364440918, 2.6262130737304688, -0.3399791717529297, 0.014627218246459961, 0.6253852844238281, 0.9988784790039062, 0.03553962707519531, 0.36963462829589844, -2.7154464721679688, 0.24178695678710938, -0.521967887878418, -0.13423871994018555, -0.17928314208984375, -0.9778847694396973, -12.33958911895752, -10.821135520935059, 0.47312188148498535, 0.31136512756347656, 0.30693793296813965, 0.14330637454986572, -0.28160667419433594, 0.9398972988128662, -10.623668670654297, 0.9159774780273438, 0.42635536193847656, 0.8854818344116211, -0.41313838958740234, 0.6701736450195312, -0.6982288360595703, 0.9360179901123047, -3.4651241302490234, -0.376187801361084, -9.68671989440918, 0.2219541072845459, 0.9360179901123047, 0.31755316257476807, -1.2769346237182617, 0.2716975212097168, -0.10099244117736816, -0.664215087890625, -7.4440460205078125, 1.4792251586914062, -0.8710184097290039, 0.3331336975097656, -0.08549118041992188, 0.17578887939453125, 0.05748796463012695, -0.5652351379394531, -0.47091102600097656, -0.4382810592651367, -0.9030914306640625, 1.3928947448730469, 0.40621376037597656, -0.28943538665771484, 1.1506567001342773, 0.4533729553222656, 2.409025192260742, 0.9227380752563477, -0.4129204750061035, 1.0299243927001953, -0.2679634094238281, -0.18823003768920898, 0.2716827392578125, -0.19370460510253906, 1.0415706634521484, -0.41706037521362305, 0.15708160400390625, -0.3994882106781006, -5.650406360626221, 0.44043922424316406, -1.3231201171875, 0.4096031188964844, 2.3034095764160156, -0.1512622833251953, -0.45111703872680664, -0.28528690338134766, 0.04691123962402344, 0.9251623153686523, -5.898858070373535, -4.935269355773926, -0.7375373840332031, -0.1733989715576172, 0.2735443115234375, 0.9360179901123047, -0.016475677490234375, 1.0692037343978882, 0.409106969833374, 0.32940006256103516, 1.4680137634277344, -4.292789459228516, 0.5645570755004883, 1.5718908309936523, -5.4425482749938965, 0.14581334590911865, -0.3938941955566406, -0.9798164367675781, -0.07146668434143066, -1.1377944946289062, -0.2434539794921875, 1.261335849761963, -8.752982139587402, 1.0572872161865234, -0.02457904815673828, -0.1047825813293457, -0.09029042720794678, 0.6912612915039062, 1.6737174987792969, 0.9350323677062988, 0.8049888610839844, 0.8564453125, 0.15201222896575928, -0.9266681671142578, 1.2578401565551758, -0.37519359588623047, -0.16453373432159424, 0.3208627700805664, 0.1762915849685669, -1.005218505859375, 1.80157470703125, -0.07682418823242188, -0.02748584747314453, 0.05299043655395508, 0.1062631607055664, 0.09024810791015625, 0.007232457399368286, 1.2810020446777344, -0.26271533966064453, -0.3298492431640625, -2.6850109100341797, -0.08526134490966797, 0.07480621337890625, -0.360349178314209, -0.5781497955322266, 0.24076175689697266, 0.5917129516601562, 0.17296290397644043, 1.3512763977050781, -0.9680671691894531, -997.83837890625, 0.8506760597229004, 0.8632087707519531, 0.35601043701171875, 5.000085830688477, 0.580322265625, 0.48311424255371094, -0.25574779510498047, -0.21875476837158203, -0.3200998306274414, 0.18543052673339844, 0.9675893783569336, -0.10411834716796875, 0.20602183043956757, 0.5001249313354492, 1.4317302703857422, -0.12212371826171875, 0.3811225891113281, 0.6885585784912109, 0.4564189910888672, 0.03918266296386719, -997.83837890625, -0.4816631078720093, 2.3368005752563477, -0.0509638786315918, 0.4526338577270508, -0.10934257507324219, -1.5077877044677734, 0.9646511077880859, -0.9895572662353516, -0.9858245849609375, -1.1950364112854004, 0.8883132934570312, 0.09537887573242188, -0.8313369750976562, 0.19235658645629883, -1.0174751281738281, 0.6457176208496094, 0.5863409042358398, -0.019674301147460938, -0.08556842803955078, 3.253347396850586, -0.0809926986694336, -6.597590446472168, -1.6550445556640625, -0.6893680095672607, 1.2071561813354492, -2.4457154273986816, -8.001480102539062, 0.4662942886352539, 15.112482070922852, 0.20224690437316895, -0.0684463381767273, -0.8394556045532227, -0.8117713928222656, 0.20333290100097656, -0.6027300357818604, -0.5487414598464966, 0.45555686950683594, 0.11997091770172119, 0.527496337890625, -0.4816631078720093, 0.10282325744628906, -0.5243310928344727, -0.6279125213623047, 0.258453369140625, -0.3813934326171875, 0.7023468017578125, 0.6842498779296875, -6.770285129547119, -8.258537292480469, -0.276853084564209, 0.1888723373413086, -0.08853530883789062, -0.0930938720703125, 1.0846443176269531, 0.3409080505371094, -5.305473327636719, -7.468965530395508, -0.07801103591918945, -0.15919256210327148, 0.21520644426345825, 1.6038951873779297, 1.336038589477539, -0.7280154228210449, 0.6774024963378906, -0.06134796142578125, 1.1567935943603516, 0.19370245933532715, 0.6283507347106934, -0.35899829864501953, -1.1034650802612305, 0.11711311340332031, 4.483521938323975, -0.5203323364257812, -0.18824481964111328, -0.3298492431640625, -0.8414764404296875], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 76800, "num_env_steps_trained": 284400, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 284400, "last_target_update_ts": 76800, "num_target_updates": 149}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -706.0511957630515, "episode_reward_mean": -59.776184432283046, "episode_len_mean": 239.93, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359], "episode_lengths": [215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5438341938162353, "mean_inference_ms": 24.049572382644655, "mean_action_processing_ms": 0.13327547600017986, "mean_env_wait_ms": 4.276086925205188, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -706.0511957630515, "episode_reward_mean": -59.776184432283046, "episode_len_mean": 239.93, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.844033569097519, -706.0511957630515, -129.18160910904408, -47.274387419223785, -129.6184589639306, 16.756627708673477, 6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359], "episode_lengths": [215, 430, 288, 253, 276, 222, 231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5438341938162353, "mean_inference_ms": 24.049572382644655, "mean_action_processing_ms": 0.13327547600017986, "mean_env_wait_ms": 4.276086925205188, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 284400, "num_env_steps_sampled": 76800, "num_env_steps_trained": 284400, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 76800, "agent_timesteps_total": 76800, "timers": {"training_iteration_time_ms": 339.172, "learn_time_ms": 81.142, "learn_throughput": 2957.791, "synch_weights_time_ms": 20.39}, "counters": {"num_env_steps_sampled": 76800, "num_env_steps_trained": 284400, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 284400, "last_target_update_ts": 76800, "num_target_updates": 149}, "done": false, "episodes_total": 276, "training_iteration": 75, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-24-33", "timestamp": 1655501073, "time_this_iter_s": 5.593923807144165, "time_total_s": 405.3210551738739, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 405.3210551738739, "timesteps_since_restore": 0, "iterations_since_restore": 75, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.625, "ram_util_percent": 65.66250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -10.811807632446289, "min_q": -82.85628509521484, "max_q": 26.31863021850586, "mean_td_error": -4.503520488739014}, "td_error": [0.7563443183898926, -0.13583946228027344, -0.3867645263671875, 0.4313850402832031, 0.6374034881591797, 1.0681519508361816, 0.8140864372253418, -1.8266611099243164, 1.673025131225586, -1.0554442405700684, 0.15702056884765625, 0.23401546478271484, 1.1160717010498047, -0.17224597930908203, -0.6901983618736267, -0.4026908874511719, 0.5169856548309326, -0.3936706781387329, 0.6878314018249512, 1.1706504821777344, 0.06155109405517578, -0.9574661254882812, -0.39417457580566406, 0.3169670104980469, 0.4864616394042969, -6.93817138671875, -0.6172404289245605, 0.20035362243652344, 1.168025016784668, 0.48435068130493164, -1.5494740009307861, 0.8046867847442627, 0.04936408996582031, -0.8177158832550049, -0.3976435661315918, 0.4224052429199219, 0.0893411636352539, 0.06722593307495117, -0.3220367431640625, -5.022602081298828, -1.8179192543029785, -0.037502288818359375, -1.9875736236572266, -0.3665318489074707, 2.4337387084960938, 0.036566972732543945, 0.08730506896972656, -0.5457172393798828, 0.3121614456176758, 0.4622993469238281, -0.9971122741699219, -0.8458023071289062, -1.0162811279296875, -3.4202842712402344, 0.2746295928955078, 2.1884384155273438, 0.39684295654296875, -0.5626792907714844, -1.363006591796875, -998.1959838867188, -0.4376850128173828, -0.4842982292175293, 0.5243382453918457, 1.8414068222045898, -1.4769611358642578, -0.09634971618652344, 1.081624984741211, 0.005387783050537109, -0.4484519958496094, -0.5788211822509766, 0.6259956359863281, 0.8394392728805542, -0.02674388885498047, 0.7763375639915466, -9.574968338012695, 0.05510711669921875, 0.4115114212036133, 0.3600120544433594, -0.3257298469543457, -0.7577648162841797, -2.362802505493164, -0.19283342361450195, 0.5566654205322266, -0.9422702789306641, 1.0143709182739258, -0.21804237365722656, 1.3230228424072266, -0.9525508880615234, -0.20340347290039062, 0.22987937927246094, -0.12008094787597656, 0.34130859375, -2.860940933227539, -5.459815979003906, -0.10098838806152344, 0.6229572296142578, -1.1931185722351074, -0.1832103729248047, -0.798187255859375, -0.23084068298339844, 5.880056381225586, 0.21853256225585938, -2.074251651763916, -0.2923135757446289, 0.3526674509048462, 0.19288063049316406, -0.07884693145751953, 2.0533447265625, -0.022783517837524414, 0.39165258407592773, 0.2253894805908203, -0.0934438705444336, -0.042572975158691406, -0.09755134582519531, 0.4436817169189453, 0.2506561279296875, 0.15136337280273438, 0.5799102783203125, 0.1511993408203125, 0.10931205749511719, 0.39859771728515625, 0.0775146484375, -0.7524547576904297, -1.9324826002120972, -0.38525867462158203, 0.6831760406494141, 0.055753469467163086, 0.2519259452819824, 0.7675261497497559, -0.14915084838867188, -0.5160198211669922, 0.29369401931762695, 0.2423868179321289, -2.2515525817871094, 0.7273740768432617, -0.018390655517578125, 0.7563443183898926, 0.1263713836669922, -0.38409996032714844, -0.15345001220703125, 0.027889490127563477, -0.3567008972167969, -1.4145698547363281, -1.08441162109375, -0.22527098655700684, -0.3671703338623047, 0.2910022735595703, 0.6259956359863281, -0.45696067810058594, 0.2198629379272461, 0.9493122100830078, -0.2266470193862915, 2.4337387084960938, 1.4924306869506836, 0.08704853057861328, -0.09240522980690002, 0.34029197692871094, -1.2973308563232422, -0.2651824951171875, -0.23477745056152344, -0.39932823181152344, 0.3304519057273865, -1.2278804779052734, 0.31003856658935547, -0.983856201171875, -6.93817138671875, 0.35164642333984375, 0.41312694549560547, 0.4099006652832031, 0.8042395114898682, 0.23680812120437622, -2.3110904693603516, 0.9739227294921875, 0.07239055633544922, -0.3903493881225586, 1.649099349975586, -0.2887287139892578, -0.05474209785461426, 2.901604652404785, -0.2658655047416687, -0.7683305740356445, 0.5346236228942871, 0.2654247283935547, -0.3482398986816406, -0.7847461700439453, -0.4847373962402344, -2.476764678955078, 0.6342082023620605, 1.4618606567382812, -0.7524547576904297, -0.019263505935668945, 0.007966041564941406, -0.6971570253372192, 0.9981193542480469, -0.15345001220703125, -0.9878501892089844, 1.538619041442871, -9.924996376037598, 1.1855249404907227, 1.0822792053222656, -0.2928328514099121, -1.1584110260009766, -0.11162757873535156, 0.1659102439880371, -0.05270671844482422, 0.4808053970336914, -0.9836082458496094, 0.9041123390197754, -0.2244400978088379, -13.806324005126953, -0.40722858905792236, -1.517629623413086, -0.8263874053955078, -0.22670364379882812, 1.1855249404907227, -9.647359848022461, 0.2161998748779297, 0.31673431396484375, -2.0389156341552734, 0.5981532335281372, 0.3091602325439453, 0.22933673858642578, -0.4326820373535156, 0.28642892837524414, -0.215789794921875, 0.27906322479248047, -0.6963157653808594, -0.16355133056640625, -0.50830078125, -11.790650367736816, 0.692354679107666, -0.09056854248046875, 0.4041767120361328, 0.7707099914550781, 0.5280075073242188, -1.212320327758789, 0.5595555305480957, -1.251251220703125, -0.4970579147338867, -0.05697441101074219], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 77824, "num_env_steps_trained": 288240, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 288240, "last_target_update_ts": 77824, "num_target_updates": 151}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -438.93339455872774, "episode_reward_mean": -51.21877989925444, "episode_len_mean": 236.81, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215], "episode_lengths": [231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5456003949928598, "mean_inference_ms": 24.05467255851701, "mean_action_processing_ms": 0.1330445668167596, "mean_env_wait_ms": 4.284381559233474, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -438.93339455872774, "episode_reward_mean": -51.21877989925444, "episode_len_mean": 236.81, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.200000114738941, -177.66234210133553, 4.600000217556953, -60.956163324415684, -21.776144102215767, 5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215], "episode_lengths": [231, 316, 210, 239, 245, 186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5456003949928598, "mean_inference_ms": 24.05467255851701, "mean_action_processing_ms": 0.1330445668167596, "mean_env_wait_ms": 4.284381559233474, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 288240, "num_env_steps_sampled": 77824, "num_env_steps_trained": 288240, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 77824, "agent_timesteps_total": 77824, "timers": {"training_iteration_time_ms": 349.027, "learn_time_ms": 80.155, "learn_throughput": 2994.197, "synch_weights_time_ms": 21.288}, "counters": {"num_env_steps_sampled": 77824, "num_env_steps_trained": 288240, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 288240, "last_target_update_ts": 77824, "num_target_updates": 151}, "done": false, "episodes_total": 282, "training_iteration": 76, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-24-39", "timestamp": 1655501079, "time_this_iter_s": 5.635516881942749, "time_total_s": 410.95657205581665, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 410.95657205581665, "timesteps_since_restore": 0, "iterations_since_restore": 76, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.575000000000003, "ram_util_percent": 65.6125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.408188819885254, "min_q": -88.21257781982422, "max_q": 27.05079460144043, "mean_td_error": -4.8850483894348145}, "td_error": [-2.946908950805664, 0.3450736999511719, -3.377056121826172, 0.4351692199707031, -0.20284461975097656, 1.5479736328125, 2.029691696166992, 4.998203277587891, 0.34519004821777344, 0.2820892333984375, -3.377056121826172, 0.7274971008300781, 0.6831061840057373, -0.15033459663391113, -0.17316818237304688, -0.2854881286621094, 5.311285972595215, -0.05727100372314453, -0.27643775939941406, 0.4958810806274414, 3.200321674346924, 0.18478797376155853, -996.3193359375, -0.2796593904495239, -0.07021331787109375, 0.043404579162597656, 1.479994773864746, -0.1170644760131836, -0.2827162742614746, 0.92779541015625, -0.6202144622802734, -0.8213176727294922, -0.7254152297973633, -0.80419921875, -0.8839054107666016, -0.07824274897575378, 0.4649834632873535, -0.2874279022216797, -5.936105728149414, 0.3408999443054199, 1.5025558471679688, -0.19393885135650635, 0.0986318588256836, -0.1053314208984375, 0.13837575912475586, -0.42685604095458984, 1.1691951751708984, 1.4616291522979736, 0.3351879119873047, 0.17880821228027344, -0.6439707279205322, 15.397806167602539, 0.07501220703125, -4.768764495849609, 0.4130897521972656, -0.37432384490966797, -0.3306293487548828, -1.1755614280700684, -1.0703182220458984, 1.0891189575195312, -0.15199851989746094, -0.4862651824951172, 0.7543411254882812, -2.804868698120117, -8.18021011352539, 2.0438079833984375, 0.5260205268859863, 0.3070220947265625, -0.6079072952270508, -21.84377670288086, -0.7899589538574219, 0.25116872787475586, 0.22954654693603516, -0.09799480438232422, 1.2458877563476562, 0.0914919376373291, -0.8743810653686523, -0.040004730224609375, 0.4413738250732422, 0.2504262924194336, -0.4725179672241211, -0.04952073097229004, -0.4278411865234375, -0.7112789154052734, -0.8151359558105469, -4.260743141174316, -0.14397740364074707, 4.810347080230713, 0.24043846130371094, 1.2280731201171875, 1.0478544235229492, -0.8453354835510254, -3.0071258544921875, -2.2082290649414062, -0.5236806869506836, 1.4544658660888672, -9.904370307922363, -0.8489546775817871, -0.10539102554321289, -1.2769384384155273, 0.05070900917053223, 2.1075439453125, -0.803009033203125, 0.07641315460205078, 0.24915862083435059, -0.43996238708496094, -0.19771039485931396, -8.791393280029297, -21.84377670288086, 0.19512081146240234, -2.8071165084838867, -0.8272563815116882, -0.31891918182373047, -0.23273849487304688, -0.33669042587280273, 2.5652527809143066, -0.3628568649291992, -0.26663780212402344, -15.816429138183594, -30.826793670654297, -0.05834484100341797, 0.8510665893554688, 0.18088197708129883, -0.5087184906005859, -0.44304847717285156, 0.06179618835449219, 0.028200149536132812, 0.04628944396972656, -0.22674179077148438, -13.36097526550293, -2.4242334365844727, 2.9316558837890625, -23.28369903564453, 0.19861066341400146, -0.36460018157958984, 1.318288803100586, 0.08472061157226562, -0.5871210098266602, 0.6865367889404297, 0.07501220703125, 0.9269580841064453, -0.8145265579223633, -1.384882926940918, -1.5211687088012695, -1.2357959747314453, 0.9451954364776611, 0.2958183288574219, -0.33814048767089844, 0.8228263854980469, -0.2605605125427246, 0.5083272457122803, -4.665642738342285, -3.4112548828125, -0.28356945514678955, -0.23792719841003418, -0.39260292053222656, 2.6776580810546875, -0.8314990997314453, -2.558596611022949, -1.681197166442871, -0.5762557983398438, -0.9558868408203125, 0.975245475769043, 1.2723503112792969, -0.5025157928466797, -1.9905834197998047, -0.040866851806640625, -0.5085468292236328, -8.297199249267578, 3.5140130519866943, 0.16962528228759766, 0.07480955123901367, 0.6873788833618164, 0.279886394739151, 0.3315610885620117, -1.1180405616760254, -15.566587448120117, 1.6326828002929688, -2.6791610717773438, 1.057516098022461, -0.004133701324462891, -1.1462774276733398, -1.0094051361083984, 1.3655452728271484, -0.17004776000976562, -0.373960018157959, -0.295440673828125, -0.07568740844726562, 1.5357651710510254, 0.5843062400817871, 2.6581573486328125, 0.5294914245605469, 0.01979944109916687, -0.1537494659423828, -0.5668745040893555, -0.2973823547363281, -0.3153724670410156, 0.10188829898834229, 2.2285897731781006, -5.285290718078613, -0.2905886173248291, -4.637726306915283, 0.16707420349121094, -0.35245609283447266, -0.15546321868896484, 0.2804219722747803, -0.07026481628417969, 0.600736141204834, -1.046102523803711, -0.25207996368408203, 0.1957184076309204, -0.2134237289428711, 0.10368645191192627, 4.213846683502197, -0.0796041488647461, -0.13590240478515625, 0.5546398162841797, 1.2410736083984375, 9.173117637634277, -0.9196271896362305, 0.40705108642578125, -1.1821022033691406, 0.5703121423721313, 0.24178266525268555, 0.5967187881469727, 0.5506292581558228, -0.24284005165100098, 1.2258758544921875, 0.45194530487060547, 0.35433053970336914, -2.1613407135009766, -1.7454643249511719, -0.571533203125, -1.5680294036865234, -0.45344841480255127, -0.6350412368774414, -0.5426158905029297, 0.5069904327392578, 0.15173053741455078, 1.0446968078613281], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 78848, "num_env_steps_trained": 292080, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 292080, "last_target_update_ts": 78848, "num_target_updates": 153}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -438.93339455872774, "episode_reward_mean": -49.09857194505632, "episode_len_mean": 235.03, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055], "episode_lengths": [186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5458770510538634, "mean_inference_ms": 24.072734691512, "mean_action_processing_ms": 0.1331422076368143, "mean_env_wait_ms": 4.290338463302644, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -438.93339455872774, "episode_reward_mean": -49.09857194505632, "episode_len_mean": 235.03, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.200000040233135, 16.011267364025116, -28.520606115460396, 12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055], "episode_lengths": [186, 231, 244, 193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5458770510538634, "mean_inference_ms": 24.072734691512, "mean_action_processing_ms": 0.1331422076368143, "mean_env_wait_ms": 4.290338463302644, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 292080, "num_env_steps_sampled": 78848, "num_env_steps_trained": 292080, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 78848, "agent_timesteps_total": 78848, "timers": {"training_iteration_time_ms": 345.539, "learn_time_ms": 82.068, "learn_throughput": 2924.392, "synch_weights_time_ms": 21.186}, "counters": {"num_env_steps_sampled": 78848, "num_env_steps_trained": 292080, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 292080, "last_target_update_ts": 78848, "num_target_updates": 153}, "done": false, "episodes_total": 287, "training_iteration": 77, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-24-44", "timestamp": 1655501084, "time_this_iter_s": 5.488417387008667, "time_total_s": 416.4449894428253, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 416.4449894428253, "timesteps_since_restore": 0, "iterations_since_restore": 77, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.5375, "ram_util_percent": 65.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -10.796314239501953, "min_q": -87.83885192871094, "max_q": 27.981414794921875, "mean_td_error": -0.12752975523471832}, "td_error": [0.989227294921875, 0.7689511775970459, -0.3198728561401367, -0.03382301330566406, 0.29448044300079346, 0.5895767211914062, -0.538132905960083, 0.30926334857940674, 0.36847877502441406, 0.2693512439727783, -0.5922412872314453, -0.13089752197265625, 2.317554473876953, 0.17280495166778564, -0.7194604873657227, -4.925166606903076, 0.12300229072570801, 2.6630630493164062, 1.7567386627197266, 1.5077934265136719, -0.39166176319122314, 0.04201316833496094, -0.7763748168945312, -0.31985318660736084, 1.2549171447753906, 0.05630183219909668, -5.102780342102051, 1.5449867248535156, 1.3347501754760742, 0.9598808288574219, 0.26044178009033203, -1.0707626342773438, 1.5597114562988281, -0.4365990161895752, 0.3067636489868164, 0.5303478240966797, 0.5609089136123657, 2.2424049377441406, 0.10360453277826309, 7.059230804443359, 1.0320701599121094, 0.029052257537841797, -0.5009090900421143, 0.5418479442596436, 1.5504655838012695, 0.5304431319236755, 0.7154121398925781, 1.7430419921875, 0.9009418487548828, 1.5917949676513672, 0.17783069610595703, -4.747655391693115, -1.290885329246521, -0.33226823806762695, -8.84178352355957, 0.9803066253662109, 0.39512062072753906, -0.009417533874511719, 0.3446025848388672, 0.7665634155273438, -0.0808420181274414, 1.0121536254882812, -0.39522647857666016, -0.6308021545410156, 0.6205687522888184, 1.4029502868652344, 0.24038049578666687, 0.526963472366333, -0.14949250221252441, -0.14949250221252441, 0.8095054626464844, -0.5585994720458984, -0.029449462890625, -1.9660353660583496, -0.6771602630615234, 0.24714946746826172, -4.296176433563232, -0.28872907161712646, -0.12222099304199219, -0.2887110710144043, 0.024522781372070312, 1.3066482543945312, 0.08998227119445801, 0.04184913635253906, 0.5372076034545898, 0.3256502151489258, -0.15567398071289062, -0.7223548889160156, 0.7349338531494141, 0.16692352294921875, 0.12651634216308594, -2.3443832397460938, 0.06447076797485352, 0.6323575973510742, 0.38155269622802734, 0.2454700469970703, -0.45577046275138855, -0.2836284637451172, 0.8117914199829102, -0.0995950698852539, 0.31714916229248047, -0.264420747756958, 0.9071044921875, 0.004384279251098633, 3.1728515625, -0.4234189987182617, 0.11211776733398438, 0.9965724945068359, 0.15205001831054688, 1.349639892578125, 1.4664173126220703, -1.1817264556884766, 0.3036375045776367, 1.4330253601074219, -0.18142318725585938, -0.09805059432983398, 0.5463180541992188, 0.15541982650756836, -0.3019590377807617, 0.1836785078048706, -0.31533384323120117, 1.1657142639160156, 0.7317085266113281, -0.11086750030517578, 0.95318603515625, -7.749427795410156, 0.05567455291748047, 1.7864322662353516, -3.196775436401367, 1.3143806457519531, 0.6070690155029297, -0.13678550720214844, -9.964595794677734, 1.1047639846801758, -0.07545089721679688, 0.9394302368164062, 0.2190556526184082, -0.04416465759277344, 1.4992971420288086, 0.4107093811035156, 0.48688793182373047, -0.4216022491455078, 0.5612106323242188, 0.9380440711975098, 0.13477516174316406, 0.4823274612426758, -12.824265480041504, 0.7604351043701172, 2.1405067443847656, 1.2648992538452148, 1.102285385131836, 1.6823816299438477, 1.4012179374694824, 0.14054489135742188, -0.49701976776123047, 0.6141905784606934, -0.3348674774169922, -0.8244400024414062, 3.5024757385253906, 1.629629135131836, 0.8192138671875, 0.6133651733398438, 2.7348246574401855, 0.3117046356201172, -0.29232215881347656, -2.004995822906494, 0.5398807525634766, -0.12695381045341492, -0.16900241374969482, 0.3030843734741211, 0.36224472522735596, -0.029516220092773438, 0.9973220825195312, -0.7544174194335938, 1.1161518096923828, -0.2664642333984375, 0.15162086486816406, -4.908659934997559, -18.499305725097656, -0.19501924514770508, 2.5412216186523438, 0.82281494140625, -0.7504720687866211, 0.3959236145019531, -1.8955268859863281, -0.38491249084472656, 0.15097689628601074, 0.9225893020629883, -0.24360370635986328, 0.7620849609375, -4.197301864624023, 0.10638809204101562, -0.8262858390808105, -0.3354835510253906, 0.21598243713378906, 1.5344152450561523, 0.3814314603805542, -0.4038572311401367, -0.04069192707538605, 2.4548559188842773, -5.906375885009766, -0.5850802063941956, 0.7242436408996582, 0.29862308502197266, 1.2276840209960938, 0.4612882137298584, -0.14833831787109375, 0.3716268539428711, 0.4492664337158203, 2.1405067443847656, 0.024519681930541992, -1.5822277069091797, 1.1870112419128418, -0.1252584457397461, 0.24802136421203613, -0.09383797645568848, 1.7611885070800781, 2.4548559188842773, 0.21902847290039062, 2.512056350708008, -0.2841463088989258, -24.8344669342041, 0.34261322021484375, -6.472836494445801, 1.4090576171875, 6.171661376953125, 2.1641311645507812, 0.3635826110839844, 2.4032955169677734, -0.5665087699890137, -6.964778900146484, 0.9488487243652344, -0.19446516036987305, 0.32935619354248047, -0.21376419067382812, 0.3416614532470703, 1.6814594268798828, -0.14577674865722656, -0.7280616760253906, -0.5138130187988281], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 79872, "num_env_steps_trained": 295920, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 295920, "last_target_update_ts": 79872, "num_target_updates": 155}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -438.93339455872774, "episode_reward_mean": -49.0571210000664, "episode_len_mean": 235.02, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184], "episode_lengths": [193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5459472959186299, "mean_inference_ms": 24.088597391904532, "mean_action_processing_ms": 0.13313702722034704, "mean_env_wait_ms": 4.295839627171631, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -438.93339455872774, "episode_reward_mean": -49.0571210000664, "episode_len_mean": 235.02, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.700902596116066, -200.36212585121393, -21.515544325113297, -31.324578635394573, 11.052629232406616, 10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184], "episode_lengths": [193, 264, 246, 238, 233, 238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5459472959186299, "mean_inference_ms": 24.088597391904532, "mean_action_processing_ms": 0.13313702722034704, "mean_env_wait_ms": 4.295839627171631, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 295920, "num_env_steps_sampled": 79872, "num_env_steps_trained": 295920, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 79872, "agent_timesteps_total": 79872, "timers": {"training_iteration_time_ms": 331.088, "learn_time_ms": 80.408, "learn_throughput": 2984.782, "synch_weights_time_ms": 20.685}, "counters": {"num_env_steps_sampled": 79872, "num_env_steps_trained": 295920, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 295920, "last_target_update_ts": 79872, "num_target_updates": 155}, "done": false, "episodes_total": 290, "training_iteration": 78, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-24-50", "timestamp": 1655501090, "time_this_iter_s": 5.402029037475586, "time_total_s": 421.8470184803009, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 421.8470184803009, "timesteps_since_restore": 0, "iterations_since_restore": 78, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.25, "ram_util_percent": 65.66250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -11.533011436462402, "min_q": -92.0681381225586, "max_q": 32.44223403930664, "mean_td_error": -0.8975864052772522}, "td_error": [0.15102481842041016, 0.12031936645507812, 0.18388795852661133, 0.516845703125, 0.05712890625, 0.16190147399902344, 1.0396404266357422, -4.5615034103393555, -0.5115904808044434, -1.051069736480713, 0.47194743156433105, 0.8637657165527344, -0.365602970123291, 0.061791181564331055, -0.20088887214660645, 0.07278251647949219, -0.3885669708251953, 0.8789196014404297, -0.09085464477539062, 3.6135520935058594, 0.05403876304626465, -0.2974395751953125, 0.07979059219360352, 0.05261707305908203, 1.1520538330078125, 2.3570098876953125, -6.381591796875, -8.474592208862305, -0.6073112487792969, 0.1977805495262146, -2.0058841705322266, -1.4931259155273438, 1.3726091384887695, 0.17033767700195312, 0.3740713894367218, 1.472970962524414, 1.5515022277832031, -0.5627899169921875, 0.629913330078125, -0.6934337615966797, -0.16775035858154297, 0.3173714876174927, -0.4446735382080078, 0.7316341400146484, -0.29776763916015625, 0.49198341369628906, 0.3383832573890686, 1.0631942749023438, -1.3309707641601562, 0.5230178833007812, 0.20428204536437988, -0.8207263946533203, 0.7501707077026367, -0.038033485412597656, -1.874267578125, -16.141849517822266, 1.0633697509765625, 1.1967029571533203, -0.4960956573486328, 0.02317333221435547, -0.39488792419433594, 0.23634672164916992, -1.4084968566894531, -1.6296424865722656, -0.16174602508544922, 2.671584129333496, -3.9244937896728516, -29.03839111328125, -2.5627918243408203, -0.6674461364746094, -0.3885669708251953, -1.4843120574951172, -1.3502826690673828, -25.722230911254883, 1.7146711349487305, -0.1894235610961914, -0.20046567916870117, -3.458376884460449, 1.3792800903320312, -0.36504122614860535, -0.068511962890625, 0.06984949111938477, 0.8948116302490234, 0.4660520553588867, -1.4385452270507812, -1.3036155700683594, -0.21508312225341797, -0.1219024658203125, -22.77901840209961, 2.671584129333496, 0.17737269401550293, -0.8563213348388672, -0.042670249938964844, 0.1612381935119629, 1.9651966094970703, 0.7113914489746094, 0.15044379234313965, 2.0257720947265625, -0.01658344268798828, -9.904399871826172, -1.0536210536956787, -7.642549514770508, -0.8527488708496094, -0.08224296569824219, 0.27541136741638184, -0.1367931365966797, 0.42455363273620605, -0.5248775482177734, 0.0402379035949707, 0.16802716255187988, 0.17456912994384766, -0.024386882781982422, 0.7314605712890625, -0.7427921295166016, -0.8707904815673828, -0.47669506072998047, -0.06388092041015625, -20.706329345703125, 0.17901897430419922, -1.2697372436523438, -0.41397857666015625, -5.473227500915527, -1.0061674118041992, -1.2319316864013672, -1.878281831741333, -1.0762310028076172, -0.213623046875, 0.4034762382507324, 1.9246101379394531, 0.7571592330932617, 2.4149932861328125, 0.9240155220031738, 2.9537506103515625, -0.15362906455993652, -0.340423583984375, -0.26211118698120117, -2.862842082977295, 0.7059258222579956, -0.06522369384765625, -0.31841468811035156, -0.8707904815673828, -1.1999168395996094, -3.438213348388672, 0.9181442260742188, -0.03188967704772949, -0.44553184509277344, -0.11778831481933594, 1.05804443359375, -0.6078479290008545, -2.4268417358398438, -0.3170146942138672, -1.2968006134033203, -11.328052520751953, 0.10178780555725098, 1.6851081848144531, -1.1671314239501953, -1.913264274597168, 0.0010232925415039062, 0.059916019439697266, -0.7668514251708984, 0.7047719955444336, 1.4137744903564453, 0.30885958671569824, -0.8138847351074219, 0.07753658294677734, -0.1801905632019043, -1.323110580444336, 0.4189720153808594, -1.9509315490722656, -0.5726494789123535, 0.0672987699508667, -1.0595741271972656, 0.30104637145996094, 0.6435737609863281, 0.2264719009399414, 0.24571990966796875, -1.3719520568847656, -0.16083908081054688, 0.051123857498168945, -0.2673959732055664, -0.6633491516113281, -1.4946889877319336, -1.2360551357269287, 0.304022878408432, 0.9644012451171875, -2.358306884765625, -0.01956939697265625, -0.09649646282196045, 0.23523902893066406, -0.1367473602294922, -2.5732479095458984, -0.4110984802246094, 0.1339244842529297, 0.296062707901001, -3.5700020790100098, -2.2234230041503906, 0.39809608459472656, -0.16008853912353516, 3.048980712890625, -0.7999858856201172, 0.7017009258270264, -0.04400968551635742, -0.5526409149169922, -0.21015357971191406, 0.1540660858154297, -1.214169979095459, -0.4599647521972656, 0.14395523071289062, -0.0789947509765625, 2.5266265869140625, -12.372200012207031, 0.8210158348083496, 0.14696884155273438, 0.03365325927734375, -0.6468124389648438, 0.645380973815918, -0.27472972869873047, 0.6574459075927734, 0.16682958602905273, 0.03799295425415039, -0.014617919921875, 0.4572024345397949, -2.351069450378418, 5.056094169616699, -4.898159980773926, -0.592808723449707, 0.3887925148010254, -0.5639485716819763, 0.48825085163116455, -0.44803524017333984, 0.1029052734375, -0.3129005432128906, 0.4937763214111328, -0.5941894054412842, -0.5002327561378479, -2.2112884521484375, -0.49750518798828125, -5.182753562927246, -0.20767831802368164, -1.5060310363769531], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 80896, "num_env_steps_trained": 299760, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 299760, "last_target_update_ts": 80896, "num_target_updates": 157}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -438.93339455872774, "episode_reward_mean": -47.051402505487204, "episode_len_mean": 233.49, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666], "episode_lengths": [238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5471678496945374, "mean_inference_ms": 24.068971842493834, "mean_action_processing_ms": 0.13276624570370732, "mean_env_wait_ms": 4.296173108164696, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -438.93339455872774, "episode_reward_mean": -47.051402505487204, "episode_len_mean": 233.49, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.238949038088322, 4.9647858291864395, 20.87800608575344, -438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666], "episode_lengths": [238, 201, 213, 372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5471678496945374, "mean_inference_ms": 24.068971842493834, "mean_action_processing_ms": 0.13276624570370732, "mean_env_wait_ms": 4.296173108164696, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 299760, "num_env_steps_sampled": 80896, "num_env_steps_trained": 299760, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 80896, "agent_timesteps_total": 80896, "timers": {"training_iteration_time_ms": 342.449, "learn_time_ms": 81.178, "learn_throughput": 2956.468, "synch_weights_time_ms": 20.29}, "counters": {"num_env_steps_sampled": 80896, "num_env_steps_trained": 299760, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 299760, "last_target_update_ts": 80896, "num_target_updates": 157}, "done": false, "episodes_total": 295, "training_iteration": 79, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-24-55", "timestamp": 1655501095, "time_this_iter_s": 5.437105417251587, "time_total_s": 427.2841238975525, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 427.2841238975525, "timesteps_since_restore": 0, "iterations_since_restore": 79, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.799999999999997, "ram_util_percent": 65.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -10.979483604431152, "min_q": -89.08882904052734, "max_q": 30.27199363708496, "mean_td_error": -9.612706184387207}, "td_error": [-2.0594091415405273, -0.7360076904296875, 0.690302848815918, 0.49964141845703125, 0.27190351486206055, -0.09836626052856445, -0.6352043151855469, 0.23894691467285156, 1.9919509887695312, 0.14659547805786133, -2.3386058807373047, -0.24124813079833984, -1.0378971099853516, -1.336838722229004, 0.19516265392303467, -3.2678585052490234, -8.775472640991211, -6.696735382080078, 0.10939764976501465, -0.5654131174087524, -1.3729639053344727, 0.3465311527252197, -0.6521320343017578, -7.303523540496826, -1.5494012832641602, -1.3197593688964844, -0.06762027740478516, -1.33290696144104, -0.6608505249023438, -0.11555671691894531, -0.485107421875, 0.22225189208984375, -0.6695518493652344, -1.8333873748779297, -0.4674229621887207, -1.2667980194091797, 0.16315311193466187, -2.270627021789551, -1.8059101104736328, 0.5049095153808594, -4.496350288391113, -0.89996337890625, -1.654470443725586, -0.24649333953857422, 1.482682228088379, 2.550386428833008, 0.31276804208755493, -1.538583755493164, -1.1377677917480469, 0.2259063720703125, -0.7690887451171875, 0.16463661193847656, -0.9019942283630371, 0.14167523384094238, -1.410604476928711, 0.6035003662109375, 0.5533180236816406, -0.4069366455078125, -2.2685489654541016, 0.07884359359741211, -1.09173583984375, -1.0641002655029297, -2.2148990631103516, -0.806513786315918, -1.3088245391845703, 0.31958508491516113, -1.8882694244384766, -2.724720001220703, -1.2477331161499023, 0.5919713973999023, -0.8948974609375, -0.19530677795410156, -1.1901041269302368, -0.057163238525390625, -1.4511299133300781, -1.1301040649414062, -0.038229942321777344, 0.4186300039291382, -1.503464698791504, 0.43873119354248047, 0.4344358444213867, 0.5874285697937012, -0.7363986968994141, -2.154233932495117, -0.39667510986328125, -0.110565185546875, -0.4685029983520508, -0.7817716598510742, 0.15012073516845703, -1.4328107833862305, -14.57994270324707, -6.562828063964844, 0.4213066101074219, -1.407700538635254, -2.729891538619995, -0.5916280746459961, -0.7767715454101562, -0.07155609130859375, -0.46405506134033203, -2.1544761657714844, -0.31172990798950195, -0.6356201171875, 0.045825958251953125, -0.8752102851867676, 0.2444753646850586, -0.15978717803955078, 0.0867919921875, -0.8992462158203125, -2.0677785873413086, -1.5531253814697266, -0.8523941040039062, -1.3824896812438965, -0.14476490020751953, -0.39888954162597656, -10.333937644958496, -0.3843860626220703, 0.3020097017288208, -996.7257690429688, 0.43647003173828125, -1.5583610534667969, -3.6706771850585938, -0.6161956787109375, -4.104227542877197, -0.7405366897583008, -10.948385238647461, -3.6813011169433594, -0.15376949310302734, 0.10440492630004883, -0.8083019256591797, -0.07081592082977295, -1.016573190689087, -1.9053363800048828, -2.824392318725586, -1.0244910717010498, 0.8523826599121094, -0.25536537170410156, -0.6705245971679688, -3.2966079711914062, -1.819131851196289, 0.03437042236328125, -0.4255809783935547, -0.01982402801513672, -3.7913970947265625, -1.3250856399536133, -0.3823699951171875, 0.19654160737991333, -0.7599306106567383, -0.6557447910308838, 0.5432662963867188, 0.4412975311279297, 0.2364368438720703, -1.8734016418457031, 8.79866886138916, 0.7004928588867188, -0.015687942504882812, 0.24774551391601562, 0.48406434059143066, 0.07360458374023438, -1.2088851928710938, -1.7370071411132812, -22.734222412109375, -2.3063583374023438, -0.6179752349853516, -2.345500946044922, -2.3022689819335938, -0.23736858367919922, -1.407700538635254, -1.0612735748291016, 1.0772485733032227, 0.5782742500305176, -3.027130126953125, -1.1377677917480469, 0.3586341142654419, -1.3852577209472656, 0.43032026290893555, -2.680562973022461, -1.0377960205078125, -0.03235149383544922, -0.5176868438720703, 0.14314794540405273, -1.881429672241211, -0.53460693359375, 0.12300777435302734, -1.5190925598144531, -15.319316864013672, -0.39541053771972656, 0.31276804208755493, -2.744866371154785, -1.4054012298583984, -2.6251230239868164, 0.5432662963867188, -1.3738842010498047, 0.48312950134277344, -1.5191421508789062, -10.948385238647461, -0.5394020080566406, -0.044193267822265625, -0.9994182586669922, 0.13430309295654297, -1.1478118896484375, -1.6598682403564453, -0.5328083038330078, -1.6252946853637695, -4.574867248535156, -12.034709930419922, -2.8952064514160156, -996.7257690429688, -0.0339970588684082, -1.8269023895263672, 0.8523826599121094, 0.08670234680175781, -0.31077003479003906, 0.7110762596130371, 0.15335845947265625, 4.12735652923584, -0.06077766418457031, -0.5939443707466125, 0.41229248046875, 0.012920379638671875, -1.2458648681640625, -2.409923553466797, -2.291135787963867, -2.371612548828125, -0.6197547912597656, 0.19652056694030762, 0.0640866756439209, 1.0364127159118652, -9.570414543151855, -1.667236328125, -1.1845016479492188, 0.3756141662597656, 0.4218568801879883, -25.10470962524414, -0.89996337890625, -0.7837066650390625, -0.47005367279052734, -1.6408586502075195, 0.19086647033691406, -0.14981555938720703, -0.4420759975910187], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 81920, "num_env_steps_trained": 303600, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 303600, "last_target_update_ts": 81920, "num_target_updates": 159}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -438.93339455872774, "episode_reward_mean": -47.53860777102411, "episode_len_mean": 233.82, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399], "episode_lengths": [372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5477277089357994, "mean_inference_ms": 24.069588923715695, "mean_action_processing_ms": 0.13277282886713201, "mean_env_wait_ms": 4.297376405002135, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -438.93339455872774, "episode_reward_mean": -47.53860777102411, "episode_len_mean": 233.82, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-438.93339455872774, 3.9132200554013252, 4.200000166893005, 7.262724369764328, 7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399], "episode_lengths": [372, 239, 223, 220, 184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5477277089357994, "mean_inference_ms": 24.069588923715695, "mean_action_processing_ms": 0.13277282886713201, "mean_env_wait_ms": 4.297376405002135, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 303600, "num_env_steps_sampled": 81920, "num_env_steps_trained": 303600, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 81920, "agent_timesteps_total": 81920, "timers": {"training_iteration_time_ms": 351.093, "learn_time_ms": 80.523, "learn_throughput": 2980.504, "synch_weights_time_ms": 20.489}, "counters": {"num_env_steps_sampled": 81920, "num_env_steps_trained": 303600, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 303600, "last_target_update_ts": 81920, "num_target_updates": 159}, "done": false, "episodes_total": 298, "training_iteration": 80, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-25-01", "timestamp": 1655501101, "time_this_iter_s": 5.487820625305176, "time_total_s": 432.77194452285767, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 432.77194452285767, "timesteps_since_restore": 0, "iterations_since_restore": 80, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.71428571428571, "ram_util_percent": 65.67142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -12.433297157287598, "min_q": -91.72358703613281, "max_q": 30.645410537719727, "mean_td_error": -0.5973806977272034}, "td_error": [-1.9636669158935547, -0.7493362426757812, 0.13365459442138672, 0.23236083984375, 0.5124683380126953, 0.07912063598632812, 0.4745302200317383, 0.30854225158691406, -0.29387855529785156, -0.5988216400146484, 10.879694938659668, 0.11312717199325562, 0.7635831832885742, 0.9704608917236328, -0.5450477600097656, -0.13162994384765625, -0.06278800964355469, -0.13827204704284668, -0.9395713806152344, -0.16162490844726562, 0.6407790184020996, -0.4862093925476074, -3.80349063873291, 0.005329132080078125, -0.03726816177368164, 0.37741661071777344, -0.1294403076171875, -0.9504842758178711, -0.2386692762374878, -0.08930778503417969, -2.088613510131836, 2.465089797973633, 0.4253196716308594, 1.2586421966552734, 0.4789160192012787, -4.366159439086914, -0.22446441650390625, 0.40772438049316406, 1.5772037506103516, -1.578927993774414, -1.1472902297973633, 0.3627328872680664, -0.04706764221191406, 0.7088336944580078, 0.5122814178466797, 0.45796966552734375, 0.1838994026184082, 1.2971973419189453, -0.44577884674072266, -0.035709381103515625, 0.6789627075195312, 0.22922897338867188, -1.2656946182250977, -0.38007164001464844, 0.3770723342895508, -0.14842987060546875, 0.42861127853393555, -1.8729095458984375, -0.7428512573242188, 0.8920202255249023, -18.768409729003906, -0.47492218017578125, 0.08844614028930664, -0.7492828369140625, 0.6976032257080078, -3.6307482719421387, -1.5153541564941406, 0.6146411895751953, 0.5110435485839844, 0.21661376953125, 0.5967731475830078, -7.657904624938965, -0.24922579526901245, -0.22501850128173828, 1.3165159225463867, -17.824575424194336, -0.07377243041992188, 0.669102668762207, 0.6501388549804688, 0.40099143981933594, -0.020244598388671875, -0.2307605743408203, -1.9831161499023438, 0.47306060791015625, 1.096170425415039, -2.5126514434814453, -0.30991101264953613, -1.1842875480651855, 0.05268383026123047, -0.1876049041748047, -0.2730426788330078, 0.8148527145385742, 0.252777099609375, -0.2725639343261719, 1.4186248779296875, -0.5684585571289062, -0.029447317123413086, 1.1048450469970703, -20.4720458984375, -0.9193344116210938, 1.2552061080932617, -0.6501493453979492, -0.3796806335449219, 1.4760360717773438, 0.5782890319824219, 0.4014681577682495, 0.14363479614257812, 0.4467802047729492, 0.23282814025878906, -0.0285835862159729, -0.18567514419555664, -0.26633262634277344, 1.6141014099121094, -9.540985107421875, -0.8935303688049316, -0.02612590789794922, 0.8905482292175293, 0.17037010192871094, 0.6671180725097656, 0.2472020387649536, 0.088996022939682, 0.4680185317993164, -0.2806081771850586, -1.6317291259765625, 0.22376394271850586, -0.0050067901611328125, 0.6195144653320312, 0.14363479614257812, -1.6669654846191406, 0.39182281494140625, -1.2635622024536133, -0.0766897201538086, 0.04252433776855469, -0.9040279388427734, -36.60197830200195, 0.19265437126159668, 0.2321147918701172, 0.26677894592285156, 0.34100341796875, 0.0898427963256836, 0.021633148193359375, -0.5769314765930176, -0.5642337799072266, -0.3632965087890625, -1.9860343933105469, -0.8346614837646484, 0.4045257568359375, 0.5737287998199463, -0.2915658950805664, 0.04594564437866211, 0.09607529640197754, 1.3031044006347656, -0.00046539306640625, 0.25313377380371094, 0.45690393447875977, 0.3824434280395508, 0.6976032257080078, -3.8224096298217773, -1.5007476806640625, 0.35979175567626953, -0.09473037719726562, 0.4547004699707031, -0.22565460205078125, 0.36121368408203125, -0.549839973449707, -0.6715002059936523, 0.5111980438232422, 0.37589263916015625, -0.04081153869628906, 0.16085243225097656, 0.5496025085449219, 0.47094154357910156, 0.7380983829498291, -4.429803848266602, -0.42914390563964844, -1.2722530364990234, 0.02512502670288086, 1.3823537826538086, 0.8553590774536133, -0.5785236358642578, -0.5065784454345703, 0.1492595672607422, 0.6899900436401367, -0.809234619140625, 0.9704608917236328, -0.7852230072021484, -0.7105827331542969, 0.2674903869628906, 0.39011287689208984, -3.273797035217285, 0.12041366100311279, 0.04877281188964844, -0.11116409301757812, 0.2896287441253662, 0.3553199768066406, -0.4926414489746094, 1.0521955490112305, -0.43433380126953125, -1.0363941192626953, -0.5732269287109375, -3.3539371490478516, -0.5290203094482422, 0.7587413787841797, -0.2927112579345703, 0.4083437919616699, 0.3907470703125, -0.492034912109375, 0.8382720947265625, -0.7105007171630859, -9.568458557128906, -1.520559310913086, 0.8872413635253906, -2.574220657348633, -3.5817222595214844, 0.8673038482666016, 0.26443910598754883, 1.1755447387695312, -1.2801456451416016, -0.34866905212402344, -0.07915115356445312, -0.7817683219909668, 0.597395658493042, 1.5542144775390625, 0.5156087875366211, 0.7777707576751709, -0.6561260223388672, 0.5264167785644531, -1.5153541564941406, -0.44252967834472656, -0.007052421569824219, -0.4747467041015625, -1.1319046020507812, 0.17545795440673828, -0.5941529273986816, -1.255941390991211, -0.0849754810333252, -0.6165332794189453, 0.17137908935546875, 0.23236083984375, 0.29740869998931885], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 82944, "num_env_steps_trained": 307440, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 307440, "last_target_update_ts": 82944, "num_target_updates": 161}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -390.8525847867131, "episode_reward_mean": -47.51889223650098, "episode_len_mean": 233.39, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325], "episode_lengths": [184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5480115886342767, "mean_inference_ms": 24.079641434214523, "mean_action_processing_ms": 0.1332810585894489, "mean_env_wait_ms": 4.299317772339001, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -390.8525847867131, "episode_reward_mean": -47.51889223650098, "episode_len_mean": 233.39, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.900000095367432, 10.207755498588085, 17.513219960033894, 5.100000165402889, -8.090607576072216, 12.095266006886959, 16.821270905435085, 12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325], "episode_lengths": [184, 213, 209, 205, 240, 205, 222, 215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5480115886342767, "mean_inference_ms": 24.079641434214523, "mean_action_processing_ms": 0.1332810585894489, "mean_env_wait_ms": 4.299317772339001, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 307440, "num_env_steps_sampled": 82944, "num_env_steps_trained": 307440, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 82944, "agent_timesteps_total": 82944, "timers": {"training_iteration_time_ms": 347.441, "learn_time_ms": 81.668, "learn_throughput": 2938.723, "synch_weights_time_ms": 19.988}, "counters": {"num_env_steps_sampled": 82944, "num_env_steps_trained": 307440, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 307440, "last_target_update_ts": 82944, "num_target_updates": 161}, "done": false, "episodes_total": 302, "training_iteration": 81, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-25-07", "timestamp": 1655501107, "time_this_iter_s": 5.465332269668579, "time_total_s": 438.23727679252625, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 438.23727679252625, "timesteps_since_restore": 0, "iterations_since_restore": 81, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.6375, "ram_util_percent": 65.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -11.597660064697266, "min_q": -91.07176971435547, "max_q": 28.843713760375977, "mean_td_error": -0.6695619225502014}, "td_error": [-2.1074485778808594, -0.32546234130859375, -1.7313861846923828, -0.3078269958496094, 1.1674880981445312, -0.01712965965270996, 0.9857978820800781, 0.30175602436065674, -0.10488128662109375, -0.9135770797729492, -0.48245811462402344, -0.16167259216308594, -0.6438865661621094, -0.4081611633300781, -1.1134939193725586, 0.4185943603515625, 0.1281418800354004, 0.4367532730102539, 0.6826827526092529, -0.7815628051757812, -0.4291648864746094, -0.09053826332092285, -0.16825199127197266, -0.2169055938720703, -0.5216941833496094, 0.015241622924804688, 0.03746318817138672, -0.2926483154296875, -0.6949920654296875, -5.540554046630859, -0.2407851219177246, -0.42522621154785156, -0.7105579376220703, 3.5268516540527344, -1.5781278610229492, -0.8505725860595703, -0.48902428150177, -0.39963722229003906, -0.17121124267578125, -0.1169469952583313, -1.390294075012207, 0.03674602508544922, 3.2546539306640625, -0.7764291763305664, -0.4428136348724365, -2.397838592529297, 1.1405229568481445, -2.3161678314208984, -1.441244125366211, 0.14623451232910156, -0.13489365577697754, -0.7787964344024658, -0.3701744079589844, -0.10721731185913086, -4.151512145996094, -1.155670166015625, 0.6636543273925781, -0.4680595397949219, -2.0369720458984375, -2.046234130859375, -0.3099250793457031, 0.22865867614746094, -0.06212615966796875, -2.658336639404297, 0.06130790710449219, 0.26581907272338867, 1.7244226932525635, 0.2738780975341797, -2.0621509552001953, -8.111661911010742, 0.7426824569702148, -0.647613525390625, -0.9579067230224609, -0.7638664245605469, -0.7642602920532227, -2.5722198486328125, -1.5799789428710938, -1.3355770111083984, 0.3014640808105469, -0.14228177070617676, -0.22676777839660645, -2.674509048461914, -0.28675079345703125, 0.48860645294189453, 0.6576156616210938, -0.4113025665283203, 0.0033368468284606934, -0.6614351272583008, -0.6286859512329102, -1.923105239868164, -0.7035179138183594, -0.551177978515625, -0.48433971405029297, -0.8798055648803711, 0.32474517822265625, -0.11290740966796875, 0.02885913848876953, -3.4227237701416016, 0.005767822265625, -0.6469345092773438, -0.5604572296142578, 0.15261077880859375, -0.09694290161132812, 0.1575946807861328, -0.9770870208740234, -1.135040283203125, 0.1365795135498047, -0.09694290161132812, -1.6651153564453125, -0.06663990020751953, 0.9658546447753906, -1.510087490081787, 0.10946464538574219, 1.2180366516113281, 0.5018024444580078, -0.5488739013671875, -1.0377731323242188, -3.110574722290039, -7.6064348220825195, -1.2773208618164062, 1.3877067565917969, -1.1854214668273926, 0.0034618377685546875, -2.0409183502197266, -0.21326065063476562, 0.3008460998535156, 3.201976776123047, -0.8364086151123047, -0.6482391357421875, -0.7512855529785156, -1.2191591262817383, -0.5665068626403809, -0.2243518829345703, -0.946245551109314, -0.9076023101806641, -1.0124101638793945, -1.3251066207885742, -1.0395753383636475, -0.606661319732666, 1.0277652740478516, -0.0036411285400390625, 0.6638374328613281, -0.09095335006713867, 0.6195831298828125, -1.0222759246826172, -2.318209648132324, 0.12297439575195312, -0.028635025024414062, -0.011266469955444336, -0.4515981674194336, -2.8037476539611816, -0.20605707168579102, -1.131678581237793, -1.9690351486206055, -0.3509955406188965, 0.4655914306640625, -6.648088455200195, 1.1332874298095703, -0.09571456909179688, 0.9750766754150391, -0.035465240478515625, -1.3481273651123047, -0.110748291015625, -0.27764892578125, -0.355224609375, -0.9214591979980469, 7.371494293212891, -0.9641151428222656, 0.9763851165771484, -0.17174911499023438, -0.3943772315979004, -0.6000175476074219, 4.673747539520264, -0.11518192291259766, 0.07085990905761719, -0.0540766716003418, -0.10027694702148438, -0.019346237182617188, -3.4632339477539062, -0.2711191177368164, -0.11920642852783203, 0.5501893758773804, 0.7282199859619141, 0.47710227966308594, -1.5311622619628906, -0.8057303428649902, 0.08749008178710938, -0.27786827087402344, -0.6347160339355469, -0.0886225700378418, 0.22881102561950684, -4.272126197814941, -0.3452949523925781, -0.13580620288848877, -0.2711496353149414, -0.3052177429199219, -0.7351894378662109, -1.990147590637207, -0.2238316535949707, -0.1140437126159668, -0.8700103759765625, -0.830263614654541, -0.8403110504150391, 0.385711669921875, -0.388031005859375, -0.2744407653808594, 0.8215131759643555, -1.4702949523925781, 0.6670417785644531, -1.0896720886230469, 0.17843341827392578, -4.398155212402344, -0.621762752532959, -2.2349624633789062, 0.6826827526092529, 0.609717845916748, 0.07707226276397705, -0.47081756591796875, -0.7994556427001953, -0.34135961532592773, -0.7069568634033203, 0.8215131759643555, -0.9053897857666016, -32.974369049072266, 0.5430564880371094, -1.0439815521240234, -0.20543241500854492, -0.21759414672851562, -0.14025497436523438, -6.928764343261719, -1.1288566589355469, -0.3447742462158203, 0.32602405548095703, -0.748016357421875, -0.5455026626586914, -1.923105239868164, -1.1749591827392578, 0.1702723503112793, 0.4369068145751953, -0.12679147720336914], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 83968, "num_env_steps_trained": 311280, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 311280, "last_target_update_ts": 83968, "num_target_updates": 163}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -55.11474833838642, "episode_len_mean": 236.03, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925], "episode_lengths": [215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5492523416838135, "mean_inference_ms": 24.084425597296693, "mean_action_processing_ms": 0.13306037469239723, "mean_env_wait_ms": 4.306909580170065, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -55.11474833838642, "episode_len_mean": 236.03, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.764785967767239, -390.8525847867131, 18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925], "episode_lengths": [215, 328, 200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5492523416838135, "mean_inference_ms": 24.084425597296693, "mean_action_processing_ms": 0.13306037469239723, "mean_env_wait_ms": 4.306909580170065, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 311280, "num_env_steps_sampled": 83968, "num_env_steps_trained": 311280, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 83968, "agent_timesteps_total": 83968, "timers": {"training_iteration_time_ms": 362.176, "learn_time_ms": 82.386, "learn_throughput": 2913.133, "synch_weights_time_ms": 20.607}, "counters": {"num_env_steps_sampled": 83968, "num_env_steps_trained": 311280, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 311280, "last_target_update_ts": 83968, "num_target_updates": 163}, "done": false, "episodes_total": 309, "training_iteration": 82, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-25-13", "timestamp": 1655501113, "time_this_iter_s": 5.8767125606536865, "time_total_s": 444.11398935317993, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 444.11398935317993, "timesteps_since_restore": 0, "iterations_since_restore": 82, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 26.08888888888889, "ram_util_percent": 65.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -11.878952980041504, "min_q": -90.853271484375, "max_q": 27.12213706970215, "mean_td_error": -1.2546221017837524}, "td_error": [-0.1811809539794922, -0.8440208435058594, -0.645648717880249, 0.32259368896484375, -0.1775188446044922, -0.6055268049240112, -0.2671823501586914, -0.39495277404785156, -0.09669876098632812, 0.16302728652954102, -2.9108924865722656, -0.8665657043457031, -0.8171725273132324, -0.746105432510376, -0.7133078575134277, -6.460687160491943, -0.18424057960510254, -2.144939422607422, -0.4654102325439453, -0.9950079917907715, -0.6495925188064575, -2.9111328125, -0.4703102111816406, -1.5991945266723633, -2.16748046875, 1.8176746368408203, -1.7606983184814453, -0.2464313507080078, -0.08919048309326172, 0.690460205078125, 0.7189350128173828, -1.0783157348632812, 0.05184173583984375, -0.45808011293411255, -0.09096431732177734, -1.7032208442687988, -0.1820087432861328, -0.9744358062744141, 0.8900556564331055, 0.7979537844657898, 0.1131134033203125, -0.4081077575683594, -7.1471710205078125, -0.9784431457519531, -0.07695865631103516, -1.1288604736328125, -13.517923355102539, -0.9460735321044922, -0.9447345733642578, -0.9743032455444336, 0.33307933807373047, -1.8673229217529297, -0.24445819854736328, 0.680908203125, -5.367125034332275, -0.5856285095214844, 0.6334762573242188, 0.05248570442199707, -0.6675043106079102, -0.25655364990234375, 0.2575017213821411, -2.215930938720703, -0.17132949829101562, -0.17935943603515625, -1.1911325454711914, 0.8029060363769531, -0.5617599487304688, 0.332489013671875, -0.8072221279144287, -6.444126605987549, -0.1323375701904297, -0.41338062286376953, -0.3898129463195801, 0.4442634582519531, -0.5157461166381836, -16.04034996032715, -0.47890281677246094, -2.2471585273742676, -0.8803806304931641, 0.0728597640991211, 0.9429855346679688, -1.1424903869628906, -0.036510169506073, -1.132863998413086, -0.11806488037109375, -0.3182239532470703, 0.07269525527954102, -1.5376558303833008, -0.3253464698791504, -0.7753429412841797, 6.3137359619140625, -2.2514991760253906, -2.3207383155822754, -1.3021771907806396, -0.3323402404785156, -0.9707846641540527, -0.4583132266998291, -0.3923301696777344, -1.3428840637207031, -0.644744873046875, -0.6032905578613281, -1.5713043212890625, -0.05157470703125, -2.748126983642578, -1.0370712280273438, -1.2592761516571045, 0.1117856502532959, -0.6635246276855469, -0.25405311584472656, -0.40755462646484375, -0.6602439880371094, -1.6344337463378906, -0.8782591819763184, -0.6684331893920898, -0.27341461181640625, -0.21314620971679688, -2.880270004272461, -0.24893856048583984, 0.25334930419921875, -0.5350918769836426, 0.9077358245849609, 0.0579146146774292, -0.056121826171875, 0.12236881256103516, -0.6169857978820801, -2.144939422607422, -0.19079017639160156, -0.7178058624267578, -4.119992256164551, -0.28826355934143066, -0.17987984418869019, -0.44045543670654297, -7.226120948791504, -0.7788619995117188, -2.1663589477539062, -0.3588557243347168, -0.6826254725456238, -0.5877189636230469, -0.5905181765556335, -0.7550978660583496, 0.5872516632080078, -2.0588111877441406, 0.30649566650390625, 1.2680206298828125, -1.3821144104003906, -1.0237751007080078, 0.5690484046936035, -0.0655975341796875, -1.727656364440918, 0.2725181579589844, -1.7605857849121094, -1.2881498336791992, -0.5632715225219727, -1.3950634002685547, -0.5628948211669922, -0.14962005615234375, -1.5550537109375, -0.6423952579498291, -1.3379745483398438, 0.1639575958251953, -1.6665363311767578, -2.520296096801758, 0.14651012420654297, 0.3571929931640625, -0.7957115173339844, -0.3517599105834961, -0.39632606506347656, -0.5261135101318359, -0.8482208251953125, -6.496852874755859, -0.7862179279327393, -0.10690784454345703, -0.8812837600708008, 0.5145359039306641, -0.3647146224975586, -0.31642282009124756, -0.1838207244873047, -0.2516670227050781, -1.896531105041504, -0.12882423400878906, 0.7683877944946289, -0.647881269454956, -81.33526611328125, -0.6946697235107422, -0.5028705596923828, -2.398280143737793, -0.5220489501953125, -0.9841880798339844, -1.4748153686523438, -2.5917067527770996, -2.973949432373047, -0.10390445590019226, 0.46544837951660156, -0.7666072845458984, 0.22650527954101562, -0.4805107116699219, -0.7591571807861328, -1.7857704162597656, -0.6585907936096191, -1.0255547761917114, -0.7909383773803711, -0.8994646072387695, -0.7510261535644531, 0.5486869812011719, -0.3650054931640625, -0.4687929153442383, 1.4355478286743164, -2.375638961791992, -0.5738124847412109, -0.832550048828125, -7.715995788574219, 0.18968963623046875, -1.0800647735595703, -6.135867118835449, -1.38287353515625, 0.30649566650390625, -1.327169418334961, -0.1560993194580078, -0.7008371353149414, 1.408125877380371, 0.8468914031982422, -0.8566112518310547, -0.18244552612304688, -0.31069183349609375, 0.5263481140136719, -1.968876838684082, -0.8441696166992188, 0.8122081756591797, -0.6241450309753418, -2.6698074340820312, -0.19608306884765625, -0.3376655578613281, -0.7839021682739258, -0.20591306686401367, -0.7773666381835938, -2.623208999633789, -1.7644119262695312, -0.6583728790283203, 0.022330284118652344, -1.143014907836914], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 84992, "num_env_steps_trained": 315120, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 315120, "last_target_update_ts": 84992, "num_target_updates": 165}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -55.75334146715701, "episode_len_mean": 236.3, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128], "episode_lengths": [200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5496806680476041, "mean_inference_ms": 24.08924923827211, "mean_action_processing_ms": 0.13313055930118148, "mean_env_wait_ms": 4.309504737163908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -55.75334146715701, "episode_len_mean": 236.3, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.915592670440674, -12.020020604133606, 9.41063542664051, -103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128], "episode_lengths": [200, 235, 209, 272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5496806680476041, "mean_inference_ms": 24.08924923827211, "mean_action_processing_ms": 0.13313055930118148, "mean_env_wait_ms": 4.309504737163908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 315120, "num_env_steps_sampled": 84992, "num_env_steps_trained": 315120, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 84992, "agent_timesteps_total": 84992, "timers": {"training_iteration_time_ms": 342.243, "learn_time_ms": 81.868, "learn_throughput": 2931.564, "synch_weights_time_ms": 20.389}, "counters": {"num_env_steps_sampled": 84992, "num_env_steps_trained": 315120, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 315120, "last_target_update_ts": 84992, "num_target_updates": 165}, "done": false, "episodes_total": 311, "training_iteration": 83, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-25-18", "timestamp": 1655501118, "time_this_iter_s": 5.381023168563843, "time_total_s": 449.4950125217438, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 449.4950125217438, "timesteps_since_restore": 0, "iterations_since_restore": 83, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.55, "ram_util_percent": 65.73750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.927730560302734, "min_q": -91.5025634765625, "max_q": 31.172889709472656, "mean_td_error": -0.5387194752693176}, "td_error": [-0.33763980865478516, -0.24520564079284668, -0.3388388156890869, -6.077863693237305, 1.160140037536621, -0.007368803024291992, 0.2786698341369629, 0.6685752868652344, -0.27988624572753906, -6.240087509155273, -0.26680195331573486, 0.35083580017089844, -23.463695526123047, -0.20582342147827148, 0.042064666748046875, -0.7274646759033203, -0.7814950942993164, 0.2478790283203125, -3.8565077781677246, -0.6159381866455078, -0.61224365234375, 0.25876402854919434, -0.04381370544433594, 0.38667869567871094, -6.466899871826172, -5.923648834228516, -0.19115757942199707, 3.20701265335083, -2.8754043579101562, 0.32976818084716797, -0.7998857498168945, -0.4707450866699219, 0.41973876953125, -0.15183448791503906, -0.3224906921386719, -2.1141529083251953, -0.32744598388671875, -0.5539350509643555, 0.6391324996948242, -17.882308959960938, -0.8405463695526123, -0.5159683227539062, -2.1320128440856934, -0.35233914852142334, -0.18831944465637207, 1.0167694091796875, 0.030999183654785156, -1.3012590408325195, 1.0610980987548828, 0.45587158203125, -5.91657829284668, -0.49114346504211426, -0.5737228393554688, 0.2645973861217499, -22.332677841186523, 0.4240255355834961, -4.900484085083008, -0.49285560846328735, 0.7439517974853516, -0.008963584899902344, -0.6729410290718079, -0.514561653137207, 1.011843204498291, 0.3202962875366211, 0.16729354858398438, -2.0150184631347656, -0.5351333618164062, -0.547637939453125, -0.6419687271118164, -5.177601337432861, 0.07510948181152344, -0.8494859933853149, 1.072312355041504, 0.7550239562988281, -5.192909240722656, -0.052204132080078125, 0.1682724952697754, -0.3105030059814453, -0.8602523803710938, 0.3802309036254883, 0.17519760131835938, 0.3975667953491211, -1.0918407440185547, -0.37642669677734375, -0.7941780090332031, -0.4413034915924072, -0.42564964294433594, 1.6396675109863281, -0.32776570320129395, -2.690614700317383, 1.1635169982910156, 0.301699161529541, -0.7977848052978516, 0.40286827087402344, -1.2765674591064453, -0.3529834747314453, 1.8879222869873047, 0.042143821716308594, 0.24694061279296875, -1.1146602630615234, -0.051604270935058594, 1.1649856567382812, -0.48337745666503906, 1.3932037353515625, -0.1656951904296875, 0.03081512451171875, -0.05096435546875, -2.1527233123779297, -0.03872108459472656, 1.1984024047851562, 0.4681282043457031, -0.56024169921875, 0.12134742736816406, 0.5041408538818359, 0.35637569427490234, -0.09268879890441895, -0.10398006439208984, -0.4317493438720703, 8.098323822021484, -1.822300910949707, -0.2470560073852539, 0.032283782958984375, 0.24059295654296875, 0.5610675811767578, -0.7189836502075195, -0.011120796203613281, -0.8727550506591797, 0.5618686676025391, 0.37412261962890625, -0.5873708724975586, 0.3695502281188965, -0.6514227390289307, -0.040149688720703125, 0.4123210906982422, 0.8532524108886719, -0.19702911376953125, 0.41764354705810547, -2.223276138305664, 4.305427551269531, -0.4659395217895508, -0.3251638412475586, -0.4180556535720825, 0.5166845321655273, -0.6716213226318359, -0.5434412956237793, -0.053368330001831055, -1.6718497276306152, -0.1814417839050293, -1.6724090576171875, -0.22272300720214844, -0.05591297149658203, 0.389678955078125, -1.1520576477050781, -0.47424888610839844, 0.24573135375976562, -0.30540037155151367, 1.0165843963623047, -0.5003094673156738, 0.5101356506347656, 1.106004238128662, 0.09039878845214844, -0.06829833984375, 0.056952834129333496, 1.8397254943847656, -0.7798597812652588, 0.0868082046508789, -0.5349817276000977, -0.0496368408203125, 0.09020233154296875, 0.7187128067016602, -1.2748873233795166, -0.7207565307617188, 3.0012731552124023, -0.3071146011352539, 0.16599225997924805, 1.3646316528320312, -0.4613380432128906, -0.17491674423217773, 13.338480949401855, -0.2582206726074219, -0.8760566711425781, 0.6350202560424805, -0.3784370422363281, -0.001956939697265625, -0.3207482099533081, 0.3021821975708008, -0.2323819398880005, -4.8037567138671875, -0.4498405456542969, 0.9955462217330933, -0.5392036437988281, -0.5826387405395508, -14.898380279541016, 3.256988525390625, -4.574934005737305, -0.013886451721191406, 1.0976181030273438, 0.27335357666015625, 0.6354319453239441, 1.2448501586914062, -0.059223175048828125, 0.6449518203735352, 1.2217597961425781, -0.6566859483718872, 0.1065835952758789, -1.4691276550292969, 0.2839181423187256, 0.9439001083374023, -0.5217456817626953, 0.2831258773803711, -3.3746509552001953, 1.1248016357421875, -0.1608753204345703, 1.8185882568359375, 0.42591381072998047, 1.4899170398712158, 1.4882640838623047, -0.02095508575439453, -0.22198963165283203, -0.889617919921875, -0.35233914852142334, -0.7405529022216797, 0.20935297012329102, 0.6789426803588867, -1.4837207794189453, -1.2334718704223633, -0.41095495223999023, 0.11686325073242188, -1.8757915496826172, 0.4151802062988281, 0.2523069381713867, -0.5352725982666016, -0.7184858322143555, -0.23422718048095703, -0.2936210632324219, -0.23264503479003906, 0.25043487548828125, 0.07404708862304688, -0.9576473236083984, 0.4915904998779297], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 86016, "num_env_steps_trained": 318960, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 318960, "last_target_update_ts": 86016, "num_target_updates": 167}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -56.299126558974386, "episode_len_mean": 236.68, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394], "episode_lengths": [272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5504207556277028, "mean_inference_ms": 24.087675573728784, "mean_action_processing_ms": 0.13332795833436037, "mean_env_wait_ms": 4.311223276321652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -56.299126558974386, "episode_len_mean": 236.68, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-103.67078354209661, 17.519292660057545, 6.700000144541264, -62.185391902923584, 12.021023489534855, 14.622492872178555, -32.55611930042505, -60.645184464752674, -109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394], "episode_lengths": [272, 235, 218, 237, 224, 191, 232, 267, 256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5504207556277028, "mean_inference_ms": 24.087675573728784, "mean_action_processing_ms": 0.13332795833436037, "mean_env_wait_ms": 4.311223276321652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 318960, "num_env_steps_sampled": 86016, "num_env_steps_trained": 318960, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 86016, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 362.127, "learn_time_ms": 82.06, "learn_throughput": 2924.675, "synch_weights_time_ms": 20.088}, "counters": {"num_env_steps_sampled": 86016, "num_env_steps_trained": 318960, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 318960, "last_target_update_ts": 86016, "num_target_updates": 167}, "done": false, "episodes_total": 314, "training_iteration": 84, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-25-24", "timestamp": 1655501124, "time_this_iter_s": 5.656200885772705, "time_total_s": 455.1512134075165, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 455.1512134075165, "timesteps_since_restore": 0, "iterations_since_restore": 84, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.150000000000002, "ram_util_percent": 65.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.663549423217773, "min_q": -66.02073669433594, "max_q": 30.811901092529297, "mean_td_error": -0.8653601408004761}, "td_error": [0.95208740234375, -0.6595916748046875, 1.0025081634521484, 0.1152346134185791, -1.8637166023254395, -1.0368709564208984, -0.4017603397369385, -0.26682281494140625, -1.197484016418457, -1.5182056427001953, 0.185150146484375, -0.6607866287231445, -0.8314037322998047, -0.12178373336791992, 0.30179452896118164, 0.5624122619628906, -0.25058555603027344, -0.05432438850402832, -0.40284061431884766, 0.26146364212036133, 0.5042266845703125, 0.03902626037597656, -1.4343814849853516, -0.22589969635009766, -0.3299827575683594, -1.1322765350341797, -1.4581546783447266, -0.2727842330932617, 0.41789817810058594, -0.011663436889648438, -0.3085024952888489, -0.7247714996337891, -1.0308704376220703, 0.1280651092529297, 0.2110595703125, -0.7373390197753906, -0.08821868896484375, 0.5124289989471436, -0.14744335412979126, 0.02041923999786377, 0.09926795959472656, 3.296905040740967, -0.646148681640625, -0.6613483428955078, 2.670093536376953, -0.0547637939453125, -1.5277729034423828, 0.07476997375488281, -1.0782461166381836, -0.6670131683349609, -0.10038924217224121, 0.10696324706077576, 0.3307204246520996, -0.26509952545166016, 0.052982330322265625, -0.09021282196044922, -0.6919441223144531, -5.851369857788086, -0.7709178924560547, -1.2280206680297852, 0.013147830963134766, -0.7080326080322266, -0.6271724700927734, -0.36200714111328125, -0.16469907760620117, -0.18048095703125, -0.5620098114013672, -0.9124565124511719, 0.24668121337890625, -0.30306386947631836, -0.60345458984375, -0.7411460876464844, -2.6274871826171875, -0.19630146026611328, -2.0772857666015625, -0.4540395736694336, -0.9626836776733398, -1.7860984802246094, -7.808522701263428, -29.895334243774414, -1.0260088443756104, -1.3878612518310547, -0.1952797770500183, 0.4263935387134552, -0.5133886337280273, -0.8534374237060547, -0.9339637756347656, -0.39606475830078125, -0.6791725158691406, -1.333547592163086, 0.1202237606048584, -0.8520355224609375, -0.3629741668701172, -1.0692625045776367, -0.7557376623153687, -0.07979416847229004, -0.020654678344726562, -0.4450874328613281, -0.6403713226318359, -0.7175369262695312, -1.543914794921875, -0.09675407409667969, -1.2160630226135254, -1.5139250755310059, -10.219308853149414, 0.160675048828125, -2.7605514526367188, -0.7915382385253906, -0.9146828651428223, -1.0276594161987305, 0.31159543991088867, 0.2501411437988281, 0.13026857376098633, -0.4982109069824219, -0.49160003662109375, -1.2091178894042969, -0.08145332336425781, -0.47875308990478516, 0.05322837829589844, -0.46946191787719727, -10.239831924438477, -0.5568370819091797, 0.37772560119628906, -1.0114412307739258, -10.002579689025879, -0.4457361698150635, -0.16902542114257812, -0.5328748226165771, 0.7456378936767578, -0.4307079315185547, 0.03539848327636719, -1.7094841003417969, -0.6034870147705078, -1.5584259033203125, -0.5709095001220703, -5.202191352844238, 0.4156780242919922, -1.3948535919189453, -1.7038002014160156, 0.009771347045898438, -0.06314468383789062, -0.07259559631347656, 0.2149505615234375, -0.8518753051757812, -0.5865373611450195, -0.8274269104003906, -0.6108226776123047, 11.577618598937988, -0.34892988204956055, -0.34368324279785156, -3.3817195892333984, -0.8999729156494141, -0.7827472686767578, 0.28906822204589844, -0.3097200393676758, 0.7696075439453125, -0.0826416015625, -0.6265888214111328, 0.8713855743408203, -1.33868408203125, -6.16302490234375, -0.4093661308288574, 0.125579833984375, -2.5172243118286133, -1.5114164352416992, -0.23851990699768066, 0.04565715789794922, -0.02756786346435547, 0.5921564102172852, -0.6584510803222656, -0.16337203979492188, -1.783238410949707, -1.7398204803466797, -3.440643310546875, 0.08071780204772949, -0.8158817291259766, -2.388010025024414, -0.408477783203125, -12.01477336883545, -0.16730785369873047, -0.7083587646484375, -0.7131996154785156, -0.8256816864013672, -0.27868080139160156, -0.3708076477050781, -0.4370441436767578, 0.05142021179199219, 0.2420949935913086, -0.509857177734375, -1.69244384765625, -0.08114814758300781, -1.0580034255981445, -0.455780029296875, -0.9336662292480469, -0.19928359985351562, -1.4687347412109375, -0.22751212120056152, -0.3310971260070801, -0.912696361541748, -0.4986705780029297, -0.9671077728271484, 0.8206100463867188, -1.5570049285888672, -0.60345458984375, 0.05389118194580078, 0.7185039520263672, -5.6523027420043945, 0.30659055709838867, -0.6343307495117188, -7.830965042114258, -0.8894567489624023, -0.324343204498291, -0.6229972839355469, -0.6471366882324219, 0.37772560119628906, -0.9135799407958984, -2.3021068572998047, -0.17919039726257324, -1.637746810913086, 1.2205581665039062, 0.08075344562530518, -2.057415008544922, -1.0614690780639648, 0.020818233489990234, 0.175262451171875, -1.8936233520507812, -0.3689742088317871, -0.26563072204589844, -0.03344535827636719, -0.14158058166503906, -0.15534210205078125, -0.09643220901489258, 5.92907190322876, 0.4744243621826172, -2.1365737915039062, -1.6385669708251953, -0.6330528259277344, 1.287649154663086, -3.0199737548828125, -0.13257837295532227], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 87040, "num_env_steps_trained": 322800, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 322800, "last_target_update_ts": 87040, "num_target_updates": 169}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -58.78786507517099, "episode_len_mean": 237.32, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433], "episode_lengths": [256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5509957788461604, "mean_inference_ms": 24.083543485643915, "mean_action_processing_ms": 0.13318122648244698, "mean_env_wait_ms": 4.3118717892288165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -58.78786507517099, "episode_len_mean": 237.32, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.02786175906658, 8.400902710855007, -100.13183457404375, -187.13610269129276, -5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433], "episode_lengths": [256, 186, 261, 273, 209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5509957788461604, "mean_inference_ms": 24.083543485643915, "mean_action_processing_ms": 0.13318122648244698, "mean_env_wait_ms": 4.3118717892288165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 322800, "num_env_steps_sampled": 87040, "num_env_steps_trained": 322800, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 87040, "agent_timesteps_total": 87040, "timers": {"training_iteration_time_ms": 366.204, "learn_time_ms": 81.741, "learn_throughput": 2936.097, "synch_weights_time_ms": 20.389}, "counters": {"num_env_steps_sampled": 87040, "num_env_steps_trained": 322800, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 322800, "last_target_update_ts": 87040, "num_target_updates": 169}, "done": false, "episodes_total": 322, "training_iteration": 85, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-25-30", "timestamp": 1655501130, "time_this_iter_s": 5.836168527603149, "time_total_s": 460.98738193511963, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 460.98738193511963, "timesteps_since_restore": 0, "iterations_since_restore": 85, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.2125, "ram_util_percent": 65.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -11.386517524719238, "min_q": -92.47164916992188, "max_q": 33.48470687866211, "mean_td_error": -0.6572498083114624}, "td_error": [-1.0774869918823242, 0.7934837341308594, -0.3556389808654785, -0.7580966949462891, -2.1500120162963867, -0.7752408981323242, -0.6014022827148438, -0.008015275001525879, -0.37737488746643066, -0.19466209411621094, 0.20495319366455078, 0.7534933090209961, -0.7110109329223633, -0.34050846099853516, -6.272909641265869, 0.7144393920898438, -0.5450897216796875, 0.31649017333984375, 0.33609962463378906, -0.5886554718017578, 0.8244705200195312, 0.01923370361328125, -1.3182754516601562, 0.558772087097168, 0.6960391998291016, -0.12537384033203125, -0.5975093841552734, -4.637387275695801, 0.1336665153503418, -7.574329376220703, -0.7782402038574219, -0.29523277282714844, -0.24729371070861816, 0.6494636535644531, 1.3291873931884766, -0.21576309204101562, 0.42905235290527344, -0.1279754638671875, 0.20948410034179688, 1.1041905879974365, 0.059539794921875, -0.65545654296875, 1.553781509399414, -0.9699515104293823, 0.3808631896972656, -2.0417022705078125, 0.6987934112548828, -0.6793670654296875, -12.048377990722656, -0.08672904968261719, -1.1230416297912598, -0.9334201812744141, 0.7307281494140625, 0.6757278442382812, -0.6465740203857422, 0.6634533405303955, -0.39365386962890625, 0.3347635269165039, -1.1126060485839844, -1.7368278503417969, -0.0025310516357421875, 0.31780052185058594, -0.8233270645141602, -0.03325843811035156, -0.535942554473877, -1.3264217376708984, 0.4560556411743164, 1.465850830078125, -0.6667289733886719, 0.43135547637939453, -5.377662658691406, -0.4543226957321167, 0.29158973693847656, 0.30243873596191406, 0.16716861724853516, -0.0471646785736084, -0.2723766565322876, 0.12526226043701172, 0.5748825073242188, -0.24397945404052734, -1.5740509033203125, -0.20163726806640625, -0.2773616313934326, -0.6044502258300781, 0.036106109619140625, -0.8597736358642578, -0.5393638610839844, -0.4309978485107422, -0.12828972935676575, 0.11904144287109375, 1.1320042610168457, -0.47736918926239014, -0.030164718627929688, 0.13321137428283691, 0.21926021575927734, 0.6757278442382812, 0.8643093109130859, -0.3901042938232422, 2.5949268341064453, 0.8372507095336914, 0.172027587890625, -1.739269495010376, -1.1792011260986328, -1.157792568206787, 0.5497398376464844, 0.41396522521972656, -1.453810691833496, -0.26662683486938477, 4.195934772491455, 1.0042781829833984, -0.09609222412109375, -4.844142913818359, 0.2038278579711914, 0.35529136657714844, 1.3839073181152344, -0.2473125457763672, 1.098785400390625, 0.23819351196289062, -17.362102508544922, 0.05629730224609375, 0.661597728729248, -0.11565256118774414, 0.5074968338012695, 1.2561531066894531, 0.22952032089233398, 0.1728363037109375, -0.4028654098510742, -0.6028299331665039, -0.8343505859375, 0.2454547882080078, 0.467132568359375, -0.2993125915527344, 1.0042781829833984, -0.31468963623046875, 0.20188450813293457, 0.3153800964355469, 1.7514724731445312, -0.4886283874511719, 0.3546886444091797, -0.9191570281982422, 1.8906021118164062, 0.2024211883544922, 0.11904144287109375, -0.6749191284179688, -0.37343597412109375, -0.021951913833618164, 0.5191537141799927, -0.4346504211425781, 0.8512048721313477, -1.1367149353027344, -0.4080486297607422, -2.9435958862304688, -0.54789137840271, -0.5671629905700684, -0.08501338958740234, -11.105303764343262, -6.193662643432617, 0.40070343017578125, 0.7254390716552734, 0.7738533020019531, -0.10162830352783203, 0.12339019775390625, -0.1143120527267456, -1.685506820678711, -1.5449028015136719, 0.0057735443115234375, -0.5819294452667236, 2.6878662109375, 0.33701038360595703, -0.08483028411865234, -5.849414825439453, -2.9438819885253906, 0.6602363586425781, -6.5082855224609375, 0.10082340240478516, 0.40070343017578125, -0.7508144378662109, -0.07572364807128906, 1.3862133026123047, 1.8214607238769531, -0.10722541809082031, -0.43560338020324707, -1.0772533416748047, -9.977930068969727, -0.3530235290527344, -7.729457855224609, -0.42223358154296875, 0.36116790771484375, -1.2453269958496094, -0.8092012405395508, 0.9172365665435791, -1.020721435546875, -1.0518779754638672, 0.5636749267578125, -1.1552734375, -0.08326005935668945, 1.0797348022460938, 0.6709079742431641, -0.04425811767578125, -0.1890735626220703, -0.20283228158950806, 3.350578784942627, -0.0214080810546875, -0.36700916290283203, -2.798988103866577, -0.8242702484130859, 0.16128325462341309, -0.06218147277832031, -0.5056037902832031, 0.16759490966796875, -0.5192861557006836, 0.6630325317382812, -0.021951913833618164, 1.2175474166870117, 0.3122291564941406, -0.2754707336425781, 0.7678794860839844, -1.5979809761047363, 0.29158973693847656, -8.300129890441895, -0.6359853744506836, -1.1041326522827148, -1.244140625, -0.18119573593139648, -0.12424659729003906, -0.3327956199645996, -0.54789137840271, -0.223968505859375, -22.507274627685547, -8.385011672973633, 0.5548019409179688, -0.9415121078491211, -0.22892078757286072, 0.2998495101928711, 0.6651966571807861, -0.01140594482421875, -0.44933176040649414, -0.8399848937988281, -0.04520606994628906, -0.08698256313800812], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 88064, "num_env_steps_trained": 326640, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 326640, "last_target_update_ts": 88064, "num_target_updates": 171}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -55.093574017137286, "episode_len_mean": 236.15, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233], "episode_lengths": [209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5512424708823204, "mean_inference_ms": 24.100658118966987, "mean_action_processing_ms": 0.13311722209500979, "mean_env_wait_ms": 4.318650062883257, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -55.093574017137286, "episode_len_mean": 236.15, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.371269211173058, 6.400000020861626, -34.34754944592714, 6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233], "episode_lengths": [209, 234, 253, 190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5512424708823204, "mean_inference_ms": 24.100658118966987, "mean_action_processing_ms": 0.13311722209500979, "mean_env_wait_ms": 4.318650062883257, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 326640, "num_env_steps_sampled": 88064, "num_env_steps_trained": 326640, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 88064, "agent_timesteps_total": 88064, "timers": {"training_iteration_time_ms": 330.273, "learn_time_ms": 82.191, "learn_throughput": 2920.02, "synch_weights_time_ms": 20.389}, "counters": {"num_env_steps_sampled": 88064, "num_env_steps_trained": 326640, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 326640, "last_target_update_ts": 88064, "num_target_updates": 171}, "done": false, "episodes_total": 326, "training_iteration": 86, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-25-36", "timestamp": 1655501136, "time_this_iter_s": 5.4483582973480225, "time_total_s": 466.43574023246765, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 466.43574023246765, "timesteps_since_restore": 0, "iterations_since_restore": 86, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.737499999999997, "ram_util_percent": 65.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -10.932828903198242, "min_q": -86.44731140136719, "max_q": 24.821866989135742, "mean_td_error": -0.9693601727485657}, "td_error": [-0.5554256439208984, -4.531578063964844, 0.4487495422363281, -15.161705017089844, -1.5963819026947021, 0.1722874641418457, 0.3303467035293579, 0.19684600830078125, 0.36915016174316406, 0.1150813102722168, -11.667930603027344, -0.1773977279663086, 1.6337776184082031, -0.8275394439697266, -3.2277603149414062, -1.1205310821533203, -0.4426231384277344, -1.9091510772705078, 0.38144516944885254, -0.17637968063354492, -0.7530708312988281, -0.039447784423828125, -0.7348814010620117, -3.6619415283203125, -12.983039855957031, -1.9161183834075928, 0.19072532653808594, 0.47762441635131836, -0.10451841354370117, -1.8570842742919922, 0.9052772521972656, 0.020252704620361328, -0.0037431716918945312, 0.8754372000694275, -0.23192119598388672, 0.7563037872314453, 0.24967670440673828, 0.6526789665222168, 1.3047099113464355, -32.020111083984375, -1.8801450729370117, -5.147981643676758, -0.38525962829589844, 0.5701355338096619, -0.2910804748535156, 0.4596216678619385, -6.436495304107666, -0.03528165817260742, -0.10107564926147461, 0.515759289264679, 0.23050880432128906, -0.09351539611816406, -0.15018272399902344, 0.2714974880218506, -3.9437131881713867, 0.1640186309814453, 0.6098721027374268, 0.754183292388916, -0.38968753814697266, -1.2435684204101562, -2.142658233642578, 0.1701030731201172, 0.09882402420043945, 0.1077423095703125, 0.4993743896484375, -0.6060047149658203, -0.9026298522949219, 0.44124841690063477, -0.9203376770019531, -0.42242431640625, 0.7347869873046875, -0.6352548599243164, -0.7807627320289612, -0.12528133392333984, -0.5030075907707214, -0.8314361572265625, -1.0347900390625, -1.1009292602539062, 0.049774169921875, -0.20079755783081055, -0.6319217681884766, 0.22296810150146484, -6.92786979675293, 0.8142032623291016, 0.7649145126342773, -0.5305023193359375, -21.2139949798584, -0.2232062816619873, -0.8422517776489258, -1.2627935409545898, -0.979705810546875, 2.419304370880127, 0.7749416828155518, -1.780317783355713, -0.2181687355041504, -1.8080635070800781, -1.0466651916503906, 0.01239156723022461, -0.16958236694335938, 0.8463859558105469, -7.644308090209961, 0.26587390899658203, -0.3903694152832031, -2.9705657958984375, 1.2008914947509766, 0.14416170120239258, 0.4890880584716797, -0.6054191589355469, 0.10454940795898438, -0.6828403472900391, 0.5526063442230225, -0.31192970275878906, -0.4481353759765625, 0.15038776397705078, 0.02229464054107666, -0.09802603721618652, -0.07570171356201172, -7.393974304199219, 0.048763275146484375, 0.5481147766113281, -8.816524505615234, -0.6716785430908203, -2.379373550415039, 0.2746562957763672, -0.8903827667236328, -1.9901580810546875, 0.13493262231349945, -1.3630256652832031, -12.439863204956055, 1.1744651794433594, -0.6877212524414062, -0.01396036148071289, -0.39795589447021484, -0.08609771728515625, -1.6380805969238281, -0.811676025390625, 0.7029361724853516, -0.557518482208252, -0.2287578582763672, -0.3852663040161133, 0.2593345642089844, 0.5896115303039551, -0.3749561309814453, 0.6744537353515625, -0.18433618545532227, 0.17991256713867188, 2.409062385559082, -1.7422161102294922, 0.3413505554199219, 0.20632529258728027, -1.1154228448867798, -0.3776359558105469, 0.0556144118309021, 0.32399606704711914, -2.078357696533203, -0.11101722717285156, 0.46424102783203125, 0.0937185287475586, 11.903003692626953, 0.5173590183258057, -0.3303232192993164, 0.5106172561645508, -0.17570114135742188, -9.200881958007812, -4.564262390136719, 1.8647079467773438, -1.861724853515625, 1.0682324171066284, 0.03851318359375, -0.1705646514892578, 0.6398372650146484, 0.04503059387207031, 0.038994789123535156, 0.7230281233787537, 0.27495527267456055, 0.32970619201660156, -2.311229705810547, 0.41860389709472656, -0.26599788665771484, 1.135396957397461, -0.053450584411621094, 0.019793987274169922, -0.7110366821289062, 1.3241596221923828, -0.12904739379882812, 0.1903548240661621, 0.4503307342529297, -0.5749130249023438, 0.07199954986572266, -0.43416786193847656, -2.6327872276306152, 0.7938308715820312, 0.2774851322174072, 0.38948822021484375, -0.034918785095214844, 0.38832545280456543, 0.22472763061523438, 0.4651516079902649, -0.1705646514892578, -0.7900285720825195, -0.8501873016357422, -0.053450584411621094, 0.07477545738220215, -0.21092700958251953, -1.9012832641601562, 0.1319723129272461, 0.7847576141357422, -0.46153736114501953, -0.15323257446289062, -10.694406509399414, 0.09577798843383789, -0.9520196914672852, 0.4226694107055664, -0.2659029960632324, -4.8067474365234375, -0.19455373287200928, 1.1587562561035156, -1.1217880249023438, 0.9996099472045898, -0.7460536956787109, 0.8808221817016602, -2.260099411010742, 0.07366657257080078, -6.191950798034668, -0.049839019775390625, -0.3651409149169922, -3.278148651123047, -1.1174802780151367, -2.961284637451172, -0.02678060531616211, -0.07314109802246094, -1.2286148071289062, -2.2568607330322266, -1.0586071014404297, -0.45467090606689453, -0.31192970275878906, -1.777669906616211, 0.17318344116210938, 0.8597202301025391, -0.5912551879882812], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 89088, "num_env_steps_trained": 330480, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 330480, "last_target_update_ts": 89088, "num_target_updates": 173}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -54.52609557017684, "episode_len_mean": 235.76, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937], "episode_lengths": [190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5516359955540243, "mean_inference_ms": 24.106395575644946, "mean_action_processing_ms": 0.1333337239057013, "mean_env_wait_ms": 4.3236599545861925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -54.52609557017684, "episode_len_mean": 235.76, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.500000052154064, 6.222173012793064, -375.5228825584054, 4.20000009983778, 5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937], "episode_lengths": [190, 251, 345, 177, 204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5516359955540243, "mean_inference_ms": 24.106395575644946, "mean_action_processing_ms": 0.1333337239057013, "mean_env_wait_ms": 4.3236599545861925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 330480, "num_env_steps_sampled": 89088, "num_env_steps_trained": 330480, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 89088, "agent_timesteps_total": 89088, "timers": {"training_iteration_time_ms": 345.341, "learn_time_ms": 81.963, "learn_throughput": 2928.155, "synch_weights_time_ms": 20.385}, "counters": {"num_env_steps_sampled": 89088, "num_env_steps_trained": 330480, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 330480, "last_target_update_ts": 89088, "num_target_updates": 173}, "done": false, "episodes_total": 329, "training_iteration": 87, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-25-41", "timestamp": 1655501141, "time_this_iter_s": 5.676363706588745, "time_total_s": 472.1121039390564, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 472.1121039390564, "timesteps_since_restore": 0, "iterations_since_restore": 87, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.025, "ram_util_percent": 65.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -10.14262580871582, "min_q": -91.84867858886719, "max_q": 33.504478454589844, "mean_td_error": -0.6205832362174988}, "td_error": [-1.1567039489746094, -0.4573707580566406, 0.2542128562927246, 2.322854518890381, 0.3199806213378906, 0.09758377075195312, -0.5203485488891602, -0.07438373565673828, -1.1142444610595703, 0.26412010192871094, 0.43564572930336, -0.05297660827636719, -0.004559040069580078, -4.489017486572266, -1.1664466857910156, -0.0994100570678711, 0.29215049743652344, 0.2477560043334961, -0.2506669759750366, -0.7350711822509766, 0.3060932159423828, -0.13557910919189453, 0.211287260055542, 0.08088302612304688, 1.3402214050292969, 0.12967252731323242, 0.111480712890625, -0.5065441131591797, 1.9406242370605469, -0.6856184005737305, 0.11295843124389648, 0.5642356872558594, -0.39574146270751953, -2.1362972259521484, 0.6619665622711182, 0.15455150604248047, -0.8548340797424316, -6.2935099601745605, -0.7895870208740234, -5.305821418762207, -0.08174705505371094, 0.7314186096191406, -1.4872684478759766, 0.3115103244781494, -10.179492950439453, -0.5332841873168945, 0.2186269760131836, -0.4073445796966553, -0.0670352578163147, 0.13120651245117188, -0.8190221786499023, 0.13274002075195312, -1.5271110534667969, 1.161550521850586, -4.7383880615234375, -0.10680198669433594, -0.04926300048828125, -0.6622447967529297, -0.20629405975341797, -0.5259256362915039, -1.0359745025634766, 0.22704267501831055, -0.013228416442871094, -0.085113525390625, -0.2051677703857422, -0.32637786865234375, 0.495555579662323, 0.44199323654174805, 0.2593822479248047, -3.0732736587524414, 0.10027408599853516, -5.026556015014648, 0.5304069519042969, -0.5377864837646484, -2.4031543731689453, -0.05857133865356445, -6.312980651855469, -0.3458280563354492, 0.0025615692138671875, 0.30733299255371094, -0.19023847579956055, 0.3634922504425049, 0.16495561599731445, -0.1870708465576172, -0.9873032569885254, -0.09464061260223389, 2.2246716022491455, 0.6344044208526611, 0.02780628204345703, -0.13581562042236328, 0.5918912887573242, 0.7868070602416992, 1.2037200927734375, -0.209716796875, 0.4448509216308594, 0.796883225440979, 0.030051440000534058, -0.001239776611328125, -0.9177374839782715, 0.4986133575439453, 0.5397682189941406, 0.3837728500366211, -0.3215312957763672, -0.8261222839355469, 0.7866153717041016, -2.5199079513549805, -0.46848297119140625, 0.2656135559082031, 0.6471195220947266, -0.6179714202880859, 0.2117328643798828, -4.866178512573242, 0.5940628051757812, 0.14028644561767578, 0.05208015441894531, -0.6319427490234375, 0.05736255645751953, -0.6049251556396484, -25.244518280029297, -0.42118310928344727, -17.871883392333984, -0.12112712860107422, 1.3264493942260742, -1.2386283874511719, -1.4588360786437988, 0.264556884765625, -2.933807373046875, -0.09095573425292969, -0.12869644165039062, -0.3320307731628418, -0.2008647918701172, 0.04566764831542969, -0.4234628677368164, -0.3751096725463867, -1.3875598907470703, -1.4201736450195312, 1.4344863891601562, 0.109100341796875, -0.5673255920410156, 1.2113466262817383, 0.22005653381347656, -0.05789947509765625, 0.3977832794189453, -3.508676528930664, 1.6548042297363281, -0.1665477752685547, 1.0058631896972656, 12.860576629638672, 0.23989295959472656, -1.325876235961914, -0.00756487250328064, -0.05044364929199219, 0.39895057678222656, 0.15143918991088867, 0.8499603271484375, -0.3100090026855469, 0.08709859848022461, -5.893009185791016, -0.24364852905273438, 0.44666290283203125, 0.15591049194335938, 0.33069801330566406, 0.10516357421875, -1.4823837280273438, 0.02117919921875, -1.3669805526733398, -1.300149917602539, -1.3417243957519531, -0.8536605834960938, 0.16875648498535156, -0.3942573070526123, -0.24282777309417725, 0.897028923034668, -0.03928375244140625, 0.004284381866455078, -0.8036894798278809, 0.2881956100463867, 1.619924545288086, -1.411635398864746, -1.0166816711425781, 0.5222282409667969, 0.029949665069580078, 1.043985366821289, -0.6854629516601562, -0.44747257232666016, -5.949981689453125, -0.6127829551696777, -0.7315406799316406, -0.22974014282226562, 0.13599443435668945, -0.49071311950683594, -0.44693946838378906, 0.2841634750366211, -0.17251157760620117, -0.37286996841430664, 2.6541032791137695, -0.7614936828613281, 0.03249168395996094, 0.013813018798828125, -0.6535530090332031, -0.8177375793457031, 0.6646289825439453, -1.0945472717285156, 0.45408058166503906, -0.01761150360107422, 0.17337799072265625, -9.049324035644531, 0.18735885620117188, 1.3839607238769531, 0.09325790405273438, -1.21356201171875, -1.300149917602539, -1.3209924697875977, -0.3704948425292969, -0.1288895606994629, -0.8671207427978516, -0.29190540313720703, -0.47269248962402344, -17.871883392333984, 0.12002372741699219, 0.5427083969116211, -1.4251556396484375, -0.31754761934280396, 0.4389629364013672, -0.8537945747375488, -0.42847633361816406, 0.12781542539596558, 0.06759357452392578, -0.05281639099121094, -0.25012969970703125, -0.12209129333496094, 0.5593223571777344, -0.5836167335510254, -1.6480598449707031, -0.8238639831542969, -0.04876136779785156, -0.9219398498535156, 0.016697168350219727, -0.0901031494140625, 0.46346616744995117], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 90112, "num_env_steps_trained": 334320, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 334320, "last_target_update_ts": 90112, "num_target_updates": 175}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -50.88222825862467, "episode_len_mean": 234.45, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958], "episode_lengths": [204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5518444044553295, "mean_inference_ms": 24.116131437966825, "mean_action_processing_ms": 0.13350181192335772, "mean_env_wait_ms": 4.326713006393149, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -50.88222825862467, "episode_len_mean": 234.45, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.999999970197678, -153.46212596446276, 28.386056430637836, -188.12842401117086, -15.674756355583668, 5.599999934434891, -131.60145526379347, -34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958], "episode_lengths": [204, 310, 210, 260, 224, 228, 297, 252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5518444044553295, "mean_inference_ms": 24.116131437966825, "mean_action_processing_ms": 0.13350181192335772, "mean_env_wait_ms": 4.326713006393149, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 334320, "num_env_steps_sampled": 90112, "num_env_steps_trained": 334320, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 90112, "agent_timesteps_total": 90112, "timers": {"training_iteration_time_ms": 352.148, "learn_time_ms": 83.277, "learn_throughput": 2881.934, "synch_weights_time_ms": 20.689}, "counters": {"num_env_steps_sampled": 90112, "num_env_steps_trained": 334320, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 334320, "last_target_update_ts": 90112, "num_target_updates": 175}, "done": false, "episodes_total": 333, "training_iteration": 88, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-25-47", "timestamp": 1655501147, "time_this_iter_s": 5.839162588119507, "time_total_s": 477.9512665271759, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 477.9512665271759, "timesteps_since_restore": 0, "iterations_since_restore": 88, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.549999999999997, "ram_util_percent": 65.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -11.108898162841797, "min_q": -92.42731475830078, "max_q": 24.915550231933594, "mean_td_error": -0.6916149854660034}, "td_error": [0.136077880859375, -0.5591257810592651, -0.6433455944061279, -1.9691171646118164, -2.070535659790039, 0.3486342430114746, -0.3556220531463623, 0.41652679443359375, -0.10622119903564453, -4.431396961212158, 0.0418400764465332, 0.3803892135620117, -0.16831254959106445, 1.7576522827148438, -0.6139068603515625, -0.2635669708251953, -0.0010166168212890625, 0.9144525527954102, -0.03516197204589844, -9.924630165100098, 0.40418195724487305, 1.5420646667480469, 0.8028984069824219, 0.8483791351318359, -1.4105300903320312, 0.02135944366455078, 0.8737640380859375, 0.4919586181640625, -0.2649211883544922, 0.15013742446899414, -23.508106231689453, 3.1856565475463867, -0.1265559196472168, 0.8395347595214844, 0.48145103454589844, 0.808018684387207, 0.4041175842285156, -0.39966583251953125, -0.06241416931152344, -0.04590034484863281, -0.7543296813964844, -0.025982379913330078, 0.23096084594726562, 0.7842235565185547, 1.665191650390625, 0.7296466827392578, 1.1116790771484375, 0.0629734992980957, 1.3193321228027344, -2.5207576751708984, 0.8154926300048828, -0.2924070358276367, 0.5902853012084961, -0.7543296813964844, -0.6119282245635986, -2.3703041076660156, -0.6074858903884888, -11.991193771362305, 0.19661569595336914, 1.7511873245239258, 0.25293731689453125, -0.46097779273986816, 0.4701690673828125, 0.42064571380615234, 1.8015742301940918, -0.6870522499084473, 0.36615610122680664, -1.1180161237716675, -0.0017895698547363281, 0.31463623046875, -5.913458824157715, 1.2377204895019531, 0.5210087895393372, 1.1688556671142578, -0.36449703574180603, -0.7507753372192383, -0.08337187767028809, 0.5838913917541504, 0.08458065986633301, -0.011350154876708984, -0.564812183380127, -0.17155742645263672, -20.911365509033203, -0.17324161529541016, -0.5095863342285156, -1.0056991577148438, 0.06080818176269531, -0.03197050094604492, -0.06799077987670898, 0.7844581604003906, -22.24694061279297, 1.956939697265625, -0.6006832122802734, 0.2412700653076172, 0.18213367462158203, 1.11090087890625, 0.14017629623413086, -1.683746337890625, 0.28827667236328125, -1.5533828735351562, 0.0602107048034668, 0.25559425354003906, -38.44070816040039, 1.0581207275390625, 0.9087915420532227, 1.0522165298461914, 2.8066537380218506, -0.3435935974121094, 0.3106708526611328, 0.8697805404663086, 0.4766807556152344, -0.3397483825683594, 0.935394287109375, 0.5892846584320068, -0.04014396667480469, 1.5608806610107422, -0.29587697982788086, 1.0331544876098633, -0.5927639007568359, -0.37825536727905273, -0.5267486572265625, 0.11699295043945312, 0.49709224700927734, 1.4345531463623047, 1.7336196899414062, -0.9344253540039062, 0.47163963317871094, -0.7669312357902527, -0.5257551670074463, -0.7074694633483887, 1.4678611755371094, -0.06881332397460938, 0.16639137268066406, 1.283247947692871, 0.022219181060791016, -21.053688049316406, 0.035239219665527344, -4.79644775390625, 1.1640071868896484, -0.2953495979309082, 0.2821826934814453, -0.03732585906982422, -9.481924057006836, 0.4050922393798828, 0.6706047058105469, -0.5968475341796875, -0.4145960807800293, 0.11378335952758789, 0.45722198486328125, -0.6646775603294373, 0.39221954345703125, -0.8356835842132568, 1.2607269287109375, -2.85036563873291, -0.8823485374450684, -0.39966583251953125, 0.3683662414550781, -7.310962677001953, 0.8163628578186035, 0.33411407470703125, 0.13555049896240234, -0.1237640380859375, -0.09360122680664062, 1.6457328796386719, 0.8627090454101562, -1.7463760375976562, 0.34102916717529297, 2.014474868774414, 1.0918006896972656, 1.2900009155273438, 0.8686599731445312, -0.34439122676849365, 0.21338534355163574, -0.4520730972290039, 2.5334930419921875, 0.37870216369628906, -4.240314483642578, -0.03732585906982422, -5.469246864318848, -0.09586334228515625, -1.0272598266601562, -0.3038107752799988, 0.04666173458099365, 1.9096336364746094, 0.5816440582275391, -0.01982879638671875, 1.0685386657714844, -0.6793861389160156, -0.18085980415344238, -0.6924781799316406, 0.02274036407470703, 2.926083564758301, -2.394634246826172, 0.4432353973388672, -4.6906633377075195, 2.3676300048828125, -0.4534587860107422, 0.9411907196044922, -0.04403114318847656, -0.6102266311645508, -0.13372886180877686, 1.09033203125, -0.5474271774291992, -4.067931175231934, 0.2253131866455078, -7.893901824951172, 1.6460456848144531, -0.6427359580993652, -0.3956141471862793, -0.6312179565429688, 0.7058672904968262, 0.05758833885192871, -0.6953433752059937, -1.480924129486084, 1.9089641571044922, 0.7071256637573242, 0.8930549621582031, -0.08709049224853516, 0.044823646545410156, 1.8277473449707031, 1.1066696643829346, -8.199272155761719, 1.0083274841308594, 0.4035162925720215, -0.03558015823364258, -0.19623851776123047, 0.4849557876586914, 0.24090003967285156, 1.52337646484375, 1.4037628173828125, 2.3915185928344727, -1.8902091979980469, -0.22372817993164062, -3.394775390625, -0.08219659328460693, 0.37662696838378906, -1.4279632568359375, 1.7664260864257812, 2.9040565490722656, 3.215343475341797], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 91136, "num_env_steps_trained": 338160, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 338160, "last_target_update_ts": 91136, "num_target_updates": 177}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -47.49753673829138, "episode_len_mean": 233.44, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261], "episode_lengths": [252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525275819727892, "mean_inference_ms": 24.110694103112696, "mean_action_processing_ms": 0.13329958760703858, "mean_env_wait_ms": 4.327370980601386, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -47.49753673829138, "episode_len_mean": 233.44, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.72060613334179, -11.786780141294003, -42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261], "episode_lengths": [252, 224, 213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525275819727892, "mean_inference_ms": 24.110694103112696, "mean_action_processing_ms": 0.13329958760703858, "mean_env_wait_ms": 4.327370980601386, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 338160, "num_env_steps_sampled": 91136, "num_env_steps_trained": 338160, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 91136, "agent_timesteps_total": 91136, "timers": {"training_iteration_time_ms": 358.13, "learn_time_ms": 82.268, "learn_throughput": 2917.31, "synch_weights_time_ms": 20.089}, "counters": {"num_env_steps_sampled": 91136, "num_env_steps_trained": 338160, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 338160, "last_target_update_ts": 91136, "num_target_updates": 177}, "done": false, "episodes_total": 340, "training_iteration": 89, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-25-53", "timestamp": 1655501153, "time_this_iter_s": 5.722805738449097, "time_total_s": 483.674072265625, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 483.674072265625, "timesteps_since_restore": 0, "iterations_since_restore": 89, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.244444444444447, "ram_util_percent": 65.41111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -11.578989028930664, "min_q": -92.12678527832031, "max_q": 27.305753707885742, "mean_td_error": -0.24909280240535736}, "td_error": [0.021979331970214844, -0.30389404296875, -7.775153160095215, -1.154994010925293, -0.9352264404296875, -0.5967092514038086, -0.14562606811523438, -4.9790802001953125, 0.8111534118652344, 3.8661136627197266, -0.11152267456054688, 0.0498356819152832, 0.12617874145507812, 0.2163231372833252, 0.3002185821533203, 0.8641098141670227, 0.34380245208740234, -0.2707958221435547, 1.459075927734375, -0.12106895446777344, -0.29485511779785156, -0.7879219055175781, 0.030914306640625, 1.0373048782348633, -0.19011127948760986, -0.048099517822265625, 0.7573060989379883, 0.37322425842285156, -1.527334213256836, 1.121927261352539, -0.05215263366699219, -0.40673351287841797, -0.26001644134521484, -0.18695831298828125, 0.17168426513671875, 1.0228290557861328, -0.3733787536621094, -0.3322925567626953, -1.1604690551757812, -1.8662605285644531, 0.4348158836364746, -0.22990036010742188, -9.390937805175781, -1.0561943054199219, 0.4266233444213867, -0.47234058380126953, -0.191644549369812, -0.005661964416503906, 1.3487606048583984, -0.42719078063964844, 0.4362621307373047, -0.39908289909362793, -0.304415225982666, -0.7985706329345703, -0.5351886749267578, -0.18120098114013672, 0.42034912109375, -0.8216507434844971, -1.4680430889129639, 1.996114730834961, 0.7388519048690796, -0.5151511430740356, -2.404298782348633, 1.5136351585388184, -0.08619308471679688, -0.08786296844482422, 0.8004512786865234, -5.177520751953125, -0.6214485168457031, -0.7372312545776367, -5.435628890991211, -0.36020517349243164, 0.80517578125, -0.22409093379974365, -0.2396392822265625, 1.6107902526855469, 0.9611358642578125, -0.8294410705566406, -2.378157615661621, -0.7646369934082031, -0.5100623369216919, -0.11813783645629883, -0.0723334550857544, 2.773439407348633, -1.3271026611328125, 2.5142040252685547, -6.554842472076416, 1.448202133178711, 0.21089935302734375, 0.19502580165863037, 2.516460418701172, -0.5261995792388916, 0.7263250350952148, 0.3157939910888672, 0.8004512786865234, -1.8050813674926758, -0.199490487575531, 1.0640435218811035, -0.4047126770019531, 0.3684062957763672, -0.16181278228759766, -0.34352684020996094, 0.17644691467285156, -9.70441722869873, 0.2546844482421875, -0.5397777557373047, 2.880178451538086, -0.5277194976806641, -0.2718997001647949, 15.60666275024414, -1.1571121215820312, -1.1306238174438477, -0.3242969512939453, -2.7025794982910156, 1.4924812316894531, 0.7681503295898438, -0.846564769744873, 2.0692882537841797, 1.891047477722168, -0.16266536712646484, -0.0467529296875, 1.2415409088134766, 1.4177417755126953, 0.9561023712158203, -0.14805865287780762, -6.772867202758789, 0.7106552124023438, 0.9066658020019531, 4.231429576873779, -0.07049083709716797, -1.020975112915039, -0.018189072608947754, 0.6240886449813843, 0.9582023620605469, -0.17062950134277344, 0.30218029022216797, 0.11972618103027344, 0.2499542236328125, -0.27822160720825195, -0.008896827697753906, 0.3859577178955078, -0.025183022022247314, -0.325650691986084, -0.22393798828125, 0.3076968193054199, 1.0986833572387695, 0.7525186538696289, 0.3905916213989258, 0.5286808013916016, -0.10683441162109375, -0.04202079772949219, -1.0333671569824219, -0.34769487380981445, 0.7626018524169922, -0.3647465705871582, -0.0323486328125, -0.047695159912109375, -0.4680814743041992, -0.5165624618530273, 0.2721214294433594, -0.45297062397003174, -2.39866304397583, -0.26717567443847656, -0.163665771484375, -0.46611690521240234, -0.4801863729953766, -3.7180044651031494, -0.48050880432128906, 0.7407779693603516, 0.659916877746582, -12.837043762207031, -0.5148143768310547, 1.4748878479003906, 0.05425834655761719, -0.6869888305664062, 1.2393264770507812, -0.6832714080810547, -0.6904010772705078, 1.3409414291381836, -0.42730116844177246, -0.3311777114868164, -0.4871562719345093, 0.14687347412109375, 1.6789112091064453, -0.3708648681640625, -0.8527050018310547, 0.20641613006591797, -0.49704158306121826, 1.891998291015625, -0.16181278228759766, -0.4193000793457031, 0.217474102973938, -1.2507648468017578, 0.08983087539672852, 1.0845212936401367, -19.490406036376953, -0.36081552505493164, 0.6198005676269531, -0.028276950120925903, 0.08407402038574219, 0.2546844482421875, 1.67254638671875, -0.47074317932128906, 0.37213134765625, -0.024379730224609375, 1.2161140441894531, -0.48923587799072266, -0.32869958877563477, -0.6196211576461792, 0.8714923858642578, -2.380035400390625, -0.31624841690063477, 1.2500553131103516, 0.08795326948165894, -0.20027828216552734, -0.2546558380126953, 0.2666740417480469, 0.9117870330810547, 0.15246474742889404, 0.7802639007568359, 0.3619176745414734, 0.2049427032470703, 0.25220489501953125, 0.12659549713134766, -0.023593902587890625, 1.891998291015625, 0.47358226776123047, 0.14667510986328125, -0.057392120361328125, -0.02881336212158203, -0.66717529296875, -6.386758804321289, 0.5296535491943359, 1.8108634948730469, 0.579871654510498, -0.5413665771484375, 0.10648679733276367, -0.5418510437011719, -0.9092944860458374, 0.25241148471832275], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 92160, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 342000, "last_target_update_ts": 92160, "num_target_updates": 179}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -47.57906436011195, "episode_len_mean": 233.54, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158], "episode_lengths": [213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531401481840558, "mean_inference_ms": 24.107638098913732, "mean_action_processing_ms": 0.13333018870303845, "mean_env_wait_ms": 4.327881321663303, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -47.57906436011195, "episode_len_mean": 233.54, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-42.389364533126354, -141.7257042452693, -48.38539168983698, 6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158], "episode_lengths": [213, 251, 235, 188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531401481840558, "mean_inference_ms": 24.107638098913732, "mean_action_processing_ms": 0.13333018870303845, "mean_env_wait_ms": 4.327881321663303, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 342000, "num_env_steps_sampled": 92160, "num_env_steps_trained": 342000, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 92160, "agent_timesteps_total": 92160, "timers": {"training_iteration_time_ms": 343.584, "learn_time_ms": 83.409, "learn_throughput": 2877.389, "synch_weights_time_ms": 20.682}, "counters": {"num_env_steps_sampled": 92160, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 342000, "last_target_update_ts": 92160, "num_target_updates": 179}, "done": false, "episodes_total": 342, "training_iteration": 90, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-25-59", "timestamp": 1655501159, "time_this_iter_s": 5.3749098777771, "time_total_s": 489.0489821434021, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 489.0489821434021, "timesteps_since_restore": 0, "iterations_since_restore": 90, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.957142857142856, "ram_util_percent": 65.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -11.012959480285645, "min_q": -90.40013885498047, "max_q": 26.650774002075195, "mean_td_error": -0.012177856639027596}, "td_error": [2.5704174041748047, -0.12549781799316406, -5.954073905944824, 0.9850254058837891, -0.4523887634277344, -0.20304059982299805, -0.06412410736083984, 0.3427886962890625, 0.7130146026611328, 0.1917552947998047, 0.5732803344726562, 1.093522548675537, 0.03247833251953125, -1.3451921939849854, -1.3549766540527344, 0.30707335472106934, 0.4807100296020508, 0.6813693046569824, -0.08073103427886963, 0.22212636470794678, 0.5329256057739258, -8.628257751464844, -0.09293365478515625, 0.2670860290527344, -0.039862632751464844, 1.6271076202392578, 0.40511131286621094, 0.41590309143066406, -0.03774833679199219, 0.45493030548095703, -0.34542083740234375, 1.6040191650390625, 0.4511774182319641, 1.0629558563232422, 1.1598701477050781, -1.092580795288086, -0.1444263458251953, 0.6432614326477051, -1.4783573150634766, 0.5353240966796875, -5.7905073165893555, 2.923809051513672, 0.5483899116516113, -5.511458396911621, 1.8316411972045898, -0.0887136459350586, -1.1462717056274414, -0.21684646606445312, -0.4879493713378906, 0.022744178771972656, -0.4006821811199188, 0.11698722839355469, 1.528787612915039, 2.7460460662841797, -0.0529385507106781, 0.6617436408996582, 0.5866756439208984, 0.6567783355712891, 0.6018047332763672, -0.8135910034179688, 0.1770477294921875, -2.8525733947753906, -0.6140987873077393, 0.37969207763671875, 1.4268245697021484, 0.055504798889160156, 2.7460460662841797, 0.3224000930786133, 0.3043813705444336, -0.21684646606445312, 0.7762866020202637, 1.1126899719238281, 0.6835746765136719, 0.5136928558349609, -6.875971794128418, 0.3999061584472656, -0.3419189453125, -0.4101095199584961, 0.14806270599365234, 0.10091590881347656, -0.4122276306152344, -6.073046684265137, -0.37290191650390625, -0.4787025451660156, 1.5844688415527344, -0.24163055419921875, 0.42163515090942383, 0.22248268127441406, -0.9181127548217773, 0.3683643341064453, 2.1728668212890625, 0.48792457580566406, 4.159964561462402, -2.373906373977661, -0.11400914192199707, -0.8920021057128906, 0.4943656921386719, 0.07940793037414551, -2.5077552795410156, -0.6321601867675781, 0.3528560400009155, 0.6556930541992188, 0.8467903137207031, 0.1275186538696289, 0.48744964599609375, 0.7257490158081055, -1.1323471069335938, -0.2161397933959961, -0.5429153442382812, 1.4917163848876953, 0.5588645935058594, 0.0610804557800293, 0.01361083984375, 0.8154182434082031, -0.11702442169189453, 0.3339090347290039, 0.14214229583740234, 0.01915687322616577, 1.5135650634765625, -5.189411163330078, 0.4636821746826172, -0.04311943054199219, 0.7710762023925781, 0.22634589672088623, 1.8309516906738281, 0.6202383041381836, -0.9932136535644531, -0.24077796936035156, 0.054668426513671875, 0.8298912048339844, -0.9704189300537109, -0.20438385009765625, 0.9712677001953125, 0.42710399627685547, 0.3889493942260742, 0.6870994567871094, 0.6162738800048828, 0.5869779586791992, 6.484529495239258, 0.8122415542602539, 0.4012107849121094, 0.7932958602905273, -0.5654082298278809, 0.4937744140625, 1.3221015930175781, 0.8154430389404297, 1.093522548675537, 0.3002786636352539, 0.2844144105911255, 0.6638240814208984, 0.24187564849853516, 0.42937660217285156, 0.6783504486083984, -0.4864215850830078, -0.3052225112915039, -0.0191497802734375, 0.4593381881713867, -0.13035011291503906, 1.3063316345214844, -0.0770111083984375, -0.2316913604736328, 0.5104436874389648, 0.00274658203125, 0.9489631652832031, -0.03414726257324219, -4.583373069763184, -0.44388651847839355, 0.2437906265258789, 0.0437464714050293, 0.2511429786682129, 2.223949432373047, 1.4195518493652344, 0.00646209716796875, 0.14511871337890625, 0.5715351104736328, 1.5327239036560059, 0.45876383781433105, 1.3481471538543701, -0.19090980291366577, 0.3646125793457031, 1.2374210357666016, 0.6896321773529053, -0.0086669921875, 0.07697439193725586, 0.20521271228790283, -0.00234222412109375, -0.18970346450805664, 0.5696468353271484, 0.16602134704589844, 1.3304290771484375, 0.3209209442138672, -0.4864215850830078, 0.03884720802307129, -0.13597965240478516, 1.3354301452636719, 0.7120742797851562, 0.7713427543640137, 1.1024398803710938, 1.037919044494629, 1.9915666580200195, 1.6717697381973267, 0.6643924713134766, 1.5941925048828125, 1.8092060089111328, 0.4739246368408203, -0.07758522033691406, -1.8279924392700195, -32.650630950927734, 1.1481361389160156, -0.37531471252441406, 0.20336341857910156, 0.5004324913024902, 0.4055948257446289, 0.4534454345703125, -0.2143268585205078, 1.2013826370239258, -1.5749084949493408, 0.31151068210601807, 0.5135116577148438, 0.8557758331298828, 0.2941884994506836, 1.266244888305664, 1.3576850891113281, 0.658238410949707, 0.9385890960693359, 0.14502429962158203, 1.434112548828125, -1.3191547393798828, 0.44101858139038086, -1.2801647186279297, 1.434112548828125, 0.27620261907577515, -0.2862997055053711, 0.2786933183670044, 0.6309661865234375, -9.55356216430664, 0.7630176544189453, 0.4294137954711914, 1.4268245697021484, -1.1014175415039062], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 93184, "num_env_steps_trained": 345840, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 345840, "last_target_update_ts": 93184, "num_target_updates": 181}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -45.68992090754211, "episode_len_mean": 232.88, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612], "episode_lengths": [188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541697431710729, "mean_inference_ms": 24.11586029943175, "mean_action_processing_ms": 0.13364349289021704, "mean_env_wait_ms": 4.335063573043432, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -45.68992090754211, "episode_len_mean": 232.88, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.199999839067459, -83.78539222478867, -132.59224439412355, -296.73144418001175, -51.17763660103083, -175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612], "episode_lengths": [188, 232, 267, 327, 212, 289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541697431710729, "mean_inference_ms": 24.11586029943175, "mean_action_processing_ms": 0.13364349289021704, "mean_env_wait_ms": 4.335063573043432, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 345840, "num_env_steps_sampled": 93184, "num_env_steps_trained": 345840, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 93184, "agent_timesteps_total": 93184, "timers": {"training_iteration_time_ms": 349.106, "learn_time_ms": 81.924, "learn_throughput": 2929.542, "synch_weights_time_ms": 20.499}, "counters": {"num_env_steps_sampled": 93184, "num_env_steps_trained": 345840, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 345840, "last_target_update_ts": 93184, "num_target_updates": 181}, "done": false, "episodes_total": 345, "training_iteration": 91, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-26-05", "timestamp": 1655501165, "time_this_iter_s": 5.532729864120483, "time_total_s": 494.5817120075226, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 494.5817120075226, "timesteps_since_restore": 0, "iterations_since_restore": 91, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.7875, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -5.793752193450928, "min_q": -80.88726806640625, "max_q": 28.376760482788086, "mean_td_error": -0.2933473587036133}, "td_error": [0.3857746124267578, -0.5034580230712891, -0.22165679931640625, -0.4361248016357422, -0.3098945617675781, -0.4911956787109375, -0.4741506576538086, -0.5409450531005859, 0.19055747985839844, -0.3217945098876953, -0.031099319458007812, -0.04326033592224121, 0.6422977447509766, 0.11896133422851562, 3.5709431171417236, 0.37380218505859375, -1.213165283203125, 0.11085987091064453, -0.4912867546081543, 3.684908866882324, 2.1750221252441406, -0.7912788391113281, 0.09109020233154297, 0.7772378921508789, 0.6426467895507812, -0.07535314559936523, 0.40386152267456055, -2.9068126678466797, -0.5483345985412598, -0.4464406967163086, -0.02928447723388672, 0.20885372161865234, -0.24789857864379883, -0.2174520492553711, -0.39288341999053955, -0.27800559997558594, 0.45029735565185547, -0.05182504653930664, 0.5759162902832031, -0.9152641296386719, 1.3607943058013916, 1.7389602661132812, -0.47905993461608887, -0.8214015960693359, -0.6176528930664062, -0.2975039482116699, -0.46309566497802734, -0.041961669921875, -9.684221267700195, -0.7985706329345703, -1.9791145324707031, -0.7275009155273438, -0.37303733825683594, 0.6541633605957031, -0.15422344207763672, 1.119936466217041, 1.2922496795654297, 0.11681365966796875, 5.182305812835693, -1.3345575332641602, -0.711205005645752, -0.31789207458496094, 0.09770965576171875, 0.6050081253051758, 1.3669490814208984, 0.48818206787109375, -3.9505391120910645, -0.314788818359375, -0.3141975402832031, 0.07733154296875, -1.683762550354004, -0.4510688781738281, -0.5609655380249023, 0.06477689743041992, 0.6466684341430664, -0.7180657386779785, -0.04379844665527344, -1.4519767761230469, 0.5611867904663086, -0.6479215621948242, -1.8533368110656738, 1.7060127258300781, -0.2943077087402344, -0.41878795623779297, 0.49199676513671875, -0.08930587768554688, -1.1725454330444336, 0.511962890625, -9.251778602600098, -0.4008033871650696, -1.6774139404296875, -0.8706645965576172, 0.4504671096801758, -0.5198297500610352, -0.5453438758850098, 0.47658443450927734, -0.46007537841796875, -0.6619906425476074, -0.4114704132080078, -0.2994571924209595, 0.041164398193359375, 0.1897106170654297, -0.04109954833984375, -0.35338306427001953, 0.08047103881835938, -0.20750276744365692, -1.1821584701538086, 0.6306867599487305, -0.080078125, -0.6983509063720703, -0.12892794609069824, 1.3052196502685547, -1.1151065826416016, 0.28684043884277344, -0.27320098876953125, -0.2391815185546875, -1.524378776550293, 1.0926647186279297, 2.206686019897461, 0.522533655166626, -5.097872734069824, 0.2518634796142578, -2.662820816040039, -0.3576399087905884, -0.7071733474731445, -0.0943899154663086, -0.29671287536621094, -0.094879150390625, 0.8428270816802979, -2.3913135528564453, 0.2355804443359375, -0.5067291259765625, 1.2378056049346924, -1.0498261451721191, -0.85516357421875, 0.12355422973632812, -0.41619300842285156, -0.5144124031066895, -4.396856307983398, 0.0385894775390625, -0.2150111198425293, -0.07159709930419922, 0.019653797149658203, -1.4980692863464355, 0.02670764923095703, 0.07180523872375488, -0.5233516693115234, -0.5819826126098633, -0.3669767379760742, 0.66326904296875, -0.20206260681152344, -1.2306709289550781, 1.6028757095336914, 0.16056060791015625, -9.364636421203613, -0.24822616577148438, -0.10497474670410156, 0.13074684143066406, -0.5494513511657715, 0.14453697204589844, -0.22751617431640625, -1.042344093322754, 0.8509869575500488, 0.010879039764404297, 0.7726001739501953, -0.020721435546875, 0.38899803161621094, -10.109232902526855, 0.6887969970703125, 0.7575254440307617, 1.8888788223266602, 1.0048329830169678, -0.31189823150634766, -0.2874644994735718, 0.10252094268798828, 0.9533605575561523, 0.7620837092399597, -0.35363197326660156, 0.36214256286621094, 1.0582427978515625, 0.11858749389648438, -0.6931037902832031, -0.2577552795410156, 0.5115890502929688, -0.32581639289855957, 0.14305710792541504, 3.3223342895507812, -0.9485893249511719, -0.3585580587387085, -1.4014339447021484, -0.034297943115234375, -0.32927703857421875, 0.36141788959503174, 0.2448253631591797, -0.47328948974609375, -0.9036979675292969, -0.25684309005737305, -0.1712055206298828, 0.6167097091674805, -0.39589977264404297, -2.470121383666992, -0.9906682968139648, -0.34900879859924316, -0.15038704872131348, 0.8768653869628906, -0.3352848291397095, 0.563262939453125, -0.21610546112060547, -0.48233842849731445, -0.5829954147338867, -6.470104217529297, -0.9915509223937988, 0.2194671630859375, -0.46764543652534485, -0.21566390991210938, -0.07501792907714844, 0.0032243728637695312, -0.2901427447795868, -0.24731731414794922, -0.10967445373535156, 1.1795902252197266, -0.37183403968811035, -0.39180076122283936, -2.790356159210205, -0.5344295501708984, 2.1442413330078125, -0.5230531692504883, 0.6166191101074219, -1.715240478515625, -0.38750648498535156, 2.4968676567077637, -0.6002340316772461, -0.16513347625732422, -0.1074066162109375, 0.019069671630859375, 0.12475824356079102, 0.3817720413208008, 0.9208774566650391, 0.6451454162597656, 0.18508100509643555], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 94208, "num_env_steps_trained": 349680, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 349680, "last_target_update_ts": 94208, "num_target_updates": 183}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -45.72581661663949, "episode_len_mean": 233.94, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612, -16.189364686608315, 10.228313989937305, 11.710635490715504, -364.3854250907898, -203.04044817388058], "episode_lengths": [289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222, 232, 206, 229, 357, 308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534777122480186, "mean_inference_ms": 24.133088476010133, "mean_action_processing_ms": 0.13361962030720792, "mean_env_wait_ms": 4.341097192553443, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -45.72581661663949, "episode_len_mean": 233.94, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-175.636102065444, -230.09446002542973, -142.17673429846764, 0.7977954372763634, -57.67168617993593, 17.213219858705997, 25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612, -16.189364686608315, 10.228313989937305, 11.710635490715504, -364.3854250907898, -203.04044817388058], "episode_lengths": [289, 318, 264, 253, 239, 190, 210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222, 232, 206, 229, 357, 308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534777122480186, "mean_inference_ms": 24.133088476010133, "mean_action_processing_ms": 0.13361962030720792, "mean_env_wait_ms": 4.341097192553443, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 349680, "num_env_steps_sampled": 94208, "num_env_steps_trained": 349680, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 94208, "agent_timesteps_total": 94208, "timers": {"training_iteration_time_ms": 355.356, "learn_time_ms": 82.386, "learn_throughput": 2913.101, "synch_weights_time_ms": 20.488}, "counters": {"num_env_steps_sampled": 94208, "num_env_steps_trained": 349680, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 349680, "last_target_update_ts": 94208, "num_target_updates": 183}, "done": false, "episodes_total": 350, "training_iteration": 92, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-26-10", "timestamp": 1655501170, "time_this_iter_s": 5.655510663986206, "time_total_s": 500.2372226715088, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 500.2372226715088, "timesteps_since_restore": 0, "iterations_since_restore": 92, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.855555555555554, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -8.7319917678833, "min_q": -90.68905639648438, "max_q": 32.80917739868164, "mean_td_error": -0.6861333250999451}, "td_error": [1.210296630859375, 0.11707592010498047, -0.02378535270690918, 0.2007899284362793, -0.3794422149658203, -0.35369300842285156, -5.87408447265625, -0.749603271484375, -0.15370559692382812, -0.28443050384521484, -3.400087356567383, -0.2563629150390625, -0.2297801971435547, -0.10049676895141602, -32.607139587402344, -2.229495048522949, -1.5014610290527344, -0.24374771118164062, 0.05819237232208252, 0.07436263561248779, -0.25316524505615234, 0.41805315017700195, 0.41556787490844727, 0.46886157989501953, 0.44756197929382324, -0.5800876617431641, -0.09930419921875, -0.1648845672607422, 0.82025146484375, -0.2652878761291504, 0.02789306640625, 0.7291557788848877, -0.1075282096862793, -0.3417510986328125, 0.8706684112548828, 0.0123443603515625, 0.5206403732299805, 0.20876264572143555, -1.6204705238342285, 0.35867881774902344, 0.12810993194580078, -0.7989623546600342, -0.33794212341308594, 0.8079319000244141, -0.3135204315185547, -5.178214073181152, -0.20521926879882812, 0.3936786651611328, -1.4835810661315918, 0.28972721099853516, -0.04385185241699219, -1.2509269714355469, 0.2130584716796875, 0.016496658325195312, -0.24019622802734375, -0.44933605194091797, -0.05361175537109375, -0.11614418029785156, 0.5737801790237427, -6.243915557861328, -0.6197769641876221, -0.20989608764648438, 0.24607181549072266, -0.28386735916137695, -0.6155424118041992, 0.8846416473388672, -0.20824027061462402, 0.015187263488769531, -0.16851425170898438, -0.06923484802246094, -1.2260322570800781, 0.9990110397338867, -0.8640832901000977, -0.2597999572753906, -0.38410282135009766, 0.2535381317138672, -1.2644062042236328, 0.487884521484375, 0.022676467895507812, -1.3290252685546875, 0.8623974323272705, -5.527772426605225, -0.7295370101928711, -0.32032012939453125, -0.3746652603149414, 0.07431459426879883, -0.02117002010345459, 0.2544097900390625, -25.738033294677734, -0.09910392761230469, -7.708155632019043, 1.745213508605957, -0.054882049560546875, -0.4712104797363281, 1.0221586227416992, -2.0844039916992188, 0.469937801361084, 0.2516021728515625, -0.5924324989318848, -0.797266960144043, 0.09728288650512695, 0.07827818393707275, 1.1041545867919922, -0.9883651733398438, 0.1470489501953125, -0.9329700469970703, 0.4865570068359375, 0.5884056091308594, 0.08687782287597656, 0.2584247589111328, -12.002445220947266, -0.607755184173584, 0.14710140228271484, 1.2320728302001953, -0.13484811782836914, -0.7051467895507812, 0.3431878089904785, -0.39340782165527344, 0.4132676124572754, -0.42298316955566406, -2.393871307373047, -0.29370832443237305, -0.08035945892333984, 0.019054412841796875, 0.12885093688964844, 1.4699373245239258, 0.0646371841430664, -0.17821979522705078, -0.34720897674560547, 0.22326374053955078, -0.3372077941894531, -0.09555435180664062, -0.12663936614990234, -0.7602319717407227, -0.2935519218444824, -0.05725669860839844, -0.051526546478271484, 0.8819541931152344, 0.3936786651611328, -0.9874438643455505, -0.13910388946533203, 0.11948871612548828, 0.8034534454345703, -0.426222562789917, -0.5684804916381836, -0.01663494110107422, 0.11793160438537598, 0.04158592224121094, -1.1939430236816406, 0.3776721954345703, -0.27668094635009766, 0.0058689117431640625, 0.6557216644287109, 1.0841045379638672, -0.2973008155822754, 0.12164974212646484, -0.9053192138671875, 1.4022750854492188, 0.3019554615020752, 0.23061752319335938, 1.0510120391845703, -9.207624435424805, -0.2689533233642578, 2.0296573638916016, 0.7160682678222656, 0.4271578788757324, -0.0055353641510009766, -0.19126176834106445, 0.6578273773193359, -1.1424140930175781, -0.1648845672607422, 0.6204032897949219, -0.11008083820343018, 0.7016892433166504, -0.236358642578125, 0.2816638946533203, 0.27892184257507324, 1.1873626708984375, 0.04833269119262695, -0.19400501251220703, -10.923919677734375, -1.9381847381591797, 0.03433942794799805, -0.9130821228027344, 0.08235883712768555, -0.6064796447753906, -5.824291229248047, 0.2575554847717285, 0.32579874992370605, -1.6548690795898438, 0.26905250549316406, -0.7127761840820312, -0.32482337951660156, -0.9505176544189453, -0.4485664367675781, 0.5481252670288086, -0.22087478637695312, 0.13349056243896484, 0.09457921981811523, -0.16396665573120117, 0.2343214750289917, -0.09330368041992188, -0.3748598098754883, -0.32570600509643555, 0.36505842208862305, 0.9245052337646484, -0.08185005187988281, 0.2192096710205078, -0.23744559288024902, -0.22192645072937012, -2.222445249557495, -7.818808078765869, -0.3458824157714844, -0.34105682373046875, -0.23203277587890625, -0.09673881530761719, -1.9771308898925781, -5.561470031738281, -0.11785697937011719, 0.6371908187866211, 0.3422250747680664, -1.4160308837890625, 1.4437580108642578, 1.1073112487792969, 1.364450454711914, 0.23372697830200195, -0.11988258361816406, -5.442577362060547, 0.15140900015830994, -0.9053192138671875, 3.846665382385254, -0.2515716552734375, -0.42159366607666016, 0.4633817672729492, -0.5459089279174805, -1.6183929443359375, -1.0774288177490234, -0.31028079986572266, -1.625645399093628, 0.40973663330078125], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 95232, "num_env_steps_trained": 353520, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 353520, "last_target_update_ts": 95232, "num_target_updates": 185}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -43.95494416296482, "episode_len_mean": 232.88, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612, -16.189364686608315, 10.228313989937305, 11.710635490715504, -364.3854250907898, -203.04044817388058, 9.971612192690372, -155.47763647139072, -34.32393506169319, -253.62010650336742, 18.369343802332878, 4.600000135600567], "episode_lengths": [210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222, 232, 206, 229, 357, 308, 233, 269, 214, 301, 200, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540334025032214, "mean_inference_ms": 24.119813472814794, "mean_action_processing_ms": 0.13362242051486026, "mean_env_wait_ms": 4.340295767626159, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -43.95494416296482, "episode_len_mean": 232.88, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.11216927319765, 14.410635367035866, -30.451680831611156, 2.828313894569874, -39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612, -16.189364686608315, 10.228313989937305, 11.710635490715504, -364.3854250907898, -203.04044817388058, 9.971612192690372, -155.47763647139072, -34.32393506169319, -253.62010650336742, 18.369343802332878, 4.600000135600567], "episode_lengths": [210, 236, 235, 217, 243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222, 232, 206, 229, 357, 308, 233, 269, 214, 301, 200, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540334025032214, "mean_inference_ms": 24.119813472814794, "mean_action_processing_ms": 0.13362242051486026, "mean_env_wait_ms": 4.340295767626159, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 353520, "num_env_steps_sampled": 95232, "num_env_steps_trained": 353520, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 95232, "agent_timesteps_total": 95232, "timers": {"training_iteration_time_ms": 336.947, "learn_time_ms": 83.161, "learn_throughput": 2885.966, "synch_weights_time_ms": 20.495}, "counters": {"num_env_steps_sampled": 95232, "num_env_steps_trained": 353520, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 353520, "last_target_update_ts": 95232, "num_target_updates": 185}, "done": false, "episodes_total": 356, "training_iteration": 93, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-26-16", "timestamp": 1655501176, "time_this_iter_s": 5.606617212295532, "time_total_s": 505.8438398838043, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 505.8438398838043, "timesteps_since_restore": 0, "iterations_since_restore": 93, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 29.5125, "ram_util_percent": 65.26249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -9.953658103942871, "min_q": -88.9939193725586, "max_q": 29.51595687866211, "mean_td_error": -0.9205305576324463}, "td_error": [-0.2504463195800781, -0.7717647552490234, 0.9053497314453125, -0.8690824508666992, 2.3377842903137207, -1.179727554321289, 0.08733654022216797, -1.0212059020996094, -0.11890792846679688, 0.6207695007324219, -0.5294103622436523, 0.7860145568847656, -0.33280014991760254, -11.680399894714355, 2.2816848754882812, -0.2406024932861328, -0.06076216697692871, 0.47545087337493896, 0.16437721252441406, 0.3549060821533203, 0.6919703483581543, 1.6995506286621094, 0.3240385055541992, 0.06756591796875, 0.9255790710449219, 1.8876762390136719, 0.3477402925491333, 2.332307815551758, 0.21134185791015625, 0.13457560539245605, -0.17611193656921387, -2.117781639099121, 0.34191226959228516, -0.113739013671875, -0.1593637466430664, 0.3379058837890625, -0.3234539031982422, 1.0280170440673828, -0.2926750183105469, 0.4189186096191406, -1.3356962203979492, -0.3918619155883789, -0.48957061767578125, 2.246030807495117, -0.3694009780883789, 0.8077201843261719, 1.6245746612548828, 0.32718658447265625, 0.5086517333984375, 0.13763427734375, 0.07606238126754761, 2.246030807495117, -0.05141568183898926, 2.048490524291992, 0.35733985900878906, 0.06966757774353027, 0.5770187377929688, -0.297033429145813, -1.5921201705932617, 1.094736099243164, 0.1071481704711914, 0.23878955841064453, -0.6405577659606934, 0.5596790313720703, -0.5912199020385742, -0.7339630126953125, -0.1690382957458496, 1.3149995803833008, -0.2723257541656494, 0.17510032653808594, -3.7143020629882812, 0.8730373382568359, -0.6685504913330078, 0.43935585021972656, 12.433025360107422, 1.1205215454101562, 0.5947179794311523, 0.30132007598876953, 0.45145416259765625, -0.3977489471435547, 0.8379690647125244, -0.8565163612365723, -0.06975364685058594, 0.22157001495361328, -0.14776432514190674, -1.3037834167480469, 0.1619102954864502, 0.11769866943359375, 0.39341068267822266, -0.2334880828857422, 0.47674560546875, 0.18814849853515625, 0.13574600219726562, -27.233901977539062, 1.0992660522460938, -2.016465187072754, 0.6425876617431641, -0.34467267990112305, 0.9091105461120605, -0.5585319995880127, 0.8902130126953125, -0.5970945358276367, 0.9255790710449219, -0.4014739990234375, -0.2948472499847412, -0.45015525817871094, -0.670235812664032, 0.9985742568969727, -0.2881178855895996, 0.9039769172668457, -0.08125877380371094, 1.7613582611083984, 0.8415317535400391, -0.14455127716064453, 0.04532051086425781, -0.3793163299560547, -0.02346181869506836, -4.023255348205566, -0.9955463409423828, -0.23424339294433594, 0.5939502716064453, -0.8370895385742188, -0.25235939025878906, 0.7603363990783691, 1.7759246826171875, 1.1181983947753906, -0.20923614501953125, -0.012675285339355469, 0.011928558349609375, -8.012479782104492, 0.06610894203186035, 0.4296541213989258, -0.07686138153076172, -0.11724710464477539, 0.3273134231567383, -39.03150939941406, 0.038715362548828125, -0.03270435333251953, 0.29723942279815674, -0.057442665100097656, -0.6411118507385254, 0.9971415996551514, 0.03501272201538086, -1.09663724899292, 0.5041046142578125, 0.7930550575256348, -0.14345669746398926, -0.6956291198730469, -16.309097290039062, -0.5769767761230469, -0.15228676795959473, -0.2630271911621094, 0.038349151611328125, -0.20923614501953125, 3.8367457389831543, 0.2722616195678711, 0.5019979476928711, 0.5881900787353516, 0.5975456237792969, 0.06756591796875, -0.4736928939819336, 0.1439208984375, 0.3700847625732422, -2.9633026123046875, -0.38066673278808594, 1.2983970642089844, -0.2432394027709961, -0.1362781524658203, 0.5470685958862305, 0.08494830131530762, 1.003748893737793, 0.98004150390625, 1.3206024169921875, 0.33377599716186523, -0.24906635284423828, -0.2711009979248047, 1.8735466003417969, -5.899947166442871, 1.0798110961914062, -0.2598085403442383, 0.7433891296386719, -0.5304775238037109, 1.3463172912597656, 0.5540885925292969, 1.2983970642089844, -1.6741561889648438, -0.46404898166656494, 0.44808483123779297, 0.6875209808349609, -0.3724374771118164, -0.019160747528076172, -1.6638679504394531, -0.9536802768707275, -0.4001638889312744, 1.7288570404052734, -5.228985786437988, -1.46539306640625, -5.1180009841918945, 1.2263565063476562, 0.28221750259399414, 0.1316850185394287, 0.15188026428222656, -79.36318969726562, -0.5537376403808594, -2.1352105140686035, 1.0093088150024414, -0.16030359268188477, -21.55818748474121, 1.1572303771972656, -2.3576602935791016, -2.876342296600342, -0.055590152740478516, -0.35903072357177734, 1.6760520935058594, -0.23973047733306885, -0.12838506698608398, -46.250579833984375, 0.27631402015686035, -0.12722492218017578, -0.8483772277832031, 0.041657447814941406, -0.002780914306640625, 0.296921968460083, 0.32718658447265625, -2.5631906986236572, 0.14104557037353516, -0.8111281394958496, 1.311811923980713, -0.11174869537353516, 1.0329194068908691, -5.5847673416137695, 23.69135284423828, 0.7027997970581055, 0.5804042816162109, -1.6014385223388672, 1.1121902465820312, -0.09477806091308594, -8.801168441772461, 1.093780517578125, -0.327606201171875], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 96256, "num_env_steps_trained": 357360, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 357360, "last_target_update_ts": 96256, "num_target_updates": 187}, "sampler_results": {"episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -48.62840516597033, "episode_len_mean": 234.35, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612, -16.189364686608315, 10.228313989937305, 11.710635490715504, -364.3854250907898, -203.04044817388058, 9.971612192690372, -155.47763647139072, -34.32393506169319, -253.62010650336742, 18.369343802332878, 4.600000135600567, 7.799999944865704, -36.23521427065134, -431.01144829392433, 4.000000022351742], "episode_lengths": [243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222, 232, 206, 229, 357, 308, 233, 269, 214, 301, 200, 230, 200, 240, 385, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552201561488109, "mean_inference_ms": 24.116365477667223, "mean_action_processing_ms": 0.13370927398145308, "mean_env_wait_ms": 4.3407132690240084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 39.95859806239605, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -48.62840516597033, "episode_len_mean": 234.35, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-39.19933517277241, 39.95859806239605, -27.0, 6.700000114738941, -157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612, -16.189364686608315, 10.228313989937305, 11.710635490715504, -364.3854250907898, -203.04044817388058, 9.971612192690372, -155.47763647139072, -34.32393506169319, -253.62010650336742, 18.369343802332878, 4.600000135600567, 7.799999944865704, -36.23521427065134, -431.01144829392433, 4.000000022351742], "episode_lengths": [243, 222, 212, 209, 297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222, 232, 206, 229, 357, 308, 233, 269, 214, 301, 200, 230, 200, 240, 385, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552201561488109, "mean_inference_ms": 24.116365477667223, "mean_action_processing_ms": 0.13370927398145308, "mean_env_wait_ms": 4.3407132690240084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 357360, "num_env_steps_sampled": 96256, "num_env_steps_trained": 357360, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 96256, "agent_timesteps_total": 96256, "timers": {"training_iteration_time_ms": 350.75, "learn_time_ms": 81.334, "learn_throughput": 2950.811, "synch_weights_time_ms": 20.333}, "counters": {"num_env_steps_sampled": 96256, "num_env_steps_trained": 357360, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 357360, "last_target_update_ts": 96256, "num_target_updates": 187}, "done": false, "episodes_total": 360, "training_iteration": 94, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-26-22", "timestamp": 1655501182, "time_this_iter_s": 5.7510035037994385, "time_total_s": 511.59484338760376, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 511.59484338760376, "timesteps_since_restore": 0, "iterations_since_restore": 94, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.15, "ram_util_percent": 65.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.575343132019043, "min_q": -79.24546813964844, "max_q": 26.10753059387207, "mean_td_error": -0.3934547007083893}, "td_error": [-0.4626469612121582, 1.3015995025634766, -0.5193643569946289, 0.08168268203735352, 0.3371443748474121, 0.9534587860107422, 0.8355712890625, 0.961578369140625, -0.0449678897857666, 0.7048149108886719, -4.109005928039551, 1.301076889038086, 0.10550594329833984, 1.5092439651489258, 0.4785590171813965, 0.996910572052002, -16.126319885253906, -10.679971694946289, -0.607752799987793, -0.5368404388427734, -0.718510627746582, 1.156625747680664, 0.8486804962158203, 0.2622232437133789, -0.10996246337890625, 1.4476451873779297, 0.0722503662109375, 0.4695148468017578, -0.6768742799758911, -0.3857154846191406, 1.015960693359375, 0.11122417449951172, -0.5402193069458008, -0.896082878112793, -0.33412742614746094, -0.5138740539550781, -0.1033334732055664, -0.9127368927001953, 0.003920555114746094, -0.4425095021724701, 1.7272610664367676, -0.11282157897949219, -0.5056629180908203, -0.23439645767211914, 1.4313297271728516, 0.7288589477539062, -0.15968871116638184, -0.9242591857910156, -0.1167449951171875, -0.10119438171386719, 0.8397216796875, -4.924106597900391, 0.7967061996459961, 1.8885116577148438, 0.0686788558959961, -0.4825706481933594, 0.008022904396057129, 0.08043289184570312, 0.11949717998504639, 0.21370840072631836, -0.3710770606994629, 0.13242340087890625, -0.1972181797027588, -1.0460443496704102, 0.3047139644622803, -40.21869659423828, 1.5009965896606445, 1.213623046875, -0.5275096893310547, -6.268746376037598, 0.3382301330566406, -1.4416618347167969, -0.3639955520629883, -7.024470806121826, -0.4993593692779541, -2.2760000228881836, 1.1940412521362305, -0.25568675994873047, -0.11797809600830078, -0.8006057739257812, 0.4258279800415039, -0.8022290468215942, -0.5086526870727539, -0.6907787322998047, 0.08584260940551758, 0.710662841796875, 0.40673828125, 0.1481001377105713, 0.07085609436035156, 0.2519845962524414, -0.8674892783164978, -0.9348735809326172, -0.0016741156578063965, 0.46956396102905273, 0.2687244415283203, -0.13215065002441406, 0.1798231601715088, -0.04767817258834839, -0.06704545021057129, -0.3887596130371094, -0.8674755096435547, 0.5041007995605469, -0.07741641998291016, 0.11045891046524048, -0.8175067901611328, 1.673715591430664, -0.26893889904022217, 2.9708328247070312, 0.8136959075927734, 0.5389080047607422, 0.5725498199462891, -0.5535726547241211, 0.11393165588378906, 2.3148155212402344, 0.5616309642791748, -0.0745096206665039, 0.5987351536750793, -0.4067058563232422, 0.36417675018310547, -4.245207786560059, -0.13215065002441406, -0.03741168975830078, 1.3585186004638672, 0.42906880378723145, 0.18381142616271973, -0.5437307357788086, 1.5398931503295898, -0.4664154052734375, 0.5590786933898926, -0.993621826171875, -0.4377613067626953, 1.7316341400146484, 1.4970207214355469, -0.49750709533691406, 0.050086021423339844, 0.9048366546630859, 0.4980602264404297, 2.2595348358154297, -0.5202207565307617, 0.7144279479980469, 3.235227584838867, 1.740178108215332, 0.07377839088439941, -0.5648946762084961, 1.7737464904785156, 0.10126686096191406, -1.9251575469970703, 0.3200492858886719, -9.94881820678711, 0.9348363876342773, 0.3779335021972656, 0.9257545471191406, 0.15162992477416992, 0.5956311225891113, 0.2798328399658203, 0.5621051788330078, -0.5422859191894531, 0.15695762634277344, 0.06632232666015625, -5.94271183013916, 1.946044921875, 0.8066921234130859, -0.6671791076660156, 0.07114791870117188, 1.1333789825439453, -0.057109832763671875, 0.7708206176757812, 2.8373584747314453, 2.978790283203125, -0.2069261074066162, -0.13160324096679688, -0.49181365966796875, -0.25908657908439636, 2.3876476287841797, 0.1516726016998291, 0.17522811889648438, 1.1112003326416016, -0.7136297821998596, -0.11050701141357422, 0.3319387435913086, -0.0969846248626709, -0.6169328689575195, -12.589425086975098, 0.17853546142578125, -0.08803129196166992, -0.4183769226074219, 0.086639404296875, -0.8892107009887695, 1.3774452209472656, 0.06012153625488281, 0.49428701400756836, -3.6191937923431396, -0.0367584228515625, 0.8348283767700195, -0.6214048862457275, -0.41193580627441406, -1.3053312301635742, 0.01331329345703125, 2.4707775115966797, 0.9348363876342773, 1.7473187446594238, 0.2966899871826172, 2.4781131744384766, 1.2472820281982422, -3.2176361083984375, -0.15578174591064453, -0.8455085754394531, 0.2946910858154297, 0.7745223045349121, 0.06287670135498047, 0.39513301849365234, -16.663349151611328, 0.8577651977539062, 0.4241740107536316, 2.1062145233154297, 0.1806718111038208, 0.04005241394042969, -0.20668363571166992, -0.7098178863525391, 0.06357192993164062, 0.7438011169433594, 2.508030891418457, -1.0287275314331055, -0.7807369232177734, 0.8081378936767578, 0.5445060729980469, -7.137739181518555, 0.21880364418029785, -0.37804412841796875, 1.9406261444091797, -0.262121319770813, 0.10944890975952148, 0.05776184797286987, -0.43523073196411133, 0.22777557373046875, -0.19399785995483398, -0.78802490234375, 0.6036479473114014, -0.23321533203125, -0.6675724983215332], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 97280, "num_env_steps_trained": 361200, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 361200, "last_target_update_ts": 97280, "num_target_updates": 189}, "sampler_results": {"episode_reward_max": 30.42902609705925, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -48.784199570193884, "episode_len_mean": 233.56, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612, -16.189364686608315, 10.228313989937305, 11.710635490715504, -364.3854250907898, -203.04044817388058, 9.971612192690372, -155.47763647139072, -34.32393506169319, -253.62010650336742, 18.369343802332878, 4.600000135600567, 7.799999944865704, -36.23521427065134, -431.01144829392433, 4.000000022351742, 7.964785985648632, 12.064785912632942, -70.63183429837227, 15.482084982097149], "episode_lengths": [297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222, 232, 206, 229, 357, 308, 233, 269, 214, 301, 200, 230, 200, 240, 385, 220, 195, 193, 243, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553583986980148, "mean_inference_ms": 24.131623842573582, "mean_action_processing_ms": 0.13378665533639952, "mean_env_wait_ms": 4.349831806560818, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 30.42902609705925, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -48.784199570193884, "episode_len_mean": 233.56, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157.23381235450506, 6.4000000804662704, 8.59999993443489, 8.91063541173935, -153.55636594444513, -42.88539157807827, -277.7566609829664, 3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612, -16.189364686608315, 10.228313989937305, 11.710635490715504, -364.3854250907898, -203.04044817388058, 9.971612192690372, -155.47763647139072, -34.32393506169319, -253.62010650336742, 18.369343802332878, 4.600000135600567, 7.799999944865704, -36.23521427065134, -431.01144829392433, 4.000000022351742, 7.964785985648632, 12.064785912632942, -70.63183429837227, 15.482084982097149], "episode_lengths": [297, 183, 228, 235, 249, 224, 324, 182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222, 232, 206, 229, 357, 308, 233, 269, 214, 301, 200, 230, 200, 240, 385, 220, 195, 193, 243, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553583986980148, "mean_inference_ms": 24.131623842573582, "mean_action_processing_ms": 0.13378665533639952, "mean_env_wait_ms": 4.349831806560818, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 361200, "num_env_steps_sampled": 97280, "num_env_steps_trained": 361200, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 97280, "agent_timesteps_total": 97280, "timers": {"training_iteration_time_ms": 356.592, "learn_time_ms": 82.227, "learn_throughput": 2918.757, "synch_weights_time_ms": 20.089}, "counters": {"num_env_steps_sampled": 97280, "num_env_steps_trained": 361200, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 361200, "last_target_update_ts": 97280, "num_target_updates": 189}, "done": false, "episodes_total": 364, "training_iteration": 95, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-26-28", "timestamp": 1655501188, "time_this_iter_s": 5.5367841720581055, "time_total_s": 517.1316275596619, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 517.1316275596619, "timesteps_since_restore": 0, "iterations_since_restore": 95, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.8625, "ram_util_percent": 65.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -5.345391750335693, "min_q": -87.56747436523438, "max_q": 26.813716888427734, "mean_td_error": -0.3637217581272125}, "td_error": [0.9241724014282227, -0.6111884117126465, -0.32790523767471313, -0.0796966552734375, -12.602655410766602, 3.2449512481689453, -0.8708839416503906, -0.5680179595947266, -1.1528215408325195, 0.045440673828125, 1.4276609420776367, 4.445416450500488, 0.1333613395690918, 2.3812427520751953, -0.7312965393066406, -0.09136772155761719, -7.411842346191406, -7.5703911781311035, -0.44409656524658203, 0.040513038635253906, 0.48170924186706543, 0.141387939453125, -0.4509744644165039, -0.06123852729797363, 0.07037997245788574, -0.9236278533935547, -0.3089876174926758, -0.16631269454956055, -0.21544618904590607, -1.2099285125732422, -0.048267364501953125, -0.6509408950805664, -0.04593515396118164, 0.7324275970458984, -0.18196392059326172, -0.18762493133544922, -0.26476573944091797, 0.07171249389648438, 0.2027587890625, -0.6401000022888184, -0.5483646392822266, -0.24357891082763672, 0.43347758054733276, -0.1846323013305664, -0.4774942398071289, 0.19012832641601562, 2.975849151611328, -1.8115386962890625, 3.301748275756836, 0.18868732452392578, -0.0852823257446289, -0.4463672637939453, 0.5910701751708984, 0.14931440353393555, 1.5575628280639648, 0.4584522247314453, 0.019930124282836914, 1.1931113004684448, 0.40279507637023926, -0.060271263122558594, 0.18935778737068176, -0.0817403793334961, 1.9717469215393066, 0.10964202880859375, 0.32255256175994873, -8.264385223388672, 0.505340576171875, -0.5329809188842773, -0.13131332397460938, -0.06765460968017578, 0.9811444282531738, -2.380922317504883, -0.33275365829467773, -7.265312194824219, -1.2690849304199219, -0.14739608764648438, 4.189070701599121, -0.19346237182617188, -0.8080358505249023, 0.38464927673339844, -0.0027294158935546875, -0.6154670715332031, 0.8490352630615234, 1.6342697143554688, 0.0468144416809082, -1.335592269897461, -0.10474395751953125, 1.3596611022949219, -0.6785287857055664, 9.639304161071777, 0.19365692138671875, -0.7648568153381348, 0.22742080688476562, -0.3943367004394531, -2.0823516845703125, 0.09444093704223633, 0.4857354164123535, -0.047055721282958984, -1.9518558979034424, -10.629521369934082, 1.634481430053711, 0.2951275706291199, -0.24761962890625, 3.46366024017334, 0.17718791961669922, -0.5974941253662109, -0.3194561004638672, 1.4266090393066406, -0.20789527893066406, -0.2353649139404297, -0.5591864585876465, 0.35640430450439453, 1.0699748992919922, 0.43776071071624756, 0.09962081909179688, -0.5686187744140625, -0.020531654357910156, 3.1973037719726562, 0.013037681579589844, -0.19378948211669922, -0.3133220672607422, -7.2525482177734375, -0.4283590316772461, -0.11376190185546875, -13.807357788085938, 3.0385265350341797, -1.6895229816436768, 0.7336273193359375, 0.5570623874664307, -0.0975332260131836, 0.5872750282287598, 1.9290237426757812, -0.516448974609375, 0.1106557846069336, 0.8036174774169922, -0.22420501708984375, -0.2595038414001465, -1.1581439971923828, -22.785507202148438, -0.11159653961658478, -2.9337730407714844, 0.7833232879638672, -0.10211420059204102, -0.2225356101989746, 0.2920684814453125, -0.1304931640625, 1.9232597351074219, -0.24187755584716797, 4.451230049133301, 0.22473526000976562, 0.8379907608032227, -0.800872802734375, -0.5701866149902344, -0.28676795959472656, -0.3232688903808594, -0.5407743453979492, -1.9407377243041992, 0.1451396942138672, 0.2823638916015625, 0.2016305923461914, -5.878602504730225, 2.3777103424072266, -0.26784324645996094, -0.6894025802612305, 0.22307538986206055, -0.11009883880615234, 0.2889423370361328, -2.035753011703491, -0.4319477081298828, 1.175246238708496, -0.2949256896972656, -0.8163208961486816, 0.10964202880859375, 0.0056819915771484375, -0.6553249359130859, -3.979689598083496, 0.6869869232177734, -0.11110782623291016, 0.6588611602783203, 0.3655710220336914, 0.8405051231384277, 4.419798851013184, 0.0246732234954834, -0.8928937911987305, -0.21340560913085938, 2.4822864532470703, -0.39945507049560547, -0.3537578582763672, 2.247429847717285, -0.35529518127441406, -0.4996604919433594, 1.4860353469848633, 0.2389841079711914, -6.194581031799316, -0.3159456253051758, -0.1793677806854248, -0.39583492279052734, 0.22900056838989258, -0.09505462646484375, -0.03751373291015625, -1.3198318481445312, -0.5772781372070312, -0.1611766815185547, -0.018545150756835938, 0.20993328094482422, 0.6575508117675781, 1.7985267639160156, -0.9485931396484375, 0.8138713836669922, 1.2411165237426758, 0.8157882690429688, 0.1297016143798828, 0.0013790130615234375, -0.4481639862060547, 0.7360687255859375, -0.0201684832572937, -0.06278181076049805, 1.446920394897461, 0.7129812240600586, -0.6479835510253906, 0.1726512908935547, -0.4300994873046875, -0.505673885345459, 0.26927852630615234, -0.6582412719726562, 0.1095278263092041, -0.7441473007202148, 0.3467426300048828, 0.15197277069091797, 1.8655586242675781, -0.32660627365112305, -19.619897842407227, -0.17704200744628906, -0.6437816619873047, -0.35529518127441406, -0.25202369689941406, 0.7159709930419922, 0.4814577102661133, -0.6760807037353516, -0.5361967086791992], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 98304, "num_env_steps_trained": 365040, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 365040, "last_target_update_ts": 98304, "num_target_updates": 191}, "sampler_results": {"episode_reward_max": 30.42902609705925, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -44.08031329110265, "episode_len_mean": 232.28, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612, -16.189364686608315, 10.228313989937305, 11.710635490715504, -364.3854250907898, -203.04044817388058, 9.971612192690372, -155.47763647139072, -34.32393506169319, -253.62010650336742, 18.369343802332878, 4.600000135600567, 7.799999944865704, -36.23521427065134, -431.01144829392433, 4.000000022351742, 7.964785985648632, 12.064785912632942, -70.63183429837227, 15.482084982097149, 12.110635451972485, -40.22060617804527, -106.02655613422394, -40.585392124950886, 25.526145860552788, 4.342037238180637, 7.720768362283707], "episode_lengths": [182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222, 232, 206, 229, 357, 308, 233, 269, 214, 301, 200, 230, 200, 240, 385, 220, 195, 193, 243, 176, 230, 236, 274, 243, 203, 224, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554213064362237, "mean_inference_ms": 24.124420882104992, "mean_action_processing_ms": 0.13367642903825205, "mean_env_wait_ms": 4.350801436785953, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 30.42902609705925, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -44.08031329110265, "episode_len_mean": 232.28, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.000000022351742, -141.4452458396554, -228.09819504618645, 10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612, -16.189364686608315, 10.228313989937305, 11.710635490715504, -364.3854250907898, -203.04044817388058, 9.971612192690372, -155.47763647139072, -34.32393506169319, -253.62010650336742, 18.369343802332878, 4.600000135600567, 7.799999944865704, -36.23521427065134, -431.01144829392433, 4.000000022351742, 7.964785985648632, 12.064785912632942, -70.63183429837227, 15.482084982097149, 12.110635451972485, -40.22060617804527, -106.02655613422394, -40.585392124950886, 25.526145860552788, 4.342037238180637, 7.720768362283707], "episode_lengths": [182, 266, 270, 217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222, 232, 206, 229, 357, 308, 233, 269, 214, 301, 200, 230, 200, 240, 385, 220, 195, 193, 243, 176, 230, 236, 274, 243, 203, 224, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554213064362237, "mean_inference_ms": 24.124420882104992, "mean_action_processing_ms": 0.13367642903825205, "mean_env_wait_ms": 4.350801436785953, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 365040, "num_env_steps_sampled": 98304, "num_env_steps_trained": 365040, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 98304, "agent_timesteps_total": 98304, "timers": {"training_iteration_time_ms": 366.64, "learn_time_ms": 83.558, "learn_throughput": 2872.249, "synch_weights_time_ms": 20.507}, "counters": {"num_env_steps_sampled": 98304, "num_env_steps_trained": 365040, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 365040, "last_target_update_ts": 98304, "num_target_updates": 191}, "done": false, "episodes_total": 371, "training_iteration": 96, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-26-34", "timestamp": 1655501194, "time_this_iter_s": 5.755963087081909, "time_total_s": 522.8875906467438, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 522.8875906467438, "timesteps_since_restore": 0, "iterations_since_restore": 96, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.4625, "ram_util_percent": 65.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -6.1281938552856445, "min_q": -87.75238800048828, "max_q": 29.807466506958008, "mean_td_error": -0.4888497591018677}, "td_error": [0.1973743438720703, 0.2975959777832031, -0.207444429397583, -0.39204978942871094, -0.6023550033569336, 1.564657211303711, -1.2138185501098633, -0.4914712905883789, -0.17574791610240936, -0.31295204162597656, -1.0539286136627197, -1.6738710403442383, -0.05628395080566406, -0.5547933578491211, -0.0029544830322265625, -5.812395095825195, -0.38377857208251953, -0.6870803833007812, -0.22261571884155273, -0.7540187835693359, -0.8302230834960938, 0.8280544281005859, -0.30850982666015625, -0.7831277847290039, 0.3822488784790039, 0.8786849975585938, -0.6206445693969727, -0.29137754440307617, -0.6777689456939697, 0.15295028686523438, -0.2705373764038086, -1.6724753379821777, 0.7178258895874023, 2.1107048988342285, 0.009016990661621094, -0.4813079833984375, 0.5235795974731445, -1.0224590301513672, -6.21021842956543, -0.7872829437255859, 0.9192447662353516, -0.9471883773803711, -0.4362630844116211, -0.5424706935882568, 0.9714984893798828, 1.7911529541015625, -0.1097555160522461, 0.4649085998535156, -0.6834297180175781, -0.5370110273361206, -0.046297550201416016, -1.3172426223754883, -0.5627479553222656, -0.6652004718780518, -5.198105812072754, 0.3108096122741699, 0.3122844696044922, -0.7741973996162415, -0.5747380256652832, -0.0886789858341217, 0.7164363861083984, -0.2459564208984375, 0.1269521713256836, -0.11028528213500977, 0.7034683227539062, -0.7198619842529297, -0.09455108642578125, -0.5455207824707031, -0.509089469909668, 0.5258913040161133, 0.29404163360595703, -0.5272605419158936, 11.326200485229492, -0.2943863868713379, 0.04470467567443848, 0.4044609069824219, -1.370060920715332, -0.17492294311523438, 0.8451728820800781, -0.0961456298828125, -0.13241147994995117, -0.7371025085449219, -0.6574640274047852, -0.41335296630859375, -0.059830665588378906, -0.2560272216796875, -0.6183445453643799, -0.8120136260986328, -0.5181875228881836, 0.004436492919921875, -0.5838098526000977, -0.8143892288208008, -0.9137668609619141, 0.9670431613922119, 7.150766849517822, -0.30756425857543945, 0.27199283242225647, 0.23407554626464844, 1.1359062194824219, 0.461191326379776, -0.27013492584228516, 0.1407337188720703, -1.0410003662109375, -4.691076278686523, -7.187012195587158, -0.17183971405029297, 0.029727935791015625, -0.4822120666503906, 0.1531064510345459, -0.2213602066040039, 0.35634613037109375, -0.5181875228881836, 1.4497957229614258, -0.8124065399169922, -11.001663208007812, -0.20726585388183594, -14.264663696289062, -1.1722474098205566, -0.5093955993652344, -0.08163738250732422, -0.39204978942871094, 0.0316925048828125, 0.19924569129943848, 1.3031787872314453, -0.46630287170410156, -0.14550137519836426, 0.11328315734863281, -0.1407918930053711, -0.8866434097290039, -0.7294950485229492, 0.33803653717041016, -0.23893919587135315, -0.35746192932128906, 0.13543415069580078, -8.740028381347656, 0.4860827326774597, 0.1407337188720703, 0.07073378562927246, -0.22364234924316406, 0.046512603759765625, -2.394235372543335, -0.3334980010986328, 0.6242656707763672, -2.490091323852539, -0.7724151611328125, 0.24626469612121582, -0.37428855895996094, 0.7669258117675781, -0.5882606506347656, 0.8349399566650391, 0.19046585261821747, 0.1615581512451172, -0.3027219772338867, -1.8399429321289062, -0.6423072814941406, -0.6178474426269531, -1.0068044662475586, 0.019614219665527344, -0.8314290046691895, 3.9194107055664062, 0.30528736114501953, -1.0226058959960938, -6.457485198974609, -1.5023927688598633, -0.29390978813171387, -0.23790597915649414, -0.003854036331176758, -0.9694995880126953, -0.030592918395996094, 0.2153606414794922, 0.35896968841552734, -0.4014453887939453, 0.03657197952270508, -0.5870628356933594, -0.643134355545044, 0.06847739219665527, -0.0002818107604980469, -0.3795452117919922, 0.33533191680908203, -0.5831890106201172, -5.45463752746582, -6.042487144470215, 0.6301651000976562, -1.0542621612548828, -0.3006477355957031, 0.1615581512451172, -0.28680896759033203, -0.20616865158081055, 0.7816970348358154, 1.3616962432861328, -0.27072906494140625, 1.793971061706543, -0.17221832275390625, -0.3835334777832031, -0.2233438491821289, -0.06291651725769043, -0.5874748229980469, -11.636922836303711, -0.9162006378173828, 0.4702606201171875, -0.42773914337158203, -0.4415922164916992, -0.3290853500366211, -0.3640749454498291, 0.29404163360595703, -0.01832437515258789, -0.05418205261230469, -0.03265380859375, -0.8490333557128906, 0.052057743072509766, -0.10045623779296875, -0.03435993194580078, 1.1035614013671875, -1.2827260494232178, -0.22685623168945312, -0.5284090042114258, -0.661473274230957, 1.21731698513031, 0.6732158660888672, 0.2442340850830078, -6.21021842956543, 1.2178096771240234, -1.0915889739990234, -0.5003547668457031, -0.22530579566955566, -0.06859540939331055, -0.03180885314941406, -0.7336077690124512, 0.7800521850585938, -0.6714239120483398, 0.08595657348632812, -0.9471883773803711, -0.6674585342407227, 0.9878931045532227, -1.4594974517822266, -0.47858524322509766, -0.002954721450805664, -0.10983848571777344, -0.7377462387084961, -0.20853233337402344], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 99328, "num_env_steps_trained": 368880, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 368880, "last_target_update_ts": 99328, "num_target_updates": 193}, "sampler_results": {"episode_reward_max": 30.42902609705925, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -40.01465714663267, "episode_len_mean": 231.47, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612, -16.189364686608315, 10.228313989937305, 11.710635490715504, -364.3854250907898, -203.04044817388058, 9.971612192690372, -155.47763647139072, -34.32393506169319, -253.62010650336742, 18.369343802332878, 4.600000135600567, 7.799999944865704, -36.23521427065134, -431.01144829392433, 4.000000022351742, 7.964785985648632, 12.064785912632942, -70.63183429837227, 15.482084982097149, 12.110635451972485, -40.22060617804527, -106.02655613422394, -40.585392124950886, 25.526145860552788, 4.342037238180637, 7.720768362283707, -1.4999999403953552, 22.70090265572071, 18.821270868182182], "episode_lengths": [217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222, 232, 206, 229, 357, 308, 233, 269, 214, 301, 200, 230, 200, 240, 385, 220, 195, 193, 243, 176, 230, 236, 274, 243, 203, 224, 202, 232, 216, 189]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565227276683439, "mean_inference_ms": 24.124447479049238, "mean_action_processing_ms": 0.13376946784164045, "mean_env_wait_ms": 4.352486878854485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 30.42902609705925, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -40.01465714663267, "episode_len_mean": 231.47, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.199999794363976, 9.02831394225359, 12.264786027371883, 10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612, -16.189364686608315, 10.228313989937305, 11.710635490715504, -364.3854250907898, -203.04044817388058, 9.971612192690372, -155.47763647139072, -34.32393506169319, -253.62010650336742, 18.369343802332878, 4.600000135600567, 7.799999944865704, -36.23521427065134, -431.01144829392433, 4.000000022351742, 7.964785985648632, 12.064785912632942, -70.63183429837227, 15.482084982097149, 12.110635451972485, -40.22060617804527, -106.02655613422394, -40.585392124950886, 25.526145860552788, 4.342037238180637, 7.720768362283707, -1.4999999403953552, 22.70090265572071, 18.821270868182182], "episode_lengths": [217, 205, 234, 186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222, 232, 206, 229, 357, 308, 233, 269, 214, 301, 200, 230, 200, 240, 385, 220, 195, 193, 243, 176, 230, 236, 274, 243, 203, 224, 202, 232, 216, 189]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565227276683439, "mean_inference_ms": 24.124447479049238, "mean_action_processing_ms": 0.13376946784164045, "mean_env_wait_ms": 4.352486878854485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 368880, "num_env_steps_sampled": 99328, "num_env_steps_trained": 368880, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 99328, "agent_timesteps_total": 99328, "timers": {"training_iteration_time_ms": 340.41, "learn_time_ms": 81.936, "learn_throughput": 2929.12, "synch_weights_time_ms": 20.185}, "counters": {"num_env_steps_sampled": 99328, "num_env_steps_trained": 368880, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 368880, "last_target_update_ts": 99328, "num_target_updates": 193}, "done": false, "episodes_total": 374, "training_iteration": 97, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-26-39", "timestamp": 1655501199, "time_this_iter_s": 5.495968341827393, "time_total_s": 528.3835589885712, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 528.3835589885712, "timesteps_since_restore": 0, "iterations_since_restore": 97, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 27.987499999999997, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0007999999797903001, "mean_q": -3.993414878845215, "min_q": -78.7779541015625, "max_q": 25.30264663696289, "mean_td_error": -0.38637441396713257}, "td_error": [0.5134525299072266, -0.7684712409973145, 0.015207767486572266, 0.4037971496582031, -0.4518423080444336, 1.0997848510742188, -0.2632455825805664, 1.1070623397827148, 0.4408397674560547, 1.1012468338012695, -0.2604055404663086, 1.7413749694824219, 0.6782283782958984, -0.45635223388671875, 0.41351747512817383, 0.48075294494628906, 0.1703791618347168, -2.4124526977539062, 0.012435853481292725, -0.2253246307373047, 0.6329622268676758, 1.2409095764160156, 0.3884906768798828, -0.31684112548828125, 0.32613039016723633, 1.430511474609375e-06, 2.8854446411132812, 0.33889317512512207, -0.36705470085144043, 0.0012539327144622803, 1.521188735961914, 0.1340465545654297, 3.131162643432617, 1.6223621368408203, 0.7008042335510254, 0.043346405029296875, 1.1070623397827148, -0.13325496017932892, -0.14975547790527344, -0.12981176376342773, 0.6020431518554688, -0.16164731979370117, 0.6190733909606934, 10.250211715698242, 0.739349365234375, 4.687355995178223, 1.077134132385254, 0.03703022003173828, 0.053916335105895996, 0.2559328079223633, 0.8138256072998047, -0.31374049186706543, -0.48638105392456055, 1.0814952850341797, -0.17951297760009766, 0.2741231918334961, 3.4085445404052734, 1.885739803314209, 0.019722938537597656, 0.15902328491210938, -0.04707914590835571, -0.25033092498779297, 0.3107720613479614, -0.2929668426513672, -0.010196685791015625, 0.22023296356201172, 0.7281475067138672, -0.2063455581665039, 0.5697402954101562, 0.6645112037658691, 2.200223922729492, 0.0530703067779541, 0.3242931365966797, 0.16652774810791016, 0.33252811431884766, 0.11389410495758057, 0.44298553466796875, -0.2778310775756836, -0.0744333267211914, 1.0814952850341797, 0.570220947265625, -10.209894180297852, -1.7235298156738281, 0.5009760856628418, 0.16187143325805664, -0.1440753936767578, 1.2337517738342285, 0.3653745651245117, 0.6020870208740234, 1.2475696802139282, 0.6918449401855469, -0.7252621650695801, 0.6705455780029297, 0.11905288696289062, 0.5416145324707031, 0.4651947021484375, -5.972953796386719, -2.7851734161376953, -0.17194798588752747, 0.7394132614135742, 1.5161609649658203, -0.1916513442993164, 0.012150764465332031, 0.10706639289855957, -0.10365772247314453, 0.5267934799194336, 0.13767147064208984, 4.378344535827637, 0.15497589111328125, 0.3240375518798828, -0.12123775482177734, 0.1957378387451172, 0.15123653411865234, -8.235074043273926, 1.73486328125, 0.797393798828125, 0.07028484344482422, -10.514580726623535, -3.1488113403320312, 0.1548246145248413, 1.3428936004638672, -0.007239818572998047, -0.1608271598815918, 0.6176567077636719, 0.06872844696044922, 1.7112045288085938, -1.3053417205810547, 0.7111411094665527, 0.08989143371582031, 1.515716552734375, -4.066831588745117, 1.5099296569824219, -4.1089768409729, 0.11389410495758057, 0.05773735046386719, -1.327423095703125, 1.1793718338012695, -10.148994445800781, 0.030927181243896484, 0.2162480354309082, 1.3651046752929688, -31.62659454345703, 0.9637928009033203, 0.08989143371582031, 0.563328742980957, 0.7167792320251465, 0.25159263610839844, -0.08057689666748047, 1.8234338760375977, -1.3487825393676758, -0.019579410552978516, 1.3481979370117188, -0.7861623764038086, 2.207274913787842, 0.9534921646118164, 0.1644601821899414, -0.38207149505615234, 1.4610662460327148, 2.200223922729492, -31.62659454345703, -1.0885353088378906, 0.7017922401428223, -0.04473161697387695, -10.656635284423828, 0.7074775695800781, 0.8637881278991699, -0.02305316925048828, 0.9411020278930664, -0.005991935729980469, 0.16630935668945312, -0.014970779418945312, -0.5002326965332031, -0.08358383178710938, 1.1460342407226562, -0.22727203369140625, 0.3240337371826172, 0.011721611022949219, -0.3359870910644531, 0.7159481048583984, -0.17651748657226562, -0.429551362991333, 0.014783382415771484, 0.5402860641479492, 1.5868701934814453, -0.1483287811279297, 0.7934715747833252, 1.1512088775634766, -0.19323348999023438, -0.3387880325317383, 2.664205551147461, 0.23725509643554688, 0.15273189544677734, 0.5293474197387695, 0.04153919219970703, 2.247509002685547, 0.3172633945941925, 0.09331917762756348, 1.669865369796753, -32.98607635498047, 0.8122959136962891, 0.7059478759765625, 5.28516960144043, 0.2912425994873047, 0.9380359649658203, 0.4817243814468384, -0.6095461845397949, -0.4274568557739258, -0.31072998046875, 1.327012062072754, 0.9064521789550781, 0.0997169017791748, -0.26922035217285156, 0.945220947265625, -0.44191884994506836, 0.08371514081954956, -0.3970381021499634, -8.609643936157227, -0.7318260669708252, -0.41884809732437134, 0.22647714614868164, -11.492435455322266, 1.8319530487060547, 0.0579228401184082, -0.3141789436340332, -0.5467977523803711, 0.1578836441040039, 0.4588298797607422, 0.5109033584594727, -0.031061172485351562, -5.255911827087402, 0.07024085521697998, 0.3196229934692383, -0.28971999883651733, 1.6820068359375, -0.7107486724853516, 0.02635955810546875, -7.325928211212158, 0.5801057815551758, 0.008516311645507812, -0.30957508087158203], "custom_metrics": {}, "num_agent_steps_trained": 240}}, "num_env_steps_sampled": 100352, "num_env_steps_trained": 372720, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 372720, "last_target_update_ts": 100352, "num_target_updates": 195}, "sampler_results": {"episode_reward_max": 30.42902609705925, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -41.73501058369875, "episode_len_mean": 232.02, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612, -16.189364686608315, 10.228313989937305, 11.710635490715504, -364.3854250907898, -203.04044817388058, 9.971612192690372, -155.47763647139072, -34.32393506169319, -253.62010650336742, 18.369343802332878, 4.600000135600567, 7.799999944865704, -36.23521427065134, -431.01144829392433, 4.000000022351742, 7.964785985648632, 12.064785912632942, -70.63183429837227, 15.482084982097149, 12.110635451972485, -40.22060617804527, -106.02655613422394, -40.585392124950886, 25.526145860552788, 4.342037238180637, 7.720768362283707, -1.4999999403953552, 22.70090265572071, 18.821270868182182, -56.48539174348116, 22.787006095051765, -106.84385829418898], "episode_lengths": [186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222, 232, 206, 229, 357, 308, 233, 269, 214, 301, 200, 230, 200, 240, 385, 220, 195, 193, 243, 176, 230, 236, 274, 243, 203, 224, 202, 232, 216, 189, 257, 207, 247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5561631235356352, "mean_inference_ms": 24.14319664690367, "mean_action_processing_ms": 0.13390832823849266, "mean_env_wait_ms": 4.356828162055619, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 30.42902609705925, "episode_reward_min": -661.3859105333686, "episode_reward_mean": -41.73501058369875, "episode_len_mean": 232.02, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.000000096857548, -9.399999774992466, -156.4776367470622, 10.728313989937305, 9.099999733269215, 18.50090266764164, 3.700000077486038, 8.499999895691872, -43.38539195805788, -24.88936445862055, -25.47278581559658, 2.8000001311302185, 19.508541472256184, 8.90924771875143, -1.6999999955296516, -5.299999982118607, 29.49927667528391, -60.2853919416666, -37.870396353304386, 14.507755532860756, 10.723855219781399, -53.87475661188364, 3.900000035762787, -21.41072976589203, -350.20041017234325, -103.78292558342218, 8.264786005020142, -661.3859105333686, -17.631971515715122, 18.4212708696723, 27.647019527852535, 30.42902609705925, -442.6471117064357, 0.7000000104308128, 14.033398061990738, 10.537830092012882, -62.84352984279394, 6.299999907612801, 22.55076728761196, -21.28539165854454, 15.29309992492199, 16.121270895004272, 6.5000002309679985, -361.3370727598667, -141.21119549125433, -23.085391841828823, -30.385391913354397, 17.575421415269375, 17.429571829736233, -17.50000014156103, 24.31839084625244, 16.610635355114937, -3.299999989569187, 19.521270863711834, 1.7000000402331352, -12.13524915277958, -6.08677975833416, -84.80858777463436, -16.499999962747097, 3.600000038743019, 4.400000222027302, 21.211538150906563, -32.22772414237261, 7.010635405778885, -61.67078386247158, -30.80000000447035, 9.310635395348072, -22.09675060212612, -16.189364686608315, 10.228313989937305, 11.710635490715504, -364.3854250907898, -203.04044817388058, 9.971612192690372, -155.47763647139072, -34.32393506169319, -253.62010650336742, 18.369343802332878, 4.600000135600567, 7.799999944865704, -36.23521427065134, -431.01144829392433, 4.000000022351742, 7.964785985648632, 12.064785912632942, -70.63183429837227, 15.482084982097149, 12.110635451972485, -40.22060617804527, -106.02655613422394, -40.585392124950886, 25.526145860552788, 4.342037238180637, 7.720768362283707, -1.4999999403953552, 22.70090265572071, 18.821270868182182, -56.48539174348116, 22.787006095051765, -106.84385829418898], "episode_lengths": [186, 229, 268, 216, 239, 226, 187, 189, 234, 227, 248, 226, 186, 177, 187, 205, 196, 256, 218, 223, 244, 239, 209, 232, 331, 292, 209, 423, 243, 191, 205, 179, 374, 196, 223, 229, 230, 219, 194, 217, 218, 225, 227, 343, 297, 213, 206, 223, 217, 231, 219, 207, 194, 226, 198, 214, 248, 284, 205, 217, 215, 227, 236, 231, 255, 232, 179, 222, 232, 206, 229, 357, 308, 233, 269, 214, 301, 200, 230, 200, 240, 385, 220, 195, 193, 243, 176, 230, 236, 274, 243, 203, 224, 202, 232, 216, 189, 257, 207, 247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5561631235356352, "mean_inference_ms": 24.14319664690367, "mean_action_processing_ms": 0.13390832823849266, "mean_env_wait_ms": 4.356828162055619, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 372720, "num_env_steps_sampled": 100352, "num_env_steps_trained": 372720, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 3840, "timesteps_total": 100352, "agent_timesteps_total": 100352, "timers": {"training_iteration_time_ms": 349.469, "learn_time_ms": 83.393, "learn_throughput": 2877.924, "synch_weights_time_ms": 20.587}, "counters": {"num_env_steps_sampled": 100352, "num_env_steps_trained": 372720, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 372720, "last_target_update_ts": 100352, "num_target_updates": 195}, "done": true, "episodes_total": 377, "training_iteration": 98, "trial_id": "1e1d3_00002", "experiment_id": "28a225f5320b4c578d8d44786d90232c", "date": "2022-06-18_00-26-45", "timestamp": 1655501205, "time_this_iter_s": 5.46575140953064, "time_total_s": 533.8493103981018, "pid": 11060, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0008, "train_batch_size": 240, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 240}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 533.8493103981018, "timesteps_since_restore": 0, "iterations_since_restore": 98, "warmup_time": 16.78898787498474, "perf": {"cpu_util_percent": 28.25, "ram_util_percent": 65.23750000000001}}
