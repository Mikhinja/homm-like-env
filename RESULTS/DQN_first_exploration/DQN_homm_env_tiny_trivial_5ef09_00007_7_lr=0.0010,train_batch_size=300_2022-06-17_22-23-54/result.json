{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": -0.3156706690788269, "min_q": -1.7673499584197998, "max_q": 1.0981976985931396, "mean_td_error": -0.8135331273078918}, "td_error": [-0.9459049105644226, -1.1351062059402466, -0.5500433444976807, -1.827575445175171, -1.198266625404358, 0.8533741235733032, -0.6847841143608093, -0.9939630031585693, -2.1067545413970947, -0.8324777483940125, -1.6737933158874512, -2.1741745471954346, -1.0714296102523804, -0.2570730447769165, -2.5038766860961914, -0.5001923441886902, -1.208784580230713, -1.208784580230713, -0.8590647578239441, 0.31635433435440063, -1.687932014465332, -0.8815658688545227, -0.8954734802246094, -0.45472872257232666, -1.725679636001587, -5.604488849639893, -1.0450286865234375, -1.5766010284423828, -0.3467264473438263, -1.1402943134307861, -1.084373116493225, -0.8167231678962708, -2.1096434593200684, -1.8146361112594604, -0.8924962878227234, -1.802331805229187, -0.5659898519515991, -1.0700829029083252, -1.1965625286102295, -1.1908173561096191, 0.9590411186218262, -1.0260049104690552, -1.3703758716583252, -0.33186769485473633, -2.1152350902557373, -11.001142501831055, -1.637970209121704, 1.5230114459991455, -1.583725094795227, -0.7841479182243347, -1.2801294326782227, 0.5830342769622803, -1.6407337188720703, -0.8470529913902283, -0.512642502784729, -1.7728631496429443, -1.4878325462341309, -1.1511309146881104, -0.772392213344574, -2.17812442779541, -2.1159749031066895, -0.34617114067077637, -0.47648048400878906, -1.7105544805526733, -1.2801294326782227, -0.3834672272205353, -2.205458164215088, -0.10499453544616699, -0.8333296775817871, -2.179091215133667, -1.6371636390686035, -1.2700403928756714, 0.30696558952331543, -0.7899554967880249, 1.3318339586257935, -0.7686979174613953, -0.94869464635849, -1.2442677021026611, -1.2562626600265503, -2.195497512817383, -0.33933183550834656, -0.7299205660820007, -0.6038315296173096, -1.5029442310333252, -1.5055732727050781, 0.34214556217193604, -0.24406394362449646, -2.17812442779541, -1.8568649291992188, -1.1983489990234375, -1.0453567504882812, -0.2639681398868561, -1.8398075103759766, -1.2839983701705933, -0.1509190797805786, 1.4359551668167114, -1.6371636390686035, 1.6691302061080933, -0.7712582945823669, -0.4795691668987274, -1.547912836074829, -0.5208683013916016, -0.6305669546127319, -1.4522783756256104, -0.9788150787353516, -0.10499453544616699, 0.5470225811004639, -1.6802709102630615, -0.24128688871860504, -1.931895136833191, 1.3423094749450684, -1.391427755355835, -1.1911394596099854, -1.1666094064712524, -2.4659271240234375, -0.2898072600364685, -0.7647421360015869, 2.566993236541748, -0.8377811908721924, -1.7654578685760498, -0.46759095788002014, 4.51225471496582, -0.15594881772994995, -1.4294748306274414, -1.0657062530517578, -2.263380289077759, 0.11066043376922607, -0.5521825551986694, -0.8652858734130859, 1.6691302061080933, -0.9163297414779663, -1.5923852920532227, 1.4460501670837402, -2.8971896171569824, 1.1664009094238281, -1.282390832901001, -0.5076248645782471, 0.0023906826972961426, -1.1672470569610596, -1.074417233467102, -1.3952651023864746, -1.1996634006500244, -1.1273553371429443, -0.6271412968635559, -1.2251830101013184, -0.05772858113050461, 0.46102553606033325, 0.013094663619995117, -0.713636577129364, 0.4685063362121582, -0.6158300042152405, -0.9232881665229797, -1.5923082828521729, -1.1273553371429443, -1.291811227798462, 0.9464694261550903, -1.7753642797470093, 0.527286171913147, -1.1113216876983643, -0.8590647578239441, -2.205458164215088, 1.3548033237457275, 4.51225471496582, -0.8924962878227234, -0.3938789963722229, -1.0640841722488403, -0.7339544892311096, -1.1996634006500244, 0.48922306299209595, -1.0576472282409668, -1.0664253234863281, -0.5500433444976807, -2.17812442779541, -1.3807071447372437, 1.0073285102844238, -0.9545081257820129, -0.6729192137718201, -0.19622769951820374, -1.9492862224578857, -0.8055893778800964, -0.4149487018585205, -1.748734474182129, -0.8587858080863953, -1.2562531232833862, 1.933868408203125, 1.1250981092453003, -1.9911346435546875, -0.48177969455718994, -0.9079322218894958, -1.6784913539886475, -0.8167231678962708, -2.5182301998138428, -1.0640841722488403, 0.11066043376922607, -0.99866783618927, -0.2902531623840332, -1.2562531232833862, 0.3396151065826416, -0.998436450958252, -1.0073580741882324, -0.9079322218894958, -2.222914934158325, -1.758779764175415, -1.509613037109375, -1.0073580741882324, -1.6249030828475952, -2.403856039047241, -1.0314030647277832, -1.9481395483016968, -1.5280065536499023, -2.2502264976501465, 0.4873692989349365, 1.4964728355407715, -2.075082540512085, -0.9921955466270447, -1.7960803508758545, -1.7175012826919556, -1.8891620635986328, -1.3703758716583252, 1.955377221107483, -0.17443764209747314, -0.4990122318267822, -0.12642395496368408, -1.963731288909912, -1.559152364730835, 0.0023906826972961426, -1.0108240842819214, 0.7654279470443726, -1.7809748649597168, 1.6044107675552368, -1.0714296102523804, -0.6628180146217346, -0.9706020355224609, -1.213526964187622, -0.11272019147872925, -1.3827840089797974, -0.4232769012451172, 0.5470225811004639, -1.7732319831848145, -0.04024767875671387, -0.6534253358840942, 0.8533741235733032, -1.1402943134307861, -1.0847145318984985, -0.7317249774932861, -2.864346504211426, -1.385086178779602, 0.530813455581665, 0.6013278961181641, -0.9706020355224609, -0.47861218452453613, -0.3467264473438263, 1.0833553075790405, -0.4767564833164215, -0.9726358652114868, -0.7120968103408813, -1.9834986925125122, -1.4853941202163696, 0.9464694261550903, 1.6543148756027222, 0.22164684534072876, -1.1763423681259155, -1.0081567764282227, -1.8773747682571411, -0.7120968103408813, 1.6481828689575195, -0.26057112216949463, -1.8773747682571411, -1.8475048542022705, 1.6044107675552368, -4.835664749145508, -1.751692771911621, -0.2902531623840332, -0.9576183557510376, -0.3834672272205353, -1.6407337188720703, 1.3993690013885498, -1.348122239112854, 1.6723021268844604, -0.24279272556304932, -1.9702723026275635, -2.1473875045776367, -1.6371636390686035, -1.4522783756256104, -1.920969843864441, -1.931895136833191, -1.5055732727050781, 1.0150656700134277, 0.5881344079971313, -1.0903162956237793, 2.566993236541748, -1.0314030647277832, 0.30696558952331543, 1.0240046977996826, -1.021226167678833, -1.1638861894607544, -2.1299362182617188, -0.5547303557395935, 0.4487929344177246, -0.2705785632133484], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 300, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 300, "last_target_update_ts": 1024, "num_target_updates": 1}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 300, "num_env_steps_sampled": 1024, "num_env_steps_trained": 300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 300, "timesteps_total": 1024, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 184.268, "learn_time_ms": 87.404, "learn_throughput": 3432.327, "synch_weights_time_ms": 20.093}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 300, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 300, "last_target_update_ts": 1024, "num_target_updates": 1}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-24-26", "timestamp": 1655493866, "time_this_iter_s": 3.301987886428833, "time_total_s": 3.301987886428833, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 3.301987886428833, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 49.239999999999995, "ram_util_percent": 57.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 3.698369026184082, "min_q": 0.910138726234436, "max_q": 5.772342681884766, "mean_td_error": 0.44813716411590576}, "td_error": [0.0958712100982666, -0.37671613693237305, 1.6932156085968018, 2.7410812377929688, 3.238063097000122, 0.06256604194641113, 0.9808194637298584, -0.20327329635620117, 0.5102412700653076, 1.4418559074401855, 2.4024291038513184, 1.7088878154754639, 2.914625406265259, -0.22730517387390137, 2.8648200035095215, 0.35845446586608887, 0.25647568702697754, 0.797656774520874, 0.4568910598754883, 2.885908842086792, 1.6784954071044922, 2.3661067485809326, 0.2983059883117676, -0.30947065353393555, 0.6810569763183594, -0.35088348388671875, -0.4726269245147705, -0.6012856960296631, 2.4341518878936768, 0.1772017478942871, -0.0050220489501953125, -0.5350475311279297, 1.427535057067871, 1.5776104927062988, 0.9583115577697754, 0.40796875953674316, 2.116929531097412, 2.5001044273376465, -0.0007672309875488281, 1.1801609992980957, 0.23738360404968262, 0.6077566146850586, -4.623039245605469, 0.404496431350708, 0.06588554382324219, 0.05896568298339844, 2.2484259605407715, -0.7959749698638916, 2.1817312240600586, 2.7943878173828125, -4.464175701141357, 0.3207433223724365, -0.22140097618103027, -0.7077541351318359, 0.7022848129272461, 2.9659671783447266, 0.5865116119384766, 1.0230088233947754, -10.303375244140625, 0.4180901050567627, 0.2582240104675293, -0.7959749698638916, -0.11706042289733887, 0.857440710067749, 0.5897443294525146, -0.34195399284362793, 0.6356542110443115, -0.7267255783081055, 0.700359582901001, 2.508699655532837, 0.06367659568786621, 0.3430445194244385, 1.2857568264007568, 0.6279861927032471, -0.29331111907958984, -0.27884984016418457, -0.009730815887451172, 1.3978381156921387, 0.23738360404968262, 2.143456220626831, 2.667830228805542, 0.010329008102416992, -0.38990020751953125, -4.623039245605469, -10.319437026977539, 0.45594215393066406, 0.29221034049987793, -0.44733738899230957, -10.319437026977539, -0.2690236568450928, 1.7098894119262695, 0.2143082618713379, 1.7123680114746094, 1.1213829517364502, 0.6008560657501221, -0.2041182518005371, 0.028064966201782227, 1.9837310314178467, 1.0230088233947754, 2.143456220626831, 2.1929733753204346, 0.33638954162597656, 2.367816686630249, 1.0084378719329834, -0.23764824867248535, 1.6097238063812256, 0.6447567939758301, 1.0455036163330078, 0.09496903419494629, -0.17567014694213867, -0.6301994323730469, 2.908691883087158, 1.1470246315002441, 1.0278284549713135, 0.21080851554870605, -5.177676200866699, 2.4409828186035156, -0.028880834579467773, 0.2971343994140625, 0.21857523918151855, 0.5683112144470215, 0.37929725646972656, 0.2714569568634033, 2.556638717651367, 0.16317057609558105, 2.896125078201294, 0.5940406322479248, 0.8845083713531494, 3.126316547393799, 2.5981926918029785, -4.776764869689941, -0.24271106719970703, -0.6142089366912842, -0.08367204666137695, 0.5019845962524414, -9.941146850585938, 0.5598030090332031, 0.1772017478942871, -0.5145165920257568, -0.2957921028137207, 0.05392193794250488, 0.5586326122283936, 0.5336818695068359, 0.03470611572265625, -1.111238718032837, 0.581878662109375, 0.39650416374206543, 0.2689497470855713, -5.20879602432251, -1.4393105506896973, 0.6501603126525879, 0.062422752380371094, 0.34776973724365234, 0.48751401901245117, 1.2249977588653564, 0.44405269622802734, 0.13112711906433105, -0.24271106719970703, -0.058923959732055664, -4.240665435791016, 1.2413959503173828, 0.09563612937927246, 1.6248106956481934, 1.6699943542480469, 2.1710216999053955, -0.4725501537322998, -0.2957921028137207, 0.38922977447509766, 1.5097228288650513, 1.8168237209320068, -0.013377666473388672, 0.14289307594299316, 1.5329279899597168, -0.7368016242980957, 2.1998131275177, -0.5262227058410645, 1.488353967666626, 0.5439388751983643, -0.8072550296783447, 0.49485301971435547, 1.0947058200836182, 2.9659671783447266, 1.215353012084961, 0.355712890625, 0.7236084938049316, 2.143456220626831, 2.1382851600646973, 2.42879581451416, -0.7405376434326172, 0.5016937255859375, -0.16792082786560059, 1.9865493774414062, 0.16317248344421387, 0.40796875953674316, -0.7040653228759766, 1.1092092990875244, -0.02159571647644043, 0.9541168212890625, 2.3278892040252686, 1.0084378719329834, -0.007227897644042969, 2.0958588123321533, 0.2477283477783203, -4.863510608673096, -0.4312100410461426, 2.734724998474121, -0.3421928882598877, 2.8181469440460205, -1.0069525241851807, -0.5792274475097656, 2.1710216999053955, 0.6447567939758301, 0.360872745513916, -0.0057582855224609375, 3.126316547393799, -0.21733689308166504, -0.5727791786193848, 2.2052385807037354, 2.169978380203247, -9.941146850585938, 0.8446741104125977, 1.6426506042480469, 0.2782125473022461, 0.848933219909668, 2.143456220626831, 0.247711181640625, 1.1771185398101807, 1.638521671295166, 1.7585830688476562, 1.4790549278259277, 0.5548346042633057, 0.9113457202911377, -0.37671613693237305, 0.19339871406555176, 0.07264900207519531, -1.190006971359253, 3.0478198528289795, -0.18393993377685547, 0.5841059684753418, 2.508699655532837, 0.6693086624145508, 0.41219067573547363, 0.7477139234542847, -0.007729291915893555, -0.05734848976135254, 0.4324789047241211, 0.6079592704772949, 0.9583115577697754, -0.09067702293395996, 2.3780739307403564, 2.3278892040252686, 1.7358365058898926, 0.23679590225219727, -0.09868097305297852, 1.4343574047088623, 1.3855295181274414, -0.0788431167602539, 1.5385091304779053, 0.9964470863342285, 1.355072021484375, -1.7635602951049805, -0.46654748916625977, -0.4706912040710449, -0.4915342330932617, 2.8990797996520996, 0.24744296073913574, 1.488353967666626, -6.995355129241943, 3.3550620079040527, 1.1329009532928467, 2.213082790374756, -0.5348961353302002, 2.908691883087158, 2.8047280311584473, 1.5385091304779053, 0.30699968338012695, 0.3425769805908203, 0.2840993404388428, 0.47338438034057617, -0.32706236839294434, 2.362342119216919, 1.3130502700805664, 1.0377652645111084, 2.7055912017822266, 2.4579660892486572, 0.24748635292053223, -0.18990874290466309, 0.19865870475769043, 2.1998131275177, -0.3090190887451172, 0.3343977928161621, 0.14374136924743652, 0.2757692337036133, 1.6784954071044922, 2.558375358581543, 1.4967786073684692, 2.3322017192840576, 0.7283425331115723, -0.29331111907958984, 0.8930020332336426], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 5100, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 5100, "last_target_update_ts": 2048, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 5100, "num_env_steps_sampled": 2048, "num_env_steps_trained": 5100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 2048, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 354.509, "learn_time_ms": 60.651, "learn_throughput": 4946.364, "synch_weights_time_ms": 19.589}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 5100, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 5100, "last_target_update_ts": 2048, "num_target_updates": 3}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-24-32", "timestamp": 1655493872, "time_this_iter_s": 5.596330165863037, "time_total_s": 8.89831805229187, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 8.89831805229187, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.299999999999997, "ram_util_percent": 58.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 4.919503211975098, "min_q": 1.920893907546997, "max_q": 7.131685733795166, "mean_td_error": 0.5014459490776062}, "td_error": [1.9856786727905273, 1.776198387145996, 1.9371132850646973, 0.8120753765106201, -5.05940580368042, 2.2182435989379883, 1.7592487335205078, -0.24493026733398438, 0.7555570602416992, -6.826883316040039, -0.14214229583740234, 2.2328262329101562, -0.5741496086120605, -0.12863445281982422, 2.4700770378112793, -1.259641170501709, 0.9293789863586426, 2.4945058822631836, -0.34706544876098633, 0.9772286415100098, 0.301666259765625, -1.8176465034484863, 1.7576799392700195, 1.7977218627929688, -0.05530548095703125, 0.10204291343688965, 0.3935127258300781, 1.7977218627929688, 0.07605123519897461, 2.0146021842956543, 2.3943042755126953, 0.7692389488220215, 0.4890451431274414, -0.21292781829833984, -0.75486159324646, 0.7082729339599609, -4.666481971740723, -0.8495597839355469, 2.3386282920837402, 0.14345550537109375, 0.3935127258300781, -0.5156044960021973, 1.733457088470459, 0.5288324356079102, -4.077168941497803, -0.30739450454711914, 1.1163983345031738, 2.3143486976623535, 0.8120753765106201, 2.7028379440307617, 0.3015456199645996, 0.31873655319213867, 2.7028379440307617, 0.35044288635253906, 1.290666103363037, 0.8457307815551758, 0.5751256942749023, 2.4123706817626953, -0.16414690017700195, 1.1033916473388672, 0.8154692649841309, -0.5635571479797363, 0.505040168762207, 0.49978017807006836, -1.259641170501709, -0.2673368453979492, -0.11244440078735352, -0.9101691246032715, 0.2230520248413086, -0.5262956619262695, -0.7329597473144531, 0.4725632667541504, 0.5948381423950195, 1.7576799392700195, 1.7576799392700195, 2.031594753265381, 0.09053277969360352, 1.9956073760986328, 2.5216116905212402, -0.018892288208007812, 5.46571159362793, 0.20006370544433594, -0.7107596397399902, 0.043695926666259766, 2.2561416625976562, 0.6851024627685547, 0.2320094108581543, 1.8338489532470703, 0.28203868865966797, -0.1221003532409668, 1.7464532852172852, 0.5662484169006348, 0.34287309646606445, 0.4389052391052246, 0.49364686012268066, 2.129725933074951, -10.023462295532227, 0.022747039794921875, -0.14069604873657227, 0.2792387008666992, -0.956942081451416, 0.6939091682434082, 0.4271976947784424, 0.7771816253662109, -0.13093161582946777, -0.2530336380004883, 1.0116405487060547, 2.0712780952453613, -0.03535127639770508, -6.347003936767578, 1.9371132850646973, 0.11285066604614258, 0.08210563659667969, -0.20728206634521484, 2.0062170028686523, 1.6652355194091797, -0.1330885887145996, -0.7487702369689941, 0.9370875358581543, 1.1222267150878906, -0.2972297668457031, -0.6128616333007812, 0.5276060104370117, 2.455644130706787, -0.12143325805664062, 0.3295717239379883, -0.2669804096221924, 0.1828165054321289, 0.27310895919799805, -0.12677812576293945, -0.6552939414978027, 0.38156795501708984, -0.7610101699829102, -4.885713577270508, -0.05530548095703125, 0.4292745590209961, 0.6210484504699707, 0.7994613647460938, 1.2265236377716064, 2.4945058822631836, 0.6597142219543457, 2.0062170028686523, 0.3654365539550781, 2.1510562896728516, 3.314784049987793, 0.564488410949707, 0.7425475120544434, 1.9793291091918945, 0.2658686637878418, -0.47811079025268555, 2.4554810523986816, 1.9646143913269043, 0.8286337852478027, 2.00614595413208, -0.5201411247253418, -0.1070108413696289, -0.9617805480957031, 0.5171289443969727, 1.2265236377716064, 2.031594753265381, 3.2951102256774902, 1.2270762920379639, 0.44414281845092773, -6.185311317443848, 2.2209978103637695, -0.27044105529785156, -4.556550025939941, 0.3509540557861328, -0.47811079025268555, -0.1096339225769043, -0.8471963405609131, 1.9172558784484863, -0.01850605010986328, 2.5282654762268066, -0.3107638359069824, 0.12833786010742188, 0.5196771621704102, 0.939570426940918, -0.25993919372558594, 1.6822991371154785, 0.5872282981872559, -0.48163604736328125, 1.8718342781066895, 1.5215802192687988, -0.349550724029541, 2.245553970336914, -0.447817325592041, 1.5215802192687988, 0.8553104400634766, 2.388284921646118, 2.455644130706787, 1.93049955368042, 2.1291651725769043, 0.2522268295288086, -5.253158092498779, 0.19628310203552246, 2.166989803314209, -0.08275175094604492, 2.2879014015197754, 0.1946706771850586, 0.26782751083374023, 0.6124324798583984, -6.2322564125061035, 3.020261764526367, 0.7391524314880371, -0.13567352294921875, 2.256524085998535, 0.7205591201782227, 2.418700695037842, 0.5977058410644531, 0.2320094108581543, 0.3061642646789551, -0.16917800903320312, -0.20859050750732422, 2.1089468002319336, 2.5830321311950684, 1.895521640777588, 0.5305566787719727, -0.11331844329833984, 0.07567739486694336, 2.578948497772217, -0.2150588035583496, -0.3925495147705078, -0.27044105529785156, 0.5858111381530762, -0.4248170852661133, 1.9691424369812012, -0.47850513458251953, 0.7908799648284912, 0.43967771530151367, 2.4435248374938965, -0.6674017906188965, 0.3273134231567383, 0.5467290878295898, 2.5216116905212402, 0.053137779235839844, 1.6961359977722168, -0.41408252716064453, 2.6177592277526855, 2.4797568321228027, -0.6342458724975586, -10.074621200561523, 2.2561416625976562, -0.1618647575378418, 0.5482149124145508, 2.462686061859131, 1.646052360534668, 0.683112621307373, 2.72282075881958, 2.5216116905212402, 1.8419194221496582, 1.87813138961792, 0.5222563743591309, 1.8386163711547852, -6.347003936767578, 0.8414425849914551, 0.5291547775268555, -0.404660701751709, 2.719526767730713, -0.2172713279724121, 0.4099698066711426, -0.24991559982299805, 0.0951089859008789, 0.2498617172241211, 2.4945058822631836, 0.35210561752319336, 0.4561433792114258, -1.216677188873291, 2.011063575744629, 0.2028651237487793, 2.291153907775879, 0.24970531463623047, 2.9275503158569336, 0.03153514862060547, 0.08695793151855469, 0.8967108726501465, 1.9147639274597168, 0.1851344108581543, 1.9691424369812012, 0.3435821533203125, 0.21770668029785156, 2.069394826889038, -0.8442409038543701, 1.5549407005310059, -0.5484099388122559, 2.8302292823791504, 0.5797553062438965, 0.35875988006591797, 2.5830321311950684, -5.05940580368042, 0.3814074993133545, 0.3437676429748535, 0.707493782043457, 0.049829959869384766, 0.9398412704467773, 1.6413278579711914, 2.7165699005126953, 2.229013442993164, 1.9005727767944336, 0.1995077133178711], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 9900, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 9900, "last_target_update_ts": 3072, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 9900, "num_env_steps_sampled": 3072, "num_env_steps_trained": 9900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 3072, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 327.241, "learn_time_ms": 61.276, "learn_throughput": 4895.848, "synch_weights_time_ms": 19.789}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 9900, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 9900, "last_target_update_ts": 3072, "num_target_updates": 5}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-24-37", "timestamp": 1655493877, "time_this_iter_s": 5.059575319290161, "time_total_s": 13.957893371582031, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 13.957893371582031, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 33.42857142857143, "ram_util_percent": 58.285714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 5.370728015899658, "min_q": 2.1020569801330566, "max_q": 7.05833101272583, "mean_td_error": 0.05373666062951088}, "td_error": [1.7427411079406738, 0.19466209411621094, -0.29749298095703125, 0.1486363410949707, -0.8526768684387207, -8.077444076538086, 1.1192340850830078, 1.246856689453125, -0.9401822090148926, -0.7004985809326172, -0.2663125991821289, -0.9575843811035156, 0.07390975952148438, -0.024946212768554688, 1.8985662460327148, 1.1204469203948975, 1.8739309310913086, -0.19786834716796875, 1.8668622970581055, -0.8604357242584229, -5.719982147216797, 1.605264663696289, -0.2639608383178711, -5.478521347045898, -0.46188831329345703, 0.8682200908660889, -0.9889621734619141, -0.5363559722900391, -5.478521347045898, 1.2344884872436523, 0.13196182250976562, 2.155773878097534, -0.39647626876831055, 0.1028757095336914, 0.22148656845092773, 0.19619417190551758, -0.42156553268432617, -0.777653694152832, 1.6279778480529785, 0.19966411590576172, -0.8621511459350586, -1.0277323722839355, 0.3024110794067383, -0.3807339668273926, 1.9779281616210938, 1.5194220542907715, 1.731400966644287, 1.696427345275879, -0.1968393325805664, 0.1416640281677246, 2.0051937103271484, 1.9158778190612793, 0.10218429565429688, -0.3833351135253906, 2.1404776573181152, 1.397263526916504, -1.065002679824829, 1.410275936126709, 1.4919791221618652, 0.5975704193115234, 1.731400966644287, -0.32506895065307617, 1.557511806488037, -10.219900131225586, 1.920893669128418, 1.410275936126709, -0.7327814102172852, -0.865532398223877, -0.9487180709838867, 2.646787643432617, -0.5398979187011719, -1.3023185729980469, -1.444108486175537, 0.24329519271850586, -0.7257342338562012, 1.8405370712280273, -0.35942792892456055, -0.569511890411377, 0.1559920310974121, -4.722142696380615, -0.8943266868591309, -0.6857562065124512, -0.48366451263427734, 0.9767088890075684, 1.168043613433838, 0.3163142204284668, -0.07911300659179688, 0.34372568130493164, -0.07821369171142578, -0.008520126342773438, -0.34150123596191406, 1.4927592277526855, -0.642059326171875, 0.9590001106262207, 2.342155933380127, 0.026892423629760742, -0.566826343536377, 1.420778751373291, 1.827519416809082, -0.03344869613647461, 1.5582208633422852, -0.19786834716796875, -0.3518047332763672, -4.78311014175415, -0.0672450065612793, -6.876925468444824, -0.8979959487915039, 1.7362823486328125, 0.9534091949462891, -0.691253662109375, 0.8765220642089844, 0.2513437271118164, 1.7427411079406738, 1.4118032455444336, -0.8168749809265137, -1.1348657608032227, 0.06590127944946289, 0.13493967056274414, 2.2432289123535156, 1.4685077667236328, 1.564849853515625, -0.2971172332763672, 0.005557060241699219, 1.9488110542297363, 2.0063982009887695, 1.5845732688903809, -0.8743319511413574, 1.2689461708068848, 0.011304378509521484, -0.4796290397644043, 1.4919791221618652, 1.9506220817565918, 1.473890781402588, -0.8382034301757812, -0.8918328285217285, -0.03344869613647461, -1.0707025527954102, 0.034152984619140625, -0.7363626956939697, -5.526375770568848, 2.0051937103271484, 2.3265256881713867, 0.37653112411499023, -0.8292162418365479, 0.5381250381469727, 1.5747156143188477, -0.872199535369873, 2.1155285835266113, 1.6842007637023926, -0.5170469284057617, -0.9094216823577881, 1.8985662460327148, -0.07095050811767578, 0.34508657455444336, 1.5132126808166504, -10.029428482055664, 2.342155933380127, -4.722142696380615, 0.07787942886352539, 2.1117262840270996, -0.7710199356079102, -0.5816140174865723, 2.1099138259887695, 2.482285976409912, 1.4685077667236328, -0.4635601043701172, 2.32658052444458, 2.0999832153320312, 0.474822998046875, 0.06717348098754883, -0.7071590423583984, 0.28705263137817383, 1.9451141357421875, 1.9822921752929688, -0.1985912322998047, 0.39903688430786133, -0.4512033462524414, 1.5039572715759277, 0.9662809371948242, 0.1451568603515625, -0.8113510608673096, -0.9094171524047852, -1.1111741065979004, 2.123140335083008, -1.2160935401916504, -0.5335178375244141, -0.10250234603881836, 5.79054069519043, -0.38053131103515625, 0.26764869689941406, -0.3489093780517578, 1.6647677421569824, -1.0774846076965332, -0.7569379806518555, 1.4685077667236328, -0.7746825218200684, 1.1725094318389893, 2.3166861534118652, -0.4571719169616699, 0.1436920166015625, 0.1999053955078125, 2.001312732696533, -5.478521347045898, 1.4780664443969727, -4.8724684715271, 1.5387649536132812, 1.6147260665893555, -0.6508908271789551, 1.733952522277832, 1.5039572715759277, 1.6435637474060059, 1.457338809967041, -1.0197701454162598, -0.8197846412658691, 2.191300868988037, -0.01794719696044922, 1.4919791221618652, 0.15357637405395508, -0.2283644676208496, -0.45794153213500977, -0.4741373062133789, 0.31687164306640625, -0.25644969940185547, -5.323139667510986, 1.3238086700439453, 1.6128597259521484, 1.6392631530761719, -0.3190574645996094, -0.2915315628051758, 1.4718842506408691, 0.12974929809570312, -0.012479305267333984, -0.5985965728759766, -1.3907701969146729, -0.7710199356079102, 0.41535425186157227, 0.04639244079589844, -0.5107536315917969, 1.9488110542297363, 0.31461191177368164, 1.5363311767578125, -0.034050941467285156, 1.733952522277832, 0.3483157157897949, -1.0952188968658447, -0.6745467185974121, -0.3831911087036133, 0.08739089965820312, -0.9407997131347656, 0.4039878845214844, -0.6859550476074219, -4.791024684906006, 0.21344804763793945, -1.4261870384216309, -1.2340693473815918, -1.3049321174621582, 1.6176142692565918, -4.964268207550049, -0.01057291030883789, 0.8488988876342773, -1.0746541023254395, 1.7451579570770264, 0.36836910247802734, 1.9506220817565918, -1.037552833557129, 1.794853687286377, 0.002048015594482422, 0.11885309219360352, 0.1476001739501953, -0.794654369354248, -1.045534610748291, 2.278076171875, -0.3618636131286621, -1.432981252670288, -0.9313797950744629, 1.732496738433838, 0.24795818328857422, -0.4232320785522461, -0.5121088027954102, -0.779259204864502, -0.9876742362976074, 1.5709834098815918, -0.2823653221130371, 0.40767812728881836, 1.6705503463745117, -0.5253810882568359, 2.1456875801086426, -0.6674270629882812, -0.43710994720458984, 1.4818367958068848, 0.24571609497070312, 2.010913372039795, 0.17908287048339844, 2.191812515258789, 0.09100198745727539, -11.048820495605469, 2.343482494354248, 1.504190444946289, 1.507981300354004, 0.7599635124206543], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 14700, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 14700, "last_target_update_ts": 4096, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": -25.12009185552597, "episode_reward_min": -76.58677984774113, "episode_reward_mean": -47.587496613152325, "episode_len_mean": 246.625, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6033288829521446, "mean_inference_ms": 21.930969294870874, "mean_action_processing_ms": 0.1546079546561037, "mean_env_wait_ms": 5.470177774763293, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -25.12009185552597, "episode_reward_min": -76.58677984774113, "episode_reward_mean": -47.587496613152325, "episode_len_mean": 246.625, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6033288829521446, "mean_inference_ms": 21.930969294870874, "mean_action_processing_ms": 0.1546079546561037, "mean_env_wait_ms": 5.470177774763293, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 14700, "num_env_steps_sampled": 4096, "num_env_steps_trained": 14700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 4096, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 335.979, "learn_time_ms": 60.216, "learn_throughput": 4982.086, "synch_weights_time_ms": 19.589}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 14700, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 14700, "last_target_update_ts": 4096, "num_target_updates": 7}, "done": false, "episodes_total": 8, "training_iteration": 4, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-24-42", "timestamp": 1655493882, "time_this_iter_s": 5.204913377761841, "time_total_s": 19.162806749343872, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 19.162806749343872, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 29.950000000000003, "ram_util_percent": 58.4625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 5.139021873474121, "min_q": 2.043210983276367, "max_q": 7.194721698760986, "mean_td_error": -0.24402779340744019}, "td_error": [1.7850966453552246, -0.8195657730102539, -0.8733220100402832, -0.2096695899963379, -0.3726181983947754, 1.4304838180541992, -0.2048044204711914, 1.8306574821472168, -0.9554934501647949, -0.6060528755187988, 0.8339643478393555, 4.196006774902344, -0.4157257080078125, -0.7394347190856934, 1.8611412048339844, -0.5369362831115723, -0.7959036827087402, 1.4787406921386719, -0.8902716636657715, 1.017697811126709, -0.8389983177185059, -0.559349536895752, -0.03872823715209961, -0.7326178550720215, -0.16753482818603516, 1.709632396697998, 1.6875314712524414, -0.8667726516723633, -0.37183475494384766, 1.107046127319336, 1.5611681938171387, -1.0048561096191406, -0.6239004135131836, 1.093580722808838, -0.25735044479370117, -0.22106218338012695, -0.5255918502807617, 0.9257907867431641, -11.519968032836914, -0.05514383316040039, -7.360321998596191, 1.7286911010742188, -1.378798246383667, -1.3899502754211426, -0.7373623847961426, -1.8343515396118164, 0.9688773155212402, -1.0527734756469727, -0.5030784606933594, -0.34162473678588867, -0.28474903106689453, -0.5694460868835449, 0.8855099678039551, -1.3029580116271973, -0.9405255317687988, 1.06386137008667, 1.5689716339111328, 1.1933655738830566, -10.448513984680176, 0.9698824882507324, 1.6875314712524414, -0.6964812278747559, -1.8750672340393066, 1.3857226371765137, 0.8606369495391846, -0.5209388732910156, 1.998812198638916, 1.5689716339111328, 1.8178153038024902, 1.7545380592346191, -1.158799648284912, -0.4663662910461426, -0.8659629821777344, 0.8031532764434814, -0.5789074897766113, -0.7525248527526855, -1.3730053901672363, -0.8824672698974609, -0.7273116111755371, -0.49443721771240234, 1.3226256370544434, 1.7672648429870605, 1.646693229675293, -0.8968496322631836, 1.248997688293457, 0.6550040245056152, -0.8271780014038086, -0.6992387771606445, -0.9758973121643066, -1.4917759895324707, -1.3329648971557617, -0.15558385848999023, 1.804067611694336, -0.7427079677581787, 1.0249519348144531, -1.7762017250061035, 0.9159245491027832, 1.5853080749511719, -0.4224262237548828, -0.4728584289550781, 1.6115355491638184, -0.7949738502502441, -0.9312882423400879, -0.27591943740844727, -1.379014015197754, 1.393078327178955, 1.2575969696044922, -0.7524256706237793, 2.035585880279541, -0.40502262115478516, -1.5459818840026855, 1.6893014907836914, -0.9096980094909668, 1.448868751525879, 1.5099763870239258, 1.4280409812927246, 0.014869928359985352, 0.8188767433166504, 1.0041580200195312, -0.14539575576782227, -0.40134382247924805, -1.0378613471984863, 1.4833168983459473, 1.2599945068359375, -0.9447178840637207, 1.451920986175537, -0.19480609893798828, 1.0549530982971191, 1.2451057434082031, 1.747363567352295, -0.1402745246887207, -0.6996321678161621, 1.7940497398376465, 1.2630271911621094, 1.5445075035095215, -1.1398110389709473, -0.9176759719848633, 1.428741455078125, -0.8939132690429688, 1.4178037643432617, -0.486358642578125, -1.7762017250061035, -0.13616514205932617, -0.5941848754882812, -10.23897933959961, -1.0012431144714355, -0.9176759719848633, -0.21146202087402344, -0.3833155632019043, -0.9120430946350098, -10.23897933959961, 1.1773557662963867, -0.21513891220092773, 0.01109933853149414, -0.6946349143981934, -1.1715283393859863, -0.5371217727661133, -0.9389543533325195, 1.130582332611084, -0.10368728637695312, 1.7940497398376465, 0.0331883430480957, -1.420464038848877, -0.6886410713195801, -0.19577312469482422, -0.563112735748291, 1.707636833190918, -0.14539575576782227, -0.7525248527526855, 1.5140600204467773, -0.6401915550231934, -0.45564746856689453, -0.49057435989379883, 1.8432354927062988, -0.10929584503173828, -5.016547679901123, -0.8639864921569824, 1.4100685119628906, 1.0534772872924805, -0.3295936584472656, -0.8990111351013184, -1.3054747581481934, -0.4872112274169922, -1.678572654724121, -0.765995979309082, 1.1542701721191406, -0.4890098571777344, 1.017869472503662, 0.9895825386047363, 0.5079641342163086, 1.390549659729004, 0.21845197677612305, -0.5033731460571289, -0.06377696990966797, -0.2324357032775879, -0.5829629898071289, 0.9757585525512695, 0.25826120376586914, -8.310626983642578, -0.3262042999267578, 0.8984265327453613, -0.4424147605895996, -0.4411344528198242, 0.9468903541564941, -0.2988162040710449, -0.7265489101409912, -0.3834404945373535, 1.730116367340088, 1.284562110900879, -2.2453041076660156, 0.6550040245056152, 0.01958608627319336, -1.066392183303833, 1.828138828277588, -5.237824440002441, -0.39897775650024414, -7.320657730102539, 0.9129743576049805, -0.4872112274169922, 1.4914202690124512, -0.9646120071411133, -0.5714468955993652, -0.3814396858215332, 1.3566536903381348, 1.160252571105957, -0.6098742485046387, -0.38589954376220703, 1.5364933013916016, 1.428741455078125, -0.43337249755859375, -0.29224109649658203, -1.8943185806274414, 1.7680702209472656, 1.4636354446411133, -0.9141392707824707, 0.5874655246734619, -0.8662793636322021, 0.17415809631347656, -5.30877685546875, -0.8338241577148438, 1.5970911979675293, -1.4089789390563965, -1.1734356880187988, -0.41010332107543945, -10.339273452758789, 5.742624282836914, -1.3516764640808105, -1.3479247093200684, -0.3131694793701172, 1.0138587951660156, -1.0403056144714355, 4.772879600524902, -0.07871294021606445, 0.8188767433166504, -0.9869155883789062, -0.11140823364257812, -0.01645517349243164, 1.8033099174499512, 1.287208080291748, -0.8091201782226562, -5.237824440002441, 0.04123830795288086, -8.310626983642578, 1.8024706840515137, -0.37535572052001953, -0.7602653503417969, 1.9713292121887207, -1.999253749847412, -0.21893978118896484, -1.04829740524292, -0.4217414855957031, 0.7539386749267578, 2.03804874420166, -1.4803690910339355, 1.8201861381530762, -0.37364816665649414, -0.15192890167236328, -0.3262042999267578, -0.4265327453613281, -0.0869293212890625, 0.0331883430480957, -0.44092273712158203, 0.08205842971801758, -0.8160037994384766, -0.5939435958862305, -1.0378613471984863, -0.4564518928527832, 1.6234517097473145, 1.4984698295593262, -0.9851217269897461, -0.445253849029541, -0.37183475494384766, -1.0633292198181152, 0.09018373489379883, -0.958984375, 0.8973960876464844, -0.3101186752319336, -0.6098260879516602, 1.3449878692626953, -0.20183372497558594], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 19500, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 19500, "last_target_update_ts": 5120, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": -25.12009185552597, "episode_reward_min": -157.70000007748604, "episode_reward_mean": -78.027903330978, "episode_len_mean": 263.875, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5595274576194671, "mean_inference_ms": 22.023360581855037, "mean_action_processing_ms": 0.14678883471197002, "mean_env_wait_ms": 5.195000754847204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -25.12009185552597, "episode_reward_min": -157.70000007748604, "episode_reward_mean": -78.027903330978, "episode_len_mean": 263.875, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5595274576194671, "mean_inference_ms": 22.023360581855037, "mean_action_processing_ms": 0.14678883471197002, "mean_env_wait_ms": 5.195000754847204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 19500, "num_env_steps_sampled": 5120, "num_env_steps_trained": 19500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 5120, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 311.251, "learn_time_ms": 60.475, "learn_throughput": 4960.695, "synch_weights_time_ms": 19.483}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 19500, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 19500, "last_target_update_ts": 5120, "num_target_updates": 9}, "done": false, "episodes_total": 16, "training_iteration": 5, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-24-48", "timestamp": 1655493888, "time_this_iter_s": 5.174530029296875, "time_total_s": 24.337336778640747, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 24.337336778640747, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.314285714285717, "ram_util_percent": 58.614285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 5.384773254394531, "min_q": 2.0738532543182373, "max_q": 7.508477210998535, "mean_td_error": -0.03807643800973892}, "td_error": [-0.552588939666748, -1.505453109741211, -0.25411272048950195, -0.7373919486999512, 1.9454197883605957, -0.3179740905761719, 1.8513965606689453, -0.6535642147064209, 1.3312444686889648, -0.18381309509277344, 0.04347515106201172, 1.4468345642089844, -0.2181873321533203, -0.3619847297668457, -0.22995471954345703, 1.9467110633850098, -0.5080175399780273, -0.16219186782836914, -0.4001021385192871, 0.9326705932617188, -0.19274044036865234, -4.930587291717529, 1.5085749626159668, -1.05889892578125, -0.9926900863647461, 2.1087136268615723, 1.4853148460388184, -1.1568350791931152, 1.4777369499206543, -7.287586688995361, -1.1580266952514648, 1.386115550994873, -0.4208517074584961, -0.6956644058227539, -0.848900318145752, 0.2578768730163574, -0.0013790130615234375, 1.500669002532959, -0.4068641662597656, -0.7750406265258789, -0.46674251556396484, -0.722074031829834, 1.5310802459716797, 2.0523667335510254, 1.764793872833252, 1.9050321578979492, 1.899653434753418, -0.8406238555908203, -0.47086572647094727, -9.875436782836914, 0.8561286926269531, -0.10283851623535156, -1.2333564758300781, 1.9467110633850098, 0.606165885925293, 1.523111343383789, 1.1669235229492188, -0.3269538879394531, 2.2206530570983887, 1.232309341430664, -0.14586877822875977, -5.067834377288818, 1.4187755584716797, -0.12261772155761719, 1.2135653495788574, 1.7205839157104492, 0.7150590419769287, 2.0073275566101074, 0.8622698783874512, 0.06324338912963867, -0.11438989639282227, 1.6083908081054688, -0.49580907821655273, -0.4105644226074219, -5.019940376281738, 0.34476232528686523, -0.2092428207397461, 1.8177571296691895, 1.014427661895752, 1.8757429122924805, 0.030859947204589844, 1.139014720916748, -10.772287368774414, 1.1781835556030273, -0.21472501754760742, 1.7870187759399414, 1.8312387466430664, 1.521993637084961, 0.7778396606445312, -0.09253549575805664, -0.8291306495666504, 1.7358107566833496, 2.079451084136963, 1.2846860885620117, 1.2895913124084473, -6.55371618270874, -0.16428184509277344, 1.7932758331298828, -0.6647133827209473, -0.772000789642334, -0.14359426498413086, 1.1803975105285645, -0.4424457550048828, -1.05889892578125, -0.4991579055786133, 1.2720677852630615, 1.4360013008117676, -0.790410041809082, 2.0626845359802246, 0.17207670211791992, 1.76204252243042, 1.6083908081054688, 1.2988324165344238, -0.29764318466186523, 1.3141107559204102, -5.3619465827941895, 2.125828742980957, -0.06101083755493164, -0.40183115005493164, -0.5231690406799316, -0.4210367202758789, 1.9960055351257324, 1.3558568954467773, 1.5205397605895996, -0.753422737121582, -0.029697418212890625, -1.3286471366882324, -0.37941551208496094, -0.11133766174316406, -5.241138935089111, -0.3806009292602539, -0.16238689422607422, 1.8378992080688477, -0.7006325721740723, 0.06394052505493164, -0.65435791015625, 1.805513858795166, -0.2612442970275879, -0.3131828308105469, 1.8270907402038574, 1.6230030059814453, 2.0309348106384277, -0.2684497833251953, -0.9968109130859375, -0.566195011138916, 0.35607194900512695, -0.23032522201538086, 2.1087136268615723, 2.050778865814209, -0.6925468444824219, -0.6008501052856445, -0.3985099792480469, -1.0302610397338867, -0.05971336364746094, 1.765108585357666, -0.22803831100463867, -0.37748241424560547, 0.054721832275390625, 1.706313133239746, -5.185134410858154, -0.06433296203613281, -0.08059120178222656, -0.33823251724243164, 1.8850884437561035, -0.12925338745117188, 1.6120381355285645, 0.9033126831054688, -0.34398841857910156, -10.046099662780762, -5.119026184082031, 1.2846860885620117, 2.0711307525634766, 1.8769879341125488, 1.4108858108520508, -0.2152099609375, 0.7716469764709473, -0.13983941078186035, 1.772822380065918, 4.788285732269287, 1.0851614475250244, -0.060921669006347656, -0.38487863540649414, -0.4545021057128906, 1.6120381355285645, 0.026276111602783203, -0.03608512878417969, 0.11185932159423828, 0.0290679931640625, 0.07882356643676758, 1.5010786056518555, -0.4254570007324219, -0.12680768966674805, -0.5248489379882812, -0.14668607711791992, 2.1087136268615723, 1.4919471740722656, -0.8499374389648438, -0.49953603744506836, -6.784976482391357, 1.6262259483337402, -5.008964538574219, -0.7908902168273926, 1.5940494537353516, -0.665252685546875, -0.38728952407836914, -0.9543328285217285, -0.24575281143188477, 1.2454452514648438, 1.524482250213623, -0.3552212715148926, 0.9446582794189453, -0.33162736892700195, -0.27614355087280273, -0.43220996856689453, 1.521993637084961, 1.3968605995178223, 1.362971305847168, -0.7817587852478027, 1.3558568954467773, -1.339609146118164, 1.2647290229797363, 1.6467561721801758, -0.26148462295532227, 1.526869297027588, 0.634765625, -0.5339789390563965, -0.22995471954345703, 1.3643591403961182, -1.163578987121582, -0.12122058868408203, -0.5117588043212891, 1.386115550994873, -0.648432731628418, 1.6695036888122559, -6.4679460525512695, 2.561450958251953, -7.3878984451293945, 1.5974531173706055, 1.2305748462677002, 1.9021334648132324, -0.6580057144165039, -0.4210367202758789, -0.038736820220947266, -0.5453100204467773, 1.5010786056518555, -0.9029760360717773, -0.2793750762939453, -9.875436782836914, -0.3985629081726074, -0.28358936309814453, 1.593155860900879, -0.9457969665527344, 1.4880175590515137, -0.04358100891113281, 1.4108858108520508, 1.8579738140106201, -7.182844638824463, -0.7352495193481445, -4.65883731842041, 1.2846860885620117, -1.3717098236083984, -0.23641586303710938, -0.49931812286376953, -1.0320000648498535, -0.2451481819152832, -0.5666112899780273, -0.3024773597717285, -0.5570268630981445, -0.4464879035949707, 1.7600722312927246, 0.1409144401550293, 1.1395654678344727, 1.8355035781860352, -0.665252685546875, -0.45792198181152344, 1.524651050567627, -0.28462791442871094, -0.37178707122802734, -0.23024415969848633, -0.16091060638427734, -0.8417158126831055, -0.9821362495422363, -0.8007664680480957, 1.785721778869629, -0.3156867027282715, 1.6775450706481934, 1.469099521636963, -1.3738784790039062, 2.2772254943847656, 0.1011958122253418, 1.5851645469665527, 1.6447134017944336, 1.2168970108032227, 0.7989969253540039, 1.5519967079162598, -1.163578987121582, 0.25837135314941406, -10.767608642578125, -0.18602466583251953, 6.667724609375], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 24300, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 24300, "last_target_update_ts": 6144, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": -25.12009185552597, "episode_reward_min": -157.70000007748604, "episode_reward_mean": -78.027903330978, "episode_len_mean": 263.875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5595274576194671, "mean_inference_ms": 22.023360581855037, "mean_action_processing_ms": 0.14678883471197002, "mean_env_wait_ms": 5.195000754847204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -25.12009185552597, "episode_reward_min": -157.70000007748604, "episode_reward_mean": -78.027903330978, "episode_len_mean": 263.875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5595274576194671, "mean_inference_ms": 22.023360581855037, "mean_action_processing_ms": 0.14678883471197002, "mean_env_wait_ms": 5.195000754847204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 24300, "num_env_steps_sampled": 6144, "num_env_steps_trained": 24300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 6144, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 291.069, "learn_time_ms": 60.779, "learn_throughput": 4935.931, "synch_weights_time_ms": 19.789}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 24300, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 24300, "last_target_update_ts": 6144, "num_target_updates": 11}, "done": false, "episodes_total": 16, "training_iteration": 6, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-24-53", "timestamp": 1655493893, "time_this_iter_s": 4.62299108505249, "time_total_s": 28.960327863693237, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 28.960327863693237, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 33.957142857142856, "ram_util_percent": 58.84285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 4.956786155700684, "min_q": 1.4053785800933838, "max_q": 7.938900470733643, "mean_td_error": -0.3290327787399292}, "td_error": [-7.548088550567627, -0.8443622589111328, -0.7889666557312012, 1.0854549407958984, 1.1361807584762573, -1.5815367698669434, 0.9831576347351074, -5.1246514320373535, 0.6733927726745605, -1.2736458778381348, 0.6861791610717773, -1.3780889511108398, -1.1928186416625977, -0.8773107528686523, 1.1061267852783203, 1.1667523384094238, 0.757249116897583, 7.4018168449401855, 2.0938148498535156, -1.5650005340576172, -0.052521467208862305, -0.38954734802246094, 0.4398016929626465, -0.7590904235839844, -1.685044288635254, -0.2954096794128418, 1.066786289215088, 0.6634047031402588, -0.899815559387207, -1.5882506370544434, 1.6545472145080566, -1.0763301849365234, 0.5134377479553223, 1.765233039855957, 1.3843021392822266, -1.6849684715270996, -0.052521467208862305, -0.4179716110229492, 0.8668603897094727, -0.20438385009765625, 0.8752899169921875, -0.8190717697143555, -1.1807150840759277, -1.5524287223815918, 0.9593343734741211, 0.6867144107818604, -1.343076467514038, -1.3710780143737793, 0.35987138748168945, -0.20438385009765625, 1.475266456604004, -0.6449270248413086, 1.7118277549743652, 1.804060459136963, -0.40622711181640625, 1.2257325649261475, 1.857886791229248, -0.48841428756713867, 1.3821663856506348, 0.7827072143554688, -0.44704389572143555, 1.1874821186065674, -0.8737983703613281, 1.294710636138916, 1.1666431427001953, 0.9765663146972656, 0.8877148628234863, 1.5992341041564941, -1.206772804260254, -0.3348989486694336, 0.8271923065185547, -0.5350131988525391, -0.4296579360961914, -0.528745174407959, 0.3282890319824219, 0.4027423858642578, -1.288640022277832, -0.3031191825866699, 1.0993521213531494, 0.1700148582458496, -0.8122024536132812, -1.215841293334961, -1.214034080505371, -0.9168763160705566, -1.1328129768371582, 1.5490789413452148, -0.8317337036132812, 0.26103901863098145, -1.141289234161377, -0.2602372169494629, 0.529088020324707, -0.031549930572509766, -7.447227478027344, 1.4469194412231445, -0.25327634811401367, -1.0057215690612793, 0.24457836151123047, -0.6888842582702637, -0.9067492485046387, 1.8314886093139648, 1.7328577041625977, -0.18272018432617188, 1.3065762519836426, -1.1992464065551758, 0.4389193058013916, -7.336572647094727, 0.6024818420410156, 1.1803913116455078, 1.536635398864746, -7.4910430908203125, -0.462679386138916, -1.3792781829833984, 0.5703859329223633, -0.9533143043518066, -0.48416709899902344, -1.237959861755371, 2.4011311531066895, -1.3752665519714355, 1.0306320190429688, -0.40384817123413086, -0.3616943359375, -0.7979097366333008, -7.795554161071777, -1.3706531524658203, -0.20139360427856445, -1.3724932670593262, -0.28070640563964844, -0.30919647216796875, -1.2174968719482422, 0.9026942253112793, 1.3212742805480957, 0.7707931995391846, -0.7155909538269043, 0.2527017593383789, -1.1898350715637207, 0.8626208305358887, -0.5436310768127441, 0.4155402183532715, -0.43784523010253906, -1.5190324783325195, -0.8260407447814941, 1.373253345489502, -0.5400381088256836, 1.31327486038208, 1.4636836051940918, -1.8932313919067383, -0.9037165641784668, 1.554161548614502, -1.0156707763671875, 0.3755621910095215, -8.273811340332031, 1.4577889442443848, 0.37919092178344727, -1.1248388290405273, -0.606025218963623, 1.4610867500305176, 0.985562801361084, -1.197296142578125, -0.6326909065246582, -1.6250500679016113, 0.44049739837646484, -1.206099033355713, 0.5301098823547363, -0.4598355293273926, 1.068894386291504, -0.15611553192138672, -2.505887031555176, 0.961143970489502, -0.42510080337524414, -0.6594114303588867, 0.549863338470459, -0.8542485237121582, -0.6867341995239258, -0.7822556495666504, -0.8949413299560547, -0.46245622634887695, 0.847015380859375, -0.5954523086547852, 0.5301098823547363, -1.6429038047790527, -8.159476280212402, -0.7959074974060059, -0.8552794456481934, 1.3538570404052734, -0.9183812141418457, -0.7674002647399902, -1.2507805824279785, 1.041560173034668, 1.3247795104980469, 1.9868087768554688, 0.807206392288208, 0.9202356338500977, -0.7003974914550781, -1.4099164009094238, 4.531722068786621, -1.1530370712280273, 0.783383846282959, 1.410944938659668, 1.0107207298278809, 1.5655298233032227, 0.704747200012207, 0.8936548233032227, -0.2998805046081543, 1.5776829719543457, 0.8110013008117676, -10.776511192321777, 0.5471072196960449, 0.9510102272033691, 1.6714987754821777, -1.3677268028259277, 1.4585118293762207, -1.6129603385925293, -0.7286896705627441, 1.6882271766662598, -1.3128914833068848, -14.118288040161133, -1.5903944969177246, -0.11606502532958984, -0.16648340225219727, -1.4177842140197754, 0.8957467079162598, -1.0707206726074219, -1.416168212890625, -0.7296910285949707, 1.242258071899414, -1.0829267501831055, 0.5045480728149414, -7.0762152671813965, -1.477604866027832, -1.5039448738098145, 0.9510102272033691, 0.8626208305358887, -1.2253971099853516, 0.9870328903198242, 1.561476707458496, 0.02351999282836914, 1.5514063835144043, 0.6565885543823242, -0.31276702880859375, -1.4930872917175293, -0.8245344161987305, -0.8212652206420898, 1.332676887512207, 2.137408494949341, 1.3603878021240234, -1.5039448738098145, -1.821967601776123, 0.9517083168029785, -5.777268409729004, -0.8305811882019043, 0.4635443687438965, -0.12783575057983398, -2.724874496459961, -0.2589125633239746, -0.674379825592041, -0.3718576431274414, -0.6197214126586914, -0.18328094482421875, 1.0839619636535645, 1.526597499847412, 1.8242559432983398, -7.14443826675415, 1.9735450744628906, -0.38785600662231445, 0.6792142391204834, 1.0894737243652344, 0.29801034927368164, 1.7150497436523438, -1.3382582664489746, 1.3729538917541504, 0.5914125442504883, -0.36749267578125, -0.6060819625854492, -0.46497488021850586, -1.1019444465637207, -1.849029541015625, -1.3438630104064941, 1.5706448554992676, -1.340909481048584, -0.7007026672363281, 0.7707931995391846, -0.559730052947998, -5.1246514320373535, -1.6214323043823242, -1.2855329513549805, -1.514512538909912, 1.4399642944335938, 1.0029168128967285, -0.2602372169494629, -1.4656720161437988, 1.6953961849212646, -0.5601367950439453, 0.43915271759033203, 0.4411187171936035, -1.6696300506591797, 1.4074530601501465, -1.3270642757415771, 1.4023683071136475, -0.14215850830078125, 0.7686929702758789], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 29100, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 29100, "last_target_update_ts": 7168, "num_target_updates": 13}, "sampler_results": {"episode_reward_max": -25.12009185552597, "episode_reward_min": -157.70000007748604, "episode_reward_mean": -78.027903330978, "episode_len_mean": 263.875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5595274576194671, "mean_inference_ms": 22.023360581855037, "mean_action_processing_ms": 0.14678883471197002, "mean_env_wait_ms": 5.195000754847204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -25.12009185552597, "episode_reward_min": -157.70000007748604, "episode_reward_mean": -78.027903330978, "episode_len_mean": 263.875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5595274576194671, "mean_inference_ms": 22.023360581855037, "mean_action_processing_ms": 0.14678883471197002, "mean_env_wait_ms": 5.195000754847204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 29100, "num_env_steps_sampled": 7168, "num_env_steps_trained": 29100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 7168, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 295.003, "learn_time_ms": 61.315, "learn_throughput": 4892.762, "synch_weights_time_ms": 20.183}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 29100, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 29100, "last_target_update_ts": 7168, "num_target_updates": 13}, "done": false, "episodes_total": 16, "training_iteration": 7, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-24-57", "timestamp": 1655493897, "time_this_iter_s": 4.647428035736084, "time_total_s": 33.60775589942932, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 33.60775589942932, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 29.671428571428574, "ram_util_percent": 58.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 4.838976860046387, "min_q": 1.7310643196105957, "max_q": 8.18446159362793, "mean_td_error": -0.15903960168361664}, "td_error": [0.679100751876831, 2.004159450531006, -1.9472429752349854, 1.194201946258545, -0.28226423263549805, 4.247798919677734, 1.046336054801941, -0.4651660919189453, 1.086440086364746, 1.1453733444213867, -0.865776538848877, 1.5248022079467773, -0.017251968383789062, -1.3832697868347168, -0.4592151641845703, -4.745790958404541, -1.0779476165771484, 1.7167649269104004, -0.10840320587158203, -0.010359764099121094, 2.117419719696045, -0.556983470916748, -0.603421688079834, -1.579662799835205, -0.13398456573486328, 1.539015769958496, -0.49657106399536133, 1.0195949077606201, -0.8798856735229492, -5.326726913452148, 1.271463394165039, -7.445079803466797, -1.8751239776611328, 0.909083366394043, -0.856874942779541, 0.9421589374542236, 2.4905338287353516, -0.45783233642578125, -0.9500470161437988, 0.5214853286743164, 1.0415687561035156, -0.20713520050048828, -1.6491189002990723, 0.9867267608642578, 0.8959839344024658, -0.748291015625, 1.3698134422302246, -0.8399226665496826, -0.7407569885253906, 0.2706108093261719, -0.1642141342163086, -0.48093175888061523, -0.15964460372924805, -0.5246057510375977, -0.13712263107299805, 0.34981775283813477, 1.7006211280822754, -0.3044557571411133, -0.8082938194274902, 0.5200150012969971, 1.163212776184082, -0.7684922218322754, -0.5275468826293945, -0.8202829360961914, -6.133482456207275, -0.9893088340759277, -2.207961082458496, 1.30143141746521, 0.0024514198303222656, 0.9770665168762207, 0.19966459274291992, 0.9040355682373047, -0.2443857192993164, 1.0274124145507812, -1.2410476207733154, -0.556983470916748, 0.0032858848571777344, 1.661397933959961, -0.45393848419189453, 0.7734782695770264, -0.2869882583618164, -0.8423762321472168, -0.33504557609558105, 7.977778434753418, 1.1630756855010986, 0.8536689281463623, 0.8199276924133301, -0.9877214431762695, -0.9201769828796387, 0.7926805019378662, 0.3000969886779785, 1.782900333404541, -1.2304096221923828, -0.4539952278137207, -0.868445873260498, -0.6656384468078613, -1.0347065925598145, -0.9652831554412842, 1.0055975914001465, 1.7447657585144043, -0.07184839248657227, -1.3072171211242676, -0.24294519424438477, -1.0229690074920654, -0.36077117919921875, 1.5895605087280273, -0.7680120468139648, 2.2254390716552734, 0.7756242752075195, -0.3400106430053711, -10.292844772338867, -1.2537236213684082, -0.5155701637268066, 0.8590602874755859, 1.7022953033447266, 0.23325014114379883, 1.1265103816986084, 1.3619179725646973, 1.7791404724121094, 1.4707508087158203, -0.7869105339050293, -10.154565811157227, -0.8034563064575195, -0.4088134765625, -0.6455192565917969, -1.134786605834961, -0.5853443145751953, 0.9219417572021484, 1.0274124145507812, 1.3217260837554932, 0.9998869895935059, -0.650191068649292, -0.43985795974731445, -0.7194366455078125, 0.9699130058288574, -0.9143438339233398, -0.2973470687866211, -1.1865403652191162, 0.4939298629760742, 1.1066789627075195, -0.8141818046569824, 0.27266645431518555, -1.1845221519470215, -0.4429135322570801, -1.501526117324829, 2.2672863006591797, -7.825590133666992, 1.9589314460754395, -0.4163484573364258, -7.240195274353027, -0.8399226665496826, -6.566967964172363, 0.9608399868011475, -0.13971757888793945, 1.0549726486206055, 1.3595185279846191, 0.9989557266235352, 0.14804697036743164, -0.8042919635772705, -0.34444427490234375, 1.6446962356567383, -0.614121675491333, -0.11218833923339844, -1.6491189002990723, 1.4447846412658691, -0.33462047576904297, 0.757270336151123, 0.04520702362060547, -4.529666423797607, -0.7356376647949219, 0.8199276924133301, 0.4651188850402832, -0.7407569885253906, 0.6321735382080078, -5.020640850067139, 2.307929515838623, -4.445894241333008, -0.19669198989868164, -0.5590667724609375, -1.247939109802246, -1.0336155891418457, -0.20792770385742188, 1.5352091789245605, -0.7821259498596191, 1.1153745651245117, 1.4811067581176758, 0.7739512920379639, -0.9869611263275146, -1.209378719329834, 0.9948985576629639, -9.890155792236328, 7.085381031036377, -0.13470792770385742, 6.39508056640625, 1.0625519752502441, -7.8973894119262695, -1.3634982109069824, -5.915735244750977, -1.145275592803955, -1.302685022354126, 0.03983449935913086, 1.1689209938049316, -0.4020977020263672, 1.0517501831054688, -0.7882497310638428, -0.7284178733825684, -1.4295508861541748, 0.002772808074951172, 1.0274124145507812, 1.1773719787597656, -0.3056516647338867, -6.656409740447998, 0.9638679027557373, 1.1665844917297363, -0.35361766815185547, -1.474790334701538, 1.2063283920288086, 1.5461101531982422, 1.8782713413238525, -1.2551813125610352, -1.5223469734191895, 0.9070000648498535, -0.3583378791809082, -0.7197756767272949, -6.566967964172363, -1.3448233604431152, -0.1290283203125, 1.5250897407531738, -0.671912431716919, 1.4162864685058594, 0.8482718467712402, 1.5398354530334473, 1.7520647048950195, -0.3952336311340332, 1.5248022079467773, 1.3484253883361816, -0.6881346702575684, 1.1773719787597656, -0.4889030456542969, -0.24091815948486328, -0.9480969905853271, 1.6530375480651855, -0.9949159622192383, 1.7006211280822754, -5.615810871124268, 1.7047901153564453, 1.8200111389160156, -0.5984222888946533, -1.1400361061096191, -0.7394027709960938, 0.17421531677246094, -6.259802341461182, 1.6910967826843262, -0.4575176239013672, -0.43706655502319336, -0.35010480880737305, -0.41985487937927246, 1.8420910835266113, 0.393202543258667, -0.18909740447998047, 1.2773866653442383, 1.737360954284668, 0.7858536243438721, 1.4912710189819336, -1.1162910461425781, 0.9058914184570312, 0.17011260986328125, 1.1892318725585938, 1.9187498092651367, 1.1652803421020508, 0.7727870941162109, -0.04917097091674805, 1.2079963684082031, 1.0635972023010254, 0.11044549942016602, 1.0824623107910156, -0.14240074157714844, 1.4434266090393066, 0.9638679027557373, 1.360189437866211, 1.1690864562988281, 1.2079963684082031, 0.11084461212158203, -1.204399585723877, 4.9246110916137695, -0.33951854705810547, -0.9534025192260742, 0.7727870941162109, -0.19005870819091797, 1.3316569328308105, 0.039769649505615234, 1.5789542198181152, 0.8551015853881836, -5.569653511047363, -1.1947507858276367, 0.23517465591430664, 1.1630756855010986, 1.8825764656066895, 0.9006919860839844, 0.9638679027557373], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 33900, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 33900, "last_target_update_ts": 8192, "num_target_updates": 15}, "sampler_results": {"episode_reward_max": -25.12009185552597, "episode_reward_min": -157.70000007748604, "episode_reward_mean": -78.027903330978, "episode_len_mean": 263.875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5595274576194671, "mean_inference_ms": 22.023360581855037, "mean_action_processing_ms": 0.14678883471197002, "mean_env_wait_ms": 5.195000754847204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -25.12009185552597, "episode_reward_min": -157.70000007748604, "episode_reward_mean": -78.027903330978, "episode_len_mean": 263.875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5595274576194671, "mean_inference_ms": 22.023360581855037, "mean_action_processing_ms": 0.14678883471197002, "mean_env_wait_ms": 5.195000754847204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 33900, "num_env_steps_sampled": 8192, "num_env_steps_trained": 33900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 8192, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 307.95, "learn_time_ms": 60.764, "learn_throughput": 4937.163, "synch_weights_time_ms": 19.991}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 33900, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 33900, "last_target_update_ts": 8192, "num_target_updates": 15}, "done": false, "episodes_total": 16, "training_iteration": 8, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-25-02", "timestamp": 1655493902, "time_this_iter_s": 4.940614461898804, "time_total_s": 38.548370361328125, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 38.548370361328125, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 33.357142857142854, "ram_util_percent": 59.01428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 3.4033970832824707, "min_q": -0.17724846303462982, "max_q": 9.856101989746094, "mean_td_error": -0.7582591772079468}, "td_error": [0.1334904432296753, 1.0398845672607422, -1.1143128871917725, -1.8689051866531372, -0.5328286290168762, 1.5860233306884766, -2.3244848251342773, -0.5604755282402039, 0.09152698516845703, -0.4489861726760864, -0.6600737571716309, -8.16353702545166, -2.4209914207458496, 1.220241904258728, -2.050006151199341, -0.8908731937408447, -0.2491755485534668, 1.0098295211791992, -0.17972111701965332, 1.2344951629638672, 1.103009581565857, -0.3432350158691406, -0.9110159873962402, -4.483419418334961, -1.3201137781143188, 0.018185138702392578, -0.2706226110458374, 0.5085824728012085, -0.5821418762207031, 0.10309028625488281, -0.7851166725158691, 0.7172517776489258, 0.09567451477050781, -1.3679566383361816, 0.2022075653076172, -1.3916099071502686, -1.7191581726074219, -2.0145604610443115, 0.5461684465408325, 1.1334152221679688, 0.15555334091186523, -0.6229777336120605, -0.17398309707641602, -1.3620485067367554, -2.1723217964172363, -0.8097944259643555, -2.3317155838012695, -0.35222291946411133, -0.25351905822753906, -0.37317657470703125, -0.37604475021362305, 0.25434231758117676, 0.46841728687286377, -0.03645944595336914, -1.4522027969360352, -1.787494421005249, -0.36287879943847656, -1.9556516408920288, -0.18348455429077148, -2.280912399291992, -2.280912399291992, -0.5328286290168762, -1.9632234573364258, -1.226597785949707, -0.07275140285491943, 0.35492950677871704, -1.728800654411316, -0.08041191101074219, -0.47634339332580566, -1.8193769454956055, -1.4846835136413574, -0.3482203483581543, 0.17793762683868408, 0.367023229598999, -1.9952867031097412, -0.2180475890636444, -10.64659309387207, -1.1125249862670898, -2.8219141960144043, 0.5684843063354492, -0.28529787063598633, -0.0948796272277832, -0.16288280487060547, 1.0966215133666992, -0.6942791938781738, -0.6538386344909668, -0.24756622314453125, -1.6656007766723633, -1.072432518005371, -4.633641242980957, -1.8163660764694214, -0.5700745582580566, -2.391968011856079, -0.5844821929931641, -1.1949365139007568, -1.944172978401184, 0.7059030532836914, 0.17739784717559814, -1.652338981628418, 0.9530661106109619, 0.44577550888061523, -0.22387029230594635, 0.48331212997436523, -1.2213010787963867, -2.247732162475586, -2.1341445446014404, -1.3019424676895142, 0.1413743495941162, -1.1297955513000488, -1.2279255390167236, 0.17739784717559814, 0.04652976989746094, -0.366269588470459, -0.8948464393615723, 1.4741592407226562, 1.2460827827453613, 0.26262974739074707, -1.6491684913635254, 0.1457808017730713, -2.5454256534576416, -1.6004972457885742, 1.1022615432739258, -2.493389129638672, -2.5144734382629395, -1.3793911933898926, -0.43801450729370117, 1.049570083618164, -0.743678092956543, -2.770831823348999, -0.5604755282402039, -0.5440902709960938, -1.8795204162597656, 1.253171682357788, -1.617689609527588, -0.4289039671421051, -1.8513199090957642, -0.5003776550292969, -0.5393519997596741, -0.7245039939880371, -2.4300949573516846, 1.2185206413269043, 0.1413743495941162, -0.17080259323120117, -0.6079535484313965, -0.842343807220459, 0.13084638118743896, -2.6881890296936035, -0.9515132904052734, -0.47936010360717773, -2.101844310760498, -0.2180475890636444, -0.615077018737793, 0.5028655529022217, -1.4886953830718994, -0.2745935320854187, 0.05939745903015137, -0.9121668338775635, -1.9063072204589844, -2.1620616912841797, -2.2356998920440674, 1.3243680000305176, -0.5680575370788574, -0.4289039671421051, 0.014018774032592773, 1.636488437652588, 0.9242386817932129, 1.44932222366333, 0.8416883945465088, -4.747647285461426, -0.019366741180419922, -1.9155693054199219, -0.35648488998413086, 0.6491847038269043, 1.6282787322998047, -0.6603178977966309, 0.2750816345214844, 0.2931762933731079, -0.7074840068817139, -1.2342395782470703, 0.45128870010375977, 0.5247227549552917, -0.953272819519043, -0.5044679641723633, -0.07001090049743652, -4.649676322937012, -3.0781052112579346, 1.7714715003967285, -3.373521566390991, -2.0064003467559814, -1.4957960844039917, -11.330867767333984, -2.090829849243164, -0.467271089553833, 4.689247131347656, -0.03197759389877319, 1.8326692581176758, -0.7636618614196777, -0.5939531326293945, 0.6720743179321289, 1.2962822914123535, 0.4564967155456543, 0.9349532127380371, 0.48566949367523193, -2.2881622314453125, -0.1947193145751953, -2.556145429611206, -0.4795393943786621, -0.4020395278930664, -2.2405171394348145, -0.042037010192871094, 0.10949325561523438, 0.1980280876159668, -0.0948796272277832, -0.03289651870727539, 1.7453899383544922, -0.3904809355735779, -0.5523262023925781, -0.5264797210693359, -0.8972342014312744, -1.4989275932312012, -1.4634735584259033, -0.21920347213745117, -2.443729877471924, 0.21380400657653809, -1.1077375411987305, -8.093253135681152, 6.111429691314697, 0.8299973011016846, 0.6800796389579773, -0.016158103942871094, 1.5873727798461914, -0.6479212045669556, -0.04583740234375, -0.1556868553161621, -0.18287992477416992, 0.5085824728012085, -2.0955562591552734, -2.046272039413452, -0.6026413440704346, -1.408157467842102, -1.4760265350341797, -1.3207910060882568, -0.19917535781860352, 1.4368386268615723, 1.103009581565857, 0.3648865222930908, -0.35637855529785156, -0.4392554759979248, -1.5103991031646729, -0.13684237003326416, -1.2646560668945312, -2.1473753452301025, -5.312932968139648, -8.710941314697266, 0.12880319356918335, -7.896100044250488, -1.2819125652313232, 1.5691661834716797, -1.7475669384002686, -1.021249771118164, 0.0038962364196777344, 0.39560675621032715, 0.9548606872558594, -0.054833292961120605, -0.13968753814697266, 1.4814825057983398, -10.086020469665527, 0.46325159072875977, 0.0656280517578125, -0.3806746006011963, 0.36883044242858887, -1.7191581726074219, 0.5461684465408325, 0.38663172721862793, 0.16840219497680664, -1.2241742610931396, 1.7153277397155762, -0.9238516092300415, -1.4889898300170898, 0.04590308666229248, 0.25434231758117676, -1.2986493110656738, -0.2924231290817261, -9.100111961364746, 0.35689830780029297, -0.9826099872589111, -1.318763256072998, 1.2549057006835938, 1.5180754661560059, -1.22622549533844, 0.5085824728012085, -0.5520448684692383, -0.9509410858154297, 0.762290358543396, 0.9530661106109619, -1.070987343788147, -1.8732733726501465, -0.7589659690856934, -0.33819031715393066, -1.3211736679077148], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 38700, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 38700, "last_target_update_ts": 9216, "num_target_updates": 17}, "sampler_results": {"episode_reward_max": -25.12009185552597, "episode_reward_min": -216.26449727267027, "episode_reward_mean": -96.06493017077446, "episode_len_mean": 271.63157894736844, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559737810275721, "mean_inference_ms": 22.02820109663957, "mean_action_processing_ms": 0.14667875111278456, "mean_env_wait_ms": 5.120808952341926, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -25.12009185552597, "episode_reward_min": -216.26449727267027, "episode_reward_mean": -96.06493017077446, "episode_len_mean": 271.63157894736844, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559737810275721, "mean_inference_ms": 22.02820109663957, "mean_action_processing_ms": 0.14667875111278456, "mean_env_wait_ms": 5.120808952341926, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 38700, "num_env_steps_sampled": 9216, "num_env_steps_trained": 38700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 9216, "agent_timesteps_total": 9216, "timers": {"training_iteration_time_ms": 337.598, "learn_time_ms": 61.128, "learn_throughput": 4907.729, "synch_weights_time_ms": 19.19}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 38700, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 38700, "last_target_update_ts": 9216, "num_target_updates": 17}, "done": false, "episodes_total": 19, "training_iteration": 9, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-25-08", "timestamp": 1655493908, "time_this_iter_s": 5.356029033660889, "time_total_s": 43.904399394989014, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 43.904399394989014, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.142857142857142, "ram_util_percent": 59.185714285714276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 3.074577569961548, "min_q": -3.012678861618042, "max_q": 11.34161376953125, "mean_td_error": -0.2551507353782654}, "td_error": [-3.0424282550811768, -8.958964347839355, -0.6064896583557129, -0.06873741745948792, -1.5565351247787476, -0.9278171062469482, 1.7713727951049805, -0.5205909013748169, -0.01770305633544922, -0.5888175964355469, 0.9209151268005371, 1.1655256748199463, 0.7305178642272949, 0.660517692565918, 0.3017004728317261, 1.2211570739746094, -0.04778933525085449, 0.9712622165679932, 0.609181821346283, -0.7944663763046265, -0.16924142837524414, -2.0493452548980713, 0.9098310470581055, -3.656867504119873, 0.1816650629043579, -1.303635835647583, 0.9525851011276245, 0.609181821346283, -1.0677742958068848, 0.5253217220306396, 0.967298150062561, -1.5631804466247559, 0.1039285659790039, -0.3535618782043457, 1.046172857284546, 1.0591003894805908, 0.02628469467163086, 0.012237071990966797, 0.9048758745193481, -11.474396705627441, 2.7276954650878906, 0.34914588928222656, 0.08272027969360352, 1.4256210327148438, -1.574504017829895, 1.0799551010131836, -0.31392741203308105, -1.0714354515075684, 0.4136695861816406, 0.6138360500335693, 0.7337006330490112, 0.11747097969055176, 1.6974234580993652, -0.9105709791183472, 1.3449430465698242, -1.5365313291549683, -0.7413182258605957, -2.089794635772705, 1.1876883506774902, 0.660517692565918, 1.278161883354187, 0.28937816619873047, -0.06774616241455078, 0.1626729965209961, -2.562647819519043, -1.357330322265625, 2.7921090126037598, -1.2632207870483398, 0.059352874755859375, 1.8424692153930664, 0.12329816818237305, 1.1750950813293457, -1.1043105125427246, 0.42341017723083496, 0.5942895412445068, 2.5958871841430664, 0.019216060638427734, -1.3697640895843506, 1.8475275039672852, -0.7830424308776855, 0.2844688892364502, -5.204455852508545, -0.42099857330322266, 0.6777935028076172, -0.5272938013076782, 1.3194639682769775, -4.9729485511779785, -0.8914546966552734, 2.304011344909668, 1.7486485242843628, -0.06774616241455078, -0.4203171730041504, 1.0568513870239258, 1.6978821754455566, -1.331660270690918, 0.27652645111083984, -0.6532728672027588, -0.15488576889038086, 0.11563944816589355, 2.5958871841430664, 1.03139066696167, -0.17421245574951172, -0.13546371459960938, 0.7627601623535156, -1.3320527076721191, 0.46376824378967285, 0.4381296634674072, 0.7899188995361328, 0.7412124872207642, -0.477047324180603, 0.4822661876678467, -0.8121234178543091, 1.2787532806396484, -0.9399493932723999, -0.8998936414718628, -0.9765300750732422, -0.08750104904174805, -1.731017827987671, -0.22084367275238037, -1.1898746490478516, 1.2133913040161133, -0.8564319610595703, -0.20868456363677979, -2.3240206241607666, 0.20262956619262695, -0.5891114473342896, -0.9383382797241211, 1.9130773544311523, -1.1683235168457031, 0.26249122619628906, -1.1147788763046265, -1.7926757335662842, 2.366786003112793, -1.5971132516860962, 1.2787532806396484, -0.21837925910949707, 0.13541382551193237, -0.9707107543945312, 1.4222736358642578, -0.28933000564575195, -7.0829315185546875, -0.05777573585510254, -0.588554859161377, -0.06399154663085938, -0.5953512191772461, 2.7764954566955566, -0.28933000564575195, -0.18262386322021484, -6.247983455657959, -0.5465335845947266, 0.43871116638183594, 0.33065271377563477, 1.538736343383789, -0.639862060546875, -0.025807619094848633, -0.23539280891418457, 1.3765692710876465, 0.13495445251464844, 0.30878186225891113, -1.486696481704712, -0.718518078327179, -9.872958183288574, 0.06956934928894043, 1.6559314727783203, -6.1349992752075195, -0.5967354774475098, -0.7915599346160889, 1.8475275039672852, -7.427285194396973, 1.9340262413024902, 1.19423246383667, 1.239608883857727, 0.654104471206665, -1.0902079343795776, -1.3922162055969238, -4.44914436340332, 0.865058422088623, 1.413689136505127, 0.09693336486816406, -0.10509014129638672, -0.4840712249279022, -1.264252781867981, -0.039936602115631104, -0.05777573585510254, 1.6404118537902832, 0.660517692565918, 1.278161883354187, 1.6978821754455566, 0.15763461589813232, 1.1762925386428833, 0.0603829026222229, 0.4351177215576172, -0.5410213470458984, -0.22122955322265625, -2.7142019271850586, -5.365683555603027, 0.31909871101379395, 0.1506214141845703, 0.9198746681213379, 0.34311890602111816, -0.5843729972839355, -0.12135684490203857, -0.7424983978271484, -2.709810733795166, -0.646812915802002, 0.08743619918823242, 0.5406744480133057, 1.6724810600280762, 0.37248384952545166, 0.5248751640319824, 2.157897472381592, 0.38048654794692993, -0.6909211874008179, -2.8613758087158203, 0.425433874130249, -1.6512367725372314, -7.128976821899414, -1.3902311325073242, 1.5115742683410645, 1.0804359912872314, 0.6589646339416504, -0.9765300750732422, -0.6255359649658203, -1.595733642578125, -1.681724190711975, 1.0220818519592285, -0.4953317642211914, -10.587726593017578, 1.1811316013336182, -0.32852792739868164, 0.18246877193450928, -0.5646493434906006, -1.4530973434448242, 0.5584521293640137, 0.2628272771835327, 0.441312313079834, 2.5141468048095703, -0.2937716245651245, 1.0046968460083008, 0.21070575714111328, -0.593651294708252, 0.7797784805297852, -1.6123392581939697, -0.28175926208496094, 1.8913302421569824, -0.19066143035888672, 1.1876883506774902, -0.48853349685668945, -0.017479896545410156, 0.6368451118469238, -1.433666706085205, -1.39353609085083, 0.11747097969055176, 1.3847665786743164, 0.34311890602111816, 2.105297803878784, 1.0220818519592285, 0.7899188995361328, -0.20903396606445312, -0.5337684154510498, -0.7172698974609375, 0.6138360500335693, -1.018916130065918, -3.044013023376465, -0.7134156227111816, 0.1601172685623169, -0.7100009918212891, -0.38782835006713867, 0.41208362579345703, 1.3746514320373535, 1.888598918914795, 0.12981200218200684, 1.8832740783691406, -1.920814871788025, 0.37248384952545166, -0.026144027709960938, 0.05794072151184082, -0.18262386322021484, -0.2819938659667969, 1.5596332550048828, -0.827812671661377, -1.560416579246521, -0.5200701951980591, 1.2874741554260254, -0.3896830081939697, 1.6184954643249512, -1.324466347694397, 1.1261143684387207, 0.2172222137451172, -0.15082550048828125, -1.7735962867736816, -1.9894152879714966, 0.7055234313011169, 1.8913302421569824, 2.271604537963867, -1.277668833732605, 0.2113093137741089, -0.6280930042266846, -0.4394497871398926, 0.04445230960845947], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 43500, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 43500, "last_target_update_ts": 10240, "num_target_updates": 19}, "sampler_results": {"episode_reward_max": -25.12009185552597, "episode_reward_min": -308.9168232306838, "episode_reward_mean": -157.66995101347567, "episode_len_mean": 298.3, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392914923108229, "mean_inference_ms": 21.982201630442372, "mean_action_processing_ms": 0.14347331825008255, "mean_env_wait_ms": 4.830830601064083, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -25.12009185552597, "episode_reward_min": -308.9168232306838, "episode_reward_mean": -157.66995101347567, "episode_len_mean": 298.3, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392914923108229, "mean_inference_ms": 21.982201630442372, "mean_action_processing_ms": 0.14347331825008255, "mean_env_wait_ms": 4.830830601064083, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 43500, "num_env_steps_sampled": 10240, "num_env_steps_trained": 43500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 10240, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 311.003, "learn_time_ms": 60.423, "learn_throughput": 4965.029, "synch_weights_time_ms": 20.089}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 43500, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 43500, "last_target_update_ts": 10240, "num_target_updates": 19}, "done": false, "episodes_total": 30, "training_iteration": 10, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-25-13", "timestamp": 1655493913, "time_this_iter_s": 5.233164310455322, "time_total_s": 49.137563705444336, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 49.137563705444336, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 28.887500000000003, "ram_util_percent": 59.287499999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 2.9286983013153076, "min_q": -4.611684322357178, "max_q": 11.361454963684082, "mean_td_error": -0.3844992220401764}, "td_error": [-0.9079036712646484, -1.1353482007980347, 1.9758129119873047, -0.3206973075866699, 0.31813621520996094, 0.3011035919189453, -0.6113772392272949, 0.2811470031738281, 0.05368947982788086, -0.522676944732666, 0.6198562979698181, 2.0977284908294678, -9.765264511108398, -4.893056869506836, -1.0344984531402588, -2.2035651206970215, -0.7204537391662598, -1.4551138877868652, 1.3827285766601562, 0.4173898696899414, -1.8917444944381714, 0.5886087417602539, 0.42040157318115234, 5.904651165008545, 0.4572157859802246, -0.9432696104049683, -0.7602691650390625, 0.5364856719970703, -0.6707091331481934, 0.6895036697387695, -0.3425126075744629, 0.3753528594970703, -1.9844980239868164, 1.3804025650024414, 0.5731139183044434, 0.3036942481994629, -1.5409619808197021, 0.05859017372131348, 0.09985542297363281, -1.403040885925293, 1.5506815910339355, 0.6503832340240479, 5.7259368896484375, -1.1020894050598145, 1.7456493377685547, 0.9025292992591858, 1.4562807083129883, -0.5051612854003906, -0.7635862827301025, -0.41283321380615234, 0.1454939842224121, 0.05859017372131348, -1.5608744621276855, -1.36296808719635, 0.37222909927368164, -1.5379304885864258, -5.265809059143066, -0.8560760021209717, 0.43646717071533203, -0.8975165486335754, 0.8110947608947754, -1.5474066734313965, 1.3202462196350098, 0.45772266387939453, 0.3925633430480957, 0.10072922706604004, -0.9373832941055298, 1.3566687107086182, -0.5624662637710571, -1.2833671569824219, -0.6694903373718262, 0.5471296310424805, 0.27817249298095703, 1.0192642211914062, 2.5695276260375977, -0.08344459533691406, 0.7666950225830078, -0.6862668991088867, -10.383724212646484, -0.265627384185791, -0.5523154735565186, -0.7179841995239258, 0.4058274030685425, -1.066613793373108, -1.1610946655273438, -1.4015986919403076, 3.6367921829223633, -1.3182811737060547, -1.4124188423156738, -1.0884885787963867, 2.472465991973877, -0.22261762619018555, -2.229903221130371, 1.3656821250915527, -0.872753381729126, -0.16970539093017578, -0.38447093963623047, 0.6314611434936523, -1.5532073974609375, 0.7177553176879883, 1.0904536247253418, 0.8647682666778564, -1.2833671569824219, 0.041290283203125, 0.6760839223861694, -0.6661787033081055, -1.064664363861084, 0.5731139183044434, 0.7177553176879883, -0.9324955940246582, 0.3341090679168701, 0.7771234512329102, -1.2724742889404297, -0.36064672470092773, 1.2550837993621826, -1.5596745014190674, -4.921894073486328, 0.22108912467956543, -2.216994285583496, 0.949951171875, 1.3535590171813965, 1.281494140625, -0.12408638000488281, 0.19548439979553223, -0.287628173828125, 1.1446037292480469, 0.9730114936828613, 1.368911623954773, 0.4193692207336426, -0.46363210678100586, 0.2708268165588379, 1.094749927520752, 0.6316137313842773, 1.8949174880981445, 0.05859017372131348, 1.094749927520752, 0.6198562979698181, -0.46363210678100586, -1.0680646896362305, 0.8905315399169922, -5.265809059143066, -1.5811071395874023, 1.4819674491882324, 0.44269657135009766, 1.1000304222106934, -1.1200833320617676, 1.0970344543457031, 0.6493759155273438, -0.7264442443847656, -1.4279850721359253, 0.4487317204475403, -6.458132266998291, 1.6982624530792236, -4.3058576583862305, -1.4753236770629883, 0.7058224678039551, 1.5690584182739258, -14.052431106567383, -6.979793548583984, -0.849940299987793, -2.3672056198120117, -1.086207628250122, -1.9656217098236084, -0.9837391376495361, -1.8360230922698975, 1.6100232601165771, 0.4977254867553711, -9.833965301513672, -1.5579500198364258, -0.7926169633865356, 1.5853962898254395, -0.9877901077270508, 1.5840859413146973, 2.5169222354888916, 0.7771234512329102, 1.347095012664795, 0.6013460159301758, -0.8706812858581543, -0.0069582462310791016, -0.8795933723449707, 0.22905731201171875, 0.7599020004272461, -2.009763479232788, -0.47838783264160156, 0.15132808685302734, 0.7879598140716553, -0.5268993377685547, 0.4196968078613281, 0.5095386505126953, 0.3363194465637207, -0.7883033752441406, 0.3213932514190674, -0.47063684463500977, -0.17679500579833984, -0.47655439376831055, -5.554056644439697, -0.7299680709838867, -0.4398679733276367, -0.13139939308166504, -2.672438621520996, 0.28084754943847656, -0.31599006056785583, 1.14875066280365, -2.1786465644836426, -1.062403678894043, 1.325911045074463, 0.7599020004272461, 0.05859017372131348, -0.00043463706970214844, -0.5147049427032471, -0.6371426582336426, 0.6198562979698181, -0.7868598103523254, -1.573500633239746, 1.0972671508789062, 1.8329219818115234, -5.355379104614258, 0.6503832340240479, -0.36592933535575867, -0.22748231887817383, 0.8060016632080078, -1.36296808719635, -0.5051612854003906, -0.23884832859039307, -0.0497589111328125, -2.152763843536377, -1.364950180053711, -5.930558681488037, 1.5536398887634277, 1.5857274532318115, 0.660801887512207, 0.5580084323883057, -0.9612231254577637, 0.1978750228881836, 0.7089747190475464, -1.6499264240264893, 0.37222909927368164, -0.0069582462310791016, -10.836336135864258, 1.393131971359253, -1.9356811046600342, 0.6760839223861694, -0.8965291976928711, 0.37484705448150635, -4.3058576583862305, -0.05654144287109375, 0.44122743606567383, -0.47655439376831055, -2.231268882751465, -1.1610946655273438, 5.904651165008545, 0.6444556713104248, -1.8506832122802734, -1.1283940076828003, -1.2591296434402466, -4.609785079956055, -0.9592739343643188, 1.3722422122955322, 0.10861706733703613, 0.25978994369506836, -0.945673942565918, -6.979793548583984, -1.0015671253204346, 1.7003881931304932, 0.6686267852783203, 2.472465991973877, -2.6270627975463867, -2.470414161682129, -1.0901684761047363, 0.8469983339309692, -1.3570237159729004, 0.16003763675689697, -1.2349427938461304, -0.14007925987243652, 0.43763136863708496, 0.9381543397903442, 1.4560801982879639, 1.7456493377685547, 0.633758544921875, 1.4560801982879639, 0.5958447456359863, -0.4765898585319519, 0.6772809028625488, 1.058935284614563, 0.2041330337524414, 0.22905731201171875, -0.4163551926612854, -1.81288480758667, 2.5169222354888916, -0.31522321701049805, 1.0904536247253418, -0.17410492897033691, 1.1876087188720703, -0.45726174116134644, 0.9025292992591858, -0.7487258911132812, -1.1316380500793457, 1.5690584182739258, 0.37222909927368164, 0.40950536727905273], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 48300, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 48300, "last_target_update_ts": 11264, "num_target_updates": 21}, "sampler_results": {"episode_reward_max": -25.12009185552597, "episode_reward_min": -403.0713306963444, "episode_reward_mean": -171.28551563899964, "episode_len_mean": 304.21875, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5362023339222414, "mean_inference_ms": 22.00042214597472, "mean_action_processing_ms": 0.142747412887405, "mean_env_wait_ms": 4.77550472771107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -25.12009185552597, "episode_reward_min": -403.0713306963444, "episode_reward_mean": -171.28551563899964, "episode_len_mean": 304.21875, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5362023339222414, "mean_inference_ms": 22.00042214597472, "mean_action_processing_ms": 0.142747412887405, "mean_env_wait_ms": 4.77550472771107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 48300, "num_env_steps_sampled": 11264, "num_env_steps_trained": 48300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 11264, "agent_timesteps_total": 11264, "timers": {"training_iteration_time_ms": 301.898, "learn_time_ms": 61.034, "learn_throughput": 4915.284, "synch_weights_time_ms": 19.861}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 48300, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 48300, "last_target_update_ts": 11264, "num_target_updates": 21}, "done": false, "episodes_total": 32, "training_iteration": 11, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-25-18", "timestamp": 1655493918, "time_this_iter_s": 4.834111928939819, "time_total_s": 53.971675634384155, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 53.971675634384155, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.99999999999999, "ram_util_percent": 59.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 2.2853267192840576, "min_q": -8.10634994506836, "max_q": 13.350362777709961, "mean_td_error": -0.36953654885292053}, "td_error": [-10.63734245300293, -1.6282801628112793, -0.5268504619598389, 0.1680774688720703, 0.985081672668457, -9.39254093170166, -5.921055793762207, 0.921333909034729, -0.1629500389099121, -1.8309624195098877, -0.44074344635009766, 0.21427130699157715, 0.3920931816101074, 0.18090581893920898, 1.8170127868652344, 0.05695152282714844, 0.04370880126953125, 0.1680774688720703, 1.7046661376953125, 0.10330963134765625, 0.8463749885559082, -0.5820512771606445, 1.5326358079910278, 0.4629659652709961, -2.34960675239563, 1.949533462524414, 1.6447782516479492, 0.15657424926757812, -0.2966032028198242, 0.1338191032409668, -0.6864509582519531, -0.5924544334411621, 0.47605419158935547, -0.1629500389099121, -2.965851306915283, 0.2802896499633789, -1.4162235260009766, -0.010715961456298828, 0.9097464084625244, -0.7240085601806641, -1.3888673782348633, -0.04412275552749634, 0.3982980251312256, 0.2531089782714844, -2.2304177284240723, 2.2514352798461914, -0.6129420399665833, 0.19297218322753906, 1.8070259094238281, -1.3546032905578613, 0.3001594543457031, 1.9338173866271973, -0.8308343887329102, -0.6522359848022461, 0.16839599609375, 1.7340893745422363, -0.3955974578857422, -1.7658824920654297, -0.03960132598876953, -1.2822768688201904, 1.2218468189239502, 0.2057476043701172, 0.6540882587432861, 4.090230464935303, -5.173454284667969, -1.2759473323822021, -2.510570526123047, -0.648198127746582, -0.046950340270996094, 0.7990782260894775, 0.2516903877258301, -0.6208300590515137, 1.706467628479004, 0.7446880340576172, 1.5544252395629883, -0.7768869400024414, -0.30488109588623047, -1.09793221950531, -3.3090131282806396, -1.9489946365356445, -0.3695608377456665, -0.1072845458984375, -3.559103012084961, -0.8883180618286133, -0.6618194580078125, -10.798527717590332, -1.4746143817901611, 0.4291210174560547, 1.234588623046875, -0.0357050895690918, 0.13434767723083496, 0.06165027618408203, 1.2108182907104492, 1.2865538597106934, -0.22205078601837158, -0.48741018772125244, -1.5670108795166016, 0.2109074592590332, -0.5597615242004395, -2.619528293609619, -1.3135433197021484, -1.6129677295684814, -0.8820159435272217, 1.2444441318511963, -0.2924518585205078, 0.49542903900146484, 0.1970219612121582, -0.28740382194519043, 1.8642597198486328, 0.383575439453125, -2.0589447021484375, 0.19881373643875122, -0.31623411178588867, -0.04075145721435547, 1.605515718460083, 0.6680047512054443, -0.1982133388519287, 2.270547866821289, 0.2109074592590332, 1.4837522506713867, 1.121577262878418, -1.6535401344299316, 2.3408730030059814, 0.21922922134399414, -1.062706470489502, -0.5113315582275391, -0.7239773273468018, 0.1386265754699707, 0.5981850624084473, -1.090916633605957, -1.2180503606796265, 1.604020357131958, -0.7547698020935059, -0.12157440185546875, 0.6824512481689453, 0.10384178161621094, 0.5620675086975098, 2.450173854827881, 0.21922922134399414, -1.0790085792541504, -0.0357050895690918, 1.5000629425048828, 0.48586511611938477, 0.41441822052001953, 2.0179824829101562, 1.1512172222137451, -0.1916813850402832, 0.04473590850830078, 3.1615803241729736, -0.9846940040588379, 0.6826286315917969, 0.38071608543395996, -2.6431140899658203, 0.12862157821655273, -0.20757389068603516, 0.7240233421325684, 0.736025333404541, -2.29951810836792, -7.276166915893555, -1.41087007522583, 1.1070356369018555, 0.921333909034729, -2.1357877254486084, -0.18334084749221802, 0.2831587791442871, -0.5431143641471863, 1.0915241241455078, -0.8279609680175781, 0.3515763282775879, -1.9861888885498047, 0.8185740113258362, 0.04276561737060547, 0.6605030298233032, -0.06781244277954102, -0.4574613571166992, -0.5808089971542358, -1.1553232669830322, -1.4954826831817627, -1.3067293167114258, 0.5224130749702454, 0.5476174354553223, -0.2626628875732422, -11.294086456298828, 0.24686181545257568, -0.12157440185546875, 4.751287460327148, 0.7605471611022949, -0.6422715187072754, -1.1085832118988037, 0.12058353424072266, -0.6517386436462402, -0.9501070976257324, -2.5611610412597656, 1.9470481872558594, -0.2157154083251953, -1.5348643064498901, 0.12829339504241943, 0.05916881561279297, -0.3457045555114746, -1.0486483573913574, -0.4256882667541504, 0.2907562255859375, 0.7276661396026611, 1.323636531829834, -0.31719970703125, -0.37201833724975586, -1.6927423477172852, 0.4260563850402832, 0.1871049404144287, 1.2387351989746094, 0.24449944496154785, -0.7882070541381836, 0.21922922134399414, -0.4357569217681885, -1.2857248783111572, -1.137804627418518, 0.17058563232421875, -0.331951379776001, 0.5990033149719238, 1.5169249773025513, 0.12862157821655273, -7.802128791809082, 0.15881967544555664, -0.15564870834350586, -0.03446674346923828, 1.2865538597106934, -0.5904664993286133, -1.8420038223266602, 1.1443705558776855, 0.05303335189819336, 0.9941387176513672, -0.6733236312866211, 1.386836051940918, 1.1512172222137451, 0.1533181071281433, 0.12862157821655273, -0.017617274075746536, 1.3368487358093262, -1.6749293804168701, -1.1275537014007568, -0.7717370986938477, -1.1995141506195068, 0.9449667930603027, -0.014041423797607422, 0.6824512481689453, 0.4258122444152832, -0.5808089971542358, -2.328428030014038, -3.3473634719848633, -2.2591209411621094, 0.7331581115722656, -0.9634504318237305, -1.5814905166625977, -1.3031327724456787, -1.7701280117034912, 0.9440150260925293, -0.47591495513916016, -0.3433527946472168, 7.49167537689209, 0.20755290985107422, -1.0845794677734375, 0.3538804054260254, -0.639228343963623, 0.04917001724243164, -10.910117149353027, -1.1945650577545166, -1.532076358795166, -0.20396137237548828, -4.534604072570801, -0.15007305145263672, -0.018540382385253906, 0.991279125213623, 1.307936668395996, -1.1036581993103027, -0.3845806121826172, -0.13168656826019287, 1.85927152633667, -0.018556594848632812, -1.6783888339996338, -9.251188278198242, 0.48499584197998047, -3.950491428375244, 0.6540882587432861, -1.6783299446105957, 0.1284494400024414, -0.2296895980834961, 1.0117857456207275, 0.14589190483093262, 0.7501323223114014, -0.989201545715332, -0.3954458236694336, 1.3721871376037598, 2.441096067428589, -0.15671682357788086, -2.2842581272125244, -0.9616994857788086, -0.4256882667541504, 1.323636531829834, -0.9129323959350586, -0.2673063278198242], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 53100, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 53100, "last_target_update_ts": 12288, "num_target_updates": 23}, "sampler_results": {"episode_reward_max": -25.12009185552597, "episode_reward_min": -403.0713306963444, "episode_reward_mean": -171.28551563899964, "episode_len_mean": 304.21875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5362023339222414, "mean_inference_ms": 22.00042214597472, "mean_action_processing_ms": 0.142747412887405, "mean_env_wait_ms": 4.77550472771107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -25.12009185552597, "episode_reward_min": -403.0713306963444, "episode_reward_mean": -171.28551563899964, "episode_len_mean": 304.21875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5362023339222414, "mean_inference_ms": 22.00042214597472, "mean_action_processing_ms": 0.142747412887405, "mean_env_wait_ms": 4.77550472771107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 53100, "num_env_steps_sampled": 12288, "num_env_steps_trained": 53100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 12288, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 313.657, "learn_time_ms": 61.073, "learn_throughput": 4912.166, "synch_weights_time_ms": 19.795}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 53100, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 53100, "last_target_update_ts": 12288, "num_target_updates": 23}, "done": false, "episodes_total": 32, "training_iteration": 12, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-25-23", "timestamp": 1655493923, "time_this_iter_s": 5.09894323348999, "time_total_s": 59.070618867874146, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 59.070618867874146, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.342857142857145, "ram_util_percent": 59.71428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 2.8688924312591553, "min_q": -9.248141288757324, "max_q": 13.35468864440918, "mean_td_error": 0.18388743698596954}, "td_error": [-1.6658046245574951, 0.39492321014404297, -0.3241100311279297, 0.9600429534912109, 0.5613431930541992, -0.0022516250610351562, 2.528024673461914, 0.5797625780105591, 0.6957180500030518, -0.6940727233886719, 2.0510196685791016, 0.5613431930541992, 0.8568658828735352, 1.2373723983764648, 0.8368692398071289, 0.1625230312347412, 0.7790489196777344, -0.6676568984985352, -0.5732054710388184, 0.787137508392334, -7.160188674926758, 0.7986788749694824, -0.48090028762817383, 1.4154653549194336, 1.6656274795532227, 3.406811237335205, -0.13279414176940918, -7.006932258605957, -0.44818925857543945, -7.814650535583496, 0.07460212707519531, 0.646939754486084, 0.8368692398071289, 0.8933053016662598, 0.29603099822998047, 1.0727920532226562, -1.1236143112182617, 4.064333915710449, 0.3460923433303833, 3.2167043685913086, 0.4064524173736572, -1.7655222415924072, -0.4880099296569824, 1.4304380416870117, 2.04199481010437, -0.6543617248535156, 0.8543071746826172, 0.6580331325531006, 1.677995204925537, -0.05567455291748047, 0.7178363800048828, 0.888340950012207, 0.9484330415725708, 0.21581554412841797, 0.39600086212158203, 2.387929916381836, 1.9809556007385254, 1.6719207763671875, -0.012883186340332031, 1.333165168762207, 0.3926811218261719, 1.5594182014465332, 0.023657798767089844, -0.6692728996276855, 0.41351747512817383, -1.7486820220947266, 1.137556552886963, 0.8670473098754883, 1.6656274795532227, 0.27918052673339844, 0.032958030700683594, -0.25826168060302734, 0.42529892921447754, -0.14463376998901367, 0.5692739486694336, 1.5102195739746094, 0.39246082305908203, -0.9616022109985352, 0.30037808418273926, -0.784184455871582, -4.285898208618164, 1.2527742385864258, 2.982481002807617, 1.1447763442993164, -0.7598371505737305, 1.9225242137908936, 1.9038114547729492, -0.7315185070037842, 0.2042536735534668, 1.8985633850097656, 2.882460594177246, -0.9390716552734375, -5.495566368103027, 0.31857454776763916, 0.9199652671813965, 1.1887683868408203, -2.272373914718628, -0.47855544090270996, 3.406811237335205, 1.0691566467285156, 0.42721986770629883, 0.6320714950561523, 1.5998231172561646, 0.23220062255859375, 2.3877410888671875, -1.672670841217041, 0.41290199756622314, -0.12797856330871582, -0.08868885040283203, 0.25096654891967773, 1.8868076801300049, -7.628233909606934, 1.9240397214889526, 3.361208438873291, 0.07575678825378418, -0.7186489105224609, -0.9312162399291992, 1.5849828720092773, 0.9720983505249023, 1.176173210144043, -5.558486461639404, 1.0028281211853027, 0.7532854080200195, -0.8287937641143799, 2.553262710571289, 0.37727928161621094, 0.06716489791870117, 0.7050704956054688, -0.8215923309326172, 2.3134775161743164, 0.3592567443847656, -0.03906440734863281, 0.23490047454833984, -6.548074722290039, 1.2792110443115234, 0.6458725929260254, 2.5878870487213135, 1.3082528114318848, -1.2091808319091797, -0.5336170196533203, -1.9642707109451294, -0.8121376037597656, 2.6326422691345215, -0.28147125244140625, 1.2094359397888184, -0.18077826499938965, -0.024068832397460938, 1.8562545776367188, 0.2640681266784668, -0.3241100311279297, -2.018047332763672, -9.64191722869873, -0.23313426971435547, -0.6828498840332031, -0.25244760513305664, -0.30028390884399414, 1.225553035736084, 2.0510196685791016, 0.468780517578125, 0.09216594696044922, 0.520341157913208, 1.3136883974075317, 2.1109352111816406, 1.6217689514160156, 1.22953462600708, 0.5451130867004395, 0.2892436981201172, -5.553022861480713, -0.9084963798522949, 0.6252803802490234, 0.1887655258178711, 3.076552391052246, -1.3905463218688965, 0.4233419895172119, -0.8420352935791016, 2.6602556705474854, 2.0361571311950684, 0.9013829231262207, -0.3932224214076996, -0.10819339752197266, 0.35123252868652344, 2.2614641189575195, -1.1582956314086914, 0.7050704956054688, 2.0607361793518066, 0.645477294921875, 0.10766029357910156, -0.7325436472892761, 0.904088020324707, -1.1136598587036133, 2.0527515411376953, 1.7195262908935547, 1.137556552886963, 0.47086000442504883, 0.09401154518127441, -0.23263120651245117, -0.818760871887207, 0.37784385681152344, -4.638835906982422, 0.47142696380615234, 0.3000912666320801, -1.549715518951416, -10.872573852539062, -0.6274471282958984, 0.4058365821838379, -0.7716410160064697, -0.4553861618041992, -0.35575294494628906, 2.061641216278076, 1.4304380416870117, -9.604506492614746, -4.125419616699219, 0.5027027130126953, 0.16588783264160156, 2.163011074066162, 0.1750349998474121, 1.5114744901657104, 0.3455190658569336, 0.1682605743408203, 0.6321210861206055, -1.3525100946426392, -0.09026575088500977, 1.0824337005615234, 0.646939754486084, 1.2686185836791992, 2.251546859741211, 0.5668635368347168, 3.533784866333008, -0.07378482818603516, 0.4388270378112793, 1.1155362129211426, 1.5338668823242188, 0.0443953275680542, 0.42996788024902344, 1.1770753860473633, -1.9690334796905518, -0.9965486526489258, -7.572323799133301, 1.1482667922973633, 1.369807243347168, 0.5756001472473145, -0.14345693588256836, 2.053255081176758, 1.1836624145507812, 1.4908502101898193, 4.428401470184326, 2.507338523864746, 0.8559699058532715, 0.3017575740814209, 2.1174726486206055, 2.0584828853607178, 0.8287248611450195, 1.7515416145324707, -6.434299468994141, 1.4747686386108398, 1.5517730712890625, -0.2049083709716797, -1.2155265808105469, 2.6662306785583496, 1.5621728897094727, -7.788904190063477, 1.9603898525238037, -0.792696475982666, 1.137556552886963, 3.2107224464416504, 0.17319488525390625, -0.23596954345703125, -0.6828498840332031, 0.4789886474609375, 1.020754337310791, -0.32492494583129883, -0.24884033203125, 3.042837142944336, 0.4014883041381836, 1.4935884475708008, 0.9940838813781738, 1.6533098220825195, -0.6679520606994629, 2.375494956970215, -6.9929327964782715, -0.7970523834228516, -2.30881404876709, 3.2167043685913086, 1.0577805042266846, -1.5545520782470703, 0.6982765197753906, 0.8802599906921387, -1.7276711463928223, 0.6877527236938477, 2.258939027786255, 1.6486997604370117, 0.6877527236938477, -0.6932873725891113, 0.22856676578521729, 1.751387357711792, 2.2529044151306152, -0.7601885795593262, 1.5799880027770996, -0.15382003784179688, 0.6409077644348145], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 57900, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 57900, "last_target_update_ts": 13312, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": -25.12009185552597, "episode_reward_min": -403.0713306963444, "episode_reward_mean": -171.28551563899964, "episode_len_mean": 304.21875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5362023339222414, "mean_inference_ms": 22.00042214597472, "mean_action_processing_ms": 0.142747412887405, "mean_env_wait_ms": 4.77550472771107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -25.12009185552597, "episode_reward_min": -403.0713306963444, "episode_reward_mean": -171.28551563899964, "episode_len_mean": 304.21875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5362023339222414, "mean_inference_ms": 22.00042214597472, "mean_action_processing_ms": 0.142747412887405, "mean_env_wait_ms": 4.77550472771107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 57900, "num_env_steps_sampled": 13312, "num_env_steps_trained": 57900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 13312, "agent_timesteps_total": 13312, "timers": {"training_iteration_time_ms": 325.986, "learn_time_ms": 61.613, "learn_throughput": 4869.124, "synch_weights_time_ms": 19.49}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 57900, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 57900, "last_target_update_ts": 13312, "num_target_updates": 25}, "done": false, "episodes_total": 32, "training_iteration": 13, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-25-29", "timestamp": 1655493929, "time_this_iter_s": 5.162949562072754, "time_total_s": 64.2335684299469, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 64.2335684299469, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 34.32857142857143, "ram_util_percent": 59.77142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 2.644922971725464, "min_q": -9.271968841552734, "max_q": 16.11861801147461, "mean_td_error": -0.08257747441530228}, "td_error": [0.4375467300415039, -0.9808237552642822, -0.37699568271636963, -0.15992069244384766, 2.5841150283813477, 0.09720325469970703, 1.7379496097564697, 0.0009980201721191406, 1.2268643379211426, 3.092712163925171, 0.2246837615966797, -0.6477980613708496, 0.7528777718544006, 0.1516127586364746, 2.5615110397338867, -0.07070696353912354, -0.34328603744506836, 0.15967559814453125, -9.035905838012695, -0.47287559509277344, 1.776869773864746, -7.810265064239502, 2.8111653327941895, 0.32587385177612305, -5.0854339599609375, 0.8665452003479004, -1.0942564010620117, 1.7698767185211182, 1.5382814407348633, -0.21344614028930664, -0.13170528411865234, 0.8472490310668945, 1.0597457885742188, 1.23677396774292, -0.6156978607177734, 0.9839115142822266, 1.0912857055664062, 0.6469531059265137, -0.18828344345092773, 1.3163185119628906, 1.8425111770629883, -1.1768584251403809, 8.226943969726562, -0.17316722869873047, 1.3910150527954102, 1.6712408065795898, 1.6348817348480225, 1.6922845840454102, 0.9978961944580078, -0.5274753570556641, 1.8708372116088867, 1.0889129638671875, 0.7737979888916016, -3.3701281547546387, 0.2802925109863281, 2.271340847015381, 1.3176038265228271, -0.561408519744873, 0.7108030319213867, -6.240211486816406, -0.3375091552734375, -1.9207191467285156, 0.4710383415222168, 0.7176213264465332, 0.8527436256408691, 2.084073066711426, -0.09957218170166016, -0.8338348865509033, 0.865077018737793, 0.08465909957885742, 1.6779742240905762, 0.0686381459236145, -7.440673828125, 0.0973978042602539, 2.0084340572357178, 0.6624064445495605, 1.0223462581634521, 0.28337574005126953, -0.030274391174316406, 0.5281233787536621, 2.394472122192383, 0.8464860916137695, 0.42083024978637695, 0.7965850830078125, 0.3625977039337158, -1.34079110622406, 0.6800346374511719, -0.28336477279663086, 0.7237262725830078, 1.9635019302368164, 1.3356750011444092, -0.24765539169311523, -1.0443344116210938, 1.1507229804992676, -8.934144973754883, 0.7887210845947266, -0.6426000595092773, -7.158531665802002, 0.9076447486877441, 1.864588737487793, -2.3314943313598633, 1.6332192420959473, -0.3435325622558594, 0.8874015808105469, 0.6280312538146973, -0.8962230682373047, 2.303478240966797, 0.03697609901428223, -6.560694694519043, 0.29066991806030273, 0.8583548069000244, -0.45560216903686523, 1.917675256729126, 0.2741518020629883, -0.5276851654052734, 1.0279121398925781, 0.22896051406860352, -3.034228563308716, 0.25521421432495117, -0.11838245391845703, 0.5665605068206787, 1.8974437713623047, -0.15480709075927734, 0.43971681594848633, -4.810583114624023, 1.092362403869629, 1.2689838409423828, -0.06137418746948242, 1.864588737487793, -1.0446090698242188, 1.4320154190063477, 1.4013051986694336, 1.891331672668457, -1.2687358856201172, 0.062007904052734375, 0.3265190124511719, 1.2296764850616455, -4.025278091430664, -1.5661892890930176, 0.20633220672607422, -0.8950395584106445, 1.5798544883728027, -0.9903359413146973, 1.23677396774292, -1.1084463596343994, -0.1054987907409668, 0.9559314250946045, 0.3302421569824219, 0.6637415885925293, -1.6597886085510254, 1.12361478805542, 0.9384746551513672, -0.8856220245361328, -0.8291130065917969, -0.36087512969970703, -4.517156600952148, 1.1309900283813477, -7.1420674324035645, 0.4176297187805176, 0.5925235748291016, -0.47287559509277344, 0.9978961944580078, -0.36191797256469727, 1.5754365921020508, 1.7585062980651855, -0.08304119110107422, 1.5676398277282715, -0.638742208480835, 0.9709455966949463, 0.9322700500488281, 0.007884025573730469, -12.456626892089844, -1.4490299224853516, -0.43955469131469727, 1.1041316986083984, 0.23462486267089844, 1.4541759490966797, -2.2680091857910156, -2.907339572906494, 0.08127498626708984, 0.3023490905761719, -0.4981727600097656, 1.083695411682129, 1.7452526092529297, -3.6114273071289062, -0.5355730056762695, 0.4567718505859375, -5.4529008865356445, -7.0611748695373535, -1.0221672058105469, 1.6661958694458008, -1.746140480041504, 1.4541759490966797, 1.213785171508789, -0.2206134796142578, 0.6616888046264648, -1.5120575428009033, 0.3378572463989258, 0.4453859329223633, 1.6641838550567627, 1.6731948852539062, 0.33406877517700195, -2.1180543899536133, 0.1928699016571045, -1.4508976936340332, -0.6647787094116211, 3.079676628112793, 0.4571709632873535, 1.9549455642700195, 0.11653518676757812, 3.1116647720336914, 1.2375354766845703, -4.307040214538574, 1.8995485305786133, -7.323483467102051, 1.0517866611480713, 0.27156734466552734, -9.923423767089844, -0.22899150848388672, 1.2482528686523438, 0.4037590026855469, 2.2475852966308594, 0.32256412506103516, 0.642970085144043, 1.7698767185211182, -0.4380922317504883, 0.2873501777648926, 1.667420506477356, -0.5530645847320557, 1.4970340728759766, 1.9550137519836426, 0.44070732593536377, -0.6281394362449646, 0.07031011581420898, 2.8111653327941895, 0.943055272102356, -0.1715087890625, -6.4173688888549805, 1.2943849563598633, 1.8835210800170898, 1.6851954460144043, 0.6450119018554688, 0.17539310455322266, -1.7528291940689087, -5.992260932922363, 0.7682456970214844, 1.808180809020996, 0.18643474578857422, 0.021997451782226562, 1.586437702178955, 0.5175597667694092, 1.2372932434082031, 1.9246742725372314, 1.2609126567840576, -0.29865550994873047, 0.18582916259765625, 3.890725612640381, 1.3910150527954102, 2.316129684448242, -5.015992164611816, -2.18033504486084, -2.0198373794555664, -6.5400238037109375, -0.32151222229003906, -0.14979934692382812, -5.583062171936035, -0.20114612579345703, 0.29201745986938477, 1.4261293411254883, 2.2475852966308594, 0.7263846397399902, -5.396916389465332, -0.20114612579345703, 1.8654818534851074, -0.32004356384277344, 0.5078105926513672, -0.3402996063232422, 0.1589217185974121, 1.1890661716461182, 0.6450119018554688, 0.24795150756835938, 3.3074440956115723, -0.7198281288146973, 0.4049968719482422, -1.1084463596343994, -0.22825407981872559, 2.545438766479492, 0.9452848434448242, 2.2916157245635986, 0.8569850921630859, -0.22852659225463867, 0.7682456970214844, 0.00145721435546875, -2.6515302658081055, -0.985654354095459, -0.013838529586791992, 0.5148134231567383, -0.555781364440918, -0.28336477279663086, -0.2823934555053711], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 62700, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 62700, "last_target_update_ts": 14336, "num_target_updates": 27}, "sampler_results": {"episode_reward_max": -25.12009185552597, "episode_reward_min": -403.0713306963444, "episode_reward_mean": -172.25147350945255, "episode_len_mean": 304.45454545454544, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5367692673214342, "mean_inference_ms": 22.020451059485357, "mean_action_processing_ms": 0.14301363317630028, "mean_env_wait_ms": 4.768491721300291, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -25.12009185552597, "episode_reward_min": -403.0713306963444, "episode_reward_mean": -172.25147350945255, "episode_len_mean": 304.45454545454544, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5367692673214342, "mean_inference_ms": 22.020451059485357, "mean_action_processing_ms": 0.14301363317630028, "mean_env_wait_ms": 4.768491721300291, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 62700, "num_env_steps_sampled": 14336, "num_env_steps_trained": 62700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 14336, "agent_timesteps_total": 14336, "timers": {"training_iteration_time_ms": 336.344, "learn_time_ms": 62.669, "learn_throughput": 4787.04, "synch_weights_time_ms": 20.189}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 62700, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 62700, "last_target_update_ts": 14336, "num_target_updates": 27}, "done": false, "episodes_total": 33, "training_iteration": 14, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-25-34", "timestamp": 1655493934, "time_this_iter_s": 5.341498136520386, "time_total_s": 69.57506656646729, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 69.57506656646729, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.525000000000006, "ram_util_percent": 59.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 1.8592958450317383, "min_q": -12.078686714172363, "max_q": 16.161739349365234, "mean_td_error": -0.31169718503952026}, "td_error": [0.005062103271484375, -0.6337010264396667, -0.3689432144165039, 0.05264759063720703, -5.645510673522949, 0.9469127655029297, 2.0581517219543457, -1.2244863510131836, -3.4763314723968506, -1.4617328643798828, 1.7297048568725586, 0.009167730808258057, -0.5724582672119141, -1.2974176406860352, -0.5394315719604492, -0.06803417205810547, 1.0566024780273438, -1.385178565979004, -0.9507980346679688, -0.659949779510498, 0.14917659759521484, -1.1379318237304688, -0.1974802017211914, -0.8662676811218262, -0.43928050994873047, -1.5647108554840088, -1.0202693939208984, -1.4651830196380615, 0.5603370666503906, -0.5537567138671875, -1.9743760824203491, -0.6144523620605469, 1.79848051071167, -1.2386959791183472, 0.009167730808258057, -0.8896694183349609, -0.5763235092163086, -1.9091391563415527, 0.34453868865966797, 1.8068323135375977, -0.1278085708618164, 0.3132908344268799, -7.574224472045898, -1.6737051010131836, -0.3756589889526367, 0.17097759246826172, -1.2978739738464355, -0.09794473648071289, -0.2646951675415039, 2.18918514251709, -1.169590950012207, 0.36227893829345703, 0.4886035919189453, -1.2068328857421875, 1.8447542190551758, 1.2689876556396484, -1.2702741622924805, 0.4886035919189453, -0.4739910960197449, -1.4373674392700195, 0.20422792434692383, 1.7974742650985718, 0.3538222908973694, -2.599255084991455, -3.17042875289917, 0.2555807828903198, -0.12042903900146484, 0.43749332427978516, 0.08882904052734375, 1.2565269470214844, -0.9070148468017578, 0.41438066959381104, -3.17042875289917, -1.7747468948364258, -0.7432310581207275, 0.7939529418945312, -0.3292055130004883, 1.0871148109436035, 0.45226019620895386, -0.46240901947021484, -0.0488734245300293, 0.7819929122924805, -1.287999153137207, 2.186983585357666, 0.13486671447753906, 0.26479244232177734, -1.6511569023132324, -0.2616095542907715, -6.476891994476318, -0.04868507385253906, -1.3109756708145142, 2.239807605743408, 0.4105492830276489, 0.6715452671051025, 1.464505672454834, 1.036606788635254, 0.8087348937988281, -0.15276718139648438, -0.02649402618408203, -0.20584917068481445, 1.6184097528457642, -0.3219943046569824, -1.2244863510131836, 0.37320804595947266, 2.066761016845703, -0.9728989601135254, -1.2007637023925781, -1.6803884506225586, 0.00705718994140625, -0.4107457399368286, 0.7922544479370117, 1.5127644538879395, 0.011395454406738281, 1.731306552886963, 0.24736320972442627, -0.4739910960197449, 1.801849365234375, -4.873724937438965, -0.8776473999023438, 2.5225157737731934, -0.5484762191772461, 1.7866201400756836, -0.47143030166625977, 0.9499436616897583, -0.19295883178710938, -0.2524752616882324, 0.49063754081726074, 0.24732255935668945, -1.7375537157058716, -0.687436580657959, -4.740864276885986, 0.8155595064163208, -1.4921382665634155, -0.16884493827819824, 1.2776556015014648, 0.3006877899169922, -10.221227645874023, 0.11907815933227539, 0.03560137748718262, 0.9469127655029297, 2.059004545211792, -0.14633750915527344, -0.4107457399368286, -1.0936474800109863, 3.0532188415527344, 1.529982089996338, -0.6000728607177734, -10.966135025024414, 0.8482990264892578, 1.035642147064209, -0.7803912162780762, 1.8068323135375977, -5.74678897857666, -0.609435498714447, 1.808802604675293, -2.0658459663391113, -0.2592182159423828, -0.18424081802368164, 0.6500964164733887, 2.6031103134155273, -3.2262682914733887, -0.2298874855041504, 0.9724817276000977, -0.7056446075439453, -0.1810903549194336, 1.240311622619629, -1.4257192611694336, -0.13352596759796143, -0.8208847045898438, 0.5336318016052246, 0.3925304412841797, -0.31706905364990234, 0.7470912933349609, -1.566685438156128, 0.29105710983276367, -0.1942734718322754, -0.5925989151000977, -1.9959068298339844, -5.467874526977539, 2.0117015838623047, 0.3567070960998535, 0.42572689056396484, 0.39151763916015625, 0.7910785675048828, -2.4715476036071777, 0.5164089202880859, 0.26315784454345703, 2.243229866027832, 1.0391559600830078, 0.24736320972442627, -1.1449203491210938, 0.7103745937347412, 0.13083648681640625, -1.0112781524658203, -0.16884493827819824, -3.080979347229004, -0.12042903900146484, -0.17895793914794922, 0.4590134620666504, -0.7274101972579956, -1.8801517486572266, -1.0333566665649414, 2.8310585021972656, 0.9618968963623047, -0.5763235092163086, -2.3022494316101074, -0.41493988037109375, -3.3910350799560547, -0.6111679077148438, 1.1687283515930176, 0.6187601089477539, -2.4729573726654053, 0.7652349472045898, 0.6546909809112549, 1.0402545928955078, 2.6031103134155273, -1.0368237495422363, -7.256752967834473, -3.2657241821289062, 1.1906089782714844, -0.786583423614502, 0.10181999206542969, 0.24895071983337402, -0.12042903900146484, 0.6783308982849121, -0.20843124389648438, -0.6372108459472656, -0.8531570434570312, 0.32763195037841797, -1.082216501235962, 0.011395454406738281, 2.0273990631103516, 0.9724817276000977, -0.29992103576660156, 0.41364431381225586, 0.043839454650878906, 0.6041326522827148, 0.6446318626403809, 0.5059839487075806, 1.7304449081420898, 1.4697751998901367, 0.5970306396484375, 1.5114850997924805, 1.4831781387329102, -0.1430349349975586, -0.46294939517974854, 0.5671563148498535, -1.1930913925170898, -0.27281951904296875, 0.6237354278564453, 1.138491153717041, -0.14120829105377197, -0.42119884490966797, -3.6434249877929688, 0.20206022262573242, -2.0919508934020996, 0.07166385650634766, 0.45226019620895386, -1.3196065425872803, 0.8106670379638672, 3.4509592056274414, 0.07499170303344727, -0.4979267120361328, -4.160744667053223, -0.23485714197158813, 0.5798290967941284, 0.5905814170837402, -1.8096861839294434, -2.1988134384155273, 0.043839454650878906, -0.3486309051513672, 0.09640121459960938, -0.6133975982666016, -0.022812843322753906, -0.9827866554260254, 0.20017242431640625, 0.6739311218261719, -0.6051654815673828, -6.511456489562988, 0.5876955986022949, -4.684853553771973, 0.2366795539855957, 2.472832679748535, -0.4161214828491211, -1.1930913925170898, -0.1396312713623047, 1.697396993637085, -1.8507561683654785, -1.25254487991333, 0.3070068359375, 1.7391958236694336, -0.29638195037841797, -0.19895005226135254, -1.6521782875061035, 0.24690818786621094, -1.223210334777832, 1.448150634765625, 1.7179689407348633, 2.059004545211792, 0.023324966430664062], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 67500, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 67500, "last_target_update_ts": 15360, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": -25.12009185552597, "episode_reward_min": -465.52141908556223, "episode_reward_mean": -188.34818394274214, "episode_len_mean": 312.48837209302326, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5304862388235743, "mean_inference_ms": 22.260110052850095, "mean_action_processing_ms": 0.14122396256113215, "mean_env_wait_ms": 4.6572787895039305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -25.12009185552597, "episode_reward_min": -465.52141908556223, "episode_reward_mean": -188.34818394274214, "episode_len_mean": 312.48837209302326, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5304862388235743, "mean_inference_ms": 22.260110052850095, "mean_action_processing_ms": 0.14122396256113215, "mean_env_wait_ms": 4.6572787895039305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 67500, "num_env_steps_sampled": 15360, "num_env_steps_trained": 67500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 15360, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 377.159, "learn_time_ms": 62.879, "learn_throughput": 4771.076, "synch_weights_time_ms": 19.363}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 67500, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 67500, "last_target_update_ts": 15360, "num_target_updates": 29}, "done": false, "episodes_total": 43, "training_iteration": 15, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-25-40", "timestamp": 1655493940, "time_this_iter_s": 5.9264349937438965, "time_total_s": 75.50150156021118, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 75.50150156021118, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.299999999999997, "ram_util_percent": 59.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 2.747915029525757, "min_q": -14.03356647491455, "max_q": 17.742334365844727, "mean_td_error": -1.137617826461792}, "td_error": [-0.8375062942504883, 0.00202178955078125, -0.123016357421875, -0.6432323455810547, -1.1405820846557617, -7.003650665283203, -0.2406749725341797, -2.352849006652832, -1.1161607503890991, 0.2642641067504883, 0.7366039752960205, -0.8718173503875732, -0.49994373321533203, -0.5694518089294434, 0.33769845962524414, -1.3640713691711426, 0.07640552520751953, -0.281644344329834, -0.13097763061523438, -0.773961067199707, 0.10052490234375, 1.5061683654785156, -0.7336167097091675, -0.08401298522949219, -0.2389965057373047, -0.292163610458374, -1.118551254272461, -0.7834310531616211, -0.6248726844787598, 2.1866683959960938, -1.202651023864746, -0.15166759490966797, 0.29131555557250977, -0.3928041458129883, -2.5730113983154297, -10.701177597045898, -1.0469131469726562, 0.6353347301483154, -10.803459167480469, -0.3592963218688965, -1.383108139038086, 1.4287004470825195, 0.9050092697143555, -0.3150177001953125, -0.479095458984375, -2.2523624897003174, 0.5236167907714844, 0.9719333648681641, -0.0962362289428711, 0.2387228012084961, 0.3143444061279297, -1.5737037658691406, -0.8590033054351807, 0.4866600036621094, -4.756107330322266, -0.7738151550292969, -3.7471630573272705, 14.874246597290039, -0.6891607046127319, -9.343152046203613, 0.16955280303955078, -0.621968150138855, -1.3632354736328125, -1.4230537414550781, -2.6291399002075195, -1.06430983543396, 0.41869115829467773, 2.1379241943359375, -1.1380128860473633, -0.3255481719970703, -1.4894886016845703, 0.2642641067504883, -0.9187054634094238, -1.6454553604125977, 0.981602668762207, -1.741818904876709, -0.881095290184021, -0.30586719512939453, -0.8503860235214233, -0.2445077896118164, -0.010042905807495117, -1.5415217876434326, -7.938605785369873, -0.5080956220626831, -0.6172821521759033, -0.8047924041748047, -1.2773470878601074, -2.2915143966674805, 2.1866683959960938, -8.270522117614746, 0.17936921119689941, -1.2076034545898438, -2.0986833572387695, -1.0155272483825684, -0.6706442832946777, -0.4229699373245239, -5.617645740509033, -0.28537654876708984, -0.7544136047363281, -10.563923835754395, 0.3716821074485779, -3.3675036430358887, -1.85675048828125, 0.5562152862548828, -3.5554451942443848, -0.5974931716918945, -0.4412369728088379, -1.3560805320739746, -0.19103431701660156, -1.19179105758667, -0.23044061660766602, 0.405609130859375, 0.3078289031982422, -1.140242099761963, -0.7961888313293457, -1.2918462753295898, -1.7559800148010254, -0.20790553092956543, -1.0419702529907227, -0.11667156219482422, 0.2249441146850586, 0.6490950584411621, -0.6240072250366211, -1.4153022766113281, -6.668839931488037, -0.18210220336914062, -1.179220199584961, -0.10423707962036133, 0.7612237930297852, -7.162413597106934, -0.2803077697753906, -0.7724862098693848, 0.11279129981994629, 0.09198665618896484, -1.6043002605438232, -1.4563846588134766, 0.032103538513183594, -0.7385187149047852, -1.5322723388671875, -1.8595631122589111, -1.5174026489257812, -0.15396495163440704, 1.4219646453857422, -1.3747715950012207, -0.48903369903564453, -0.35291528701782227, -1.6290385723114014, -2.0973892211914062, -11.063018798828125, -0.5125412940979004, 0.22730684280395508, -0.6489825248718262, -1.4624040126800537, -0.19342494010925293, -5.13612174987793, -2.2964744567871094, -1.1919317245483398, -1.5734000205993652, 0.6061086654663086, -7.025289058685303, -2.120347023010254, -8.22050666809082, -2.7738137245178223, -9.579652786254883, 2.0264244079589844, -2.2418088912963867, -1.7286524772644043, 0.47671031951904297, -0.21346718072891235, -0.06594181060791016, -0.40597057342529297, -7.994445323944092, -5.286005020141602, -1.15745210647583, -6.202493667602539, 0.25031280517578125, -0.9665451049804688, -0.49506282806396484, -0.0779728889465332, -0.3529781103134155, -0.6528975963592529, -1.842376708984375, -1.4163321256637573, -4.54026985168457, -1.0044069290161133, -0.33275318145751953, -0.32332277297973633, -2.3314104080200195, -0.639866828918457, -2.8208794593811035, -1.920520305633545, -0.2252974808216095, 1.8992379903793335, -0.8589444160461426, -0.37071704864501953, -1.409433364868164, 1.1956119537353516, -0.8551120758056641, 0.601710319519043, -0.8255214691162109, -0.78277587890625, -0.65106201171875, -0.08310508728027344, -2.2187185287475586, 0.2387228012084961, -1.900238275527954, 0.11279129981994629, -0.1488962173461914, 0.8751201629638672, 2.1604957580566406, -0.899714469909668, -0.6512050628662109, -5.13612174987793, -1.2290287017822266, -8.264375686645508, 1.7569169998168945, -0.863093376159668, -0.6200056076049805, -0.3069915771484375, -0.10094356536865234, -1.400695562362671, -0.708038330078125, -0.16989898681640625, -4.417533874511719, -1.0001640319824219, -1.1271506547927856, -2.6291399002075195, -1.278243064880371, -0.6586894989013672, -1.5958285331726074, -1.2652087211608887, -1.2132129669189453, -7.869288444519043, -0.06411933898925781, -0.9521255493164062, -1.5906744003295898, -1.095606803894043, 0.006587028503417969, -0.8969295620918274, -2.3048744201660156, 1.5628929138183594, 0.7390151023864746, 0.8006823062896729, 0.17936921119689941, -0.3279060125350952, 0.7052618861198425, -0.16637694835662842, 0.27607059478759766, -0.9535870552062988, -1.029623031616211, -0.14381623268127441, 0.20107460021972656, 0.6061086654663086, -1.0363178253173828, -1.1114578247070312, -2.474379301071167, -3.104541301727295, -0.679102897644043, 0.7192902565002441, 1.0107054710388184, 0.6061086654663086, -0.048427581787109375, -2.3883237838745117, 0.662440299987793, -0.13845157623291016, 0.7628622055053711, -1.1957063674926758, -9.101243019104004, -1.2447006702423096, -1.101125717163086, 0.05501699447631836, -5.937716007232666, -0.48790931701660156, -0.978703498840332, 0.5236167907714844, -1.2230596542358398, 1.6063718795776367, -0.21956825256347656, -0.03453540802001953, -2.11942458152771, -1.6223578453063965, 1.0720500946044922, -1.0793464183807373, 0.2398991584777832, -1.644986629486084, 0.974095344543457, -2.8137364387512207, -0.5223140716552734, -0.3477787971496582, -0.36209142208099365, 0.6062417030334473, -0.9768829345703125, 0.2620534896850586, -0.3690314292907715, -0.517087459564209, 0.41869115829467773, -2.565539836883545, -1.6928431987762451, -2.626183271408081, -1.4301719665527344], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 72300, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 72300, "last_target_update_ts": 16384, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": -25.12009185552597, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -200.26741382035803, "episode_len_mean": 317.3404255319149, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5260892347058959, "mean_inference_ms": 22.287869723608754, "mean_action_processing_ms": 0.14040919436148552, "mean_env_wait_ms": 4.617276593522479, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -25.12009185552597, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -200.26741382035803, "episode_len_mean": 317.3404255319149, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5260892347058959, "mean_inference_ms": 22.287869723608754, "mean_action_processing_ms": 0.14040919436148552, "mean_env_wait_ms": 4.617276593522479, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 72300, "num_env_steps_sampled": 16384, "num_env_steps_trained": 72300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 16384, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 342.604, "learn_time_ms": 62.539, "learn_throughput": 4797.003, "synch_weights_time_ms": 20.176}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 72300, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 72300, "last_target_update_ts": 16384, "num_target_updates": 31}, "done": false, "episodes_total": 47, "training_iteration": 16, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-25-46", "timestamp": 1655493946, "time_this_iter_s": 5.414955139160156, "time_total_s": 80.91645669937134, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 80.91645669937134, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.487499999999997, "ram_util_percent": 60.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 3.760634422302246, "min_q": -15.1426362991333, "max_q": 17.796796798706055, "mean_td_error": -0.4533902406692505}, "td_error": [-0.11075496673583984, 0.2028207778930664, -2.082758903503418, -0.8561253547668457, 1.6860074996948242, 0.4726734161376953, -0.6250104904174805, -0.7768697738647461, 0.222381591796875, -0.1121678352355957, 1.5184125900268555, 1.375702142715454, -0.4419877529144287, -1.395448923110962, 0.1570974588394165, -2.0923967361450195, 0.4318584203720093, 0.1658024787902832, 2.577755928039551, -2.8582870960235596, -1.445359230041504, 0.03996849060058594, 0.46396827697753906, -10.150201797485352, 0.9036741256713867, 1.0580711364746094, -1.6384029388427734, -0.8577127456665039, -0.11929750442504883, 0.5854475498199463, -0.9367208480834961, -0.6553440093994141, 0.945439338684082, 3.4897513389587402, 0.37961387634277344, 1.0021920204162598, -2.281867265701294, -1.451526165008545, 1.2937650680541992, -0.5644502639770508, -3.427046060562134, 0.13519859313964844, -0.9412760734558105, -1.9001765251159668, -1.4403114318847656, 0.6610269546508789, 1.1716985702514648, -0.34529781341552734, 0.055384278297424316, -1.7395727634429932, 0.016126632690429688, 0.14501452445983887, -10.150201797485352, -0.5216007232666016, -0.9367208480834961, -1.147942066192627, 0.5452413558959961, -1.50799560546875, 0.630340576171875, -0.9316287040710449, -0.1840658187866211, 0.26790809631347656, -0.5535030364990234, 2.03692626953125, -0.1291208267211914, 0.5767412185668945, 0.26244163513183594, -0.4237222671508789, 1.0021920204162598, -2.5289382934570312, 0.9892578125, 0.5393705368041992, -1.1953964233398438, 0.3190116882324219, 1.7369499206542969, 0.050289154052734375, 1.08837890625, 0.8401520252227783, -0.32899951934814453, -0.3353625535964966, -1.9063615798950195, -0.5905911922454834, 1.247835397720337, 0.2943902015686035, 0.6256961822509766, 1.006345272064209, 2.1466217041015625, -0.2921276092529297, -5.106209754943848, 1.2151718139648438, 1.5853004455566406, -1.50799560546875, 0.647178590297699, -0.41373205184936523, 0.49606895446777344, -1.465336799621582, 1.7679033279418945, -1.3806934356689453, -0.24306583404541016, -1.290316104888916, 0.7936506271362305, -0.29033613204956055, -1.6619138717651367, -0.6239619255065918, -0.3879718780517578, -1.7395727634429932, 0.4262118339538574, -0.11771202087402344, 0.3736295700073242, -0.7390103340148926, 2.7039804458618164, -0.8908166885375977, 0.44022560119628906, 0.04065704345703125, 1.4316082000732422, -0.8534736633300781, -1.8057613372802734, -1.130743384361267, 0.2993736267089844, -0.5914754867553711, 0.15844058990478516, 0.13445377349853516, -0.511805534362793, 1.1263384819030762, -1.2154674530029297, 0.2200145721435547, -1.7251300811767578, 0.8011245727539062, -7.182854175567627, -0.07895410060882568, 1.3381128311157227, -10.063383102416992, -2.0711841583251953, -0.61231529712677, -1.262441635131836, 1.233283519744873, -0.46575355529785156, -7.997363090515137, 1.8584784269332886, 0.09814929962158203, 0.3438377380371094, 0.06752538681030273, -0.1483297348022461, -6.596890449523926, 0.3320131301879883, -0.23079395294189453, -3.3208131790161133, -0.022325515747070312, 0.2902660369873047, 0.8932218551635742, -0.7085075378417969, 0.5601811408996582, 0.657122015953064, -10.083812713623047, 0.3663538098335266, 0.06403779983520508, -2.799537181854248, 0.6550793647766113, -9.517569541931152, 1.7172832489013672, 0.30605870485305786, 0.44022560119628906, 0.26790809631347656, 0.4497532844543457, -0.8912366628646851, -0.969517707824707, 0.3803486227989197, -0.04494762420654297, 1.6152842044830322, 0.06308460235595703, -1.21867036819458, -0.01674175262451172, -0.08409595489501953, -0.30506420135498047, 0.08024263381958008, 0.44988155364990234, 0.3474159240722656, -0.2921276092529297, 0.1691732406616211, 0.8101511001586914, -1.5668697357177734, 0.7392005920410156, 0.3063492774963379, 0.13446569442749023, 0.07745027542114258, 0.24306821823120117, -0.9613523483276367, -0.38959407806396484, -0.21246671676635742, -1.4321095943450928, 0.7935781478881836, 0.3726351261138916, 0.5847702026367188, 0.3406705856323242, 0.6037378311157227, -1.0259122848510742, -0.08774375915527344, 0.6567869186401367, 1.3504091501235962, -0.6826480627059937, -0.4126577377319336, 1.1410551071166992, 0.9779338836669922, 0.5870180726051331, 0.22102069854736328, -0.1696346402168274, 0.017522811889648438, 0.647178590297699, -0.15054550766944885, -0.937342643737793, -0.1476602554321289, 0.7411632537841797, -1.7570886611938477, 0.5150547027587891, 0.9787991046905518, 0.43838024139404297, 0.2506856918334961, -0.06403541564941406, 0.5104961395263672, -1.1476774215698242, 0.5755615234375, 1.1136775016784668, 1.1146247386932373, 0.23293298482894897, -1.124579906463623, 0.7750520706176758, 0.7816267013549805, 0.9123187065124512, -7.021640777587891, -0.6241403818130493, 0.47904109954833984, -6.646322727203369, -0.5316951274871826, 0.4555348753929138, 2.7202978134155273, 1.2937650680541992, 0.1695847511291504, 1.465707778930664, -0.8281958103179932, -7.483617782592773, -6.369948387145996, -1.7246036529541016, 0.864222526550293, -0.826076865196228, 0.09137344360351562, -0.49720168113708496, 1.2846777439117432, -2.835099220275879, -0.3685646057128906, -0.08279621601104736, 0.5822238922119141, -6.629973888397217, -0.19847345352172852, 1.4600000381469727, 0.6136407852172852, -0.6967487335205078, -0.7525219917297363, -0.37288904190063477, 0.04502153396606445, -1.6315500736236572, -0.9195098876953125, -0.2868671417236328, -0.9367208480834961, 0.6401093006134033, -1.1094398498535156, 0.4283580780029297, 0.2822227478027344, -0.7052383422851562, -6.823376655578613, -0.009764671325683594, 1.0600767135620117, -0.4506397247314453, 1.2504258155822754, -0.35330772399902344, -0.14107704162597656, 1.9993005990982056, -0.18056607246398926, -0.4035797119140625, -0.9436883926391602, 1.2344722747802734, -1.270604133605957, 0.13848304748535156, 1.6153573989868164, -1.0411920547485352, -0.2707498073577881, -0.059037208557128906, 0.3788728713989258, -2.0945968627929688, -1.5215682983398438, -0.9500927925109863, 2.0817222595214844, 0.5150547027587891, -0.31061601638793945, 0.5305423736572266, -0.22460001707077026, 0.5305423736572266, -10.690459251403809, 1.381007194519043, 0.2371077537536621, -0.7821331024169922], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 77100, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 77100, "last_target_update_ts": 17408, "num_target_updates": 33}, "sampler_results": {"episode_reward_max": -25.12009185552597, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -204.37882095823684, "episode_len_mean": 318.4791666666667, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5257418025718965, "mean_inference_ms": 22.311922491404747, "mean_action_processing_ms": 0.1406390899379651, "mean_env_wait_ms": 4.603420817087652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": -25.12009185552597, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -204.37882095823684, "episode_len_mean": 318.4791666666667, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5257418025718965, "mean_inference_ms": 22.311922491404747, "mean_action_processing_ms": 0.1406390899379651, "mean_env_wait_ms": 4.603420817087652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 77100, "num_env_steps_sampled": 17408, "num_env_steps_trained": 77100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 17408, "agent_timesteps_total": 17408, "timers": {"training_iteration_time_ms": 318.256, "learn_time_ms": 62.465, "learn_throughput": 4802.706, "synch_weights_time_ms": 19.988}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 77100, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 77100, "last_target_update_ts": 17408, "num_target_updates": 33}, "done": false, "episodes_total": 48, "training_iteration": 17, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-25-51", "timestamp": 1655493951, "time_this_iter_s": 5.043742895126343, "time_total_s": 85.96019959449768, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 85.96019959449768, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 33.974999999999994, "ram_util_percent": 60.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 2.4863674640655518, "min_q": -16.326038360595703, "max_q": 16.458953857421875, "mean_td_error": -0.8424763679504395}, "td_error": [-0.14054489135742188, 0.6011486053466797, 0.5049524307250977, -0.4495086669921875, -5.411698341369629, -0.6259117126464844, -2.090176582336426, 0.2613706588745117, -1.397933006286621, 0.8327474594116211, -1.1837525367736816, -1.606600046157837, -0.5357093811035156, -0.11411285400390625, -0.3373603820800781, -0.27585673332214355, -1.7052457332611084, -0.45999813079833984, -0.6259117126464844, 1.3791239261627197, -1.0580253601074219, -8.252208709716797, 0.8533058166503906, -0.628415584564209, 0.6017674207687378, -1.4510140419006348, 1.5097951889038086, 1.3636531829833984, -1.1836938858032227, -0.32561206817626953, 0.37976837158203125, -1.1104145050048828, -0.9146976470947266, -1.7910223007202148, -2.7079038619995117, 0.38620710372924805, -2.458322048187256, -0.8122355937957764, -4.338151931762695, -0.5280128717422485, -5.572845458984375, -1.0120811462402344, -6.602193355560303, 0.2619466781616211, -0.025170326232910156, -1.1252756118774414, -0.5421113967895508, -1.0240583419799805, -0.2598876953125, -0.8027992248535156, 3.720083475112915, 1.082798957824707, -1.1385340690612793, -1.3615880012512207, -1.6158428192138672, -0.7195329666137695, -0.25762081146240234, -0.20403432846069336, -0.8262224197387695, -0.40471458435058594, -0.47153520584106445, -1.0948333740234375, -1.1480789184570312, -0.4059327244758606, -1.9124226570129395, -0.14054489135742188, -1.923872470855713, -1.2859681844711304, -1.6455678939819336, -0.6840171813964844, 1.781171441078186, -2.217599868774414, -0.8642220497131348, -0.8540868759155273, -9.700307846069336, -1.4333525896072388, -0.6540794372558594, -0.026575088500976562, -0.5063610076904297, -6.922018051147461, -0.9111757278442383, -0.8044776916503906, -0.7297191619873047, -0.1318359375, -0.5330106019973755, 0.4519472122192383, -1.2171437740325928, -0.6182360649108887, -0.3766641616821289, -2.1980271339416504, -0.4537067413330078, -0.2334972620010376, -2.5972652435302734, 1.5304632186889648, 0.03285026550292969, 3.720083475112915, -2.458548069000244, 1.1321439743041992, -0.050766944885253906, -0.24593091011047363, 0.7122726440429688, -0.17345046997070312, 0.9552011489868164, -0.14054489135742188, -1.3843636512756348, -0.11165046691894531, -0.48336315155029297, 1.6574811935424805, -0.203385591506958, -1.124506950378418, -1.606600046157837, -0.4969139099121094, 1.2417919635772705, -1.4120545387268066, 0.6160345077514648, 2.0805559158325195, -0.17726516723632812, -0.2334972620010376, 2.3160147666931152, -2.3676629066467285, -1.233306884765625, -0.47122859954833984, -1.084808349609375, -0.6362695693969727, 1.7544174194335938, -1.2856993675231934, -1.2381901741027832, -0.8287605047225952, -0.7630290985107422, -1.0218768119812012, 0.27365636825561523, 1.0029850006103516, -0.5874576568603516, -2.6675660610198975, 0.6557731628417969, -1.7696682214736938, -0.6694581508636475, -1.2750349044799805, -0.1809523105621338, -7.752424240112305, 0.09196186065673828, -0.8925695419311523, -0.3933725357055664, 0.02048802375793457, -2.3828883171081543, 0.04734945297241211, -1.0596312284469604, -1.2980642318725586, -7.127635478973389, -2.085310935974121, 2.2476978302001953, -0.2129364013671875, -0.33979272842407227, -2.19119930267334, 0.24248409271240234, -0.7266407012939453, -0.5384831428527832, -1.6891756057739258, -0.5827522277832031, 0.5868940353393555, -1.025822639465332, -0.1809523105621338, -7.334224700927734, 0.37976837158203125, -1.3514599800109863, -0.31797337532043457, -0.00042998790740966797, 0.8819999694824219, 1.2480568885803223, 0.16625547409057617, 0.4383525848388672, 1.5528631210327148, 1.0663766860961914, -0.9920661449432373, -0.16558551788330078, -0.4527706503868103, -1.385768175125122, -1.3527441024780273, -6.523690223693848, -0.4278583526611328, -0.0372927188873291, -0.30601733922958374, -1.8192481994628906, -0.21927356719970703, -0.01026153564453125, 1.1738839149475098, -2.36997127532959, 0.3342580795288086, -0.16450417041778564, -0.03658103942871094, -2.36997127532959, -0.5058836936950684, -0.7629823684692383, -10.42518424987793, -0.6911468505859375, -7.650347709655762, 0.4045051336288452, -0.4503045082092285, -0.09613609313964844, 0.8295166492462158, 0.8133970499038696, -6.762764930725098, -1.1403698921203613, 3.5680532455444336, -10.071028709411621, 4.483079433441162, 1.2533326148986816, -0.43651676177978516, -1.3744525909423828, -9.400007247924805, -0.7732992172241211, -0.49547040462493896, -9.526288032531738, 1.363626480102539, -1.8460986614227295, 1.1564273834228516, -2.19119930267334, -0.07307600975036621, -0.20158624649047852, -0.2082958221435547, -0.4969139099121094, 1.413808822631836, -0.5500030517578125, 0.6625566482543945, -1.8438715934753418, -4.142110824584961, -1.3636701107025146, -0.15625524520874023, -1.4552464485168457, 0.05319690704345703, 0.15441322326660156, 0.06462383270263672, -2.679488182067871, 0.1602020263671875, 2.7054643630981445, 0.3627290725708008, 1.5224714279174805, -0.44277191162109375, -0.7520561218261719, -1.6332149505615234, -0.4061260223388672, -0.4554023742675781, 0.2731742858886719, -1.0127449035644531, 2.1513023376464844, 0.07111608982086182, -1.8460986614227295, 0.6248378753662109, 0.342010498046875, -0.8785390853881836, -1.310131549835205, 0.08063983917236328, 0.48547935485839844, -0.8896770477294922, -0.45371556282043457, -0.2554960250854492, 1.497185230255127, -0.5623674392700195, -0.10628032684326172, -2.3155839443206787, 0.06385135650634766, -0.9897499084472656, -1.2980642318725586, -1.1608519554138184, -1.7054178714752197, -1.9420576095581055, 0.04089784622192383, 1.3386812210083008, -0.9847650527954102, 0.013600349426269531, -0.5001916885375977, 1.031517744064331, 0.5357533097267151, -1.5919122695922852, 0.4597407579421997, -11.544486045837402, -1.0204949378967285, -0.8765142560005188, -1.8109407424926758, 0.39364147186279297, -0.845484733581543, -1.367248773574829, -4.908145904541016, -2.6902551651000977, -0.8223786354064941, -0.7122182846069336, 0.16625547409057617, -0.7976779937744141, 0.6569795608520508, -0.42051857709884644, 8.26546573638916, -1.788095474243164, -2.1811726093292236, -0.8800806999206543, -1.642831802368164, -2.911470413208008, 0.3894209861755371, 0.10705828666687012, -0.852069616317749, -0.2879781723022461], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 81900, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 81900, "last_target_update_ts": 18432, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -199.92095465623603, "episode_len_mean": 315.9183673469388, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256640889683509, "mean_inference_ms": 22.335379459793735, "mean_action_processing_ms": 0.14067019904754444, "mean_env_wait_ms": 4.597225412435346, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -199.92095465623603, "episode_len_mean": 315.9183673469388, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256640889683509, "mean_inference_ms": 22.335379459793735, "mean_action_processing_ms": 0.14067019904754444, "mean_env_wait_ms": 4.597225412435346, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 81900, "num_env_steps_sampled": 18432, "num_env_steps_trained": 81900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 18432, "agent_timesteps_total": 18432, "timers": {"training_iteration_time_ms": 337.839, "learn_time_ms": 64.869, "learn_throughput": 4624.685, "synch_weights_time_ms": 20.59}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 81900, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 81900, "last_target_update_ts": 18432, "num_target_updates": 35}, "done": false, "episodes_total": 49, "training_iteration": 18, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-25-56", "timestamp": 1655493956, "time_this_iter_s": 5.248578786849976, "time_total_s": 91.20877838134766, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 91.20877838134766, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 35.1, "ram_util_percent": 60.357142857142854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 2.6644742488861084, "min_q": -16.21435546875, "max_q": 18.501712799072266, "mean_td_error": -0.7219966650009155}, "td_error": [0.2980799674987793, -7.451903820037842, 0.2626380920410156, -1.7487328052520752, -1.200296401977539, 0.9902725219726562, -0.3307170867919922, -1.6324470043182373, -0.9890283346176147, 0.763573408126831, -0.9937458038330078, -0.7088088989257812, -0.8192757368087769, 0.7625890970230103, 0.24732303619384766, -1.9117088317871094, -0.25365424156188965, -3.5515079498291016, 1.0965547561645508, -2.302464485168457, -1.0535898208618164, 1.0724170207977295, -0.08168506622314453, -7.518050193786621, -1.2582874298095703, -0.24928951263427734, -0.5245828628540039, 0.6858108639717102, -3.2149364948272705, 0.8362255096435547, 0.44034671783447266, 0.8922004699707031, 0.03974151611328125, 0.6549720764160156, 0.05376434326171875, 0.5438222885131836, -0.5823268890380859, 0.8718829154968262, 1.0049686431884766, 0.8312950134277344, -10.684391975402832, -1.2121638059616089, 1.0540237426757812, -0.17390108108520508, 0.6944284439086914, 0.0001049041748046875, -0.1545543670654297, -0.527522087097168, -0.45363903045654297, 0.6812571287155151, -0.7855625152587891, -1.304995059967041, -0.47652530670166016, -1.4935152530670166, 1.228363037109375, -0.11355018615722656, 0.989595890045166, -0.27942466735839844, -9.845261573791504, -1.183736801147461, -0.1450519561767578, -1.049501895904541, -1.6251335144042969, -1.3296549320220947, -0.5954976081848145, -1.6585440635681152, -0.871962308883667, 0.30316162109375, 0.8444509506225586, -0.14382266998291016, -0.3804159164428711, -0.12902545928955078, -0.9084634780883789, -1.5227632522583008, 0.660395622253418, -1.1289033889770508, -4.265277862548828, 0.26790475845336914, -0.4485541582107544, 0.19555187225341797, -0.31961512565612793, -0.5443150997161865, -0.7083299160003662, -0.5204026699066162, 0.8271199464797974, -0.35076236724853516, -0.2628169059753418, 0.4017753601074219, -0.9444589614868164, -0.6989434957504272, 1.761458396911621, -0.4490060806274414, -1.356740951538086, -3.5963287353515625, 0.26577091217041016, -1.7752180099487305, 0.6145162582397461, 2.005342483520508, 0.0304221510887146, -1.9207220077514648, -2.004732131958008, -0.30017757415771484, -0.2034454345703125, -0.9967813491821289, 0.4128293991088867, 1.1986255645751953, 0.8085129261016846, -0.7415115833282471, -0.8475759625434875, -0.1274871826171875, -1.286673903465271, 0.4383702278137207, -0.06186842918395996, -3.15311861038208, 0.41500329971313477, -0.12165021896362305, -1.3712825775146484, -0.9414482116699219, -0.3632693290710449, 7.671309471130371, 0.006471157073974609, -0.6821637153625488, -7.95943021774292, -0.4694860577583313, 0.31049489974975586, -2.5021514892578125, -7.518050193786621, -1.6597576141357422, -0.7859265804290771, -1.165724754333496, -6.008533477783203, -2.314012050628662, 1.0883408784866333, 1.228363037109375, 0.04156780242919922, -5.307609558105469, 0.34093785285949707, 0.39476776123046875, 0.035773277282714844, -0.377333402633667, -0.8027185201644897, -0.5767834186553955, -0.1988821029663086, 0.5017166137695312, 1.799072265625, -0.1333012580871582, -0.5094962120056152, 0.668632984161377, -1.2699403762817383, -6.8897504806518555, -1.2405314445495605, 1.7103567123413086, 0.475458025932312, -0.7417526245117188, -0.43332934379577637, -10.046311378479004, 1.0372657775878906, -2.210911273956299, -0.32372474670410156, 0.7615870833396912, -0.7495689392089844, 0.6627712249755859, 0.914576530456543, 0.4253506660461426, 2.644287109375, -1.5929720401763916, -0.4214906692504883, -0.5294175148010254, 1.036520004272461, -2.7692766189575195, 1.92840576171875, -2.088992118835449, -0.5481318235397339, 0.03585624694824219, -0.4964289665222168, -0.806391716003418, 0.9469857215881348, -0.6259994506835938, -0.35214805603027344, 0.3088650703430176, -1.849623680114746, 0.9535808563232422, 0.841160774230957, -0.2333545684814453, 0.44266176223754883, -5.514158248901367, -0.9713773727416992, -1.2849111557006836, -0.43577659130096436, -0.3552875518798828, -1.0648822784423828, 1.3419398069381714, 0.43834781646728516, -0.8789396286010742, -1.4271950721740723, -4.412012100219727, -7.43331241607666, 0.5460453033447266, -0.24392223358154297, 1.4138598442077637, -2.675372362136841, -0.14533710479736328, 0.5972480773925781, -6.1207275390625, -0.13159942626953125, 1.2752537727355957, 0.026792168617248535, 1.1236224174499512, -1.0249290466308594, 1.5842018127441406, 0.06620025634765625, -2.0943362712860107, -0.8976011276245117, 0.9581050872802734, -1.1059484481811523, -1.2308998107910156, 1.1220769882202148, -1.4853410720825195, 0.31049489974975586, 0.7505025863647461, -0.8036805987358093, -0.3586430549621582, 0.17106246948242188, 0.559380292892456, 0.20308971405029297, 2.5206127166748047, -0.05129528045654297, 1.2113242149353027, -2.7652549743652344, -1.7579612731933594, -0.633041501045227, 1.2260384559631348, -1.3867425918579102, -0.4303569793701172, -0.603358268737793, 0.2623152732849121, -1.0417718887329102, -1.0574092864990234, -0.5360437631607056, -0.8555349111557007, -2.0499706268310547, -0.9713773727416992, -0.3544301986694336, 0.7447671890258789, -0.12957000732421875, 0.5921087265014648, 1.3212823867797852, -0.112455815076828, -0.8609566688537598, -4.444446563720703, -1.644261360168457, -0.7733265161514282, 0.7741656303405762, -0.9890283346176147, 1.7836167812347412, 1.6887435913085938, -1.976038932800293, 1.7685432434082031, -1.1289033889770508, -6.361318588256836, 1.2828779220581055, -0.29244422912597656, 0.3652973175048828, 0.5478262901306152, 0.5032196044921875, -0.3144712448120117, -0.8101980686187744, -10.19985580444336, -1.7972514629364014, -0.6840076446533203, -0.8484439849853516, 1.2327027320861816, 0.6313668489456177, 0.2664823532104492, -3.9893226623535156, 0.008290290832519531, -1.0007658004760742, 0.6858108639717102, -1.815927505493164, -0.17302989959716797, -0.8974672555923462, -0.4780311584472656, -1.626572608947754, -1.1374092102050781, -0.1274871826171875, -10.594482421875, -0.6824924945831299, 1.546241283416748, -0.9077787399291992, 0.7379817962646484, 0.291018009185791, -0.712432861328125, -1.531641960144043, -0.1545543670654297, -1.3214960098266602, -6.529450416564941, -0.47805166244506836, 0.47768115997314453, -0.6434905529022217, -0.030074119567871094], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 86700, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 86700, "last_target_update_ts": 19456, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -191.29436715593877, "episode_len_mean": 311.22641509433964, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5264051710763125, "mean_inference_ms": 22.392840085649595, "mean_action_processing_ms": 0.14004915562967812, "mean_env_wait_ms": 4.578242126634414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -191.29436715593877, "episode_len_mean": 311.22641509433964, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5264051710763125, "mean_inference_ms": 22.392840085649595, "mean_action_processing_ms": 0.14004915562967812, "mean_env_wait_ms": 4.578242126634414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 86700, "num_env_steps_sampled": 19456, "num_env_steps_trained": 86700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 19456, "agent_timesteps_total": 19456, "timers": {"training_iteration_time_ms": 340.194, "learn_time_ms": 62.336, "learn_throughput": 4812.657, "synch_weights_time_ms": 20.59}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 86700, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 86700, "last_target_update_ts": 19456, "num_target_updates": 37}, "done": false, "episodes_total": 53, "training_iteration": 19, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-26-02", "timestamp": 1655493962, "time_this_iter_s": 5.450411558151245, "time_total_s": 96.6591899394989, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 96.6591899394989, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 34.85, "ram_util_percent": 60.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 3.828479766845703, "min_q": -17.415102005004883, "max_q": 19.980146408081055, "mean_td_error": -0.8200170993804932}, "td_error": [-1.4592132568359375, -0.16582584381103516, -5.575966835021973, -0.01297760009765625, -1.2723569869995117, -0.7627043724060059, -0.3750724792480469, -5.275576591491699, -6.667289733886719, 0.816328763961792, -1.590780258178711, -0.6325473785400391, 1.0423498153686523, 0.014635562896728516, -0.8810746669769287, -0.20736408233642578, -1.3967947959899902, -3.856919765472412, -0.12268352508544922, 0.19499874114990234, -0.796189546585083, -0.7114734649658203, -1.5663299560546875, -0.43900203704833984, 0.7249283790588379, 0.6622161865234375, -2.054523468017578, 2.094738006591797, -1.6165142059326172, -0.47919273376464844, 0.019477367401123047, -0.9971070289611816, 0.5536470413208008, -1.6034326553344727, -0.4342036247253418, -0.07520103454589844, 0.0770425796508789, 0.6246938705444336, -0.2885868549346924, 0.981135368347168, -0.023494243621826172, 0.07540035247802734, 0.7559123039245605, -0.7437014579772949, -0.08658123016357422, 0.5188188552856445, -0.07762384414672852, -1.0068302154541016, -1.0185394287109375, -1.2500371932983398, 0.15444457530975342, -2.3486146926879883, -0.6220121383666992, -2.3589553833007812, 2.2920141220092773, 1.1592695713043213, -7.8051252365112305, -3.641355037689209, -0.4491748809814453, 0.45653343200683594, 0.7956486940383911, -2.184825897216797, -2.959657907485962, -0.2448134422302246, -1.0857324600219727, -0.26790475845336914, -0.8208184242248535, -0.3423490524291992, -2.9335665702819824, -1.4274849891662598, -7.64535665512085, 0.8240528106689453, -0.09775447845458984, -0.9559469223022461, -6.418349266052246, 0.9626555442810059, -1.388026237487793, -1.9030866622924805, -0.1354217529296875, -0.5570628643035889, -0.7703456878662109, -1.7263141870498657, -0.6407277584075928, -1.8861033916473389, -5.5193328857421875, -1.6661795377731323, -8.69702434539795, 1.2613630294799805, 0.10179996490478516, -1.9030866622924805, -0.709065318107605, 0.03392982482910156, 1.8994746208190918, 1.785548448562622, 0.7683844566345215, 0.3110971450805664, -1.329085111618042, 1.6901618242263794, 0.7880449295043945, -0.6771812438964844, 0.5574874877929688, 0.8579111099243164, -0.5702791213989258, 1.7010674476623535, -0.5774135589599609, 0.14000415802001953, -1.4031648635864258, -7.420310020446777, 0.5752601623535156, 0.07540035247802734, -1.1225910186767578, -0.4903562068939209, -1.1154422760009766, 2.0825676918029785, 0.8401021957397461, -0.1092977523803711, -1.1632858514785767, 0.08257913589477539, 0.21647262573242188, 0.31941986083984375, -1.230545997619629, -1.2793583869934082, -9.877349853515625, -1.510536789894104, 0.07270431518554688, -6.219309329986572, 0.8347451686859131, -1.1106739044189453, -1.5042767524719238, -0.6965246200561523, 0.1558551788330078, -0.03266620635986328, 1.7099930047988892, 0.6183037757873535, 0.7539839744567871, 0.3891639709472656, -6.209395885467529, -0.9321743845939636, -1.8928500413894653, -1.9925518035888672, 0.05753040313720703, -1.6106499433517456, 0.0440068244934082, -0.6698102951049805, 0.6673550605773926, 0.2646827697753906, -0.1750926971435547, -1.8854072093963623, -0.9133586883544922, -5.5193328857421875, -0.7845922708511353, -0.14174270629882812, 2.0397768020629883, -10.493114471435547, 4.705462455749512, -0.9913148880004883, 0.26487255096435547, 0.639801025390625, 0.00971221923828125, 0.34855079650878906, 0.9015207290649414, -1.1313209533691406, 0.4249725341796875, -1.7521448135375977, -0.3267514705657959, -1.448410987854004, -0.5312061309814453, -0.07289791107177734, -2.0295462608337402, -6.1393022537231445, -2.6465466022491455, -2.539883613586426, 0.29531359672546387, -0.41167736053466797, -0.39458465576171875, 0.14000415802001953, -0.3154487609863281, -1.3717999458312988, 1.4068584442138672, -2.2872729301452637, -0.035124778747558594, -0.3995981216430664, -0.2102489471435547, 0.18866634368896484, 0.5763454437255859, -0.586883544921875, -1.9735536575317383, -0.957399845123291, 0.4259071350097656, 2.0397768020629883, -0.1565694808959961, -1.1888189315795898, 0.2072744369506836, -0.024259567260742188, -1.9892442226409912, 11.613301277160645, 1.197493553161621, 0.8614616394042969, -0.3761920928955078, 2.174898147583008, -1.3432908058166504, 1.4435977935791016, -5.61760139465332, -0.3159341812133789, -2.2725062370300293, -2.1293487548828125, 0.07296180725097656, -5.52849006652832, 0.5464606285095215, 0.7206554412841797, -1.0864214897155762, 1.7674951553344727, -1.2980833053588867, 0.2510337829589844, 0.33732032775878906, -0.822221040725708, 0.5335590243339539, -0.5539608001708984, -6.937984466552734, 1.8828725814819336, -0.917335033416748, 0.7893886566162109, -0.6250782012939453, -0.1595783233642578, 0.5293827056884766, 1.2487950325012207, -1.9871158599853516, -2.10970401763916, -0.7977848052978516, -0.960317850112915, -0.9511547088623047, -6.763097763061523, -5.698810577392578, 1.0356311798095703, -0.21304035186767578, -0.7469692230224609, -1.3783411979675293, -0.08590888977050781, -0.028006553649902344, 0.23048019409179688, -2.1396045684814453, 1.6199169158935547, 0.7683844566345215, -5.398279190063477, 0.38097476959228516, -0.842629075050354, -0.3161802291870117, -1.1225910186767578, -5.355855941772461, -1.9404017925262451, 0.48862314224243164, 0.27481555938720703, -0.5826492309570312, 0.38097476959228516, -0.20052528381347656, -2.0521841049194336, -0.9237127304077148, 0.7658061981201172, -0.5811638832092285, -1.1948027610778809, -0.21219253540039062, -0.43568944931030273, 1.1069035530090332, 1.0633516311645508, -0.20052528381347656, -0.504880428314209, -0.5734672546386719, -0.1837139129638672, -0.39655303955078125, -1.3332490921020508, -0.03553199768066406, -0.23616838455200195, -0.9631528854370117, -7.245841026306152, -1.1478595733642578, -0.9722156524658203, 0.7086770534515381, -0.7478516101837158, -5.737266540527344, -1.0164194107055664, -1.5150847434997559, -1.7951796054840088, -0.07839393615722656, -0.9362139701843262, 3.144559383392334, -0.13800716400146484, -0.20813274383544922, -0.8787083625793457, 0.2003622055053711, -0.8198290467262268, -0.7954373359680176, -0.09283828735351562, 0.16224288940429688, -0.8681173324584961, -1.3975756168365479, -2.4050304889678955, -4.872798919677734, -2.0435776710510254, 0.7086770534515381, 0.26082468032836914], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 91500, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 91500, "last_target_update_ts": 20480, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -190.7866902247829, "episode_len_mean": 310.91525423728814, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5242385967683978, "mean_inference_ms": 22.522693776226223, "mean_action_processing_ms": 0.13946855698325125, "mean_env_wait_ms": 4.541488066905087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -190.7866902247829, "episode_len_mean": 310.91525423728814, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5242385967683978, "mean_inference_ms": 22.522693776226223, "mean_action_processing_ms": 0.13946855698325125, "mean_env_wait_ms": 4.541488066905087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 91500, "num_env_steps_sampled": 20480, "num_env_steps_trained": 91500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 20480, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 365.744, "learn_time_ms": 63.398, "learn_throughput": 4732.017, "synch_weights_time_ms": 20.089}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 91500, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 91500, "last_target_update_ts": 20480, "num_target_updates": 39}, "done": false, "episodes_total": 59, "training_iteration": 20, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-26-08", "timestamp": 1655493968, "time_this_iter_s": 5.719491243362427, "time_total_s": 102.37868118286133, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 102.37868118286133, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.375, "ram_util_percent": 60.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 3.4142448902130127, "min_q": -18.77103614807129, "max_q": 20.785131454467773, "mean_td_error": -0.9141741991043091}, "td_error": [-1.0724886655807495, 0.5294361114501953, 0.17134666442871094, -0.4357719421386719, 0.0021715164184570312, -1.917475700378418, 1.3950424194335938, 0.5076351165771484, 0.5425515174865723, -0.39050889015197754, -0.5265598297119141, 0.23769855499267578, -0.6627943515777588, -8.801850318908691, 0.044910430908203125, -1.0816905498504639, -0.7890129089355469, 0.07132148742675781, 1.4789237976074219, -0.2663646936416626, -2.4887590408325195, -1.0105810165405273, 0.45287418365478516, -0.7327110767364502, -1.346107006072998, 1.0962700843811035, -1.0114984512329102, -0.07291889190673828, -1.2721805572509766, 1.052384376525879, -1.3428831100463867, -0.7503695487976074, -0.2926969528198242, -0.1022043228149414, 0.8999519348144531, -8.718268394470215, -0.4868204593658447, 0.42681884765625, -0.7244691848754883, -0.47164154052734375, -0.34450817108154297, 0.48333168029785156, -1.9608396291732788, 0.30072927474975586, -0.03881072998046875, 0.6488537788391113, -0.23468589782714844, -1.5950827598571777, 0.1562347412109375, -6.839885711669922, -1.1567821502685547, -0.43162623047828674, -2.561589241027832, -0.055384159088134766, 0.7733883857727051, 0.14468955993652344, -0.9105262756347656, 0.7450199127197266, -0.033267974853515625, -10.035292625427246, -0.2195873260498047, -0.47037696838378906, 1.8858318328857422, -0.2013096809387207, -0.38242053985595703, -1.7865562438964844, 0.30143141746520996, -1.8787591457366943, 0.5706305503845215, 0.10955810546875, -0.9479127526283264, -8.107243537902832, -0.12410831451416016, -1.078385829925537, -1.4702694416046143, -0.7089152336120605, -0.3811631202697754, 0.9182567596435547, -0.4908101558685303, -2.37050724029541, -0.6839113235473633, -2.6914002895355225, -0.9207334518432617, 0.5345587730407715, 0.974186897277832, -1.4221853017807007, -0.20057106018066406, -0.4526233673095703, -0.6059525012969971, -0.725090503692627, -0.3821530342102051, -9.763054847717285, -1.0463895797729492, 0.810748815536499, 0.07821846008300781, 0.24036169052124023, -1.9120416641235352, -0.05308723449707031, -1.8281431198120117, -6.615782737731934, 0.1569986343383789, -0.21969252824783325, -1.2239837646484375, -1.2797627449035645, -0.5930147171020508, -0.023279190063476562, -0.9440774917602539, -1.088205099105835, -0.9139366149902344, -0.8895788192749023, -0.4017915725708008, 0.02556324005126953, -0.009150505065917969, -0.12069272994995117, 0.1703500747680664, -0.48984336853027344, 0.3739936351776123, 0.1485118865966797, -0.6649665832519531, -1.1441779136657715, 1.2884035110473633, -0.2463359832763672, -1.1332359313964844, -0.39754486083984375, -0.6097078323364258, -5.676631927490234, -8.430243492126465, 0.07577323913574219, -0.5533266067504883, -2.224795341491699, -0.6485528945922852, -0.6178131103515625, 0.8741931915283203, -1.205739974975586, -2.0588483810424805, 1.8363995552062988, -0.347939670085907, 1.1790626049041748, -7.853233337402344, -1.4674696922302246, -0.5925397872924805, -0.36705636978149414, -0.04380989074707031, 0.04547691345214844, -1.3133530616760254, -0.6473550796508789, -0.05490899085998535, 0.34914398193359375, -0.7596979141235352, -1.2345447540283203, -2.287240982055664, -2.907214641571045, -1.156080722808838, 0.17134666442871094, -0.16905879974365234, 0.11052560806274414, -0.9802988767623901, -5.447614669799805, -0.2752467393875122, 0.5855579376220703, -2.466134786605835, -0.6129913330078125, 0.07348918914794922, -0.6260895729064941, -1.6022138595581055, -0.06569766998291016, 0.28990602493286133, -1.1567821502685547, 3.254382610321045, 0.37375450134277344, 0.7506103515625, 0.06187915802001953, -0.5169897079467773, -0.8895788192749023, 0.38429832458496094, -0.5109972953796387, -2.746257781982422, 10.614128112792969, -1.4689855575561523, 0.16036367416381836, -1.408700942993164, 0.4781656265258789, 0.21512961387634277, -1.8848159313201904, 0.5512404441833496, -0.9037281274795532, -2.3211402893066406, -0.4220266342163086, -0.14120864868164062, -0.053974151611328125, -1.398207187652588, -0.7380356788635254, -1.31195068359375, -0.062081336975097656, -0.4543294906616211, -4.37315559387207, 0.1545248031616211, -1.0021390914916992, -0.6306099891662598, -0.43162623047828674, -1.6486084461212158, -0.6810989379882812, -6.052931785583496, -0.9655647277832031, -1.0711488723754883, -0.4526233673095703, -6.353113174438477, 0.2736663818359375, 0.06998348236083984, -0.29164600372314453, -0.497472882270813, -5.7214741706848145, -0.41933631896972656, -0.8509178161621094, 0.020899295806884766, -0.7198915481567383, -7.362707614898682, -0.6750605702400208, -2.466134786605835, 0.8923053741455078, -8.091341018676758, 0.2500476837158203, -0.9333281517028809, -11.180130004882812, -1.0485448837280273, -1.3687405586242676, -1.7947921752929688, -0.5930147171020508, 0.10832786560058594, -0.3356742858886719, -1.2002019882202148, -0.18686294555664062, -0.7129898071289062, 0.7565798759460449, -8.270547866821289, 0.14468955993652344, 0.6388378143310547, -0.23297762870788574, -1.2307958602905273, 2.0730350017547607, -2.103549003601074, 1.5242195129394531, 0.3238391876220703, -2.713290214538574, -10.774408340454102, -0.12181282043457031, -0.2455596923828125, 0.3211221694946289, -0.18995094299316406, -5.3748040199279785, -0.15767669677734375, 0.059502601623535156, -10.685840606689453, 0.18076348304748535, -0.5391845703125, 0.07348918914794922, -0.4526233673095703, 0.22957336902618408, -0.6612986326217651, 0.2736663818359375, -1.0500078201293945, -0.4116067886352539, 0.20410728454589844, -1.2503242492675781, -0.03332710266113281, -2.1317458152770996, -0.18268966674804688, 0.5979747772216797, -7.996456146240234, -0.038486480712890625, 0.4164915084838867, 13.530065536499023, -1.419663906097412, 0.34633588790893555, -0.8299202919006348, -0.6083898544311523, 0.21354103088378906, -0.6073508262634277, 0.38429832458496094, 0.3389902114868164, -1.635939598083496, -1.593731164932251, 1.632868766784668, -1.1972265243530273, 0.21150445938110352, 0.0003323554992675781, -1.1729679107666016, -2.5910234451293945, 0.30072927474975586, 0.37375450134277344, 0.5898890495300293, -1.6158196926116943, -1.1332359313964844, -1.049227237701416, -0.11008834838867188, -1.3084259033203125, -0.4019594192504883, -0.6455032825469971, -2.0548996925354004, 0.3558993339538574], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 96300, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 96300, "last_target_update_ts": 21504, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -190.89382521493826, "episode_len_mean": 310.296875, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.520962859292528, "mean_inference_ms": 22.589382539914943, "mean_action_processing_ms": 0.13909251879853485, "mean_env_wait_ms": 4.511552930233799, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -190.89382521493826, "episode_len_mean": 310.296875, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.520962859292528, "mean_inference_ms": 22.589382539914943, "mean_action_processing_ms": 0.13909251879853485, "mean_env_wait_ms": 4.511552930233799, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 96300, "num_env_steps_sampled": 21504, "num_env_steps_trained": 96300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 21504, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 318.575, "learn_time_ms": 63.098, "learn_throughput": 4754.527, "synch_weights_time_ms": 19.691}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 96300, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 96300, "last_target_update_ts": 21504, "num_target_updates": 41}, "done": false, "episodes_total": 64, "training_iteration": 21, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-26-13", "timestamp": 1655493973, "time_this_iter_s": 5.250102519989014, "time_total_s": 107.62878370285034, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 107.62878370285034, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.962500000000006, "ram_util_percent": 60.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 3.6944873332977295, "min_q": -18.430742263793945, "max_q": 21.981765747070312, "mean_td_error": -0.5808063745498657}, "td_error": [1.211127758026123, -2.2224249839782715, 1.3655109405517578, 0.013908863067626953, -1.068809986114502, -5.707589149475098, -0.15063047409057617, -1.6923561096191406, -0.5927524566650391, -7.990452766418457, 0.2958681583404541, 0.029859542846679688, 0.4382457733154297, 0.5961875915527344, -5.339960098266602, -0.13800525665283203, -0.46915626525878906, -0.1467151641845703, 0.5460205078125, -0.7621669769287109, -0.03575944900512695, -0.38509416580200195, -0.8880720138549805, 0.4389162063598633, -0.2668485641479492, 0.5248072147369385, -1.4628820419311523, 0.052506446838378906, 0.6504611968994141, -0.4923553466796875, 1.5236272811889648, -2.7944154739379883, -0.48688650131225586, -0.042336463928222656, -0.7883059978485107, -0.5699005126953125, -0.8480806350708008, -1.7173185348510742, -0.8665199279785156, -0.5486950874328613, 0.9882488250732422, -0.9639878273010254, 1.765987515449524, -0.1905956268310547, 0.9602689743041992, -0.5899434089660645, 0.5670413970947266, 0.2145700454711914, 2.0748071670532227, -0.07640743255615234, -0.0972299575805664, 0.17631816864013672, -2.467787265777588, 0.5218987464904785, -0.04498910903930664, 1.0335474014282227, 0.5961875915527344, 0.27945709228515625, -0.050135135650634766, -0.3670048713684082, -1.9562077522277832, -2.8637688159942627, 0.6487598419189453, -0.9012699127197266, -0.9993915557861328, -1.2779874801635742, 0.021523475646972656, -0.07737255096435547, -0.1300668716430664, -0.2901986837387085, -0.20987987518310547, 1.5753107070922852, 0.39654541015625, -0.6901826858520508, 0.6606578826904297, 0.45181751251220703, -0.49392223358154297, 0.8278846740722656, -1.0349493026733398, -0.23263835906982422, -1.3406109809875488, -0.19969654083251953, -2.1448984146118164, 0.38765907287597656, 0.47725677490234375, 6.401825904846191, 0.6598871350288391, -1.8029088973999023, -0.25925445556640625, -1.080265998840332, -2.9017441272735596, -0.9159307479858398, -10.3536958694458, -0.0881204605102539, -1.488576889038086, -0.6506433486938477, 0.3689713478088379, -5.47805118560791, 0.5427589416503906, 0.2883567810058594, -0.4923553466796875, 1.1031208038330078, -1.1801490783691406, 1.4687786102294922, -0.9691333770751953, -0.3822059631347656, -0.40542006492614746, 1.0253548622131348, -3.110933303833008, -0.46946609020233154, 0.30936384201049805, -8.212977409362793, 0.5200340747833252, 0.2642698287963867, 0.07708358764648438, -0.4304666519165039, 0.7986392974853516, 19.600038528442383, 0.7039012908935547, -7.406520843505859, -0.5335819721221924, 1.5772666931152344, -0.2839236259460449, 0.41921138763427734, -0.3933725357055664, 0.045548439025878906, -0.13822650909423828, -0.2737569808959961, 0.47961974143981934, -1.1687145233154297, -0.16489219665527344, -0.41393184661865234, -7.2695512771606445, -1.667891263961792, -0.3094043731689453, 0.3088045120239258, 0.15297508239746094, -1.4937503337860107, -1.4567770957946777, -1.4953460693359375, 0.3691415786743164, 0.8056821823120117, -1.3095061779022217, -0.3816201686859131, -0.22751998901367188, 0.09861552715301514, -0.4606666564941406, 0.5045568943023682, 0.6003189086914062, -2.0628182888031006, -3.202465057373047, -1.4068899154663086, 0.8390474319458008, -0.044109344482421875, -0.8182716369628906, -1.8790936470031738, -2.2028799057006836, -1.8698372840881348, -3.340574264526367, -0.26981544494628906, -1.58518648147583, 0.1117696762084961, -0.30106353759765625, -0.05826383829116821, -0.8608760833740234, 0.9085351228713989, 0.08330392837524414, 0.39156150817871094, 0.7650728225708008, -0.9036517143249512, -0.4630310535430908, -0.3957247734069824, -0.8021426200866699, 0.5408496856689453, 1.6226577758789062, -0.871798038482666, 0.3795590400695801, 1.9185476303100586, 0.9602689743041992, -1.5081892013549805, -0.5254406929016113, -0.2799525260925293, -4.658790588378906, -1.3647117614746094, -1.0584545135498047, -8.148536682128906, -0.5298783779144287, -0.2784242630004883, 0.5202915668487549, -0.9034271240234375, -0.09086692333221436, 0.18351268768310547, 0.9085351228713989, -0.9551982879638672, 0.7034330368041992, -0.04923200607299805, -1.583310842514038, 0.07243108749389648, 0.04426002502441406, -0.30762386322021484, -0.33164310455322266, 1.3104848861694336, -0.8904571533203125, 0.3795590400695801, 0.3508577346801758, 0.16785526275634766, 0.30936384201049805, 0.6338558197021484, 0.7431430816650391, 0.47725677490234375, 0.5325956344604492, 0.1887826919555664, -5.508146286010742, -0.8907164931297302, -0.7730083465576172, -5.895310401916504, -1.272613525390625, -0.7347054481506348, -5.341500759124756, -1.1432933807373047, -11.902758598327637, -0.1204986572265625, 1.0663948059082031, 0.42355823516845703, -1.2239398956298828, -1.1624822616577148, -10.943563461303711, -0.8209603428840637, 0.45659875869750977, 0.00586700439453125, 1.346160888671875, -0.8151037693023682, -2.421299934387207, -7.3282599449157715, -1.901482105255127, 0.2096090316772461, -2.043593645095825, -0.9402666091918945, 0.5826807022094727, -2.4217519760131836, -0.22481632232666016, -0.4214344024658203, -0.3322763442993164, -0.42676401138305664, -0.3402986526489258, -1.0848197937011719, 0.03525876998901367, -2.0316619873046875, -1.680069088935852, -0.18587398529052734, 0.07943010330200195, -11.156194686889648, -5.482079982757568, -0.9446048736572266, -0.3054780960083008, -0.8120208978652954, -0.11446857452392578, 0.8506968021392822, -0.681422233581543, -1.0863714218139648, 0.426114559173584, -1.16845703125, 0.2989487648010254, 0.45784807205200195, 9.884833335876465, 0.5202915668487549, -8.315760612487793, -0.47792720794677734, -0.4166224002838135, 0.17631816864013672, 0.47725677490234375, 2.2246389389038086, 0.42355823516845703, 2.014629364013672, 1.0398030281066895, -0.49219822883605957, 0.09680938720703125, -0.48688650131225586, 0.1000748872756958, -0.030817031860351562, -6.192888259887695, -0.07640743255615234, -0.33841896057128906, 0.4578418731689453, -1.6279559135437012, -1.271092414855957, -0.6275935173034668, 0.629040002822876, -0.2525296211242676, 1.4494819641113281, -0.172529935836792, 0.20462942123413086, -0.04042863845825195, 0.0314178466796875, -0.10127067565917969, 0.043915748596191406, 0.7080241441726685, -0.15240192413330078, -1.3901338577270508, 10.219789505004883], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 101100, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 101100, "last_target_update_ts": 22528, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -185.3432613021948, "episode_len_mean": 307.8333333333333, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5216970490663599, "mean_inference_ms": 22.619472081901794, "mean_action_processing_ms": 0.13916592621653928, "mean_env_wait_ms": 4.507774186642698, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -185.3432613021948, "episode_len_mean": 307.8333333333333, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5216970490663599, "mean_inference_ms": 22.619472081901794, "mean_action_processing_ms": 0.13916592621653928, "mean_env_wait_ms": 4.507774186642698, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 101100, "num_env_steps_sampled": 22528, "num_env_steps_trained": 101100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 22528, "agent_timesteps_total": 22528, "timers": {"training_iteration_time_ms": 336.21, "learn_time_ms": 62.533, "learn_throughput": 4797.46, "synch_weights_time_ms": 20.396}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 101100, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 101100, "last_target_update_ts": 22528, "num_target_updates": 43}, "done": false, "episodes_total": 66, "training_iteration": 22, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-26-19", "timestamp": 1655493979, "time_this_iter_s": 5.282254219055176, "time_total_s": 112.91103792190552, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 112.91103792190552, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.47142857142857, "ram_util_percent": 60.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 5.134198188781738, "min_q": -18.13728141784668, "max_q": 22.48369026184082, "mean_td_error": -0.7893031239509583}, "td_error": [-1.5656805038452148, -0.8139266967773438, -0.7100753784179688, -1.0454578399658203, 0.9374983310699463, 1.1211633682250977, -1.0450191497802734, -0.41074275970458984, -1.3997571468353271, -0.3075089454650879, 0.842768669128418, -1.4833154678344727, -0.8053828477859497, 1.1794638633728027, -0.7038097381591797, 3.0938282012939453, -0.20731544494628906, 0.20726251602172852, 0.7702007293701172, -6.590327262878418, 0.04787635803222656, -0.4898514449596405, -0.2039051055908203, -0.12914466857910156, 0.20420455932617188, -0.1337752342224121, -1.8761272430419922, -1.028638482093811, -0.39692389965057373, -1.7768054008483887, -0.7725558280944824, -1.8584755659103394, -0.8537024259567261, -1.0977346897125244, -0.5937166213989258, -0.28241920471191406, -2.720378875732422, -2.044870376586914, -0.2619398832321167, -6.253804683685303, 0.4489011764526367, -1.5576152801513672, 0.22050857543945312, 0.8897264003753662, -0.017386436462402344, -1.2194900512695312, -0.1547718048095703, 2.317368507385254, -2.7283244132995605, -0.6830778121948242, 0.5596375465393066, -0.6047935485839844, -1.2428255081176758, -0.3632662296295166, -1.0804705619812012, 0.6421644687652588, 2.667003631591797, 0.052464962005615234, -0.8053828477859497, -0.5041961669921875, -0.8807744979858398, 0.37342071533203125, -1.0367379188537598, 0.6360492706298828, -1.1812310218811035, -0.378440260887146, -0.8239784240722656, -0.9964838027954102, -0.4877004623413086, 1.3752548694610596, -0.9125280380249023, -5.507049560546875, -0.4072074890136719, 1.0811805725097656, -2.066356658935547, -0.2784004211425781, -0.14604759216308594, -0.7744731903076172, -0.5199611186981201, 1.0258307456970215, -1.926553726196289, -0.4436206817626953, 0.3361992835998535, -2.4393091201782227, -0.16383719444274902, -0.2787437438964844, -1.096109390258789, 0.8600912094116211, -0.6448783874511719, -1.0861282348632812, -1.223475456237793, -7.040233135223389, -1.1996192932128906, -0.7990126609802246, -0.48596954345703125, 0.16100311279296875, 0.309908390045166, -0.4752063751220703, -2.7688822746276855, 0.9050388336181641, -2.1797103881835938, -1.1426695585250854, 0.012588977813720703, 0.17949247360229492, -1.0917418003082275, -1.2979049682617188, 0.16100311279296875, -0.2875080108642578, 0.12004470825195312, -1.610055923461914, -1.4421002864837646, -1.197801113128662, -0.7242517471313477, -0.20241475105285645, -1.2539100646972656, -0.35756683349609375, -4.839156150817871, -1.0182199478149414, -0.12036514282226562, -2.6651101112365723, 0.45724010467529297, -1.8552143573760986, -1.0134191513061523, -0.19021987915039062, -0.10350322723388672, 0.3879331350326538, -1.2400336265563965, -0.7418408393859863, -0.09624099731445312, 0.36521100997924805, -0.4388493299484253, 0.02020801603794098, -0.9411355257034302, -0.31571102142333984, -0.21990728378295898, -0.30413246154785156, 0.731715202331543, 0.16141891479492188, -1.2749156951904297, -7.794516563415527, -0.10962963104248047, -1.4652976989746094, -1.683126449584961, -0.26511573791503906, -0.7210769653320312, -2.106997489929199, 0.0957331657409668, -1.5164990425109863, 0.2559385299682617, -0.46628355979919434, 0.5008606910705566, -0.6699533462524414, -1.4914228916168213, 1.480778455734253, -0.6985864639282227, -0.15584850311279297, -0.31056737899780273, 1.2103393077850342, -0.1631450653076172, -6.052390098571777, -0.6973452568054199, -1.6156117916107178, -0.6929512023925781, 1.0255541801452637, -3.006924629211426, -0.6351947784423828, -1.8572282791137695, -1.859884262084961, -1.0098843574523926, -0.9052256941795349, -0.4082984924316406, 0.2711925506591797, 0.7103595733642578, 1.4631595611572266, 0.6292934417724609, -0.08507919311523438, 1.4568824768066406, -2.2341527938842773, 0.5378952026367188, 0.4373598098754883, -0.2550926208496094, 0.2802877426147461, 0.11724281311035156, -0.7756533622741699, 0.8714594841003418, 0.12369096279144287, -0.2813529968261719, 2.029446601867676, -0.269672155380249, -1.1656723022460938, -1.0676765441894531, -1.9405348300933838, 0.931915283203125, -0.7229175567626953, 1.5900530815124512, 0.9161739349365234, 0.9160139560699463, 1.113450050354004, -1.1584687232971191, -1.3616552352905273, -0.6140298843383789, -0.7669343948364258, -8.803544044494629, -1.3196868896484375, -0.6925325393676758, -1.30194091796875, -1.8656330108642578, 0.023244380950927734, -1.3184318542480469, -0.6242611408233643, -1.6232306957244873, -1.4421002864837646, 0.15643095970153809, -0.46898698806762695, 0.42058897018432617, -0.9053335189819336, -0.9372854232788086, 0.2460193634033203, -0.6242611408233643, 0.9067635536193848, 0.9902434349060059, 0.7174892425537109, -0.6062908172607422, -0.5597876310348511, -8.38607120513916, -7.348028182983398, -7.245729923248291, -0.24733543395996094, 0.9036900997161865, 1.3563575744628906, 0.4023094177246094, -1.5379009246826172, -2.176391839981079, -0.9211710691452026, -0.5610294342041016, -1.1219003200531006, 0.5665702819824219, -2.1484484672546387, -0.4982719421386719, 2.4235808849334717, -0.4595208466053009, 1.3258228302001953, 2.988009452819824, -0.4984130859375, -1.6664962768554688, 0.13371658325195312, 0.3706550598144531, -0.4063863754272461, -0.4084358215332031, -1.4478940963745117, -0.9298772811889648, -9.146885871887207, 0.2374887466430664, -0.6945953369140625, 0.17103099822998047, 0.16100311279296875, -9.89326286315918, -0.4895709753036499, 2.0825462341308594, -0.36801815032958984, -1.0002026557922363, -1.7196531295776367, -0.17120885848999023, -1.1018140316009521, 0.9894704818725586, -0.8168144226074219, 0.46553778648376465, -2.09700345993042, -0.6806802749633789, -1.3263583183288574, 1.479567527770996, -0.7663872241973877, -0.20731544494628906, -1.3259063959121704, -1.8135782480239868, 0.6231626272201538, -8.289030075073242, -6.896786212921143, -1.000629186630249, -0.8096039295196533, -4.7222137451171875, 0.12980270385742188, -0.8709394931793213, -2.322840690612793, -2.283409595489502, -2.010312080383301, -0.5985040664672852, 2.275265693664551, -0.9384880065917969, -0.2454395294189453, -1.3759737014770508, -0.9257869720458984, -1.1426695585250854, -1.5433130264282227, -1.5702877044677734, -0.9622592926025391, 0.07660055160522461, -0.918347179889679, -0.9656370282173157, 1.3896255493164062], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 105900, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 105900, "last_target_update_ts": 23552, "num_target_updates": 45}, "sampler_results": {"episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -179.32012094773245, "episode_len_mean": 304.59420289855075, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5222531375225026, "mean_inference_ms": 22.637857116094857, "mean_action_processing_ms": 0.13874110247405813, "mean_env_wait_ms": 4.498741846287857, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -179.32012094773245, "episode_len_mean": 304.59420289855075, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5222531375225026, "mean_inference_ms": 22.637857116094857, "mean_action_processing_ms": 0.13874110247405813, "mean_env_wait_ms": 4.498741846287857, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 105900, "num_env_steps_sampled": 23552, "num_env_steps_trained": 105900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 23552, "agent_timesteps_total": 23552, "timers": {"training_iteration_time_ms": 332.632, "learn_time_ms": 63.069, "learn_throughput": 4756.673, "synch_weights_time_ms": 19.887}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 105900, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 105900, "last_target_update_ts": 23552, "num_target_updates": 45}, "done": false, "episodes_total": 69, "training_iteration": 23, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-26-24", "timestamp": 1655493984, "time_this_iter_s": 5.238038539886475, "time_total_s": 118.14907646179199, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 118.14907646179199, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.275000000000002, "ram_util_percent": 61.0125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 4.4712347984313965, "min_q": -19.46285057067871, "max_q": 23.32961654663086, "mean_td_error": -0.5424160957336426}, "td_error": [0.030435562133789062, 0.7238693237304688, 1.4863204956054688, -0.035473406314849854, 0.3466460704803467, -0.43966054916381836, -4.036267280578613, 0.08130073547363281, -0.3926963806152344, -0.3049125671386719, -0.5152359008789062, -0.37839794158935547, -1.3375616073608398, 1.5835418701171875, -0.4160623550415039, -0.3434009552001953, -0.8314666748046875, 1.1503968238830566, 0.1318511962890625, 0.5183019638061523, 0.3807339668273926, -0.7815799713134766, 0.23556900024414062, 0.2993812561035156, -0.19466400146484375, -1.6390814781188965, 0.0631941556930542, 0.36473751068115234, -0.04407095909118652, 0.23147296905517578, 1.3811445236206055, -0.25760793685913086, -0.8710947036743164, 0.7167673110961914, -0.4371185302734375, -0.053371429443359375, -5.692789077758789, -0.08920764923095703, -1.4467322826385498, -0.3390817642211914, -2.423964500427246, -0.11429214477539062, -6.104656219482422, -5.669855117797852, 0.20506620407104492, -1.1052093505859375, -0.4434795379638672, 0.03945446014404297, -0.015485286712646484, 0.6143684387207031, -0.4458433985710144, -0.38161396980285645, -0.5119285583496094, 0.13179540634155273, -0.5857915878295898, 0.7387056946754456, 0.08343887329101562, 0.7027158737182617, -0.9713926315307617, 0.34837228059768677, 0.06861186027526855, -1.5067167282104492, 1.3948484659194946, -2.219740867614746, -9.63177490234375, -0.3693380355834961, 0.01877593994140625, 0.16827750205993652, -1.8447751998901367, -0.42450618743896484, 0.7460451126098633, 0.5753397941589355, -0.9803190231323242, -0.052944183349609375, 0.3172597885131836, -1.0131990909576416, -7.730050086975098, -0.43274784088134766, -0.4923785924911499, 0.6386146545410156, -0.49756813049316406, -1.1224875450134277, 1.0480461120605469, -0.9606170654296875, 1.215277910232544, -0.8481988906860352, -1.0705547332763672, -2.2058372497558594, -5.773789882659912, -0.033554673194885254, 1.3066859245300293, -5.96502161026001, -0.7155084609985352, -0.6461009979248047, 0.22944903373718262, 0.3085346221923828, -0.4543600082397461, 0.07564067840576172, 0.6335935592651367, 0.739274263381958, 0.3775980472564697, -1.9209280014038086, -0.26728248596191406, 1.0888895988464355, 0.3136258125305176, -1.9452972412109375, 1.2822628021240234, -0.37909793853759766, -0.8125228881835938, -2.3599939346313477, 0.28519153594970703, -0.2750239372253418, -10.692564010620117, -0.3454253673553467, -4.529689311981201, -1.028327465057373, 0.3041691780090332, -1.2710304260253906, 0.5520238876342773, 0.6939163208007812, 0.7189469337463379, -0.28183773159980774, -0.539433479309082, 2.5826234817504883, -4.807315826416016, 0.4624905586242676, -6.054105758666992, -1.3628473281860352, -0.2418980598449707, -0.6132564544677734, 1.6501561403274536, -0.03193950653076172, 0.9810886383056641, 1.1576042175292969, 0.8647511005401611, -0.17754840850830078, 1.5195655822753906, 0.2167339324951172, 0.25626587867736816, -0.42531585693359375, 11.650372505187988, -0.6199378967285156, -1.834284782409668, 0.38830649852752686, 0.744110107421875, 0.9701862335205078, 0.3526836633682251, -1.5613994598388672, 0.15566253662109375, 0.3095722198486328, -0.4414099454879761, 1.240132212638855, -0.41054749488830566, -0.38121700286865234, -0.07988691329956055, -0.2754788398742676, 0.3979339599609375, 0.49294567108154297, 0.18808865547180176, -0.6430785655975342, -0.16702747344970703, -10.370588302612305, -0.03270149230957031, -0.7612398862838745, -0.15062856674194336, -1.1471214294433594, 0.6844539642333984, -0.39330101013183594, -0.226104736328125, -0.667365550994873, 0.4111208915710449, -0.47093772888183594, 1.0317745208740234, 0.7318210601806641, 0.18492603302001953, 0.2134990692138672, 0.11232566833496094, -0.629399299621582, -0.17766952514648438, -0.557103157043457, 0.12015819549560547, -0.41595458984375, 20.873018264770508, -0.41623640060424805, -0.6333553194999695, -0.14632701873779297, -1.315561294555664, -0.4939919710159302, -1.069340705871582, -0.4748665690422058, -0.778007447719574, 0.6433887481689453, -3.024718761444092, -1.8086345195770264, -5.449156761169434, 0.687190055847168, -5.999933242797852, -1.448695182800293, 0.3309135437011719, -2.1637842655181885, 1.555570363998413, 0.10473155975341797, 0.8022899627685547, -12.712679862976074, -5.557460784912109, 0.8319759368896484, 0.07806205749511719, 0.6467651128768921, -0.5637984275817871, -0.8356161117553711, 0.348721981048584, -0.7145085334777832, -0.13466358184814453, -1.7777976989746094, -0.06275463104248047, -4.153897762298584, -0.06660741567611694, -6.739845275878906, 0.43132954835891724, -1.4958405494689941, -1.585531234741211, -0.33204078674316406, 0.7528243064880371, 1.4273185729980469, 0.5629539489746094, -0.21412444114685059, -4.995111465454102, -0.9363030195236206, -0.3224067687988281, -1.7141261100769043, -1.226444125175476, 1.067713737487793, -1.3926997184753418, 1.023512363433838, -0.45544612407684326, -0.706230640411377, -0.6178379058837891, 0.8121554851531982, -0.2236475944519043, 0.30190181732177734, -0.31531333923339844, -1.0989075899124146, 0.299257755279541, -0.04832136631011963, 0.20122861862182617, -7.730050086975098, -0.8178138732910156, 0.9443656802177429, -0.1606428623199463, -0.8363897800445557, 0.693831741809845, 1.012692928314209, -1.3571205139160156, 0.5473823547363281, -1.2146592140197754, 0.8091787099838257, -0.6760252118110657, 0.07531166076660156, 1.2899227142333984, -0.5382585525512695, -6.639495849609375, 0.9359993934631348, 0.10320377349853516, -1.2141327857971191, 0.973530650138855, 0.04951906204223633, 0.09448099136352539, -1.2042920589447021, -0.7551164627075195, -5.453012943267822, 1.421003818511963, 1.395197868347168, 0.3775980472564697, -1.4428215026855469, -0.4845311641693115, -0.15738487243652344, 1.8782613277435303, 0.9825620651245117, -0.7384815216064453, 0.3142280578613281, 1.0880022048950195, -0.361785888671875, -0.4845311641693115, -0.26802730560302734, 0.6302890777587891, 0.13931989669799805, -0.2972583770751953, -0.023969650268554688, 0.07531166076660156, -0.9482154846191406, -0.0693511962890625, -1.3236074447631836, 0.9389219284057617, -5.72688627243042, -0.0961918830871582, -0.11687517166137695, -0.6895408630371094, -1.3951740264892578, -2.0495657920837402, -0.1255970001220703], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 110700, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 110700, "last_target_update_ts": 24576, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -171.36837795197962, "episode_len_mean": 300.9866666666667, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5216598692772052, "mean_inference_ms": 22.735995493830604, "mean_action_processing_ms": 0.13806410743512354, "mean_env_wait_ms": 4.479786872303632, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -171.36837795197962, "episode_len_mean": 300.9866666666667, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5216598692772052, "mean_inference_ms": 22.735995493830604, "mean_action_processing_ms": 0.13806410743512354, "mean_env_wait_ms": 4.479786872303632, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 110700, "num_env_steps_sampled": 24576, "num_env_steps_trained": 110700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 24576, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 357.463, "learn_time_ms": 63.503, "learn_throughput": 4724.172, "synch_weights_time_ms": 19.889}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 110700, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 110700, "last_target_update_ts": 24576, "num_target_updates": 47}, "done": false, "episodes_total": 75, "training_iteration": 24, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-26-30", "timestamp": 1655493990, "time_this_iter_s": 5.598423004150391, "time_total_s": 123.74749946594238, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 123.74749946594238, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.062499999999996, "ram_util_percent": 61.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 5.829020023345947, "min_q": -17.854507446289062, "max_q": 23.511991500854492, "mean_td_error": -0.26528772711753845}, "td_error": [-0.51995849609375, 0.07230663299560547, -6.520966053009033, 1.140364170074463, -0.06028938293457031, 1.6099176406860352, -1.2316780090332031, -5.134254455566406, 0.4205188751220703, -0.005974233150482178, -0.7310512065887451, -1.402134895324707, -5.031162261962891, 0.04116763174533844, 0.16338443756103516, -0.2990131378173828, -0.9242525100708008, -0.45115017890930176, -6.709352493286133, -2.2306509017944336, -5.516726493835449, 1.0697410106658936, -0.9809207916259766, -0.1468648910522461, -0.7233142852783203, 0.8674039840698242, 0.40189361572265625, 0.642054557800293, -0.08497333526611328, 0.20000267028808594, 0.13691949844360352, -0.008037567138671875, 0.6520481109619141, 0.8597612380981445, 0.16743946075439453, 1.4571456909179688, -0.8051614761352539, 1.979783058166504, 0.26488304138183594, 0.14458394050598145, 0.9629676342010498, 0.44948163628578186, -0.5218801498413086, -6.536282539367676, -1.7929887771606445, -0.12622880935668945, -6.663146495819092, 0.46332335472106934, 0.8422155380249023, -0.6056270599365234, -0.32986927032470703, -0.6337814331054688, -0.0054492950439453125, 0.30148589611053467, 0.6130619049072266, 1.7638309001922607, -1.1983680725097656, 0.1287221908569336, 0.22084838151931763, -0.1405954360961914, 1.4110292196273804, -1.0709922313690186, 0.17845535278320312, 20.349550247192383, -0.2868661880493164, -0.7310512065887451, -0.8679671287536621, -0.06417828798294067, -0.27139949798583984, 0.44489097595214844, 1.5386505126953125, -0.051900386810302734, 0.469240665435791, 0.3224983215332031, -0.9892945289611816, 0.37222790718078613, 0.09268531203269958, 0.48540687561035156, -0.7888603210449219, -0.7198104858398438, 0.6441001892089844, -0.7960777282714844, 0.14397680759429932, 0.8829684257507324, 3.485950231552124, 1.2303047180175781, -0.5616674423217773, -2.3819637298583984, -1.1736278533935547, 0.1287221908569336, -0.3887782096862793, -1.1756620407104492, -0.10021209716796875, 0.9453344345092773, 1.0990772247314453, -0.42683982849121094, 1.1983604431152344, 0.5372314453125, -0.37464970350265503, 0.6884970664978027, 1.3809633255004883, -0.17287087440490723, 1.3534669876098633, 0.6442070007324219, 0.3628857135772705, -6.69705867767334, -6.766913890838623, -0.8077282905578613, 0.7390880584716797, -0.24598407745361328, -0.31609535217285156, -1.5200386047363281, -0.5702084302902222, 0.2542753219604492, 0.3983182907104492, -0.05357170104980469, 0.3628857135772705, -1.056509017944336, 0.43477344512939453, 0.13307571411132812, -0.19004011154174805, 0.017015457153320312, 0.9228081703186035, 0.41698646545410156, 1.087667465209961, -0.5493993759155273, 0.49304866790771484, -0.5693597793579102, -0.07057958841323853, -2.1540794372558594, 0.3983182907104492, 1.1682214736938477, -0.26677608489990234, 0.7551608085632324, -1.179274082183838, 1.030385971069336, 0.543018639087677, -7.1571149826049805, 0.6468520164489746, 0.6670465469360352, 0.6481626629829407, 0.48069334030151367, 0.6296157836914062, 0.6172962188720703, -0.1968088150024414, -0.5589504241943359, 0.141082763671875, -0.7263822555541992, 1.439023494720459, -0.8244366645812988, 0.9709782600402832, 0.03603827953338623, -7.2104291915893555, -0.5653989315032959, -1.1215226650238037, -0.5818519592285156, -1.1713237762451172, 0.46545684337615967, 1.5019654035568237, -3.7886452674865723, -6.0694122314453125, -0.17908668518066406, -0.9609684944152832, -0.9869613647460938, -0.8384778499603271, -0.15357303619384766, 1.48453950881958, 7.077052593231201, 0.16037845611572266, -0.4275836944580078, -0.8296675682067871, 0.03648853302001953, 0.9483919143676758, 0.5336541533470154, -0.4763268232345581, -0.4999558925628662, -0.7078968286514282, -0.08793449401855469, 0.41609200835227966, 0.15235137939453125, -1.458047866821289, 1.22629976272583, -1.8015508651733398, 0.3623768091201782, 1.556635856628418, 0.5309562683105469, -0.6490449905395508, 0.5284314155578613, 0.8205347061157227, -1.1592485904693604, 2.2044076919555664, 0.25159263610839844, -0.6389179229736328, -0.3587203025817871, 1.451568603515625, -5.072013854980469, -0.9624881744384766, 0.2611570358276367, -0.3165397644042969, 2.141493320465088, -0.24178791046142578, -0.9456558227539062, 0.3471384048461914, -1.1108484268188477, -0.22698259353637695, 0.6916170120239258, -0.672987699508667, 0.08868692815303802, -0.2539558410644531, -0.6174979209899902, -0.7472634315490723, -1.1028709411621094, 0.8510961532592773, 0.5779838562011719, 0.25122833251953125, 0.5431137084960938, 0.03477287292480469, -1.5298881530761719, -8.380498886108398, 0.07116508483886719, -1.6227622032165527, 1.2013204097747803, 0.38945865631103516, 0.6220452785491943, 1.0056349039077759, 0.3530392050743103, -0.16949820518493652, 0.6468520164489746, -0.4952983856201172, -6.467024326324463, 0.49304866790771484, 0.28470420837402344, -0.10322380065917969, 1.1300878524780273, -1.5320186614990234, -0.5531874895095825, -1.108205795288086, -0.86431884765625, 0.43903541564941406, 0.555578351020813, -0.5235977172851562, 0.4916210174560547, -1.3930702209472656, 0.4432644844055176, 0.9169188141822815, -0.5024123191833496, -0.47512149810791016, 1.0308170318603516, 1.477055311203003, 0.3295111656188965, 0.2527589797973633, 1.918853759765625, 1.7638309001922607, 0.9938337802886963, -10.590838432312012, -1.6255450248718262, 1.0707578659057617, -0.1096348762512207, 0.23037028312683105, -0.6372871398925781, -1.0094289779663086, -4.704134941101074, 0.1666698455810547, -1.539684772491455, -0.6114275455474854, -0.8077282905578613, 1.4198627471923828, -0.7941865921020508, -0.809351921081543, 0.2010364532470703, 0.23037028312683105, 0.4172802269458771, 0.811418354511261, 1.0671716928482056, 0.26696115732192993, -0.4511733055114746, 1.5386505126953125, -0.0140228271484375, -0.9496965408325195, 0.4387686252593994, 0.07852935791015625, 0.4036722183227539, -1.5995159149169922, 0.26093757152557373, -1.7603355646133423, 1.22629976272583, -0.15844321250915527, -0.46214866638183594, -0.4724245071411133, -0.38852977752685547, 0.20946121215820312, -1.12274169921875, -1.4524869918823242, -1.3790559768676758, -0.18679332733154297, 0.8521451950073242, -0.38332176208496094, 0.9167904853820801, -1.3928537368774414, 0.5092887878417969], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 115500, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 115500, "last_target_update_ts": 25600, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -169.39621716011553, "episode_len_mean": 300.0632911392405, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.521207678157869, "mean_inference_ms": 22.78442966764305, "mean_action_processing_ms": 0.13796467415979635, "mean_env_wait_ms": 4.464580247073227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 14.056627839803696, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -169.39621716011553, "episode_len_mean": 300.0632911392405, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.521207678157869, "mean_inference_ms": 22.78442966764305, "mean_action_processing_ms": 0.13796467415979635, "mean_env_wait_ms": 4.464580247073227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 115500, "num_env_steps_sampled": 25600, "num_env_steps_trained": 115500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 25600, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 336.232, "learn_time_ms": 64.367, "learn_throughput": 4660.793, "synch_weights_time_ms": 20.284}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 115500, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 115500, "last_target_update_ts": 25600, "num_target_updates": 49}, "done": false, "episodes_total": 79, "training_iteration": 25, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-26-36", "timestamp": 1655493996, "time_this_iter_s": 5.589264392852783, "time_total_s": 129.33676385879517, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 129.33676385879517, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.362500000000004, "ram_util_percent": 61.150000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 5.996580600738525, "min_q": -16.219966888427734, "max_q": 25.044099807739258, "mean_td_error": -0.5795704126358032}, "td_error": [0.5563907623291016, 0.1627368927001953, 0.3305377960205078, -2.083634376525879, -1.9724626541137695, -0.6804213523864746, -0.3079957962036133, -0.6724796295166016, -2.137868881225586, 0.8890514373779297, -0.15473031997680664, -0.4001493453979492, 0.726445198059082, -1.5105926990509033, -0.40905022621154785, -1.7066612243652344, 0.9601531028747559, -0.1569976806640625, -2.0664405822753906, -0.4642791748046875, 1.1218376159667969, -2.1815242767333984, 0.5380892753601074, 0.843480110168457, 1.4625301361083984, -0.011448860168457031, -0.4817037582397461, 0.032784342765808105, 1.4154720306396484, 0.39453125, -0.0047607421875, -5.689556121826172, -0.25634968280792236, 0.17881202697753906, -6.246919631958008, -0.22319889068603516, -6.922580242156982, -7.272212505340576, -0.08739757537841797, 0.45021486282348633, -0.22245049476623535, -0.16453266143798828, 0.08409595489501953, 0.17882823944091797, 0.22655022144317627, -0.03638744354248047, 0.7425222396850586, -5.725154876708984, -1.0547704696655273, -0.5211009979248047, -0.7540521621704102, 1.5754241943359375, 1.115574836730957, -0.8264908790588379, -0.3528709411621094, 1.1598052978515625, -0.11118888854980469, 1.3504886627197266, -0.1483306884765625, -0.013137131929397583, -0.8935642242431641, -3.2930245399475098, -1.0330219268798828, -1.8842849731445312, 0.6666889190673828, -0.15248394012451172, -0.1636676788330078, -4.991701126098633, -0.2964138984680176, -0.5550251007080078, 0.45716094970703125, 1.4251928329467773, -0.5552307367324829, 0.774360179901123, -1.3296693563461304, 0.1919724941253662, 0.5621981620788574, 0.28106212615966797, -0.7874116897583008, -0.6666913032531738, 1.4239740371704102, -6.612056732177734, -1.1186790466308594, -7.809969902038574, -0.5200729370117188, -0.5143623352050781, 0.634246826171875, -5.709468841552734, -0.35066795349121094, -1.0941202640533447, 0.5198440551757812, 0.9942256212234497, 0.08634710311889648, 0.4022865295410156, 0.47504234313964844, 0.5277538299560547, -1.5814566612243652, -1.3174901008605957, 0.21684837341308594, -0.2012615203857422, -1.587855339050293, 0.40129756927490234, 0.8292219638824463, 0.537078857421875, -0.45715034008026123, -0.3797113299369812, -0.9784717559814453, -1.496316909790039, -0.8495878577232361, 0.7425222396850586, -0.866108775138855, 0.008436203002929688, -4.619623184204102, -2.1684370040893555, -0.5114240646362305, 0.9045333862304688, 0.35726261138916016, -0.9718532562255859, -0.40627849102020264, 0.008935928344726562, -1.0986933708190918, -0.4817037582397461, 0.07142484188079834, 0.314929723739624, -0.5328936576843262, 1.0968539714813232, 0.7129449844360352, -0.9301567077636719, 1.0033578872680664, -0.4364013671875, 0.010198593139648438, 1.7011992931365967, -0.05499982833862305, -9.494087219238281, 0.5118675231933594, 0.054440826177597046, -1.1629228591918945, 0.10647046566009521, -0.21919822692871094, 0.1707310676574707, 0.3095588684082031, 0.31971168518066406, 1.3042736053466797, 0.1627368927001953, 0.15212583541870117, 0.02750563621520996, -0.866108775138855, -0.01148223876953125, 0.4945957660675049, -0.6708579063415527, -0.9767818450927734, 0.1921544075012207, -15.65428638458252, 0.3382601737976074, -2.030667304992676, -0.22245049476623535, 0.11226367950439453, 1.454996109008789, -0.7988529205322266, -6.776777267456055, -0.09379112720489502, -0.426929235458374, -0.4212496280670166, 1.2411670684814453, -0.46135759353637695, -0.9391021728515625, -0.2669849395751953, 0.7640190124511719, -0.3668327331542969, -0.8265342712402344, -1.493459701538086, -1.0547704696655273, -0.5652117133140564, -1.3912081718444824, -0.41289329528808594, -1.4455413818359375, 0.524838924407959, -1.1671972274780273, -0.751706600189209, -0.5289821624755859, 0.16050219535827637, 0.10211372375488281, -2.3978376388549805, -1.1398067474365234, 0.8246035575866699, 0.3353605270385742, 0.19491815567016602, 0.3220653533935547, -0.2261829376220703, -0.5552307367324829, 1.203333854675293, 1.7011992931365967, 1.5132722854614258, -3.624349594116211, 0.013791799545288086, -0.07634639739990234, 1.2695608139038086, -0.5566048622131348, 0.9712352752685547, 0.08524322509765625, 1.146139144897461, 0.11243152618408203, 1.3907623291015625, 0.1486661434173584, -0.06738710403442383, 0.751047670841217, 0.23914861679077148, 1.5132722854614258, 1.0113096237182617, -0.7074875831604004, -1.0528182983398438, -0.5418522357940674, -0.3351644277572632, -0.26748067140579224, -2.1684370040893555, 0.785567045211792, 1.1327533721923828, 0.8838021755218506, 17.003490447998047, -1.3652124404907227, 5.406672477722168, -1.092644214630127, -0.6601841449737549, 0.14416742324829102, 0.28545284271240234, 0.5506010055541992, 0.24436473846435547, -0.41087794303894043, 1.0515813827514648, -1.5327129364013672, 2.149764060974121, 0.32971787452697754, -1.9093618392944336, -0.27468109130859375, -6.92869758605957, -0.49637413024902344, -0.7025203704833984, -0.2873995304107666, 0.5222644805908203, -0.31177520751953125, -0.3668327331542969, -0.9658379554748535, -1.5818939208984375, 0.21553754806518555, 0.3305377960205078, -7.253700256347656, 0.7262847423553467, -0.9936904907226562, -0.9033699035644531, 0.6247472763061523, -6.638277053833008, -0.5579608678817749, -10.477789878845215, -1.3267498016357422, -0.6091747283935547, 1.4089059829711914, 0.6582266092300415, -2.5141210556030273, -4.644143581390381, 0.15045928955078125, -0.0046367645263671875, -1.2664012908935547, -0.49593067169189453, -0.45370912551879883, -0.11951923370361328, -2.6765189170837402, 0.33782827854156494, 0.5878582000732422, 1.2179126739501953, -1.0684032440185547, -0.5001411437988281, 0.2409677505493164, 0.04978466033935547, -0.04570341110229492, -0.8694705963134766, -1.0465364456176758, -0.9951071739196777, -1.353569507598877, 0.3649895191192627, -1.0684032440185547, -0.3151884078979492, 0.2562260925769806, -0.09272709488868713, -0.807136058807373, -0.6398835182189941, -5.695438385009766, 0.3752622604370117, -1.1952905654907227, -0.07725143432617188, -0.1276235580444336, -5.250277519226074, 0.31453609466552734, 0.8869813680648804, 0.38756561279296875, 0.05013322830200195, 0.8052692413330078, -7.214299201965332, -1.0406074523925781, -1.5468133687973022, -0.15964508056640625], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 120300, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 120300, "last_target_update_ts": 26624, "num_target_updates": 51}, "sampler_results": {"episode_reward_max": 23.85626193881035, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -163.17100782476993, "episode_len_mean": 297.73493975903614, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5216275999256867, "mean_inference_ms": 22.82761576456838, "mean_action_processing_ms": 0.13800582420071034, "mean_env_wait_ms": 4.460036069157821, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 23.85626193881035, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -163.17100782476993, "episode_len_mean": 297.73493975903614, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5216275999256867, "mean_inference_ms": 22.82761576456838, "mean_action_processing_ms": 0.13800582420071034, "mean_env_wait_ms": 4.460036069157821, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 120300, "num_env_steps_sampled": 26624, "num_env_steps_trained": 120300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 26624, "agent_timesteps_total": 26624, "timers": {"training_iteration_time_ms": 329.269, "learn_time_ms": 63.857, "learn_throughput": 4697.969, "synch_weights_time_ms": 19.489}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 120300, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 120300, "last_target_update_ts": 26624, "num_target_updates": 51}, "done": false, "episodes_total": 83, "training_iteration": 26, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-26-41", "timestamp": 1655494001, "time_this_iter_s": 5.385690927505493, "time_total_s": 134.72245478630066, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 134.72245478630066, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.025, "ram_util_percent": 61.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 6.332242012023926, "min_q": -15.798113822937012, "max_q": 26.85066795349121, "mean_td_error": -0.9508897662162781}, "td_error": [0.5123615264892578, -1.8198037147521973, -0.5031976699829102, 0.9585368633270264, 0.5938567519187927, 0.02618694305419922, 0.17762452363967896, -1.037581443786621, -1.2276701927185059, -2.263017416000366, -1.4497509002685547, -0.6584281921386719, -0.5937869548797607, -8.486846923828125, -0.9094939827919006, -0.7387256622314453, -1.235673427581787, -2.411653518676758, -0.7536890506744385, -2.0471153259277344, -0.4440326690673828, -0.20673465728759766, -1.524809718132019, 0.0509190559387207, 1.452427864074707, -0.33127403259277344, 0.5796585083007812, -0.6341171264648438, -1.8954262733459473, -0.5193988680839539, 0.8261470794677734, 0.3565988540649414, -0.6298589706420898, 1.672842025756836, -0.074127197265625, -7.350088119506836, -1.1225132942199707, -1.0613499879837036, -1.2973384857177734, -0.09463047981262207, -1.258913278579712, 0.054470062255859375, -1.035665512084961, -0.9969711303710938, -1.2257957458496094, -0.3518333435058594, -1.1025500297546387, -0.8302817940711975, -1.0321893692016602, 0.5321903228759766, 0.0905771255493164, -1.1118323802947998, 0.5127325057983398, -1.173095703125, 1.270181655883789, -12.019059181213379, -0.4081587791442871, -1.1930793523788452, 1.1124591827392578, -0.9253935217857361, 0.6906403303146362, -6.166243553161621, 0.49592530727386475, -0.7348670959472656, -0.1976795196533203, -0.37073230743408203, -0.5020614266395569, -1.9959444999694824, -1.561755657196045, -1.3197734355926514, -0.7263122797012329, 0.6624388694763184, -0.5825891494750977, -1.379323124885559, -0.8182888031005859, -0.8437986373901367, -1.7979812622070312, 0.4935598373413086, -0.5294365882873535, -0.08768081665039062, 0.1959686279296875, 0.16354221105575562, -1.0175056457519531, -0.40664005279541016, -0.8787002563476562, 0.4052085876464844, -4.615197658538818, -1.0934927463531494, 0.6083853244781494, -1.371384620666504, -1.7709827423095703, -0.7612459659576416, -1.258913278579712, 0.18851304054260254, 0.2936205267906189, 0.27527523040771484, 0.7627601623535156, -0.6335325241088867, -0.9356613159179688, -0.26938772201538086, -0.9384975433349609, -1.3022575378417969, -1.0954980850219727, -0.42378008365631104, -0.6758561134338379, -1.1756012439727783, -0.245269775390625, 0.3550356328487396, -1.320608139038086, -6.329401969909668, -0.9134807586669922, 1.270181655883789, -0.2904062271118164, -2.483804941177368, 0.10403251647949219, -0.5101375579833984, 2.339862823486328, -0.42378008365631104, -0.4218255281448364, -0.9475796222686768, -0.4440326690673828, 0.25468993186950684, 0.18775510787963867, -0.5088720321655273, -0.14287948608398438, 0.5173749923706055, -1.0252995491027832, -0.39286136627197266, -0.409517765045166, -2.037261486053467, -0.5931482315063477, -0.9806928634643555, -0.5788493156433105, 0.23896503448486328, -1.7274627685546875, 0.005917549133300781, -1.0320196151733398, -2.0377631187438965, -1.0812089443206787, -0.9343318939208984, -0.3742809295654297, -0.6663785576820374, -0.7805353403091431, -0.8160982131958008, -1.204512596130371, 0.08910942077636719, -0.32710886001586914, -0.9968363046646118, -0.260178804397583, -1.1025500297546387, -0.8945410251617432, 0.6039543151855469, 0.053740501403808594, -0.21015644073486328, -0.5431880950927734, 0.5437355041503906, -0.9922558665275574, -0.15589582920074463, -0.36908769607543945, -0.9928731918334961, -0.1563119888305664, -0.21476411819458008, 0.5996425151824951, -1.2202153205871582, -0.8428573608398438, -0.6788953542709351, -0.13370323181152344, -1.2065448760986328, -1.408518671989441, 0.1068277359008789, -1.001272439956665, 1.0248725414276123, -5.605359077453613, -1.8801746368408203, -1.7633647918701172, -1.1820011138916016, -6.385007858276367, -0.12266063690185547, 0.5654139518737793, -1.5236679315567017, -0.9731347560882568, -1.8500746488571167, -0.4523029327392578, -1.0622673034667969, -5.905209064483643, 0.29090118408203125, -0.3575458526611328, 0.33471715450286865, 0.862675666809082, -1.072366714477539, 0.2673325538635254, -0.1155233383178711, -1.0332986116409302, -0.5868101119995117, -0.5397534370422363, -0.5219964981079102, -10.492143630981445, -0.12320518493652344, -0.11198043823242188, -1.0105457305908203, -0.32152414321899414, -0.32282018661499023, 0.11417865753173828, -0.678052544593811, -0.8371686935424805, 0.613311767578125, -5.715909004211426, -6.678854942321777, 0.2468724250793457, -0.5075922012329102, 0.9804954528808594, -0.6584281921386719, 0.2978076934814453, -2.3481578826904297, -1.6207597255706787, -1.8481371402740479, -0.6747360229492188, -2.1280908584594727, 0.08434295654296875, -0.9176175594329834, -0.9112167358398438, 1.3965187072753906, -0.4124770164489746, 0.054470062255859375, -0.4137539863586426, -0.8704729080200195, -1.1178576946258545, -2.129382848739624, -0.024132728576660156, -0.6089625358581543, -0.4061410427093506, 0.0905771255493164, -7.862046241760254, -1.2520999908447266, -1.1954116821289062, -1.238840103149414, -0.6867237091064453, 0.1772747039794922, 0.8060665130615234, -6.7017436027526855, 1.5214252471923828, 0.864680290222168, 0.6751518249511719, -0.41950035095214844, 0.8012361526489258, -1.4987459182739258, -1.7337161302566528, -7.871086120605469, -0.43674278259277344, 1.4885873794555664, -1.045712947845459, -1.7913097143173218, -1.7119340896606445, 0.3842049837112427, -2.028733253479004, -0.912114143371582, -1.3077850341796875, -1.0373334884643555, 0.20715808868408203, -6.599892616271973, 0.6083853244781494, -0.9819374084472656, -0.9019899368286133, 2.7598657608032227, -0.34589684009552, -7.258872985839844, -1.4120674133300781, -1.2989540100097656, -1.9097423553466797, -0.8145408630371094, -1.1261346340179443, -1.258913278579712, -1.8367773294448853, -0.8808298110961914, 0.4493436813354492, 0.2195882797241211, -0.9057950973510742, -0.6106433868408203, -1.2903327941894531, -0.7806358337402344, -0.6458034515380859, -1.2964580059051514, 0.5321903228759766, -0.23561179637908936, 0.5301618576049805, -1.7464381456375122, -6.260345458984375, -0.43066978454589844, -0.12090492248535156, -0.587061882019043, -0.9988918304443359, -1.6254076957702637, -0.613861083984375, -0.7474803924560547, 1.3651771545410156, -11.62182903289795, 2.0373973846435547, -0.5557384490966797, -0.39662837982177734, -1.9668340682983398], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 125100, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 125100, "last_target_update_ts": 27648, "num_target_updates": 53}, "sampler_results": {"episode_reward_max": 25.369419291615486, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -158.78614452349788, "episode_len_mean": 295.9529411764706, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5219839044467757, "mean_inference_ms": 22.842430541605577, "mean_action_processing_ms": 0.13782616770267003, "mean_env_wait_ms": 4.456219617300342, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 25.369419291615486, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -158.78614452349788, "episode_len_mean": 295.9529411764706, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5219839044467757, "mean_inference_ms": 22.842430541605577, "mean_action_processing_ms": 0.13782616770267003, "mean_env_wait_ms": 4.456219617300342, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 125100, "num_env_steps_sampled": 27648, "num_env_steps_trained": 125100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 27648, "agent_timesteps_total": 27648, "timers": {"training_iteration_time_ms": 333.954, "learn_time_ms": 64.59, "learn_throughput": 4644.689, "synch_weights_time_ms": 20.29}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 125100, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 125100, "last_target_update_ts": 27648, "num_target_updates": 53}, "done": false, "episodes_total": 85, "training_iteration": 27, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-26-47", "timestamp": 1655494007, "time_this_iter_s": 5.341390609741211, "time_total_s": 140.06384539604187, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 140.06384539604187, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.512499999999996, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 6.270912170410156, "min_q": -17.052364349365234, "max_q": 27.72600746154785, "mean_td_error": -0.4933182895183563}, "td_error": [-1.0939826965332031, -0.07312202453613281, 0.2845296859741211, 0.5978356599807739, -0.1467151641845703, -0.0022542476654052734, -10.645828247070312, 0.0942678451538086, 0.3228566646575928, -0.3099021911621094, -1.0212831497192383, -0.6870155334472656, -0.08892536163330078, 0.561650276184082, -1.2574293613433838, -0.6755679845809937, -0.5463852286338806, -0.7298016548156738, -0.9553952217102051, -1.0863780975341797, -0.8321112990379333, -0.08011054992675781, -0.15497779846191406, -0.151403546333313, 1.0646543502807617, -0.4529571533203125, -0.5720329880714417, -1.3440757989883423, -1.5407719612121582, -0.038450002670288086, 0.6027812957763672, -0.08982276916503906, 0.8650493621826172, 0.01837068796157837, -0.28733062744140625, -6.688799858093262, -0.35689306259155273, 0.028751373291015625, -1.0445146560668945, 1.8459720611572266, -0.23099613189697266, -0.1137157678604126, -0.250640869140625, 0.1502847671508789, -0.9373912811279297, 0.24687862396240234, -1.8748564720153809, -0.09513568878173828, 0.7745423316955566, 0.6292533874511719, -0.9263086318969727, -0.16800785064697266, 0.034802794456481934, -0.4982314109802246, -0.0014095306396484375, -0.6499447822570801, -0.3900895118713379, 0.106201171875, -0.02611684799194336, -9.65785026550293, -1.3718547821044922, 0.4732818305492401, 1.588134765625, 0.03199958801269531, -0.7611986398696899, 1.1588563919067383, -1.0773181915283203, -1.0668630599975586, -0.4181070327758789, 1.1091351509094238, 0.15245270729064941, -0.18732643127441406, -0.028156280517578125, 0.04756450653076172, -1.21746826171875, -0.7090606689453125, -0.527104377746582, 1.1518487930297852, 0.7563877105712891, 0.6946182250976562, -0.1171865463256836, -1.4263992309570312, -0.03489166498184204, 0.1378488540649414, -0.4498748779296875, -0.5290670394897461, -0.8706598281860352, -0.9446377754211426, -0.34566664695739746, -0.30544066429138184, -0.6243171691894531, 0.43374842405319214, 0.5313816070556641, 0.5678742527961731, -0.6813639998435974, 1.4682188034057617, -0.016649246215820312, 0.6564083099365234, -0.3499464988708496, 0.5178720951080322, 0.221099853515625, 0.5955495834350586, -5.00315523147583, 0.6187000274658203, 0.10353755950927734, -0.3714742660522461, -0.18829345703125, -1.027108907699585, 1.4282341003417969, -0.24374771118164062, 1.4900858402252197, -0.32289791107177734, 1.9066543579101562, 1.1286025047302246, -1.9643001556396484, 0.20792531967163086, 0.5129966735839844, 0.6886940002441406, -0.620699405670166, 1.4575843811035156, -0.3383350372314453, -0.1474170684814453, -0.9020565152168274, -0.9513187408447266, 1.0153976678848267, 1.850088119506836, 0.36638689041137695, -0.9344367980957031, -2.344217300415039, -0.5165567398071289, 0.15442609786987305, -0.10378313064575195, 0.6742916107177734, 0.01065361499786377, 1.105682373046875, -1.6750397682189941, -0.4660968780517578, -0.08577442169189453, 0.0668802261352539, -0.8919172286987305, 0.29720258712768555, -0.6404895782470703, -0.2639579772949219, -1.4835768938064575, -0.173066645860672, 0.4362668991088867, -5.028532981872559, 0.29678916931152344, 1.0247011184692383, 0.5619916915893555, -3.0141992568969727, -0.27658796310424805, -1.306666374206543, -0.29416555166244507, 0.005370140075683594, -0.7921056747436523, 2.0755481719970703, 0.7952983379364014, -0.8105158805847168, -0.5448513031005859, -0.025533676147460938, -0.9260282516479492, 0.37683749198913574, -0.68017578125, 1.2270584106445312, -0.31983810663223267, 0.1518707275390625, 1.4170637130737305, -7.765712738037109, -0.2767505645751953, 0.6593837738037109, -0.5390381813049316, 0.29678916931152344, -0.46770477294921875, -0.3452417850494385, 0.9377524852752686, -0.25121021270751953, 0.31287050247192383, -8.012298583984375, 5.1588006019592285, -5.997568130493164, -0.3286327123641968, 0.014538288116455078, 0.10421276092529297, 0.96307373046875, -0.24760866165161133, -0.5140657424926758, 2.1182403564453125, -0.4782257080078125, 0.2529144287109375, 0.9377524852752686, -0.8928484916687012, -0.2183701992034912, -0.3917105197906494, -1.102020263671875, -0.5051923394203186, 0.7100801467895508, -9.683000564575195, -1.253932237625122, -0.7065502405166626, -7.159364223480225, -0.26830822229385376, 1.2903833389282227, -0.5956761837005615, -0.5579859614372253, -0.017078399658203125, 1.935739278793335, 1.505784034729004, -0.36319202184677124, -0.4640735983848572, 0.693079948425293, -0.4954543113708496, -0.18441534042358398, 1.0954771041870117, -0.3930778503417969, 0.7888126373291016, -0.7982177734375, 0.08954572677612305, 0.5614509582519531, -1.2032079696655273, 1.8330230712890625, -8.016685485839844, 1.031743049621582, -1.159228801727295, 0.32036781311035156, -5.8383026123046875, -0.8682575225830078, -0.35533320903778076, 0.1544170379638672, -0.03592562675476074, -1.3406662940979004, 0.24486255645751953, 0.9377524852752686, -0.07066607475280762, 0.20460987091064453, 0.25799041986465454, 0.3483562469482422, 0.1015925407409668, 2.8678245544433594, 0.7013053894042969, 1.4261226654052734, -0.06839847564697266, 0.8430747985839844, -9.944944381713867, -0.02529454231262207, 0.19325637817382812, -6.646688461303711, 1.1807641983032227, -0.44092750549316406, -1.0795726776123047, -0.3902854919433594, 0.7879924774169922, -4.226587772369385, -10.443684577941895, 2.0612564086914062, 1.8669533729553223, -0.9168152809143066, -1.4429396390914917, 0.2195873260498047, -7.653718948364258, -1.1600418090820312, -0.49835968017578125, 1.105682373046875, 0.7120131254196167, -0.2727985382080078, -5.752121925354004, 0.0862569808959961, -0.9364498853683472, -1.0329556465148926, 1.493372917175293, -0.8121863007545471, -0.24447345733642578, -0.5997425317764282, -0.1726449877023697, -0.5861244201660156, 0.04756450653076172, -5.774294853210449, -0.6145803928375244, -0.3383350372314453, -0.9971640110015869, -1.0206947326660156, -0.4088449478149414, -0.43114757537841797, -1.23622465133667, 1.0530939102172852, -0.26262664794921875, -1.4965600967407227, -0.3479996919631958, 0.64609694480896, -0.16800785064697266, -1.0887641906738281, 0.1183004379272461, 1.2653217315673828, 1.5101070404052734, -0.38576793670654297, -0.956298828125, -0.3143119215965271, 0.8993186950683594, 0.7092828750610352, 0.23938369750976562], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 129900, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 129900, "last_target_update_ts": 28672, "num_target_updates": 55}, "sampler_results": {"episode_reward_max": 26.176207274198532, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -147.31626779958606, "episode_len_mean": 290.47872340425533, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5220192211255165, "mean_inference_ms": 22.94322066826255, "mean_action_processing_ms": 0.13735690546017856, "mean_env_wait_ms": 4.441190324121729, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 26.176207274198532, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -147.31626779958606, "episode_len_mean": 290.47872340425533, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5220192211255165, "mean_inference_ms": 22.94322066826255, "mean_action_processing_ms": 0.13735690546017856, "mean_env_wait_ms": 4.441190324121729, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 129900, "num_env_steps_sampled": 28672, "num_env_steps_trained": 129900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 28672, "agent_timesteps_total": 28672, "timers": {"training_iteration_time_ms": 364.058, "learn_time_ms": 65.0, "learn_throughput": 4615.359, "synch_weights_time_ms": 19.987}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 129900, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 129900, "last_target_update_ts": 28672, "num_target_updates": 55}, "done": false, "episodes_total": 94, "training_iteration": 28, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-26-53", "timestamp": 1655494013, "time_this_iter_s": 5.766076564788818, "time_total_s": 145.8299219608307, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 145.8299219608307, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.025000000000006, "ram_util_percent": 61.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 7.604912281036377, "min_q": -10.314757347106934, "max_q": 26.18440055847168, "mean_td_error": -0.3339724838733673}, "td_error": [14.045452117919922, 0.26635122299194336, -0.38300609588623047, 1.4073448181152344, 0.23758220672607422, 0.3295269012451172, -0.9363994598388672, 0.48593413829803467, 1.1582765579223633, -1.3983688354492188, 0.5895481109619141, 0.49599528312683105, 0.2996816635131836, 0.5566856861114502, -0.8478764295578003, -0.9750199317932129, 0.9345971345901489, -0.9284687042236328, 0.10010027885437012, 0.7973313331604004, -1.1927690505981445, -0.7176710963249207, 0.0423431396484375, -0.27867889404296875, -1.0186347961425781, 0.8982856273651123, -6.612763404846191, -0.8617095947265625, 0.6849164962768555, -0.06351089477539062, 2.101703643798828, -1.0350701808929443, -0.7590818405151367, -1.4031603336334229, -0.5762863159179688, 1.6802082061767578, 0.2850027084350586, 1.1062374114990234, 0.4225902557373047, -2.0380430221557617, -0.798457145690918, -0.41652846336364746, 1.1328767538070679, -0.27014732360839844, -1.088700771331787, 7.67293119430542, -4.717998504638672, -0.0687028169631958, 0.33478033542633057, 0.3299522399902344, -0.1329813003540039, -0.3956880569458008, 0.25905704498291016, 0.5984591245651245, -0.18040764331817627, -6.376989364624023, -0.7379512786865234, -0.4062938690185547, -3.0846104621887207, 0.4570651054382324, -4.015335559844971, 1.5438132286071777, -0.009722709655761719, 0.1570262908935547, -0.38311195373535156, -0.7249889373779297, -1.4489631652832031, -2.020585536956787, -0.342822790145874, 0.3903217315673828, -5.977653980255127, -2.2985897064208984, -1.1355948448181152, 0.3158722519874573, -0.130110502243042, -0.4154762029647827, -2.722980499267578, -0.32602858543395996, 1.275219440460205, -0.21614742279052734, -0.7637395858764648, -0.019802093505859375, -1.3349032402038574, -0.1872730255126953, -0.8166971206665039, -0.21874624490737915, -0.5223051309585571, -1.1777057647705078, -0.38080132007598877, -1.9729690551757812, 0.32147836685180664, -0.14721298217773438, -0.4290580153465271, 0.1694704294204712, 0.5966892242431641, -0.8766589164733887, 0.08727401494979858, -0.49011945724487305, -6.302299976348877, -0.0033957958221435547, -2.422308921813965, -0.018995285034179688, -0.2838258743286133, 0.013689041137695312, -0.6056809425354004, -0.34241151809692383, -0.9714775085449219, -0.6911721229553223, 0.09675788879394531, -1.2943377494812012, 3.117237091064453, -1.3915739059448242, -9.17193603515625, -0.17055225372314453, 1.0067768096923828, 0.023392200469970703, -1.14556884765625, 0.9461574554443359, -1.0155491828918457, 0.7563660144805908, 1.410056710243225, -1.9879627227783203, -0.005406856536865234, -8.637923240661621, -7.391251564025879, -0.01742076873779297, -0.5344924926757812, -1.2089967727661133, 0.1232830286026001, -1.4397804737091064, -0.7909317016601562, -0.8388343453407288, -0.7471179962158203, 0.5282368659973145, -0.6020007133483887, -2.382913589477539, -0.4820082187652588, 0.41049623489379883, -0.653172492980957, 0.630836009979248, -1.1931943893432617, -0.8953151702880859, -0.3264288306236267, 1.9397029876708984, -2.1351184844970703, -0.3421783447265625, 0.5118057727813721, -0.44092631340026855, 0.888789176940918, 0.6104331016540527, 0.5377197265625, 1.2188091278076172, 1.2058448791503906, 0.44722509384155273, -1.7808399200439453, 0.9872760772705078, -1.1035633087158203, 0.007103919982910156, -0.7821597456932068, -0.6851625442504883, 0.14546656608581543, 0.19461357593536377, -0.37587451934814453, -1.286065936088562, 0.529205322265625, -0.4171104431152344, -0.3541908264160156, -5.494256973266602, -0.025221824645996094, 0.5221385955810547, -0.30079078674316406, -0.8340713381767273, -2.0255966186523438, -0.30402374267578125, -1.2487201690673828, -0.8570804595947266, -0.38769006729125977, 0.7890100479125977, 0.11660575866699219, 0.021018266677856445, 0.9993476867675781, 1.6106939315795898, -0.7560784816741943, 2.372861862182617, 0.7901191711425781, -1.5611923933029175, 2.1137523651123047, 0.364501953125, 0.5110201835632324, 0.6795473098754883, 0.2622089385986328, -1.1413235664367676, 0.3304405212402344, -0.5058364868164062, -0.4835977554321289, 0.3274383544921875, -0.421630859375, 1.2825984954833984, 3.567765712738037, 0.41820335388183594, -2.0550100803375244, -0.3032522201538086, 0.17531538009643555, -0.5683298110961914, -0.3660773038864136, 0.11056137084960938, -0.6065144538879395, -1.5270905494689941, 0.4410133361816406, 1.0835387706756592, -0.4963035583496094, 0.6776647567749023, 0.6594381332397461, -0.691777229309082, 1.1025028228759766, -0.8292546272277832, -0.08276653289794922, -0.16850709915161133, -0.304607629776001, 0.26108622550964355, -0.47579288482666016, 0.098388671875, 0.15244293212890625, -0.9511518478393555, 0.28586459159851074, 0.5907783508300781, 1.275583267211914, -6.047752380371094, -0.6274089813232422, 0.9492063522338867, -0.08885478973388672, -1.2496483325958252, -0.14045143127441406, -0.4779067039489746, 0.1783914566040039, -0.01848745346069336, -0.5611941814422607, 0.36546850204467773, 0.4355182647705078, -1.1240854263305664, 1.337533950805664, -0.7892208099365234, 0.19823956489562988, -0.20054030418395996, -0.7329673767089844, 0.2161639928817749, -0.2015066146850586, 0.7659034729003906, 0.4886507987976074, -0.4154762029647827, -0.7356853485107422, 0.1676311492919922, -0.3963470458984375, 0.5783185958862305, -0.4121131896972656, 0.6385698318481445, 2.14117431640625, -0.9386234283447266, 0.09531974792480469, -0.9386234283447266, -0.5699755549430847, -0.17764854431152344, 1.17601478099823, 0.5214433670043945, -0.38676929473876953, 0.581209659576416, -0.8022985458374023, -0.6854801774024963, -0.40712738037109375, -0.5223051309585571, 0.43667304515838623, 0.11718368530273438, -0.6371383666992188, 0.08271598815917969, 0.14456462860107422, -1.1034269332885742, 0.886962890625, 1.0928592681884766, -10.201772689819336, -0.6015777587890625, 0.7295055985450745, 0.016859054565429688, -0.4960949420928955, -0.5271186828613281, -1.3415756225585938, 0.18951177597045898, 0.4301424026489258, -0.6065720319747925, 0.5042462348937988, -1.4880695343017578, -0.6748895645141602, 5.117778778076172, -0.7759819030761719, 0.31854677200317383, -5.1209492683410645, -1.7988739013671875, 0.7973313331604004, -0.00318145751953125, -0.15958532691001892, 0.09627151489257812], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 134700, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 134700, "last_target_update_ts": 29696, "num_target_updates": 57}, "sampler_results": {"episode_reward_max": 26.176207274198532, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -148.7493004596547, "episode_len_mean": 290.5473684210526, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5219861750258167, "mean_inference_ms": 22.955889357015554, "mean_action_processing_ms": 0.1373331162287966, "mean_env_wait_ms": 4.4399144022623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 26.176207274198532, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -148.7493004596547, "episode_len_mean": 290.5473684210526, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5219861750258167, "mean_inference_ms": 22.955889357015554, "mean_action_processing_ms": 0.1373331162287966, "mean_env_wait_ms": 4.4399144022623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 134700, "num_env_steps_sampled": 29696, "num_env_steps_trained": 134700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 29696, "agent_timesteps_total": 29696, "timers": {"training_iteration_time_ms": 325.873, "learn_time_ms": 64.394, "learn_throughput": 4658.831, "synch_weights_time_ms": 20.588}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 134700, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 134700, "last_target_update_ts": 29696, "num_target_updates": 57}, "done": false, "episodes_total": 95, "training_iteration": 29, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-26-58", "timestamp": 1655494018, "time_this_iter_s": 5.142051458358765, "time_total_s": 150.97197341918945, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 150.97197341918945, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.05714285714286, "ram_util_percent": 61.357142857142854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 7.582101821899414, "min_q": -15.928689956665039, "max_q": 27.312850952148438, "mean_td_error": -1.0903619527816772}, "td_error": [-2.932577133178711, -1.2953968048095703, -1.1915677785873413, -2.2169699668884277, -1.5251331329345703, -1.388107180595398, -0.7532496452331543, 1.7015666961669922, -0.6183619499206543, -1.7867164611816406, -1.8249149322509766, -0.5496463775634766, -0.8626823425292969, 0.00971531867980957, -0.7261009216308594, -0.5495634078979492, -2.228349447250366, -0.07737016677856445, -1.222580909729004, 1.5500950813293457, 0.2409343719482422, -1.4872817993164062, -0.881842851638794, 0.7416801452636719, -1.637132167816162, -0.6765966415405273, -0.5356674194335938, -0.9237699508666992, -1.8468291759490967, -2.236037254333496, -1.1153888702392578, -0.7511286735534668, -0.3424367904663086, 0.6655874252319336, -1.5658740997314453, 0.6066646575927734, -0.7421170473098755, -1.03656005859375, -0.13516807556152344, -1.7351226806640625, -1.1981348991394043, -0.655510425567627, -2.2062721252441406, -3.104328155517578, -1.0869379043579102, -0.43535900115966797, -2.347306251525879, -1.5823173522949219, 0.5193901062011719, -0.237152099609375, -1.3044137954711914, -1.0177769660949707, 0.11344385147094727, -4.9431047439575195, -7.00262451171875, -0.1972517967224121, -2.3726234436035156, -1.107292652130127, -2.2237114906311035, -0.44947052001953125, -0.10189193487167358, -6.476251602172852, -0.6637153625488281, -1.9580917358398438, -0.7408249378204346, -0.26653575897216797, -1.466958999633789, -0.08118247985839844, 1.2397879362106323, -1.140150547027588, -6.662385940551758, 3.5253257751464844, -0.5510272979736328, 0.8941555023193359, -0.4533195495605469, -0.48287391662597656, -1.7670421600341797, -1.5229358673095703, -0.42304515838623047, -1.0519371032714844, -0.8487586975097656, -2.7044291496276855, -0.9309625625610352, -1.540025234222412, -1.1839933395385742, -0.0076904296875, 0.7729427814483643, 0.7088737487792969, -1.296976089477539, -0.9424004554748535, -0.32553744316101074, 0.41049861907958984, -0.13231754302978516, 1.084075927734375, -0.25321006774902344, -0.7508411407470703, -0.8642024993896484, 0.3910380005836487, -0.6827411651611328, -1.5390148162841797, -1.606039047241211, 0.3261550962924957, -0.9749832153320312, -1.6318550109863281, -1.0867595672607422, -1.7277969121932983, -0.5011386871337891, -2.252117156982422, -0.3052816390991211, -0.8518190383911133, -1.9226179122924805, -1.9032988548278809, -1.9301376342773438, -0.9403409957885742, 0.32883453369140625, -1.3161325454711914, -10.525190353393555, -0.0449674129486084, 0.33911216259002686, -0.49468040466308594, -2.277958393096924, -0.36878108978271484, 0.2904043197631836, 1.0396709442138672, -1.5381364822387695, 0.6042205095291138, -0.5937881469726562, -0.6834278106689453, -2.1572654247283936, -0.9738225936889648, -7.674224853515625, 0.03205585479736328, -2.349487781524658, -0.8101248741149902, -0.5236701965332031, -0.792961597442627, -3.6744489669799805, -0.4668630361557007, -0.5658483505249023, -1.1375341415405273, -1.423999309539795, -3.7809410095214844, -1.1315199136734009, -1.2794926166534424, -0.6345357894897461, -6.891082763671875, 9.525498390197754, 0.38213539123535156, -0.5257871150970459, -1.2280974388122559, -1.0674701929092407, -1.3378419876098633, -0.08193302154541016, -0.6164836883544922, -0.48583412170410156, -1.2086467742919922, -2.090083360671997, -0.42348194122314453, -0.2706279754638672, -0.4165286123752594, -1.145524501800537, -0.8375402688980103, -1.208981990814209, -1.8012828826904297, 0.6940999031066895, 0.005489349365234375, -0.2604377269744873, -1.3115859031677246, -0.9694280624389648, -0.9500551819801331, -2.087724447250366, 7.521501541137695, -1.750727653503418, 1.0282659530639648, -0.06935882568359375, -1.9001169204711914, -0.468414306640625, -1.5864243507385254, -0.5322656631469727, -0.6379127502441406, -1.9055290222167969, 1.1142663955688477, -0.6962604522705078, -1.881230354309082, -1.2533159255981445, -3.1550941467285156, -1.5212841033935547, -1.8971590995788574, -2.76930570602417, -1.4730587005615234, 0.9570198059082031, -0.10465574264526367, -1.640127182006836, -0.43700408935546875, -1.910675048828125, -0.8777346611022949, -6.050895690917969, -1.5035533905029297, -1.9063091278076172, -2.1721882820129395, -0.5772895812988281, 0.1387782096862793, -6.100193977355957, 0.6426544189453125, -0.5511910915374756, -1.0146265029907227, -0.3753942847251892, -1.8947986364364624, -2.259942054748535, -0.859316349029541, -1.2820987701416016, -1.0457448959350586, -6.4041242599487305, -5.694847106933594, -0.3602609634399414, -0.42544734477996826, -6.093402862548828, 0.39803504943847656, -0.2545278072357178, -0.21125054359436035, -1.3155517578125, -0.8116512298583984, -7.552447319030762, -1.3196454048156738, 0.5784491300582886, 1.291295051574707, -0.5582647323608398, -1.1889004707336426, -1.88303542137146, -0.5198459625244141, 0.5831565856933594, -2.6221485137939453, 0.5151176452636719, -1.7179813385009766, -1.5508241653442383, 0.6365886926651001, -5.107851028442383, 0.23143696784973145, 0.2967180013656616, -1.333932876586914, -2.888212203979492, -1.0209178924560547, -2.999776840209961, -0.47372913360595703, -0.5442619323730469, -0.5236701965332031, -0.7547187805175781, -1.130620002746582, -1.1574363708496094, -1.7315775156021118, 1.5401513576507568, -1.1004047393798828, -0.5906877517700195, 0.16228199005126953, -0.11417984962463379, -0.22936248779296875, -1.4222698211669922, -0.10097980499267578, -0.8230115175247192, 0.06545114517211914, -0.8309688568115234, -0.6020183563232422, -1.3045296669006348, -0.9128682613372803, -0.957846462726593, -0.40973395109176636, -0.12314224243164062, -0.11360931396484375, -0.13516807556152344, -0.14042186737060547, -1.8596057891845703, -1.2091703414916992, -0.5444584488868713, -6.494499206542969, -1.7918164730072021, -0.6146450042724609, -5.955514907836914, 1.1816434860229492, -0.18489468097686768, 0.4813385009765625, -1.954157829284668, -1.438359260559082, 0.46338844299316406, -0.49199581146240234, -1.0403900146484375, 0.9898500442504883, -0.6607275009155273, -7.655271530151367, -1.7845306396484375, 2.375154733657837, -0.5858826637268066, -0.5984907150268555, -2.0152621269226074, 0.6448163986206055, 0.3041515350341797, -5.92927885055542, -6.702831268310547, -0.16083836555480957, 0.19922733306884766, 0.3566713333129883], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 139500, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 139500, "last_target_update_ts": 30720, "num_target_updates": 59}, "sampler_results": {"episode_reward_max": 26.176207274198532, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -144.14191328704356, "episode_len_mean": 288.65, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5226985744795983, "mean_inference_ms": 22.993268726090786, "mean_action_processing_ms": 0.13731379112335593, "mean_env_wait_ms": 4.435623435240532, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 26.176207274198532, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -144.14191328704356, "episode_len_mean": 288.65, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.032736882567406, -56.999097377061844, -76.58677984774113, -25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806], "episode_lengths": [245, 246, 251, 242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5226985744795983, "mean_inference_ms": 22.993268726090786, "mean_action_processing_ms": 0.13731379112335593, "mean_env_wait_ms": 4.435623435240532, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 139500, "num_env_steps_sampled": 30720, "num_env_steps_trained": 139500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 30720, "agent_timesteps_total": 30720, "timers": {"training_iteration_time_ms": 343.916, "learn_time_ms": 64.652, "learn_throughput": 4640.234, "synch_weights_time_ms": 19.987}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 139500, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 139500, "last_target_update_ts": 30720, "num_target_updates": 59}, "done": false, "episodes_total": 100, "training_iteration": 30, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-27-04", "timestamp": 1655494024, "time_this_iter_s": 5.4901814460754395, "time_total_s": 156.4621548652649, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 156.4621548652649, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.137499999999996, "ram_util_percent": 61.3875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 8.568888664245605, "min_q": -14.61205005645752, "max_q": 27.114578247070312, "mean_td_error": -0.18760494887828827}, "td_error": [1.5189456939697266, -5.65658712387085, 0.5703859329223633, -1.0448532104492188, -1.4704065322875977, 0.3831672668457031, 0.42002296447753906, 0.03437328338623047, 1.0096009969711304, 0.4402143955230713, 1.7732625007629395, 0.08924651145935059, 0.03454744815826416, 0.7603855133056641, 0.0847320556640625, 0.42604923248291016, 0.27910614013671875, 0.18088281154632568, -1.253490924835205, 0.29500865936279297, 0.9447002410888672, 1.054126262664795, -0.37392377853393555, 0.6383194923400879, -0.04930305480957031, -0.8916387557983398, 0.5615445375442505, 0.03196907043457031, -0.0874176025390625, -0.7010068893432617, 0.15959453582763672, 0.9280538558959961, 0.4902467727661133, 0.16135406494140625, 1.2766027450561523, 0.9860495328903198, -0.06228524446487427, -1.1998472213745117, 1.9494075775146484, 1.3277149200439453, 0.30654335021972656, 0.4636192321777344, 1.3369426727294922, 0.8013324737548828, 0.5266501903533936, 5.903530120849609, -0.26239681243896484, -0.6314001083374023, 0.1378307342529297, 1.3004493713378906, 1.1400156021118164, 1.059133529663086, 1.2596917152404785, 0.29500865936279297, 0.2677888870239258, 0.5455169677734375, -6.5188093185424805, -0.2964210510253906, -12.311927795410156, -6.261534214019775, 0.6145143508911133, -0.3141965866088867, -0.2759995460510254, 1.7042808532714844, 0.5613594055175781, 0.1550731658935547, -0.36723804473876953, 1.4026145935058594, 0.14779090881347656, 0.7700157165527344, 0.020051956176757812, 0.7633695602416992, 1.209489345550537, -0.09981632232666016, 1.372675895690918, -0.5351591110229492, -1.3445367813110352, 0.9341754913330078, 0.6049413681030273, 1.0626609325408936, 0.008487701416015625, 1.050513505935669, 0.4673764705657959, 1.034677505493164, 1.3057670593261719, -1.8043708801269531, -4.89774751663208, 0.9089219570159912, 0.9252762794494629, 1.475834846496582, -0.4547309875488281, 0.3970276117324829, 1.6913251876831055, -0.6464443206787109, 9.795324325561523, -6.8367228507995605, -5.906552314758301, -0.8797397613525391, 0.030174732208251953, 0.36395740509033203, 0.4758124351501465, 0.9897894859313965, -5.65658712387085, 1.3952064514160156, 0.3500986099243164, -9.408601760864258, 0.5297117233276367, 0.6396255493164062, 0.3934755325317383, 2.3539609909057617, 0.4309988021850586, 0.34107232093811035, 1.3442001342773438, 0.9592694640159607, -0.128387451171875, -2.8125200271606445, 0.7852649688720703, 0.07145404815673828, 0.45856380462646484, 0.6919193267822266, -0.1238260269165039, 0.5819973945617676, 1.9447250366210938, 0.9534530639648438, 0.8272495269775391, -0.22492313385009766, 0.6792716979980469, 0.5163118839263916, 0.5513452887535095, 0.07811164855957031, 0.8142471313476562, -4.446559906005859, 1.0006256103515625, 0.4771413803100586, 1.3358168601989746, -1.1721878051757812, 0.8685550689697266, 0.8502216339111328, 1.2082338333129883, 0.6648349761962891, -1.5247585773468018, 0.29837703704833984, 1.065166711807251, 1.0552597045898438, -0.48337650299072266, -0.9949703216552734, 0.40755176544189453, 1.0263237953186035, -0.5223984718322754, 0.07269668579101562, 0.3490527868270874, 1.2335447072982788, 0.4957122802734375, 0.6134011745452881, 1.0556983947753906, -0.35024452209472656, 0.4896259307861328, -0.2868458032608032, -1.5956192016601562, -0.5295257568359375, 1.0006256103515625, 0.6947989463806152, -0.29261016845703125, 0.9465632438659668, -1.315485954284668, 0.08846664428710938, -0.2855968475341797, 1.4103035926818848, 0.24954938888549805, 1.1816720962524414, -10.072118759155273, -0.7265939712524414, 0.7477192878723145, 0.24360179901123047, 0.4504740238189697, 0.3581051826477051, 0.27036380767822266, -0.3207743167877197, -0.274463415145874, -0.21145915985107422, 1.065166711807251, 1.6700782775878906, 0.7136001586914062, 0.5263552665710449, 1.8935742378234863, 1.1076431274414062, 0.6178369522094727, -0.06787633895874023, 0.14574432373046875, -0.1711578369140625, -4.838741302490234, -6.216292381286621, -0.40842437744140625, 0.29486656188964844, -0.672149658203125, 0.7630987167358398, 0.27396678924560547, 0.22083663940429688, -0.34047508239746094, -0.23994159698486328, 1.607595443725586, -0.13233399391174316, 1.1630573272705078, 0.6894807815551758, -1.181969165802002, 0.5621109008789062, -0.4210796356201172, -9.218320846557617, -0.5035910606384277, -7.20952033996582, 0.42461061477661133, 1.1617274284362793, 0.6860413551330566, 1.5471296310424805, -0.0180206298828125, 1.657029151916504, 0.9252171516418457, 1.061610221862793, 0.8374204635620117, 0.08912944793701172, 0.8129978179931641, 2.2130556106567383, 1.003570556640625, -12.28353500366211, -0.0635995864868164, -3.8454818725585938, -0.13758540153503418, 0.04371070861816406, 0.2654743194580078, 0.7471117973327637, 1.3563175201416016, -1.7926998138427734, -0.1370438188314438, 0.3196067810058594, -0.39877891540527344, 0.9869303703308105, -1.2633419036865234, 0.4577608108520508, 0.27396678924560547, 0.8448085784912109, -1.875162124633789, -0.32134246826171875, 0.29157257080078125, 0.08664250373840332, 1.1546874046325684, 0.7552294731140137, 0.16341781616210938, -0.772122859954834, 0.8322877883911133, -0.25331616401672363, 1.7652263641357422, -0.5466442108154297, 0.23475396633148193, 1.2664661407470703, 0.7435235977172852, -0.5188112258911133, 0.6526832580566406, 0.5551862716674805, -0.12754535675048828, -0.420773983001709, -9.347434997558594, 0.4830446243286133, -0.03676557540893555, 0.03168487548828125, 0.4069328308105469, -5.970661163330078, 0.17131519317626953, 0.8872566223144531, 1.469210147857666, 1.239006519317627, 0.08960914611816406, 0.3305845260620117, 0.4444718360900879, 0.36395740509033203, -0.17735958099365234, -0.09672427177429199, -0.29430699348449707, 1.116628646850586, 0.14574432373046875, 0.1444559097290039, -5.805702209472656, 1.4388494491577148, -1.1336324214935303, -0.3112880289554596, -0.2612438201904297, -2.532240152359009, 0.7397962808609009, 0.6203823089599609, -0.4408900737762451, -9.347434997558594, 0.2324237823486328, -5.603216171264648, 0.896449089050293, -0.015924453735351562, 0.6141452789306641, 0.9164555072784424, -8.083751678466797, -0.7283172607421875, -2.1309728622436523, 1.0181102752685547], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 144300, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 144300, "last_target_update_ts": 31744, "num_target_updates": 61}, "sampler_results": {"episode_reward_max": 26.641731038689613, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -142.48602005183696, "episode_len_mean": 288.06, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827], "episode_lengths": [242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5221916452415328, "mean_inference_ms": 23.02310105192456, "mean_action_processing_ms": 0.13617726023720425, "mean_env_wait_ms": 4.404563856036891, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 26.641731038689613, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -142.48602005183696, "episode_len_mean": 288.06, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25.12009185552597, -53.35071071237326, -38.838877484202385, -25.560859136283398, -50.210819609463215, -94.10221508145332, -106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827], "episode_lengths": [242, 251, 250, 242, 246, 276, 287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5221916452415328, "mean_inference_ms": 23.02310105192456, "mean_action_processing_ms": 0.13617726023720425, "mean_env_wait_ms": 4.404563856036891, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 144300, "num_env_steps_sampled": 31744, "num_env_steps_trained": 144300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 31744, "agent_timesteps_total": 31744, "timers": {"training_iteration_time_ms": 347.182, "learn_time_ms": 64.917, "learn_throughput": 4621.257, "synch_weights_time_ms": 20.89}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 144300, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 144300, "last_target_update_ts": 31744, "num_target_updates": 61}, "done": false, "episodes_total": 103, "training_iteration": 31, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-27-09", "timestamp": 1655494029, "time_this_iter_s": 5.395686388015747, "time_total_s": 161.85784125328064, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 161.85784125328064, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 34.55, "ram_util_percent": 61.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 7.471123218536377, "min_q": -15.479780197143555, "max_q": 29.838132858276367, "mean_td_error": -0.3821673095226288}, "td_error": [-0.5303735733032227, -0.8450398445129395, -0.870671272277832, -0.6698017120361328, -0.3051184415817261, -6.261014938354492, -0.0001621246337890625, 0.9565267562866211, -0.20712041854858398, -0.21199607849121094, 0.7901868224143982, -0.0340423583984375, -0.5774013996124268, -0.05581378936767578, -0.4120502471923828, -0.5150117874145508, 0.42394208908081055, -0.632260799407959, -6.2195940017700195, -1.1595878601074219, -0.32138824462890625, 0.016824722290039062, -0.2809715270996094, 0.3700968623161316, -0.45784950256347656, 1.8521919250488281, 0.4553271532058716, 0.09815216064453125, -1.101750373840332, 0.6253570318222046, -0.5109310150146484, -4.900561809539795, 0.4253883361816406, -0.24581432342529297, -5.271799087524414, -0.2196488380432129, 0.4269336462020874, 0.04650115966796875, -0.2743034362792969, -2.9815006256103516, 2.2168757915496826, -0.0340423583984375, -0.8386831283569336, -0.10859692096710205, -5.510526180267334, 1.0172442197799683, 0.9970600605010986, 1.574615478515625, 0.31063222885131836, -0.9673945903778076, 1.550644874572754, -0.4172687530517578, -1.1615571975708008, -0.5952615737915039, 0.20099693536758423, -0.3862724304199219, 1.7420806884765625, 0.08966636657714844, -5.4250288009643555, 0.49445533752441406, 0.02637305296957493, -0.223785400390625, -1.0869121551513672, -0.2530975341796875, -0.0076141357421875, -0.17795133590698242, -0.5526466369628906, -1.3349342346191406, 0.8859882354736328, 2.043759346008301, 0.7659358978271484, -1.0290336608886719, -0.17339181900024414, 0.8747529983520508, -0.38686180114746094, -0.21199607849121094, -4.375288009643555, 1.3532085418701172, -0.0748586654663086, -0.4198789596557617, -0.35486745834350586, -0.8280302286148071, -0.48346078395843506, -1.536576271057129, -1.0074262619018555, 0.22156190872192383, 0.6733152866363525, -0.8654689788818359, -0.22694635391235352, 0.3583669662475586, -0.1867351531982422, 0.658778190612793, 0.7290982604026794, -0.5332551002502441, 1.4573612213134766, 0.7956655025482178, 2.1846580505371094, 0.25697994232177734, -0.33136749267578125, 0.6232652068138123, -0.684837818145752, 0.2619304656982422, 0.6996498107910156, -0.4965057373046875, -0.9025907516479492, 0.030768394470214844, -0.04138714075088501, 0.0020093917846679688, -0.4113287925720215, -0.4476649761199951, 0.32578879594802856, 0.08224105834960938, -0.21181511878967285, -0.5265274047851562, -1.1593513488769531, -0.6456012725830078, -0.20975112915039062, 0.22240734100341797, 0.7956655025482178, -1.0541296005249023, 0.5055074691772461, 0.7938547134399414, -0.6144518852233887, 1.0866270065307617, -2.3933753967285156, -0.9122962951660156, -8.85025405883789, 0.5186524391174316, -0.7925608158111572, -0.22083282470703125, -1.2110843658447266, -4.393819808959961, 0.7581932544708252, 0.27242112159729004, 0.09925532341003418, 0.6338715553283691, -0.03367424011230469, -0.09288787841796875, 0.06281757354736328, -0.24581432342529297, -1.331181287765503, -0.4763965606689453, -0.4142909049987793, 0.24147796630859375, -0.15536832809448242, -0.23765182495117188, 1.102525234222412, -0.9118146896362305, -5.532759666442871, 0.006015777587890625, -4.338310241699219, -0.4683990478515625, 0.3919658660888672, -0.25885772705078125, 0.7263774871826172, -0.0748586654663086, -0.3806276321411133, 0.5360012054443359, -0.08978497982025146, -0.05057322978973389, -0.059909820556640625, 0.07859116792678833, -0.19893169403076172, -0.9998345375061035, -0.7306637763977051, 0.9099488258361816, -1.3070344924926758, -6.381776809692383, 0.4903097152709961, -1.1878461837768555, 0.41663479804992676, -0.9339098930358887, 0.7956655025482178, 1.4035316705703735, 0.1438608169555664, -2.1588573455810547, -0.885080099105835, 0.2612299919128418, -2.344074249267578, -0.3296750783920288, 0.3618900775909424, 1.0188796520233154, -0.8963985443115234, 0.7766879200935364, -0.04907369613647461, -0.3227100372314453, -0.344268798828125, 0.9691257476806641, -0.3331007957458496, -1.3106975555419922, -1.1585958003997803, -1.270298957824707, 0.1639552116394043, -0.14929533004760742, 0.04763221740722656, -2.0450448989868164, 2.0862083435058594, -1.282827377319336, -1.6411542892456055, -0.7462425231933594, 0.9492886066436768, -0.33727073669433594, -0.7328157424926758, -0.21874046325683594, -0.17454862594604492, 0.32091420888900757, -0.9377093315124512, -0.17795133590698242, -5.887729644775391, 1.2854411602020264, 0.39426612854003906, 1.669412612915039, 1.097015619277954, -0.7885212898254395, -0.30005455017089844, 0.12417459487915039, -4.719952583312988, -1.0804510116577148, -7.071552276611328, 0.2338418960571289, -0.2260284423828125, 0.010318756103515625, -0.9248833656311035, 1.0031404495239258, -0.6820716857910156, -1.0869121551513672, -0.3082737922668457, -1.0999116897583008, 0.06467342376708984, -7.159101486206055, -0.40987586975097656, -0.20600438117980957, 1.443063735961914, 0.1375570297241211, -8.233909606933594, -0.11204195022583008, -10.885988235473633, -2.3521053791046143, 0.37305355072021484, -1.0140995979309082, 1.078383445739746, -0.18892836570739746, 0.2342815399169922, -0.8477745056152344, -0.020358562469482422, 0.13648104667663574, 0.40306997299194336, 0.6444337368011475, -0.42619991302490234, -0.4989604949951172, 0.8433361053466797, 0.15656518936157227, -1.8547720909118652, 0.36474609375, -0.05793476104736328, 0.6246623992919922, -0.71356201171875, -4.923202037811279, 0.28163719177246094, -1.427663803100586, 0.06137275695800781, -0.1794452667236328, -0.08364439010620117, -1.4217109680175781, 0.5727320909500122, -0.17676925659179688, -0.49242085218429565, -0.6610450744628906, -0.8598251342773438, 28.019540786743164, -0.7544851303100586, 0.052437424659729004, 0.0019116401672363281, -0.24210453033447266, 0.2647533416748047, -0.8018739223480225, 0.5439882278442383, -0.06168937683105469, 0.5161287784576416, 1.0634746551513672, -6.393374443054199, 0.1126813292503357, -0.22490906715393066, -0.775299072265625, 0.19819259643554688, 2.655515670776367, 0.6032986640930176, 0.33194732666015625, 6.869197845458984, -0.25057363510131836, -1.0015134811401367, 0.43277081847190857, -0.4198799133300781, -0.8752527236938477, 1.0243377685546875, -0.6289467811584473, -0.14997732639312744, -0.9862880706787109, 2.1204729080200195, -0.5894374847412109], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 149100, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 149100, "last_target_update_ts": 32768, "num_target_updates": 63}, "sampler_results": {"episode_reward_max": 26.641731038689613, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -141.66379644609987, "episode_len_mean": 287.63, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522], "episode_lengths": [287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5166455249954729, "mean_inference_ms": 23.17171488855565, "mean_action_processing_ms": 0.13504051311785267, "mean_env_wait_ms": 4.337191922778217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 26.641731038689613, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -141.66379644609987, "episode_len_mean": 287.63, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.2471659258008, -58.78811512887478, -142.49909740686417, -157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522], "episode_lengths": [287, 268, 291, 290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5166455249954729, "mean_inference_ms": 23.17171488855565, "mean_action_processing_ms": 0.13504051311785267, "mean_env_wait_ms": 4.337191922778217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 149100, "num_env_steps_sampled": 32768, "num_env_steps_trained": 149100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 32768, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 337.739, "learn_time_ms": 64.67, "learn_throughput": 4638.909, "synch_weights_time_ms": 21.088}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 149100, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 149100, "last_target_update_ts": 32768, "num_target_updates": 63}, "done": false, "episodes_total": 109, "training_iteration": 32, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-27-15", "timestamp": 1655494035, "time_this_iter_s": 5.523588418960571, "time_total_s": 167.3814296722412, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 167.3814296722412, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.7125, "ram_util_percent": 61.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 7.649740219116211, "min_q": -15.634194374084473, "max_q": 27.143165588378906, "mean_td_error": -0.4878123104572296}, "td_error": [-0.2693367004394531, 0.044712066650390625, -0.8845624923706055, -1.0483689308166504, 0.6555488109588623, -0.4812948703765869, -1.743295669555664, 1.4528865814208984, 0.3260622024536133, 0.929560661315918, 1.019815444946289, 1.5631580352783203, -0.8512940406799316, -0.2776203155517578, -0.5070104598999023, 0.03176259994506836, 0.5262689590454102, -0.339571475982666, 0.3342241644859314, -0.7080059051513672, 1.3620429039001465, 1.692944049835205, 0.5844230651855469, -0.5246543884277344, -0.024160385131835938, 0.38690662384033203, -0.2725973129272461, 3.6643571853637695, -1.0872325897216797, -0.5129039287567139, 1.3010101318359375, 0.3195304870605469, -0.041640281677246094, 0.8271071910858154, -0.7314367294311523, -5.726982116699219, -0.0019741058349609375, -0.45123982429504395, -1.1221046447753906, -0.6420769691467285, 0.6589088439941406, 0.8021445274353027, 1.18800950050354, -1.0231313705444336, 0.8233472108840942, -1.2851581573486328, 0.1656956672668457, 0.9562149047851562, 1.3620429039001465, -0.6834230422973633, -0.05305051803588867, 0.6080379486083984, -0.6660618782043457, 0.5500006675720215, 0.5070332884788513, -0.4283716678619385, -0.05040454864501953, 0.7811708450317383, -1.1233701705932617, -0.9694671630859375, -0.4341078996658325, -0.6242504119873047, -1.3225951194763184, -1.076345443725586, -0.5601023435592651, -1.2009248733520508, -1.0126147270202637, -0.22585296630859375, 0.6007037162780762, 0.8089917898178101, -2.535141944885254, 1.6150970458984375, 0.04085588455200195, -0.0014396905899047852, 0.07652151584625244, 0.3104820251464844, -1.2734088897705078, -0.5070743560791016, -0.3406047821044922, 0.10743474960327148, -0.47684669494628906, 1.0871188640594482, -1.4044842720031738, -3.774188756942749, 0.18941879272460938, -0.16427230834960938, 0.18937110900878906, -1.1319828033447266, -0.3727564811706543, -5.480548858642578, 0.3124399185180664, -6.994841575622559, -2.2416439056396484, -0.16410541534423828, 0.5095605850219727, -1.111948013305664, -7.192992210388184, 1.4453001022338867, 0.9622554779052734, -0.1511220932006836, -1.1462230682373047, 0.18426895141601562, 0.3520660400390625, 0.12626361846923828, -0.19356060028076172, -5.20667839050293, 0.9362437725067139, 0.3566558361053467, -0.7486932277679443, 0.625684380531311, -4.775364875793457, -0.4880795478820801, 4.055889129638672, 0.5796456336975098, -0.9117827415466309, -0.38966846466064453, -0.7523527145385742, 0.08320659399032593, 0.6539821624755859, -0.5095310211181641, 0.28760719299316406, 0.42531442642211914, -0.5246543884277344, -0.8672580718994141, 0.38613128662109375, -1.2922801971435547, 0.09707164764404297, -1.1849250793457031, -0.1624593734741211, 1.760514736175537, 0.8983993530273438, 3.8210296630859375, 0.7139544486999512, -0.2541818618774414, 0.07652151584625244, -0.2879199981689453, 0.4098832309246063, -0.8333773612976074, -2.0801992416381836, -5.535483360290527, -1.4207167625427246, -7.570307731628418, -5.971579074859619, 0.08061408996582031, -0.7440319061279297, -0.37513256072998047, -0.1758803129196167, -0.1411956548690796, -1.3245162963867188, -1.3696556091308594, -2.378830909729004, 0.33068323135375977, 0.0834207534790039, -1.1768608093261719, 1.6150970458984375, -0.987846851348877, 0.41072940826416016, 1.0102596282958984, -0.020556926727294922, -0.18339687585830688, -0.4694805145263672, -0.1699666976928711, 0.0027431249618530273, 0.05590718984603882, 1.9791145324707031, -0.18006324768066406, 0.13719463348388672, -6.782919406890869, -0.342940092086792, -0.37595272064208984, -1.9616241455078125, 7.731146812438965, -0.6797618865966797, 0.5379891395568848, 0.3728208839893341, -0.8365049362182617, 0.12512588500976562, 0.30143165588378906, 0.24566435813903809, -0.9243946075439453, -0.9125761985778809, -0.34755897521972656, 1.0858964920043945, -0.013437271118164062, -7.556320667266846, 0.6594457626342773, -0.3107471466064453, 1.7526822090148926, 0.3429778814315796, -0.8448076248168945, -0.09895133972167969, 0.016004323959350586, 0.25838595628738403, -0.35346412658691406, -0.9622707366943359, -1.1766424179077148, -1.0557975769042969, -0.07330131530761719, 0.1330413818359375, 0.5974602699279785, 0.2982158660888672, -0.39108753204345703, 1.734480381011963, -0.35469818115234375, -0.10940408706665039, -0.9572181701660156, -0.39108753204345703, -2.9553070068359375, -0.9197123050689697, 2.087611198425293, -1.7705602645874023, 0.05739402770996094, -6.480356216430664, 1.0822503566741943, 0.485858678817749, -0.2243480682373047, 13.681292533874512, -0.40570640563964844, 0.8233472108840942, -1.5827302932739258, 0.7449131011962891, 0.3594820499420166, 0.038836002349853516, -0.6375522613525391, -0.9752378463745117, -1.0353641510009766, 0.45349621772766113, -2.337735176086426, -1.235708236694336, -1.235708236694336, 0.05922508239746094, -1.0055198669433594, -0.9309759140014648, 0.1771240234375, -1.4852733612060547, -0.6201777458190918, -2.265038013458252, -1.5195984840393066, -2.171234130859375, -0.16649198532104492, -0.9788379669189453, -0.535369873046875, -0.4704856872558594, -8.203228950500488, -10.073534965515137, -6.69986629486084, -0.8958568572998047, -0.4944877624511719, 0.13132953643798828, -1.7861042022705078, -0.8570833206176758, -1.2107362747192383, 0.7195835113525391, -0.6616177558898926, -0.5740633010864258, -0.4562835693359375, -7.053871154785156, -1.1554927825927734, -0.41375017166137695, -1.8213214874267578, -6.311962127685547, -1.4395596981048584, -3.1457080841064453, 0.13016891479492188, 0.3036823272705078, 0.36773204803466797, 0.36115455627441406, -0.21381473541259766, -1.1375689506530762, 1.6396384239196777, -0.3449678421020508, -0.346160888671875, 0.5714120864868164, -0.4265172481536865, 0.39527082443237305, 0.043443918228149414, -0.3955097198486328, -1.2444534301757812, -0.10274910926818848, -1.5149345397949219, -1.3126516342163086, 0.5266742706298828, -0.339571475982666, 0.771519660949707, 2.703831672668457, 0.16487979888916016, -1.5165863037109375, 0.641484260559082, 0.45863842964172363, -1.3341736793518066, 0.06997966766357422, 0.5740745067596436, -2.061854839324951, 0.08039402961730957, 0.6213016510009766, -1.5569238662719727, 0.4605398178100586, -1.6417911052703857, -2.276552200317383, 1.3519172668457031], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 153900, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 153900, "last_target_update_ts": 33792, "num_target_updates": 65}, "sampler_results": {"episode_reward_max": 26.641731038689613, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -140.11451889164746, "episode_len_mean": 286.53, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462], "episode_lengths": [290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5175755941877689, "mean_inference_ms": 23.226321095210636, "mean_action_processing_ms": 0.13494494612792837, "mean_env_wait_ms": 4.3243222941011945, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 26.641731038689613, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -140.11451889164746, "episode_len_mean": 286.53, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157.70000007748604, -101.46550904214382, -94.20598547905684, -112.73839224874973, -190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462], "episode_lengths": [290, 276, 277, 284, 309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5175755941877689, "mean_inference_ms": 23.226321095210636, "mean_action_processing_ms": 0.13494494612792837, "mean_env_wait_ms": 4.3243222941011945, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 153900, "num_env_steps_sampled": 33792, "num_env_steps_trained": 153900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 33792, "agent_timesteps_total": 33792, "timers": {"training_iteration_time_ms": 330.765, "learn_time_ms": 64.493, "learn_throughput": 4651.653, "synch_weights_time_ms": 20.389}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 153900, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 153900, "last_target_update_ts": 33792, "num_target_updates": 65}, "done": false, "episodes_total": 112, "training_iteration": 33, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-27-20", "timestamp": 1655494040, "time_this_iter_s": 5.301770210266113, "time_total_s": 172.68319988250732, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 172.68319988250732, "timesteps_since_restore": 0, "iterations_since_restore": 33, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.675000000000004, "ram_util_percent": 61.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 9.21368408203125, "min_q": -11.948172569274902, "max_q": 31.320919036865234, "mean_td_error": -0.44971874356269836}, "td_error": [1.2937016487121582, 2.111708641052246, 1.4862475395202637, 0.7053108215332031, 0.33127832412719727, -0.6260948181152344, 0.29607582092285156, 0.37873125076293945, -1.944936752319336, 1.2758760452270508, 1.0045325756072998, -0.7267210483551025, 1.0369715690612793, 0.6114177703857422, -0.16912364959716797, 0.33949756622314453, -0.4288005828857422, 0.6125759482383728, -4.580801963806152, 0.2853546142578125, 1.681112289428711, 0.5513210296630859, 0.4142131805419922, 1.5606703758239746, -1.0171689987182617, 1.3852910995483398, -1.5476741790771484, -0.15630340576171875, -0.2008533477783203, 0.7055644989013672, -1.4654521942138672, -0.1755962371826172, -1.717245101928711, -0.3974785804748535, -0.8666172027587891, -0.5717949867248535, 0.8388481140136719, -0.04546356201171875, -0.5699234008789062, -5.392522811889648, 1.1054768562316895, 0.5105230212211609, -0.7237367630004883, -0.3970203399658203, 0.12434959411621094, -0.25403833389282227, -1.2979660034179688, -0.374731183052063, 0.23772668838500977, 0.10225296020507812, -5.60422420501709, 0.8248481750488281, -0.13769960403442383, 1.0808582305908203, -0.07090950012207031, 0.10695719718933105, -0.1227412223815918, -0.5981283187866211, 0.9081077575683594, -0.09354305267333984, 0.2138824462890625, -1.723433017730713, -0.6163244247436523, -0.1473674774169922, -0.27414751052856445, -0.4072831869125366, -0.027544021606445312, -0.48978090286254883, -0.6097126007080078, -0.0655059814453125, 0.4472670555114746, -2.1057543754577637, 1.1348075866699219, 0.1687602996826172, 1.3964881896972656, -0.45710062980651855, 1.65484619140625, -0.6260948181152344, 1.4092888832092285, -1.8040180206298828, -1.0645828247070312, 0.2853546142578125, 0.7002773284912109, 1.729443073272705, 0.11847496032714844, 0.5305466651916504, 0.36212921142578125, 0.7180469036102295, -5.879680633544922, -10.015420913696289, 1.4371347427368164, -0.08708536624908447, -0.16544818878173828, 1.0216050148010254, -6.686733722686768, -0.09146952629089355, 0.022070497274398804, 0.47936058044433594, 0.014720916748046875, -0.11246888339519501, 0.11874198913574219, -1.1832656860351562, -0.3229178190231323, -0.2734661102294922, -0.6582000255584717, -0.1755962371826172, 0.5520546436309814, 0.8601236343383789, 0.9387054443359375, -6.019256591796875, -4.606716156005859, -0.11827224493026733, 0.2872488498687744, 5.595950126647949, -0.5249195098876953, 0.7970790863037109, 0.022742390632629395, 0.9750328063964844, -6.949821949005127, -2.2583069801330566, -0.5340557098388672, -0.1431560516357422, 1.1121177673339844, -0.9581255912780762, -0.7093617916107178, -0.446502685546875, -0.6066856384277344, 1.8268451690673828, 0.4142131805419922, 1.0866663455963135, -0.4770832061767578, -1.5359877347946167, -0.9933251142501831, 0.41355323791503906, -7.456273078918457, 0.3465762138366699, -0.23387908935546875, -0.925990104675293, -0.4482440948486328, 0.5148191452026367, -0.39926910400390625, 0.17809104919433594, 2.057952880859375, 0.05709850788116455, 0.4408845901489258, 0.3153362274169922, -0.04157280921936035, -0.10414409637451172, -0.4360208511352539, 1.0601239204406738, -1.2831354141235352, 0.26393651962280273, -0.6696953773498535, -0.6247444152832031, -7.227418899536133, -0.2319812774658203, -0.052944183349609375, -0.8013134002685547, -0.7737045288085938, -1.02471923828125, -0.14704632759094238, 1.5414438247680664, 1.4349098205566406, -8.004283905029297, 0.06908798217773438, 0.08940505981445312, 0.07669639587402344, 0.10225296020507812, 5.17072057723999, -1.0265378952026367, -0.8669242858886719, -0.6592159271240234, 0.13139280676841736, 0.6180920600891113, 0.9944486618041992, -0.3317546844482422, -1.5815906524658203, -1.1177330017089844, 0.6256523132324219, 0.5968742370605469, 0.019735634326934814, -0.7208199501037598, 0.9056863784790039, 0.53662109375, 0.3135056495666504, -9.1509370803833, 1.190185546875, -1.3022470474243164, -0.23119688034057617, -0.12618446350097656, 0.4049515724182129, -0.21019649505615234, 1.2146939039230347, -0.22589111328125, 1.4918367862701416, -0.25550341606140137, -0.4429588317871094, -2.480170726776123, 1.2639684677124023, -1.4145536422729492, 1.1304559707641602, -6.415734767913818, 2.728862762451172, -3.4296951293945312, -6.083099365234375, -5.511319637298584, -1.5361995697021484, 0.00529026985168457, -0.28569984436035156, 0.17469453811645508, 1.4535713195800781, -1.203857421875, -0.48636627197265625, -1.643625259399414, -1.1766703128814697, -5.181936740875244, -0.15565872192382812, -1.0485100746154785, 0.8108458518981934, 0.46384239196777344, 0.2552337646484375, -0.8220051527023315, -2.4921035766601562, -0.09984016418457031, -0.3522472381591797, -9.672616958618164, -0.11046600341796875, 1.0216065645217896, 1.8546619415283203, 0.42731666564941406, 1.9907360076904297, -5.7398881912231445, -0.562324583530426, -0.8725912570953369, 0.562576174736023, 1.4918367862701416, -1.2916736602783203, 0.7195205688476562, -0.5736894607543945, -1.438547134399414, -0.11046600341796875, 1.7501602172851562, -0.43370819091796875, -0.6035356521606445, 1.0004453659057617, -1.9895744323730469, 0.9398174285888672, 1.1725797653198242, -0.6292929649353027, -1.064021110534668, -0.24200111627578735, -0.024067401885986328, -0.28927040100097656, -0.6140451431274414, -0.4147071838378906, 0.11835861206054688, -0.03381538391113281, 0.33875107765197754, -0.10790157318115234, -0.20383358001708984, -0.28916263580322266, 2.544340133666992, 0.1426544189453125, 0.9730575084686279, -0.2793874740600586, -0.3304758071899414, -0.43370819091796875, 0.4795231819152832, 0.45406436920166016, -0.9552545547485352, 0.14165019989013672, -0.9793100357055664, -0.19395732879638672, -0.6007242202758789, 0.09696054458618164, 0.19772768020629883, -0.4419078826904297, 0.29460811614990234, -0.7581872940063477, 0.8569679260253906, -4.0162506103515625, 0.11242389678955078, 0.18226337432861328, -0.23780059814453125, 2.0757479667663574, -11.176353454589844, -6.128704071044922, -0.4448661804199219, 0.08205223083496094, -0.01045846939086914, -1.309432029724121, 0.802452564239502, 0.3575725555419922, 0.8472585678100586, 0.46048736572265625, 2.206599712371826, -4.807062149047852, 0.24985313415527344, 1.1082820892333984, -0.1755962371826172], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 158700, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 158700, "last_target_update_ts": 34816, "num_target_updates": 67}, "sampler_results": {"episode_reward_max": 26.641731038689613, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -136.73285567715763, "episode_len_mean": 284.64, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237], "episode_lengths": [309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5189880337417211, "mean_inference_ms": 23.296160342546944, "mean_action_processing_ms": 0.13514483866897245, "mean_env_wait_ms": 4.3016683084434195, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 26.641731038689613, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -136.73285567715763, "episode_len_mean": 284.64, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-190.7678050622344, -169.75491761416197, -216.26449727267027, -227.67148768901825, -291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237], "episode_lengths": [309, 307, 323, 340, 354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5189880337417211, "mean_inference_ms": 23.296160342546944, "mean_action_processing_ms": 0.13514483866897245, "mean_env_wait_ms": 4.3016683084434195, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 158700, "num_env_steps_sampled": 34816, "num_env_steps_trained": 158700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 34816, "agent_timesteps_total": 34816, "timers": {"training_iteration_time_ms": 335.042, "learn_time_ms": 64.97, "learn_throughput": 4617.525, "synch_weights_time_ms": 20.289}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 158700, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 158700, "last_target_update_ts": 34816, "num_target_updates": 67}, "done": false, "episodes_total": 116, "training_iteration": 34, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-27-26", "timestamp": 1655494046, "time_this_iter_s": 5.436410903930664, "time_total_s": 178.119610786438, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 178.119610786438, "timesteps_since_restore": 0, "iterations_since_restore": 34, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.924999999999997, "ram_util_percent": 62.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 9.450096130371094, "min_q": -17.338520050048828, "max_q": 31.381235122680664, "mean_td_error": -0.30567193031311035}, "td_error": [-0.3152298927307129, 0.1419677734375, -8.012350082397461, 0.4642219543457031, 0.8965121507644653, 10.668839454650879, -0.5019612312316895, 0.5255193710327148, -0.015466690063476562, -0.6036291122436523, 0.008526802062988281, -0.5932013988494873, -0.11946868896484375, 1.2497200965881348, 0.5195071697235107, 0.6468145847320557, -0.03780364990234375, 1.464714527130127, -0.06331443786621094, -0.16826438903808594, -1.210235595703125, -0.5001239776611328, 0.23546600341796875, -0.6674902439117432, -0.6886329650878906, -0.4661142826080322, -0.7545623779296875, 0.33059024810791016, -1.7480487823486328, -0.7188858985900879, -0.5663061141967773, -1.299102783203125, 0.4889659881591797, 0.4496903419494629, 1.4161529541015625, 0.8319129943847656, -0.04726219177246094, 0.21360397338867188, -1.9112701416015625, -8.122937202453613, -0.4547538757324219, -0.2320098876953125, -0.33721494674682617, 1.7932841777801514, 0.7389450073242188, -1.0523691177368164, -1.334310531616211, -7.375880241394043, 0.20142078399658203, -0.01594257354736328, 0.4068242311477661, -0.2587881088256836, -1.3538885116577148, 1.3415985107421875, -0.6024556159973145, 0.10947394371032715, 1.381929636001587, -0.49401092529296875, -0.362903356552124, -0.2953977584838867, 2.626798391342163, 0.41123437881469727, 0.6007556915283203, 0.6708469390869141, 1.1867012977600098, -0.891510009765625, -0.7512247562408447, -0.9016256332397461, 0.23954391479492188, -0.4486122131347656, -0.7655050754547119, -0.2196197509765625, -5.284675121307373, 0.20333194732666016, -0.6745071411132812, 0.31812095642089844, -0.2375164031982422, 0.46454811096191406, -1.9132461547851562, 0.09589004516601562, -0.6036291122436523, 0.35767173767089844, -0.06217813491821289, -7.273675441741943, 0.8076858520507812, -0.7853102684020996, -0.4321708679199219, 0.05650734901428223, -0.5082588195800781, -0.4597492218017578, 0.18346214294433594, 0.04352760314941406, 1.0539264678955078, 0.43241143226623535, 2.1063671112060547, 0.009278178215026855, -3.041398048400879, 0.14643001556396484, -3.599681854248047, -5.996698379516602, -7.233803749084473, -0.08963513374328613, 0.22655773162841797, -1.2112007141113281, -0.5961408615112305, 0.822077751159668, -6.336578369140625, -0.10717320442199707, -0.8299264907836914, -2.774202346801758, 30.950599670410156, 0.4881489872932434, -0.4740028381347656, 0.36919593811035156, -0.17030000686645508, -0.6263935565948486, 0.6640892028808594, -1.3386917114257812, 1.39862060546875, -0.3362002372741699, 1.0405735969543457, -0.530487060546875, -0.9544410705566406, -4.176261901855469, 14.155014991760254, 1.108485221862793, 0.7433910369873047, -0.3362002372741699, -0.12343788146972656, -0.9101672172546387, 1.2692791223526, -0.3167257308959961, -5.799457550048828, -2.374998092651367, -0.08656120300292969, 0.26961565017700195, 1.184891700744629, -0.9750218391418457, -1.2627105712890625, 0.05646038055419922, 0.8076858520507812, 0.4965381622314453, 0.6011345386505127, 0.32022953033447266, -6.998961925506592, 0.30735015869140625, -0.3337059020996094, -0.3471217751502991, 0.265045166015625, 0.6951713562011719, -5.048174858093262, -0.5455307960510254, 0.2023162841796875, 1.2710380554199219, -1.118194580078125, 1.1058721542358398, 0.13643264770507812, -1.726663589477539, -9.654679298400879, 0.14749717712402344, -0.3169822692871094, -5.942249774932861, -0.6430652141571045, -0.5411138534545898, 0.8132834434509277, -1.0480890274047852, -1.1618175506591797, -0.4495062828063965, -0.7146072387695312, 0.7175664901733398, -0.6380720138549805, 0.0027599334716796875, -0.8272061347961426, 0.4196605682373047, 0.5465478897094727, 1.075124740600586, -0.5458803176879883, 0.6011345386505127, -0.33141016960144043, -1.5058717727661133, -0.08011627197265625, 1.3930339813232422, -0.8065671920776367, -0.08647346496582031, 0.20325613021850586, 1.5743446350097656, -5.784301280975342, 0.9015302658081055, -0.8702036142349243, -6.919099807739258, 1.5154037475585938, 0.9083365797996521, 0.07480239868164062, -0.7209987640380859, -0.22536468505859375, 0.35574984550476074, 0.20853805541992188, -0.9876432418823242, -1.3328269720077515, 0.27757930755615234, -0.5902953147888184, 0.24954509735107422, -0.04743194580078125, 0.41611385345458984, 1.2326745986938477, 0.09589004516601562, -0.08084249496459961, -1.2787666320800781, -0.6336026191711426, -0.36780548095703125, -0.7522296905517578, -0.5877895355224609, -6.572726249694824, -1.0895118713378906, -0.7044334411621094, 0.3756399154663086, -1.1356773376464844, -1.4364378452301025, -1.696847915649414, 0.09050941467285156, 2.1786155700683594, -7.562159538269043, 0.6554222106933594, 1.6398358345031738, 0.10599708557128906, -8.012350082397461, -0.874913215637207, -0.4514598846435547, -0.28165245056152344, -1.4414045810699463, -0.31480932235717773, 0.025747299194335938, 0.4975099563598633, -0.3299112319946289, 1.4278793334960938, 0.9980106353759766, 0.18554019927978516, 0.4723062515258789, 1.062070608139038, 0.7829313278198242, 0.7144908905029297, 0.2545299530029297, 0.9512176513671875, 0.4890003204345703, -1.4186286926269531, 0.07550859451293945, -0.3485431671142578, -0.6898193359375, 2.0537681579589844, -0.3813967704772949, -0.21298885345458984, 1.1623821258544922, 0.3289918899536133, -0.6080446243286133, -0.7710657119750977, 0.7143745422363281, -1.7702064514160156, -0.2958812713623047, 0.05214405059814453, 0.35173559188842773, -0.8085942268371582, 0.3625221252441406, 1.3123846054077148, -0.1442413330078125, -0.7907514572143555, -1.0561275482177734, -0.00920724868774414, 0.8628940582275391, -0.3975081443786621, -1.726923942565918, 0.08113682270050049, -0.5775966644287109, 1.019106149673462, -0.08165287971496582, 0.5192952156066895, 0.31941795349121094, -0.33089160919189453, 0.8965121507644653, 0.5652452707290649, -1.5029821395874023, -0.5775966644287109, -0.4173707962036133, 1.1115236282348633, -6.965046405792236, 0.8053239583969116, 0.646477460861206, 0.09664344787597656, 0.7146186828613281, 0.052379608154296875, 0.14709186553955078, 0.2088022232055664, 1.9980392456054688, 1.5841648578643799, 0.5533437728881836, 0.06016254425048828, -0.7078871726989746, -0.7522296905517578, -0.6149063110351562, -0.5161619186401367, 0.6006498336791992], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 163500, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 163500, "last_target_update_ts": 35840, "num_target_updates": 69}, "sampler_results": {"episode_reward_max": 26.641731038689613, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -131.05275517068804, "episode_len_mean": 281.53, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998], "episode_lengths": [354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5191093162019369, "mean_inference_ms": 23.381190941428923, "mean_action_processing_ms": 0.13457960602735025, "mean_env_wait_ms": 4.292403712300391, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 26.641731038689613, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -131.05275517068804, "episode_len_mean": 281.53, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-291.4704899266362, -295.98025480657816, -298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998], "episode_lengths": [354, 368, 356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5191093162019369, "mean_inference_ms": 23.381190941428923, "mean_action_processing_ms": 0.13457960602735025, "mean_env_wait_ms": 4.292403712300391, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 163500, "num_env_steps_sampled": 35840, "num_env_steps_trained": 163500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 35840, "agent_timesteps_total": 35840, "timers": {"training_iteration_time_ms": 336.644, "learn_time_ms": 64.762, "learn_throughput": 4632.381, "synch_weights_time_ms": 20.502}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 163500, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 163500, "last_target_update_ts": 35840, "num_target_updates": 69}, "done": false, "episodes_total": 120, "training_iteration": 35, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-27-32", "timestamp": 1655494052, "time_this_iter_s": 5.483856678009033, "time_total_s": 183.60346746444702, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 183.60346746444702, "timesteps_since_restore": 0, "iterations_since_restore": 35, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.125, "ram_util_percent": 62.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 9.071959495544434, "min_q": -15.541746139526367, "max_q": 30.404287338256836, "mean_td_error": -0.9040865302085876}, "td_error": [0.7155685424804688, -1.6680073738098145, -1.474592924118042, -0.0685110092163086, 0.05689430236816406, 2.68853759765625, 0.3973064422607422, -0.6446704864501953, 1.9163188934326172, -1.1426210403442383, -1.3937797546386719, -0.6895313262939453, -1.4569244384765625, -0.2760934829711914, -1.8773193359375, -0.24425792694091797, -1.6583943367004395, 0.5020980834960938, 0.3963613510131836, -0.04831886291503906, -1.0580272674560547, 0.29060161113739014, -1.221217155456543, -1.4420642852783203, -1.2292203903198242, -0.6605825424194336, -0.42711448669433594, -0.9735016822814941, -0.5190067291259766, -1.156233787536621, -1.2298617362976074, -0.22979354858398438, -0.31136322021484375, -0.25634765625, -1.248002529144287, -1.3104662895202637, -7.993316650390625, 0.3760232925415039, -0.20365476608276367, -3.2891368865966797, -1.5837373733520508, -1.8183355331420898, -0.9619951248168945, 0.07404422760009766, -0.1742926836013794, 0.15581512451171875, 0.4332132339477539, -1.2186331748962402, -0.41329556703567505, -1.327789306640625, 0.28901004791259766, -1.3119125366210938, -1.684235692024231, -0.576927661895752, -0.9959426522254944, -3.2518863677978516, -6.547779083251953, 0.6211838722229004, -0.3651113510131836, 0.8826313018798828, -0.5293946266174316, -1.972970962524414, -0.7534465789794922, -0.45276451110839844, -1.0803451538085938, -2.5903167724609375, -1.2392234802246094, 0.09895563125610352, -1.9261274337768555, -0.8687744140625, 0.11336994171142578, -0.4657707214355469, -0.3725461959838867, -1.025749921798706, -3.6001949310302734, 0.028221607208251953, -1.0239953994750977, -0.613947868347168, 0.06235504150390625, -7.586733818054199, -0.3274860382080078, -0.393890380859375, -0.16591453552246094, 0.055632591247558594, -0.7045421600341797, -0.3507721424102783, -0.6618709564208984, -7.517087459564209, -0.029819488525390625, -1.3836736679077148, 0.04866504669189453, -1.4374241828918457, -0.15011978149414062, -1.0560483932495117, -0.3805088996887207, 0.0063934326171875, 0.08778953552246094, -5.730240821838379, -5.510568618774414, 0.14115333557128906, -0.0748281478881836, -1.5879096984863281, -1.0983450412750244, -1.0748977661132812, -6.3347272872924805, 5.406834125518799, -0.36052513122558594, -1.3028907775878906, 0.06840038299560547, 10.337321281433105, 7.3505964279174805, -0.29099464416503906, -0.2589836120605469, -1.488210678100586, -0.8915500640869141, -1.6419925689697266, -0.2598991394042969, 1.014279842376709, -0.8850193023681641, -1.9608392715454102, -1.1519107818603516, 0.015618324279785156, -1.8982105255126953, -0.06863594055175781, -0.31136322021484375, -1.205406665802002, 0.017373085021972656, -0.7601323127746582, -0.7242412567138672, -4.207611083984375, 1.0861680507659912, -1.611504316329956, -1.5359468460083008, -1.135894775390625, -1.6443920135498047, -0.6580629944801331, -0.506342887878418, -0.8583245277404785, -0.15690231323242188, -1.3945121765136719, -6.376235008239746, -1.6341850757598877, -0.2026195526123047, -1.1271953582763672, 0.4159679412841797, -0.13239848613739014, -0.5579209327697754, -0.12258148193359375, -0.9201865196228027, 0.5494785308837891, -0.8039641380310059, -1.009629249572754, -0.2802395820617676, -0.05513191223144531, -0.127288818359375, -0.2433786392211914, -1.1141853332519531, -2.0260801315307617, 0.7003440856933594, -0.4388699531555176, -2.7359447479248047, -2.496126174926758, -0.6577162742614746, -1.2969970703125, -1.1677846908569336, -0.041265010833740234, -4.017761707305908, -0.9340858459472656, -2.3763275146484375, -0.3998394012451172, 0.0195770263671875, 1.111262559890747, 7.1502366065979, -7.752513885498047, -1.7968244552612305, 0.7087836265563965, 0.9592981338500977, -0.2579522132873535, -2.657949924468994, -0.5827999114990234, 0.4380931854248047, -0.22354507446289062, 0.19294452667236328, -1.8586788177490234, -1.8718230724334717, -1.3865201473236084, -9.77132797241211, -0.6464881896972656, -1.5450496673583984, -0.1898493766784668, -1.036123275756836, -0.4109477996826172, -0.9794254302978516, -6.155355453491211, -0.06177234649658203, -0.5468854904174805, -2.4254932403564453, 5.814294815063477, 0.3364744186401367, -6.550286293029785, 1.127838134765625, -1.2974185943603516, 1.0990314483642578, 0.7514762878417969, -1.2068977355957031, -0.4817543029785156, -0.07094192504882812, -0.12258148193359375, 0.25969409942626953, -1.265009880065918, -0.40065693855285645, -2.3905744552612305, -0.07584571838378906, -1.1972589492797852, -0.38916754722595215, -1.1115093231201172, -1.0675537586212158, -0.14057564735412598, -0.40748071670532227, 0.8421468734741211, -2.097860336303711, -1.4397335052490234, -0.082122802734375, -0.31110572814941406, -0.2540431022644043, -9.931567192077637, -0.9232325553894043, 0.20413804054260254, -3.122708559036255, 0.01089620590209961, -0.4517087936401367, -6.353025436401367, -0.33474206924438477, 1.6031415462493896, -0.8687744140625, -1.5618858337402344, -0.2856607437133789, 2.0592920780181885, -0.7924089431762695, -1.019953727722168, -3.0622730255126953, 1.313436508178711, 1.0080018043518066, -1.023730993270874, -6.464840888977051, -1.4415855407714844, -7.072795867919922, -0.5281305313110352, 0.3122730255126953, 2.2209930419921875, -1.6032915115356445, -1.3617382049560547, -0.8757009506225586, 0.2791166305541992, -0.10413169860839844, -1.5839042663574219, -1.8341313600540161, -0.7954506874084473, -0.6822636127471924, -0.8812980651855469, 0.4963111877441406, -1.4251054525375366, -0.3086814880371094, -0.8778815269470215, 0.04095649719238281, -0.738231897354126, -0.33845090866088867, -0.6041650772094727, -0.1598644256591797, -1.0675537586212158, -0.3412817716598511, -0.7114903926849365, -1.0569878816604614, -0.6002559661865234, -2.238931894302368, 0.6320590972900391, 0.44015979766845703, -0.6481647491455078, 1.9464874267578125, 0.536808967590332, -4.250046730041504, -0.2919120788574219, -6.933341979980469, -0.42694735527038574, 1.501451015472412, -1.009608268737793, -1.155806541442871, 0.9806561470031738, 0.005936652421951294, -0.6987972259521484, -0.7005996704101562, -1.149993896484375, -8.41970443725586, -1.4968223571777344, -0.2691779136657715, -0.7255239486694336, -1.1482582092285156, -0.34335994720458984, -0.7670307159423828, -0.474123477935791], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 168300, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 168300, "last_target_update_ts": 36864, "num_target_updates": 71}, "sampler_results": {"episode_reward_max": 26.641731038689613, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -126.20086308732628, "episode_len_mean": 279.32, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488], "episode_lengths": [356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5195820301720614, "mean_inference_ms": 23.421054245240484, "mean_action_processing_ms": 0.1343447411042756, "mean_env_wait_ms": 4.296275360445906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 26.641731038689613, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -126.20086308732628, "episode_len_mean": 279.32, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-298.1489288508892, -204.62786138802767, -237.99337070435286, -262.31771176308393, -255.11550346016884, -222.95893928408623, -308.9168232306838, -299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488], "episode_lengths": [356, 331, 327, 341, 341, 334, 349, 347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5195820301720614, "mean_inference_ms": 23.421054245240484, "mean_action_processing_ms": 0.1343447411042756, "mean_env_wait_ms": 4.296275360445906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 168300, "num_env_steps_sampled": 36864, "num_env_steps_trained": 168300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 36864, "agent_timesteps_total": 36864, "timers": {"training_iteration_time_ms": 343.522, "learn_time_ms": 66.449, "learn_throughput": 4514.707, "synch_weights_time_ms": 20.189}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 168300, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 168300, "last_target_update_ts": 36864, "num_target_updates": 71}, "done": false, "episodes_total": 122, "training_iteration": 36, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-27-37", "timestamp": 1655494057, "time_this_iter_s": 5.357545614242554, "time_total_s": 188.96101307868958, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 188.96101307868958, "timesteps_since_restore": 0, "iterations_since_restore": 36, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 33.1875, "ram_util_percent": 62.287499999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 9.222764015197754, "min_q": -19.176361083984375, "max_q": 29.832197189331055, "mean_td_error": -0.8274945616722107}, "td_error": [-6.570167541503906, 1.2038860321044922, -0.46228885650634766, 0.08196139335632324, 0.13234281539916992, 0.35948824882507324, -6.144741058349609, -0.3553290367126465, -0.40667057037353516, -0.9824442863464355, -1.1758346557617188, -1.25162672996521, -1.6649754047393799, -0.3035612106323242, -7.6441755294799805, -0.4138765335083008, -1.414876937866211, -0.965606689453125, -0.023514151573181152, -0.8355913162231445, -0.6925816535949707, 0.022579193115234375, 1.1217012405395508, 0.8704128265380859, -0.8514704704284668, -1.4314393997192383, -1.5979537963867188, -6.782714366912842, 0.049648284912109375, -0.2600478529930115, -0.4693000316619873, -0.7997279167175293, 0.4988594055175781, -2.0333633422851562, -0.8324594497680664, 0.820563793182373, -0.493438720703125, -1.4369258880615234, -2.605377197265625, -5.241748809814453, -1.217794418334961, -1.2321357727050781, -0.9629424810409546, -0.9380378723144531, -1.7202091217041016, -1.4162178039550781, 1.1419258117675781, -0.452272891998291, -2.5341663360595703, -0.31356096267700195, -1.8289146423339844, -1.0125732421875, 0.27825772762298584, -2.7874507904052734, -0.6283636093139648, -0.14872074127197266, -1.4832744598388672, -1.305166244506836, -7.614330291748047, 1.2424030303955078, 0.32069599628448486, 0.5354766845703125, -1.0125732421875, 0.8918876647949219, -0.20355701446533203, -0.09240531921386719, -0.15125513076782227, -0.5526895523071289, -0.034688472747802734, -1.1619071960449219, -6.523390769958496, 0.3179459571838379, -0.5466928482055664, 0.7260036468505859, 2.2822799682617188, 0.1358938217163086, -0.7349333763122559, -0.7116928100585938, 0.14538955688476562, -0.5990886688232422, -0.913776159286499, -0.061862945556640625, -0.23070907592773438, -0.13177990913391113, -0.8770370483398438, 1.1535816192626953, -0.7390356063842773, -0.4129056930541992, -0.7853512763977051, -1.5073604583740234, -0.49091053009033203, 0.9178605079650879, -0.007061004638671875, -0.5169639587402344, 0.9207172393798828, -6.527985572814941, -0.4227886199951172, -0.010982513427734375, 0.8918876647949219, -0.2102675437927246, -1.4162178039550781, -1.8039913177490234, -0.20142364501953125, -6.720216274261475, -8.134822845458984, -0.1298999786376953, -0.6938934326171875, -0.9972095489501953, -0.5954418182373047, -1.1655340194702148, -0.4944324493408203, 0.012743949890136719, -0.11668014526367188, -5.685214996337891, 0.7602119445800781, 1.9725313186645508, -10.984942436218262, -0.5056085586547852, -1.7832527160644531, 0.7521281242370605, 1.3457527160644531, -0.9654252529144287, 0.27448368072509766, -0.6581172943115234, -8.153220176696777, -1.1564083099365234, -0.4106435775756836, -0.3478260040283203, -1.2793045043945312, 0.31014251708984375, 0.9748802185058594, -0.31612491607666016, -0.2574758529663086, -1.337209701538086, -0.008915901184082031, -0.7183270454406738, -0.6528329849243164, 0.5138835906982422, -0.6612892150878906, 0.053783416748046875, -1.9192276000976562, -0.5029659271240234, 0.5233631134033203, -0.4801802635192871, -0.7941479682922363, 1.3313751220703125, -1.2051429748535156, -0.5332509279251099, -0.49693870544433594, 0.015974044799804688, -0.6654148101806641, -0.3804512023925781, -1.3850669860839844, 1.3071479797363281, -0.7188882827758789, -0.5754232406616211, -5.542269706726074, -0.9945755004882812, -0.7755589485168457, -0.890777587890625, -2.610978126525879, 0.7176175117492676, -0.6062124967575073, 0.014432907104492188, 0.11495494842529297, -1.8667278289794922, -0.00376129150390625, -0.7923660278320312, 0.9435396194458008, 0.17706060409545898, 1.039341926574707, -0.4204878807067871, 1.5081493854522705, -1.961557388305664, -0.8977162837982178, -0.7980422973632812, -1.6197471618652344, 0.18839359283447266, -0.47196006774902344, -0.6685962677001953, -0.8778924942016602, -0.1770532727241516, 0.23868870735168457, 0.04568004608154297, 0.17606592178344727, -0.727771520614624, -0.08246898651123047, -7.738153457641602, 0.10556888580322266, -2.478670120239258, 0.5749130249023438, 0.9178605079650879, -0.8147764205932617, -0.4801802635192871, -1.7528362274169922, -1.3820018768310547, -0.23010540008544922, 0.2274322509765625, -0.04669547080993652, -1.101670742034912, -1.0915555953979492, -0.8655309677124023, -0.3361968994140625, -0.7932577133178711, -1.58734130859375, 0.09143352508544922, 0.19313621520996094, -0.890777587890625, -1.183891773223877, 0.015499114990234375, 0.03568220138549805, -0.8717527389526367, 2.2442893981933594, 0.7046360969543457, -0.6088008880615234, -0.024552345275878906, -0.2584195137023926, -0.029763221740722656, -7.186006546020508, -0.4323291778564453, -1.0570878982543945, -0.20098876953125, -1.0274429321289062, -0.2957947254180908, -1.4281682968139648, -0.5109701156616211, 1.199345588684082, 0.2766385078430176, -0.7791671752929688, 0.44659423828125, -0.9200782775878906, 0.9162788391113281, 0.3229804039001465, 2.216289520263672, -0.7979798316955566, 1.3473224639892578, -1.3709516525268555, 0.08224678039550781, -0.6461677551269531, -1.3629456758499146, -0.3128080368041992, -0.9424214363098145, 1.617605209350586, 1.0032367706298828, -0.7041854858398438, -0.9098958969116211, 0.26085472106933594, 0.2871284484863281, -0.5785121917724609, -0.7421989440917969, -0.5140447616577148, 0.10181903839111328, -5.202550888061523, -0.5081272125244141, -0.6176643371582031, -6.8881378173828125, -0.27314090728759766, -1.5438590049743652, 0.27825772762298584, -2.4669418334960938, -0.05473816394805908, -1.0515289306640625, 0.9129257202148438, 2.0179691314697266, 0.15033531188964844, -1.148838996887207, -0.892033576965332, 2.341093063354492, -1.635019302368164, -1.5145635604858398, 7.046629428863525, -1.2359304428100586, -3.5046329498291016, -2.4121646881103516, 0.7916622161865234, -1.183891773223877, -0.7390356063842773, 0.3292694091796875, -0.6622467041015625, -6.857698440551758, -1.2599868774414062, -0.2960796356201172, 0.2851400375366211, -0.3723738193511963, -1.0146188735961914, 0.19835901260375977, -11.241277694702148, -0.7572531700134277, -0.3077664375305176, -0.06722784042358398, -1.5722386837005615, -0.2886080741882324, 0.42064380645751953, 0.16370391845703125, -0.029688715934753418, -0.029763221740722656, -2.3368492126464844, -0.1940174102783203, -2.633603572845459, 0.0391845703125], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 173100, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 173100, "last_target_update_ts": 37888, "num_target_updates": 73}, "sampler_results": {"episode_reward_max": 30.757340155541897, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -117.01642024181783, "episode_len_mean": 274.45, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724], "episode_lengths": [347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.52168289439527, "mean_inference_ms": 23.582824714417836, "mean_action_processing_ms": 0.13445351043282391, "mean_env_wait_ms": 4.2944661769693475, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 30.757340155541897, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -117.01642024181783, "episode_len_mean": 274.45, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-299.6634860560298, -347.96663934737444, -403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724], "episode_lengths": [347, 390, 396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.52168289439527, "mean_inference_ms": 23.582824714417836, "mean_action_processing_ms": 0.13445351043282391, "mean_env_wait_ms": 4.2944661769693475, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 173100, "num_env_steps_sampled": 37888, "num_env_steps_trained": 173100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 37888, "agent_timesteps_total": 37888, "timers": {"training_iteration_time_ms": 350.955, "learn_time_ms": 65.794, "learn_throughput": 4559.712, "synch_weights_time_ms": 20.089}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 173100, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 173100, "last_target_update_ts": 37888, "num_target_updates": 73}, "done": false, "episodes_total": 129, "training_iteration": 37, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-27-43", "timestamp": 1655494063, "time_this_iter_s": 5.678677558898926, "time_total_s": 194.6396906375885, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 194.6396906375885, "timesteps_since_restore": 0, "iterations_since_restore": 37, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 33.362500000000004, "ram_util_percent": 62.3625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 11.076964378356934, "min_q": -19.189828872680664, "max_q": 31.933914184570312, "mean_td_error": -0.09942443668842316}, "td_error": [-0.3516249656677246, -0.31385231018066406, 1.103144645690918, 0.9126887321472168, 1.3274774551391602, -6.5040130615234375, 1.2516899108886719, 1.5458874702453613, 0.17580747604370117, 1.6017265319824219, 2.735139846801758, 0.6140594482421875, -0.8165731430053711, -0.4076061248779297, 0.08358997106552124, 2.297708511352539, 0.5410842895507812, -0.51312255859375, -9.367365837097168, 0.5352621078491211, 1.3136463165283203, 1.5152912139892578, 1.103144645690918, -6.334602355957031, -4.531337738037109, 1.807779312133789, -1.6110649108886719, -4.635379791259766, -0.5449485778808594, 1.0899724960327148, 1.673264980316162, -0.34302330017089844, -1.1036863327026367, -0.6907558441162109, 1.2203197479248047, 0.7817678451538086, 0.87872314453125, -0.15341663360595703, -1.059347152709961, 2.316605567932129, 0.06711006164550781, -0.11188101768493652, 0.5396218299865723, 1.2660465240478516, -2.326770782470703, 0.21057510375976562, -0.17257118225097656, 1.8396968841552734, 0.7138080596923828, 0.08179330825805664, 0.48518943786621094, 0.5065593719482422, -0.7222800254821777, -0.25723695755004883, -9.923332214355469, -0.40534400939941406, 1.566115379333496, 0.7881693840026855, 0.9311676025390625, 0.9956855773925781, -1.0167522430419922, -0.0006406307220458984, -2.24863338470459, 1.3927180767059326, -0.1529216766357422, -0.5729086399078369, 1.1373634338378906, 0.4010000228881836, -0.22594451904296875, 0.16793274879455566, 0.8433132171630859, 1.409733772277832, 0.08791589736938477, -0.7300291061401367, 0.49585914611816406, -1.0887603759765625, 0.04413259029388428, 0.1992778778076172, -0.12482833862304688, 0.6059303283691406, 1.0905237197875977, -1.4132766723632812, 0.7830734252929688, 1.486917495727539, -0.44299840927124023, 1.196664810180664, 0.3961210250854492, 0.6606606841087341, 0.4170255661010742, -0.15115022659301758, -0.10738277435302734, -0.3583717346191406, -0.06917095184326172, -0.44588661193847656, -0.3541879653930664, 0.9168682098388672, 0.199418306350708, 0.118804931640625, 0.20743608474731445, 1.2835655212402344, 0.46500205993652344, 0.40782833099365234, -10.640565872192383, 2.047819137573242, 0.05741262435913086, -0.39183080196380615, 1.3891525268554688, 0.6131086349487305, -0.6260190010070801, 0.5548503398895264, -0.3612213134765625, 0.31157875061035156, -0.0057239532470703125, 2.179933547973633, -0.3014955520629883, 1.797001838684082, 0.4748973846435547, 0.2429947853088379, -0.4610878825187683, 0.6410751342773438, -0.8289680480957031, -5.874889373779297, 1.0288147926330566, -0.013593673706054688, -0.1304922103881836, 1.837244987487793, -1.1463079452514648, 0.213165283203125, 0.8363857269287109, 1.903818130493164, 0.09847450256347656, 1.1322088241577148, 0.5348808765411377, 1.7889370918273926, -0.505648136138916, -5.413812637329102, -2.285177230834961, 0.6609842777252197, -4.576254367828369, 15.265975952148438, -0.004094600677490234, 0.034236907958984375, 0.17807292938232422, -0.3787422180175781, 0.3811459541320801, -4.12047004699707, 1.7477684020996094, 0.25797224044799805, -0.2805824279785156, 0.5046749114990234, 2.9716849327087402, 0.7300834655761719, 1.6197280883789062, 0.37672901153564453, -0.7845945358276367, 0.1665172576904297, -0.3552265167236328, -0.36028194427490234, 0.10030746459960938, 0.5333118438720703, 0.6680150032043457, -0.49393653869628906, 0.30878639221191406, 0.05388832092285156, 2.22324800491333, 0.43216419219970703, 0.2156667709350586, 0.25797224044799805, 0.46056365966796875, 0.7239513397216797, -8.942885398864746, 0.1692943572998047, -1.0613837242126465, 1.0259051322937012, -1.234384536743164, -0.36757659912109375, -1.7253732681274414, 1.696685791015625, -1.0167522430419922, 0.20946311950683594, 0.8995742797851562, 1.1526594161987305, -0.38547754287719727, -0.8754215240478516, -6.57805061340332, 1.083024024963379, 1.5825557708740234, -1.2670612335205078, -3.297212600708008, -0.09656715393066406, 0.017548561096191406, -0.16831374168395996, 0.875422477722168, -1.57072114944458, 0.3955879211425781, 0.4010000228881836, -6.930458068847656, -0.03468644618988037, 0.2681770324707031, -0.6381149291992188, -0.29927825927734375, 1.607673168182373, 1.9162273406982422, 0.14420413970947266, -0.013593673706054688, 1.9905452728271484, -4.176427841186523, -0.610992431640625, -0.21739482879638672, 1.9016904830932617, -0.045340538024902344, -1.263178825378418, 0.3345050811767578, 0.14036941528320312, -0.9861583709716797, 0.7994937896728516, -0.599179744720459, 0.08725786209106445, -0.40692639350891113, 0.6924505233764648, 0.42697787284851074, 0.0009665489196777344, 0.26628589630126953, 0.31012916564941406, 0.45160698890686035, -0.5531463623046875, -0.8745460510253906, 0.049500226974487305, 0.5584542751312256, 1.0119476318359375, 9.901008605957031, 0.23009872436523438, 0.5539982318878174, 0.8034324645996094, 0.39116668701171875, -3.489185333251953, -1.390390396118164, 0.40258169174194336, 1.073408842086792, 0.31616926193237305, -0.21477270126342773, -0.2805824279785156, -0.10720396041870117, 2.162531852722168, -0.047138214111328125, 1.2549629211425781, 0.7016358375549316, -0.20197570323944092, -6.149104595184326, -0.3701763153076172, -0.1811661720275879, -0.13546466827392578, 1.403299331665039, 0.13695383071899414, -2.481008529663086, 1.4091930389404297, -0.3412933349609375, -0.09040260314941406, 0.746657133102417, 0.6057271957397461, 0.9055361747741699, -8.01253890991211, -1.923616886138916, -0.5888881683349609, 1.1090679168701172, 1.050741195678711, -0.8606472015380859, 0.16240277886390686, 3.1481027603149414, -0.05517864227294922, 0.5070781707763672, 0.27758216857910156, -0.7548775672912598, -0.700777530670166, 1.5689964294433594, 0.2419264316558838, 0.04107379913330078, -0.4928169250488281, 0.6883087158203125, 0.8363857269287109, 1.4444084167480469, -7.03205680847168, 0.4251899719238281, 1.538224220275879, 1.4125003814697266, 6.047945976257324, -10.640565872192383, -0.6326541900634766, -0.23308277130126953, -6.8387908935546875, -0.030734539031982422, -0.3890047073364258, 1.0960350036621094, 1.0805392265319824, -0.027553081512451172, -1.4624214172363281, -0.524205207824707, 1.056905746459961, 0.8986015319824219, 0.6483745574951172], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 177900, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 177900, "last_target_update_ts": 38912, "num_target_updates": 75}, "sampler_results": {"episode_reward_max": 30.757340155541897, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -110.1763550003618, "episode_len_mean": 271.35, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664], "episode_lengths": [396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5220850634349735, "mean_inference_ms": 23.62202903548293, "mean_action_processing_ms": 0.1342392502485359, "mean_env_wait_ms": 4.301666895645963, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 30.757340155541897, "episode_reward_min": -476.5026508048177, "episode_reward_mean": -110.1763550003618, "episode_len_mean": 271.35, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-403.0713306963444, -203.16212536394596, -197.89718276262283, -236.04085521399975, -215.14250279963017, -285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664], "episode_lengths": [396, 312, 333, 332, 341, 351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5220850634349735, "mean_inference_ms": 23.62202903548293, "mean_action_processing_ms": 0.1342392502485359, "mean_env_wait_ms": 4.301666895645963, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 177900, "num_env_steps_sampled": 38912, "num_env_steps_trained": 177900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 38912, "agent_timesteps_total": 38912, "timers": {"training_iteration_time_ms": 328.594, "learn_time_ms": 65.522, "learn_throughput": 4578.605, "synch_weights_time_ms": 20.988}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 177900, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 177900, "last_target_update_ts": 38912, "num_target_updates": 75}, "done": false, "episodes_total": 131, "training_iteration": 38, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-27-49", "timestamp": 1655494069, "time_this_iter_s": 5.253999471664429, "time_total_s": 199.89369010925293, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 199.89369010925293, "timesteps_since_restore": 0, "iterations_since_restore": 38, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.185714285714287, "ram_util_percent": 62.557142857142864}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 10.933775901794434, "min_q": -20.89911651611328, "max_q": 31.621353149414062, "mean_td_error": 0.045670345425605774}, "td_error": [-0.7261254787445068, 2.037020683288574, -9.918212890625e-05, 0.017189979553222656, -0.7836246490478516, 0.12801742553710938, -0.5662689208984375, 2.453521251678467, -1.9871482849121094, 1.2309017181396484, 0.8320550918579102, -1.6102428436279297, 0.36899805068969727, 0.24129009246826172, -0.5899324417114258, 0.5626544952392578, -0.9525997638702393, 0.033618927001953125, 0.9987583160400391, 0.5917072296142578, 0.8039689064025879, -0.05122089385986328, 0.6203861236572266, 1.8901863098144531, -0.4627065658569336, 0.6757864952087402, -4.498147487640381, -5.856288909912109, -0.1693124771118164, 0.6680374145507812, -0.30266427993774414, 1.3697242736816406, -0.212799072265625, -0.1182703971862793, -1.1319003105163574, 0.1331634521484375, -0.043023109436035156, 1.0124778747558594, -3.5829524993896484, -0.9087305068969727, 1.2157087326049805, -1.3674405813217163, -0.5568552017211914, -0.10062122344970703, -0.12444067001342773, -0.09792375564575195, 0.12113666534423828, 1.054957389831543, 6.26876163482666, 0.05781745910644531, -0.22117328643798828, 0.030210018157958984, -8.637994766235352, 0.10158634185791016, -2.6199257373809814, 0.5041732788085938, 2.78579044342041, 0.9143867492675781, 1.8120174407958984, -0.11575698852539062, 2.0323410034179688, -0.5723896026611328, -0.26058483123779297, -1.6113885641098022, 6.3885498046875, -0.8638124465942383, 0.8470726013183594, 1.03985595703125, 0.29302406311035156, -0.8363242149353027, 0.16346359252929688, -0.6805877685546875, 1.1057300567626953, -0.40229082107543945, 1.1050033569335938, -0.6928520202636719, -4.907562255859375, 0.414459228515625, 0.3848583698272705, 1.662466049194336, -0.3289966583251953, -3.946561813354492, -0.1967911720275879, 0.3742222785949707, -0.16620707511901855, 0.08327913284301758, 1.2095422744750977, 5.370969772338867, 1.7925357818603516, 4.777674674987793, -0.41529273986816406, 1.5219306945800781, 1.0981636047363281, -0.0011701583862304688, 1.02540922164917, -1.0075817108154297, 0.0007228851318359375, -0.2701854705810547, 1.014369010925293, 0.057576656341552734, 0.6211004257202148, -0.42918968200683594, -0.7226581573486328, 0.3848583698272705, 0.21447372436523438, -1.1342945098876953, -0.1624584197998047, 0.21447372436523438, 2.3953380584716797, 0.7919158935546875, -0.30371761322021484, 0.9101095199584961, 0.5633783340454102, 0.16464662551879883, 1.2639644145965576, 10.241881370544434, 2.207500457763672, 0.10404300689697266, 0.4311603307723999, 0.2626352310180664, 0.22791290283203125, 1.4890174865722656, -0.33597660064697266, -1.605093002319336, 0.8908710479736328, -0.8145565986633301, 0.9539518356323242, 1.4910945892333984, -0.6433384418487549, -4.604652404785156, 0.4904146194458008, 1.439967155456543, -0.545100212097168, -0.595583438873291, -0.41216087341308594, 0.187591552734375, -0.5107269287109375, 0.5468044281005859, -0.03714752197265625, 0.4049806594848633, 0.5145187377929688, -4.48654842376709, 0.24485206604003906, 0.1448965072631836, 1.0720834732055664, 0.32270050048828125, 0.44652652740478516, 0.4025993347167969, -0.2429828643798828, -0.31219482421875, 0.5761852264404297, 0.04759025573730469, -4.87025260925293, 0.9410337209701538, -0.18991851806640625, 0.4798412322998047, -0.7251071929931641, 0.7121238708496094, -0.96722412109375, 0.5609632730484009, -0.5235099792480469, 0.07061576843261719, 0.8771800994873047, 0.41368675231933594, -0.23076248168945312, 0.8782224655151367, 0.2683391571044922, 0.8039689064025879, -2.1221885681152344, 8.113983154296875, -0.3723493814468384, 0.822420597076416, 0.8293936252593994, -1.4619183540344238, 0.7152912616729736, 0.5709686279296875, -1.6680011749267578, 0.11691856384277344, 1.4129724502563477, -0.3196980357170105, -0.5543842315673828, -0.28072357177734375, 1.3159637451171875, 0.9410337209701538, -0.9860048294067383, -2.107686996459961, -2.2806243896484375, -0.37587177753448486, 0.007513999938964844, 0.5535793304443359, -0.8860092163085938, 0.4189167022705078, 0.9143867492675781, -5.377330780029297, -0.026525497436523438, 1.1581625938415527, -0.5941915512084961, 0.16220474243164062, 0.8293933868408203, 0.2436237335205078, 1.0149283409118652, -0.20624065399169922, 0.6246433258056641, 0.7802509069442749, 1.5188438892364502, 0.6211004257202148, -0.5468935966491699, -0.2852570414543152, 0.6211004257202148, -0.1632852554321289, -4.864870071411133, 0.01425933837890625, 0.5613288879394531, 0.34461677074432373, -0.7154960632324219, 0.4912252426147461, 0.33539366722106934, 0.053429603576660156, -1.930394172668457, 0.20644569396972656, 0.24892044067382812, -0.08545112609863281, -0.22106194496154785, -0.4254641532897949, -1.9608230590820312, 1.4949822425842285, 0.5613288879394531, 1.6530113220214844, 0.29115962982177734, -6.3257646560668945, 2.291666030883789, -0.08169364929199219, 2.459653854370117, 0.629436731338501, -0.4146620035171509, -0.11632537841796875, -0.6040802001953125, 0.115234375, 11.196425437927246, 0.4865303039550781, -0.10153388977050781, -1.1504769325256348, -4.946025848388672, 0.0044803619384765625, -0.7578926086425781, 0.778139591217041, -6.204448699951172, -0.41553306579589844, 0.4902172088623047, -10.203546524047852, 0.5173859596252441, 0.930506706237793, -0.14130592346191406, 0.07857894897460938, -0.07950305938720703, 0.09832465648651123, -1.2582049369812012, 0.24747896194458008, -1.6109046936035156, 1.178574800491333, -0.0477750301361084, -0.7726573944091797, -0.3423160910606384, 0.5684061050415039, -0.04649066925048828, -0.8476476669311523, 0.49824953079223633, -0.1528792381286621, -0.45360231399536133, 0.5267019271850586, -0.22922611236572266, -1.1932587623596191, 1.0654296875, 0.6306381225585938, 1.230508804321289, -11.070938110351562, 0.9215269088745117, 9.840301513671875, 0.05713367462158203, 0.12536239624023438, 0.6179385185241699, -1.6341533660888672, 0.059576988220214844, -0.04580879211425781, 0.48535776138305664, 0.1448965072631836, 1.7956428527832031, -0.44653892517089844, 0.5467033386230469, -0.3640422821044922, 0.2404419183731079, 0.38114213943481445, 0.39690399169921875, -0.4023323059082031, -0.2091519832611084, 0.3510096073150635, 0.25223588943481445, 0.006557464599609375, 0.2121715545654297, 1.1600871086120605], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 182700, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 182700, "last_target_update_ts": 39936, "num_target_updates": 77}, "sampler_results": {"episode_reward_max": 30.757340155541897, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -108.77463838987052, "episode_len_mean": 269.12, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572], "episode_lengths": [351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5227949010355799, "mean_inference_ms": 23.67323870871875, "mean_action_processing_ms": 0.13389560038313017, "mean_env_wait_ms": 4.304945912223375, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 30.757340155541897, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -108.77463838987052, "episode_len_mean": 269.12, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-285.07842034846544, -465.52141908556223, -165.6207566484809, -145.7561755478382, -147.5729676783085, -238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572], "episode_lengths": [351, 402, 324, 302, 311, 336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5227949010355799, "mean_inference_ms": 23.67323870871875, "mean_action_processing_ms": 0.13389560038313017, "mean_env_wait_ms": 4.304945912223375, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 182700, "num_env_steps_sampled": 39936, "num_env_steps_trained": 182700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 39936, "agent_timesteps_total": 39936, "timers": {"training_iteration_time_ms": 338.137, "learn_time_ms": 65.614, "learn_throughput": 4572.164, "synch_weights_time_ms": 20.44}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 182700, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 182700, "last_target_update_ts": 39936, "num_target_updates": 77}, "done": false, "episodes_total": 136, "training_iteration": 39, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-27-54", "timestamp": 1655494074, "time_this_iter_s": 5.50848650932312, "time_total_s": 205.40217661857605, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 205.40217661857605, "timesteps_since_restore": 0, "iterations_since_restore": 39, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.8875, "ram_util_percent": 62.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 9.971334457397461, "min_q": -21.062152862548828, "max_q": 36.04667663574219, "mean_td_error": -0.3992440104484558}, "td_error": [-0.5449275970458984, 0.47747230529785156, -0.5444087982177734, 0.17289161682128906, -0.8575100898742676, -0.9962196350097656, 0.12825679779052734, -4.856127738952637, -0.026926040649414062, -0.9675178527832031, 0.42128825187683105, -1.5470085144042969, -0.8612513542175293, -0.008943557739257812, -4.460338115692139, -0.057410240173339844, 0.7640247344970703, 0.13312053680419922, -0.6281852722167969, 0.7361650466918945, -1.6055984497070312, 0.6208095550537109, 0.08971786499023438, 0.19144630432128906, -0.02095508575439453, -1.5047931671142578, 0.6694583892822266, -0.5877523422241211, -0.23346328735351562, -0.08680343627929688, -0.5462703704833984, -7.930210113525391, -0.043609619140625, -0.3420001268386841, -6.468048095703125, 0.12461590766906738, -0.12265443801879883, -0.0625162124633789, -6.747156143188477, -1.0167064666748047, -0.07908964157104492, -0.34270477294921875, -0.31494808197021484, 0.385458767414093, -1.0243754386901855, 0.7933158874511719, -6.254297256469727, -0.6345653533935547, 0.49460411071777344, 0.5449498891830444, 1.5127813816070557, 0.4621715545654297, 1.874856948852539, -1.0888671875, 0.2579822540283203, 0.7634429931640625, -0.12414193153381348, -0.2639904022216797, -13.193452835083008, -1.920680046081543, -0.3351290225982666, 0.25484681129455566, -0.8785886764526367, -0.48941612243652344, -0.7737159729003906, 1.0443792343139648, 0.1559896469116211, 0.8627281188964844, -0.25411128997802734, 0.9894657135009766, -0.2639646530151367, 1.426501989364624, 0.16117477416992188, 8.96623420715332, 0.5065641403198242, -0.7221565246582031, -0.1591191291809082, -0.5745315551757812, -0.3421519994735718, -0.4700508117675781, 0.7878742218017578, -0.8670060634613037, -0.250571608543396, -0.31735992431640625, 0.2163710594177246, -0.23882293701171875, -6.084768295288086, -1.4383659362792969, -0.9983034133911133, -0.9404001235961914, -1.166891098022461, 0.39586758613586426, 1.2489345073699951, 0.8639755249023438, 0.7933158874511719, -1.4131994247436523, 0.7976455688476562, 0.04266834259033203, -0.10442829132080078, -0.16839289665222168, -0.4944267272949219, 1.9504146575927734, -0.052959442138671875, 1.317373275756836, -0.2700098752975464, -0.8271055221557617, 0.4654388427734375, 0.09953737258911133, 0.4904317855834961, -0.15718460083007812, -0.22210311889648438, 3.032796859741211, 0.7608909606933594, 0.8308687210083008, 0.5608634948730469, -0.9173793792724609, 0.47440052032470703, 0.0014764070510864258, -0.08836126327514648, -0.14569377899169922, -0.8483428955078125, 0.33646297454833984, 0.25718116760253906, 0.037532806396484375, -0.04764366149902344, -1.5457768440246582, 0.4108085632324219, 1.4605159759521484, 10.637763023376465, -1.07525634765625, -0.02627849578857422, -0.0954437255859375, 0.7933158874511719, -0.11246681213378906, 0.2538161277770996, 0.26445937156677246, 0.8278141021728516, 0.5887794494628906, -0.419314980506897, -0.6345653533935547, -0.8264217376708984, 0.8991103172302246, -0.0850529670715332, -0.10451889038085938, -0.19224834442138672, -8.70794677734375, -4.143927574157715, -0.600064754486084, -0.16133713722229004, -1.974137544631958, -0.6078481674194336, -10.858283996582031, -1.9375, -5.330427169799805, -0.024725675582885742, -0.21854090690612793, -0.4248390197753906, 0.9297974109649658, -1.253373146057129, -0.5466179847717285, -0.8583078384399414, -7.27968692779541, -0.047371864318847656, -0.4712181091308594, -0.398284912109375, -0.5896892547607422, -1.1102581024169922, 0.5676064491271973, -0.2289257049560547, 0.9178338050842285, -0.8111691474914551, 0.8947105407714844, 0.026134490966796875, -0.7675380706787109, -0.19671779870986938, 0.017469406127929688, 0.4814324378967285, -0.16869544982910156, 0.051105499267578125, -0.7558218240737915, -0.600064754486084, -0.31598496437072754, -0.4302835464477539, 0.9280672073364258, 0.4904317855834961, -0.08505535125732422, -0.8028609752655029, -0.31717491149902344, 0.2034156322479248, -0.30718040466308594, 0.16417217254638672, 1.0066261291503906, 0.22213125228881836, 0.4408707618713379, 0.2997293472290039, 0.6033210754394531, -0.5257868766784668, -0.2752571105957031, 0.47747230529785156, -0.8449640274047852, -0.3466916084289551, -0.025094985961914062, -0.25042104721069336, -0.08892345428466797, 0.10607337951660156, -0.29622316360473633, 0.22782295942306519, 0.6892633438110352, 0.17201995849609375, -6.527026176452637, -0.22217369079589844, 0.38244056701660156, -1.2401199340820312, 0.10921621322631836, -0.3504905700683594, 0.09694862365722656, -0.23151588439941406, 0.2977132797241211, -0.1780691146850586, -0.37467193603515625, 1.5496139526367188, -1.1222095489501953, -0.5611352920532227, 0.6256470680236816, -0.2682504653930664, -1.048044204711914, -6.309333324432373, -0.35782647132873535, -0.09603500366210938, 0.4254641532897949, 0.14064598083496094, -0.47261905670166016, 4.097433090209961, 0.33310508728027344, 2.0731496810913086, -0.8255035877227783, 0.3507709503173828, 0.33132457733154297, -0.42641115188598633, -0.7884292602539062, -6.468048095703125, -0.764979362487793, 0.042992591857910156, 0.6453781127929688, -0.41739654541015625, -0.6126375198364258, -0.2248072624206543, -0.7514915466308594, -0.9187941551208496, 0.9414129257202148, 0.33361244201660156, -0.1454906463623047, 0.1377277374267578, -0.1564769744873047, 0.6915836334228516, -0.004302024841308594, -0.5639599561691284, 0.7697410583496094, 0.19144630432128906, 0.3413209915161133, 1.4446382522583008, 0.421262264251709, 0.9429950714111328, 2.2213311195373535, -2.0127172470092773, 0.36674314737319946, 0.172607421875, 0.2676076889038086, -1.1716423034667969, 0.8033761978149414, -1.3837032318115234, -1.0833699703216553, -2.7779548168182373, 0.10199737548828125, 3.4208765029907227, -0.697789192199707, 0.11936378479003906, -0.5814628601074219, 0.6296839714050293, 0.7774848937988281, 0.15921735763549805, -1.1420106887817383, -2.090421676635742, -0.24164581298828125, 0.3804149627685547, -0.9006617069244385, -0.326265811920166, -0.42010974884033203, -1.1319745779037476, -0.846776008605957, -0.9763307571411133, 0.45241880416870117, 0.48433685302734375, 1.0715150833129883, -10.26729679107666, -0.5169639587402344, -1.7314701080322266, -0.46793556213378906, -0.09483051300048828, -0.08944988250732422], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 187500, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 187500, "last_target_update_ts": 40960, "num_target_updates": 79}, "sampler_results": {"episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -96.18439423084259, "episode_len_mean": 263.24, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117], "episode_lengths": [336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.525668912155952, "mean_inference_ms": 23.73485554212469, "mean_action_processing_ms": 0.13401426252749024, "mean_env_wait_ms": 4.310448490507676, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -96.18439423084259, "episode_len_mean": 263.24, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-238.0413929745555, -318.00161066651344, -314.8811574727297, -382.10798933357, -476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117], "episode_lengths": [336, 358, 362, 387, 414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.525668912155952, "mean_inference_ms": 23.73485554212469, "mean_action_processing_ms": 0.13401426252749024, "mean_env_wait_ms": 4.310448490507676, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 187500, "num_env_steps_sampled": 40960, "num_env_steps_trained": 187500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 40960, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 350.083, "learn_time_ms": 65.706, "learn_throughput": 4565.795, "synch_weights_time_ms": 20.501}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 187500, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 187500, "last_target_update_ts": 40960, "num_target_updates": 79}, "done": false, "episodes_total": 141, "training_iteration": 40, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-28-00", "timestamp": 1655494080, "time_this_iter_s": 5.560988426208496, "time_total_s": 210.96316504478455, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 210.96316504478455, "timesteps_since_restore": 0, "iterations_since_restore": 40, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.425, "ram_util_percent": 62.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 10.033539772033691, "min_q": -21.20944595336914, "max_q": 35.50077819824219, "mean_td_error": -0.6548779010772705}, "td_error": [-0.9431142807006836, -1.1114752292633057, -2.0945940017700195, -1.347104549407959, -0.6982583999633789, 0.9638996124267578, 0.7424182891845703, -1.1313810348510742, -0.5722253322601318, -1.0171079635620117, -0.8155937194824219, -0.11204814910888672, -0.8290891647338867, -0.21693968772888184, 0.03575897216796875, 0.22809219360351562, 0.02875041961669922, 2.5299806594848633, -6.834766387939453, 0.3302335739135742, 0.33127403259277344, -0.27787208557128906, 0.8425216674804688, 0.25053977966308594, -0.8784446716308594, 0.4860525131225586, 0.94561767578125, 2.0858654975891113, -0.39023876190185547, -1.2655963897705078, 1.5593318939208984, 0.16565227508544922, 0.2622489929199219, -0.014766693115234375, 0.21928256750106812, -2.47772216796875, -0.04486274719238281, -0.054549217224121094, 0.37362098693847656, -1.8545112609863281, -1.8420915603637695, -1.8240485191345215, -5.096790313720703, -0.1291027069091797, -1.4232816696166992, -0.400421142578125, -6.141376495361328, 0.29674625396728516, 0.543060302734375, -1.2864933013916016, 0.31542205810546875, -0.25795042514801025, -0.3639190196990967, 0.9638996124267578, -0.22515583038330078, 1.511709213256836, -0.14096832275390625, -0.17941045761108398, -0.07741165161132812, -0.7857394218444824, -2.219850540161133, 0.5475196838378906, -8.299614906311035, 0.4414529800415039, -1.1684465408325195, 0.48585450649261475, -0.08374357223510742, -0.8611841201782227, -1.9572358131408691, -6.536350250244141, -0.6382503509521484, -2.503854751586914, -0.7267398834228516, 0.07084369659423828, 0.4783611297607422, -3.2970571517944336, 0.7927780151367188, -0.8756818771362305, -0.8027896881103516, -0.26113319396972656, 0.8903598785400391, 0.0060901641845703125, 0.38589179515838623, 0.11534404754638672, 0.04387092590332031, -0.9976019859313965, 0.1121673583984375, -1.1979866027832031, -1.6469707489013672, 0.6364307403564453, -0.5947725772857666, -0.4080061912536621, -1.0655590295791626, -0.7625875473022461, -1.376896858215332, -1.4304313659667969, 1.5593318939208984, -0.5376949310302734, -0.09157133102416992, -0.44931697845458984, -1.1907615661621094, -1.2655205726623535, -0.6363601684570312, -0.2523207664489746, -0.0906977653503418, 0.47300243377685547, -0.4127645492553711, -0.712864875793457, 0.4792327880859375, -0.2311553955078125, -0.4411144256591797, 0.1590261459350586, -0.05390334129333496, -0.8900012969970703, -1.2212426662445068, 0.9958419799804688, -0.07188129425048828, 0.896355152130127, -0.01168966293334961, -0.04878711700439453, -1.2085776329040527, -1.3729610443115234, -0.1791973114013672, -4.8378400802612305, -0.5567493438720703, -5.090568542480469, -0.038628578186035156, -0.6130924224853516, -0.8353242874145508, -0.1912994384765625, -1.1907615661621094, 2.335233688354492, -0.07250022888183594, -0.4099769592285156, -0.4014396667480469, 9.226452827453613, 0.241668701171875, -0.47006702423095703, 0.24602174758911133, -0.4671473503112793, 0.8584194183349609, -1.6320648193359375, -6.937685489654541, -0.5709695816040039, 0.21503019332885742, 0.5934748649597168, -5.934675216674805, -0.437599241733551, 0.1298532485961914, -1.7313728332519531, -0.6015583276748657, 0.8575229644775391, 0.15248489379882812, 2.068693161010742, -0.9426326751708984, 1.1128287315368652, -6.520599365234375, 0.3782329559326172, 1.0146713256835938, -0.4312434196472168, -0.6794376373291016, -1.2343978881835938, -0.5606727600097656, 3.0024805068969727, -0.6045751571655273, 0.7508082389831543, -8.583962440490723, -0.9727344512939453, -1.461350917816162, -2.585911989212036, 0.6129093170166016, -7.016669273376465, 0.049834251403808594, 0.4144935607910156, -0.3954925537109375, -0.3959784507751465, -5.936433792114258, 1.8712873458862305, -1.2171859741210938, -1.1907615661621094, 0.015443772077560425, -0.031963348388671875, 0.7057228088378906, -0.46532297134399414, -0.5478037595748901, 1.1820621490478516, -1.1389293670654297, 1.356252670288086, -2.0102157592773438, -0.4191093444824219, -0.5663566589355469, -0.017246246337890625, -0.8611841201782227, 0.10318499803543091, 0.06398200988769531, 1.0150947570800781, 0.09068179130554199, -1.3385009765625, -1.6990785598754883, -0.531853199005127, -6.233390808105469, -0.3054389953613281, -0.6329755783081055, -0.29814815521240234, 0.029231548309326172, 0.019598007202148438, 0.0377650260925293, -0.29413747787475586, 3.0024805068969727, -0.7427806854248047, -0.6341195106506348, 0.7267014980316162, 0.9785051345825195, 0.3412742614746094, -0.6942052841186523, -0.8109617233276367, 0.7249507904052734, -1.925626516342163, 0.03624534606933594, -1.299675464630127, -0.27787208557128906, 0.4989614486694336, -0.9478626251220703, -0.7735509872436523, -1.3145108222961426, -0.014530181884765625, 0.5490741729736328, -0.2641468048095703, -0.36943483352661133, -0.30670928955078125, -1.8360862731933594, -0.060962677001953125, -0.15162181854248047, 0.9222869873046875, -0.7861170768737793, -0.10817313194274902, -0.6341195106506348, -9.863972663879395, -7.092071533203125, -1.909698486328125, -0.14998340606689453, -0.14865493774414062, -0.7388460636138916, -0.07103633880615234, -0.4219536781311035, -1.202852725982666, -0.0997467041015625, -0.08461475372314453, -0.790771484375, 0.604773759841919, -0.4455604553222656, 8.850759506225586, 0.30556297302246094, -1.3515090942382812, -0.6140174865722656, 0.3170175552368164, -1.6049203872680664, -1.2539210319519043, -0.33998966217041016, -0.1253509521484375, -1.4574871063232422, -0.6821517944335938, -7.646002292633057, 0.029231548309326172, 2.1804771423339844, 0.5387539863586426, -3.882558822631836, -1.040506362915039, 0.543060302734375, -0.5776834487915039, -0.3954925537109375, -2.4274415969848633, -0.8263987302780151, -0.8800077438354492, 1.1041955947875977, 0.3069915771484375, -0.8714332580566406, 1.0967073440551758, -2.085725784301758, -0.5710868835449219, -0.9455327987670898, -0.8146495819091797, -5.936433792114258, -0.27506017684936523, 0.45726776123046875, 0.017303466796875, 1.281733512878418, -0.05762624740600586, 0.7108631134033203, -0.05554533004760742, -0.14952850341796875, 0.6215038299560547, -0.48394060134887695, -0.5419564247131348, -2.015596389770508, -1.2537345886230469, 0.17255544662475586, -0.7711563110351562, -1.8453086614608765, -11.580608367919922], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 192300, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 192300, "last_target_update_ts": 41984, "num_target_updates": 81}, "sampler_results": {"episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -86.36819000795484, "episode_len_mean": 259.09, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746], "episode_lengths": [414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268193492597747, "mean_inference_ms": 23.802189232804572, "mean_action_processing_ms": 0.13429841958975772, "mean_env_wait_ms": 4.310189710720478, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -86.36819000795484, "episode_len_mean": 259.09, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-476.5026508048177, -140.10474240779877, -397.6149564385414, 14.056627839803696, -18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746], "episode_lengths": [414, 315, 372, 193, 244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268193492597747, "mean_inference_ms": 23.802189232804572, "mean_action_processing_ms": 0.13429841958975772, "mean_env_wait_ms": 4.310189710720478, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 192300, "num_env_steps_sampled": 41984, "num_env_steps_trained": 192300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 41984, "agent_timesteps_total": 41984, "timers": {"training_iteration_time_ms": 344.792, "learn_time_ms": 66.686, "learn_throughput": 4498.712, "synch_weights_time_ms": 21.532}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 192300, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 192300, "last_target_update_ts": 41984, "num_target_updates": 81}, "done": false, "episodes_total": 145, "training_iteration": 41, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-28-06", "timestamp": 1655494086, "time_this_iter_s": 5.419991493225098, "time_total_s": 216.38315653800964, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 216.38315653800964, "timesteps_since_restore": 0, "iterations_since_restore": 41, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 34.662499999999994, "ram_util_percent": 62.9625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 11.419716835021973, "min_q": -22.11825180053711, "max_q": 37.15828323364258, "mean_td_error": -0.3631807565689087}, "td_error": [-0.5526895523071289, 0.5210094451904297, -4.799979209899902, 0.13384437561035156, -2.06677508354187, 0.16106700897216797, -7.608473300933838, 0.00595855712890625, -6.780153274536133, -0.4027395248413086, 1.424799919128418, -0.13415145874023438, 0.1097869873046875, -0.7241191864013672, 0.41464853286743164, -0.9379005432128906, -0.7092838287353516, 0.5762176513671875, -1.8680915832519531, -0.33195245265960693, 0.5847005844116211, -0.02210235595703125, -0.4683094024658203, 0.13303184509277344, 1.1830081939697266, -5.398141860961914, -0.28693294525146484, -11.136878967285156, -0.27400684356689453, 0.1751236915588379, 0.45763349533081055, -0.3945045471191406, 0.9169554710388184, 7.424333572387695, 0.1651449203491211, -1.0692214965820312, -0.11918973922729492, -0.9288654327392578, 1.1619644165039062, -1.5980291366577148, 0.17535781860351562, -6.119007110595703, -0.48462486267089844, -5.118446350097656, 0.8132305145263672, -0.11758160591125488, -9.575172424316406, 0.09757399559020996, 0.27039337158203125, -8.555500030517578, 1.1929211616516113, 0.6741571426391602, 1.3794050216674805, -1.6716585159301758, -1.4800729751586914, -4.717531204223633, -0.7073221206665039, -0.41284942626953125, -4.854602813720703, -0.6797409057617188, -0.3813438415527344, 1.9398555755615234, -6.998151779174805, -0.1550445556640625, -0.9881744384765625, -0.24250364303588867, 0.18044281005859375, 1.104863166809082, 0.059356689453125, -0.35023021697998047, 0.36264610290527344, 0.3935050964355469, -3.7085695266723633, 1.8337039947509766, 0.09612035751342773, -1.9468622207641602, 0.10862350463867188, -0.30204296112060547, 0.01909637451171875, -0.6001863479614258, -0.6430467367172241, 1.9461555480957031, -2.2677688598632812, -6.2851409912109375, -1.1701412200927734, -0.3688793182373047, -2.152261734008789, -0.1403369903564453, 1.2921562194824219, -1.3687199354171753, 0.1706380844116211, 0.22820663452148438, 0.097320556640625, 0.3797645568847656, 0.7585535049438477, -0.3375434875488281, 0.37018251419067383, -0.15462636947631836, -0.14353704452514648, -4.572904586791992, -0.2804679870605469, 0.24408817291259766, -0.7679777145385742, -0.15462636947631836, 0.9417972564697266, -9.578173637390137, -0.10672950744628906, -0.1759958267211914, 0.6401510238647461, 0.289703369140625, -0.7878849506378174, -0.6531217098236084, 0.16106700897216797, 0.5773377418518066, -0.30473995208740234, 2.2238779067993164, -0.7737307548522949, -0.6967124938964844, 0.16106700897216797, 0.48266029357910156, 0.6838340759277344, -0.4544715881347656, 0.15559685230255127, 3.9360525608062744, 0.1193084716796875, -0.03416252136230469, 0.5146417617797852, -1.6950397491455078, -0.5536527633666992, 0.6758456230163574, 0.2346477508544922, 0.23888206481933594, 0.7482147216796875, 0.9733028411865234, -0.2841606140136719, 1.312856674194336, 0.5572881698608398, 0.4006080627441406, -0.42024803161621094, -0.4147205352783203, 0.14341354370117188, 0.004362344741821289, 0.5597286224365234, 1.3019638061523438, 1.713247299194336, 0.1836223602294922, 0.45763349533081055, -0.20692062377929688, 0.7041759490966797, -0.3980598449707031, -0.2798786163330078, -0.5966553688049316, -1.197291374206543, 7.413559913635254, 0.45785045623779297, -0.2129836082458496, -0.6348600387573242, -2.3158397674560547, 0.376190185546875, 0.04343414306640625, 0.025063514709472656, 0.34842443466186523, 0.3271656036376953, -0.8997688293457031, 0.17143869400024414, -9.548314094543457, 0.097320556640625, 0.1381521224975586, 1.0269842147827148, 0.18491649627685547, -5.398805618286133, -0.7866239547729492, 0.1874651312828064, 0.7449378967285156, -0.016603708267211914, -0.2725486755371094, -0.32176780700683594, 0.6147708892822266, -2.869023323059082, 0.5947389602661133, -0.1288677453994751, 1.8775196075439453, 0.5756053924560547, -4.516442775726318, -0.28778576850891113, 0.2026844024658203, -0.17238235473632812, 0.46953582763671875, -0.1436634063720703, -1.497568130493164, -0.6039116382598877, -0.24195480346679688, -1.8883657455444336, -0.7335896492004395, -0.9547357559204102, 0.1671276092529297, -0.7476644515991211, -0.30779361724853516, -0.2878122329711914, 0.783646821975708, -0.4797244071960449, 0.08693790435791016, -0.33362388610839844, 1.171980381011963, 1.088271141052246, 10.22173023223877, -1.2237224578857422, 1.261199951171875, 4.297934532165527, 0.628936767578125, -0.19223785400390625, 0.5303335189819336, 0.039997100830078125, -0.37921714782714844, 0.5703310966491699, -0.7472515106201172, -0.8018069267272949, 0.38356733322143555, 0.1033935546875, -0.17810440063476562, 0.3465385437011719, 0.4153614044189453, -1.6919326782226562, -0.3123779296875, -0.15944433212280273, -0.16379928588867188, -2.015814781188965, 1.5967330932617188, -3.477020263671875, -1.5199718475341797, -0.23175811767578125, -1.824666976928711, -0.20470952987670898, 2.126636505126953, -0.7624855041503906, -1.0289859771728516, -6.958521842956543, 0.00339508056640625, 0.21593523025512695, 0.5747880935668945, -0.16615009307861328, -0.3191242218017578, -1.7443628311157227, 0.35782814025878906, 2.342172622680664, 0.34841227531433105, -0.034050941467285156, -0.5239968299865723, -1.4359874725341797, 0.7604942321777344, -0.3912849426269531, -0.2483386993408203, -0.3194875717163086, -0.1690959930419922, 0.908574104309082, 0.6556148529052734, -1.899916648864746, -0.3374824523925781, 0.3376579284667969, 0.5856180191040039, 0.24399852752685547, 12.955065727233887, -0.6628866195678711, 0.10931968688964844, 0.029256343841552734, -4.534488677978516, -0.7053394317626953, -0.916473388671875, -0.07995033264160156, -0.8526620864868164, 0.09160852432250977, 0.3652353286743164, 0.19208717346191406, -2.145359754562378, -0.6278419494628906, -2.8004894256591797, -1.6246492862701416, -0.47057580947875977, 0.8557214736938477, -0.9098224639892578, -0.037485599517822266, 1.8957481384277344, -0.09156227111816406, -0.10575246810913086, 0.44430065155029297, 8.364124298095703, -1.9751873016357422, -0.39507102966308594, -0.4643828868865967, -0.030225753784179688, -0.43739745020866394, 0.40978240966796875, 0.423370361328125, 0.310269832611084, 0.3630714416503906, 0.37376976013183594, 0.5856180191040039, -0.16615009307861328, -1.1032743453979492, -0.18671321868896484], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 197100, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 197100, "last_target_update_ts": 43008, "num_target_updates": 83}, "sampler_results": {"episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -78.22140649579465, "episode_len_mean": 255.66, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763], "episode_lengths": [244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5284071493838478, "mean_inference_ms": 23.83029051706647, "mean_action_processing_ms": 0.133938326472996, "mean_env_wait_ms": 4.321862863076231, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -78.22140649579465, "episode_len_mean": 255.66, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-18.77972226589918, -168.72786147892475, -13.045976087450981, -141.92112127691507, -302.7448376342654, -122.009222432971, -155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763], "episode_lengths": [244, 289, 215, 267, 338, 301, 307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5284071493838478, "mean_inference_ms": 23.83029051706647, "mean_action_processing_ms": 0.133938326472996, "mean_env_wait_ms": 4.321862863076231, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 197100, "num_env_steps_sampled": 43008, "num_env_steps_trained": 197100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 43008, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 349.14, "learn_time_ms": 66.779, "learn_throughput": 4492.435, "synch_weights_time_ms": 20.789}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 197100, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 197100, "last_target_update_ts": 43008, "num_target_updates": 83}, "done": false, "episodes_total": 149, "training_iteration": 42, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-28-12", "timestamp": 1655494092, "time_this_iter_s": 5.766430139541626, "time_total_s": 222.14958667755127, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 222.14958667755127, "timesteps_since_restore": 0, "iterations_since_restore": 42, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 33.13333333333333, "ram_util_percent": 63.12222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 11.493305206298828, "min_q": -23.05803871154785, "max_q": 32.27069854736328, "mean_td_error": 0.053370628505945206}, "td_error": [0.6302967071533203, 1.1017494201660156, 0.6019001007080078, 0.19373607635498047, -1.3493242263793945, -0.28128910064697266, 1.0891189575195312, 1.2195923328399658, -0.7468738555908203, 0.36737918853759766, 0.15120267868041992, -0.5030708312988281, 0.22424590587615967, 1.7254676818847656, -1.4321308135986328, -0.9439182281494141, 0.8495283126831055, 0.5913619995117188, 0.4236774444580078, -0.3178901672363281, 0.48032474517822266, 1.0351638793945312, -0.17394161224365234, 1.2919511795043945, -0.505225658416748, 0.42757272720336914, -1.0365924835205078, 1.0431113243103027, 0.012599945068359375, 1.5735435485839844, -0.4958992004394531, 0.4837069511413574, -6.173547744750977, 0.8922767639160156, 0.7925310134887695, -9.519819259643555, 0.9088630676269531, 2.0763092041015625, 0.5174541473388672, 0.7575788497924805, 0.10454988479614258, -0.08464813232421875, -0.12493133544921875, 0.635871410369873, 0.5279664993286133, 1.4175059795379639, 0.24352169036865234, 0.9209418296813965, 0.8302249908447266, 1.3408222198486328, -0.07906055450439453, 1.0782880783081055, -1.1066951751708984, 6.439934730529785, -0.8884477615356445, 1.9475460052490234, 0.5218563079833984, 1.2355461120605469, 2.0696792602539062, -0.5622310638427734, 1.0150585174560547, 3.037382125854492, 1.1152725219726562, 0.8034267425537109, 0.5980234146118164, -0.37981539964675903, 0.4108285903930664, 1.0379409790039062, 0.6787199974060059, 1.3885993957519531, 0.4671926498413086, -0.32822665572166443, 0.28777027130126953, 2.201085090637207, 0.01759934425354004, -6.344779014587402, 1.448441505432129, 2.0232725143432617, 0.6022586822509766, 0.30069589614868164, 1.110708236694336, -0.2305145263671875, -0.2684507369995117, 0.8285388946533203, 1.6825408935546875, 0.4086155891418457, 0.4368019104003906, 0.6128110885620117, -0.3096892833709717, -0.3080558776855469, -0.5603981018066406, -4.361520767211914, 0.15439224243164062, 1.514272689819336, -0.7995281219482422, -0.06905746459960938, 0.4086155891418457, 1.3883562088012695, -0.3877525329589844, 1.440842628479004, -0.9336743354797363, 0.9729700088500977, 1.1082706451416016, -1.1684017181396484, 4.978437423706055, 0.34180259704589844, -6.495965957641602, -0.24262237548828125, 1.541048526763916, -0.41245555877685547, 0.07455945014953613, 0.8192393779754639, -0.06305503845214844, 0.7802963256835938, 0.37584400177001953, 1.657318115234375, 1.5066452026367188, -9.637066841125488, -0.09966421127319336, 0.5188665390014648, 0.12445306777954102, 0.6064262390136719, 0.2391376495361328, 0.06159830093383789, 0.4418373107910156, 0.8460636138916016, -0.0330810546875, 0.13546037673950195, 0.37885618209838867, -0.3775177001953125, 0.19399118423461914, -1.947042465209961, 0.23882770538330078, -0.029407978057861328, 1.1862850189208984, -0.7943744659423828, 0.791478157043457, 0.7778530120849609, -3.3873348236083984, -1.60345458984375, -0.3009958267211914, 2.2949180603027344, -0.29887235164642334, 1.516125202178955, -9.654899597167969, -6.229658126831055, -0.9820499420166016, 2.2030162811279297, -9.376495361328125, 0.30745506286621094, 0.6820316314697266, 0.792973518371582, 0.3063983917236328, 1.2832698822021484, -1.4806767702102661, 1.3096566200256348, 0.43937110900878906, 1.1389150619506836, 0.4726696014404297, -4.931125640869141, -0.9594156742095947, 1.1149959564208984, 0.8935527801513672, 2.0438170433044434, 0.8948774337768555, 0.6542084217071533, 1.0082740783691406, -0.6761806011199951, 0.5851383209228516, 1.1655235290527344, 0.23888397216796875, 0.6409578323364258, 1.3725371360778809, 0.08579063415527344, 0.7876243591308594, 0.8700551986694336, 0.4110112190246582, 0.8812789916992188, 0.4853496551513672, 0.5438117980957031, -0.9314136505126953, -5.015755653381348, -0.07068252563476562, -4.547798156738281, -4.760734558105469, -0.6954727172851562, 0.5160245895385742, -0.4778766632080078, -1.550229549407959, 0.12751388549804688, 1.3657121658325195, 0.5413761138916016, -0.19295120239257812, 0.18916702270507812, 0.03301429748535156, 0.3180828094482422, -0.3004417419433594, 0.01847553253173828, 2.5514564514160156, 1.3782062530517578, 0.5408191680908203, 1.0810165405273438, 1.7335319519042969, -0.0038022994995117188, 0.9146528244018555, -0.2926764488220215, -0.030681133270263672, -0.422943115234375, 0.38729286193847656, 1.0690250396728516, 0.5826053619384766, 0.6447315216064453, -0.6229114532470703, 1.0117521286010742, 1.255751609802246, 1.1370694637298584, 1.1629676818847656, 0.17407894134521484, 1.1580095291137695, 2.222787857055664, -0.08017206192016602, 0.3131837844848633, 0.4172172546386719, 2.592761993408203, 0.8051834106445312, 0.9828643798828125, 0.3156585693359375, 0.00272369384765625, 1.8791446685791016, -1.0738415718078613, -4.168491363525391, 0.09554481506347656, 0.8138594627380371, 1.2948055267333984, 0.35176658630371094, 0.36316490173339844, 0.8957619667053223, 5.710529327392578, -6.817536354064941, 0.6943588256835938, -9.02217960357666, -4.782641410827637, 0.363344669342041, 0.5179214477539062, 1.4185066223144531, 0.7644462585449219, 0.12132930755615234, 1.066023826599121, 0.5118808746337891, -0.48089122772216797, 0.24233508110046387, 1.292684555053711, -2.24265193939209, 0.6758890151977539, -0.14510154724121094, -0.028818130493164062, -0.6883883476257324, 0.2842874526977539, 0.18255615234375, 1.0346269607543945, 0.546229362487793, -0.1732769012451172, -0.5584874153137207, 0.37632179260253906, 0.4208412170410156, 0.6220664978027344, 0.2066497802734375, 1.3229494094848633, 0.8352370262145996, -0.35568079352378845, 2.346620559692383, 0.8906955718994141, 0.14400482177734375, 0.024636000394821167, 0.3215212821960449, 0.22591781616210938, 1.952657699584961, 0.013005733489990234, 0.5564327239990234, 0.22374534606933594, 0.5308632850646973, -6.350691795349121, 1.3373327255249023, 0.5542669296264648, 0.34243297576904297, 0.3763160705566406, 0.6465373039245605, -0.8797283172607422, 0.8135881423950195, -0.8884477615356445, 0.6986377239227295, 0.6917533874511719, 1.6407575607299805, 0.8114738464355469, 0.627985954284668, -0.49466776847839355, -7.141180038452148, 0.27213478088378906, -0.05833625793457031, 0.3358726501464844], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 201900, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 201900, "last_target_update_ts": 44032, "num_target_updates": 85}, "sampler_results": {"episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -71.46797828681767, "episode_len_mean": 252.32, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907], "episode_lengths": [307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5298581791925456, "mean_inference_ms": 23.89144740369021, "mean_action_processing_ms": 0.13396104697600042, "mean_env_wait_ms": 4.330017055166035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -71.46797828681767, "episode_len_mean": 252.32, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155.29138973355293, -221.34156723320484, -309.75527311116457, -6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907], "episode_lengths": [307, 322, 337, 244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5298581791925456, "mean_inference_ms": 23.89144740369021, "mean_action_processing_ms": 0.13396104697600042, "mean_env_wait_ms": 4.330017055166035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 201900, "num_env_steps_sampled": 44032, "num_env_steps_trained": 201900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 44032, "agent_timesteps_total": 44032, "timers": {"training_iteration_time_ms": 351.032, "learn_time_ms": 66.171, "learn_throughput": 4533.687, "synch_weights_time_ms": 20.289}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 201900, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 201900, "last_target_update_ts": 44032, "num_target_updates": 85}, "done": false, "episodes_total": 155, "training_iteration": 43, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-28-17", "timestamp": 1655494097, "time_this_iter_s": 5.467810153961182, "time_total_s": 227.61739683151245, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 227.61739683151245, "timesteps_since_restore": 0, "iterations_since_restore": 43, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.428571428571427, "ram_util_percent": 63.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 10.568552017211914, "min_q": -25.41387939453125, "max_q": 39.598087310791016, "mean_td_error": -0.4772535264492035}, "td_error": [0.4271249771118164, -0.053820133209228516, -2.760976791381836, -0.3238048553466797, 0.0036950111389160156, -0.33954668045043945, 0.3360006809234619, 0.2610321044921875, 0.7540693283081055, 0.03809928894042969, 0.663722038269043, 0.015155792236328125, -1.1110138893127441, -4.755434036254883, -0.3101377487182617, 0.7154245376586914, -0.4137544631958008, 0.07461833953857422, 0.21675682067871094, 8.608076095581055, 0.3052482604980469, 2.0128517150878906, -0.9484233856201172, 1.696868896484375, -0.07721853256225586, 0.3784370422363281, -0.33823204040527344, 0.25626516342163086, 0.12442970275878906, -0.9980869293212891, 0.018398284912109375, 0.6009006500244141, -4.958181381225586, 0.9337549209594727, 1.3817329406738281, -0.6282215118408203, 0.022847652435302734, -2.6385374069213867, -0.2708425521850586, -0.23534011840820312, -0.1122891902923584, 0.17124176025390625, -1.0058879852294922, -0.9288387298583984, -0.8206710815429688, 0.47266387939453125, 1.0645751953125, -0.08475828170776367, -5.932480812072754, 0.4348793029785156, 0.15095138549804688, -0.7506160736083984, -0.1956939697265625, -0.7252426147460938, 0.15869903564453125, -0.6394109725952148, -0.27544522285461426, 0.8243293762207031, 2.7084274291992188, 0.3283376693725586, -1.0193023681640625, 17.5247802734375, -0.13753604888916016, -1.204054832458496, 0.05260276794433594, -1.2733960151672363, 0.9261341094970703, 0.599738597869873, -0.5124006271362305, 1.2539129257202148, -0.1544055938720703, -0.3706197738647461, -6.024280548095703, -0.3775010108947754, -9.364497184753418, 0.623936653137207, -9.295415878295898, -1.161630630493164, -0.17897558212280273, -0.25833868980407715, 0.2404766082763672, 0.3829059600830078, 0.24825477600097656, -0.5034728050231934, -6.970672607421875, -0.7902927398681641, 0.515925407409668, 1.1836328506469727, -1.3441286087036133, 0.014280319213867188, 0.3750724792480469, -0.6719570159912109, -0.4384908676147461, -0.8152804374694824, -1.3955974578857422, 1.3813121318817139, 0.9789532423019409, 0.025800704956054688, 0.35141420364379883, -0.11417198181152344, 0.4866294860839844, 1.9199542999267578, -0.7412047386169434, 0.304934024810791, -0.6004629135131836, 0.10530662536621094, 1.2873115539550781, -5.817126274108887, -2.280364990234375, 0.35666465759277344, -0.07361984252929688, -0.7024681568145752, 0.2137775421142578, -1.7457542419433594, 0.1233530044555664, -0.3343086242675781, -0.4114189147949219, -1.1701669692993164, -0.019544601440429688, -5.371151447296143, 0.7634811401367188, 0.24966859817504883, -0.2631869316101074, -0.21636009216308594, -0.5813593864440918, -0.9615287780761719, 0.19611644744873047, -4.375494480133057, -0.0543212890625, 1.1593210697174072, -0.2798175811767578, -6.370857238769531, -1.4976272583007812, -1.8791675567626953, 0.3815269470214844, -0.34159088134765625, -1.3184301853179932, 0.4289112091064453, -0.04695320129394531, -0.45838022232055664, 0.11774063110351562, 0.8807005882263184, -0.11203813552856445, -0.11494207382202148, 0.03766226768493652, 1.0061187744140625, 0.27134132385253906, -0.43346214294433594, -0.10239219665527344, 0.7145109176635742, -5.000942230224609, -0.4782066345214844, -0.3027973175048828, -0.9350290298461914, -4.76359748840332, -0.46366405487060547, 0.3274192810058594, -6.944014549255371, -0.5387144088745117, -6.202910423278809, -0.06205940246582031, -1.1937789916992188, -1.1915335655212402, -0.2146596908569336, -0.3638572692871094, 1.1180295944213867, -0.5209293365478516, -2.732394218444824, -0.02911663055419922, -0.7786374092102051, -0.4988212585449219, 0.49111175537109375, -0.45236921310424805, -0.2606849670410156, -5.864524841308594, -6.411840438842773, 0.8765316009521484, 0.25304412841796875, -1.5608062744140625, -0.2039508819580078, -0.11005163192749023, 0.49407005310058594, -0.3777179718017578, -5.035578727722168, -0.33749616146087646, 0.5180954933166504, 0.07521367073059082, -0.7587594985961914, -1.1110138893127441, 0.007889747619628906, -1.1697063446044922, 0.010982513427734375, -1.2501970529556274, -0.6483557224273682, -1.2567262649536133, -0.6157103180885315, -0.6047496795654297, 0.5368967056274414, -0.2299203872680664, 0.5242056846618652, -0.4094200134277344, 0.040561676025390625, -1.1771111488342285, -0.15177440643310547, -0.571904182434082, -0.6436748504638672, 1.8916726112365723, 0.927978515625, -1.800330400466919, -0.005476474761962891, 1.0708894729614258, 0.7859439849853516, -2.1667613983154297, -0.4253997802734375, 1.4306001663208008, -0.14910078048706055, 0.48324012756347656, -0.32930421829223633, 0.3658123016357422, 0.09475183486938477, -0.6617488861083984, -7.558530807495117, 0.7592048645019531, -5.817126274108887, -0.08719253540039062, -0.19637393951416016, 2.836700439453125, 0.2831234931945801, 0.39894700050354004, 0.8230886459350586, 0.20652198791503906, 0.7907886505126953, 1.1011476516723633, 0.8576087951660156, -0.3043346405029297, -0.8769595623016357, 0.3300294876098633, 0.6846394538879395, -0.4910311698913574, -0.3966655731201172, 1.2952041625976562, -12.24390983581543, 0.1686573028564453, -4.212551116943359, -0.4997587203979492, 0.47331809997558594, 0.21747112274169922, 0.4693775177001953, -0.24713706970214844, 0.4719672203063965, 0.36903810501098633, -0.3085331916809082, -1.2377376556396484, 0.15138530731201172, -0.19293785095214844, 0.7291355133056641, -0.3601856231689453, -0.30762815475463867, -1.7915706634521484, -0.5096259117126465, -0.34320640563964844, 6.652422904968262, -0.967036247253418, 0.44686126708984375, 0.5812301635742188, 0.20652198791503906, 3.023993492126465, -2.6026463508605957, -3.1883583068847656, -0.3561973571777344, -2.9698028564453125, 0.3762397766113281, -0.013811111450195312, -1.0818099975585938, -1.010930061340332, 0.0036950111389160156, -0.05108976364135742, 0.6421236991882324, 0.005544185638427734, 1.6189517974853516, 1.1291189193725586, -0.11561203002929688, -1.2068510055541992, -0.5205163955688477, -0.11599159240722656, 2.9974899291992188, -0.06042289733886719, 0.5486335754394531, -0.44520044326782227, -0.48562073707580566, 0.43327856063842773, -6.289421081542969, 1.9532623291015625, -0.9001789093017578, -0.1405315399169922, -0.9831767082214355, 0.2867927551269531, -5.175467491149902, -0.6482539176940918, -0.7037076950073242], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 206700, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 206700, "last_target_update_ts": 45056, "num_target_updates": 87}, "sampler_results": {"episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -66.98259338349104, "episode_len_mean": 250.4, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237], "episode_lengths": [244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5309440664094718, "mean_inference_ms": 23.916940326358258, "mean_action_processing_ms": 0.134130082545313, "mean_env_wait_ms": 4.334439300299068, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -66.98259338349104, "episode_len_mean": 250.4, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.670973852276802, -45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237], "episode_lengths": [244, 249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5309440664094718, "mean_inference_ms": 23.916940326358258, "mean_action_processing_ms": 0.134130082545313, "mean_env_wait_ms": 4.334439300299068, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 206700, "num_env_steps_sampled": 45056, "num_env_steps_trained": 206700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 45056, "agent_timesteps_total": 45056, "timers": {"training_iteration_time_ms": 331.336, "learn_time_ms": 66.463, "learn_throughput": 4513.813, "synch_weights_time_ms": 20.289}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 206700, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 206700, "last_target_update_ts": 45056, "num_target_updates": 87}, "done": false, "episodes_total": 158, "training_iteration": 44, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-28-23", "timestamp": 1655494103, "time_this_iter_s": 5.386632442474365, "time_total_s": 233.00402927398682, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 233.00402927398682, "timesteps_since_restore": 0, "iterations_since_restore": 44, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.0625, "ram_util_percent": 63.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 10.992295265197754, "min_q": -25.841917037963867, "max_q": 40.939571380615234, "mean_td_error": -0.8377065658569336}, "td_error": [-0.20200777053833008, -1.7767829895019531, -0.12104606628417969, -0.1567859649658203, -0.7252368927001953, 0.14661312103271484, -1.4346656799316406, -0.4015922546386719, 0.6599063873291016, 0.016849517822265625, -0.5751428604125977, 0.8051156997680664, -0.34585094451904297, -0.25696754455566406, -0.3829460144042969, 0.2407512664794922, 0.1679840087890625, -12.056419372558594, -10.080702781677246, -0.10204124450683594, -1.084536075592041, -1.0086288452148438, 1.2382855415344238, -0.05766868591308594, -0.6485681533813477, -0.0022764205932617188, 2.146940231323242, -0.9401817321777344, -0.5195860862731934, 0.7231004238128662, -0.8302192687988281, -6.078935623168945, -0.5234251022338867, -0.66168212890625, -0.7213163375854492, -0.8358078002929688, -6.489394187927246, -0.31671142578125, 0.4767894744873047, -0.4131021499633789, -1.6766843795776367, 0.8259329795837402, 0.02092266082763672, -11.068891525268555, 0.6702613830566406, -0.43575000762939453, -2.2829837799072266, 0.039463043212890625, -5.929594039916992, -0.46775007247924805, -0.7003078460693359, 0.8299932479858398, -0.7517805099487305, -0.890328049659729, -3.758119583129883, -0.3184518814086914, -2.1601672172546387, -1.351996898651123, 0.46842265129089355, -0.20223045349121094, -0.3966217041015625, 1.6499617099761963, -0.5545692443847656, -3.792266845703125, -0.9282016754150391, -6.3095703125, -0.8960292339324951, 0.5566730499267578, -2.1309432983398438, -0.13942623138427734, -4.099020004272461, -1.9059441089630127, 0.12216806411743164, -0.31671142578125, -1.3012313842773438, -1.7853121757507324, -0.07745552062988281, 2.0415096282958984, -1.4499788284301758, -0.4808025360107422, -0.0976877212524414, -1.1032452583312988, -0.9271903038024902, 0.054470062255859375, 0.2868480682373047, -1.171513557434082, 0.16997337341308594, -1.4213809967041016, 0.5081777572631836, -0.8966975212097168, -0.2842588424682617, -0.5845260620117188, -0.6080307960510254, -0.11920166015625, -0.7372674942016602, 0.01785564422607422, 8.961607933044434, -1.3420295715332031, 0.36622166633605957, 0.28667354583740234, -0.49563026428222656, -0.8189327716827393, -3.083743095397949, -5.762341499328613, 1.2112760543823242, -0.1208047866821289, 0.8388023376464844, 0.6264877319335938, 0.7203640937805176, -1.532059907913208, -0.24667739868164062, -1.5687370300292969, -0.12374496459960938, -1.1940593719482422, 0.09032392501831055, -1.7852287292480469, -0.24194574356079102, -0.8861064910888672, -0.9495315551757812, -1.2247562408447266, -0.43463706970214844, -6.397270202636719, 0.31760215759277344, -0.528928279876709, -1.4219846725463867, -8.231073379516602, 0.09060049057006836, -0.11500215530395508, -0.7397480010986328, -0.9014148712158203, -0.39710044860839844, -0.7059059143066406, -1.841094970703125, -1.7861323356628418, -1.1105155944824219, -0.32752227783203125, 0.24969840049743652, -0.16480445861816406, -0.23788881301879883, -0.7961816787719727, -1.160074234008789, 0.28816986083984375, 0.5467381477355957, 0.9203367233276367, -0.97149658203125, -0.4582853317260742, 0.3942079544067383, -0.41866493225097656, 0.8599710464477539, -1.2261905670166016, -0.5761523246765137, 1.481003761291504, -1.6881542205810547, 0.23425006866455078, 0.7755498886108398, -2.0325536727905273, -2.223212242126465, -0.8780839443206787, -0.8727455139160156, -0.8281269073486328, -1.1067028045654297, -5.601352691650391, 0.9207777976989746, -0.014209747314453125, -0.47437095642089844, -0.4933128356933594, 0.48084259033203125, -0.6276874542236328, -0.7840824127197266, -0.7373514175415039, -0.5014591217041016, -0.4118032455444336, -0.6723883152008057, -1.213730812072754, 0.1678638458251953, -0.7924413681030273, 0.31662940979003906, 1.7505149841308594, 0.5932769775390625, -0.581965446472168, 5.0170464515686035, -1.610076904296875, -0.08433008193969727, -0.3509187698364258, -0.48467588424682617, -0.5174369812011719, 0.27553749084472656, -6.821153163909912, -1.3895025253295898, 0.8417329788208008, -0.5102841854095459, 0.06523895263671875, -1.1241798400878906, 0.5927653312683105, -0.32263660430908203, -5.762341499328613, -0.3260498046875, -0.5238966941833496, -2.4929656982421875, 0.03042459487915039, 0.20401501655578613, -1.243971347808838, 0.2204761505126953, 0.6702613830566406, -0.5670480728149414, -5.941643238067627, -0.7336826324462891, -0.13763093948364258, -0.01897430419921875, 0.08393186330795288, -0.5911731719970703, -0.1920328140258789, -0.19727039337158203, -0.1677255630493164, -0.6173419952392578, -0.2191009521484375, -0.4408407211303711, -1.1238441467285156, -0.979344367980957, 0.6751947402954102, -0.5080795288085938, -1.5394344329833984, -1.8455123901367188, 0.13437509536743164, 0.9253584146499634, 5.940822601318359, -8.013197898864746, -0.449127197265625, 0.3580913543701172, -0.46115827560424805, -0.17198944091796875, -0.3692188262939453, -1.1785163879394531, -1.0496883392333984, -0.8714532852172852, -1.1670608520507812, -3.0738754272460938, -0.010080337524414062, -3.256135940551758, 0.8364434242248535, -1.6120834350585938, -3.4568004608154297, -0.23380231857299805, 0.24208831787109375, 0.9385452270507812, 0.40981483459472656, -0.27910566329956055, -2.076852798461914, -0.1491377353668213, -0.6141119003295898, 0.28347015380859375, -0.38153648376464844, -0.21065521240234375, -0.02260756492614746, -0.723698616027832, -0.12047576904296875, -0.9340372085571289, 0.6233844757080078, -1.0869941711425781, -2.4819507598876953, -0.7290935516357422, -0.77764892578125, 7.337886810302734, 0.9207777976989746, 0.1381983757019043, -2.562276840209961, 0.035160064697265625, -0.26445770263671875, 0.1725749969482422, -0.165679931640625, -3.138641834259033, -1.6984496116638184, -5.570196151733398, 1.336318016052246, -0.9806594848632812, -0.8966069221496582, -0.7205333709716797, -1.6664676666259766, 0.03358888626098633, -1.094991683959961, -7.153678894042969, 0.1831064224243164, -0.43590736389160156, -6.73891544342041, 0.2919182777404785, -0.1735682487487793, -0.22546958923339844, -1.8227519989013672, -0.9961442947387695, 0.3063969612121582, -0.7870113849639893, 0.6251220703125, -7.662671089172363, -0.4441208839416504, -0.5632162094116211, -2.209613800048828, -1.3995838165283203, 0.573432445526123, -5.457788467407227, 0.2868480682373047], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 211500, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 211500, "last_target_update_ts": 46080, "num_target_updates": 89}, "sampler_results": {"episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -66.82580608971416, "episode_len_mean": 249.94, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175], "episode_lengths": [249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5313386979251614, "mean_inference_ms": 23.933878808559747, "mean_action_processing_ms": 0.13422582109949133, "mean_env_wait_ms": 4.336010404332925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -66.82580608971416, "episode_len_mean": 249.94, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.63490456342697, -225.4123389571905, -290.0566602572799, -220.24305748939514, -179.44312922656536, -26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175], "episode_lengths": [249, 327, 335, 310, 294, 235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5313386979251614, "mean_inference_ms": 23.933878808559747, "mean_action_processing_ms": 0.13422582109949133, "mean_env_wait_ms": 4.336010404332925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 211500, "num_env_steps_sampled": 46080, "num_env_steps_trained": 211500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 46080, "agent_timesteps_total": 46080, "timers": {"training_iteration_time_ms": 332.583, "learn_time_ms": 67.652, "learn_throughput": 4434.428, "synch_weights_time_ms": 20.652}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 211500, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 211500, "last_target_update_ts": 46080, "num_target_updates": 89}, "done": false, "episodes_total": 159, "training_iteration": 45, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-28-28", "timestamp": 1655494108, "time_this_iter_s": 5.283275842666626, "time_total_s": 238.28730511665344, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 238.28730511665344, "timesteps_since_restore": 0, "iterations_since_restore": 45, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.550000000000004, "ram_util_percent": 63.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 11.146382331848145, "min_q": -27.608617782592773, "max_q": 37.788089752197266, "mean_td_error": -0.567538321018219}, "td_error": [-0.1582965850830078, 0.2594757080078125, -1.5133514404296875, -0.42942047119140625, 0.7780108451843262, -0.8524761199951172, -0.2622966766357422, -0.6903131008148193, 0.6141948699951172, -0.11032676696777344, -0.8077077865600586, -0.21462750434875488, -0.34755611419677734, -1.2255611419677734, -1.5331754684448242, -0.014405250549316406, 0.36514806747436523, -1.2010574340820312, -0.4069976806640625, -0.43952083587646484, 1.4732789993286133, -1.8311758041381836, 0.12346649169921875, 0.4543781280517578, -0.3264751434326172, 0.15116214752197266, -0.3607006072998047, -0.041861534118652344, -0.3529653549194336, -1.1080955266952515, -1.1134185791015625, -0.8274250030517578, -1.6998825073242188, -0.45850276947021484, 0.19350624084472656, -0.7651867866516113, -1.163839340209961, 0.029249191284179688, -0.2846956253051758, -0.3394966125488281, -5.046178817749023, -0.6211528778076172, -1.7004848718643188, 0.16943931579589844, -0.17388343811035156, 0.13239431381225586, -0.011788368225097656, -0.4361858367919922, -0.3331260681152344, 0.26461124420166016, -0.8688583374023438, -0.19593334197998047, -0.4335365295410156, -1.0719423294067383, -0.9241371154785156, 0.7607049942016602, -0.9608325958251953, -8.867186546325684, -0.17196083068847656, 0.30843544006347656, -0.38763999938964844, -0.7621517181396484, 0.4310741424560547, -0.22454214096069336, -7.705958366394043, 0.29514408111572266, 0.11136436462402344, -0.15204334259033203, 1.3561062812805176, -1.1116037368774414, -0.4398231506347656, -0.6550006866455078, 0.22865605354309082, -4.638950347900391, 0.3865337371826172, 0.002323150634765625, 0.7353382110595703, -12.67935848236084, -0.6031112670898438, -1.1337356567382812, -0.3057575225830078, 0.6975870132446289, -1.7965927124023438, 0.6066579818725586, -0.7693576812744141, -0.6853847503662109, 0.035584092140197754, 0.47137451171875, 0.1794300079345703, -0.5421726703643799, 0.7499771118164062, -0.20361948013305664, 10.046577453613281, 0.5661664009094238, -0.4541797637939453, -0.8924560546875, -0.06319618225097656, -0.3473529815673828, 0.5725765228271484, 0.6936659812927246, -0.2157878875732422, -6.761579513549805, 0.877814531326294, 5.1802167892456055, 0.031537532806396484, -0.9553298950195312, 2.1272506713867188, -0.16943359375, -0.15848159790039062, -0.11756753921508789, 0.6952629089355469, 0.8218479156494141, 0.23910903930664062, -2.0764970779418945, -3.5237083435058594, -0.3299751281738281, -1.4360904693603516, -0.017063140869140625, -0.4528999328613281, -1.8861198425292969, -7.968699932098389, -0.2424182891845703, -0.7199783325195312, 1.5712699890136719, -0.04309558868408203, -10.182485580444336, 4.358833312988281, -0.497708797454834, -0.4107513427734375, 0.04626274108886719, -0.087371826171875, -6.363588333129883, -1.6905298233032227, -0.07708168029785156, 0.3148820400238037, -6.991574287414551, 1.566131591796875, -1.189549446105957, -0.253143310546875, 0.3578948974609375, 12.19517993927002, -0.4833545684814453, -0.04913520812988281, -0.36713266372680664, -1.2245845794677734, 1.2099823951721191, 0.9804303646087646, -0.5693130493164062, 0.40647125244140625, -0.3451375961303711, -0.22550392150878906, 0.023565292358398438, -0.17388343811035156, 0.16490554809570312, -0.662114143371582, -1.5633630752563477, 5.055267333984375, -10.379968643188477, -0.39993858337402344, -0.4560403823852539, -2.7497050762176514, -1.2515144348144531, -0.38498783111572266, -0.2939472198486328, -1.4399471282958984, -0.40407562255859375, 0.1621788740158081, -0.4987184405326843, 0.20656394958496094, -6.166294097900391, 0.12115240097045898, 6.248509407043457, -10.050607681274414, -0.8324432373046875, 0.6917095184326172, -6.289033889770508, -9.93270492553711, -0.5092544555664062, 0.950584888458252, 0.23833560943603516, -1.2478036880493164, 1.6550841331481934, -0.7169351577758789, 0.3452577590942383, 1.7813358306884766, 0.9411039352416992, -4.50894832611084, -1.705810546875, -0.5228281021118164, -0.197418212890625, 0.41563987731933594, -0.01712942123413086, -0.16943359375, -0.5606002807617188, 0.22722721099853516, -0.0987691879272461, 17.466461181640625, 1.4887495040893555, -0.34998512268066406, -0.1089639663696289, -0.18506717681884766, -0.8099193572998047, -0.07618522644042969, -7.050313949584961, -0.7397518157958984, 0.2333831787109375, -2.5038986206054688, -0.5919322967529297, -0.16323089599609375, -0.055690765380859375, -0.23618006706237793, 3.444957733154297, 0.11582374572753906, -0.509831428527832, -0.7749738693237305, -0.8142824172973633, 0.17659664154052734, 0.4364748001098633, -0.5123691558837891, -0.5260334014892578, 0.6975870132446289, -2.077052116394043, -0.29393959045410156, 1.1380157470703125, -0.5669012069702148, -0.487396240234375, -0.22996902465820312, 0.31065988540649414, -0.2047901153564453, -0.497708797454834, -4.127170562744141, 0.4208078384399414, -0.06285476684570312, -0.41354894638061523, -0.4260702133178711, -1.6488609313964844, 0.17106246948242188, 0.6968517303466797, -1.5633630752563477, 0.15934085845947266, -0.17416000366210938, 0.1139068603515625, -1.529479742050171, 0.5985312461853027, 0.02832317352294922, -0.9779148101806641, -1.1143245697021484, 0.14336013793945312, -1.3511486053466797, 0.26932239532470703, -0.332003116607666, 0.7493171691894531, -0.7865400314331055, -0.2154083251953125, 0.046133995056152344, -0.9757051467895508, -0.9864120483398438, -0.8933515548706055, -0.9864120483398438, -0.1560840606689453, 0.7421646118164062, -0.20190000534057617, -0.8382997512817383, -4.869239807128906, -0.08075141906738281, -1.593848466873169, 0.1457524299621582, -0.29796695709228516, 0.05418205261230469, 1.0643892288208008, -10.648445129394531, -0.13500118255615234, 0.03671836853027344, -0.6148452758789062, -5.249338150024414, 0.6058073043823242, 1.4949150085449219, -1.0887813568115234, -0.7497520446777344, 0.7964038848876953, 1.488163948059082, 1.702810287475586, -1.4699575901031494, -0.4910469055175781, 0.05048370361328125, 0.38346099853515625, -3.0191307067871094, -0.48851776123046875, -2.402279853820801, 0.4427986145019531, -0.9933695793151855, 0.21375608444213867, -0.8913760185241699, -0.39121341705322266, -8.550873756408691, 0.41280651092529297, -0.8154010772705078, 0.4427986145019531, 0.18172740936279297, 0.6086883544921875], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 216300, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 216300, "last_target_update_ts": 47104, "num_target_updates": 91}, "sampler_results": {"episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -57.38260652408004, "episode_len_mean": 245.93, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173], "episode_lengths": [235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5340358533852938, "mean_inference_ms": 23.96459423793655, "mean_action_processing_ms": 0.13393491558834106, "mean_env_wait_ms": 4.347011900397502, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -57.38260652408004, "episode_len_mean": 245.93, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.76882315427065, 11.318390965461731, -131.03400216251612, -7.499097280204296, -1.9000000059604645, -227.09505306184292, -114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173], "episode_lengths": [235, 223, 271, 229, 200, 332, 262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5340358533852938, "mean_inference_ms": 23.96459423793655, "mean_action_processing_ms": 0.13393491558834106, "mean_env_wait_ms": 4.347011900397502, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 216300, "num_env_steps_sampled": 47104, "num_env_steps_trained": 216300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 47104, "agent_timesteps_total": 47104, "timers": {"training_iteration_time_ms": 342.962, "learn_time_ms": 67.57, "learn_throughput": 4439.851, "synch_weights_time_ms": 20.813}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 216300, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 216300, "last_target_update_ts": 47104, "num_target_updates": 91}, "done": false, "episodes_total": 164, "training_iteration": 46, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-28-34", "timestamp": 1655494114, "time_this_iter_s": 5.60558557510376, "time_total_s": 243.8928906917572, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 243.8928906917572, "timesteps_since_restore": 0, "iterations_since_restore": 46, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.575, "ram_util_percent": 63.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 12.395589828491211, "min_q": -27.085432052612305, "max_q": 42.07147216796875, "mean_td_error": -0.17588135600090027}, "td_error": [-1.2062463760375977, -0.042980194091796875, 1.292311668395996, 0.1533203125, -0.8173179626464844, 0.5213271975517273, -0.03890728950500488, -0.14657974243164062, 0.15641021728515625, 0.47106361389160156, -1.7040739059448242, -2.2278919219970703, -0.32487010955810547, -3.373792886734009, 0.18255233764648438, 1.0896835327148438, 1.2697601318359375, -0.07100868225097656, 0.8639020919799805, 0.4798564910888672, 0.871065080165863, 0.1042640209197998, -1.116389274597168, 1.156857967376709, -1.122603178024292, -0.33466434478759766, -9.659791946411133, 0.5544185638427734, 1.5162372589111328, 1.0447473526000977, -6.385780334472656, 0.3238182067871094, -5.980280876159668, -4.769918918609619, 0.241180419921875, 0.3327927589416504, -0.11326980590820312, 0.2503376007080078, 0.21198749542236328, 0.36089372634887695, 0.0061206817626953125, 0.6463813781738281, 0.32989978790283203, -0.18231582641601562, -0.8945732116699219, 1.9519376754760742, 1.0857973098754883, 0.9821205139160156, 0.791712760925293, -0.6716537475585938, 0.32022857666015625, 0.7482643127441406, 0.05380725860595703, 3.0174198150634766, -4.454801559448242, -0.11281394958496094, 0.39032745361328125, 0.07446479797363281, -0.44745874404907227, 0.31176090240478516, -0.5771093368530273, 0.2717704772949219, -0.6298718452453613, -0.2827644348144531, 1.9867010116577148, 6.711484909057617, -10.191041946411133, 0.5520830154418945, -0.8908843994140625, -0.9742240905761719, 0.3823051452636719, 0.15829133987426758, 0.762359619140625, -0.4607372283935547, -0.702488899230957, 1.4673547744750977, 0.3010101318359375, -0.0669097900390625, -0.3049459457397461, 0.4102821350097656, 0.06137561798095703, -0.14719486236572266, 0.927947998046875, -1.2833261489868164, -0.3947324752807617, 1.6717514991760254, -0.11265754699707031, -0.0321197509765625, 0.3415851593017578, -0.25658726692199707, 0.3937644958496094, -0.25226497650146484, -7.111537933349609, -5.577171325683594, -0.08351516723632812, 0.07374954223632812, 0.01806640625, -0.492154598236084, 0.3738584518432617, 0.9332036972045898, 0.6254024505615234, -0.8508338928222656, 0.2734856605529785, 0.24983882904052734, 0.5603418350219727, -0.06604814529418945, -0.48882102966308594, -0.9937324523925781, 13.414081573486328, -6.652435302734375, 0.6866593360900879, 0.7079963684082031, -6.614249229431152, 0.3443889617919922, 0.06722211837768555, -1.8111052513122559, -0.8072514533996582, -0.3119659423828125, -0.8888721466064453, 1.3417291641235352, 1.9101157188415527, 0.31068897247314453, 0.6551405787467957, 22.066604614257812, 1.358128547668457, -0.5315389633178711, 0.10470008850097656, -0.5769648551940918, -0.09714317321777344, 0.24497222900390625, -0.6991615295410156, -7.83027458190918, -0.49065399169921875, 0.5167331695556641, 0.4718027114868164, 0.24123764038085938, 0.1670064926147461, -7.1752471923828125, 0.020610809326171875, -0.09528160095214844, -0.3201507329940796, 0.5925021171569824, 0.7079963684082031, -0.21666240692138672, -0.4178485870361328, -0.17663097381591797, 0.4842662811279297, -0.36302757263183594, -1.1492044925689697, -0.018510818481445312, 1.1904220581054688, 1.755056381225586, -1.2933168411254883, 1.1315183639526367, 1.0447473526000977, -0.45327186584472656, 0.7587394714355469, 1.358128547668457, 0.4623847007751465, 2.623157501220703, -1.2606091499328613, -0.041272640228271484, -1.3574094772338867, -0.7222709655761719, 1.506216049194336, -6.369871139526367, 0.5882911682128906, -0.2762794494628906, 0.11928081512451172, 1.3572826385498047, 0.22415637969970703, 1.0281486511230469, -1.4319400787353516, 0.4119558334350586, 1.4138164520263672, 0.19390010833740234, -2.476238250732422, -0.4188251495361328, -2.230520248413086, 0.30957794189453125, 0.30060386657714844, 0.5126180648803711, -0.5170106887817383, 6.031737327575684, -1.6580848693847656, -0.11982345581054688, -0.34799957275390625, 1.1869697570800781, 2.685777187347412, -0.8968229293823242, 1.5921916961669922, -0.05692863464355469, 0.08934211730957031, 0.505465030670166, -0.049016475677490234, -0.3080892562866211, -1.3203248977661133, -0.9701404571533203, 0.056832313537597656, -1.0168876647949219, 0.4221014976501465, -0.18059468269348145, 0.3446235656738281, -0.22522354125976562, -0.30074119567871094, -0.3876028060913086, 0.8070440292358398, -0.5235099792480469, 0.316683292388916, -0.4877800941467285, -6.652435302734375, -4.1405792236328125, 0.5364446640014648, -0.8071804046630859, -0.7303237915039062, 0.9581913948059082, -0.4962043762207031, 0.6428377628326416, -0.2552194595336914, 0.03398323059082031, -1.0764884948730469, -0.6814403533935547, -0.8884491920471191, 1.715047836303711, 0.39754295349121094, -0.1978539228439331, -0.4870872497558594, 0.15175533294677734, -0.26453495025634766, -0.09489560127258301, -0.4303913116455078, -5.0348310470581055, -1.2113385200500488, -2.470719337463379, -0.8437843322753906, -0.6448287963867188, 0.9842739105224609, -0.6527862548828125, -0.3060302734375, -6.103767395019531, 0.5693740844726562, -0.4407534599304199, -0.6951613426208496, 0.6081600189208984, -0.965576171875, -0.08471107482910156, 0.5406551361083984, -0.4719390869140625, -0.05113983154296875, -0.5992259979248047, 0.3335914611816406, -0.5576629638671875, 1.6907539367675781, -2.856600761413574, 0.3166790008544922, -0.7061052322387695, 0.1755228042602539, -0.03374481201171875, -1.0716431140899658, -0.9271583557128906, -0.14816856384277344, -0.10156440734863281, 0.8153729438781738, -0.7262554168701172, -0.7557315826416016, 0.4897747039794922, -1.4848442077636719, -0.12134170532226562, -0.9668807983398438, -0.15900087356567383, -0.21472835540771484, 0.25977516174316406, -1.0393714904785156, 0.33303260803222656, 0.0529475212097168, 0.5183963775634766, -0.4637155532836914, 1.5834922790527344, 0.1553363800048828, -1.4578609466552734, -0.15031814575195312, -0.3813619613647461, 0.5320711135864258, -3.9615020751953125, -0.119110107421875, -0.03391289710998535, 0.22942066192626953, -0.22434234619140625, 2.0441818237304688, 0.32784271240234375, 1.5956192016601562, -0.5103988647460938, 3.614863395690918, -0.4050769805908203, 1.4759082794189453, 0.934025764465332, 0.2466268539428711, 1.3835172653198242, 0.7438435554504395, -0.441342830657959], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 221100, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 221100, "last_target_update_ts": 48128, "num_target_updates": 93}, "sampler_results": {"episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -64.0164239026606, "episode_len_mean": 247.53, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159], "episode_lengths": [262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5350333525979728, "mean_inference_ms": 24.012985750785283, "mean_action_processing_ms": 0.1341011918291768, "mean_env_wait_ms": 4.349782969241629, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -64.0164239026606, "episode_len_mean": 247.53, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114.11592084914446, -47.831563010811806, -63.184489488601685, -23.510187789797783, -3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159], "episode_lengths": [262, 241, 250, 256, 216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5350333525979728, "mean_inference_ms": 24.012985750785283, "mean_action_processing_ms": 0.1341011918291768, "mean_env_wait_ms": 4.349782969241629, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 221100, "num_env_steps_sampled": 48128, "num_env_steps_trained": 221100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 48128, "agent_timesteps_total": 48128, "timers": {"training_iteration_time_ms": 351.305, "learn_time_ms": 71.839, "learn_throughput": 4176.03, "synch_weights_time_ms": 20.789}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 221100, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 221100, "last_target_update_ts": 48128, "num_target_updates": 93}, "done": false, "episodes_total": 170, "training_iteration": 47, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-28-40", "timestamp": 1655494120, "time_this_iter_s": 5.710400819778442, "time_total_s": 249.60329151153564, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 249.60329151153564, "timesteps_since_restore": 0, "iterations_since_restore": 47, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.1125, "ram_util_percent": 63.7625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 12.863760948181152, "min_q": -27.331594467163086, "max_q": 38.155738830566406, "mean_td_error": -0.3437636196613312}, "td_error": [2.9335289001464844, 1.1614913940429688, 0.7222540378570557, -1.7984466552734375, 0.3117408752441406, 0.30922555923461914, -0.08852720260620117, -0.2817821502685547, 1.2568397521972656, 0.40525245666503906, -1.3009891510009766, -5.657346725463867, -1.7761971950531006, 0.7077960968017578, -10.02837085723877, -1.4307594299316406, 0.9523320198059082, 1.6468324661254883, -0.5508766174316406, 0.8108377456665039, -0.07700347900390625, 0.9627914428710938, 0.9814624786376953, -0.25317955017089844, 1.3403739929199219, 0.5895872116088867, 1.7258796691894531, -10.336259841918945, -0.46642112731933594, -0.08852720260620117, -3.3166027069091797, -0.2758932113647461, -7.932121276855469, 1.1326074600219727, 1.3557977676391602, 0.3832817077636719, -0.40728139877319336, 0.3975715637207031, 0.7228293418884277, 1.1333179473876953, 0.6976556777954102, 0.1552906036376953, 1.1525611877441406, 1.0099048614501953, 0.19601678848266602, 0.5733222961425781, 0.15954017639160156, 0.4763188362121582, 0.7483329772949219, -0.9292201995849609, 0.24507713317871094, 0.4738616943359375, 0.022832870483398438, -2.8162102699279785, -3.122694492340088, 1.2527828216552734, 0.5373802185058594, -0.46732139587402344, 0.33172130584716797, -2.9207191467285156, 0.8993501663208008, -0.6642227172851562, -10.764144897460938, -0.6457014083862305, 0.5911912322044373, 1.9649133682250977, -0.9979486465454102, -0.2919163703918457, 0.7194614410400391, -1.163869857788086, -0.2835416793823242, -4.585163116455078, -0.1025848388671875, -1.0973601341247559, -0.6173057556152344, 0.3799858093261719, -1.0297698974609375, 0.6667230129241943, 0.13562393188476562, 1.466897964477539, -0.38553428649902344, 0.5534472465515137, 0.5337486267089844, -0.5854911804199219, -1.4975481033325195, 0.3710455894470215, -5.669178485870361, 1.0161819458007812, 0.22474384307861328, 0.22812175750732422, -5.143694877624512, 1.3115463256835938, -0.0015583038330078125, -4.001352310180664, -0.8705158233642578, 0.8785562515258789, -0.1823568344116211, -9.51595687866211, -0.6395606994628906, 1.1249198913574219, -0.2989311218261719, 8.083325386047363, 0.45283937454223633, 0.3549690246582031, -0.3010282516479492, 0.7072372436523438, -0.28632688522338867, -0.9271676540374756, 0.9998483657836914, 0.49934959411621094, -0.3803901672363281, 3.297740936279297, 0.5003681182861328, 0.9352931976318359, 0.23619842529296875, -0.47083234786987305, 0.8461723327636719, 0.27388954162597656, 0.9798583984375, -0.35747623443603516, 1.0291290283203125, -0.8064384460449219, 0.9126501083374023, 1.0775032043457031, -0.6650705337524414, -0.3014850616455078, -1.2801628112792969, -0.25777459144592285, 0.06658554077148438, -0.7171134948730469, -0.32537269592285156, -0.03433513641357422, -0.1475391387939453, 0.5691947937011719, -1.2174782752990723, -8.765573501586914, 0.27065086364746094, -7.360174655914307, 0.2474689483642578, -0.06046789884567261, 0.21083450317382812, 0.0654134750366211, 0.756009578704834, 2.5478954315185547, 1.0172414779663086, 0.9680824279785156, 0.6858835220336914, 1.1479315757751465, 0.33771753311157227, 0.9858188629150391, -0.09732627868652344, -0.8842248916625977, -0.5375423431396484, 0.5510807037353516, -0.2509346008300781, -0.8226642608642578, 1.1937999725341797, -0.15303421020507812, -0.6475987434387207, -0.13840389251708984, 0.5893402099609375, 0.13843631744384766, 0.1811695098876953, 0.7367353439331055, 0.7958946228027344, 0.4471311569213867, -0.4527168273925781, -0.5625705718994141, -0.45171213150024414, 0.07343435287475586, -0.3288111686706543, 1.3583660125732422, -6.753423690795898, 0.43792152404785156, 1.5340576171875, -2.988948345184326, 0.444002628326416, -0.22003173828125, -0.9455080032348633, -0.8713312149047852, -0.9518280029296875, -4.052776336669922, 0.4901299476623535, -0.3243446350097656, -0.7526664733886719, 0.14684247970581055, 1.0219531059265137, -6.622264862060547, -0.8076486587524414, 0.3239631652832031, 0.8163261413574219, 0.2721843719482422, -0.5983905792236328, 0.9468674659729004, 1.337930679321289, -0.60512375831604, -0.7122058868408203, -0.6816539764404297, 1.0289335250854492, 1.0959663391113281, -0.5083332061767578, -0.1771535873413086, -0.11251306533813477, -6.367647171020508, -0.06335115432739258, -0.010162353515625, -9.15804672241211, -4.172328948974609, -0.5144481658935547, 0.6891412734985352, -0.3314962387084961, 0.7261838912963867, 0.32689857482910156, -1.5199756622314453, 0.3731861114501953, -0.03337287902832031, 0.8344154357910156, -0.7038321495056152, -0.3201938271522522, -1.163621425628662, -0.46018123626708984, -0.04641532897949219, 0.4301919937133789, -0.35578155517578125, -0.46159934997558594, -0.8375763893127441, 0.18069839477539062, -0.11211013793945312, 0.37399768829345703, 8.632309913635254, -0.60512375831604, 0.9126501083374023, 0.9253520965576172, 0.21406936645507812, -0.43666648864746094, 0.6842107772827148, -0.3847465515136719, -0.7583317756652832, 0.8178997039794922, 0.2160482406616211, 1.8270201683044434, 0.6827507019042969, -2.1804847717285156, -0.06987571716308594, -0.060115814208984375, 1.0964317321777344, 0.7156591415405273, -0.12571144104003906, -0.0931234359741211, 0.32514476776123047, 1.3318843841552734, -12.999983787536621, -0.48105335235595703, -0.29426276683807373, 1.242034912109375, 0.5227336883544922, -8.836423873901367, -0.9282017946243286, 0.8611636757850647, -0.5611362457275391, 0.9833536148071289, -1.789541244506836, 0.6828727722167969, -0.4446392059326172, 0.5274658203125, 0.39330482482910156, 0.21813106536865234, -0.013528823852539062, 3.0079402923583984, 1.6386432647705078, -0.9417476654052734, 0.4227485656738281, -0.1728363037109375, -0.3698558807373047, 0.29271602630615234, 0.4861421585083008, -0.6886367797851562, 0.6579666137695312, 0.6854496002197266, 0.7667655944824219, 0.843024730682373, 0.4068593978881836, 0.9769706726074219, -0.818812370300293, 1.4531822204589844, 0.2775917053222656, 0.8445377349853516, -0.3218851089477539, -0.8998498916625977, 0.02765655517578125, -1.2477035522460938, 0.25911426544189453, 0.8729352951049805, 0.775894284248352, -1.7187871932983398, 0.3094158172607422, 1.172551155090332, 0.7487049102783203, 0.18434524536132812, -7.146644592285156], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 225900, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 225900, "last_target_update_ts": 49152, "num_target_updates": 95}, "sampler_results": {"episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -65.16955634512007, "episode_len_mean": 248.44, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987], "episode_lengths": [216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5359733774975315, "mean_inference_ms": 24.04000113533842, "mean_action_processing_ms": 0.13439233452157046, "mean_env_wait_ms": 4.354570524636609, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -65.16955634512007, "episode_len_mean": 248.44, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8027868047356606, -17.177434764802456, -137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987], "episode_lengths": [216, 240, 285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5359733774975315, "mean_inference_ms": 24.04000113533842, "mean_action_processing_ms": 0.13439233452157046, "mean_env_wait_ms": 4.354570524636609, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 225900, "num_env_steps_sampled": 49152, "num_env_steps_trained": 225900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 49152, "agent_timesteps_total": 49152, "timers": {"training_iteration_time_ms": 351.953, "learn_time_ms": 69.789, "learn_throughput": 4298.673, "synch_weights_time_ms": 21.888}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 225900, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 225900, "last_target_update_ts": 49152, "num_target_updates": 95}, "done": false, "episodes_total": 174, "training_iteration": 48, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-28-46", "timestamp": 1655494126, "time_this_iter_s": 5.736571311950684, "time_total_s": 255.33986282348633, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 255.33986282348633, "timesteps_since_restore": 0, "iterations_since_restore": 48, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.425, "ram_util_percent": 63.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 13.231391906738281, "min_q": -27.937515258789062, "max_q": 42.987972259521484, "mean_td_error": -0.28657013177871704}, "td_error": [-1.3508468866348267, -1.1575813293457031, -0.8508322238922119, -7.135309219360352, -5.783494472503662, -0.2865123748779297, -0.2553234100341797, 0.7945671081542969, -0.48134708404541016, -0.2630481719970703, 0.5834560394287109, 1.4797935485839844, 1.053126335144043, 0.3802156448364258, 2.0068702697753906, 0.23955535888671875, -0.41636180877685547, 0.5002017021179199, 1.125387191772461, 0.38377857208251953, 0.9149036407470703, -0.49680328369140625, 0.20826244354248047, 0.4919877052307129, 0.374481201171875, -0.3087596893310547, 0.22217559814453125, 3.379589080810547, -0.2513422966003418, 0.9395856857299805, -6.700828552246094, 0.012048721313476562, 0.11011314392089844, -6.445797443389893, -0.5148382186889648, -0.7325286865234375, -0.25325465202331543, -0.043140411376953125, -0.37903594970703125, 1.1903352737426758, 0.7915382385253906, 4.028437614440918, 0.6102712154388428, 0.3845996856689453, -0.26279497146606445, 0.1722087860107422, -0.7581825256347656, -0.8353748321533203, -0.1786956787109375, 0.4191102981567383, 0.02085113525390625, 0.008434772491455078, 0.627202033996582, 0.6572365760803223, -1.1726174354553223, -0.20561599731445312, -1.8075313568115234, 0.7395658493041992, 0.7786698341369629, 0.3835868835449219, 0.34389781951904297, -4.362850189208984, 0.8587818145751953, 0.7945671081542969, -1.2126502990722656, -1.0571317672729492, -0.9358385801315308, 0.1279306411743164, 0.8095321655273438, 1.7475776672363281, -0.42722320556640625, 1.2446880340576172, 0.887056827545166, 0.5387287139892578, -0.45221662521362305, 0.5833530426025391, 0.9903361797332764, 0.053353965282440186, 0.5599689483642578, 0.28185272216796875, -0.2675771713256836, -0.910059928894043, 0.49828147888183594, 0.6569480895996094, 10.080144882202148, 0.9805774688720703, -5.964047431945801, -0.6490144729614258, -0.46643829345703125, 0.5990257263183594, -9.447465896606445, -0.30275726318359375, -0.3061065673828125, 0.8577351570129395, -0.8275675773620605, -0.22675609588623047, 0.36217808723449707, 0.5286693572998047, -0.4892578125, 1.568563461303711, 0.1324625015258789, -1.9531307220458984, -3.0465259552001953, 0.6267049312591553, 1.6120033264160156, 0.2071361541748047, -5.911266326904297, 0.2187519073486328, -0.4061717987060547, -1.027608871459961, -2.9763450622558594, -1.0655516386032104, -5.8779096603393555, 0.27048301696777344, -1.6341619491577148, -6.979947090148926, 0.054100990295410156, -0.18843746185302734, 0.8278532028198242, 18.48835563659668, 14.203991889953613, -9.69472599029541, 0.21599960327148438, -0.00489044189453125, -1.461165428161621, -1.056119680404663, -0.49805641174316406, -1.8551297187805176, 0.7354507446289062, -0.02731037139892578, 0.46397972106933594, -7.85374641418457, 0.20641517639160156, -6.231832504272461, 0.025298118591308594, 0.7144317626953125, -1.0910015106201172, 0.40070533752441406, -2.1272125244140625, 0.6204771995544434, 1.986328125, 0.2473907470703125, 0.4404010772705078, 1.220489501953125, 0.07854366302490234, -0.4984416961669922, 0.1913890838623047, -1.2945518493652344, -7.1784820556640625, -0.6557826995849609, 0.9133415222167969, -1.6292533874511719, 3.5178451538085938, -1.0297660827636719, -0.19708633422851562, 0.20810508728027344, -0.3446989059448242, 0.7436256408691406, 0.11364173889160156, 0.4642009735107422, -1.7629890441894531, 0.5662784576416016, 0.3954744338989258, -0.23257207870483398, -0.427764892578125, -0.9897546768188477, 1.9290199279785156, -0.818023681640625, 1.7298030853271484, -1.245208740234375, -1.523702621459961, -0.8722038269042969, 1.2625598907470703, 1.3431169986724854, 0.7978954315185547, 0.8130360841751099, -1.5634269714355469, -0.6528596878051758, -10.751955032348633, 0.12684249877929688, 0.26865625381469727, -7.580310344696045, -0.04636955261230469, -0.955510139465332, -1.2569427490234375, 1.121978759765625, -1.3133201599121094, 0.6803150177001953, 2.6680850982666016, -1.1176118850708008, 0.6549158096313477, -2.6366329193115234, -0.290069580078125, -0.029958724975585938, -10.617860794067383, 8.35366439819336, -0.249664306640625, -0.7297220230102539, 0.4663045406341553, -1.6483097076416016, 0.42237091064453125, -0.7817707061767578, -1.3854074478149414, -0.43575477600097656, 3.37526798248291, -0.4814724922180176, 1.986328125, 0.7812356948852539, -1.5234160423278809, 0.29859352111816406, -0.7012481689453125, 0.3315248489379883, -0.647125244140625, -1.3125972747802734, 0.5488615036010742, -0.31636571884155273, 0.16278553009033203, -1.2496395111083984, 1.2211275100708008, -2.6209592819213867, 0.5632686614990234, 0.4978923797607422, -0.2750701904296875, -1.561759114265442, -0.3228893280029297, -0.1103677749633789, -0.09377288818359375, -0.22675609588623047, -0.7408857345581055, 0.4660758972167969, -0.36370372772216797, -0.7624778747558594, 0.3429884910583496, 0.18062782287597656, 0.8923244476318359, 0.21719253063201904, -1.7178263664245605, -0.8853912353515625, 1.006143569946289, -6.59489631652832, -0.42807579040527344, 0.3591136932373047, 1.986328125, 0.9185018539428711, 0.6172895431518555, 6.095070838928223, -0.48905038833618164, -0.9527015686035156, 0.6431121826171875, -0.26453399658203125, -1.7900562286376953, -0.18003559112548828, 2.695432662963867, -2.543437957763672, 0.36801910400390625, 0.6858940124511719, 0.3421363830566406, -0.31513404846191406, 2.715822219848633, 0.18170320987701416, -2.0053324699401855, 0.33300256729125977, 0.5546951293945312, -0.6838893890380859, -1.6963367462158203, 0.23834705352783203, -9.25996208190918, 0.42290306091308594, -5.770097732543945, 0.4229240417480469, -0.5326833724975586, 18.154186248779297, 0.4607257843017578, -0.44154787063598633, -1.796391487121582, -0.5284748077392578, -0.3442544937133789, 0.2886848449707031, 0.9506072998046875, 0.35573768615722656, 0.9074125289916992, -0.9507975578308105, -1.9977302551269531, -0.5392637252807617, -1.027608871459961, -0.7210369110107422, -0.8167705535888672, -0.03626441955566406, 0.44453001022338867, 0.3357715606689453, -4.362850189208984, -0.5082645416259766, -0.770751953125, -1.1908249855041504, -0.4224420189857483, 0.10176849365234375, -0.7084684371948242, 1.7186508178710938, -0.0651397705078125, -5.864185333251953], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 230700, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 230700, "last_target_update_ts": 50176, "num_target_updates": 97}, "sampler_results": {"episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -68.55314585827291, "episode_len_mean": 249.6, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164], "episode_lengths": [285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5367531386165468, "mean_inference_ms": 24.053315731098404, "mean_action_processing_ms": 0.1342385648252959, "mean_env_wait_ms": 4.362103234928614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -68.55314585827291, "episode_len_mean": 249.6, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-137.0893982425332, -268.9999786987901, -106.40599754452705, -114.80699863284826, 10.400000244379044, -80.34175735712051, 23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164], "episode_lengths": [285, 336, 270, 303, 235, 266, 203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5367531386165468, "mean_inference_ms": 24.053315731098404, "mean_action_processing_ms": 0.1342385648252959, "mean_env_wait_ms": 4.362103234928614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 230700, "num_env_steps_sampled": 50176, "num_env_steps_trained": 230700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 50176, "agent_timesteps_total": 50176, "timers": {"training_iteration_time_ms": 341.899, "learn_time_ms": 69.93, "learn_throughput": 4290.029, "synch_weights_time_ms": 21.089}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 230700, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 230700, "last_target_update_ts": 50176, "num_target_updates": 97}, "done": false, "episodes_total": 176, "training_iteration": 49, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-28-52", "timestamp": 1655494132, "time_this_iter_s": 5.505014181137085, "time_total_s": 260.8448770046234, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 260.8448770046234, "timesteps_since_restore": 0, "iterations_since_restore": 49, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.2125, "ram_util_percent": 64.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 13.667333602905273, "min_q": -26.603981018066406, "max_q": 42.41204833984375, "mean_td_error": -0.5032681226730347}, "td_error": [-0.38346290588378906, -6.857082366943359, -0.6094570159912109, 0.11293411254882812, 0.017789840698242188, 0.0006389617919921875, -0.03525733947753906, -0.17720603942871094, 0.5032444000244141, -1.1604366302490234, 0.2361602783203125, 0.30283164978027344, -0.77978515625, -2.255645751953125, -0.7599983215332031, 2.7522687911987305, -1.750091552734375, -7.850263595581055, 6.780019760131836, -2.8243446350097656, -0.3303704261779785, 0.13063812255859375, 0.010034561157226562, 0.2219696044921875, -4.68510627746582, -1.8602356910705566, -0.2628898620605469, 0.2438058853149414, -0.43111610412597656, 0.023827552795410156, -0.6909103393554688, 0.9069728851318359, 0.619321346282959, -0.08739948272705078, -0.9334912300109863, 1.0060303211212158, -0.1751415729522705, -0.6104602813720703, -0.6530370712280273, 0.4782588481903076, 0.4588623046875, -0.9890880584716797, -0.7144088745117188, 0.48632287979125977, -0.9439849853515625, -0.049292564392089844, 0.30835914611816406, -0.7967839241027832, -1.9177436828613281, -0.861328125, -0.3013601303100586, -0.32132530212402344, -0.5609130859375, -1.7367801666259766, -0.9876365661621094, 0.18634939193725586, 0.664069652557373, -0.36715126037597656, -0.8721504211425781, 0.483428955078125, -0.6727352142333984, -0.5446376800537109, -1.212249755859375, -2.3172245025634766, 0.5051894187927246, -0.31522369384765625, -8.659292221069336, -0.1248025894165039, 0.06659698486328125, 6.06743860244751, 1.9130134582519531, -2.1411476135253906, 0.4782588481903076, -0.10329532623291016, -2.016179084777832, 0.25191307067871094, 0.6618480682373047, -1.2062740325927734, -0.8444662094116211, 0.8285255432128906, 0.3058910369873047, -0.16071653366088867, 0.4540243148803711, -0.3619718551635742, -2.8960723876953125, -0.30045127868652344, 0.1360400915145874, -1.9054679870605469, -0.9292681217193604, -0.7922000885009766, -6.124763488769531, 0.09734916687011719, -0.3658275604248047, 0.1257920265197754, -0.22389793395996094, -6.356456756591797, 0.10653114318847656, 1.6625385284423828, -1.251556396484375, -2.9638595581054688, -3.0298500061035156, -0.8474669456481934, -0.43567657470703125, -5.8907012939453125, -0.3822755813598633, 0.21984481811523438, 0.8911170959472656, -0.9137922525405884, -0.9550228118896484, -0.3242473602294922, 0.12225532531738281, -5.626283645629883, -0.6366539001464844, -0.7932224273681641, 1.112192153930664, -0.5938386917114258, 2.0499582290649414, -0.05004692077636719, -0.12802982330322266, -0.4496769905090332, 0.1423257291316986, -0.04453468322753906, -0.06526947021484375, 0.044124603271484375, -1.611741542816162, -1.3617019653320312, 13.954689979553223, 1.1627063751220703, -0.770850658416748, -0.00020694732666015625, -0.041155099868774414, 0.14714539051055908, 0.6879971027374268, -0.5823068618774414, -0.30750465393066406, -0.23514175415039062, -1.101943016052246, -0.022497177124023438, 4.652290344238281, 0.312807559967041, -4.458906173706055, 0.6076726913452148, -0.01568317413330078, -0.04945087432861328, 0.30782318115234375, 0.5027923583984375, -0.6192684173583984, -0.6874594688415527, 0.48632287979125977, -0.8928661346435547, 0.035117149353027344, -2.1879844665527344, 9.14794921875, 0.8552393913269043, -1.578033447265625, -2.2324180603027344, -0.8036823272705078, -0.13625383377075195, -0.7776203155517578, -4.7469482421875, -2.241790771484375, -0.03753376007080078, -0.39033985137939453, -1.2314958572387695, -0.24583053588867188, 0.0744466781616211, 0.8854045867919922, 0.2864341735839844, -2.3124771118164062, -1.2805633544921875, -1.808685302734375, -0.35982704162597656, 0.0747227668762207, 0.5142555236816406, -0.6122870445251465, -0.29586219787597656, -0.3119392395019531, -0.9526767730712891, 0.9856986999511719, -1.1353302001953125, 0.7842950820922852, -1.3267021179199219, -0.5854272842407227, 0.8571376800537109, -0.4331321716308594, 0.9069728851318359, 3.0503814220428467, -0.2817955017089844, -0.16944122314453125, 0.04444313049316406, -6.325075149536133, -1.1193065643310547, -0.2436046600341797, -0.39295101165771484, 1.7214698791503906, -1.2869796752929688, -0.4875774383544922, -0.023613929748535156, -0.2020435333251953, -0.6773300170898438, -3.9736461639404297, -0.12977027893066406, 8.647635459899902, -0.0965888500213623, -1.6058712005615234, -1.0453405380249023, -10.469493865966797, -0.450225830078125, 8.039026260375977, -0.5320978164672852, -1.1459026336669922, -0.720003604888916, -0.8401660919189453, 1.731475830078125, -1.930938720703125, 0.9774894714355469, -0.19448184967041016, -7.4772539138793945, -1.6415047645568848, -0.7065906524658203, 1.4026498794555664, -0.3426017761230469, 0.634070873260498, -0.3022298812866211, -0.36598634719848633, -1.0193977355957031, -0.8751052618026733, -0.18192481994628906, -0.3977780342102051, 6.333622932434082, -0.6163530349731445, -0.4405803680419922, -1.0136423110961914, -0.5505180358886719, -0.571385383605957, -0.6915321350097656, -0.0767364501953125, -0.7939643859863281, -0.4899778366088867, -1.3993721008300781, 0.32781344652175903, -0.36373329162597656, -0.5506591796875, -1.1663103103637695, -0.21109771728515625, 1.407552719116211, -5.01378059387207, 1.1527060270309448, -2.352142333984375, -1.4254932403564453, -1.4868361949920654, -0.053302764892578125, -1.2125539779663086, 0.06302452087402344, -3.760627269744873, 1.8252220153808594, -0.8786354064941406, -0.4766712188720703, -0.5444431304931641, -2.8137292861938477, 1.6334047317504883, -0.5113010406494141, -0.6124496459960938, -1.1189899444580078, -0.29920196533203125, 0.04938364028930664, -0.37037134170532227, 0.10346412658691406, -0.031579017639160156, -0.8378047943115234, -2.574115753173828, -4.242162704467773, -1.2571258544921875, -1.1831302642822266, -0.3131074905395508, 0.3290977478027344, -0.6239643096923828, -0.7143707275390625, -0.7634439468383789, -0.20573174953460693, -0.11569499969482422, -0.9233541488647461, -0.05730438232421875, -0.3880786895751953, 0.611968994140625, 0.48172521591186523, -0.6430240869522095, 0.6646194458007812, -0.8822116851806641, 0.1319446563720703, -9.720207214355469, -1.2257061004638672, -0.4763493537902832, -1.4583659172058105, -0.864532470703125, -0.6295442581176758, -0.055266380310058594, -0.8956003189086914, -0.6460962295532227, -0.1792888641357422], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 235500, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 235500, "last_target_update_ts": 51200, "num_target_updates": 99}, "sampler_results": {"episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -65.46867080464959, "episode_len_mean": 247.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105], "episode_lengths": [203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5383500379303088, "mean_inference_ms": 24.078970594454994, "mean_action_processing_ms": 0.13381731032963176, "mean_env_wait_ms": 4.368743916022441, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 32.411537662148476, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -65.46867080464959, "episode_len_mean": 247.75, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.85626193881035, 21.001945666968822, 25.369419291615486, 26.176207274198532, -0.6893648058176041, 9.500000149011612, -7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105], "episode_lengths": [203, 228, 216, 230, 238, 219, 228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5383500379303088, "mean_inference_ms": 24.078970594454994, "mean_action_processing_ms": 0.13381731032963176, "mean_env_wait_ms": 4.368743916022441, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 235500, "num_env_steps_sampled": 51200, "num_env_steps_trained": 235500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 51200, "agent_timesteps_total": 51200, "timers": {"training_iteration_time_ms": 360.792, "learn_time_ms": 70.975, "learn_throughput": 4226.82, "synch_weights_time_ms": 21.089}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 235500, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 235500, "last_target_update_ts": 51200, "num_target_updates": 99}, "done": false, "episodes_total": 182, "training_iteration": 50, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-28-58", "timestamp": 1655494138, "time_this_iter_s": 5.704303026199341, "time_total_s": 266.54918003082275, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 266.54918003082275, "timesteps_since_restore": 0, "iterations_since_restore": 50, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.51111111111111, "ram_util_percent": 64.16666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 13.407145500183105, "min_q": -19.821552276611328, "max_q": 43.16714859008789, "mean_td_error": -1.299712896347046}, "td_error": [-2.8310813903808594, -0.0330967903137207, -2.033782482147217, -0.6972684860229492, -1.4840354919433594, -2.0963516235351562, -1.0615234375, -1.9871025085449219, -1.3612985610961914, -1.1301703453063965, -0.6475410461425781, -0.9257297515869141, -1.6462154388427734, -1.1094417572021484, -0.2822437286376953, -3.2422103881835938, -0.011217117309570312, -1.3959636688232422, -2.308279037475586, -0.2668447494506836, 0.5463676452636719, -1.2205803394317627, -0.9983921051025391, -1.6614398956298828, -3.5766220092773438, -0.9433784484863281, -1.1881122589111328, 1.6605091094970703, -1.2198762893676758, -1.4753131866455078, -1.8171181678771973, -1.0310306549072266, -1.2801322937011719, -0.29216575622558594, -0.4801807403564453, -0.8883581161499023, -0.5526523590087891, -1.3802471160888672, -0.08353996276855469, -0.4410219192504883, -1.0390338897705078, -0.7134189605712891, -2.972318649291992, 0.6183154582977295, -1.019704818725586, -0.6293754577636719, -1.3143272399902344, -0.08353996276855469, -1.0216598510742188, -1.435598373413086, -0.950291633605957, -1.2353019714355469, -1.7381782531738281, -1.7289180755615234, -6.902593612670898, -0.4090089797973633, -1.2627363204956055, -0.14687156677246094, -1.1408920288085938, -1.188446044921875, -5.971691131591797, -7.058818817138672, -0.16263961791992188, -0.9863929748535156, -2.225353240966797, -1.16249418258667, -1.7074317932128906, -2.6549758911132812, -0.640472412109375, 1.027099370956421, -8.968368530273438, -1.0677642822265625, 0.32184696197509766, -0.9862880706787109, -0.924748420715332, -0.15271949768066406, -1.4424347877502441, -0.6370115280151367, 9.478646278381348, -5.72953987121582, -1.2124614715576172, -0.49869346618652344, -1.1780166625976562, -1.4554128646850586, -6.983926773071289, -1.0816459655761719, 0.6062231063842773, -1.8738822937011719, -0.5267105102539062, -0.19025421142578125, -1.3248653411865234, -11.373600959777832, -2.380549430847168, -8.790277481079102, -0.6843070983886719, -1.00860595703125, 0.5107631683349609, 0.7301421165466309, -1.4109039306640625, -1.4035773277282715, -0.4262967109680176, -0.5738239288330078, -0.8084540367126465, -1.8663654327392578, -1.3090524673461914, 0.371612548828125, -0.5906605124473572, -0.6281261444091797, -1.6865367889404297, -0.3089447021484375, -1.4166755676269531, 0.5170803070068359, -0.18026018142700195, 0.16499567031860352, -0.5719156265258789, -0.6405963897705078, -1.5315351486206055, -0.20958328247070312, -1.064352035522461, -1.2041778564453125, -1.0777320861816406, -1.8225975036621094, 0.3475980758666992, -0.3799877166748047, 0.8936663866043091, 0.005457878112792969, -0.8131313323974609, 0.08456611633300781, -7.74055290222168, 0.47545814514160156, -1.1208677291870117, -0.8420124053955078, -0.5680294036865234, -1.3710975646972656, -0.19434881210327148, -0.6355524063110352, -1.6082611083984375, -1.3668394088745117, -0.5521336197853088, 1.1689453125, -1.8569526672363281, -1.4243927001953125, -1.058631420135498, -0.5056018829345703, -1.3451595306396484, 0.9838910102844238, -1.4129047393798828, -4.955855369567871, 0.592803955078125, -1.5816268920898438, -0.8972806930541992, -1.4141502380371094, 0.6519813537597656, -1.258932113647461, -1.6607666015625, -2.1998729705810547, -1.7182083129882812, 0.522972583770752, -1.0283203125, -1.2180824279785156, -0.6252756118774414, -0.6768360137939453, 0.5806436538696289, -0.8853840827941895, -1.419149398803711, -5.755633354187012, 0.3639240264892578, -0.2088942527770996, -1.1054730415344238, -2.972318649291992, -1.2469406127929688, -0.9975948333740234, -2.157512664794922, -0.4571876525878906, -0.815035343170166, -0.31319427490234375, -1.739736557006836, -0.7880535125732422, -0.6449947357177734, -1.7230186462402344, -0.5058670043945312, -2.387563705444336, 1.8141436576843262, 0.32184696197509766, -0.9983921051025391, -2.0005855560302734, -1.2809867858886719, -1.0108814239501953, -0.25029468536376953, -0.010009407997131348, -2.2066116333007812, -0.5640068054199219, 0.058240413665771484, -1.395242691040039, -1.2195816040039062, -1.32513427734375, -0.1576836109161377, -0.362823486328125, -1.415273666381836, -1.2863941192626953, -1.8593158721923828, -9.14737319946289, -2.2962112426757812, -1.492818832397461, -2.0291147232055664, -1.367121696472168, -1.1811094284057617, -0.49117279052734375, -0.08317971229553223, -0.8882293701171875, -1.2862701416015625, -0.2468576431274414, -3.091989517211914, 0.4313652515411377, -1.4609737396240234, 1.032463550567627, 1.027099370956421, -1.1257286071777344, -1.2126483917236328, -0.7929720878601074, -0.6116676330566406, -0.5417995452880859, 0.9970407485961914, -0.7965621948242188, -0.0016584396362304688, -0.9855928421020508, -1.2386856079101562, -9.279054641723633, 0.24596881866455078, -0.9832448959350586, -1.3649616241455078, 0.19992923736572266, -0.028191566467285156, 0.023738384246826172, -0.4382801055908203, -9.231657981872559, -1.226241111755371, 0.2590484619140625, -2.5132408142089844, -0.3651695251464844, -1.7562570571899414, -0.8900766372680664, -1.187058448791504, 0.18820977210998535, -0.8384132385253906, -7.331435680389404, 0.02029132843017578, -1.0328445434570312, -1.2234916687011719, 0.1449909210205078, -1.1243934631347656, -2.8651962280273438, 0.03217506408691406, -0.022551536560058594, -1.0381221771240234, 0.14903831481933594, 0.44738197326660156, -0.6475629806518555, -0.8157196044921875, -1.2625083923339844, -2.0820541381835938, -1.0328445434570312, -3.2425174713134766, -1.6610755920410156, -0.9268178939819336, 1.862532615661621, -1.2834339141845703, -0.6544399261474609, -10.54723072052002, -1.172271728515625, -0.36228275299072266, -0.6757402420043945, -0.7062177658081055, -0.9944095611572266, -11.113526344299316, -1.6917572021484375, -1.96343994140625, -0.6126880645751953, -1.3706426620483398, -0.8727130889892578, -1.858346939086914, -1.2702980041503906, -1.688873291015625, -1.0756239891052246, -1.9378318786621094, -2.6353893280029297, -0.7317843437194824, -1.5232925415039062, -1.0746269226074219, -0.8570661544799805, -1.9147987365722656, -1.2884950637817383, -0.4640498161315918, -1.304372787475586, -8.248640060424805, -1.935624122619629, -1.1964702606201172, -0.3339681625366211, -2.7410411834716797, -0.22603273391723633], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 240300, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 240300, "last_target_update_ts": 52224, "num_target_updates": 101}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -67.48722032092512, "episode_len_mean": 248.62, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812], "episode_lengths": [228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5389229531741704, "mean_inference_ms": 24.119116216615645, "mean_action_processing_ms": 0.1338763475417562, "mean_env_wait_ms": 4.378010296274532, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -67.48722032092512, "episode_len_mean": 248.62, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.9000000059604645, -21.337735794484615, -125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812], "episode_lengths": [228, 245, 239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5389229531741704, "mean_inference_ms": 24.119116216615645, "mean_action_processing_ms": 0.1338763475417562, "mean_env_wait_ms": 4.378010296274532, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 240300, "num_env_steps_sampled": 52224, "num_env_steps_trained": 240300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 52224, "agent_timesteps_total": 52224, "timers": {"training_iteration_time_ms": 368.815, "learn_time_ms": 68.857, "learn_throughput": 4356.831, "synch_weights_time_ms": 21.49}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 240300, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 240300, "last_target_update_ts": 52224, "num_target_updates": 101}, "done": false, "episodes_total": 188, "training_iteration": 51, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-29-03", "timestamp": 1655494143, "time_this_iter_s": 5.781148910522461, "time_total_s": 272.3303289413452, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 272.3303289413452, "timesteps_since_restore": 0, "iterations_since_restore": 51, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 35.55, "ram_util_percent": 64.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 13.964550971984863, "min_q": -28.165058135986328, "max_q": 40.85400390625, "mean_td_error": -0.06452853232622147}, "td_error": [1.2974014282226562, 0.07921648025512695, -1.6972752809524536, -1.0823278427124023, -6.178871154785156, 2.668926477432251, 1.3691787719726562, 3.929262161254883, 0.9508914947509766, -0.4348735809326172, 0.7610206604003906, -1.0166234970092773, 2.1977243423461914, -0.3787088394165039, -1.3428497314453125, -0.9029884338378906, -1.1633739471435547, -1.6226768493652344, 1.3664703369140625, 1.7045469284057617, 0.5447845458984375, -1.702016830444336, 0.19989013671875, -2.7057852745056152, -0.6279659271240234, 0.6442317962646484, 0.1783905029296875, 0.08583831787109375, -4.513359069824219, 0.49782276153564453, -0.4974508285522461, 1.6529407501220703, 0.5313138961791992, 0.34214019775390625, 1.166616439819336, 1.6895370483398438, -1.431100845336914, -0.9357681274414062, 1.2186646461486816, 1.3544731140136719, 0.048004150390625, 1.4754467010498047, 0.5032637119293213, -0.46439170837402344, -0.2078857421875, -8.461884498596191, 1.0215539932250977, 1.927596092224121, 2.0399255752563477, 1.5090088844299316, -1.007150650024414, 2.666532516479492, -1.3505077362060547, 1.2606420516967773, 2.2191295623779297, -0.3031291961669922, 0.32341766357421875, -1.8829336166381836, 2.0672860145568848, 18.174734115600586, 0.018759727478027344, 2.078841209411621, 0.0024213790893554688, 1.5334863662719727, 1.5857315063476562, 1.9212617874145508, 1.693552017211914, -2.1301403045654297, -1.3530311584472656, 2.190804958343506, 1.5628185272216797, -1.3687820434570312, 1.096764087677002, -6.74749755859375, 2.5562081336975098, -0.35553550720214844, 2.384765625, 0.547480583190918, 0.5520229339599609, -1.1297626495361328, -5.99188232421875, 1.6895370483398438, 0.8593578338623047, 0.14522552490234375, 2.455728054046631, 1.3526725769042969, -1.4250469207763672, -4.304325103759766, 5.012454032897949, -0.23313140869140625, 0.8618841171264648, -0.1637401580810547, 3.4799156188964844, 0.07748532295227051, -2.1246814727783203, -1.0974292755126953, 1.0513172149658203, 10.879032135009766, 1.5983524322509766, 0.08724594116210938, 1.4361591339111328, -0.11377286911010742, 0.6017351150512695, -1.7364253997802734, 4.07737922668457, 2.245786666870117, -1.1517972946166992, -1.1489543914794922, -0.3125119209289551, -0.1020669937133789, 1.1617050170898438, 0.036728858947753906, 3.2385501861572266, 0.029693603515625, 1.8972649574279785, -0.7496242523193359, -1.448160171508789, 0.8246307373046875, 0.1763744354248047, -1.806142807006836, -0.8868398666381836, 2.1428375244140625, -1.7989387512207031, -1.0213241577148438, -0.01974010467529297, -0.42763519287109375, 0.5140151977539062, -0.5243325233459473, -1.306227684020996, 2.574246406555176, 0.9515142440795898, 1.4489288330078125, 1.7882146835327148, -0.11486244201660156, -1.2313013076782227, 2.1943016052246094, -1.5864582061767578, 0.4969615936279297, -4.276487350463867, -2.7462158203125, -0.7371292114257812, -0.6611037254333496, -1.3767166137695312, -0.3103599548339844, -0.7929191589355469, 2.452970504760742, 1.198185920715332, -0.3800468444824219, -1.253666877746582, -2.2585182189941406, 1.06689453125, -0.521878719329834, 0.9850425720214844, -1.0186152458190918, 0.8476600646972656, 3.9874324798583984, 0.8738899230957031, -0.0958719253540039, -1.6666126251220703, 1.410013198852539, -1.8957233428955078, 1.0487499237060547, -1.5121936798095703, 3.697935104370117, -1.0347537994384766, -0.0920863151550293, 0.3442649841308594, 3.302175521850586, 3.6456737518310547, -1.329824447631836, 1.8315792083740234, 1.0451889038085938, -1.7939834594726562, 0.8532180786132812, 0.3917374610900879, -0.7955312728881836, -5.899633407592773, -0.7766685485839844, -0.9881381988525391, 0.75555419921875, -0.5260324478149414, 1.166616439819336, 1.2446479797363281, 1.4286689758300781, -0.15664100646972656, 1.5209541320800781, 0.9169855117797852, 0.14839649200439453, -0.5101814270019531, 1.4720268249511719, -1.29937744140625, -1.1326379776000977, 0.29255008697509766, 1.3164687156677246, 0.08868408203125, 2.5865297317504883, -10.146706581115723, -1.669290542602539, 3.195490837097168, 0.5124320983886719, -4.51390266418457, 1.1175332069396973, -0.9433784484863281, -0.7809925079345703, -0.02973651885986328, 1.7765092849731445, 2.3994483947753906, 0.44202423095703125, -0.8473033905029297, 1.4725112915039062, -15.822466850280762, 1.374826431274414, -1.0540695190429688, -0.7073497772216797, -5.302701950073242, 4.07737922668457, -1.2519416809082031, 1.613525390625, -6.178871154785156, -0.2870779037475586, 0.036251068115234375, -1.4030094146728516, -1.387960433959961, 8.674690246582031, -0.6277065277099609, 1.096764087677002, -19.488285064697266, 1.1061038970947266, 1.9424934387207031, 2.1817941665649414, -6.722162246704102, -0.2237873077392578, -1.0080974102020264, 1.1748409271240234, 1.1506328582763672, -3.23219895362854, -1.2481098175048828, 2.142529010772705, 2.1897659301757812, -10.146706581115723, -5.753826141357422, -0.48199284076690674, -0.43947505950927734, -0.2619771957397461, -0.8063478469848633, -7.954675674438477, -3.122344970703125, 1.8391895294189453, -0.8992595672607422, 0.31652069091796875, -1.9393887519836426, 1.2016239166259766, 0.03515434265136719, 1.2146720886230469, -7.242216110229492, 0.09968161582946777, 0.2873039245605469, 0.47722625732421875, 1.3699779510498047, -1.4983820915222168, -0.733311653137207, 3.9133996963500977, -0.2301950752735138, 1.843968391418457, -0.1425628662109375, 0.6479244232177734, 4.23289680480957, 1.388066291809082, 0.7837553024291992, -3.617025375366211, 2.7177982330322266, -1.023946762084961, 2.1608314514160156, 8.62762451171875, -1.0166234970092773, 1.2002811431884766, 1.7439370155334473, -0.7291049957275391, -8.633406639099121, -0.08846473693847656, 0.2781105041503906, 1.9322547912597656, 0.8498811721801758, -1.5602607727050781, 2.7826876640319824, 0.9282474517822266, 0.7543773651123047, -8.633406639099121, -0.7966499328613281, -7.2467498779296875, 0.521845817565918, 1.3595805168151855, -2.220722198486328, -0.2443075180053711, 0.29468727111816406, -1.4414215087890625, -4.725069046020508, 2.387744903564453, 5.374005317687988, 0.8684368133544922], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 53248, "num_env_steps_trained": 245100, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 245100, "last_target_update_ts": 53248, "num_target_updates": 103}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -68.87003500327468, "episode_len_mean": 249.17, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578], "episode_lengths": [239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5395851809935247, "mean_inference_ms": 24.119854596993136, "mean_action_processing_ms": 0.1340970108284247, "mean_env_wait_ms": 4.376930195608857, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -68.87003500327468, "episode_len_mean": 249.17, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-125.4853918030858, -232.7606334388256, 11.810635656118393, -10.22060589492321, -283.4543705061078, -111.50614011287689, -63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578], "episode_lengths": [239, 302, 207, 241, 297, 277, 270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5395851809935247, "mean_inference_ms": 24.119854596993136, "mean_action_processing_ms": 0.1340970108284247, "mean_env_wait_ms": 4.376930195608857, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 245100, "num_env_steps_sampled": 53248, "num_env_steps_trained": 245100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 53248, "agent_timesteps_total": 53248, "timers": {"training_iteration_time_ms": 338.38, "learn_time_ms": 68.608, "learn_throughput": 4372.638, "synch_weights_time_ms": 20.389}, "counters": {"num_env_steps_sampled": 53248, "num_env_steps_trained": 245100, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 245100, "last_target_update_ts": 53248, "num_target_updates": 103}, "done": false, "episodes_total": 190, "training_iteration": 52, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-29-09", "timestamp": 1655494149, "time_this_iter_s": 5.404752969741821, "time_total_s": 277.73508191108704, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 277.73508191108704, "timesteps_since_restore": 0, "iterations_since_restore": 52, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.174999999999997, "ram_util_percent": 64.17500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.235690116882324, "min_q": -25.421289443969727, "max_q": 39.0740966796875, "mean_td_error": 0.16780008375644684}, "td_error": [0.5291252136230469, 0.05479240417480469, 1.4325618743896484, -0.3358440399169922, -0.5701971054077148, 1.5762090682983398, -0.2013988494873047, -0.7974338531494141, 0.5180606842041016, 0.10457611083984375, 0.3949604034423828, -0.3663177490234375, 0.9755582809448242, 0.26285409927368164, -0.360687255859375, 4.949478626251221, -0.5287103652954102, 0.43192291259765625, -6.553895950317383, 0.10617947578430176, 0.1667957305908203, 0.9207727909088135, -0.09117889404296875, -0.19166326522827148, -0.1743297576904297, 0.12182044982910156, 23.62529182434082, 0.2377777099609375, -0.7767696380615234, -4.405243873596191, 0.4160442352294922, -0.1424875259399414, 0.15935277938842773, 1.0761089324951172, 0.36882781982421875, 16.0285587310791, -0.6481533050537109, -0.5107345581054688, -0.1892991065979004, -0.7940545082092285, -0.1481781005859375, 0.6096186637878418, -0.21872806549072266, -0.3746962547302246, -0.45842552185058594, -0.33962249755859375, 1.7480392456054688, -0.11487197875976562, 0.2387371063232422, 1.7557563781738281, 0.45554018020629883, 0.6254825592041016, 1.264871597290039, 4.809581756591797, 0.1919879913330078, -0.12030410766601562, -0.33191490173339844, 0.956233024597168, 0.6248931884765625, -0.7645626068115234, 0.7553062438964844, -0.2797393798828125, -0.7062085866928101, 0.29172706604003906, 0.09255504608154297, 0.07147789001464844, 0.8927459716796875, -0.6276874542236328, 0.9839954376220703, -0.006397247314453125, -1.1295042037963867, -6.75984001159668, 0.13394546508789062, -9.400690078735352, 3.7659621238708496, 0.09595298767089844, -0.1556873321533203, -0.33356285095214844, 1.415503978729248, 0.3267498016357422, -0.5602607727050781, 1.9463510513305664, 7.131157875061035, -0.6584739685058594, 0.5015172958374023, -0.49110984802246094, -0.30308055877685547, 0.007335662841796875, 0.26537322998046875, -0.22490453720092773, 0.08234405517578125, -0.2808418273925781, 0.13231945037841797, -0.27572059631347656, -0.0236968994140625, -0.3090794086456299, -0.5054988861083984, -0.222625732421875, -1.2978501319885254, 0.2367534637451172, 0.4603719711303711, 0.07328271865844727, 0.12009906768798828, 2.286191940307617, -5.113285541534424, -0.349151611328125, 1.5780324935913086, 1.9240283966064453, 1.459498405456543, 0.8904571533203125, -0.08747100830078125, 0.5654978156089783, 0.055049896240234375, 0.1495199203491211, -0.27357959747314453, 0.5674781799316406, -1.0202264785766602, -0.08862686157226562, -0.2858619689941406, 1.2790765762329102, -1.2636289596557617, 0.1801776885986328, 0.0767822265625, -1.7845935821533203, 0.3578958511352539, -0.2912883758544922, -0.7721118927001953, 0.03929328918457031, 0.3894309997558594, -7.277714729309082, -0.5159854888916016, -6.06776237487793, -0.16951560974121094, 0.3238182067871094, -0.055034637451171875, 1.0268421173095703, 0.39356422424316406, 0.2559843063354492, -1.6990585327148438, -2.2399330139160156, 0.716357946395874, -0.7250728607177734, 0.47489166259765625, 2.038712501525879, -0.23033714294433594, -0.16675662994384766, 0.2019801139831543, 7.266670227050781, 0.1850452423095703, -0.7683877944946289, 1.4789390563964844, -0.16471290588378906, 0.22728538513183594, -5.800559997558594, 1.1566352844238281, -0.2223215103149414, -0.9418163299560547, 1.1597404479980469, -0.6693687438964844, 0.7171058654785156, 0.6347436904907227, 0.9926605224609375, -0.8079918622970581, 0.23112760484218597, 0.07435035705566406, 0.2286815643310547, 1.564732551574707, -0.1251087188720703, 0.611865758895874, -0.5499858856201172, 0.4557523727416992, 1.4565086364746094, -0.21677112579345703, 0.8367500305175781, -0.6151285171508789, 0.2194538116455078, 0.3392457962036133, -4.76927375793457, 0.4914569854736328, 1.1457334756851196, -0.4794645309448242, 0.0767822265625, 0.47283172607421875, 0.24799346923828125, -0.33327293395996094, -0.48625946044921875, -0.4053211212158203, 1.7561779022216797, -0.35688018798828125, 2.651552200317383, -0.5219869613647461, -0.04860496520996094, 0.05324840545654297, 1.4373054504394531, -0.25569915771484375, -0.3742542266845703, 0.2600131034851074, -0.6264533996582031, -0.16353988647460938, -0.084625244140625, -0.6209230422973633, 1.8312873840332031, 0.3507881164550781, 0.2286663055419922, 0.0416259765625, 2.119884490966797, 0.21546030044555664, 0.07505989074707031, -0.15645885467529297, -0.3270530700683594, -0.7990055084228516, 0.0926809310913086, 0.28786277770996094, 0.43192291259765625, 0.4513263702392578, -0.33524131774902344, -28.592378616333008, 0.0053424835205078125, 0.0483245849609375, -1.2882871627807617, -0.42546844482421875, -0.2190084457397461, 1.1231380701065063, 1.1655902862548828, 0.19044852256774902, 0.7614116668701172, 1.0534696578979492, 0.5829381942749023, -0.1398944854736328, -1.0120277404785156, -1.185025691986084, -0.16691207885742188, -0.5022735595703125, 0.064727783203125, -5.99363899230957, -0.4475898742675781, -0.6974620819091797, -0.1892991065979004, -0.33962249755859375, -1.1878890991210938, 0.1887192726135254, -0.3577098846435547, 0.5999479293823242, 0.5812854766845703, -0.6825418472290039, 0.16547393798828125, -0.4720292091369629, -0.9376029968261719, -0.029521465301513672, 0.14192485809326172, 0.23118972778320312, 0.11423587799072266, 0.18315887451171875, 0.22940731048583984, 0.15500354766845703, -0.17546844482421875, -0.5511665344238281, 0.2571449279785156, -0.773991584777832, 1.567378044128418, -0.05985069274902344, 0.4357185363769531, -0.7651596069335938, 0.29181766510009766, -0.4820730686187744, -0.1664562225341797, -0.21673583984375, -0.5610027313232422, -1.6187057495117188, -0.8144798278808594, -0.07356452941894531, 19.035133361816406, 0.33173370361328125, -0.1144876480102539, 0.4064474105834961, 26.774229049682617, 0.23948955535888672, 0.0548553466796875, -0.3233985900878906, 0.8463706970214844, -0.7597532272338867, -1.4872112274169922, 0.6631736755371094, -0.28278160095214844, 0.1678295135498047, -0.2197437286376953, 0.22271728515625, 0.7510738372802734, 0.37181949615478516, 0.18255996704101562, 0.7834806442260742, 0.18698692321777344, -0.6889042854309082, -0.2229456901550293, 0.23545455932617188, -0.08106470108032227, 1.415503978729248, 0.04033851623535156, -0.03749370574951172, 1.0925769805908203], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 54272, "num_env_steps_trained": 249900, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 249900, "last_target_update_ts": 54272, "num_target_updates": 105}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -61.623919572904704, "episode_len_mean": 246.16, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248], "episode_lengths": [270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5416240772710136, "mean_inference_ms": 24.15473949484783, "mean_action_processing_ms": 0.13390760977522154, "mean_env_wait_ms": 4.386194430795459, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -61.623919572904704, "episode_len_mean": 246.16, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.314652390778065, -30.332123182713985, 1.9009506031870842, -79.75581995397806, -4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248], "episode_lengths": [270, 236, 236, 244, 239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5416240772710136, "mean_inference_ms": 24.15473949484783, "mean_action_processing_ms": 0.13390760977522154, "mean_env_wait_ms": 4.386194430795459, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 249900, "num_env_steps_sampled": 54272, "num_env_steps_trained": 249900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 54272, "agent_timesteps_total": 54272, "timers": {"training_iteration_time_ms": 355.39, "learn_time_ms": 70.032, "learn_throughput": 4283.782, "synch_weights_time_ms": 21.088}, "counters": {"num_env_steps_sampled": 54272, "num_env_steps_trained": 249900, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 249900, "last_target_update_ts": 54272, "num_target_updates": 105}, "done": false, "episodes_total": 196, "training_iteration": 53, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-29-15", "timestamp": 1655494155, "time_this_iter_s": 5.667048454284668, "time_total_s": 283.4021303653717, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 283.4021303653717, "timesteps_since_restore": 0, "iterations_since_restore": 53, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 33.0625, "ram_util_percent": 64.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 13.257575988769531, "min_q": -26.158336639404297, "max_q": 38.6439323425293, "mean_td_error": -0.359525591135025}, "td_error": [-6.067930221557617, 0.7799596786499023, 0.17348384857177734, -0.016282081604003906, -0.1283423900604248, -1.1371421813964844, -1.7284307479858398, -1.045578956604004, 0.5555419921875, -0.5345573425292969, 0.3440513610839844, -1.079329490661621, -0.0721883773803711, -0.3183021545410156, 0.2611274719238281, 0.5248355865478516, -0.561614990234375, -0.21428966522216797, -0.07707023620605469, -2.5662307739257812, -0.7932925224304199, 0.8007626533508301, -0.19456052780151367, 0.47728729248046875, -0.5862636566162109, -0.09926986694335938, 0.5199899673461914, 8.348987579345703, -1.0317649841308594, -0.21047019958496094, 0.048793792724609375, 1.0553779602050781, -7.143634796142578, 0.15854930877685547, -0.10325431823730469, -0.11932182312011719, -1.2979869842529297, -1.7052555084228516, -0.51641845703125, -0.48969364166259766, -0.047926902770996094, -0.2207317352294922, -10.467443466186523, -0.7406826019287109, 0.5954151153564453, 0.11976242065429688, -0.4031200408935547, -1.2276649475097656, -6.247087478637695, -0.16021728515625, -0.0003376007080078125, 0.41373729705810547, -0.5792350769042969, 0.32488059997558594, 0.21269893646240234, 0.12939453125, -0.026065826416015625, 0.47025489807128906, -9.882533073425293, -0.1662921905517578, -0.7381992340087891, -0.11564254760742188, 8.355775833129883, -0.8716096878051758, -0.15921592712402344, -1.0317649841308594, -0.08028221130371094, -1.0134000778198242, 0.3291759490966797, -0.9742527008056641, -0.37883949279785156, -0.38996315002441406, -0.18861007690429688, 0.46197509765625, -1.0245952606201172, -0.34712839126586914, 0.19972610473632812, -2.2254161834716797, -0.08020401000976562, -0.6199755668640137, -5.096281051635742, 0.15378189086914062, 0.06795310974121094, 0.2958259582519531, -0.03583049774169922, 0.29233217239379883, -0.8915786743164062, -0.18032073974609375, 0.062066078186035156, 0.7871532440185547, 0.5470647811889648, -0.8431029319763184, -0.6360836029052734, -0.5929222106933594, -0.6643753051757812, -0.04651069641113281, -0.5368585586547852, 0.3509502410888672, 0.03527545928955078, -4.936271667480469, 0.062216758728027344, 0.5700135231018066, 0.2444286346435547, -2.109999179840088, -7.262691497802734, -5.680826187133789, -0.8634910583496094, -0.6141014099121094, -0.5521249771118164, -6.116281509399414, -0.7208938598632812, -0.5493669509887695, -0.07769250869750977, 0.08791255950927734, -0.4975234866142273, -1.90348219871521, 0.21160459518432617, 1.181863784790039, -0.6430521011352539, 0.05039405822753906, -0.9680595397949219, 0.9742279052734375, -0.6661348342895508, 0.08425426483154297, 0.12796401977539062, -1.726522445678711, 0.5059566497802734, -0.10729789733886719, -0.2543153762817383, -1.4614205360412598, 0.5812721252441406, -0.1519317626953125, 1.3456969261169434, -0.28933238983154297, -5.793356895446777, 0.30533504486083984, -0.494598388671875, -0.0863494873046875, 0.8732147216796875, 0.624239444732666, -0.2044820785522461, -0.3227729797363281, 0.3698244094848633, 0.13659381866455078, 0.45398521423339844, 0.5096979141235352, 0.4213695526123047, 0.20175933837890625, 0.5614528656005859, -0.32007789611816406, 0.36934852600097656, 0.358101487159729, -0.6466445922851562, -0.7512187957763672, -0.28879833221435547, 1.0435733795166016, -0.2039804458618164, 0.23603582382202148, -1.2043781280517578, -0.13818073272705078, -0.10149574279785156, 1.8964576721191406, -0.3675422668457031, -2.8582568168640137, -0.6360836029052734, -1.3116836547851562, 0.03944206237792969, -0.1573925018310547, 12.878887176513672, -0.5313262939453125, -0.9553790092468262, 0.12522411346435547, -0.6933193206787109, 0.6743412017822266, 1.689497947692871, 0.4202413558959961, -0.6605873107910156, 0.32937049865722656, -3.566256284713745, -0.6466445922851562, -0.9784870147705078, -0.5655536651611328, -7.181746482849121, 0.660491943359375, 0.6698818206787109, 0.22020244598388672, -1.1109142303466797, 0.7888431549072266, -0.09342765808105469, -0.7373148202896118, 0.1927248239517212, 0.2774944305419922, -0.08247089385986328, 0.9158515930175781, 1.1308586597442627, -0.6144857406616211, -0.6364898681640625, -0.22968196868896484, 1.107285499572754, 0.12885475158691406, -0.3669910430908203, -0.3853893280029297, 12.686507225036621, -0.08876800537109375, -1.0688610076904297, -0.3157939910888672, 0.11540985107421875, 0.20243453979492188, 1.3415851593017578, -1.9282894134521484, 0.12132072448730469, 1.6322803497314453, 0.1372997760772705, 0.24457359313964844, -0.4046211242675781, -1.7869834899902344, -4.44761848449707, -1.0794563293457031, -6.189655303955078, -0.6222305297851562, 0.11858558654785156, -0.47351646423339844, 1.1589250564575195, -6.29777717590332, 1.1226558685302734, -6.788860321044922, -0.247161865234375, 0.10148239135742188, 1.0553779602050781, 1.424180030822754, -0.6320438385009766, -0.6440200805664062, 0.12914180755615234, 0.1304950714111328, 0.15729522705078125, -0.5262641906738281, 0.7246379852294922, -0.09213829040527344, 0.3534984588623047, 0.15941429138183594, -0.5925569534301758, -0.2532176971435547, 0.27927398681640625, 1.527122974395752, -0.09213829040527344, -1.1741256713867188, 0.414827823638916, -1.8082504272460938, 0.6254749298095703, 0.006866455078125, 1.1677522659301758, -0.5159320831298828, -0.7323760986328125, -0.5810718536376953, -0.7438135147094727, -0.5572605133056641, -2.0819053649902344, -0.5449304580688477, 0.10552978515625, -0.522315502166748, -0.5911989212036133, 5.47983455657959, 0.14844608306884766, 0.5033588409423828, 13.831204414367676, 0.15401649475097656, 0.47415781021118164, 0.07074165344238281, -0.58282470703125, -0.34026050567626953, -0.2801647186279297, -0.35125064849853516, -0.2695159912109375, -6.659820556640625, -0.06776809692382812, -0.003075122833251953, -0.38802051544189453, 0.020211219787597656, 0.7541904449462891, -0.16094493865966797, -0.3941688537597656, 0.10889720916748047, 0.5725102424621582, -1.1377277374267578, 0.14389991760253906, -4.437132835388184, 0.23656082153320312, -0.7699260711669922, -0.6064777374267578, -1.1476964950561523, -2.103862762451172, -0.5139961242675781, -0.5534725189208984, -0.4046363830566406, -1.7136611938476562, -1.3537540435791016, 0.09969772398471832, 0.0019893646240234375, 1.4972639083862305, -1.5781779289245605], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 55296, "num_env_steps_trained": 254700, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 254700, "last_target_update_ts": 55296, "num_target_updates": 107}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -59.62419525243342, "episode_len_mean": 245.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962], "episode_lengths": [239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5422675159228753, "mean_inference_ms": 24.182039565567674, "mean_action_processing_ms": 0.13393778231254777, "mean_env_wait_ms": 4.3916197242237764, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -59.62419525243342, "episode_len_mean": 245.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.88936485350132, 26.641731038689613, -43.78165677189827, -6.713453978300095, -75.08070662617683, 11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962], "episode_lengths": [239, 213, 231, 235, 254, 228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5422675159228753, "mean_inference_ms": 24.182039565567674, "mean_action_processing_ms": 0.13393778231254777, "mean_env_wait_ms": 4.3916197242237764, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 254700, "num_env_steps_sampled": 55296, "num_env_steps_trained": 254700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 55296, "agent_timesteps_total": 55296, "timers": {"training_iteration_time_ms": 338.173, "learn_time_ms": 70.03, "learn_throughput": 4283.887, "synch_weights_time_ms": 20.672}, "counters": {"num_env_steps_sampled": 55296, "num_env_steps_trained": 254700, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 254700, "last_target_update_ts": 55296, "num_target_updates": 107}, "done": false, "episodes_total": 200, "training_iteration": 54, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-29-21", "timestamp": 1655494161, "time_this_iter_s": 5.430942058563232, "time_total_s": 288.83307242393494, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 288.83307242393494, "timesteps_since_restore": 0, "iterations_since_restore": 54, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.925, "ram_util_percent": 64.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 13.56075382232666, "min_q": -26.073835372924805, "max_q": 33.19166564941406, "mean_td_error": -0.870256781578064}, "td_error": [-0.1555957794189453, -1.3710212707519531, -4.919183731079102, -4.932511329650879, 0.23354578018188477, 1.063119888305664, 0.8323087692260742, -0.9405727386474609, -0.4491539001464844, 0.07563018798828125, 0.5622444152832031, -1.6309385299682617, -2.5067195892333984, -1.8201236724853516, -0.669926643371582, -1.7383043766021729, -2.5232162475585938, 0.6333427429199219, -1.9044685363769531, -1.0728683471679688, -0.931716799736023, -0.9814319610595703, 0.39946556091308594, -3.1506118774414062, -1.7555351257324219, 0.5162792205810547, -11.414566993713379, -1.033116340637207, 0.5938606262207031, -1.182988166809082, -0.4323463439941406, -1.7134160995483398, -1.3803730010986328, -2.8295135498046875, -0.6008739471435547, -0.05660057067871094, 7.6875128746032715, -0.12248754501342773, 1.3273773193359375, 0.9333648681640625, -0.23839521408081055, 0.052926063537597656, -2.2075958251953125, 0.3782081604003906, -1.4503765106201172, 2.551785707473755, -1.3109045028686523, -1.239713191986084, -1.1146340370178223, -0.6395072937011719, -2.98614501953125, -1.2650947570800781, -6.464334487915039, -0.1686840057373047, -1.0698795318603516, 0.5899662971496582, 0.3995800018310547, -0.7690038681030273, 4.667712211608887, 0.08666229248046875, -0.6545639038085938, -0.5589127540588379, -0.822075366973877, 0.2795238494873047, -2.786726951599121, 0.14545440673828125, -1.405282974243164, -0.6264142990112305, -2.7558746337890625, 0.8670406341552734, -0.7010421752929688, -1.432382583618164, 0.3919353485107422, 0.10520648956298828, -1.4204492568969727, -0.8903980255126953, 0.12027931213378906, -0.999751091003418, -1.7748327255249023, -1.5123960971832275, -1.8310604095458984, -0.00948333740234375, -0.8816928863525391, -8.791440963745117, -1.285919189453125, 0.07355880737304688, -0.44151973724365234, -1.470062255859375, 0.10032081604003906, 0.5323390960693359, 1.0198211669921875, 0.9279022216796875, -1.433298110961914, 0.4708728790283203, -0.8838062286376953, 0.7131776809692383, -0.6066150665283203, -0.7770795822143555, 0.33359622955322266, -1.652501106262207, 0.3989443778991699, -3.0993332862854004, -7.405697345733643, -1.9401731491088867, -0.999751091003418, -1.424173355102539, -0.7929677963256836, -0.26387786865234375, -1.0519218444824219, -1.402109146118164, -1.7986068725585938, -6.679452419281006, -1.2708702087402344, -0.8403491973876953, -2.000852584838867, 0.4217338562011719, 1.5009503364562988, 0.22670555114746094, -5.446611404418945, -0.2022686004638672, -0.27872562408447266, 0.10557079315185547, 0.7386941909790039, -3.1391029357910156, -0.7145671844482422, -2.008848190307617, -1.0968856811523438, -0.26717376708984375, -1.4294042587280273, -0.9244918823242188, -1.384037971496582, -0.48970746994018555, 1.093353271484375, -1.0785331726074219, -0.9670314788818359, 2.319199323654175, -0.04684019088745117, 0.9572887420654297, -1.0225744247436523, -0.9238929748535156, -1.2779655456542969, -2.3971118927001953, -0.9805846214294434, 0.2905845642089844, 1.2418346405029297, 2.8555212020874023, -2.064847946166992, 0.16167449951171875, -0.09830951690673828, -0.19051837921142578, 1.8577194213867188, -0.8731241226196289, -0.17203235626220703, -3.7299461364746094, -1.4426136016845703, -0.5339303016662598, 9.737174987792969, -0.30126237869262695, -2.297914505004883, -0.8030414581298828, -0.19245338439941406, -1.9267349243164062, -7.048149108886719, -0.7738580703735352, -1.0597515106201172, -0.05302619934082031, 0.47382068634033203, -1.0767266750335693, 0.06676578521728516, -1.254617691040039, -0.44748878479003906, 0.8015975952148438, -0.04762458801269531, -0.688841700553894, -2.720348358154297, -1.188248634338379, -1.1546363830566406, 0.128814697265625, -2.5963706970214844, 0.170501708984375, 0.4926776885986328, -0.5061569213867188, 0.17718231678009033, -1.303079605102539, -3.035146713256836, -2.7808475494384766, -1.5579566955566406, -1.7936630249023438, 1.5009503364562988, -3.506100654602051, -3.258976936340332, 0.16214662790298462, 2.665851593017578, -1.4299936294555664, -2.77056884765625, -2.069852828979492, 0.10931968688964844, -0.2746620178222656, -0.4971637725830078, 0.00048065185546875, 0.0767221450805664, -0.1961507797241211, 0.5178699493408203, -0.7143516540527344, -0.8170852661132812, 0.5741767883300781, -21.0609130859375, 0.7797727584838867, 0.7359447479248047, 0.16669082641601562, 0.95672607421875, -0.5366249084472656, -0.6855449676513672, 0.260833740234375, -1.4683952331542969, -0.4746723175048828, -0.4541168212890625, -1.4416790008544922, -0.5575103759765625, -0.4872398376464844, -1.4226446151733398, -0.41162872314453125, -0.38508033752441406, -0.38454315066337585, -1.6406822204589844, -1.1855545043945312, -0.45180511474609375, -0.7061786651611328, -1.6711559295654297, 6.113409042358398, -6.409571647644043, -1.098546028137207, -5.716146469116211, -0.974703311920166, -0.6882181167602539, -0.8572654724121094, -1.2899389266967773, -0.7733860015869141, 0.39313697814941406, -0.6323223114013672, -1.0551881790161133, -1.0310683250427246, -0.6288280487060547, -1.9835987091064453, -0.5703620910644531, -0.943303108215332, -0.6863918304443359, -1.689535140991211, 0.029327392578125, -1.7542181015014648, -0.5407447814941406, 0.901890754699707, -0.6922006607055664, -1.0611152648925781, -0.014739990234375, 0.4095926284790039, -2.11077880859375, -1.459402084350586, -0.019482135772705078, -1.703658103942871, -0.5934591293334961, 0.5078907012939453, -2.005237579345703, -7.368198394775391, -1.3645954132080078, -0.7905435562133789, 0.012337684631347656, -1.0238447189331055, -1.5832672119140625, -5.287792205810547, -1.2354230880737305, -1.6236152648925781, 8.408000946044922, -0.6739110946655273, -0.18280029296875, 0.18314552307128906, -1.3297386169433594, -0.2520027160644531, -0.3322772979736328, 1.4176578521728516, -1.6812267303466797, -8.02266788482666, -1.9073410034179688, -5.6721906661987305, -0.5586071014404297, -0.34568023681640625, -0.2827644348144531, -1.993185043334961, -0.8246192932128906, -1.5978527069091797, -1.28745698928833, -0.6947331428527832, -0.2403888702392578, -0.9167861938476562, 0.28562021255493164, -0.9628286361694336, 1.02608060836792, 0.6129341125488281, -0.7610797882080078, 11.281732559204102], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 56320, "num_env_steps_trained": 259500, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 259500, "last_target_update_ts": 56320, "num_target_updates": 109}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -60.11110671080649, "episode_len_mean": 244.9, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872], "episode_lengths": [228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5422320907271869, "mean_inference_ms": 24.209466014750788, "mean_action_processing_ms": 0.13398251341108344, "mean_env_wait_ms": 4.394704440120256, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -60.11110671080649, "episode_len_mean": 244.9, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.034490875899792, -5.335616856813431, -4.395143195986748, -124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872], "episode_lengths": [228, 229, 247, 271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5422320907271869, "mean_inference_ms": 24.209466014750788, "mean_action_processing_ms": 0.13398251341108344, "mean_env_wait_ms": 4.394704440120256, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 259500, "num_env_steps_sampled": 56320, "num_env_steps_trained": 259500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 56320, "agent_timesteps_total": 56320, "timers": {"training_iteration_time_ms": 341.744, "learn_time_ms": 69.304, "learn_throughput": 4328.761, "synch_weights_time_ms": 20.657}, "counters": {"num_env_steps_sampled": 56320, "num_env_steps_trained": 259500, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 259500, "last_target_update_ts": 56320, "num_target_updates": 109}, "done": false, "episodes_total": 205, "training_iteration": 55, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-29-26", "timestamp": 1655494166, "time_this_iter_s": 5.430710077285767, "time_total_s": 294.2637825012207, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 294.2637825012207, "timesteps_since_restore": 0, "iterations_since_restore": 55, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 34.0875, "ram_util_percent": 64.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 13.944319725036621, "min_q": -26.123546600341797, "max_q": 38.880374908447266, "mean_td_error": -0.3212638199329376}, "td_error": [-0.9581394195556641, 0.48674869537353516, -5.160434722900391, -1.7209358215332031, 0.3945894241333008, -6.349328994750977, -0.5545196533203125, 0.4651961326599121, -1.8805999755859375, 1.9381046295166016, 0.45622825622558594, 0.6652336120605469, 0.3983478546142578, -7.660567283630371, -0.038761138916015625, 0.07509040832519531, 0.35675811767578125, 0.008494377136230469, 1.6361980438232422, 9.300750732421875, 0.733154296875, 0.9503650665283203, 0.5575714111328125, 0.43427467346191406, -0.3902568817138672, -0.3034839630126953, 0.0882568359375, -0.7161092758178711, 0.1836719512939453, 0.9109649658203125, 0.33203125, -1.5155448913574219, 0.18780803680419922, 0.18659210205078125, 0.09992218017578125, -0.11867284774780273, 0.2702970504760742, 0.4891986846923828, -0.26212310791015625, 0.4893970489501953, 1.020925521850586, -0.9760284423828125, -0.702906608581543, 0.31032896041870117, 1.1754066944122314, 0.4095134735107422, 0.4699440002441406, 0.4296579360961914, -0.11273479461669922, 1.8738279342651367, 0.3857841491699219, -0.7554717063903809, 0.14502525329589844, -0.43216419219970703, -0.8687648773193359, 0.017728805541992188, 0.8459396362304688, -0.15159988403320312, -0.6554803848266602, -0.43704986572265625, 0.2712078094482422, -5.031780242919922, 0.1003570556640625, 1.0524616241455078, 0.5443744659423828, -0.2530956268310547, -0.31546974182128906, 0.9513397216796875, 0.020140647888183594, -0.46643829345703125, 0.7887287139892578, 0.6922683715820312, -0.6412410736083984, 0.23879528045654297, -4.448371887207031, -0.21128082275390625, -0.5053644180297852, -4.761554718017578, -7.679455280303955, -5.736955642700195, -0.5884113311767578, 0.10205459594726562, 0.6660842895507812, -0.21856914460659027, 0.5329227447509766, 0.33061814308166504, -1.1828787326812744, -0.3543062210083008, -1.7222442626953125, 0.41041994094848633, -5.48838472366333, -0.7635021209716797, 1.0354795455932617, -0.6112442016601562, 0.6098003387451172, -2.6986942291259766, -0.30584716796875, -1.1340970993041992, 0.6850743293762207, -0.7734370231628418, 0.5937309265136719, -1.0183162689208984, -0.022432327270507812, -1.2123870849609375, -0.5403623580932617, -1.3980646133422852, 0.2510833740234375, -0.9646110534667969, -0.6648464202880859, -0.5952863693237305, -0.2768831253051758, 0.49352073669433594, -0.008747100830078125, -1.3958349227905273, 1.0255098342895508, -7.6461029052734375, 13.19381332397461, 0.19841623306274414, -0.13190650939941406, 0.4499645233154297, 0.0012400150299072266, 1.3992595672607422, -0.773834228515625, -6.525874137878418, 0.674189567565918, 1.0583724975585938, 0.09209632873535156, -0.5971636772155762, 0.30739402770996094, 0.3898773193359375, 0.016998291015625, 0.2772402763366699, 0.3504314422607422, 3.34918212890625, 0.31938982009887695, 1.356180191040039, -0.2820577621459961, 0.09015560150146484, -0.4519987106323242, 0.051639556884765625, 2.0378551483154297, -5.288084983825684, -0.17781448364257812, 0.77703857421875, -6.14216423034668, -1.1032581329345703, 1.0464553833007812, -1.3878135681152344, 0.22696208953857422, 0.5402622222900391, 1.7495403289794922, -0.24176025390625, 0.31200408935546875, -0.23801136016845703, -0.21856914460659027, 3.0637149810791016, 0.2247791290283203, 0.2921562194824219, 0.2995319366455078, -2.3779067993164062, -0.3201637268066406, 1.0043048858642578, 1.2494101524353027, 0.45284271240234375, -0.04843711853027344, -1.1068878173828125, -0.42482948303222656, -0.03555139899253845, -1.966224193572998, 1.0206317901611328, -0.5341348648071289, 0.8622570037841797, 0.3152589797973633, -0.22113609313964844, -0.17655515670776367, 1.266937255859375, 0.5517234802246094, -0.25618743896484375, 0.33466672897338867, -0.49752140045166016, -9.206304550170898, -6.316484451293945, 0.9998207092285156, -0.5568323135375977, 0.23427391052246094, -0.1877117156982422, 0.8103435635566711, -0.6190624237060547, 0.13471221923828125, 1.1375622749328613, 0.7982139587402344, 1.3585281372070312, -1.5329203605651855, -0.4536724090576172, -0.088134765625, -0.13973617553710938, 0.27250099182128906, -5.74973201751709, 0.03277778625488281, -1.3708152770996094, -0.15344619750976562, 0.6805229187011719, -0.7734370231628418, -6.14508056640625, 0.3944530487060547, -0.9111814498901367, 0.40836524963378906, -0.2666921615600586, 0.21097755432128906, -0.044765472412109375, -0.10758781433105469, -0.7364659309387207, -0.10628724098205566, -0.310638427734375, 0.6737937927246094, 3.6142120361328125, -0.18310260772705078, 1.0413894653320312, -7.032905578613281, 0.002666473388671875, 0.4716625213623047, 2.075908660888672, -4.774900436401367, -0.6652946472167969, -0.031606197357177734, -1.4336204528808594, -0.11964035034179688, -0.1362438201904297, 0.42163562774658203, -1.2923879623413086, 0.5407180786132812, 1.3016185760498047, -0.31203556060791016, 0.0243377685546875, -0.13547515869140625, -0.7623262405395508, 0.4431495666503906, -0.12862777709960938, -0.26415061950683594, 0.3290252685546875, 0.5803852081298828, -0.9202136993408203, 0.1899423599243164, -4.509502410888672, -0.5041618347167969, 0.07984542846679688, -0.5509700775146484, -0.773834228515625, 1.785593032836914, -0.5405483245849609, -1.4069428443908691, -0.6492252349853516, -0.33319091796875, -0.18262672424316406, -0.13973617553710938, -0.019216537475585938, -0.1131744384765625, 0.271844744682312, 0.7213249206542969, 0.5329399108886719, -0.3025798797607422, -0.12001991271972656, 0.132293701171875, -0.35349178314208984, 0.5100765228271484, 0.7788028717041016, 0.21248817443847656, -3.601011276245117, -0.8334579467773438, -0.13004779815673828, 0.26010704040527344, -0.5231084823608398, 0.9069852828979492, -1.5928401947021484, -0.6168365478515625, -0.6712579727172852, 1.5783982276916504, -0.2467517852783203, 0.23788166046142578, 0.8908863067626953, 0.7004318237304688, -6.066019535064697, 0.21019363403320312, -6.040278434753418, 2.202503204345703, -0.6697502136230469, 0.3430824279785156, -2.775005340576172, -0.5814447402954102, 0.9467239379882812, -0.24072885513305664, 0.6338748931884766, -0.0764312744140625, -0.11780738830566406, 0.08573341369628906, 1.7466411590576172, 2.221874237060547, -0.5699291229248047, -0.03852272033691406, 0.41135120391845703], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 264300, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 264300, "last_target_update_ts": 57344, "num_target_updates": 111}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -59.762776208668946, "episode_len_mean": 244.12, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961], "episode_lengths": [271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5432144503861526, "mean_inference_ms": 24.212388035825043, "mean_action_processing_ms": 0.13422167240126817, "mean_env_wait_ms": 4.3961353575672595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -59.762776208668946, "episode_len_mean": 244.12, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-124.47078352421522, -13.374756574630737, -158.42317636311054, 19.191309921443462, -20.97903547435999, 6.8000000193715096, -103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961], "episode_lengths": [271, 256, 276, 204, 239, 207, 282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5432144503861526, "mean_inference_ms": 24.212388035825043, "mean_action_processing_ms": 0.13422167240126817, "mean_env_wait_ms": 4.3961353575672595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 264300, "num_env_steps_sampled": 57344, "num_env_steps_trained": 264300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 57344, "agent_timesteps_total": 57344, "timers": {"training_iteration_time_ms": 341.868, "learn_time_ms": 71.699, "learn_throughput": 4184.184, "synch_weights_time_ms": 20.683}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 264300, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 264300, "last_target_update_ts": 57344, "num_target_updates": 111}, "done": false, "episodes_total": 208, "training_iteration": 56, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-29-32", "timestamp": 1655494172, "time_this_iter_s": 5.461804628372192, "time_total_s": 299.7255871295929, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 299.7255871295929, "timesteps_since_restore": 0, "iterations_since_restore": 56, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.150000000000002, "ram_util_percent": 64.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.10945987701416, "min_q": -24.613059997558594, "max_q": 37.69434356689453, "mean_td_error": -0.09254438430070877}, "td_error": [-0.6267752647399902, 0.43450069427490234, -0.12200164794921875, 0.33313417434692383, -0.06823348999023438, -4.427162170410156, -1.5268383026123047, 3.950209617614746, -0.5255641937255859, 0.7996273040771484, -0.37105560302734375, 1.2820148468017578, -0.00372314453125, 1.0172176361083984, -1.0981521606445312, -0.14186668395996094, 0.9932060241699219, -0.6680946350097656, 0.24318504333496094, 0.19815731048583984, 0.4294557571411133, 0.5770969390869141, 0.19195842742919922, 0.36283111572265625, -0.57708740234375, 0.829524040222168, 1.303030014038086, 0.046248435974121094, 0.6942439079284668, 13.186623573303223, 0.6516408920288086, -9.154321670532227, -0.766291618347168, -0.5288448333740234, -6.780506134033203, 0.4818093776702881, 0.6679363250732422, -0.5649681091308594, -0.7781581878662109, 1.369675636291504, -0.16302776336669922, 1.2542462348937988, -0.7309398651123047, 0.45062255859375, 0.7853827476501465, 8.568365097045898, 1.0397653579711914, 1.4160966873168945, -0.09630298614501953, 1.5039806365966797, -8.57969856262207, 0.04593849182128906, 0.2337188720703125, -0.3100757598876953, 1.1018524169921875, -0.06203651428222656, 0.2347545623779297, 0.43467235565185547, -0.8052577972412109, 1.0156450271606445, 0.052257537841796875, 1.4423702955245972, -2.1791768074035645, 0.36234283447265625, 1.6395988464355469, 0.15948867797851562, 1.1268959045410156, -0.4331321716308594, -0.39012956619262695, 0.01965808868408203, 0.03328895568847656, 0.3874845504760742, -0.5091085433959961, 0.7110023498535156, 2.093038558959961, 0.8254051208496094, 1.4423702955245972, 0.7819805145263672, 0.7556304931640625, 0.6977100372314453, 0.05130958557128906, -1.0289134979248047, -0.2080364227294922, 0.9454183578491211, 0.18972015380859375, 0.35294151306152344, 0.9229164123535156, -4.962549209594727, -0.45189666748046875, 0.604914665222168, 0.8325233459472656, 1.8590717315673828, 0.3767662048339844, -0.020564556121826172, 0.9758167266845703, 0.16382312774658203, 1.7154922485351562, -0.35187816619873047, -0.10269594192504883, 0.12026500701904297, 0.32329845428466797, 0.2042064666748047, -0.2691364288330078, 0.0706930160522461, 0.17781448364257812, -0.4017658233642578, 0.5584743022918701, -0.08363533020019531, -0.41361045837402344, 0.3031282424926758, 0.9258232116699219, -4.315296173095703, 0.6752275228500366, -0.0021429061889648438, 0.5978126525878906, 0.703312873840332, -0.9342117309570312, -0.8498134613037109, 0.5196633338928223, -0.0998067855834961, -0.4211263656616211, 0.5884091854095459, -0.4909229278564453, 0.07415485382080078, -5.621604919433594, -0.32496070861816406, -0.37105560302734375, -1.0787239074707031, 0.08636760711669922, 2.592374801635742, 0.045420169830322266, -0.368743896484375, -0.49227142333984375, 0.408599853515625, 0.1916494369506836, -0.5199413299560547, 0.8220415115356445, 0.01699352264404297, 0.12174415588378906, 0.19301605224609375, 0.5250892639160156, 1.0662965774536133, 0.6874284744262695, -0.2555055618286133, 0.2995777130126953, 2.1754932403564453, 1.0662965774536133, -0.9980819225311279, -1.0602569580078125, 0.8236961364746094, -1.7482585906982422, -0.18358612060546875, 0.09907722473144531, 0.9928076267242432, 0.34128904342651367, -0.31084632873535156, -0.1231536865234375, 0.6812214851379395, -0.6789302825927734, -0.39795684814453125, 1.270853042602539, -0.8042006492614746, -10.050216674804688, -5.602076530456543, 1.1480541229248047, -0.19136810302734375, -6.389568328857422, -1.1136131286621094, 0.15923118591308594, 2.384378433227539, 0.5026149749755859, -0.17041778564453125, 1.3287572860717773, -0.6702671051025391, -0.8212394714355469, -0.6872119903564453, -0.2601146697998047, 0.759119987487793, 1.6474494934082031, 0.37050819396972656, -0.8819012641906738, 0.45491790771484375, -0.6984958648681641, 0.6783485412597656, -0.2389850616455078, 0.4212627410888672, -0.19492149353027344, -0.13812589645385742, 1.1581897735595703, 0.24906349182128906, 0.6865987777709961, -0.5109272003173828, 0.3403739929199219, -0.7625484466552734, -0.2532176971435547, 0.6348342895507812, -1.6595325469970703, 0.2774529457092285, -1.7882041931152344, -0.1337108612060547, 0.37111663818359375, 0.8212985992431641, 1.3138618469238281, -0.6794986724853516, -0.4898228645324707, -0.5894374847412109, 0.6145830154418945, 0.800811767578125, -0.44988059997558594, 2.3474349975585938, -0.10527610778808594, -0.2353534698486328, 0.04768848419189453, 0.27240562438964844, 0.05538463592529297, 0.48790836334228516, 0.0611419677734375, 6.610438346862793, -0.9500417709350586, 0.6583881378173828, 0.22910594940185547, 2.3973960876464844, -2.0390777587890625, -4.262707710266113, 0.8819723129272461, -0.33429908752441406, 1.4066591262817383, -0.9183597564697266, 0.4611701965332031, -0.5582923889160156, -10.290670394897461, 0.26663970947265625, -0.6488990783691406, 1.3465261459350586, -10.050216674804688, 0.17527008056640625, 0.20691871643066406, 0.0053462982177734375, 1.1973133087158203, -0.4090747833251953, -0.26480865478515625, -0.27628421783447266, -0.39460277557373047, 1.1328697204589844, 0.2599153518676758, 0.041728973388671875, -0.5063266754150391, -0.4963855743408203, 0.13010120391845703, -1.1414623260498047, -0.421051025390625, -0.7992420196533203, 0.9605803489685059, -0.8695259094238281, -0.04751777648925781, 0.4065237045288086, 1.1941204071044922, 0.16734886169433594, 1.1083049774169922, -0.7445869445800781, -0.2883453369140625, 0.5511355400085449, -0.023537158966064453, -0.1505584716796875, 0.27063941955566406, -0.4009361267089844, -0.7503890991210938, -0.1679515838623047, 0.11454963684082031, 0.41863059997558594, -0.1951313018798828, 1.6589317321777344, -5.298530578613281, -0.544586181640625, -0.9073600769042969, 0.3696908950805664, -0.3618183135986328, 0.5641288757324219, -0.7112216949462891, -6.630523204803467, 0.1186075210571289, -0.8801240921020508, 0.14188432693481445, -0.4831104278564453, 0.1314239501953125, 0.5633502006530762, 1.8139076232910156, 0.41353893280029297, -0.11792278289794922, 1.0670108795166016, -0.5335836410522461, -1.4971733093261719, -0.35326194763183594, -0.14452028274536133, -5.076077938079834, -0.6644210815429688, 0.9336309432983398, 2.2656593322753906, 1.2964560985565186, 0.009922027587890625], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 58368, "num_env_steps_trained": 269100, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 269100, "last_target_update_ts": 58368, "num_target_updates": 113}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -57.45371414601803, "episode_len_mean": 243.11, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226], "episode_lengths": [282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5444467544140004, "mean_inference_ms": 24.228328351193845, "mean_action_processing_ms": 0.13379511805373828, "mean_env_wait_ms": 4.4035666384409184, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -57.45371414601803, "episode_len_mean": 243.11, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-103.86988089978695, -9.894649043679237, -10.33521393686533, -210.45239259302616, -9.989364460110664, -5.671686001121998, 2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226], "episode_lengths": [282, 210, 226, 302, 208, 232, 214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5444467544140004, "mean_inference_ms": 24.228328351193845, "mean_action_processing_ms": 0.13379511805373828, "mean_env_wait_ms": 4.4035666384409184, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 269100, "num_env_steps_sampled": 58368, "num_env_steps_trained": 269100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 58368, "agent_timesteps_total": 58368, "timers": {"training_iteration_time_ms": 359.932, "learn_time_ms": 69.471, "learn_throughput": 4318.366, "synch_weights_time_ms": 20.887}, "counters": {"num_env_steps_sampled": 58368, "num_env_steps_trained": 269100, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 269100, "last_target_update_ts": 58368, "num_target_updates": 113}, "done": false, "episodes_total": 214, "training_iteration": 57, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-29-38", "timestamp": 1655494178, "time_this_iter_s": 5.710585355758667, "time_total_s": 305.43617248535156, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 305.43617248535156, "timesteps_since_restore": 0, "iterations_since_restore": 57, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.1875, "ram_util_percent": 64.3625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.502582550048828, "min_q": -24.50773048400879, "max_q": 36.307579040527344, "mean_td_error": -0.3703361451625824}, "td_error": [-1.0933036804199219, 1.0592646598815918, -0.04338264465332031, -1.1367793083190918, -4.747392654418945, -0.20415878295898438, -1.2095203399658203, -8.9906644821167, 0.155609130859375, 1.6891956329345703, 1.6938247680664062, 0.15862226486206055, 0.6769657135009766, -0.41279125213623047, 0.45457935333251953, -0.6783437728881836, -0.02577972412109375, -0.4993247985839844, 0.4247627258300781, 12.855291366577148, 1.2966375350952148, 0.6735749244689941, 0.8319740295410156, 1.045400619506836, -0.5562458038330078, 1.5394611358642578, 0.24159812927246094, -0.026744842529296875, -2.16119384765625, -0.5345592498779297, 1.4345006942749023, 0.06917762756347656, -16.49984359741211, -0.46250152587890625, 0.060138702392578125, 0.32721757888793945, 2.1214351654052734, -0.7167205810546875, 0.9648380279541016, -1.521720290184021, -0.11248111724853516, 1.574117660522461, -0.4241657257080078, -0.35788536071777344, 0.16446781158447266, -0.09298515319824219, -0.3822174072265625, -1.0816192626953125, -0.7576704025268555, 0.3825855255126953, 6.7245192527771, -0.2433643341064453, 1.0935840606689453, -0.38898181915283203, -0.04013824462890625, 0.9392604827880859, 0.06521415710449219, 0.6155033111572266, -0.4265165328979492, -10.472294807434082, -4.830166816711426, 0.4083747863769531, 1.6246299743652344, -1.3321266174316406, 0.031510353088378906, -0.4824409484863281, -0.3828010559082031, -0.4911050796508789, -0.5298166275024414, 0.4491081237792969, 0.48815155029296875, -0.31854820251464844, -7.9838409423828125, -0.29802513122558594, -0.5242404937744141, 0.13081741333007812, -0.4221324920654297, -0.2823829650878906, 0.2000293731689453, 2.1973094940185547, 0.5808486938476562, -0.7423839569091797, 0.5634632110595703, 0.11176586151123047, 9.892393112182617, -0.581934928894043, -0.4752035140991211, 0.34417057037353516, -0.33644676208496094, -0.029897689819335938, 17.510679244995117, 1.4731488227844238, -0.7690629959106445, 0.31738853454589844, 1.303598403930664, -5.952244758605957, -0.8751325607299805, 1.0091075897216797, 0.42607688903808594, -0.2900400161743164, 0.48639392852783203, -0.5311622619628906, -0.0021820068359375, -0.8800239562988281, -7.040140151977539, -1.4564027786254883, -0.6602020263671875, -5.242522239685059, -5.093358993530273, 0.31006813049316406, 1.4979915618896484, 0.16709041595458984, -0.9076442718505859, -0.7077212333679199, -1.1898460388183594, 0.8171634674072266, -0.4023303985595703, -0.04022407531738281, -4.980496406555176, -0.15993595123291016, -5.856294631958008, -0.6753368377685547, -0.04013824462890625, 0.30043601989746094, -0.0216522216796875, -0.4751243591308594, -0.7529802322387695, 0.1502361297607422, -0.5926723480224609, -0.21636199951171875, -1.1428272724151611, 0.5205783843994141, -0.48974841833114624, 1.5344524383544922, -1.6417102813720703, -0.13759231567382812, -7.436472415924072, -0.8069343566894531, -0.22534561157226562, -0.5249233245849609, 0.739044189453125, 0.5582599639892578, 0.2606678009033203, 1.2287635803222656, -0.5500755310058594, -1.4091987609863281, -10.370553970336914, -0.029771804809570312, -4.549831390380859, 1.176417589187622, -0.04652214050292969, -3.201655387878418, -0.21159934997558594, 0.6186084747314453, 0.3915824890136719, -0.552734375, -0.43988037109375, 1.1963062286376953, 0.5664272308349609, -6.334522724151611, -4.485160827636719, -0.7181606292724609, -0.1536273956298828, 0.3114948272705078, -6.421514511108398, 0.043842315673828125, -0.28341102600097656, 0.821197509765625, -0.04688453674316406, -0.15240764617919922, -0.483917236328125, -5.699485778808594, 2.142165184020996, -0.2892303466796875, -0.25022125244140625, -0.5098371505737305, -0.16510009765625, -6.184775352478027, 0.727189302444458, -0.19565773010253906, -0.6300487518310547, 0.5054082870483398, 0.5635185241699219, -0.9272515773773193, 0.9150505065917969, 0.028026580810546875, -0.2657289505004883, -4.103870868682861, -0.7725801467895508, 1.4489941596984863, 1.2087206840515137, 0.4672527313232422, 0.33059120178222656, 0.028954505920410156, 1.7713661193847656, -7.824729919433594, 0.5641546249389648, -0.6225337982177734, 1.4016003608703613, 14.634160041809082, 0.733820915222168, -0.8324527740478516, 0.3376026153564453, 0.6072444915771484, -0.1790142059326172, -4.549831390380859, -0.15294265747070312, -2.280217170715332, 0.7708034515380859, 0.3915824890136719, -0.06388998031616211, -0.8882637023925781, 0.7779808044433594, 0.4328460693359375, 0.9254817962646484, -0.5749034881591797, -0.5256099700927734, 0.5525436401367188, -0.06595039367675781, -0.8672275543212891, -0.4053459167480469, -8.07845687866211, -0.4805908203125, -0.1649799346923828, 1.4520378112792969, -0.025793075561523438, -0.2847557067871094, 0.0651092529296875, -0.8447551727294922, -0.8945226669311523, -2.4863452911376953, 0.48377227783203125, -0.3750467300415039, -1.2123908996582031, -0.19698619842529297, 0.18141746520996094, -0.06331062316894531, -0.758091926574707, -0.5345592498779297, -0.09797859191894531, 0.6910247802734375, 0.319793701171875, -0.07204055786132812, -0.1436138153076172, -0.28024959564208984, 0.36376237869262695, 1.0337433815002441, -0.4473094940185547, -9.340718269348145, 0.739044189453125, -0.5288019180297852, 0.5499362945556641, -0.07309341430664062, -0.1466197967529297, 0.2688636779785156, 1.4236936569213867, 0.5184574127197266, 0.24000167846679688, 0.05518960952758789, -2.0935211181640625, -0.30827903747558594, 1.5242862701416016, 0.4080432653427124, -2.210048198699951, -0.8069343566894531, 0.10268592834472656, 0.2739887237548828, -1.2321319580078125, -2.3139638900756836, -0.29215240478515625, -0.13181114196777344, 0.34389209747314453, -1.4189701080322266, 2.463754177093506, -0.4474678039550781, 0.05241823196411133, 2.9886646270751953, -0.18973827362060547, 0.15053176879882812, -0.6289644241333008, -0.14751720428466797, -0.42026519775390625, -0.3907756805419922, -0.32619380950927734, -0.022495269775390625, 0.8171634674072266, -0.8242988586425781, -1.3233094215393066, 0.3519859313964844, -0.39016056060791016, -0.2666759490966797, 0.4152660369873047, 1.7775144577026367, 1.3958320617675781, -1.2758750915527344, -0.30814361572265625, 0.7708034515380859, 0.08785629272460938, -0.11477470397949219, 0.4738292694091797], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 59392, "num_env_steps_trained": 273900, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 273900, "last_target_update_ts": 59392, "num_target_updates": 115}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -58.20561331614852, "episode_len_mean": 242.87, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978], "episode_lengths": [214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.545439312343736, "mean_inference_ms": 24.27402497820666, "mean_action_processing_ms": 0.13410463276969709, "mean_env_wait_ms": 4.408905412477807, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -58.20561331614852, "episode_len_mean": 242.87, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.300000064074993, -104.56153646111488, -139.30659079551697, -247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978], "episode_lengths": [214, 287, 286, 319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.545439312343736, "mean_inference_ms": 24.27402497820666, "mean_action_processing_ms": 0.13410463276969709, "mean_env_wait_ms": 4.408905412477807, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 273900, "num_env_steps_sampled": 59392, "num_env_steps_trained": 273900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 59392, "agent_timesteps_total": 59392, "timers": {"training_iteration_time_ms": 350.233, "learn_time_ms": 70.067, "learn_throughput": 4281.628, "synch_weights_time_ms": 21.389}, "counters": {"num_env_steps_sampled": 59392, "num_env_steps_trained": 273900, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 273900, "last_target_update_ts": 59392, "num_target_updates": 115}, "done": false, "episodes_total": 220, "training_iteration": 58, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-29-43", "timestamp": 1655494183, "time_this_iter_s": 5.53937292098999, "time_total_s": 310.97554540634155, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 310.97554540634155, "timesteps_since_restore": 0, "iterations_since_restore": 58, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.25, "ram_util_percent": 64.3875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 13.6939115524292, "min_q": -14.707467079162598, "max_q": 36.91394805908203, "mean_td_error": -0.2604714334011078}, "td_error": [0.3004767894744873, -0.8780155181884766, -1.8434991836547852, 0.7376823425292969, 0.8632411956787109, 0.4128150939941406, 0.4552955627441406, 1.2662973403930664, -0.6416873931884766, 1.7008476257324219, -0.16901016235351562, -7.71940803527832, -0.11322402954101562, 1.1312073469161987, -0.7970142364501953, 0.2110748291015625, -0.6585674285888672, -0.5448284149169922, -0.24871444702148438, -0.49118995666503906, 0.2658414840698242, -0.1707324981689453, -0.20195293426513672, -1.2295541763305664, -0.24865198135375977, 1.3572196960449219, -0.7091913223266602, -0.14340782165527344, 0.3349742889404297, -0.8068351745605469, 0.41748619079589844, -1.5376996994018555, 0.4922447204589844, -0.018865197896957397, -1.0655198097229004, -0.028587818145751953, -2.170748233795166, -0.9179205894470215, -0.15909671783447266, 0.727571964263916, -0.814422607421875, -0.9767398834228516, 0.4204902648925781, -0.4152545928955078, -1.058189868927002, -1.07489013671875, -0.4866828918457031, 0.37960243225097656, 0.118896484375, 0.9686279296875, -0.18423843383789062, -0.8364753723144531, 0.3708305358886719, -0.22852706909179688, 5.611658096313477, 0.5089149475097656, 0.19260406494140625, -0.5557975769042969, 0.4922447204589844, -3.4904918670654297, -0.5666656494140625, -0.8449287414550781, -0.6136302947998047, -0.07697105407714844, -0.733759880065918, -0.23512840270996094, 0.17685890197753906, 0.1640634536743164, 0.4586143493652344, 0.4790935516357422, 0.34833526611328125, -0.6612625122070312, 1.9785356521606445, -2.6365437507629395, 1.068730354309082, 0.17833614349365234, -0.29700660705566406, -1.7175140380859375, -0.5642948150634766, 0.4301776885986328, 0.8280811309814453, 0.09850502014160156, -0.16817092895507812, 0.1651521921157837, 0.41229248046875, -0.4020500183105469, -0.22586441040039062, -0.12005138397216797, -0.6002740859985352, 1.462082862854004, -0.5342941284179688, -1.6000137329101562, -0.606785774230957, -0.21196937561035156, 0.19565868377685547, -0.6532192230224609, 0.8972444534301758, 0.01193380355834961, 0.023813724517822266, -6.055874824523926, -0.7180557250976562, -0.7258358001708984, 0.22943782806396484, -6.153718948364258, 0.5041050910949707, -0.8150782585144043, 1.1474342346191406, -0.19156265258789062, -0.009471893310546875, -0.4864625930786133, 0.1270904541015625, 0.29753780364990234, -0.22326946258544922, 0.47583961486816406, 0.2848837375640869, -0.48577308654785156, -0.6976871490478516, 0.13326454162597656, 0.4587221145629883, 1.0909442901611328, 0.17209243774414062, 0.19604110717773438, -0.5381355285644531, -0.17546463012695312, 0.1179494857788086, 0.44146156311035156, -0.7876186370849609, -0.07045817375183105, -1.1624259948730469, 1.0080814361572266, -5.622532844543457, 0.9610404968261719, 0.5498628616333008, -0.2606163024902344, 0.5040912628173828, -3.5523343086242676, -0.2269725799560547, -0.7105185985565186, 23.640504837036133, 0.17003917694091797, 1.3894023895263672, -0.5978507995605469, 0.2543210983276367, -1.6133356094360352, -6.4990386962890625, -0.1602611541748047, 0.5935821533203125, -0.5011749267578125, 0.4630126953125, -0.4571387469768524, -0.3242149353027344, 0.9603414535522461, -0.1789693832397461, -0.4900951385498047, -0.8556861877441406, -1.3920822143554688, 0.5687179565429688, -0.6110630035400391, -10.53154182434082, -0.8577601909637451, 0.9274139404296875, -0.7100372314453125, -0.45967698097229004, -4.471738815307617, -0.5064430236816406, -0.5380697250366211, 0.15003204345703125, -0.2479400634765625, 0.30226850509643555, -0.20195293426513672, 0.832040548324585, 1.16998291015625, -0.1721324920654297, 0.9252033233642578, -0.35741329193115234, -0.18726825714111328, 0.8558158874511719, -1.0775079727172852, 0.05157279968261719, -0.6229124069213867, 0.0707550048828125, -0.33747291564941406, -9.706432342529297, -0.42261505126953125, 24.44123077392578, 1.1179676055908203, -0.5709505081176758, -0.250701904296875, -0.27869606018066406, -0.056720733642578125, -2.5305252075195312, -0.7505712509155273, 0.11894607543945312, -0.06394767761230469, -0.05098533630371094, -0.1887836456298828, 2.679912567138672, 0.46988391876220703, 0.45854759216308594, -0.26795196533203125, -1.0853691101074219, 0.2110748291015625, -0.7039451599121094, -0.8167552947998047, -0.4665374755859375, 0.4328474998474121, -0.18269824981689453, 0.1472339630126953, -13.877235412597656, -4.962803840637207, -1.170858383178711, 2.37801456451416, -0.11635208129882812, 0.20201683044433594, -0.8110027313232422, -0.13398075103759766, -0.3196268081665039, 0.008122444152832031, 0.04060935974121094, 0.04305458068847656, -0.5824298858642578, -0.29720020294189453, 20.332969665527344, 9.270076751708984, 0.47792720794677734, -0.5552034378051758, -0.37269020080566406, 0.7088775634765625, -0.09471893310546875, -0.034264564514160156, -7.023497581481934, -0.4714992046356201, -0.4515266418457031, -0.00981903076171875, 1.083456039428711, -0.09362220764160156, -8.326641082763672, -1.919240951538086, -1.1291470527648926, -0.1725902557373047, -0.4133720397949219, -7.252469062805176, -0.45618438720703125, -0.4193239212036133, -0.17562198638916016, 0.06772613525390625, 0.7680482864379883, 0.5666637420654297, 0.03361225128173828, -0.2729167938232422, -2.3768081665039062, -0.17522048950195312, 0.01026153564453125, -2.1643896102905273, -0.21204185485839844, -0.9825468063354492, 0.2647085189819336, 0.1045675277709961, -0.15196800231933594, -0.32794952392578125, -0.4269695281982422, -0.3991546630859375, -0.925715446472168, 0.2964305877685547, 0.2971811294555664, -0.18220901489257812, 0.22329235076904297, -0.2932925224304199, 0.04301261901855469, 0.4128150939941406, -0.7488059997558594, -0.9509944915771484, -6.7180280685424805, 2.437689781188965, 0.07547378540039062, -10.449277877807617, -0.09888362884521484, 0.10240316390991211, -0.7939233779907227, 0.1433429718017578, 0.1708240509033203, -0.44783782958984375, -0.21511077880859375, -0.34586334228515625, -0.05814933776855469, -0.1540241241455078, -0.6585674285888672, 0.5898036956787109, -0.5531501770019531, -0.23684263229370117, -0.5346107482910156, -1.5601153373718262, 0.612060546875, -0.28496646881103516, -1.406209945678711, -2.4378223419189453, -0.17231464385986328, 0.0043010711669921875, -0.8568592071533203, -0.18162918090820312], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 60416, "num_env_steps_trained": 278700, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 278700, "last_target_update_ts": 60416, "num_target_updates": 117}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -55.878684167340396, "episode_len_mean": 241.67, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822], "episode_lengths": [319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5457920722428865, "mean_inference_ms": 24.261214159130336, "mean_action_processing_ms": 0.13382364812225997, "mean_env_wait_ms": 4.409116601353729, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -55.878684167340396, "episode_len_mean": 241.67, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-247.84060787409544, 12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822], "episode_lengths": [319, 223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5457920722428865, "mean_inference_ms": 24.261214159130336, "mean_action_processing_ms": 0.13382364812225997, "mean_env_wait_ms": 4.409116601353729, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 278700, "num_env_steps_sampled": 60416, "num_env_steps_trained": 278700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 60416, "agent_timesteps_total": 60416, "timers": {"training_iteration_time_ms": 345.96, "learn_time_ms": 69.494, "learn_throughput": 4316.917, "synch_weights_time_ms": 20.789}, "counters": {"num_env_steps_sampled": 60416, "num_env_steps_trained": 278700, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 278700, "last_target_update_ts": 60416, "num_target_updates": 117}, "done": false, "episodes_total": 223, "training_iteration": 59, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-29-49", "timestamp": 1655494189, "time_this_iter_s": 5.483632802963257, "time_total_s": 316.4591782093048, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 316.4591782093048, "timesteps_since_restore": 0, "iterations_since_restore": 59, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.4625, "ram_util_percent": 64.3875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.563518524169922, "min_q": -14.050301551818848, "max_q": 35.14855194091797, "mean_td_error": -0.1688961386680603}, "td_error": [-0.2699851989746094, 0.03585052490234375, -3.650196075439453, -1.3568716049194336, -8.532917022705078, -1.0359210968017578, 0.41128110885620117, -0.7880210876464844, 0.08588981628417969, -0.022409439086914062, -0.24422168731689453, -0.404388427734375, 1.4712982177734375, -0.05751609802246094, -0.045922279357910156, -1.061884880065918, 0.027448654174804688, 0.25214385986328125, 1.097856044769287, 0.9719610214233398, -0.32854461669921875, 1.6244754791259766, -0.33713245391845703, -0.6309776306152344, 0.24031829833984375, -7.716616630554199, -0.3508167266845703, -0.5630588531494141, -0.5998630523681641, -0.07968616485595703, 0.7510929107666016, 0.8027267456054688, -0.23598480224609375, -1.7067830562591553, -0.9787025451660156, -1.7766761779785156, -0.2296009063720703, -0.2601318359375, -1.1675416231155396, 0.24239492416381836, 0.525390625, -0.7018795013427734, 0.013742446899414062, 0.11699295043945312, -0.3520793914794922, -0.787501335144043, -0.9083957672119141, -0.6679058074951172, 0.2587623596191406, -0.31354618072509766, -1.1394710540771484, 1.113037109375, -5.640477657318115, -0.840296745300293, -0.6749019622802734, -0.22854900360107422, -5.061241149902344, -0.5140142440795898, -1.3290061950683594, -0.5664081573486328, -1.2826461791992188, 0.6085891723632812, 2.5864124298095703, -0.2914257049560547, 0.7938194274902344, 1.2472877502441406, -0.5233078002929688, 0.10652685165405273, -0.5216579437255859, 0.41164493560791016, 0.7010116577148438, -0.16108131408691406, 2.372354507446289, -0.3125953674316406, -0.019039154052734375, 1.9774837493896484, 0.10652685165405273, -6.113964080810547, -0.07500457763671875, 0.8688926696777344, 0.5609512329101562, -0.024387359619140625, -0.14432144165039062, -0.9802865982055664, 0.9635238647460938, -0.2776069641113281, -0.04656410217285156, -0.06735515594482422, -5.382199287414551, 0.9288911819458008, -0.20504093170166016, -0.16028499603271484, -0.16021728515625, -0.5230846405029297, 0.047855377197265625, -0.21942901611328125, -0.41446971893310547, 1.416518211364746, 1.9109480381011963, 2.391946792602539, -0.5827922821044922, -1.1400165557861328, 0.7843255996704102, -0.3928403854370117, -0.25810718536376953, -0.12273216247558594, 0.32942962646484375, 0.5533409118652344, 0.10239410400390625, -0.07508468627929688, 0.5588722229003906, -0.25350093841552734, 0.16773033142089844, 0.18270301818847656, 0.1935443878173828, 0.22739410400390625, 2.9685592651367188, -0.5710420608520508, -1.516007423400879, 0.6550188064575195, 0.5440435409545898, -0.34276676177978516, -4.771085739135742, -0.5732383728027344, 1.1440448760986328, 1.1391735076904297, -0.12443351745605469, -0.4080476760864258, 0.7725830078125, -0.8013725280761719, 2.214923858642578, 0.3432044982910156, 0.08753776550292969, -0.04062080383300781, -0.17039871215820312, 0.7938508987426758, -0.21274948120117188, -0.19956320524215698, 0.031200408935546875, -0.05073356628417969, 0.3496284484863281, 1.2698297500610352, -0.4025818109512329, 1.4289302825927734, -0.189208984375, 1.0739822387695312, 1.1640396118164062, 1.2381181716918945, 0.4674644470214844, -0.5103931427001953, -1.3473362922668457, 0.16773033142089844, -0.04525351524353027, 0.12044334411621094, -0.38686370849609375, -0.066802978515625, -0.9060420989990234, 0.17493438720703125, 0.5073432922363281, -0.1937274932861328, 0.033451080322265625, -0.9724330902099609, -0.024495482444763184, 0.61065673828125, -0.01631927490234375, 0.5070362091064453, -1.9035043716430664, -0.3488922119140625, 0.23290443420410156, -6.452239990234375, 0.44440269470214844, 0.5618095397949219, -0.3256864547729492, -0.03378486633300781, -0.30547428131103516, 0.11857795715332031, -0.066925048828125, -5.324828147888184, -0.34366416931152344, 1.3801898956298828, -0.44935035705566406, -0.22760772705078125, -0.2136211395263672, -0.08088493347167969, 0.15055084228515625, -0.3931159973144531, 0.20688438415527344, -0.6530513763427734, 0.011237144470214844, 0.6156444549560547, -1.0865859985351562, -0.31862449645996094, -1.0228071212768555, 0.01840972900390625, -0.49578094482421875, 1.0718250274658203, -1.4332447052001953, -0.2634758949279785, -0.3236818313598633, 0.7369251251220703, -4.687074661254883, -0.0072689056396484375, 0.22153854370117188, -0.0020046234130859375, -0.33989524841308594, -0.08449172973632812, 8.26787281036377, 0.8466720581054688, -0.78192138671875, 0.7774181365966797, 0.417325496673584, 0.579345703125, 0.029707908630371094, -0.8765449523925781, 1.7371845245361328, 0.11113262176513672, -0.21729469299316406, -8.011921882629395, -0.32997798919677734, -6.09758186340332, 1.2381181716918945, -0.6883125305175781, 0.381805419921875, 0.6512594223022461, 0.10652685165405273, 0.2898683547973633, -1.1115455627441406, 0.17845726013183594, -0.8305282592773438, -0.749140739440918, 0.14184951782226562, 0.10002708435058594, 0.42081451416015625, 1.5615081787109375, -0.3777799606323242, -0.04744243621826172, -0.5027713775634766, -0.3444380760192871, -0.10085678100585938, -0.05254554748535156, 2.041548252105713, -0.1710529327392578, -3.6844844818115234, 0.1910686492919922, -0.5406332015991211, -0.33237743377685547, 0.5865917205810547, 0.34900474548339844, -0.5921201705932617, -0.5257101058959961, -6.024049758911133, 2.041548252105713, -0.4181327819824219, 1.1741533279418945, -0.2877235412597656, -0.1503276824951172, -0.34999752044677734, -0.050567626953125, -4.941659927368164, 7.573622226715088, 1.369199275970459, 0.4811439514160156, -1.4790096282958984, 0.2696189880371094, -0.7231559753417969, -0.03304576873779297, 0.8779611587524414, 0.6463279724121094, 16.08103370666504, 0.4442024230957031, -0.14026451110839844, -0.3127403259277344, -0.8014721870422363, 9.477987289428711, -0.01818084716796875, 3.5289478302001953, -0.816981315612793, -0.09527301788330078, -0.25942087173461914, 0.6990947723388672, 1.152313232421875, 0.003520965576171875, -0.3630199432373047, -0.165130615234375, -0.20634078979492188, -1.7067830562591553, 1.0896124839782715, 0.3810844421386719, -7.4556379318237305, -0.6430683135986328, -0.3010234832763672, 1.4712982177734375, 0.6060323715209961, -1.2458434104919434, 1.0646429061889648, -0.3939657211303711, -2.670114517211914, -4.368208885192871, 0.63704514503479, -1.1582565307617188], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 61440, "num_env_steps_trained": 283500, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 283500, "last_target_update_ts": 61440, "num_target_updates": 119}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -53.073161215260626, "episode_len_mean": 240.58, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855], "episode_lengths": [223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5465248061255419, "mean_inference_ms": 24.26015648372656, "mean_action_processing_ms": 0.13380771618457868, "mean_env_wait_ms": 4.41128829891156, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -53.073161215260626, "episode_len_mean": 240.58, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.20000009983778, 30.757340155541897, -230.16302812844515, 29.22353083640337, -326.5054984241724, 26.27639864385128, 10.100000098347664, 1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855], "episode_lengths": [223, 220, 305, 207, 332, 214, 213, 218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5465248061255419, "mean_inference_ms": 24.26015648372656, "mean_action_processing_ms": 0.13380771618457868, "mean_env_wait_ms": 4.41128829891156, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 283500, "num_env_steps_sampled": 61440, "num_env_steps_trained": 283500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 61440, "agent_timesteps_total": 61440, "timers": {"training_iteration_time_ms": 337.055, "learn_time_ms": 69.982, "learn_throughput": 4286.828, "synch_weights_time_ms": 21.587}, "counters": {"num_env_steps_sampled": 61440, "num_env_steps_trained": 283500, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 283500, "last_target_update_ts": 61440, "num_target_updates": 119}, "done": false, "episodes_total": 224, "training_iteration": 60, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-29-55", "timestamp": 1655494195, "time_this_iter_s": 5.371263742446899, "time_total_s": 321.8304419517517, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 321.8304419517517, "timesteps_since_restore": 0, "iterations_since_restore": 60, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.2875, "ram_util_percent": 64.32499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 13.269695281982422, "min_q": -13.243457794189453, "max_q": 33.84328842163086, "mean_td_error": -0.2630912661552429}, "td_error": [0.5493907928466797, -0.3843812942504883, 1.921828269958496, 0.24452495574951172, 0.17876052856445312, -0.6187400817871094, -0.2373828887939453, -0.7051143646240234, 0.33513689041137695, 1.203134536743164, 0.21199440956115723, 0.7211198806762695, -0.675013542175293, -0.015216708183288574, -0.3006172180175781, 0.5828590393066406, 0.08828067779541016, -0.07635498046875, 0.1910724639892578, 0.10910749435424805, 0.2973136901855469, -0.10459518432617188, -0.7998504638671875, -1.474578857421875, -0.04143524169921875, -0.6122732162475586, -4.585918426513672, -0.24875450134277344, 0.034404754638671875, 0.009863853454589844, -1.747406005859375, 0.5924148559570312, -0.5584297180175781, -0.44487571716308594, 0.08670520782470703, 1.0669407844543457, 0.2581024169921875, 1.9328746795654297, 0.2932405471801758, 0.25976085662841797, -9.663131713867188, -0.6620216369628906, -0.8009204864501953, -0.7480745315551758, -0.8857688903808594, -0.9690666198730469, 2.94350528717041, 0.32946109771728516, 1.1176834106445312, 0.2882194519042969, -0.09952640533447266, 1.0726184844970703, -0.5363960266113281, -0.3200397491455078, -0.3051934242248535, -1.0243558883666992, -8.543351173400879, 0.28789234161376953, 0.23708057403564453, 0.6567544937133789, -0.04029512405395508, -0.6236076354980469, -0.6524105072021484, 0.026071548461914062, 0.0889444351196289, 0.23563766479492188, 2.1771974563598633, -0.08006668090820312, 0.19395065307617188, -0.6508579254150391, -7.868274688720703, 0.8209056854248047, -0.4879913330078125, -1.787602424621582, -0.7177810668945312, 1.3515360355377197, -0.038700103759765625, -1.5964131355285645, 1.0415878295898438, 0.2880878448486328, -0.2539405822753906, -6.514354705810547, 0.2211742401123047, 0.17453575134277344, 0.20015239715576172, 0.3963584899902344, 1.9432392120361328, 0.3138914108276367, -0.42432594299316406, -0.5782356262207031, -0.1601409912109375, -6.637218952178955, 1.0853042602539062, -0.27553558349609375, -1.2514429092407227, 0.22052764892578125, -0.0029163360595703125, 0.8095858097076416, 0.4033336639404297, -0.2863483428955078, -0.04629039764404297, 0.04014015197753906, -0.04117393493652344, -0.6709041595458984, -1.2561140060424805, -1.5026531219482422, -0.4372978210449219, 0.246490478515625, -0.3396015167236328, -0.00363922119140625, -1.2763588428497314, -0.04862213134765625, -0.22246360778808594, 0.46280479431152344, 0.2476506233215332, -0.37200355529785156, -0.5857143402099609, -0.1593017578125, -0.4753732681274414, -0.10328960418701172, 0.6187520027160645, -0.13356399536132812, 0.8429145812988281, -0.5051403045654297, 0.5655393600463867, 9.00831413269043, -0.7679824829101562, -0.5888023376464844, -0.24892425537109375, 0.5049209594726562, -0.09609031677246094, -7.052576541900635, -0.11846351623535156, -0.2740529179573059, -0.7350335121154785, -0.7352304458618164, -0.061041831970214844, -0.26180267333984375, 0.0439305305480957, -0.9744879603385925, -0.10347938537597656, -5.5869245529174805, -0.017332077026367188, -1.5690679550170898, -0.4170398712158203, -0.8232440948486328, 0.17047500610351562, -2.0631303787231445, -0.2885398864746094, -0.17645835876464844, -0.7971930503845215, 0.5142536163330078, 0.09285163879394531, -0.19158077239990234, 0.16236591339111328, 0.026500701904296875, 0.6709880828857422, -0.4092521667480469, 0.38187599182128906, 6.975351810455322, -8.537065505981445, -0.023586273193359375, 0.026859283447265625, -0.04007530212402344, 0.16773772239685059, -1.23553466796875, 1.5342073440551758, 0.016054153442382812, -6.308162689208984, 0.2139739990234375, 1.0853042602539062, 0.18829917907714844, 0.4599270820617676, 0.0041675567626953125, -0.517259955406189, 0.5046195983886719, 3.505563735961914, -0.9152998924255371, -0.16071224212646484, 0.3233203887939453, -0.04808616638183594, -0.7482107877731323, -0.3525271415710449, -0.853269100189209, 0.27152252197265625, -0.1261310577392578, -0.6353912353515625, -4.982040882110596, 0.166473388671875, -0.13272953033447266, -7.017788887023926, -0.5535411834716797, 0.3034687042236328, -1.4092998504638672, -0.07659912109375, -0.8342952728271484, 1.1638927459716797, -0.03436565399169922, -0.509246826171875, 0.17354393005371094, -0.7760829925537109, -0.7123746871948242, 0.15103912353515625, 0.12302970886230469, 0.48944568634033203, -0.9744879603385925, -0.5400028228759766, -0.3837776184082031, 0.043763160705566406, -0.011899948120117188, -0.17668724060058594, 0.32568931579589844, 0.08974075317382812, 0.7217397689819336, -0.9040184020996094, 0.3758878707885742, -0.9879913330078125, -1.4175024032592773, 0.025775909423828125, 0.270904541015625, -0.6133213043212891, 0.2573394775390625, 0.2828245162963867, -0.4728546142578125, 0.4697227478027344, -1.015320062637329, -0.11102962493896484, -0.06188774108886719, 0.705169677734375, -0.8435087203979492, -0.05419349670410156, -0.9311037063598633, 0.42017459869384766, -0.13628864288330078, 0.21199440956115723, 0.8705689907073975, 0.36873435974121094, 0.7344064712524414, -0.08647394180297852, -0.3614034652709961, 0.4880180358886719, -1.5411548614501953, 0.052075862884521484, -5.675386428833008, 0.018483638763427734, 2.7420639991760254, -1.5159969329833984, -0.048397064208984375, -0.3626585006713867, -0.12301826477050781, -0.13922882080078125, -3.346637725830078, 0.2769288420677185, -5.121126174926758, 1.5639076232910156, 0.3468456268310547, -0.0694122314453125, 1.0172500610351562, -0.7861537933349609, -0.053119659423828125, -0.5351352691650391, -10.213154792785645, 0.11444664001464844, -0.45960235595703125, -0.7350335121154785, 3.544706344604492, -0.32122230529785156, 5.029965400695801, 0.02688312530517578, -0.3116264343261719, 1.6774303913116455, 0.15621280670166016, -0.23571300506591797, 0.23268556594848633, -0.20418739318847656, 0.018515586853027344, 0.7058305740356445, -0.5181293487548828, -0.12650012969970703, 0.29109764099121094, 0.8270468711853027, 0.6934280395507812, 17.013538360595703, 0.03977775573730469, 3.5502805709838867, 0.22432518005371094, -1.4383506774902344, -4.653535842895508, -0.5029058456420898, 0.7226047515869141, -0.04754447937011719, 0.023984909057617188, 0.1312570571899414, 0.287628173828125, 0.1709423065185547, -0.45651721954345703, -0.9657993316650391, -0.45725440979003906, 0.19852638244628906, 0.41127681732177734], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 62464, "num_env_steps_trained": 288300, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 288300, "last_target_update_ts": 62464, "num_target_updates": 121}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -48.84840842545032, "episode_len_mean": 238.79, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521], "episode_lengths": [218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5477547517500697, "mean_inference_ms": 24.297210184037894, "mean_action_processing_ms": 0.13392546094675226, "mean_env_wait_ms": 4.420601123398652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -793.7732945084572, "episode_reward_mean": -48.84840842545032, "episode_len_mean": 238.79, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.171865351498127, -63.79248657077551, -147.57763646543026, -111.17078359425068, -793.7732945084572, -3.8352138474583626, -3.199018992483616, 7.228314056992531, 32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521], "episode_lengths": [218, 268, 281, 274, 450, 218, 245, 199, 216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5477547517500697, "mean_inference_ms": 24.297210184037894, "mean_action_processing_ms": 0.13392546094675226, "mean_env_wait_ms": 4.420601123398652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 288300, "num_env_steps_sampled": 62464, "num_env_steps_trained": 288300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 62464, "agent_timesteps_total": 62464, "timers": {"training_iteration_time_ms": 351.664, "learn_time_ms": 70.792, "learn_throughput": 4237.762, "synch_weights_time_ms": 20.596}, "counters": {"num_env_steps_sampled": 62464, "num_env_steps_trained": 288300, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 288300, "last_target_update_ts": 62464, "num_target_updates": 121}, "done": false, "episodes_total": 231, "training_iteration": 61, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-30-01", "timestamp": 1655494201, "time_this_iter_s": 5.708598613739014, "time_total_s": 327.5390405654907, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 327.5390405654907, "timesteps_since_restore": 0, "iterations_since_restore": 61, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.975, "ram_util_percent": 64.4125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 15.026664733886719, "min_q": -17.71332359313965, "max_q": 38.623104095458984, "mean_td_error": -0.15294918417930603}, "td_error": [-4.506002426147461, -10.978759765625, 10.859147071838379, -1.5382459163665771, 0.5201272964477539, -0.15238475799560547, -0.23846149444580078, 1.1098308563232422, -0.1322650909423828, 0.4299468994140625, -1.5095853805541992, -0.16136932373046875, 1.1152887344360352, -0.15001201629638672, 0.1193532943725586, -1.6445393562316895, -0.1667623519897461, 3.344893455505371, 0.36064910888671875, -0.010692596435546875, -0.7830104827880859, 1.875204086303711, -0.33916473388671875, 0.21767044067382812, -2.338247299194336, 0.1336817741394043, 0.4430370330810547, -0.14858627319335938, 1.6409969329833984, 0.07210159301757812, 0.3806610107421875, -0.8233366012573242, -0.43247032165527344, 0.9449143409729004, -0.24264907836914062, -0.2777519226074219, -0.1146697998046875, 0.28139591217041016, 0.5749483108520508, 0.3333168029785156, 0.1752452850341797, -0.3596963882446289, -0.8059597015380859, -0.17734909057617188, -0.5853118896484375, -1.3895130157470703, 0.6677494049072266, -0.07602310180664062, -0.559300422668457, 0.0915679931640625, -0.25426483154296875, -0.7331886291503906, 1.0959186553955078, -0.6477832794189453, 0.4778156280517578, 1.0309162139892578, 0.13914871215820312, -0.3490285873413086, -0.07214736938476562, -0.5776157379150391, 0.19623947143554688, -0.6628627777099609, 1.396139144897461, -0.9022464752197266, -2.491006851196289, 0.4983673095703125, -0.1878185272216797, -4.756923675537109, -0.2035846710205078, -0.1672534942626953, -0.0913238525390625, -0.6721611022949219, 0.29613304138183594, -5.993856430053711, 0.3486919403076172, 0.05743217468261719, -4.469076156616211, 1.2830448150634766, 0.5306358337402344, 0.07638883590698242, 0.017307281494140625, 1.3905696868896484, 0.48214197158813477, -0.754633903503418, -0.15549659729003906, 0.2141437530517578, 0.16347122192382812, -0.9492688179016113, -0.34111976623535156, 0.3888740539550781, 0.06963539123535156, -1.107219934463501, 0.4054832458496094, 2.294139862060547, 0.1849822998046875, 0.2317676544189453, -0.6775856018066406, -0.5386180877685547, -0.9206295013427734, -0.32752394676208496, -1.9032516479492188, 8.571147918701172e-05, 0.26261091232299805, -0.25458526611328125, 0.07216835021972656, 0.5522747039794922, -0.06084442138671875, 5.808685779571533, -1.0592117309570312, 0.38550758361816406, 1.3516216278076172, -0.2277660369873047, -0.7792644500732422, 1.598764419555664, 1.9501848220825195, -0.6642904281616211, -5.819826126098633, 0.0073947906494140625, 0.09448432922363281, 0.6055984497070312, -1.0800762176513672, 4.798226833343506, 0.5874948501586914, 0.6720142364501953, 0.4620208740234375, -0.16650772094726562, -0.36740875244140625, -0.5762801170349121, -1.2052850723266602, 0.23387908935546875, -0.5892806053161621, 0.8635530471801758, 2.327241897583008, 1.0523395538330078, -0.12392044067382812, -0.5897693634033203, -0.17907047271728516, -0.004245758056640625, 0.35436153411865234, -8.847939491271973, 0.41675376892089844, 0.9006366729736328, 0.7740392684936523, 1.6669445037841797, -0.38636016845703125, -0.3899383544921875, -0.55621337890625, 0.5428295135498047, -0.12128543853759766, -4.880205154418945, 1.4587030410766602, 0.9311106204986572, 0.652461051940918, -0.5480508804321289, -5.484026908874512, 15.567584037780762, 1.2013025283813477, 0.4564981460571289, 1.2526130676269531, -0.17366600036621094, -0.28740978240966797, 0.27155017852783203, -0.5737104415893555, -0.11363458633422852, -0.8055610656738281, -0.05973625183105469, 0.2485980987548828, -0.4382162094116211, -1.5733652114868164, 0.37457847595214844, 0.7994136810302734, 0.6944484710693359, 0.4763627052307129, 0.10708999633789062, -0.4709615707397461, 0.2453784942626953, -7.1187334060668945, -5.560674667358398, 0.5336933135986328, -0.6696786880493164, 5.71663761138916, 0.4544229507446289, -0.6967334747314453, -0.11835861206054688, 0.9678573608398438, 0.28099632263183594, -0.9448776245117188, 1.2827873229980469, 0.0772848129272461, 0.40490245819091797, -0.4388408660888672, -0.9212075471878052, 1.0781993865966797, -0.3198566436767578, 0.3129711151123047, 0.06612968444824219, -0.19814157485961914, -0.4759635925292969, 0.6885223388671875, 0.21990394592285156, -0.5071344375610352, -1.4709577560424805, 0.4328877925872803, -0.08603763580322266, -0.24656963348388672, -0.2860851287841797, 0.7836570739746094, -0.46810150146484375, 0.40420281887054443, 0.5789947509765625, -0.2282257080078125, -0.17696762084960938, -5.022590637207031, -0.6074943542480469, -0.9015340805053711, 0.018532752990722656, 1.9120850563049316, -0.6636219024658203, -0.9352445602416992, 0.9010162353515625, -0.22055530548095703, -5.276949882507324, -0.34560394287109375, -0.7331886291503906, 1.06610107421875, -0.10463523864746094, 0.05433845520019531, -0.6848630905151367, 0.24414539337158203, -0.5792722702026367, -5.227575302124023, -5.286960601806641, 0.31888580322265625, -0.32956504821777344, -0.19129276275634766, -9.603456497192383, -0.017530441284179688, 0.9585866928100586, 0.03709983825683594, 7.741832733154297, -0.43150997161865234, 0.1448841094970703, -0.3197479248046875, -0.7242469787597656, -8.179105758666992, 0.3102893829345703, 0.1851358413696289, 0.6217842102050781, -0.23949050903320312, -0.25510215759277344, -0.6418113708496094, -0.6937313079833984, -0.46439075469970703, -0.2024250030517578, 0.2361736297607422, 0.11077690124511719, 0.7297248840332031, -0.09337997436523438, -0.19532465934753418, -0.6403522491455078, -1.7034034729003906, -0.10117340087890625, -1.5793743133544922, -0.07038021087646484, 1.3645529747009277, -0.3899383544921875, 0.4042396545410156, 0.13680267333984375, -1.1262836456298828, 0.00490570068359375, -0.26971435546875, 0.7933244705200195, 0.7499828338623047, -0.39005470275878906, 0.2645244598388672, 0.1521282196044922, 0.8390674591064453, -0.6523857116699219, -0.7213859558105469, -1.0561847686767578, 0.5153217315673828, 1.4487171173095703, 0.6998510360717773, 16.900442123413086, 0.3199291229248047, 1.0706777572631836, 0.2900257110595703, -7.659746170043945, -1.3002426624298096, -3.6363887786865234, -0.10911130905151367, 0.11190032958984375, 0.37889862060546875, 0.12681198120117188, 0.253082275390625, -0.38872480392456055, -0.4597625732421875, -0.3708972930908203, -1.026803970336914, 0.13926982879638672], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 63488, "num_env_steps_trained": 293100, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 293100, "last_target_update_ts": 63488, "num_target_updates": 123}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -595.5982278063893, "episode_reward_mean": -46.02044211141765, "episode_len_mean": 237.59, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846], "episode_lengths": [216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5489088904738274, "mean_inference_ms": 24.30985936511143, "mean_action_processing_ms": 0.1337225243940647, "mean_env_wait_ms": 4.423654706094437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -595.5982278063893, "episode_reward_mean": -46.02044211141765, "episode_len_mean": 237.59, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846], "episode_lengths": [216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5489088904738274, "mean_inference_ms": 24.30985936511143, "mean_action_processing_ms": 0.1337225243940647, "mean_env_wait_ms": 4.423654706094437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 293100, "num_env_steps_sampled": 63488, "num_env_steps_trained": 293100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 63488, "agent_timesteps_total": 63488, "timers": {"training_iteration_time_ms": 356.63, "learn_time_ms": 70.24, "learn_throughput": 4271.082, "synch_weights_time_ms": 21.311}, "counters": {"num_env_steps_sampled": 63488, "num_env_steps_trained": 293100, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 293100, "last_target_update_ts": 63488, "num_target_updates": 123}, "done": false, "episodes_total": 239, "training_iteration": 62, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-30-06", "timestamp": 1655494206, "time_this_iter_s": 5.722373008728027, "time_total_s": 333.26141357421875, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 333.26141357421875, "timesteps_since_restore": 0, "iterations_since_restore": 62, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.412499999999998, "ram_util_percent": 64.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.762054443359375, "min_q": -15.837996482849121, "max_q": 32.6956901550293, "mean_td_error": -0.7046613693237305}, "td_error": [-0.45595550537109375, 0.1931605339050293, -0.7166042327880859, 0.35311031341552734, 0.24940872192382812, 0.7324962615966797, -0.3906745910644531, 0.5334477424621582, -0.12408065795898438, -6.1268110275268555, 0.36797046661376953, 0.1805887222290039, 1.2392654418945312, -0.08084678649902344, -1.3225011825561523, -9.911787033081055, -0.2583951950073242, 0.22934818267822266, 0.6268081665039062, 0.3528919219970703, 1.3866891860961914, -0.6408042907714844, -0.7096157073974609, -5.847455978393555, -0.9336930513381958, -0.031352996826171875, -4.270334243774414, -3.6505165100097656, 1.2813987731933594, -0.3565797805786133, 0.1392364501953125, 1.4319767951965332, -0.3057289123535156, -1.0041303634643555, -0.4439868927001953, -0.0055084228515625, 0.9594306945800781, 9.512149810791016, 0.5122947692871094, -1.0778433084487915, -3.886594772338867, -4.528598785400391, -0.2621040344238281, -0.29788970947265625, -10.646444320678711, 1.2776374816894531, -0.1091156005859375, -0.12440109252929688, 0.4440593719482422, 2.1816701889038086, 1.9534273147583008, -0.6179876327514648, -0.7253608703613281, 0.9491510391235352, -0.8335056304931641, 0.011570930480957031, -6.647619247436523, -4.365967750549316, -0.25878238677978516, -0.23111915588378906, -0.6411342620849609, -0.185821533203125, 10.618088722229004, 0.23421287536621094, -0.27753543853759766, 0.7127017974853516, -0.07743644714355469, -0.04181861877441406, 1.0175609588623047, -0.2891731262207031, 0.025289535522460938, -1.8597049713134766, 0.32106781005859375, -0.4988384246826172, -0.19175004959106445, 0.46955299377441406, 0.1905517578125, -0.4628105163574219, -0.1131134033203125, -0.10765838623046875, -9.731668472290039, 0.2639474868774414, -7.023586273193359, 0.21387434005737305, 0.08390998840332031, -5.070987701416016, -0.3974487781524658, 0.14795875549316406, 0.4219684600830078, 1.0193824768066406, -5.162330627441406, 0.36095523834228516, -0.4048480987548828, 1.1629743576049805, 0.22224807739257812, 0.26263904571533203, -7.248990058898926, -0.542572021484375, -0.32811832427978516, -0.38857460021972656, -0.9540233612060547, 1.776789665222168, -1.6516828536987305, 9.497366905212402, 0.14484024047851562, -3.182482957839966, 0.11663627624511719, 0.31249046325683594, -8.918119430541992, -0.5234355926513672, -3.4884395599365234, -10.088239669799805, -2.3420753479003906, 0.5705776214599609, 0.19414520263671875, 0.6485862731933594, -0.3410682678222656, -1.4381587505340576, -0.6891841888427734, -0.6162300109863281, -0.2853507995605469, -0.28559112548828125, -0.3823413848876953, -0.5552244186401367, 0.6271190643310547, -0.8866119384765625, 0.11970329284667969, -6.429543495178223, -0.25875282287597656, -0.176239013671875, 0.2950325012207031, -0.04682159423828125, 0.3517475128173828, -0.18540239334106445, 0.19890213012695312, 0.17513799667358398, -0.60247802734375, -0.5806350708007812, 0.012456893920898438, -6.644359588623047, -0.26981449127197266, 0.22555160522460938, -0.44211769104003906, -2.031513214111328, -0.13761520385742188, 4.55402946472168, 0.8767690658569336, -0.34250086545944214, 0.10844039916992188, -2.457148551940918, -2.7190113067626953, -0.3144359588623047, 0.04182624816894531, -0.08702903985977173, -0.2222309112548828, -7.3435516357421875, -0.5677108764648438, 0.7625770568847656, -1.2756023406982422, 0.025142669677734375, -0.8921031951904297, -0.8356943130493164, -9.753665924072266, -0.07736015319824219, -0.05205535888671875, 0.306182861328125, -0.09247016906738281, -0.8189773559570312, -0.5230472087860107, 0.5964260101318359, -0.34250086545944214, 0.5727682113647461, -0.1793813705444336, 0.2567434310913086, 1.0175609588623047, -0.04939079284667969, -0.32703208923339844, 0.999455451965332, 0.37624120712280273, 0.08290290832519531, -1.7827434539794922, -0.5917892456054688, -5.554697036743164, -1.471994161605835, -0.6498994827270508, -0.09494590759277344, 0.07479286193847656, -0.4778251647949219, -2.459064483642578, 0.7954826354980469, -0.2305889129638672, -0.7703509330749512, -0.9052495956420898, -2.1117711067199707, 0.19799232482910156, -0.10478591918945312, 0.10339069366455078, -0.3648204803466797, -0.6856613159179688, -2.6490490436553955, 0.10691261291503906, 0.2066650390625, 0.07609367370605469, -1.103769302368164, -0.2729644775390625, 2.1428680419921875, -3.864774703979492, -0.9675202369689941, 0.12130928039550781, 0.6255712509155273, -9.731668472290039, 1.4208717346191406, -0.9372920989990234, 0.25614356994628906, -7.175854682922363, -0.9488735198974609, -1.3069324493408203, 0.025256633758544922, -0.9469852447509766, 0.15671539306640625, 1.72711181640625, -2.053513288497925, 1.1205520629882812, -2.930781364440918, 0.5624227523803711, -8.964021682739258, -0.020708084106445312, -2.473278045654297, 1.0114555358886719, 0.17568016052246094, -2.435858726501465, -6.334728240966797, 0.3910975456237793, -0.47258949279785156, -10.920042037963867, 0.12181472778320312, -0.5680437088012695, 0.2298583984375, 0.7320690155029297, 0.20105743408203125, 0.03526496887207031, -0.0644388198852539, -0.6874961853027344, -1.5373191833496094, -0.08084678649902344, -0.33793163299560547, -0.2749786376953125, -0.4173011779785156, 1.0932559967041016, 0.17288565635681152, -0.043781280517578125, -0.11375999450683594, -0.3000164031982422, -0.01275634765625, 1.7728147506713867, -0.10434341430664062, -0.10909652709960938, -0.4193305969238281, 1.0645809173583984, 0.5679798126220703, -1.2295341491699219, -0.4734458923339844, -0.3147697448730469, -0.05402946472167969, -0.04867744445800781, -0.5017127990722656, 1.9423274993896484, -0.34008216857910156, 0.07103538513183594, 0.27628326416015625, 0.34157371520996094, -0.5631661415100098, 0.8965892791748047, -0.08702903985977173, -0.44730567932128906, -1.0716915130615234, -0.4747180938720703, 0.061187744140625, 0.34715843200683594, -0.009645462036132812, 0.06050682067871094, 0.19052505493164062, -0.8085920810699463, -0.1313236951828003, 0.3000020980834961, -6.384197235107422, -1.1908369064331055, 1.158487319946289, -1.062345027923584, -1.0887451171875, -0.04213690757751465, 0.30562782287597656, 0.08783626556396484, 0.09341049194335938, -4.409786224365234, 0.650543212890625, -0.16840076446533203, 1.7959175109863281, 0.0308990478515625, -0.29642391204833984], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 297900, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 297900, "last_target_update_ts": 64512, "num_target_updates": 125}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -595.5982278063893, "episode_reward_mean": -46.02044211141765, "episode_len_mean": 237.59, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846], "episode_lengths": [216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5489088904738274, "mean_inference_ms": 24.30985936511143, "mean_action_processing_ms": 0.1337225243940647, "mean_env_wait_ms": 4.423654706094437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -595.5982278063893, "episode_reward_mean": -46.02044211141765, "episode_len_mean": 237.59, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.411537662148476, 16.869057714939117, -196.2954170331359, 11.207755401730537, -41.16629871726036, -45.15776780992746, -81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846], "episode_lengths": [216, 224, 284, 232, 257, 255, 251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5489088904738274, "mean_inference_ms": 24.30985936511143, "mean_action_processing_ms": 0.1337225243940647, "mean_env_wait_ms": 4.423654706094437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 297900, "num_env_steps_sampled": 64512, "num_env_steps_trained": 297900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 64512, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 331.942, "learn_time_ms": 72.068, "learn_throughput": 4162.73, "synch_weights_time_ms": 20.787}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 297900, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 297900, "last_target_update_ts": 64512, "num_target_updates": 125}, "done": false, "episodes_total": 239, "training_iteration": 63, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-30-12", "timestamp": 1655494212, "time_this_iter_s": 5.234865188598633, "time_total_s": 338.4962787628174, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 338.4962787628174, "timesteps_since_restore": 0, "iterations_since_restore": 63, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 34.474999999999994, "ram_util_percent": 64.17500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 15.128742218017578, "min_q": -15.017070770263672, "max_q": 39.1760139465332, "mean_td_error": -0.014954471960663795}, "td_error": [-0.4966697692871094, 1.3247032165527344, 0.6165924072265625, 0.46843576431274414, -0.954345703125, -0.8093967437744141, 0.2881317138671875, 0.8916130065917969, 0.10533332824707031, 0.1928424835205078, -1.8629369735717773, -0.2413616180419922, -1.1215476989746094, 0.06156349182128906, 1.7059803009033203, -0.49980926513671875, -0.25921058654785156, 0.6744556427001953, -0.6210107803344727, 1.1079065799713135, -0.8265397548675537, -0.12062740325927734, 0.3610725402832031, 0.055321693420410156, -7.246835708618164, -0.9051361083984375, -1.0181894302368164, -0.23905086517333984, 0.08778762817382812, 0.15348052978515625, -0.1399860382080078, 0.7410039901733398, 0.19160938262939453, 0.4240610599517822, -0.9079399108886719, 1.563432216644287, 0.3146495819091797, 0.3887166976928711, 0.033908843994140625, -0.3054790496826172, 0.06064414978027344, 1.2357711791992188, -1.534942626953125, -0.6858768463134766, -0.5761642456054688, 0.06122589111328125, -0.581298828125, -1.9461467266082764, -1.4982891082763672, 1.297780990600586, 0.3830423355102539, 0.6708030700683594, 1.1480684280395508, -2.1413793563842773, -0.7808318138122559, -0.29429054260253906, 0.5636296272277832, -0.47551727294921875, 0.5239658355712891, 0.47249507904052734, -0.1431446075439453, 14.088207244873047, 1.1944608688354492, -0.4519233703613281, 11.625985145568848, 0.3172721862792969, 0.9600925445556641, 0.7632989883422852, -0.02817535400390625, -1.534942626953125, 0.2508392333984375, 2.504678726196289, 0.9980506896972656, 0.5573787689208984, -1.1352119445800781, 0.39685630798339844, -0.6174564361572266, 0.09150314331054688, -0.3113441467285156, -0.02684783935546875, -0.6041622161865234, -0.12323284149169922, 0.22690773010253906, 0.17556381225585938, 0.613734245300293, 0.6083354949951172, 1.536397933959961, -0.16257447004318237, 0.34328460693359375, 0.25859832763671875, 0.034088134765625, 1.5295963287353516, -0.2864542007446289, 0.6818332672119141, 0.026953697204589844, -4.6603240966796875, 0.31435108184814453, -0.38317298889160156, -0.46059417724609375, 1.0993480682373047, 1.4321626424789429, 0.2750282287597656, -4.012474060058594, -1.4352874755859375, 0.9485874176025391, 0.6690828800201416, -1.2748212814331055, 0.3469276428222656, -2.248270034790039, -0.27493715286254883, 1.1553878784179688, 0.33625221252441406, 0.17722415924072266, 0.38021278381347656, -0.469393253326416, 0.6582107543945312, -0.5532045364379883, 0.20264434814453125, -0.057244300842285156, 0.8823356628417969, -0.9991550445556641, -0.48735713958740234, 1.0695457458496094, 12.79539966583252, 0.8287243843078613, -0.306732177734375, 0.8210582733154297, 0.6579780578613281, 1.6838741302490234, -0.18241500854492188, 0.30774688720703125, 0.3372802734375, -2.325137138366699, 1.1844730377197266, 0.27425670623779297, 2.307748794555664, -6.086905479431152, -0.5552213191986084, 0.13324546813964844, 0.3600602149963379, 0.3930835723876953, 0.3711566925048828, -0.09655570983886719, 0.05856513977050781, 0.634300708770752, -0.7694406509399414, 0.2610054016113281, 0.4628009796142578, 0.22023677825927734, 0.42644405364990234, 0.4706382751464844, -1.5331134796142578, 0.600703239440918, 0.25859832763671875, 0.06090354919433594, 0.7325811386108398, 0.10187911987304688, 0.45971107482910156, 1.6875004768371582, -8.345663070678711, -1.5500388145446777, -9.344438552856445, 0.1805553436279297, -0.10647869110107422, 0.48302650451660156, -0.2682838439941406, -0.04388618469238281, 1.8184494972229004, -0.4619903564453125, -0.7362442016601562, 0.31082820892333984, 0.7511148452758789, -0.47269248962402344, 0.20171165466308594, 0.7511148452758789, -2.249866485595703, -1.844095230102539, -0.029112815856933594, -0.10758399963378906, -0.8171367645263672, 2.4406580924987793, 0.31409263610839844, 2.6775436401367188, 0.09744644165039062, 0.3584403991699219, -0.807952880859375, 1.4858007431030273, 0.5893211364746094, 0.31542015075683594, 0.26404476165771484, 1.6482762098312378, 0.01934051513671875, -0.18473052978515625, 0.2001047134399414, 1.1311702728271484, -0.3010721206665039, -0.176666259765625, -0.3264350891113281, -0.1625375747680664, -0.34333133697509766, -0.1676478385925293, -0.6648244857788086, 0.6111602783203125, -1.3857011795043945, -1.0044682025909424, 0.2210845947265625, -3.5166311264038086, 1.4660511016845703, 0.8141737580299377, 0.26776885986328125, -0.5045976638793945, -0.05529308319091797, 0.9978790283203125, -0.05298805236816406, -25.51270294189453, 1.8714096546173096, 1.277191162109375, -0.10741043090820312, 0.8349399566650391, 1.1247491836547852, 0.11262702941894531, 1.0842504501342773, -0.7028770446777344, 0.3525371551513672, -0.2105426788330078, -0.432952880859375, -0.408966064453125, 0.573638916015625, 0.6288738250732422, -0.5278358459472656, -0.10678291320800781, -0.4522895812988281, 0.051921844482421875, 0.9765052795410156, -1.0271263122558594, -2.8439979553222656, -2.3409061431884766, 1.3710756301879883, 0.0236358642578125, 0.6402578353881836, -1.0390434265136719, 0.3083019256591797, -0.6395044326782227, -0.22322845458984375, -0.12826156616210938, 0.8245658874511719, 0.6128168106079102, -5.634068489074707, 0.11068248748779297, -0.4776115417480469, -0.3037109375, -0.05531501770019531, -2.135647773742676, 2.7448339462280273, 0.8925337791442871, 1.5295963287353516, -0.35561180114746094, 0.7403240203857422, 0.5696029663085938, 0.48041534423828125, -0.01668071746826172, -1.0450477600097656, -1.294424057006836, -0.6389503479003906, 0.16903114318847656, 0.4348773956298828, 8.145026206970215, 0.3165750503540039, -1.1986699104309082, 2.7056541442871094, 0.1538867950439453, -1.5415019989013672, 0.16514968872070312, 0.5780858993530273, 1.0154304504394531, 0.5054969787597656, -0.8730592727661133, -0.13333892822265625, 0.8602542877197266, 0.3920478820800781, 0.5023269653320312, -0.9104118347167969, 1.262324333190918, 0.05178260803222656, 0.5060033798217773, 0.42516136169433594, -0.08752250671386719, 0.7343006134033203, -0.4199199676513672, -0.7531095743179321, -6.761163711547852, 1.2214107513427734, -0.7669563293457031, -0.13080596923828125, 0.5994606018066406, 0.5569648742675781, 0.03620433807373047, -0.2036895751953125, -0.0980081558227539, -0.5107889175415039], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 65536, "num_env_steps_trained": 302700, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 302700, "last_target_update_ts": 65536, "num_target_updates": 127}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -595.5982278063893, "episode_reward_mean": -42.998595380038026, "episode_len_mean": 235.66, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784], "episode_lengths": [251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5506173943007806, "mean_inference_ms": 24.337497584670608, "mean_action_processing_ms": 0.1335145750724537, "mean_env_wait_ms": 4.436545724357756, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -595.5982278063893, "episode_reward_mean": -42.998595380038026, "episode_len_mean": 235.66, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-81.067667581141, -26.699999794363976, -88.02060582488775, 10.300902605056763, -6.3047381192445755, 5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784], "episode_lengths": [251, 252, 259, 189, 230, 199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5506173943007806, "mean_inference_ms": 24.337497584670608, "mean_action_processing_ms": 0.1335145750724537, "mean_env_wait_ms": 4.436545724357756, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 302700, "num_env_steps_sampled": 65536, "num_env_steps_trained": 302700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 65536, "agent_timesteps_total": 65536, "timers": {"training_iteration_time_ms": 357.222, "learn_time_ms": 71.059, "learn_throughput": 4221.836, "synch_weights_time_ms": 21.388}, "counters": {"num_env_steps_sampled": 65536, "num_env_steps_trained": 302700, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 302700, "last_target_update_ts": 65536, "num_target_updates": 127}, "done": false, "episodes_total": 245, "training_iteration": 64, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-30-18", "timestamp": 1655494218, "time_this_iter_s": 5.7175188064575195, "time_total_s": 344.2137975692749, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 344.2137975692749, "timesteps_since_restore": 0, "iterations_since_restore": 64, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.5625, "ram_util_percent": 64.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 13.26180362701416, "min_q": -16.016931533813477, "max_q": 33.12482452392578, "mean_td_error": -0.1608920693397522}, "td_error": [-4.338602066040039, 0.9344568252563477, -1.4255733489990234, -0.24017333984375, -0.21284103393554688, 0.22084808349609375, 0.5466079711914062, -0.24800682067871094, 0.48240089416503906, -0.5134868621826172, 1.5626029968261719, 1.9381799697875977, -0.18183326721191406, -2.213819980621338, -11.185216903686523, -0.5606245994567871, -2.4701852798461914, -1.0113115310668945, -0.16409778594970703, 0.5055961608886719, 0.15214109420776367, -1.0087337493896484, -0.5480709075927734, -0.0918426513671875, 0.24554824829101562, 0.7422884702682495, -0.3770937919616699, -1.7740764617919922, -0.4158744812011719, 1.3985729217529297, 0.27478790283203125, 0.05628538131713867, -2.1415176391601562, 1.5626029968261719, -0.011756420135498047, 0.38400840759277344, 0.7830390930175781, -0.3892331123352051, 1.5831565856933594, 0.2735166549682617, -5.852621078491211, 0.011989593505859375, 1.2002439498901367, 1.2116069793701172, 0.06589889526367188, 1.3849897384643555, 1.3283398151397705, 0.09096813201904297, -0.6054143905639648, -0.2455921173095703, -0.053745269775390625, 0.17232608795166016, 0.8138303756713867, 0.42083603143692017, -1.0617380142211914, -0.2876853942871094, -0.3251829147338867, -0.26592445373535156, -0.09894847869873047, 0.4258594512939453, -0.1614990234375, -0.8776223659515381, -1.4915947914123535, -0.04677104949951172, 1.6104011535644531, -1.133580207824707, -5.1541852951049805, 0.35430335998535156, -0.00909423828125, -0.43962669372558594, -0.38675689697265625, 0.4700307846069336, 0.3821554183959961, -0.07535648345947266, -1.6797847747802734, -0.26140594482421875, -0.05767393112182617, 0.07881641387939453, 0.07620525360107422, 0.5178718566894531, -0.2761249542236328, -4.715031623840332, 1.7792110443115234, 0.03965616226196289, 6.455514430999756, -1.153193473815918, -0.08606719970703125, -0.12752532958984375, 0.722625732421875, -0.07146263122558594, -7.3970947265625, -1.5038938522338867, -0.26896095275878906, 2.0806636810302734, 0.15759849548339844, -0.14954710006713867, -1.0307302474975586, -10.833439826965332, -0.4396514892578125, -0.4552040100097656, -0.1441783905029297, 0.009325027465820312, 0.4065704345703125, -0.4887504577636719, -0.08096122741699219, -0.8742570877075195, 0.6623992919921875, -0.21407413482666016, 0.8975143432617188, -1.4504756927490234, -0.21257972717285156, 11.814555168151855, -0.6322250366210938, -2.555771827697754, -0.9210300445556641, -0.9754867553710938, -0.7558565139770508, -0.08645439147949219, -0.501251220703125, 1.79168701171875, -0.8264427185058594, 1.0932226181030273, -1.5799894332885742, 0.5196609497070312, 0.20534801483154297, 1.1622276306152344, -0.7671098709106445, -9.908445358276367, -0.8627185821533203, 0.06119203567504883, -0.16723155975341797, 0.9510006904602051, 0.30864620208740234, -0.9375104904174805, 1.541543960571289, -0.48368167877197266, -0.22338485717773438, -0.4310140609741211, 0.04916572570800781, -0.10425949096679688, -6.375774383544922, -0.268646240234375, 0.08286285400390625, 0.37024497985839844, -0.5546035766601562, 2.9941558837890625, -0.09161043167114258, -0.407379150390625, 1.554464340209961, 0.1620044708251953, -0.16254520416259766, -1.375216007232666, -1.2777528762817383, -0.13814544677734375, 0.013653755187988281, -0.10662078857421875, -1.4915947914123535, 8.500396728515625, -1.0176010131835938, -0.3267841339111328, 0.3633079528808594, -0.4269294738769531, -2.9510202407836914, 0.5521430969238281, 0.6333189010620117, 0.16006207466125488, 0.6077108383178711, -0.46425819396972656, 0.06783676147460938, -0.44472789764404297, 0.3772850036621094, 0.07636070251464844, -0.2300701141357422, -0.053325653076171875, -1.3826818466186523, 1.2024412155151367, -0.5095882415771484, -0.07689082622528076, -7.105853080749512, 0.41210460662841797, 0.17390823364257812, 0.5665035247802734, -1.2645587921142578, 1.3277716636657715, -0.5699234008789062, 0.14035892486572266, -0.1039276123046875, -1.2389745712280273, 12.555180549621582, -7.07286262512207, -0.5140950679779053, 0.28951072692871094, -0.68084716796875, 2.099618911743164, -0.3282051086425781, -0.5117454528808594, -2.609992027282715, -0.6941537857055664, 0.2348651885986328, 0.7517757415771484, 4.960274696350098, 0.2544088363647461, 0.19855690002441406, -0.5773868560791016, -5.560178756713867, -0.37114524841308594, -0.0068569183349609375, -0.031147003173828125, -0.31360626220703125, -0.1275005340576172, -1.9059257507324219, -0.4248085021972656, 0.25386714935302734, 0.2200946807861328, -1.887476921081543, -0.8279733657836914, -0.14301109313964844, 0.2778472900390625, 0.15077781677246094, 0.2755889892578125, 0.06411552429199219, -0.03471946716308594, 0.6026191711425781, -0.6922140121459961, -5.272222518920898, 0.06258392333984375, -0.676795482635498, -0.2839622497558594, -0.3417167663574219, 0.17633056640625, 5.461614608764648, 0.23203659057617188, 0.10306930541992188, -0.3759174346923828, -1.6780805587768555, 0.26580142974853516, 0.43393898010253906, -0.8206157684326172, 1.1576290130615234, 0.31694793701171875, -0.5242618918418884, 8.622928619384766, -0.34580230712890625, -0.44472789764404297, 0.23713159561157227, 0.414703369140625, -0.2760796546936035, -1.7026634216308594, 0.6749072074890137, -0.35105133056640625, -0.1039276123046875, -0.4188823699951172, -0.8857898712158203, -0.1401653289794922, -0.06304359436035156, -0.810027003288269, -0.5219640731811523, -0.5992565155029297, 1.2689437866210938, 1.2052993774414062, 1.1669559478759766, -1.5096478462219238, -0.44285011291503906, -0.5641422271728516, -1.6191494464874268, 0.06589889526367188, -0.19780921936035156, 0.5653305053710938, 1.0003128051757812, -0.7970123291015625, 2.473808765411377, 0.8262758255004883, 0.78680419921875, 1.0201950073242188, 0.580744743347168, 1.092376708984375, -1.0233502388000488, 0.2349414825439453, 0.10238456726074219, -0.40778040885925293, 11.416621208190918, 0.7624473571777344, 0.04917335510253906, -0.09785079956054688, -1.0800540447235107, 0.5892411470413208, -5.053295135498047, 1.0343666076660156, -0.15863418579101562, -1.2647943496704102, -1.1401500701904297, 7.706545829772949, -0.5257453918457031, 0.2555046081542969, -5.134137153625488, -0.46063232421875, 0.2535676956176758, -0.04955768585205078, -0.5677947998046875, -0.13258934020996094], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 66560, "num_env_steps_trained": 307500, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 307500, "last_target_update_ts": 66560, "num_target_updates": 129}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -595.5982278063893, "episode_reward_mean": -41.93446971602738, "episode_len_mean": 234.96, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884], "episode_lengths": [199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519323988885709, "mean_inference_ms": 24.359920941845406, "mean_action_processing_ms": 0.13375029985935102, "mean_env_wait_ms": 4.4418566488882725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -595.5982278063893, "episode_reward_mean": -41.93446971602738, "episode_len_mean": 234.96, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.579693131148815, -96.65707827359438, 10.652169287204742, -3.05596636980772, -2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884], "episode_lengths": [199, 268, 202, 222, 199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519323988885709, "mean_inference_ms": 24.359920941845406, "mean_action_processing_ms": 0.13375029985935102, "mean_env_wait_ms": 4.4418566488882725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 307500, "num_env_steps_sampled": 66560, "num_env_steps_trained": 307500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 66560, "agent_timesteps_total": 66560, "timers": {"training_iteration_time_ms": 346.495, "learn_time_ms": 73.266, "learn_throughput": 4094.686, "synch_weights_time_ms": 20.847}, "counters": {"num_env_steps_sampled": 66560, "num_env_steps_trained": 307500, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 307500, "last_target_update_ts": 66560, "num_target_updates": 129}, "done": false, "episodes_total": 250, "training_iteration": 65, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-30-24", "timestamp": 1655494224, "time_this_iter_s": 5.6491968631744385, "time_total_s": 349.86299443244934, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 349.86299443244934, "timesteps_since_restore": 0, "iterations_since_restore": 65, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.775, "ram_util_percent": 64.26249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.971748352050781, "min_q": -13.960132598876953, "max_q": 37.30401611328125, "mean_td_error": 0.10142306983470917}, "td_error": [-6.181161880493164, 0.36018943786621094, -0.5340523719787598, 0.2966651916503906, -0.9591407775878906, 0.26674652099609375, -0.18700647354125977, -10.024124145507812, 1.803976058959961, -5.898999214172363, -0.8312950134277344, 0.1939128041267395, -0.07150840759277344, 0.8941860198974609, -1.0194473266601562, -0.43361568450927734, 1.5384092330932617, 0.10271644592285156, 2.0334930419921875, 2.459444999694824, -0.08305025100708008, 1.4952983856201172, 0.09490776062011719, 0.36740684509277344, -0.12011337280273438, 0.1120452880859375, 0.6561164855957031, 8.659080505371094, 0.039363861083984375, 2.1013050079345703, 0.7276649475097656, 0.2572612762451172, 0.4486055374145508, -0.14576101303100586, -0.9683551788330078, 0.20325183868408203, 2.3944196701049805, -0.2334461212158203, 1.2316160202026367, -1.8592376708984375, -0.08238029479980469, -1.465066909790039, 0.5552787780761719, 0.11369705200195312, 0.3095207214355469, 3.551511764526367, 4.268008232116699, 0.18878650665283203, 0.2723045349121094, -1.5047683715820312, 0.11564826965332031, 23.483722686767578, 0.5238857269287109, 0.9055187702178955, 0.528564453125, -0.43342018127441406, 0.8800334930419922, 0.4780693054199219, 0.4788398742675781, -0.036441802978515625, 1.5976371765136719, 0.8054714202880859, 0.2842063903808594, 0.40689659118652344, 0.2025766372680664, 1.2653026580810547, -0.2130908966064453, -1.4927101135253906, 0.8861351013183594, 0.12976551055908203, 0.199462890625, 0.4598102569580078, -1.891103744506836, 0.5203080773353577, 0.7791872024536133, -1.1758718490600586, 0.6708955764770508, 0.22026634216308594, -2.672222137451172, 0.3497285842895508, 0.6534271240234375, 0.4050111770629883, -4.560903549194336, -0.3776397705078125, -0.5569754838943481, 0.1765880584716797, -0.6556758880615234, -0.2716398239135742, 0.18490219116210938, 0.22431373596191406, 0.12306976318359375, -1.360158920288086, 0.30454444885253906, -0.20246124267578125, 0.9144725799560547, 0.3759651184082031, -0.15388107299804688, 0.014434814453125, -0.6864614486694336, 0.414642333984375, -0.6400699615478516, 0.5214223861694336, -0.4876823425292969, 0.6037693023681641, 1.4572663307189941, -0.1254138946533203, 0.4013528823852539, -0.09343528747558594, 0.8063535690307617, -0.16268539428710938, -0.08545112609863281, 0.563960075378418, -0.533134937286377, 0.4353008270263672, 1.6107196807861328, 0.11989784240722656, 0.5014381408691406, 0.8300552368164062, 0.009424209594726562, -0.3414268493652344, -0.17792892456054688, 0.18207883834838867, -0.32464027404785156, -3.940852165222168, 1.1417665481567383, -0.404632568359375, -0.11234855651855469, 0.43804216384887695, -0.4738655090332031, -0.6205816268920898, 1.7540302276611328, -2.4843578338623047, -0.8109836578369141, 0.943187952041626, 0.5273990631103516, 0.07500076293945312, -0.052231788635253906, 0.2179088592529297, 0.2386627197265625, 0.37752628326416016, 0.17920684814453125, -0.6868457794189453, -5.469133377075195, 0.9655685424804688, 0.32828235626220703, 0.03610801696777344, 0.15452003479003906, 0.03266620635986328, -0.18499469757080078, 0.02851104736328125, 0.012493133544921875, 0.3369789123535156, -0.26353931427001953, 12.380745887756348, -0.269927978515625, 0.9075918197631836, 0.9546432495117188, -0.22064208984375, 1.072310447692871, -0.48001527786254883, 0.5633792877197266, 0.095184326171875, 2.0334930419921875, 0.5139694213867188, 0.10546684265136719, 0.9112730026245117, 1.3452038764953613, 0.42923545837402344, 0.19830119609832764, 0.0073394775390625, 1.3818426132202148, -0.750309944152832, -0.7473201751708984, 0.8099288940429688, -5.889440536499023, 0.36795997619628906, 1.553823471069336, 0.7361354827880859, 0.07458877563476562, -1.1375646591186523, 0.7025241851806641, -0.38198089599609375, 0.16072320938110352, -0.0187835693359375, 1.8819580078125, 0.7212200164794922, -6.877706527709961, -3.908700942993164, -0.46858787536621094, 0.6352490186691284, 13.092432975769043, -0.15161752700805664, -0.4713611602783203, -0.3852519989013672, 0.06132221221923828, 0.5147953033447266, 0.5018911361694336, 1.1408042907714844, -0.45073795318603516, 0.326723575592041, -0.17089080810546875, 0.15280723571777344, -0.2527608871459961, -0.004048347473144531, 0.3237648010253906, -4.844598770141602, -0.47640037536621094, -0.1297740936279297, -0.031566619873046875, -0.24379253387451172, 0.2795906066894531, 10.108561515808105, -0.18448734283447266, 0.04793119430541992, -7.213893890380859, 0.4131486415863037, -0.46118927001953125, 0.7176837921142578, -4.9668731689453125, -0.5584049224853516, 1.0110759735107422, 0.39489269256591797, -0.40367889404296875, -0.7393741607666016, -0.1668558120727539, 0.20702552795410156, -0.022674560546875, 0.07994842529296875, -7.762022018432617, -0.2012653350830078, -0.3634023666381836, -0.2682819366455078, 0.4601879119873047, -0.15438079833984375, -0.0410003662109375, 0.047878265380859375, 0.29563426971435547, -0.06786727905273438, -4.09602165222168, -0.428741455078125, 0.2202739715576172, -0.05373382568359375, -0.014583587646484375, -0.2016010284423828, -0.06267738342285156, 0.11160826683044434, 0.10905075073242188, 0.5069084167480469, -0.22745323181152344, 1.0280208587646484, -5.985198974609375, 0.29351234436035156, 0.6831142902374268, 0.008127450942993164, -4.006182670593262, 0.5751218795776367, 1.0042415857315063, 0.12156105041503906, 0.7940864562988281, -0.26680421829223633, -0.10028839111328125, 0.7946815490722656, 2.0920820236206055, -0.0491943359375, 0.12167930603027344, -0.019329071044921875, -0.4171905517578125, -0.1356945037841797, 0.26473331451416016, -0.202606201171875, 1.1518211364746094, -1.731668472290039, 0.5147953033447266, 0.010633468627929688, -2.364741325378418, -0.5625143051147461, -0.08340072631835938, 0.2041921615600586, -5.774204254150391, 0.12263679504394531, -0.6864614486694336, -0.1282196044921875, 0.6140756607055664, 0.9410114288330078, -2.5962650775909424, 1.0384862422943115, -0.5011329650878906, -0.35703182220458984, -0.026526927947998047, 0.2466135025024414, -0.029270172119140625, 0.1845378875732422, 0.2081775665283203, -2.447298049926758, 0.1227426528930664, -0.07363510131835938, 14.559455871582031, -0.4058523178100586, 1.0796613693237305, 0.38007068634033203], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 67584, "num_env_steps_trained": 312300, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 312300, "last_target_update_ts": 67584, "num_target_updates": 131}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -595.5982278063893, "episode_reward_mean": -40.76776245065034, "episode_len_mean": 235.03, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373], "episode_lengths": [199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.551767531501042, "mean_inference_ms": 24.35416629023949, "mean_action_processing_ms": 0.1335445393821476, "mean_env_wait_ms": 4.441291617710053, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -595.5982278063893, "episode_reward_mean": -40.76776245065034, "episode_len_mean": 235.03, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0999999344348907, -215.49537017941475, -30.024578727781773, 7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373], "episode_lengths": [199, 317, 237, 220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.551767531501042, "mean_inference_ms": 24.35416629023949, "mean_action_processing_ms": 0.1335445393821476, "mean_env_wait_ms": 4.441291617710053, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 312300, "num_env_steps_sampled": 67584, "num_env_steps_trained": 312300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 67584, "agent_timesteps_total": 67584, "timers": {"training_iteration_time_ms": 352.715, "learn_time_ms": 71.031, "learn_throughput": 4223.494, "synch_weights_time_ms": 20.908}, "counters": {"num_env_steps_sampled": 67584, "num_env_steps_trained": 312300, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 312300, "last_target_update_ts": 67584, "num_target_updates": 131}, "done": false, "episodes_total": 254, "training_iteration": 66, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-30-29", "timestamp": 1655494229, "time_this_iter_s": 5.62115216255188, "time_total_s": 355.4841465950012, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 355.4841465950012, "timesteps_since_restore": 0, "iterations_since_restore": 66, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.3875, "ram_util_percent": 64.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 12.658191680908203, "min_q": -14.524683952331543, "max_q": 31.374378204345703, "mean_td_error": -0.20574899017810822}, "td_error": [-0.09543800354003906, -0.791912317276001, 0.4329715371131897, 0.015359878540039062, -0.7711181640625, -1.0343055725097656, 0.47840213775634766, -0.19393587112426758, -6.1602783203125, 0.9451427459716797, 0.011722087860107422, -0.6584959030151367, 1.0631828308105469, 0.8129243850708008, -1.850149154663086, 0.6496524810791016, 0.8869037628173828, -0.14587020874023438, -0.21648788452148438, -1.2668018341064453, 0.018805980682373047, 0.8618254661560059, 0.15428733825683594, -1.0396480560302734, -0.2873525619506836, 0.9261264801025391, -0.013324737548828125, 0.21473979949951172, -0.3374767303466797, -0.47905826568603516, 0.42083263397216797, -0.3791618347167969, 0.3138103485107422, -2.7323150634765625, 0.11033821105957031, -0.48807334899902344, -0.7822837829589844, 0.2189640998840332, -0.09436798095703125, 0.2882499694824219, 0.03663444519042969, 0.7814044952392578, -0.019715607166290283, 0.9531431198120117, 0.2838897705078125, 0.19329071044921875, -6.284451484680176, 2.8507537841796875, -0.3634185791015625, -0.14170265197753906, 0.11945056915283203, -0.4202880859375, 0.1534595489501953, 0.13306903839111328, 0.690648078918457, -0.4587337374687195, -0.29389190673828125, -0.08138871192932129, -0.6157608032226562, 0.9580078125, -0.2673797607421875, 3.0887537002563477, -0.5034503936767578, 0.4061002731323242, -0.74664306640625, 0.1803884506225586, 0.3726806640625, 0.24580097198486328, 0.527267336845398, -7.197475433349609, -0.011631011962890625, -0.14026355743408203, -0.07083511352539062, 2.636436700820923, -0.21264076232910156, -6.574858665466309, -0.8755264282226562, 0.46135812997817993, -0.11726665496826172, 0.5974483489990234, 0.308349609375, 1.3563542366027832, 0.9797983169555664, 0.5231881141662598, -0.17069149017333984, -0.2638397216796875, -0.5771284103393555, -0.38028526306152344, 2.414944887161255, 0.058929443359375, 0.23160362243652344, 1.4019203186035156, 0.11553573608398438, -0.06864547729492188, 0.23319625854492188, -0.3695697784423828, -2.209693431854248, -0.03584861755371094, 0.26952171325683594, -0.20372772216796875, 0.4591197967529297, 0.15403079986572266, 0.056171417236328125, -0.07336044311523438, -0.21521949768066406, 0.7897262573242188, 0.2721843719482422, 15.136173248291016, 1.6442999839782715, 0.39600372314453125, 1.293548583984375, -0.33541297912597656, -1.2834105491638184, 0.027034759521484375, 0.22101974487304688, -0.636998176574707, -0.1603703498840332, -0.3477821350097656, -0.24718666076660156, -0.20218658447265625, -0.28391265869140625, 1.0410442352294922, 0.6830291748046875, 0.1504802703857422, 0.8335881233215332, 0.28105735778808594, 0.03986501693725586, -0.5700802803039551, -0.5532751083374023, 2.1531028747558594, -0.7589654922485352, -0.47905826568603516, -0.15001392364501953, -0.06879043579101562, 0.30451202392578125, -0.2353672981262207, -6.636983871459961, 8.738470077514648, 0.07603263854980469, 0.28089332580566406, -8.310770034790039, 0.7319984436035156, -0.30420875549316406, 0.015061378479003906, 0.8129243850708008, -0.1903209686279297, -0.13159561157226562, 1.2161407470703125, -0.17698287963867188, -0.6257038116455078, -0.9411373138427734, 0.4723323583602905, 0.4327402114868164, 0.44962501525878906, 1.1000823974609375, 1.004394292831421, -0.47086334228515625, -0.014636993408203125, -5.212892532348633, 0.275909423828125, -0.18721771240234375, 0.15032577514648438, 0.35344839096069336, -1.9174981117248535, 0.2309408187866211, -0.07222843170166016, 0.053394317626953125, -0.38010406494140625, -0.11726665496826172, -0.014636993408203125, 0.44993019104003906, -4.963649749755859, 0.2980222702026367, -0.27486562728881836, -0.05877399444580078, -0.17069149017333984, 0.4854726791381836, -0.029451370239257812, -0.16762733459472656, -0.09085845947265625, -0.1635589599609375, 0.8200750350952148, 0.2670001983642578, 1.8500385284423828, -0.6285238265991211, 0.14827919006347656, 0.024730682373046875, 0.29915618896484375, 0.83807373046875, 0.055535316467285156, 0.8825938701629639, -1.3867769241333008, -0.000217437744140625, 0.5883502960205078, -0.8228969573974609, 0.9181423187255859, 0.4548320770263672, 0.3679008483886719, -0.21343326568603516, -0.5482101440429688, -7.69211483001709, -0.2280902862548828, 0.0699472427368164, 0.1756153106689453, -0.02079010009765625, -0.6389894485473633, 0.17259597778320312, 0.3465118408203125, -0.19394207000732422, -0.05426216125488281, -0.00365447998046875, 0.46869850158691406, 0.05077934265136719, 1.039219856262207, 1.3783588409423828, -0.03928661346435547, -0.3330574035644531, -0.5088729858398438, 0.030656814575195312, 0.9064221382141113, -1.5497539043426514, 0.013919830322265625, -0.20672035217285156, -1.6046628952026367, -0.4595603942871094, 2.096567153930664, -0.0887136459350586, 0.9482619762420654, -0.36670494079589844, 1.3209037780761719, -0.7994146347045898, -0.10639667510986328, -0.2930574417114258, 0.2236003875732422, -0.008119583129882812, -0.5078396797180176, 0.9007816314697266, 0.5335483551025391, -0.2583003044128418, -7.83712100982666, -0.6592082977294922, 0.9432344436645508, -0.49552345275878906, -0.3044414520263672, -0.10802841186523438, 0.02471637725830078, -0.16493701934814453, 0.9024686813354492, -0.047677040100097656, 0.0415802001953125, -0.03505897521972656, -0.19262313842773438, -16.38015365600586, 0.009530067443847656, 1.5975255966186523, 1.3563804626464844, 0.01799488067626953, 0.06691896915435791, 1.1625862121582031, 0.2803659439086914, 0.23563766479492188, -0.0021209716796875, 1.7885932922363281, 0.17884254455566406, -0.8755264282226562, -0.8160133361816406, 0.8247857093811035, -9.409638404846191, -0.1523427963256836, 1.1177234649658203, 2.0438995361328125, -0.7901802062988281, -0.2391338348388672, 1.3266663551330566, -0.0795135498046875, 0.15417003631591797, -7.445276737213135, 0.10806465148925781, 0.41065406799316406, -0.09055280685424805, 0.06186389923095703, 0.036357879638671875, 0.11563682556152344, 0.2115459442138672, 0.13522720336914062, -0.03103160858154297, 0.41185855865478516, -2.169710159301758, -0.514225959777832, -6.302399635314941, 0.3067455291748047, -0.18153858184814453, -1.8282670974731445, -0.7554959058761597, -1.46588134765625, 0.4601097106933594, -7.209157943725586, -0.09539413452148438, -0.35266876220703125, 2.114553451538086], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 68608, "num_env_steps_trained": 317100, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 317100, "last_target_update_ts": 68608, "num_target_updates": 133}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -595.5982278063893, "episode_reward_mean": -39.42639930292964, "episode_len_mean": 234.79, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148], "episode_lengths": [220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520679500746992, "mean_inference_ms": 24.353456517973854, "mean_action_processing_ms": 0.13348219686099497, "mean_env_wait_ms": 4.4407920122309985, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -595.5982278063893, "episode_reward_mean": -39.42639930292964, "episode_len_mean": 234.79, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.670209161937237, 9.007755525410175, 14.210635505616665, -7.361050836741924, 14.71896842122078, -46.93868713825941, 8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148], "episode_lengths": [220, 198, 192, 229, 213, 250, 230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520679500746992, "mean_inference_ms": 24.353456517973854, "mean_action_processing_ms": 0.13348219686099497, "mean_env_wait_ms": 4.4407920122309985, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 317100, "num_env_steps_sampled": 68608, "num_env_steps_trained": 317100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 68608, "agent_timesteps_total": 68608, "timers": {"training_iteration_time_ms": 358.03, "learn_time_ms": 71.258, "learn_throughput": 4210.027, "synch_weights_time_ms": 20.905}, "counters": {"num_env_steps_sampled": 68608, "num_env_steps_trained": 317100, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 317100, "last_target_update_ts": 68608, "num_target_updates": 133}, "done": false, "episodes_total": 257, "training_iteration": 67, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-30-35", "timestamp": 1655494235, "time_this_iter_s": 5.5654213428497314, "time_total_s": 361.04956793785095, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 361.04956793785095, "timesteps_since_restore": 0, "iterations_since_restore": 67, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 33.075, "ram_util_percent": 64.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 12.234156608581543, "min_q": -12.764472961425781, "max_q": 38.29183578491211, "mean_td_error": -0.5976971983909607}, "td_error": [-0.6907296180725098, -0.3670072555541992, -0.1396465301513672, -0.13362598419189453, -0.11215972900390625, -0.2687501907348633, -0.2691946029663086, -0.0206146240234375, 0.111114501953125, -0.7439022064208984, -0.36064720153808594, 0.0217437744140625, -0.5338382720947266, 11.746323585510254, -0.3331947326660156, -0.7413234710693359, 0.7702827453613281, -1.7169532775878906, -1.09521484375, -7.717911720275879, -0.11928749084472656, -0.32911014556884766, -0.8657197952270508, -0.077911376953125, -0.3522958755493164, 1.3538689613342285, 0.08929157257080078, -0.8281357288360596, -0.131683349609375, -0.2082958221435547, -0.456756591796875, 0.9683941602706909, 0.8292703628540039, 6.860052108764648, 0.22181415557861328, -0.5842781066894531, -0.8709659576416016, -0.9983110427856445, 0.12345099449157715, -0.36224937438964844, -0.5918102264404297, -0.05650138854980469, 0.8746347427368164, -4.397539138793945, -0.28540611267089844, 0.7613277435302734, -6.474364280700684, -0.45641613006591797, -0.6081557273864746, 0.24190711975097656, 0.4233207702636719, 0.2809152603149414, -0.6031895875930786, -0.3762798309326172, -0.4032917022705078, 10.690118789672852, -0.32943153381347656, 0.32542848587036133, -0.7548561096191406, -0.8554916381835938, -0.22209930419921875, 0.8308687210083008, 0.3642253875732422, -0.23146629333496094, -0.8594627380371094, -0.8194103240966797, -0.35239505767822266, -1.002655029296875, -5.801399230957031, -1.1490116119384766, -0.2843589782714844, 0.6179275512695312, -0.6072444915771484, -0.7377347946166992, 1.1283760070800781, -0.5943043231964111, -0.4312882423400879, -0.5749891996383667, -0.5235195159912109, 0.3090705871582031, -1.539078712463379, -10.242101669311523, 0.015832901000976562, 0.5705146789550781, 0.03607368469238281, -0.44734764099121094, 0.7450275421142578, -0.00263214111328125, -0.06753921508789062, -2.5888586044311523, 1.0469228029251099, -0.3297278881072998, 0.9179286956787109, -0.38397216796875, -0.5236654281616211, -0.6060962677001953, -0.4930086135864258, 0.059945106506347656, 0.7681884765625, -0.8389797210693359, 0.8981571197509766, 0.13296127319335938, -0.740612268447876, -1.0815038681030273, -0.3958897590637207, -0.5417475700378418, -0.23146629333496094, 0.16349411010742188, -0.3122596740722656, -0.7831077575683594, -0.3259906768798828, -0.38086795806884766, -0.5361919403076172, 0.3844614028930664, 0.8503875732421875, -0.2608165740966797, -0.31057071685791016, 0.420382022857666, 1.2613067626953125, -0.016086578369140625, -0.3713083267211914, 0.14929676055908203, 1.5240602493286133, -0.5279645919799805, -7.044325828552246, -0.3911151885986328, -0.19617652893066406, -0.4481182098388672, -0.5979080200195312, -2.3143157958984375, 0.5146160125732422, -0.7778472900390625, 1.6577520370483398, -0.6061716079711914, -1.6376004219055176, -0.22498703002929688, -0.19185161590576172, -0.4041919708251953, -8.314830780029297, 4.459364891052246, -0.6546869277954102, -0.6121597290039062, -0.28784942626953125, -0.5236333012580872, -0.6652431488037109, -2.6210498809814453, -0.8281357288360596, -7.044325828552246, 1.3384647369384766, -0.5929059982299805, -0.7199001312255859, -0.8986568450927734, -0.6340404748916626, -9.694857597351074, -0.586890697479248, -0.4551868438720703, -0.09667778015136719, -0.4903678894042969, -0.42555999755859375, -1.0558700561523438, -0.5570049285888672, -0.4632740020751953, -0.29351234436035156, 0.22219085693359375, -0.6553864479064941, -1.599365234375, 0.5011138916015625, 0.43818092346191406, -0.22100067138671875, 0.06335163116455078, -2.169745445251465, -0.54534912109375, -0.676964282989502, 1.8422870635986328, -0.4312763214111328, -0.42873573303222656, 0.8162431716918945, -0.9830303192138672, -1.7095508575439453, -0.22188758850097656, -1.609262466430664, -1.4638288021087646, -6.476922988891602, -1.665655255317688, -0.34271240234375, -0.15259790420532227, -0.3006706237792969, -0.5465359687805176, -0.24178314208984375, -0.4656667709350586, -0.20758438110351562, -0.4676666259765625, -0.5605241060256958, -0.20832347869873047, -0.42310619354248047, -0.3150978088378906, -0.13083648681640625, -0.4287681579589844, -2.473601818084717, -0.5494246482849121, -0.5443820953369141, -0.2536964416503906, -0.5562648773193359, -0.7653875350952148, -0.03988838195800781, -0.058536529541015625, -0.17647171020507812, -0.8005900382995605, -0.4371681213378906, 0.059734344482421875, 0.04816913604736328, -1.3505401611328125, 0.021201133728027344, 0.2302861213684082, -0.4972350597381592, -0.1794757843017578, -0.9395370483398438, -0.13712596893310547, -4.526512145996094, -1.0177841186523438, -2.273116111755371, 8.542794227600098, -0.012073516845703125, -0.2113056182861328, -1.1932592391967773, 0.5071306228637695, -7.943122863769531, 0.31566619873046875, -0.671356201171875, 0.2698383331298828, 0.8403215408325195, -0.007386207580566406, -0.0310821533203125, 0.9932918548583984, -10.464757919311523, -0.5271425247192383, 1.4653892517089844, -0.12251663208007812, -0.37507057189941406, 0.11001205444335938, -0.37053680419921875, -0.5962991714477539, -7.656217575073242, -2.420766830444336, -0.47493648529052734, -0.1541004180908203, -0.8600729703903198, -0.5100784301757812, 2.558422088623047, -0.2812809944152832, 0.9908885955810547, -0.5330371856689453, -0.7065982818603516, 0.030076980590820312, -0.6031895875930786, -0.6391908526420593, -1.4117422103881836, -0.56134033203125, -0.2683897018432617, 0.31232261657714844, 0.37844085693359375, 0.12446832656860352, -0.055210113525390625, -0.5291175842285156, -0.7693119049072266, 1.0305476188659668, -14.59187126159668, -0.9978189468383789, -5.262033462524414, 0.10960578918457031, -1.2832635641098022, -1.5511236190795898, 1.1563587188720703, 1.3152389526367188, -0.49518585205078125, 0.2726325988769531, -4.5135040283203125, 7.278793811798096, 0.37812232971191406, -0.31237220764160156, 0.14200973510742188, -0.870783805847168, 0.7304987907409668, -0.47020530700683594, -6.3462934494018555, -0.06914806365966797, 0.9860019683837891, 0.15582847595214844, -0.3361520767211914, 0.37509822845458984, -0.6890449523925781, -0.37507057189941406, -9.58119010925293, -0.2152233123779297, 0.5768318176269531, -0.41252613067626953, -7.387939453125, -0.18851613998413086, -0.29486846923828125, -2.8818140029907227], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 69632, "num_env_steps_trained": 321900, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 321900, "last_target_update_ts": 69632, "num_target_updates": 135}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -595.5982278063893, "episode_reward_mean": -38.99241030350328, "episode_len_mean": 235.51, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472], "episode_lengths": [230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537767135749614, "mean_inference_ms": 24.371680239772232, "mean_action_processing_ms": 0.1335504571959107, "mean_env_wait_ms": 4.450244660496889, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -595.5982278063893, "episode_reward_mean": -38.99241030350328, "episode_len_mean": 235.51, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.900000117719173, 24.416421800851822, 12.09146473556757, 10.564786046743393, 9.810635454952717, -595.5982278063893, -507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472], "episode_lengths": [230, 221, 195, 225, 202, 419, 388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537767135749614, "mean_inference_ms": 24.371680239772232, "mean_action_processing_ms": 0.1335504571959107, "mean_env_wait_ms": 4.450244660496889, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 321900, "num_env_steps_sampled": 69632, "num_env_steps_trained": 321900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 69632, "agent_timesteps_total": 69632, "timers": {"training_iteration_time_ms": 365.526, "learn_time_ms": 71.666, "learn_throughput": 4186.06, "synch_weights_time_ms": 21.088}, "counters": {"num_env_steps_sampled": 69632, "num_env_steps_trained": 321900, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 321900, "last_target_update_ts": 69632, "num_target_updates": 135}, "done": false, "episodes_total": 263, "training_iteration": 68, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-30-41", "timestamp": 1655494241, "time_this_iter_s": 5.885970115661621, "time_total_s": 366.9355380535126, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 366.9355380535126, "timesteps_since_restore": 0, "iterations_since_restore": 68, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.65555555555556, "ram_util_percent": 64.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.021597862243652, "min_q": -13.483433723449707, "max_q": 33.4927864074707, "mean_td_error": -0.5158997774124146}, "td_error": [-0.16351795196533203, -5.450551986694336, -0.04817962646484375, -8.032337188720703, -0.2706451416015625, 0.14525508880615234, -0.7799320220947266, 0.3064994812011719, 0.05255317687988281, 2.5351028442382812, 0.38666439056396484, -6.392799377441406, 0.020299911499023438, -2.228459358215332, -10.512458801269531, -0.6551828384399414, -0.07505416870117188, 0.37413620948791504, -0.3329486846923828, -0.6846542358398438, -0.20308494567871094, -5.680572509765625, 3.077838897705078, 0.29879283905029297, -5.169508934020996, 0.5041656494140625, 3.785961151123047, -0.13924598693847656, 1.742903232574463, 6.73295783996582, -0.5348949432373047, -0.40778064727783203, -0.6960353851318359, 1.9269390106201172, -0.49212646484375, -0.6582216024398804, -1.0914316177368164, -0.3831501007080078, 0.1577129364013672, 1.9426393508911133, -0.30533576011657715, 0.18505859375, 0.38870859146118164, -0.2793922424316406, 0.6257495880126953, 0.017393112182617188, 6.608156204223633, -0.44951868057250977, -0.10339546203613281, -0.4868335723876953, -0.40496063232421875, -0.077880859375, -23.931297302246094, -0.5980286598205566, 1.2114124298095703, 1.4206047058105469, 0.08313679695129395, -1.2701492309570312, -0.4075603485107422, 1.4771537780761719, -0.2935009002685547, 0.047921180725097656, -1.24383544921875, 0.3172779083251953, -0.8545341491699219, -0.08801460266113281, -0.2393341064453125, 0.34328460693359375, 0.24319124221801758, 7.959294319152832, 0.1192178726196289, -0.5686550140380859, -0.10278892517089844, -1.0331153869628906, 0.5459308624267578, 1.4874224662780762, -0.5265474319458008, -8.41354751586914, -1.2125167846679688, 0.4179263114929199, -0.011058807373046875, -4.870929718017578, 0.45216721296310425, 0.2260150909423828, -0.36832237243652344, 0.5330157279968262, -0.033618927001953125, 1.1946630477905273, 0.2106342315673828, 0.37754201889038086, -0.7793864011764526, 0.6127405166625977, -0.5570468902587891, 1.478682518005371, 0.31429290771484375, -0.558349609375, -1.693216323852539, -0.2972559928894043, -0.8222851753234863, -0.2142810821533203, 0.07721614837646484, -0.5726318359375, -0.11214256286621094, -1.4611749649047852, -0.9335491061210632, -5.305885314941406, 0.18732643127441406, 0.07545852661132812, -1.1110353469848633, 0.10821914672851562, 0.07984542846679688, 0.6378636360168457, -0.4611949920654297, -0.7664699554443359, -0.6154689788818359, -0.5109462738037109, -0.5347394943237305, 0.27950000762939453, 0.17934608459472656, -0.031610965728759766, 0.49044227600097656, -0.23056793212890625, -0.4425067901611328, 0.18204212188720703, -5.721492767333984, -0.6050262451171875, -0.8625020980834961, -0.11350107192993164, -0.06452560424804688, 0.16892242431640625, 0.050853729248046875, -0.3341388702392578, 0.3252067565917969, -0.5592527389526367, 0.0367431640625, 0.7197296619415283, 0.286712646484375, 1.5313549041748047, 1.4500980377197266, -0.08065128326416016, -0.1468505859375, -0.9121174812316895, -0.1422863006591797, 0.14543819427490234, -0.11467933654785156, -7.364007949829102, -1.6581840515136719, 0.3348979949951172, -1.5118684768676758, 0.2766838073730469, -0.9286766052246094, 0.4790363311767578, -0.2110748291015625, -0.2848796844482422, -0.0927419662475586, -0.5812625885009766, -0.43347930908203125, 0.7239017486572266, -0.07137870788574219, 0.12725257873535156, 0.1945819854736328, -0.8976411819458008, 0.9299509525299072, -1.1821184158325195, -0.1544971466064453, 1.6143474578857422, 1.3047094345092773, -0.3790273666381836, 0.5636358261108398, -0.43652915954589844, -8.032337188720703, -5.038606643676758, -0.4989509582519531, -0.4950580596923828, 0.0028781890869140625, -0.40126705169677734, -8.142828941345215, -1.8432397842407227, 0.3210582733154297, -0.3703794479370117, -0.4787006378173828, -0.2631239891052246, 3.048600196838379, -0.26441097259521484, 0.5079612731933594, 1.1946630477905273, 0.24533843994140625, 0.4524540901184082, -4.565156936645508, -0.6989192962646484, -1.5705947875976562, 0.706451416015625, -1.3664216995239258, 0.2120981216430664, -1.5427484512329102, 0.04696941375732422, 0.6724119186401367, -0.6029739379882812, -3.907329559326172, -5.617998123168945, -0.10893917083740234, -1.0310478210449219, -0.7058010101318359, -10.512458801269531, -0.7109298706054688, -0.17560386657714844, 19.74430274963379, 0.05392742156982422, 0.15141916275024414, 1.6568326950073242, -3.4871654510498047, 0.6475391387939453, 1.1946630477905273, -0.9888584613800049, 0.1363086700439453, -0.37054443359375, -0.5395259857177734, -4.887411117553711, -7.175540924072266, 0.7656128406524658, -0.040065765380859375, -0.11802291870117188, -0.6673707962036133, 0.18169879913330078, 0.277895450592041, -0.518610954284668, -0.3099908232688904, 0.7247829437255859, 9.286593437194824, -1.2310714721679688, 0.6706609725952148, 0.4032735824584961, -0.706395149230957, -0.324798583984375, -9.898563385009766, -0.6823878288269043, -0.42607879638671875, -0.041629791259765625, -5.55671501159668, -0.12499046325683594, 1.659641981124878, -0.20779132843017578, 0.2986931800842285, -0.2751016616821289, 1.0038847923278809, 0.1884441375732422, -0.012301445007324219, 0.1752338409423828, -2.3855299949645996, -0.4790477752685547, -0.08891105651855469, -1.1247495412826538, -0.13854598999023438, -0.457904577255249, 1.0374908447265625, -0.1357288360595703, -0.6846542358398438, 0.6608014106750488, -0.3695812225341797, -0.5003948211669922, -0.07558345794677734, 3.8957056999206543, -4.742050647735596, 0.0046482086181640625, -0.40538930892944336, -0.8529853820800781, 0.3874845504760742, -0.1071319580078125, -0.3498706817626953, 0.016796112060546875, 0.29636383056640625, -0.007860183715820312, -0.12073326110839844, -0.24168777465820312, -0.7888631820678711, 0.46076011657714844, 0.4078664779663086, -5.585634231567383, -1.1656074523925781, -0.17125320434570312, -9.255203247070312, -0.10585975646972656, -0.04489707946777344, 0.07993125915527344, -0.4526948928833008, 0.15194416046142578, -0.18689441680908203, -0.23490619659423828, 0.6165885925292969, 0.3502531051635742, -0.11336421966552734, 0.09267044067382812, -1.2153568267822266, 0.08351707458496094, 1.1115570068359375, -2.719898223876953, -3.270242691040039, 1.0612306594848633, 0.49044227600097656, 0.17075538635253906], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 70656, "num_env_steps_trained": 326700, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 326700, "last_target_update_ts": 70656, "num_target_updates": 137}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -507.6454027891159, "episode_reward_mean": -34.14718080759049, "episode_len_mean": 233.57, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421], "episode_lengths": [388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537722789496385, "mean_inference_ms": 24.38479851712595, "mean_action_processing_ms": 0.13357624460051867, "mean_env_wait_ms": 4.454369182808829, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -507.6454027891159, "episode_reward_mean": -34.14718080759049, "episode_len_mean": 233.57, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-507.6454027891159, -86.70659109950066, 3.410635530948639, 9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421], "episode_lengths": [388, 288, 230, 244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537722789496385, "mean_inference_ms": 24.38479851712595, "mean_action_processing_ms": 0.13357624460051867, "mean_env_wait_ms": 4.454369182808829, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 326700, "num_env_steps_sampled": 70656, "num_env_steps_trained": 326700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 70656, "agent_timesteps_total": 70656, "timers": {"training_iteration_time_ms": 343.924, "learn_time_ms": 69.859, "learn_throughput": 4294.376, "synch_weights_time_ms": 20.988}, "counters": {"num_env_steps_sampled": 70656, "num_env_steps_trained": 326700, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 326700, "last_target_update_ts": 70656, "num_target_updates": 137}, "done": false, "episodes_total": 269, "training_iteration": 69, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-30-47", "timestamp": 1655494247, "time_this_iter_s": 5.598209619522095, "time_total_s": 372.53374767303467, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 372.53374767303467, "timesteps_since_restore": 0, "iterations_since_restore": 69, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.962500000000002, "ram_util_percent": 64.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 13.932852745056152, "min_q": -10.865209579467773, "max_q": 34.240577697753906, "mean_td_error": -0.1343449354171753}, "td_error": [-1.0990252494812012, -0.5468788146972656, 0.852715015411377, -0.7516441345214844, -4.756491661071777, 0.043160438537597656, -0.4056415557861328, 0.1464519500732422, 10.006219863891602, -0.2613334655761719, -0.3827977180480957, -0.24972152709960938, 0.07326412200927734, -0.644012451171875, 1.0997438430786133, 1.2420902252197266, -1.0524005889892578, 0.399261474609375, -0.4532957077026367, -0.718388557434082, -0.13493919372558594, -0.70513916015625, -0.7443752288818359, -0.11124801635742188, 0.04608154296875, -0.5651216506958008, 0.4670982360839844, 0.8324136734008789, -0.9804649353027344, 1.9169139862060547, -1.1131572723388672, 0.4658660888671875, 1.052781105041504, 0.9678058624267578, -0.008096694946289062, -0.7286167144775391, -0.03861427307128906, 1.0934820175170898, 0.31977272033691406, -0.1462545394897461, 0.44295692443847656, -0.47692203521728516, -1.0808944702148438, -5.3006439208984375, 0.4029369354248047, -0.4019641876220703, 0.22119998931884766, -0.40387725830078125, 0.649627685546875, 0.16464900970458984, -0.005946159362792969, 0.6127877235412598, -0.7571201324462891, -0.2767934799194336, -0.1031646728515625, 0.28484058380126953, -0.17984676361083984, 0.2957267761230469, -0.11276435852050781, 0.3805551528930664, -0.8481645584106445, -0.8570833206176758, -0.5431108474731445, -0.236328125, 0.08990001678466797, 0.24358892440795898, -1.713618278503418, 0.6356182098388672, -0.1412372589111328, -0.708892822265625, -0.6261324882507324, -0.015933990478515625, -1.4175770282745361, 1.4729022979736328, 1.1984233856201172, 1.4286117553710938, -1.4675750732421875, 12.338833808898926, -0.10394859313964844, 0.5438175201416016, -0.1575298309326172, -0.37227869033813477, -0.6349506378173828, -0.29451751708984375, -0.25244903564453125, -0.30640149116516113, 0.31291675567626953, -0.24605369567871094, 0.5238227844238281, -0.0059719085693359375, -5.110718727111816, -0.483184814453125, -0.22049522399902344, -0.5452356338500977, -1.7349810600280762, -1.6532440185546875, -0.19964981079101562, 0.17646026611328125, 0.4106254577636719, -0.5552067756652832, 0.2071075439453125, -1.310338020324707, 0.1355457305908203, 0.13409805297851562, -0.12387561798095703, 0.2067708969116211, 0.8354511260986328, -0.3355979919433594, -0.2889833450317383, -0.66949462890625, -0.047489166259765625, -0.27350616455078125, 1.0138378143310547, 0.8415336608886719, -0.04575490951538086, 7.298731327056885, -0.4925875663757324, -0.4666271209716797, -0.8432879447937012, -0.06008028984069824, -0.5731887817382812, -0.12524032592773438, 0.5385074615478516, 0.0165252685546875, -0.5696392059326172, 2.2059097290039062, -3.8138351440429688, -20.150911331176758, 0.23834991455078125, 0.7809906005859375, -0.46221160888671875, -1.7435226440429688, -0.3753232955932617, -0.8113565444946289, -3.175358772277832, 0.39012956619262695, -0.438448429107666, 0.21002769470214844, 0.037445068359375, -0.2704296112060547, 0.8673915863037109, 0.051868438720703125, 0.2806572914123535, -0.08800125122070312, 0.19989776611328125, -4.956413269042969, 7.034667015075684, 0.8460178375244141, -0.18042755126953125, 0.40294647216796875, -0.0670328140258789, -0.3326902389526367, -0.6619501113891602, -0.23435401916503906, 1.1984233856201172, 1.543492317199707, 0.1975841522216797, -0.35289859771728516, -0.12063181400299072, 0.3019676208496094, 0.05095481872558594, -1.009718894958496, -0.05961036682128906, 0.015560150146484375, 0.5099315643310547, -0.1224985122680664, -0.40925121307373047, 0.4318714141845703, 0.77825927734375, -0.1483154296875, -0.1009521484375, 0.11820411682128906, 0.3469858169555664, -0.39459991455078125, -0.6478409767150879, -0.10572052001953125, -0.20809555053710938, -1.1670427322387695, 0.12146186828613281, 0.022264480590820312, 0.13170909881591797, -0.5141506195068359, 0.07326412200927734, -0.6001787185668945, -0.7195243835449219, -0.030882835388183594, 0.7273521423339844, 0.529414176940918, 0.16464900970458984, -0.04332160949707031, -0.2173910140991211, -20.150911331176758, -0.9405384063720703, -0.9984674453735352, -0.5511693954467773, 1.1146678924560547, -0.17832183837890625, 0.0206756591796875, 0.17373085021972656, -0.12186527252197266, 0.6952247619628906, -1.1337337493896484, 0.6790809631347656, 0.21151161193847656, 0.3533964157104492, -0.4970703125, 4.1095051765441895, -8.657308578491211, -0.27971363067626953, -0.932032585144043, -0.17651748657226562, 0.3733377456665039, -0.44441890716552734, 0.32007598876953125, 2.5563526153564453, 0.4029369354248047, -0.003826141357421875, -0.6562862396240234, 0.17421579360961914, -0.216400146484375, -0.4795646667480469, -2.0665283203125, -0.5909309387207031, -0.5846986770629883, -0.32132506370544434, 0.2432270050048828, -0.10027885437011719, 0.617711067199707, 0.394589900970459, -0.4555530548095703, -0.19402599334716797, -0.6526055335998535, 1.0458507537841797, -1.042215347290039, -0.30340099334716797, 0.9340896606445312, -0.07749652862548828, 2.3064703941345215, -0.37995052337646484, 0.1908702850341797, 8.988988876342773, -0.0606231689453125, 0.24996185302734375, -0.17628955841064453, 0.7447776794433594, -0.7286167144775391, 0.5211524963378906, -0.06623649597167969, 0.5693569183349609, -0.24099493026733398, 0.5290355682373047, 0.27758026123046875, 0.11880302429199219, -0.49919700622558594, -7.593246936798096, 0.12565994262695312, -0.15202045440673828, 15.874723434448242, 0.9904003143310547, -0.6558723449707031, 1.0611333847045898, -0.985264778137207, -6.872566223144531, -0.04106330871582031, 1.3753547668457031, 0.030295372009277344, -1.9682073593139648, 0.0015974044799804688, 0.505589485168457, -1.557922601699829, -0.28139495849609375, -0.3104877471923828, 0.09629058837890625, -0.4546337127685547, 1.514298439025879, -0.4278221130371094, 0.15139484405517578, 1.3520851135253906, 0.3019676208496094, 0.27816545963287354, -8.740921020507812, 0.8732109069824219, -0.3681354522705078, 0.08636093139648438, 2.3356752395629883, 1.3504915237426758, 0.11962318420410156, -0.14155101776123047, -0.8333034515380859, 0.1417865753173828, 0.06838226318359375, -0.19574928283691406, 1.6186647415161133, 0.13607025146484375, -0.6727447509765625, -0.39907169342041016, -0.3243837356567383, -0.39790821075439453, 0.33450889587402344, 0.6059665679931641], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 331500, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 331500, "last_target_update_ts": 71680, "num_target_updates": 139}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -29.253713088706135, "episode_len_mean": 231.46, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254], "episode_lengths": [244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550563809974585, "mean_inference_ms": 24.386738249504678, "mean_action_processing_ms": 0.13326515921488055, "mean_env_wait_ms": 4.462456780668571, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -29.253713088706135, "episode_len_mean": 231.46, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.059649743139744, -289.71909955888987, -377.44980807602406, 18.110635191202164, 9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254], "episode_lengths": [244, 338, 343, 229, 230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550563809974585, "mean_inference_ms": 24.386738249504678, "mean_action_processing_ms": 0.13326515921488055, "mean_env_wait_ms": 4.462456780668571, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 331500, "num_env_steps_sampled": 71680, "num_env_steps_trained": 331500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 71680, "agent_timesteps_total": 71680, "timers": {"training_iteration_time_ms": 351.067, "learn_time_ms": 71.505, "learn_throughput": 4195.515, "synch_weights_time_ms": 21.784}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 331500, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 331500, "last_target_update_ts": 71680, "num_target_updates": 139}, "done": false, "episodes_total": 272, "training_iteration": 70, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-30-53", "timestamp": 1655494253, "time_this_iter_s": 5.516912460327148, "time_total_s": 378.0506601333618, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 378.0506601333618, "timesteps_since_restore": 0, "iterations_since_restore": 70, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.1875, "ram_util_percent": 64.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.85679817199707, "min_q": -11.165599822998047, "max_q": 34.819461822509766, "mean_td_error": 0.06565035134553909}, "td_error": [1.4925079345703125, 0.7541599273681641, 0.07178878784179688, -0.3870382308959961, -0.7846736907958984, 0.49078941345214844, 0.7452855110168457, 0.6893863677978516, -0.3906078338623047, -0.1417713165283203, -0.24553298950195312, 0.5753593444824219, 11.740172386169434, 0.03144359588623047, -0.7114067077636719, 0.8159217834472656, 1.0556926727294922, 0.1636524200439453, 0.4693117141723633, -0.5427541732788086, 0.07631874084472656, 0.37990856170654297, 0.8556251525878906, -0.4618196487426758, 0.9407927989959717, 0.2581319808959961, 0.05401420593261719, 0.7682628631591797, 1.4286165237426758, 0.5994758605957031, -0.5513486862182617, 0.8481025695800781, 8.306038856506348, 0.04222393035888672, 0.567901611328125, 0.3976478576660156, 0.4299449920654297, -6.236843109130859, -0.10272598266601562, -1.822793960571289, 0.6299076080322266, 0.3460550308227539, 0.40286827087402344, 6.675858020782471, -0.31005096435546875, -0.14126205444335938, -0.3611137866973877, -0.10371208190917969, 0.7214994430541992, 0.7628993988037109, 0.6223316192626953, 0.9474964141845703, 0.8326554298400879, 0.04807758331298828, 0.5372867584228516, 0.7119731903076172, -5.15022087097168, 1.1767539978027344, 0.4911632537841797, 0.2607908248901367, 0.5992622375488281, -7.365379333496094, 0.8258533477783203, 0.27962207794189453, 0.04756736755371094, 0.5942325592041016, 0.9594402313232422, 0.1887493133544922, 1.035262107849121, -0.11745262145996094, -0.24524211883544922, 1.8183536529541016, -0.8620433807373047, -1.160552978515625, 0.5722904205322266, 0.7736892700195312, 0.14682483673095703, -1.841448426246643, 1.6354742050170898, 0.36583518981933594, -1.0386643409729004, 0.6652641296386719, -0.4697284698486328, 0.5732603073120117, -1.3019323348999023, 0.3051239252090454, 0.6162319183349609, -0.7259922027587891, -5.182243347167969, 1.7710514068603516, -0.16013336181640625, 0.8908534049987793, -5.566899299621582, 0.9998931884765625, 0.32619285583496094, 0.026327133178710938, 0.8687076568603516, -0.43907833099365234, -0.14164352416992188, 0.5401983261108398, 0.6559610366821289, -0.5822429656982422, -1.3983607292175293, 0.9170608520507812, 0.6601638793945312, 0.45896339416503906, -1.2007274627685547, -0.12471580505371094, -0.7947635650634766, 0.9081497192382812, -0.6372184753417969, 0.06413936614990234, 0.014388084411621094, 3.649794578552246, 0.3348655700683594, 0.6820316314697266, 0.6861667633056641, -5.478964805603027, -10.400611877441406, -6.654044151306152, 7.262653350830078, -0.23357152938842773, 0.06577014923095703, 0.00200653076171875, 11.649099349975586, 0.3051239252090454, -0.31638240814208984, -0.3914003372192383, -0.846646785736084, 0.2971954345703125, -6.412167549133301, -0.06852912902832031, 0.3566150665283203, 0.5243716239929199, -0.5450401306152344, 1.3013362884521484, 0.12899494171142578, 0.3621244430541992, 0.054141998291015625, -0.4263763427734375, -0.16098403930664062, 0.17929601669311523, -0.1524677276611328, -0.12652015686035156, 0.011446952819824219, -0.2177753448486328, 0.5463123321533203, 0.47568702697753906, 0.048938751220703125, -0.6865959167480469, -1.0459473133087158, 0.30693912506103516, 0.5550365447998047, 0.06692314147949219, 0.7396697998046875, 0.786381721496582, -0.5328531265258789, 0.5405187606811523, -0.19455718994140625, 0.3690814971923828, -0.16373538970947266, -0.2361316680908203, 2.0610148906707764, 1.046494483947754, 0.17830848693847656, -0.8815946578979492, 6.162130355834961, 0.7965602874755859, -0.39133644104003906, -0.7585368156433105, 0.02460479736328125, -0.8682365417480469, 1.2765998840332031, 1.6884422302246094, 0.06240653991699219, 1.776240348815918, 0.052018165588378906, 0.9686751365661621, -0.0847158432006836, 0.11415290832519531, -1.0056228637695312, 1.1425457000732422, 0.10616445541381836, 0.48934173583984375, -0.5751409530639648, -0.532564640045166, -4.719959259033203, 0.35941123962402344, 0.42383384704589844, 0.4958171844482422, -0.581352710723877, 0.2897939682006836, 1.296213150024414, -0.6327142715454102, -0.34500694274902344, 0.8225841522216797, 0.5222587585449219, 11.831772804260254, -0.8073153495788574, 0.6432266235351562, -0.04892539978027344, -0.7084283828735352, 0.046535491943359375, 0.26776123046875, 0.06692314147949219, 0.1533660888671875, -0.3874378204345703, -0.15632057189941406, -6.135173797607422, 0.6036090850830078, 0.15963077545166016, -0.8468642234802246, 0.32766056060791016, -0.36889171600341797, 1.2653688192367554, -0.8500118255615234, 0.06921577453613281, 0.3771629333496094, 1.988250732421875, -1.4533615112304688, 0.373809814453125, 0.04709625244140625, -7.011615753173828, -0.5226449966430664, 1.3907833099365234, -0.5672760009765625, -0.31554365158081055, 0.03667259216308594, 0.25173377990722656, -0.3888359069824219, -0.2726935148239136, 0.4412984848022461, 0.1487865447998047, 0.03003406524658203, -5.098758697509766, 1.2922172546386719, 0.33377742767333984, 0.1784038543701172, -0.0888519287109375, -0.5026817321777344, 0.3426551818847656, 0.1937103271484375, -0.49791908264160156, -0.37016868591308594, 1.0391042232513428, 0.18648910522460938, -0.2486734390258789, -7.8197126388549805, 0.8349723815917969, 0.03634834289550781, -0.1361370086669922, -0.7214388847351074, 0.5111846923828125, 0.49521827697753906, -1.0803899765014648, 0.22421550750732422, -0.6466183662414551, -0.6580877304077148, 0.29248046875, 1.278390884399414, 1.8342061042785645, 0.08039474487304688, 0.2204456329345703, -0.0949392318725586, -0.6333808898925781, -6.295614242553711, -0.16518783569335938, 0.42092323303222656, 0.5107612609863281, 1.3401222229003906, 0.13264083862304688, -0.5711503028869629, -0.3870382308959961, -0.7341022491455078, 0.1187286376953125, -0.3024864196777344, 0.6102275848388672, -7.072662353515625, -0.49802589416503906, 0.6482486724853516, 8.044926643371582, 1.3817977905273438, 0.44535255432128906, 0.6041126251220703, 0.12575340270996094, 1.2412859201431274, -0.32079601287841797, 0.6114387512207031, -0.40003395080566406, -0.1609363555908203, 0.7025260925292969, -0.5713443756103516, 0.4067211151123047, 1.026942491531372, -0.8842916488647461, 0.08675861358642578, -0.08474063873291016, -0.23046875, -0.15727806091308594, 0.3217782974243164], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 72704, "num_env_steps_trained": 336300, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 336300, "last_target_update_ts": 72704, "num_target_updates": 141}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -23.03002481304109, "episode_len_mean": 228.71, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365], "episode_lengths": [230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555333224444262, "mean_inference_ms": 24.389012592477137, "mean_action_processing_ms": 0.13331277156184224, "mean_env_wait_ms": 4.464358845672778, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -23.03002481304109, "episode_len_mean": 228.71, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.899999968707561, -4.799999982118607, -130.3014622926712, -6.603026404976845, -196.336315959692, -60.655820198357105, 10.000000014901161, 37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365], "episode_lengths": [230, 233, 267, 230, 288, 262, 242, 221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555333224444262, "mean_inference_ms": 24.389012592477137, "mean_action_processing_ms": 0.13331277156184224, "mean_env_wait_ms": 4.464358845672778, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 336300, "num_env_steps_sampled": 72704, "num_env_steps_trained": 336300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 72704, "agent_timesteps_total": 72704, "timers": {"training_iteration_time_ms": 368.852, "learn_time_ms": 71.464, "learn_throughput": 4197.899, "synch_weights_time_ms": 20.82}, "counters": {"num_env_steps_sampled": 72704, "num_env_steps_trained": 336300, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 336300, "last_target_update_ts": 72704, "num_target_updates": 141}, "done": false, "episodes_total": 276, "training_iteration": 71, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-30-59", "timestamp": 1655494259, "time_this_iter_s": 5.730706453323364, "time_total_s": 383.7813665866852, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 383.7813665866852, "timesteps_since_restore": 0, "iterations_since_restore": 71, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.175, "ram_util_percent": 64.2625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 13.950214385986328, "min_q": -9.769129753112793, "max_q": 34.412086486816406, "mean_td_error": -0.22340728342533112}, "td_error": [-4.532928466796875, 1.5306100845336914, -0.28061771392822266, 0.22627639770507812, -0.13434314727783203, -0.3276844024658203, -0.6997051239013672, -0.1577434539794922, -0.3741931915283203, -0.4070930480957031, 1.142350196838379, 2.0224857330322266, -0.03685951232910156, 1.9611539840698242, -0.20396995544433594, 1.9554309844970703, 0.8407649993896484, 0.8198623657226562, 0.5451984405517578, 0.7551021575927734, 0.0771026611328125, 0.2714271545410156, 0.16166329383850098, -0.9355278015136719, 0.7831439971923828, 0.1998920440673828, 1.413726806640625, 0.21269607543945312, -4.534360885620117, -1.8388466835021973, 0.14693641662597656, 0.4592552185058594, -0.0764923095703125, -0.590184211730957, -0.053104400634765625, 1.1306686401367188, -0.19838523864746094, 0.21198463439941406, -0.4459075927734375, 0.1727428436279297, -0.5437424182891846, 0.4951286315917969, 0.4668903350830078, 0.5151958465576172, 1.6178169250488281, 0.020635128021240234, -0.46816444396972656, -0.6009197235107422, -0.17353153228759766, 1.131026268005371, -0.6892013549804688, 0.9145870208740234, 0.9402751922607422, 0.8448982238769531, -0.7089385986328125, -0.09435021877288818, 0.26970672607421875, 0.44915771484375, 1.222010612487793, 0.9055995941162109, -5.421819686889648, -1.93035888671875, 0.14404869079589844, 0.6759223937988281, 0.2859783172607422, -0.0030841827392578125, 0.08678817749023438, 0.21477985382080078, -0.20274734497070312, -0.22215521335601807, 1.1450386047363281, 0.11751365661621094, 0.3478546142578125, -0.1717987060546875, 0.23591136932373047, -5.724673271179199, 0.08678817749023438, 0.8167095184326172, 0.014084815979003906, 0.5881824493408203, 0.07715988159179688, -0.1097726821899414, 0.24988079071044922, 0.4705009460449219, 0.5498981475830078, -0.04703330993652344, 0.5095367431640625, -5.641861438751221, -0.3479909896850586, -0.09419631958007812, 0.1324458122253418, -0.7304954528808594, 0.22260522842407227, 0.6212368011474609, -0.5437424182891846, 0.5200837254524231, 0.7809081077575684, -0.7056193351745605, -0.7087383270263672, 0.6584444046020508, -0.01682281494140625, -0.0851888656616211, 0.15664100646972656, -0.7944412231445312, 0.20823287963867188, -6.049674987792969, 1.0024604797363281, -0.4375896453857422, -1.0613398551940918, 0.6243534088134766, 0.07861709594726562, 0.5429601669311523, 0.14404869079589844, -0.7228622436523438, -1.760045051574707, -3.0167369842529297, 0.7475967407226562, 0.2183971405029297, 0.1486339569091797, 0.131103515625, -0.009531021118164062, -6.003641128540039, 4.25594425201416, -1.3277788162231445, -1.5358772277832031, 0.032550811767578125, -1.2459001541137695, 0.9004402160644531, -0.642207145690918, 0.9547595977783203, -0.2074446678161621, 1.2675223350524902, 0.13626480102539062, 0.08986282348632812, -0.1401233673095703, 0.23019123077392578, 0.8235263824462891, 0.4642958641052246, 0.6658902168273926, 0.4980649948120117, -0.017792701721191406, -0.11061859130859375, -0.3415842056274414, -0.3407716751098633, 0.6629142761230469, 0.2174386978149414, 0.3086357116699219, 0.7673091888427734, -7.926666259765625, 0.2999725341796875, -0.2538871765136719, -0.3234214782714844, 1.7063426971435547, -4.320754051208496, 12.573163986206055, -0.3740119934082031, -0.2538871765136719, -0.4857492446899414, 2.2358570098876953, 0.6712517738342285, 0.1906108856201172, 0.28455448150634766, 0.2506389617919922, -0.268280029296875, 0.22675704956054688, -8.848638534545898, -0.5458059310913086, -0.2606487274169922, 0.3937187194824219, -7.38734245300293, 0.6445674896240234, 0.02231884002685547, 1.0739517211914062, 1.2540781497955322, 0.023618221282958984, -0.13071823120117188, -0.8977622985839844, 0.6293716430664062, 1.0040664672851562, 0.6873416900634766, 0.09372425079345703, -1.1329717636108398, 0.44509124755859375, 0.11911582946777344, -0.2908467948436737, -0.6214227676391602, 1.4240245819091797, -0.5046920776367188, -0.5155620574951172, -0.16356325149536133, -1.0890569686889648, 0.977910041809082, -0.1280517578125, 0.020452499389648438, -0.49230194091796875, 0.11851418018341064, 0.8357906341552734, -0.5367183685302734, -0.043297767639160156, 0.3418598175048828, -0.4301414489746094, 0.5425815582275391, -0.08164691925048828, -0.3113746643066406, -0.45181941986083984, 1.2474498748779297, 0.5306930541992188, -0.1689586639404297, -0.028730392456054688, 0.1906108856201172, -0.3829364776611328, 0.09655189514160156, 0.6132450103759766, 0.12298011779785156, 0.6196155548095703, 1.6008234024047852, -0.690366268157959, 0.7995691299438477, 0.7041044235229492, -0.7689657211303711, -1.1077394485473633, -0.09525775909423828, 0.5400581359863281, 0.6584758758544922, 0.6845870018005371, -0.1002950668334961, 2.2076644897460938, -1.1472549438476562, -0.6451807022094727, 10.82936954498291, -19.971776962280273, 0.8448982238769531, 0.6909656524658203, 0.3097572326660156, -0.004998207092285156, -0.05880165100097656, 0.691802978515625, -6.831029891967773, -0.7527198791503906, -0.36250734329223633, 0.5799732208251953, 0.1519479751586914, 1.8522491455078125, 0.5940399169921875, -0.017792701721191406, 0.7810554504394531, 0.10443878173828125, -0.2909984588623047, -0.27366161346435547, -0.43033599853515625, -1.801443099975586, -0.1057443618774414, -6.84849739074707, 0.3744850158691406, 0.36551666259765625, 0.8023796081542969, 0.46103882789611816, 0.3887825012207031, 0.30689239501953125, 1.222010612487793, 0.2094249725341797, -5.346804618835449, -0.3704805374145508, 0.11156558990478516, 0.38989830017089844, 0.4034271240234375, -0.7247309684753418, 0.7683162689208984, -11.376879692077637, -0.25754451751708984, -0.24089813232421875, -6.149162292480469, -7.908828258514404, -0.17267608642578125, -0.5312175750732422, -0.3199424743652344, -0.531097412109375, -0.43328857421875, -0.018808364868164062, 0.4085063934326172, 0.32694435119628906, -5.941293716430664, -0.598785400390625, -0.44739437103271484, 0.4945240020751953, 0.6322460174560547, -0.47174835205078125, -0.32096385955810547, 1.371866226196289, 1.0739517211914062, 8.920226097106934, -0.06168937683105469, 0.016969680786132812, 0.6950216293334961, 0.3206501007080078, -0.5834274291992188, 0.1386241912841797, 2.022733688354492, 0.5722579956054688, -7.277437210083008], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 73728, "num_env_steps_trained": 341100, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 341100, "last_target_update_ts": 73728, "num_target_updates": 143}, "sampler_results": {"episode_reward_max": 37.90505797415972, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -19.834533203914763, "episode_len_mean": 226.42, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388], "episode_lengths": [221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567532807273232, "mean_inference_ms": 24.403233006571224, "mean_action_processing_ms": 0.13356599519787685, "mean_env_wait_ms": 4.468984162515552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 37.90505797415972, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -19.834533203914763, "episode_len_mean": 226.42, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.90505797415972, 4.6000001057982445, -1.300000011920929, -64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388], "episode_lengths": [221, 210, 237, 237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567532807273232, "mean_inference_ms": 24.403233006571224, "mean_action_processing_ms": 0.13356599519787685, "mean_env_wait_ms": 4.468984162515552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 341100, "num_env_steps_sampled": 73728, "num_env_steps_trained": 341100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 73728, "agent_timesteps_total": 73728, "timers": {"training_iteration_time_ms": 359.934, "learn_time_ms": 72.074, "learn_throughput": 4162.362, "synch_weights_time_ms": 21.089}, "counters": {"num_env_steps_sampled": 73728, "num_env_steps_trained": 341100, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 341100, "last_target_update_ts": 73728, "num_target_updates": 143}, "done": false, "episodes_total": 283, "training_iteration": 72, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-31-05", "timestamp": 1655494265, "time_this_iter_s": 5.714340686798096, "time_total_s": 389.4957072734833, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 389.4957072734833, "timesteps_since_restore": 0, "iterations_since_restore": 72, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.333333333333336, "ram_util_percent": 64.33333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 13.485153198242188, "min_q": -11.144342422485352, "max_q": 30.845117568969727, "mean_td_error": -0.46373340487480164}, "td_error": [-0.3235492706298828, 0.43379735946655273, 0.41077518463134766, 0.21666908264160156, -0.43755149841308594, -1.1588783264160156, 0.10326290130615234, 2.9032363891601562, -0.20893383026123047, -0.3032393455505371, -0.44499778747558594, -0.05499458312988281, -0.4153561592102051, -0.5983676910400391, -0.8266277313232422, -0.6859493255615234, -10.899839401245117, -0.35573577880859375, -0.8841876983642578, 0.8359451293945312, -6.205677032470703, 0.0782003402709961, -0.9976463317871094, -1.828730583190918, -0.22835731506347656, -1.231987476348877, 1.1374187469482422, -0.6719329357147217, -0.4818916320800781, -0.21904945373535156, 0.020044326782226562, -0.7462558746337891, -0.46144771575927734, -0.021535873413085938, -0.6100635528564453, -0.26513147354125977, 0.19236087799072266, -0.46144771575927734, -0.12375736236572266, -0.21680831909179688, -0.2136402130126953, -0.5766901969909668, -0.7701034545898438, -9.200582504272461, -0.2693605422973633, -0.12120819091796875, -0.28676795959472656, -1.1785082817077637, -0.15151023864746094, 1.5015087127685547, 1.0564498901367188, 0.2986431121826172, 0.4219698905944824, -0.20095252990722656, -0.40314674377441406, 7.41813850402832, -1.8449134826660156, -1.3797855377197266, -0.043412208557128906, -0.17971324920654297, -2.735800266265869, 0.7105693817138672, 0.10122823715209961, 0.8524303436279297, -0.6501007080078125, -0.24565982818603516, -1.462071418762207, -0.2346515655517578, -0.0667724609375, -0.01288604736328125, -0.4820866584777832, -0.9488716125488281, 0.0913839340209961, -0.3669929504394531, -0.2759284973144531, -0.043347835540771484, -0.16961669921875, -0.6714577674865723, -0.38263988494873047, -0.2706146240234375, 0.037548065185546875, -0.55279541015625, -0.05986595153808594, -0.7266740798950195, -0.3301849365234375, -0.15268325805664062, -0.39812278747558594, -1.5610885620117188, 0.3616933822631836, -1.1741271018981934, 0.8144340515136719, -0.37465476989746094, -0.3483734130859375, -0.31835174560546875, 0.40996742248535156, -0.4029560089111328, -0.8873586654663086, -0.24850082397460938, -0.6681575775146484, -0.5218572616577148, -6.296935081481934, -0.03990936279296875, -0.18322515487670898, -0.4772043228149414, 0.1521148681640625, 0.13299942016601562, 3.334505558013916, -0.3246307373046875, 0.17731761932373047, 0.02035999298095703, -0.46536779403686523, -0.2544574737548828, -0.7496988773345947, -0.2745819091796875, -0.3090219497680664, -0.7765395641326904, 0.2108287811279297, -1.1217143535614014, -0.9209156036376953, 7.16092586517334, -1.73307466506958, 9.980805397033691, -0.08037090301513672, -0.6907553672790527, -0.7204227447509766, -0.22381210327148438, -0.1951274871826172, -5.633144378662109, -1.5456981658935547, -0.9908008575439453, -0.7896957397460938, -0.39321422576904297, -0.6572151184082031, -0.8019876480102539, -0.4866328239440918, -0.7778606414794922, 0.027916908264160156, -7.506446838378906, -0.5735807418823242, 0.13857340812683105, -0.39333534240722656, -0.7443103790283203, -0.8096237182617188, -0.23960250616073608, -0.29085755348205566, -0.3588676452636719, -0.12090492248535156, -0.30499267578125, 0.560877799987793, -0.06502914428710938, -1.0721278190612793, 0.30761051177978516, -0.78009033203125, -0.17847824096679688, -1.468064308166504, 0.6036834716796875, -0.31661033630371094, -0.49435901641845703, 2.105997085571289, -0.8085689544677734, -0.3458404541015625, -0.7775955200195312, -0.48328590393066406, -1.8210229873657227, 0.18169784545898438, 2.067007064819336, -0.3385334014892578, -0.6543302536010742, -2.1150598526000977, -0.15781021118164062, -0.22987079620361328, -0.8188772201538086, -0.17462730407714844, 0.066253662109375, -0.18095016479492188, 0.07572746276855469, -1.130514144897461, 0.12198543548583984, -0.564457893371582, -0.44648265838623047, -0.7622108459472656, 0.4150390625, -0.5681629180908203, -0.6669445037841797, -0.137939453125, -1.8488225936889648, -0.31310462951660156, -0.6934404373168945, -0.7765395641326904, -0.639739990234375, -0.3487720489501953, -1.1585712432861328, -0.7540969848632812, -0.07556533813476562, -0.5646405220031738, -0.4619255065917969, -6.089859962463379, -1.051656723022461, 0.3163461685180664, -0.17631912231445312, -0.42589378356933594, -1.3185415267944336, -0.8408360481262207, -0.46402883529663086, 0.21631717681884766, 0.19440650939941406, -0.5120658874511719, -0.7016916275024414, 0.03703880310058594, -1.7957096099853516, -5.311030387878418, 0.03606605529785156, 1.1795825958251953, -0.351043701171875, -0.13884353637695312, -0.6035957336425781, -0.549281120300293, -0.5529279708862305, 0.28818321228027344, 0.23289108276367188, -1.3019065856933594, -0.3692455291748047, -0.5981588363647461, -0.550079345703125, -0.25819969177246094, 0.14415359497070312, -0.08426094055175781, -0.6973857879638672, -0.38456153869628906, 0.8999013900756836, -0.6466789245605469, 2.531437873840332, 0.7160415649414062, 0.08182120323181152, -0.9658231735229492, 0.16424179077148438, -0.6006946563720703, -0.3275585174560547, -0.0707244873046875, -0.5175685882568359, 0.3441286087036133, 0.059121131896972656, -0.6757259368896484, -9.784235000610352, -0.3990497589111328, -0.5665426254272461, -0.5755548477172852, -0.002079010009765625, -0.2657909393310547, -0.06048583984375, -0.7791633605957031, -0.08185577392578125, -0.44158077239990234, -0.256561279296875, -0.9181766510009766, -0.4417734146118164, -0.6714191436767578, -0.7479801177978516, -0.3656501770019531, -0.8965625762939453, -0.2739286422729492, -0.37119388580322266, 0.04538154602050781, -0.11952590942382812, -0.30495357513427734, -0.08082294464111328, -0.33764076232910156, -0.4258441925048828, -6.61732292175293, -0.16778278350830078, -6.041502475738525, 0.06574821472167969, 0.2513742446899414, 0.3188629150390625, -0.147735595703125, -0.4417734146118164, 0.2424468994140625, -0.5563535690307617, -0.9834156036376953, -0.3548588752746582, 9.756205558776855, -0.7443475723266602, 0.2894554138183594, -1.113006591796875, -0.6396522521972656, -0.043412208557128906, 0.7736883163452148, 0.167999267578125, 0.010641098022460938, -7.06011962890625, -1.1696350574493408, -0.7496988773345947, -0.2941112518310547, -0.1201925277709961, -0.10029411315917969, -0.4282855987548828, -0.38983154296875, 2.105997085571289, -0.6695041656494141, -0.5212202072143555], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 74752, "num_env_steps_trained": 345900, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 345900, "last_target_update_ts": 74752, "num_target_updates": 145}, "sampler_results": {"episode_reward_max": 36.82614543288946, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -21.891555882170795, "episode_len_mean": 226.98, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233], "episode_lengths": [237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569683032461729, "mean_inference_ms": 24.390593981350026, "mean_action_processing_ms": 0.13345128929467415, "mean_env_wait_ms": 4.469689774938982, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 36.82614543288946, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -21.891555882170795, "episode_len_mean": 226.98, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.37475663423538, -83.47078356146812, 14.80090257525444, -182.32010661065578, 4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233], "episode_lengths": [237, 274, 217, 311, 188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569683032461729, "mean_inference_ms": 24.390593981350026, "mean_action_processing_ms": 0.13345128929467415, "mean_env_wait_ms": 4.469689774938982, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 345900, "num_env_steps_sampled": 74752, "num_env_steps_trained": 345900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 74752, "agent_timesteps_total": 74752, "timers": {"training_iteration_time_ms": 351.264, "learn_time_ms": 71.38, "learn_throughput": 4202.874, "synch_weights_time_ms": 20.489}, "counters": {"num_env_steps_sampled": 74752, "num_env_steps_trained": 345900, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 345900, "last_target_update_ts": 74752, "num_target_updates": 145}, "done": false, "episodes_total": 286, "training_iteration": 73, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-31-11", "timestamp": 1655494271, "time_this_iter_s": 5.805548667907715, "time_total_s": 395.301255941391, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 395.301255941391, "timesteps_since_restore": 0, "iterations_since_restore": 73, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 29.15, "ram_util_percent": 64.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 15.729072570800781, "min_q": -8.479178428649902, "max_q": 35.305030822753906, "mean_td_error": 0.44881775975227356}, "td_error": [0.6038970947265625, 0.5267562866210938, -0.12982177734375, 0.5060195922851562, 0.804229736328125, 1.6962833404541016, 0.47739505767822266, -0.1815800666809082, 0.6658163070678711, 0.6029109954833984, 0.29741668701171875, 0.2501392364501953, 0.4734363555908203, 1.3959789276123047, 2.582012176513672, 1.6091432571411133, 4.3304853439331055, 0.7467222213745117, -0.1429767608642578, 0.6062374114990234, -0.17907142639160156, 0.16650080680847168, 1.0588569641113281, 0.07454776763916016, 1.2224407196044922, 2.550212860107422, 0.7360010147094727, 0.04094886779785156, -10.215137481689453, 8.585030555725098, 0.166778564453125, 1.5438270568847656, -0.4893455505371094, 0.15363597869873047, -0.2091960906982422, 0.4786357879638672, 1.143463134765625, 2.066751480102539, 0.93878173828125, -0.0464019775390625, 0.5779581069946289, -0.06125450134277344, 0.07393836975097656, -0.2010868787765503, -0.07977151870727539, -0.2801856994628906, 0.6026515960693359, -0.052379608154296875, 0.04281425476074219, 0.4733247756958008, 1.1267337799072266, 0.697545051574707, 1.8642940521240234, -0.14310073852539062, -0.07854557037353516, 0.16292762756347656, 0.537470817565918, 0.8696823120117188, -0.7194595336914062, 0.5927410125732422, 1.9058494567871094, -0.0022411346435546875, 1.359292984008789, 0.8854217529296875, 0.17744827270507812, 0.8726139068603516, 0.3017616271972656, 1.7997379302978516, 1.4962959289550781, 0.23668289184570312, 8.598872184753418, 0.4018573760986328, 0.07962512969970703, 0.4162769317626953, -0.7738933563232422, 0.6948528289794922, 0.5159378051757812, 0.5478839874267578, -0.42046356201171875, 0.28116798400878906, 0.06352806091308594, 0.9753913879394531, 0.43291473388671875, 5.173459529876709, 0.8830833435058594, -0.21929454803466797, -0.11811447143554688, -0.3120565414428711, 0.7308311462402344, 0.4353971481323242, 0.6430206298828125, -7.686769008636475, -0.6609840393066406, 2.8373355865478516, -0.05519866943359375, 1.4843940734863281, 11.407971382141113, -0.31696033477783203, 1.5927486419677734, 0.10532951354980469, -0.2723875045776367, 0.7557010650634766, 0.7180366516113281, 0.6236343383789062, -0.7374629974365234, 1.045175552368164, 0.3494396209716797, -0.744384765625, -0.2607097625732422, -0.12350082397460938, -6.066650390625, 0.2763786315917969, 1.7441444396972656, -6.42213249206543, 0.8220057487487793, 7.456808567047119, -0.09745407104492188, -0.1427621841430664, 0.3084278106689453, -0.21959304809570312, 1.0528678894042969, 7.618383884429932, -1.0157403945922852, -0.34838104248046875, -0.1963672637939453, 0.09698009490966797, 0.9235095977783203, 0.273040771484375, 0.019502639770507812, 0.6715946197509766, -0.21318435668945312, 0.2271289825439453, -0.4660348892211914, 0.38336181640625, 0.9645423889160156, 0.5815925598144531, -0.3268766403198242, -0.46728515625, -8.945659637451172, 2.8719778060913086, 3.0752315521240234, -0.8710291385650635, 0.4885883331298828, 0.9278674125671387, -0.3172140121459961, 0.5794334411621094, 0.3237323760986328, -0.4203333854675293, 0.7775650024414062, -0.020934104919433594, 0.5212287902832031, 0.012413978576660156, 0.34349822998046875, -2.432220458984375, 0.6443376541137695, 0.8174428939819336, -1.4838333129882812, -0.17589378356933594, 0.018199920654296875, 0.8065547943115234, 1.4586219787597656, 0.1549386978149414, 0.5952835083007812, 0.31789207458496094, 0.30423808097839355, 0.9265670776367188, 0.6988105773925781, 1.928365707397461, 2.0490167140960693, 4.889415740966797, -0.15036582946777344, -0.3641319274902344, 0.1469287872314453, 0.5006370544433594, -0.367340087890625, 0.21245193481445312, 0.5672235488891602, 0.5416421890258789, 0.4660148620605469, 0.3762063980102539, -0.12738895416259766, 1.254967212677002, 0.5297012329101562, 0.11577796936035156, 1.1354832649230957, 0.6722379326820374, 0.6702461242675781, 0.804229736328125, -0.4757986068725586, 0.8216266632080078, 0.4277019500732422, -5.421012878417969, 0.6564254760742188, 0.3389749526977539, 0.5822718143463135, 0.7765846252441406, 0.08737945556640625, 0.5501556396484375, 0.623070240020752, 0.2106800079345703, -6.455410957336426, 0.4302349090576172, 1.1349945068359375, 0.5195112228393555, 0.3909730911254883, 0.08638191223144531, 1.4240798950195312, -0.0781087875366211, 0.3133544921875, 0.5911140441894531, -0.2529869079589844, 0.34244346618652344, 1.09505033493042, 1.1813106536865234, -0.46858882904052734, -0.254488468170166, 1.7181339263916016, 0.7203426361083984, -0.21982669830322266, 0.5533390045166016, 0.45612525939941406, 0.4367036819458008, 0.07561302185058594, 0.5148553848266602, 0.2935905456542969, 0.8967933654785156, -0.42181217670440674, 0.6600151062011719, 1.0532875061035156, 0.6115608215332031, 0.3553504943847656, 1.5883712768554688, 0.17594528198242188, 0.5711193084716797, 0.8300209045410156, 0.9181709289550781, 0.0740823745727539, 0.741206169128418, -0.36313819885253906, -0.05439186096191406, -0.03656435012817383, 2.403963088989258, 0.5913476943969727, 0.21245193481445312, 0.6598606109619141, 5.072185039520264, 8.620808601379395, 0.4934844970703125, 0.6211795806884766, -0.029065966606140137, 0.052178382873535156, 0.12758350372314453, 0.46990394592285156, 0.8885631561279297, -3.9761295318603516, 0.20282268524169922, -0.22784042358398438, -0.1490039825439453, 0.3035392761230469, 0.48548126220703125, 0.29423046112060547, -0.6825923919677734, 8.954813957214355, 0.4340991973876953, 1.7375831604003906, 2.5941505432128906, 0.16172313690185547, 0.0908203125, 0.17738056182861328, 0.24010086059570312, 0.43853187561035156, -7.837675094604492, 0.4955463409423828, 1.0070457458496094, 1.7525253295898438, -0.6929149627685547, -1.9352149963378906, 1.2518644332885742, 0.6540451049804688, 0.2233104705810547, -0.20787525177001953, 2.1885290145874023, -1.8518142700195312, 0.7417116165161133, 0.5596389770507812, 0.3633995056152344, 0.40260887145996094, 0.2074298858642578, 0.9248714447021484, -0.052593231201171875, 1.4181671142578125, 1.6392250061035156, 0.023115158081054688, -9.295598983764648, 1.032557487487793, 0.43491220474243164, 0.49907398223876953, 0.03302335739135742, 0.7154865264892578, 0.43491220474243164], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 75776, "num_env_steps_trained": 350700, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 350700, "last_target_update_ts": 75776, "num_target_updates": 147}, "sampler_results": {"episode_reward_max": 36.82614543288946, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -18.419531596377492, "episode_len_mean": 225.43, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825], "episode_lengths": [188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5579936133588325, "mean_inference_ms": 24.409770842161763, "mean_action_processing_ms": 0.13328961292734912, "mean_env_wait_ms": 4.476905645231057, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 36.82614543288946, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -18.419531596377492, "episode_len_mean": 225.43, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.400000117719173, 12.364786013960838, -80.77678146958351, 19.23449084162712, 17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825], "episode_lengths": [188, 199, 250, 223, 202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5579936133588325, "mean_inference_ms": 24.409770842161763, "mean_action_processing_ms": 0.13328961292734912, "mean_env_wait_ms": 4.476905645231057, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 350700, "num_env_steps_sampled": 75776, "num_env_steps_trained": 350700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 75776, "agent_timesteps_total": 75776, "timers": {"training_iteration_time_ms": 365.351, "learn_time_ms": 71.585, "learn_throughput": 4190.806, "synch_weights_time_ms": 20.589}, "counters": {"num_env_steps_sampled": 75776, "num_env_steps_trained": 350700, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 350700, "last_target_update_ts": 75776, "num_target_updates": 147}, "done": false, "episodes_total": 290, "training_iteration": 74, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-31-17", "timestamp": 1655494277, "time_this_iter_s": 5.790489435195923, "time_total_s": 401.0917453765869, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 401.0917453765869, "timesteps_since_restore": 0, "iterations_since_restore": 74, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.9375, "ram_util_percent": 64.1375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 15.147786140441895, "min_q": -7.742656230926514, "max_q": 33.93560791015625, "mean_td_error": 0.21102839708328247}, "td_error": [-0.5892438888549805, -0.12409591674804688, -0.25670337677001953, 1.0879249572753906, -0.011782646179199219, 0.30463504791259766, -0.050815582275390625, 0.7375583648681641, -0.30138587951660156, 0.8002395629882812, -0.021657943725585938, 0.2641468048095703, -0.019622802734375, 0.6969566345214844, 1.2953920364379883, -6.773462295532227, 0.7041740417480469, -0.3190174102783203, 0.1771717071533203, -1.0677289962768555, -0.377960205078125, -0.4808197021484375, 0.21412944793701172, -0.39835453033447266, 0.40307140350341797, 0.6384353637695312, -5.359897613525391, 0.9233503341674805, -0.35440731048583984, -0.5146865844726562, 0.8805103302001953, 0.3389432430267334, -0.7779998779296875, -0.4187459945678711, 0.8712517023086548, -0.3832387924194336, 0.49254798889160156, 0.6252880096435547, 0.5732612609863281, -0.3000202178955078, 0.6445426940917969, 1.3776359558105469, -0.7949986457824707, 0.6066436767578125, 0.6494655609130859, 0.04723358154296875, 1.024052619934082, 0.3587055206298828, 0.14206504821777344, 0.07243061065673828, 0.6918306350708008, 0.7218666076660156, -1.2714824676513672, -0.6197938919067383, 0.20769405364990234, 1.2398815155029297, 0.8096544742584229, -0.2867546081542969, 0.66510009765625, -0.6072654724121094, -0.35642528533935547, -0.6540653705596924, 0.04393041133880615, 0.5549592971801758, 0.8749260902404785, 0.44818663597106934, 2.42138671875, 0.9210300445556641, -1.289825439453125, 0.18735980987548828, 0.7307519912719727, -0.35642528533935547, 0.6196098327636719, -0.10890769958496094, -0.10132789611816406, -0.8077964782714844, -0.3263092041015625, -0.09471702575683594, -0.6690750122070312, 9.07789134979248, 0.3307170867919922, 0.20698928833007812, -0.4894251823425293, 0.23769760131835938, 1.2474870681762695, 1.2527999877929688, 0.6630744934082031, 2.050107002258301, -0.4689292907714844, 0.7108526229858398, 2.04489803314209, 0.3137016296386719, -0.03310203552246094, -1.5568981170654297, 0.7801570892333984, -0.6298089027404785, -0.2027873992919922, 0.9500694274902344, 0.052021026611328125, 0.9308395385742188, 3.8232173919677734, 0.6736469268798828, 0.9056768417358398, -1.2689247131347656, 0.22618484497070312, 0.8255167007446289, 2.1332879066467285, 0.26628923416137695, -0.1303844451904297, -0.04429435729980469, -0.18020057678222656, 0.42207908630371094, 0.33327579498291016, -1.8582496643066406, -0.34757041931152344, 0.9181118011474609, 0.7302336692810059, 0.46584510803222656, 0.5732612609863281, 0.9447164535522461, 0.9602165222167969, -0.5028800964355469, 0.07389640808105469, 1.430739402770996, 1.9534454345703125, 0.7995767593383789, -0.2861471176147461, 0.3296699523925781, -0.5360422134399414, 0.10130119323730469, 0.5195026397705078, -8.812118530273438, 3.0376415252685547, 1.5340385437011719, 1.4878077507019043, 0.4632878303527832, 0.7348518371582031, -0.2978935241699219, -0.5794439315795898, 0.2328634262084961, 0.4367332458496094, 0.8440818786621094, 0.763941764831543, 0.375213623046875, 0.13167572021484375, 0.5296378135681152, 0.0030088424682617188, 0.9759955406188965, -0.7741317749023438, -7.001089096069336, 0.03477799892425537, -0.4595775604248047, 5.172245025634766, 2.114572525024414, 0.4704093933105469, 0.5092277526855469, 0.13446807861328125, 1.5426912307739258, 0.6839179992675781, 0.4205741882324219, 0.5179176330566406, 0.44561195373535156, 0.4752025604248047, -0.5604724884033203, 13.968628883361816, 0.7098445892333984, -0.049365997314453125, -0.2977867126464844, 0.29778385162353516, -0.20330238342285156, -0.5208339691162109, 1.2414741516113281, 0.31842041015625, 11.301569938659668, 0.33647727966308594, 0.5229721069335938, 1.3984203338623047, 0.3069300651550293, -0.04814624786376953, 0.16495132446289062, -0.36161041259765625, -1.4163687229156494, 0.058441162109375, 0.04277610778808594, 0.10694122314453125, 0.5282421112060547, -0.036622047424316406, 0.456512451171875, 0.36675453186035156, 0.7761726379394531, 2.4408130645751953, -0.4030752182006836, -0.7058219909667969, 0.6893062591552734, -0.8034343719482422, -0.8516683578491211, 0.3072185516357422, 0.3832969665527344, 0.13985013961791992, 0.25235843658447266, 0.5901851654052734, 1.04644775390625, 0.14713668823242188, 0.3741774559020996, 0.2558135986328125, 1.5837531089782715, -0.20872879028320312, 0.6649255752563477, 1.284515380859375, 0.25882816314697266, 0.20643281936645508, 0.24779129028320312, 1.0379257202148438, -0.31284141540527344, 0.13296985626220703, 1.5426912307739258, -0.2349529266357422, 0.5793447494506836, 0.283966064453125, -1.8273124694824219, 0.43651580810546875, -0.9646072387695312, 0.5199193954467773, 0.0756845474243164, -0.3280296325683594, -0.5171136856079102, -0.03087615966796875, -0.18020057678222656, 0.3653850555419922, 0.48621368408203125, -0.2205963134765625, 0.012372970581054688, 0.7138729095458984, 1.1146831512451172, -1.2262182235717773, -0.2136058807373047, -0.03310203552246094, -0.07496833801269531, 0.1401081085205078, 0.9248647689819336, -6.720828056335449, 0.5555095672607422, -0.8978195190429688, -0.024211883544921875, -0.17047882080078125, 0.8298788070678711, -0.2538728713989258, 1.1292171478271484, 1.6406841278076172, 0.19928264617919922, 0.6421442031860352, -0.4684419631958008, 0.49439239501953125, -6.514456748962402, 0.9360742568969727, -6.106801986694336, 0.08540058135986328, 0.3527565002441406, 0.3381462097167969, 1.6842164993286133, 0.04842185974121094, -5.900350570678711, 0.9056768417358398, 0.5349483489990234, 0.019164085388183594, -0.6176137924194336, 0.5384197235107422, -0.4946708679199219, -0.736454963684082, 0.4733867645263672, 0.3063011169433594, 0.09533119201660156, -0.44728851318359375, 0.37244701385498047, 0.8516807556152344, -6.337766647338867, 0.2732725143432617, 0.06505584716796875, 0.7572135925292969, 0.28673362731933594, 4.082615852355957, -0.2880096435546875, 0.04471778869628906, 0.9467241764068604, 0.170074462890625, 1.133401870727539, 0.9613666534423828, 0.6089649200439453, 0.3576068878173828, 0.09832954406738281, 0.5533866882324219, -2.451183319091797, 0.7619571685791016, -0.3064603805541992, -0.8343982696533203, 0.9272141456604004, -0.5001544952392578, -0.29291248321533203, -0.0064678192138671875, 0.3914222717285156], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 76800, "num_env_steps_trained": 355500, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 355500, "last_target_update_ts": 76800, "num_target_updates": 149}, "sampler_results": {"episode_reward_max": 36.82614543288946, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -18.948912690877915, "episode_len_mean": 225.58, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751], "episode_lengths": [202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5584270431093824, "mean_inference_ms": 24.417994123797083, "mean_action_processing_ms": 0.13342088321554976, "mean_env_wait_ms": 4.478858742146982, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 36.82614543288946, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -18.948912690877915, "episode_len_mean": 225.58, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.072541274130344, 0.7000001594424248, 28.92475811392069, -1.599999986588955, -2.6539709270000458, 3.799999922513962, -28.67614435404539, 10.344166919589043, 13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751], "episode_lengths": [202, 200, 195, 220, 219, 236, 223, 201, 229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5584270431093824, "mean_inference_ms": 24.417994123797083, "mean_action_processing_ms": 0.13342088321554976, "mean_env_wait_ms": 4.478858742146982, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 355500, "num_env_steps_sampled": 76800, "num_env_steps_trained": 355500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 76800, "agent_timesteps_total": 76800, "timers": {"training_iteration_time_ms": 348.234, "learn_time_ms": 72.167, "learn_throughput": 4157.028, "synch_weights_time_ms": 20.389}, "counters": {"num_env_steps_sampled": 76800, "num_env_steps_trained": 355500, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 355500, "last_target_update_ts": 76800, "num_target_updates": 149}, "done": false, "episodes_total": 294, "training_iteration": 75, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-31-22", "timestamp": 1655494282, "time_this_iter_s": 5.574262380599976, "time_total_s": 406.6660077571869, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 406.6660077571869, "timesteps_since_restore": 0, "iterations_since_restore": 75, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.737499999999997, "ram_util_percent": 64.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 15.05559253692627, "min_q": -6.6786980628967285, "max_q": 35.025291442871094, "mean_td_error": -0.059998881071805954}, "td_error": [-5.221139907836914, -0.1063385009765625, -0.8270702362060547, 0.8837060928344727, 0.07221221923828125, -0.16910362243652344, 0.7931728363037109, -0.8504505157470703, 0.5612144470214844, -0.7829495072364807, 1.1844615936279297, -0.2579660415649414, 1.570089340209961, 0.554532527923584, 2.1054725646972656, 0.25485992431640625, -0.6945295333862305, -0.7015905380249023, 0.5454435348510742, -5.554025650024414, 0.5147380828857422, -1.0725631713867188, 1.0997695922851562, 0.41599082946777344, 0.4036741256713867, 0.6267156600952148, 0.16370487213134766, 0.6243495941162109, 0.1714000701904297, -0.5220146179199219, -0.4271869659423828, 1.0052995681762695, 1.057464599609375, 1.1504650115966797, 1.344247817993164, 1.4560356140136719, 0.2390899658203125, -0.5073575973510742, 0.012681961059570312, 0.6371173858642578, 1.3134374618530273, 0.30717945098876953, 0.6639828681945801, 0.7081031799316406, 0.4376235604286194, -1.032583236694336, 0.9424419403076172, 1.6429862976074219, -0.04144477844238281, 0.9220705032348633, 0.2628316879272461, -1.4280414581298828, -1.0114631652832031, -0.41933727264404297, -0.5294513702392578, 0.9568281173706055, 0.05632781982421875, -0.19295501708984375, 0.04835700988769531, 1.7661924362182617, -0.3140406608581543, 0.7821464538574219, 0.050067901611328125, 0.848114013671875, 0.1972827911376953, 0.4810047149658203, 0.12599754333496094, 1.1573295593261719, 1.2031059265136719, 0.4227266311645508, 0.31752967834472656, -0.31304168701171875, 0.8386688232421875, -0.6680231094360352, -0.9393072128295898, 0.6822643280029297, -0.2357959747314453, 0.4810047149658203, 2.0086917877197266, 0.03656959533691406, -0.2978994846343994, 8.665746688842773, 0.3686485290527344, 0.1818370819091797, 0.3413982391357422, -2.051229476928711, 1.4040565490722656, 0.6467838287353516, 0.3877124786376953, 0.3276185989379883, 0.8476219177246094, -1.3710637092590332, -1.1478757858276367, 0.34666967391967773, 0.9879665374755859, -0.26943397521972656, 0.3809623718261719, 0.5579853057861328, -0.7654819488525391, -0.6996293067932129, 2.387056350708008, 0.4430351257324219, 8.592493057250977, 9.680427551269531, -4.287696838378906, 0.8366012573242188, -0.3277435302734375, 1.0595684051513672, -0.9737339019775391, -0.18978214263916016, 0.5945510864257812, 0.6840229034423828, 0.6800746917724609, -1.3741741180419922, -0.3446927070617676, 0.9820671081542969, -1.0040664672851562, -0.24767494201660156, 0.40755558013916016, 0.8335075378417969, 1.0699844360351562, 0.8998928070068359, 0.3703775405883789, -0.3227810859680176, -6.480238914489746, 1.0969295501708984, -1.4054393768310547, -4.4073333740234375, -0.7952947616577148, 7.030651569366455, -6.449779510498047, 0.4893159866333008, -1.7673072814941406, -0.3140406608581543, -0.5652256011962891, -0.08410358428955078, -0.22758102416992188, -1.0450325012207031, 0.2552680969238281, -0.5560369491577148, -1.2185897827148438, 0.9190769195556641, 0.3128032684326172, 0.35961341857910156, 0.9002208709716797, -1.2888927459716797, -0.6181640625, 2.1359214782714844, -0.08097076416015625, 0.06379127502441406, -2.8130571842193604, 0.4010331630706787, 2.13250732421875, -15.17205810546875, -2.437297821044922, -0.6619644165039062, 0.30223941802978516, 0.5033073425292969, -0.10513731837272644, 0.6394367218017578, 1.0126237869262695, 1.4539413452148438, -0.22076988220214844, 0.2421398162841797, -0.45234012603759766, -1.1415443420410156, 0.4879570007324219, 0.4622163772583008, -0.9873142242431641, 0.8004732131958008, -1.0439701080322266, -0.32422304153442383, -0.11956977844238281, 1.1560745239257812, -0.024049758911132812, 0.35170936584472656, 1.0128936767578125, 0.2875394821166992, 1.11328125, -0.9073219299316406, 0.8141078948974609, 0.23748207092285156, 1.0887775421142578, 0.3458404541015625, 0.5909337997436523, 0.537628173828125, -0.1737656593322754, -4.150394439697266, -0.1060333251953125, -0.4504051208496094, 0.0011310577392578125, 1.3505792617797852, 0.36091041564941406, -0.30184173583984375, -10.96413803100586, -0.38798046112060547, -0.21303367614746094, -6.507680892944336, -0.8748569488525391, 0.5715606212615967, 0.7943115234375, -0.20013046264648438, 0.39601683616638184, 1.0045204162597656, -0.016427993774414062, 0.1368083953857422, -0.00691986083984375, 0.543304443359375, -0.7884330749511719, -5.351024627685547, -1.0713691711425781, 1.1455821990966797, 9.13870906829834, 1.5445938110351562, 0.17434120178222656, -6.076225280761719, 3.7496986389160156, 1.909733772277832, 0.5326595306396484, -0.7139358520507812, 0.48541259765625, 0.3358497619628906, -0.377960205078125, 0.22618865966796875, 0.9725484848022461, -9.94735336303711, 0.2918834686279297, -1.4282569885253906, -0.5367307662963867, 0.5193357467651367, 0.4002552032470703, -0.8003330230712891, 0.45950889587402344, -0.2116107940673828, 1.4059371948242188, 0.27338266372680664, 0.7710132598876953, 0.7187261581420898, 0.7053890228271484, -0.40326976776123047, -1.2133598327636719, -0.28192710876464844, -1.1239089965820312, 0.6545352935791016, 0.7910337448120117, 0.8585968017578125, 0.6545352935791016, 0.1657562255859375, -6.424069404602051, -1.7586860656738281, -0.1341390609741211, 0.00749969482421875, 1.2441883087158203, -1.7401885986328125, 1.4594287872314453, -0.6388616561889648, 0.06941032409667969, 1.3799800872802734, 0.3259010314941406, -0.13843917846679688, 1.3399152755737305, -0.59869384765625, -0.3968505859375, -0.49883270263671875, -0.22238683700561523, 1.0671195983886719, -0.33881187438964844, -1.5146456956863403, -0.031314849853515625, 0.6722679138183594, -0.03541278839111328, -0.2934398651123047, 1.3934688568115234, 0.5490264892578125, -1.2837409973144531, 0.8994406461715698, -0.9462007284164429, -0.19179248809814453, 1.0815391540527344, 0.10466575622558594, -0.11216449737548828, 0.12762832641601562, -0.7740916013717651, 0.8329277038574219, 0.3419380187988281, -10.903823852539062, 0.6289882659912109, -1.4282569885253906, 0.0137481689453125, 0.0816812515258789, -0.6751194000244141, -0.10628128051757812, 1.259378433227539, 0.6995182037353516, -0.4856410026550293, 0.7389059066772461, 0.6143016815185547, 1.2370471954345703, 1.1480693817138672, -4.414162635803223], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 77824, "num_env_steps_trained": 360300, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 360300, "last_target_update_ts": 77824, "num_target_updates": 151}, "sampler_results": {"episode_reward_max": 36.82614543288946, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -21.718999598026276, "episode_len_mean": 227.6, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149], "episode_lengths": [229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5598039454884255, "mean_inference_ms": 24.415154085841593, "mean_action_processing_ms": 0.13327681951514922, "mean_env_wait_ms": 4.486661174318276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 36.82614543288946, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -21.718999598026276, "episode_len_mean": 227.6, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.856495954096317, -4.682940378785133, -143.35617516934872, 36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149], "episode_lengths": [229, 218, 291, 212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5598039454884255, "mean_inference_ms": 24.415154085841593, "mean_action_processing_ms": 0.13327681951514922, "mean_env_wait_ms": 4.486661174318276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 360300, "num_env_steps_sampled": 77824, "num_env_steps_trained": 360300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 77824, "agent_timesteps_total": 77824, "timers": {"training_iteration_time_ms": 373.636, "learn_time_ms": 72.049, "learn_throughput": 4163.861, "synch_weights_time_ms": 20.42}, "counters": {"num_env_steps_sampled": 77824, "num_env_steps_trained": 360300, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 360300, "last_target_update_ts": 77824, "num_target_updates": 151}, "done": false, "episodes_total": 302, "training_iteration": 76, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-31-29", "timestamp": 1655494289, "time_this_iter_s": 6.061485052108765, "time_total_s": 412.72749280929565, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 412.72749280929565, "timesteps_since_restore": 0, "iterations_since_restore": 76, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.05555555555556, "ram_util_percent": 64.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 16.779033660888672, "min_q": -6.412393093109131, "max_q": 36.61803436279297, "mean_td_error": 0.11027953028678894}, "td_error": [0.42363739013671875, 0.20351886749267578, -0.09322166442871094, -0.2341175079345703, -6.4897074699401855, -0.5547666549682617, 0.23549461364746094, 0.1480121612548828, -7.533323287963867, 1.0390758514404297, 0.7731132507324219, -0.1951770782470703, 0.6186161041259766, 0.830103874206543, 1.0750484466552734, 0.4926586151123047, 0.3286266326904297, -0.17034626007080078, -0.7331278324127197, 2.410259246826172, -0.7416553497314453, 5.417655944824219, -3.394796371459961, 0.35901308059692383, 1.2300920486450195, -0.07782936096191406, 0.2611827850341797, 1.1994705200195312, -0.6325435638427734, 0.4580726623535156, 0.11068648099899292, -0.9018068313598633, 0.6013193130493164, 0.7766304016113281, 0.10959625244140625, 0.43227386474609375, -0.9785385131835938, -0.3031024932861328, 0.9564323425292969, 0.04653644561767578, 0.4416828155517578, 0.9047031402587891, 1.0450305938720703, 0.7825288772583008, 0.22505474090576172, 0.026540756225585938, 0.8684816360473633, 0.18071365356445312, -0.2641005516052246, -6.318464279174805, 0.6109256744384766, 1.2396907806396484, 0.028974533081054688, 0.6838817596435547, 1.186680793762207, -0.45289039611816406, -0.34546661376953125, -0.46668243408203125, 1.0538501739501953, -5.416467666625977, 0.9206185340881348, -0.9893283843994141, -1.147857666015625, 0.6998405456542969, 0.45571327209472656, 0.7223587036132812, 0.3674936294555664, 0.5458426475524902, -0.01777362823486328, -1.1534919738769531, -0.42788219451904297, 0.21886634826660156, 0.3613243103027344, -5.371315002441406, 3.161531448364258, 0.07976722717285156, 0.85223388671875, 0.22835731506347656, 0.4298725128173828, 0.18071365356445312, 0.035277366638183594, 0.8140525817871094, 5.501499176025391, -0.7049345970153809, 0.8755455017089844, -1.2185897827148438, 0.5770359039306641, 0.9108028411865234, -0.11340141296386719, 0.3787498474121094, 0.721771240234375, 0.4142341613769531, 0.8776493072509766, 0.5768203735351562, 0.4614982604980469, 0.5244865417480469, -0.09669208526611328, 0.41411590576171875, 0.8180618286132812, -0.9118213653564453, -1.138906478881836, -5.68671989440918, 1.1721420288085938, 0.2696037292480469, 0.9643497467041016, 0.24181842803955078, 0.6236095428466797, -0.047115325927734375, 0.7099590301513672, -0.1704874038696289, -9.539863586425781, 0.07571887969970703, 0.20369434356689453, -1.2300424575805664, 0.18401718139648438, 0.5023212432861328, 0.17975139617919922, 0.22696876525878906, 0.8773202896118164, 0.32419633865356445, 0.3787498474121094, -0.4140462875366211, 1.0628070831298828, 0.2999868392944336, 0.5527935028076172, -1.2596511840820312, 0.3589916229248047, 0.7680091857910156, 1.6525630950927734, -5.220761299133301, -0.3512001037597656, 1.0958876609802246, -0.8077840805053711, 0.5041046142578125, 0.2565927505493164, 4.332731246948242, 1.0349693298339844, -0.11679840087890625, 2.0224609375, 0.21701812744140625, 1.1802616119384766, 0.5561685562133789, 1.2591495513916016, -0.7652554512023926, -0.2540236711502075, 0.3214550018310547, 0.7763328552246094, -0.39130592346191406, -0.7978038787841797, 0.670252799987793, 0.9722908735275269, 0.7374095916748047, 0.5909824371337891, 15.435215950012207, -1.4031562805175781, 0.0695047378540039, 0.17061805725097656, 0.7368383407592773, 0.5051069259643555, -0.3002042770385742, -1.096860408782959, -0.4174003601074219, 0.41678619384765625, -0.3046894073486328, 0.09265899658203125, 0.6638035774230957, 0.7111396789550781, -0.3247528076171875, -1.5812454223632812, 0.2204303741455078, -0.13478851318359375, 2.7338943481445312, 0.7022724151611328, 1.0518245697021484, 0.17776107788085938, 0.09960079193115234, 1.342935562133789, 0.18205833435058594, 0.5293102264404297, 0.30303955078125, -1.4031562805175781, 0.20868873596191406, 0.3749227523803711, 0.6631975173950195, -9.36386489868164, 0.4382438659667969, 1.4993743896484375, 0.5000782012939453, 1.1588916778564453, 0.15752601623535156, -0.3064117431640625, 0.7417788505554199, 0.5000782012939453, 1.1644906997680664, 0.37104225158691406, -0.33475780487060547, 0.8350458145141602, 5.675372123718262, -0.9357261657714844, 0.9247207641601562, 0.9891090393066406, 0.8894424438476562, 0.5263071060180664, -0.056349754333496094, 0.5935754776000977, -0.4385833740234375, -0.10942840576171875, -4.684904098510742, -1.785581111907959, 0.5246143341064453, 0.263580322265625, -0.4123039245605469, -0.22632598876953125, 0.7655925750732422, 0.5784740447998047, -0.07360649108886719, 1.177734375, 1.2012176513671875, -0.679163932800293, 1.3403937816619873, -4.392890930175781, 0.7605323791503906, 0.5862903594970703, 0.6574745178222656, 0.18979454040527344, 0.6109142303466797, -0.2605552673339844, 0.7994251251220703, -2.2589149475097656, -0.29784584045410156, 0.3817143440246582, 0.6438884735107422, 0.2524862289428711, -5.976112365722656, 0.9198770523071289, -1.8957099914550781, 0.2246246337890625, -4.107041358947754, 0.3199195861816406, -0.09669208526611328, 0.6366233825683594, -0.5480690002441406, -0.8467864990234375, -0.060561180114746094, 0.010568618774414062, 0.3047170639038086, 1.2300920486450195, 0.5023412704467773, 0.02624225616455078, -6.164281845092773, 0.06921577453613281, -0.49947166442871094, 0.7180156707763672, 0.05722618103027344, 5.983142852783203, 0.43842315673828125, 1.4228153228759766, 0.21468734741210938, 0.1878204345703125, 0.04596900939941406, 0.2779560089111328, 0.658818244934082, -0.028484344482421875, 0.18004798889160156, 0.6267299652099609, -0.7128772735595703, 0.8344821929931641, -0.18101143836975098, 0.4393482208251953, -0.4182147979736328, 0.006321907043457031, 0.5545272827148438, -0.7493267059326172, 0.1583232879638672, 0.3226051330566406, 0.020272254943847656, 1.0825538635253906, 0.7576465606689453, -0.001827239990234375, 0.5464982986450195, 0.6607780456542969, 8.867508888244629, 1.5746917724609375, 0.6572036743164062, -7.7498931884765625, -0.24965953826904297, -0.13355445861816406, 0.14411544799804688, 1.0384063720703125, 0.7304439544677734, 2.4042751789093018, 0.1812419891357422, 0.24081802368164062, 0.5280914306640625, 0.6133365631103516, 0.3732151985168457, 0.251889705657959, -0.21412897109985352, -0.19510841369628906, -0.09559822082519531], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 78848, "num_env_steps_trained": 365100, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 365100, "last_target_update_ts": 78848, "num_target_updates": 153}, "sampler_results": {"episode_reward_max": 36.82614543288946, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -20.089934845343233, "episode_len_mean": 226.44, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706], "episode_lengths": [212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5604662999605678, "mean_inference_ms": 24.422551880411003, "mean_action_processing_ms": 0.13332868671489118, "mean_env_wait_ms": 4.490198886104227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 36.82614543288946, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -20.089934845343233, "episode_len_mean": 226.44, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.82614543288946, 5.0000001192092896, -5.689364515244961, 0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706], "episode_lengths": [212, 201, 213, 199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5604662999605678, "mean_inference_ms": 24.422551880411003, "mean_action_processing_ms": 0.13332868671489118, "mean_env_wait_ms": 4.490198886104227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 365100, "num_env_steps_sampled": 78848, "num_env_steps_trained": 365100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 78848, "agent_timesteps_total": 78848, "timers": {"training_iteration_time_ms": 364.425, "learn_time_ms": 71.152, "learn_throughput": 4216.313, "synch_weights_time_ms": 20.986}, "counters": {"num_env_steps_sampled": 78848, "num_env_steps_trained": 365100, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 365100, "last_target_update_ts": 78848, "num_target_updates": 153}, "done": false, "episodes_total": 305, "training_iteration": 77, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-31-34", "timestamp": 1655494294, "time_this_iter_s": 5.628638029098511, "time_total_s": 418.35613083839417, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 418.35613083839417, "timesteps_since_restore": 0, "iterations_since_restore": 77, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.0625, "ram_util_percent": 64.1375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 16.5842227935791, "min_q": -4.569695949554443, "max_q": 37.055965423583984, "mean_td_error": 0.34369370341300964}, "td_error": [0.48163795471191406, -6.391574859619141, 1.3995018005371094, 0.20055007934570312, 0.037837982177734375, 0.37389564514160156, 0.47772216796875, -0.1392230987548828, 0.007367134094238281, 0.5292701721191406, 0.5580387115478516, -0.16635894775390625, 0.003261566162109375, -0.12966346740722656, 1.3717193603515625, 1.0301342010498047, -0.029422760009765625, 0.13089561462402344, 1.2807836532592773, -0.061168670654296875, 0.45595550537109375, 1.422560691833496, 1.569840431213379, 0.2613677978515625, -0.14728927612304688, -0.04886817932128906, -0.11520671844482422, 0.07393074035644531, 0.4685821533203125, 0.05893516540527344, 0.4450054168701172, -0.3112192153930664, 0.6134662628173828, 0.7318639755249023, -0.2720155715942383, 0.57733154296875, 0.3530769348144531, -0.08958816528320312, 0.15358829498291016, 0.8407039642333984, 0.9977378845214844, -0.033233642578125, 0.45780086517333984, 1.1960043907165527, 0.0059261322021484375, 0.04170989990234375, 0.20106220245361328, 1.1800765991210938, 0.8907699584960938, 0.9992599487304688, 0.8335552215576172, 3.9058570861816406, 0.4925365447998047, 0.45818138122558594, 0.22344207763671875, 0.1489734649658203, 0.4073925018310547, -0.2676267623901367, 0.9717235565185547, -0.32532644271850586, 12.526421546936035, -0.06524181365966797, 0.5112209320068359, -0.03894615173339844, 0.3732452392578125, -0.05780792236328125, 0.3107990324497223, 0.6199188232421875, 0.6897993087768555, -1.1075811386108398, 0.4766349792480469, -0.1709270477294922, 0.27861976623535156, 0.48473644256591797, 0.17536354064941406, -0.01361083984375, 0.13200855255126953, -6.273778915405273, 0.22548770904541016, 0.49147605895996094, -0.045299530029296875, 0.9358921051025391, 5.924657821655273, 0.6466884613037109, -0.3864021301269531, -0.040320396423339844, 0.5268039703369141, 0.54571533203125, 0.7262706756591797, 0.45931243896484375, 0.18876075744628906, 0.17833423614501953, 0.4083843231201172, 1.8345434665679932, 0.20755958557128906, 0.5176162719726562, 0.1028585433959961, -0.08858299255371094, -0.19432640075683594, 0.34011268615722656, -5.8261260986328125, 0.2968902587890625, 0.5536346435546875, 0.5257740020751953, -0.14771175384521484, 2.2508468627929688, -0.058152198791503906, 0.5752983093261719, 0.1548175811767578, -0.281982421875, 0.6409225463867188, -6.0381269454956055, -0.24964427947998047, 0.057262420654296875, 0.08316516876220703, 2.6556310653686523, -0.1046600341796875, 0.82452392578125, 0.15607452392578125, 0.4818401336669922, 1.4467811584472656, 0.05816650390625, -2.051490545272827, 0.7114009857177734, 0.33017826080322266, 0.8705902099609375, -0.6439418792724609, -5.91650390625, 1.1072912216186523, 0.4242591857910156, 0.40431976318359375, 4.645895481109619, -0.8148871660232544, 1.3222274780273438, -0.12042999267578125, 0.3680229187011719, 0.5086288452148438, -0.5295276641845703, 0.5154838562011719, 0.3419017791748047, 0.852431058883667, 0.7402572631835938, 0.32115745544433594, 0.6913337707519531, 0.7454910278320312, -0.09417247772216797, -0.4796133041381836, 0.6199188232421875, 0.6720962524414062, 0.17433738708496094, -0.061168670654296875, -0.6861209869384766, 9.412101745605469, 0.7704563140869141, 0.6678714752197266, 0.8869400024414062, 0.7751388549804688, 0.9467630386352539, 0.04437732696533203, 0.28646183013916016, 0.25668811798095703, 1.106858253479004, 0.7822608947753906, -5.261011123657227, 0.6827716827392578, -0.12331771850585938, 0.29021453857421875, 0.1913614273071289, 0.0771942138671875, 2.6485252380371094, -4.868598937988281, 0.1925182342529297, 0.43115901947021484, 0.6128950119018555, 0.9835166931152344, 0.05248069763183594, 1.2764670848846436, -0.010345458984375, 0.3507089614868164, 15.664809226989746, 0.7824478149414062, -0.15905094146728516, 0.1651315689086914, 0.9996547698974609, -1.077535629272461, 0.28237056732177734, 16.386425018310547, 0.7814235687255859, 0.6529378890991211, 0.6854572296142578, -5.688503265380859, -0.10311317443847656, -0.6029801368713379, 0.005222320556640625, 0.4889345169067383, -0.31070470809936523, 0.38884735107421875, 0.8733062744140625, 0.014606475830078125, 0.10729217529296875, 0.4552440643310547, 0.10666465759277344, 0.74127197265625, 1.0319786071777344, 1.2764670848846436, 0.8262863159179688, 0.10059928894042969, 0.07057861983776093, -1.3988637924194336, 2.188802719116211, -1.1975374221801758, -1.3352901935577393, -0.5943905115127563, 0.7764759063720703, -6.745136260986328, 0.8335552215576172, 0.5083332061767578, 1.0190849304199219, 0.2150859832763672, 0.01888275146484375, -0.5396451950073242, 4.785167217254639, 0.13697433471679688, 0.3524761199951172, 0.04967689514160156, 0.06891250610351562, -0.33299827575683594, 0.5711812973022461, -5.387479782104492, -0.045699119567871094, -1.0359723567962646, -1.6475543975830078, 0.9912986755371094, -0.3423471450805664, 0.1057586669921875, 0.5104265213012695, -0.08260154724121094, 0.031149864196777344, -0.09778213500976562, 0.5604190826416016, 1.236440658569336, -0.26534080505371094, 0.4720191955566406, -0.02387237548828125, 0.5319623947143555, -0.1876087188720703, -0.5506458282470703, -0.2994575500488281, -0.08819580078125, 0.5526294708251953, 0.3107990324497223, 0.8007421493530273, 0.40155029296875, 0.856903076171875, 2.4759368896484375, 0.9404559135437012, 0.7130603790283203, -0.2581024169921875, 0.21582889556884766, 1.5436067581176758, 0.6658496856689453, 0.5923938751220703, 0.2325218915939331, 0.46600341796875, -0.3102741241455078, 0.4733238220214844, 0.027204513549804688, 1.5332865715026855, 0.268643856048584, 0.09411430358886719, -0.9178791046142578, 0.13555479049682617, 0.18913841247558594, 0.5448684692382812, -0.08484649658203125, 0.01957988739013672, 0.016360759735107422, 1.5702838897705078, 0.6435203552246094, 0.29424095153808594, 0.27173495292663574, -4.615394592285156, 0.20900821685791016, 0.061034202575683594, -8.813884735107422, 0.1695384979248047, 0.8292312622070312, 0.3382563591003418, 0.480633020401001, -0.27362060546875, -0.012919425964355469, -0.08697509765625, -0.5354976654052734, -1.5960702896118164, -0.8221817016601562, 0.3483905792236328, -0.2347087860107422, 0.11321830749511719, 13.546339988708496, 0.37642669677734375], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 79872, "num_env_steps_trained": 369900, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 369900, "last_target_update_ts": 79872, "num_target_updates": 155}, "sampler_results": {"episode_reward_max": 33.934633642435074, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -20.7594280667603, "episode_len_mean": 226.63, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797], "episode_lengths": [199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5613523539469053, "mean_inference_ms": 24.431636811666078, "mean_action_processing_ms": 0.1334061003515856, "mean_env_wait_ms": 4.49515461518686, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 33.934633642435074, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -20.7594280667603, "episode_len_mean": 226.63, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5238555073738098, -73.47078357636929, 9.399999782443047, 23.886056825518608, -1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797], "episode_lengths": [199, 255, 219, 224, 215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5613523539469053, "mean_inference_ms": 24.431636811666078, "mean_action_processing_ms": 0.1334061003515856, "mean_env_wait_ms": 4.49515461518686, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 369900, "num_env_steps_sampled": 79872, "num_env_steps_trained": 369900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 79872, "agent_timesteps_total": 79872, "timers": {"training_iteration_time_ms": 356.708, "learn_time_ms": 71.5, "learn_throughput": 4195.785, "synch_weights_time_ms": 20.707}, "counters": {"num_env_steps_sampled": 79872, "num_env_steps_trained": 369900, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 369900, "last_target_update_ts": 79872, "num_target_updates": 155}, "done": false, "episodes_total": 308, "training_iteration": 78, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-31-40", "timestamp": 1655494300, "time_this_iter_s": 5.607102632522583, "time_total_s": 423.96323347091675, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 423.96323347091675, "timesteps_since_restore": 0, "iterations_since_restore": 78, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.9375, "ram_util_percent": 64.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 16.249263763427734, "min_q": -4.370668888092041, "max_q": 37.038536071777344, "mean_td_error": 0.15704242885112762}, "td_error": [1.6440813541412354, -0.383880615234375, -0.20215225219726562, 1.868443489074707, -4.425006866455078, 2.5232295989990234, -0.2392406463623047, 0.06759452819824219, 0.5765247344970703, 0.06654930114746094, 0.4961967468261719, -0.8057193756103516, 0.15894508361816406, 0.02434539794921875, 1.0107707977294922, 0.9866485595703125, -0.36432647705078125, -0.009952545166015625, 1.2550411224365234, 0.7777099609375, -0.1723804473876953, 0.3548240661621094, 3.3476638793945312, 0.6933717727661133, 0.02272796630859375, -4.35329532623291, 0.9376258850097656, 1.204111099243164, 1.0829429626464844, -0.1562023162841797, -4.82215690612793, 0.0221099853515625, 0.6251678466796875, 0.4482078552246094, 0.44828033447265625, 0.9346542358398438, 0.8759746551513672, 0.6415643692016602, -0.1563100814819336, -6.523321151733398, 0.3037986755371094, 0.596287727355957, -0.9749794006347656, 0.013936996459960938, 0.11421489715576172, -1.0819602012634277, 0.5199756622314453, 0.42994117736816406, 1.5222196578979492, 0.7002887725830078, 0.464144229888916, 0.1984119415283203, 0.6031322479248047, 0.28759002685546875, 0.16490936279296875, -0.13388633728027344, -0.010217666625976562, 0.8617253303527832, 2.6262054443359375, 0.1567840576171875, 0.675135612487793, 0.909454345703125, 0.9995059967041016, -0.8785991668701172, -5.157122611999512, -0.8648300170898438, 0.8425197601318359, 1.1050910949707031, 0.42212486267089844, 0.11499977111816406, 0.6855230331420898, -0.4963359832763672, 0.1309490203857422, 0.22043991088867188, 0.542633056640625, 1.0167121887207031, 0.39944934844970703, -0.8767814636230469, 2.5251541137695312, 0.5188407897949219, 0.35611724853515625, -10.301702499389648, -0.7009449005126953, -0.1432018280029297, 0.4083709716796875, 0.944915771484375, 0.5771102905273438, 0.41442298889160156, 0.68450927734375, 0.5873908996582031, 1.7871789932250977, 0.4487628936767578, 0.5596084594726562, -1.2047863006591797, -1.4850730895996094, -7.747442245483398, 0.7983026504516602, 0.3318815231323242, 0.7607250213623047, 0.6116828918457031, 0.7802562713623047, -1.897653579711914, 0.49846458435058594, 1.1000099182128906, 2.0168285369873047, 2.1443653106689453, 0.6463413238525391, -0.24875354766845703, 0.3466033935546875, 0.13918781280517578, 0.6761970520019531, 0.5023021697998047, 1.1194801330566406, 1.0036869049072266, 0.5794687271118164, 1.0110340118408203, 0.4087963104248047, 0.20699691772460938, 0.4923839569091797, 0.8355302810668945, -8.709774017333984, 1.0596494674682617, -0.24187469482421875, 0.2240610122680664, 0.8744754791259766, 0.8635692596435547, -0.1255483627319336, 0.8871726989746094, 1.151228904724121, 0.6031370162963867, -0.44375038146972656, 1.1625251770019531, 0.03271293640136719, 0.40160369873046875, 0.25598716735839844, 0.5950469970703125, 1.0848217010498047, 1.0163345336914062, 0.8253746032714844, -0.14353322982788086, 0.14481449127197266, -0.28418827056884766, -0.6321859359741211, 0.07920360565185547, 0.8407154083251953, -0.027541160583496094, 0.025811195373535156, -0.10424423217773438, -0.5763216018676758, -5.754239082336426, 0.8568029403686523, 1.6059093475341797, -9.52227783203125, 0.6352939605712891, 1.1667251586914062, 0.62054443359375, 0.3667163848876953, 0.2602806091308594, 1.2111454010009766, 1.6995620727539062, 0.5692076683044434, 0.31325721740722656, 9.678744316101074, -0.04776763916015625, 0.6907157897949219, 0.33693408966064453, -9.570631980895996, 0.2906646728515625, 1.2548103332519531, 1.287557601928711, 0.6499824523925781, 1.3926382064819336, -6.572301864624023, 1.1249065399169922, 0.45047616958618164, 0.5543975830078125, -0.4355964660644531, 1.7612028121948242, 0.7588920593261719, 0.9976034164428711, 1.326568603515625, 0.9041764736175537, -0.2855396270751953, 1.0230598449707031, -0.07918643951416016, 0.1356220245361328, 0.06721687316894531, 1.1997058391571045, 0.3038949966430664, 0.7295346260070801, -0.09412765502929688, 0.8355960845947266, 1.3643131256103516, -5.477085113525391, -0.11434459686279297, 0.6905384063720703, 0.47991180419921875, 0.41632652282714844, 7.26872444152832, 1.4313697814941406, 0.4484214782714844, 0.7796125411987305, 0.8326692581176758, 0.0933847427368164, -0.0042266845703125, 1.7083244323730469, -5.369112968444824, 0.35756874084472656, 0.4944133758544922, 0.32027673721313477, 0.23286914825439453, 0.16879844665527344, -1.2334213256835938, 0.33693408966064453, 0.6018943786621094, 0.3769569396972656, 0.39632606506347656, 0.18078994750976562, 0.36487674713134766, 0.8318099975585938, 1.0459442138671875, 0.7159595489501953, 0.2490835189819336, -0.9470748901367188, 0.2818603515625, 0.2824115753173828, -0.08890724182128906, 0.838226318359375, 0.839263916015625, 1.6824874877929688, -0.240386962890625, 0.7690067291259766, 2.0464000701904297, 0.7145366668701172, 0.7912988662719727, 0.35755348205566406, 1.0703296661376953, 1.0589675903320312, 0.8361091613769531, 0.47631263732910156, 0.35234880447387695, 0.3027076721191406, 1.7270126342773438, 0.3993406295776367, 0.2152090072631836, -0.0971221923828125, 1.052687644958496, 0.33858776092529297, -0.06478309631347656, 0.13025033473968506, -8.709774017333984, -0.4569282531738281, 0.42615699768066406, 0.8164253234863281, 0.6261968612670898, 0.3607463836669922, 0.5144920349121094, -0.47252368927001953, 1.3999576568603516, 0.39403438568115234, 0.12511014938354492, 1.6059093475341797, 1.0713129043579102, 1.7682952880859375, 1.3083972930908203, 0.6139049530029297, 5.9066009521484375, 0.7755975723266602, 0.0875697135925293, -0.36925506591796875, 0.35577392578125, -0.5741977691650391, -0.29746150970458984, 0.3626546859741211, 1.1559858322143555, 0.10688440501689911, -0.7176055908203125, 0.3039741516113281, 0.5512018203735352, -7.0188751220703125, 0.6045818328857422, 0.31325721740722656, -2.5147647857666016, 5.0132551193237305, 1.939807415008545, 1.7044029235839844, -0.6100578308105469, 0.7415351867675781, -1.0955085754394531, 0.5907878875732422, 0.19632339477539062, 0.7474098205566406, 0.9415292739868164, 0.5941038131713867, 0.2564067840576172, 0.31783294677734375, -1.4378814697265625, -0.26732730865478516, 0.4907379150390625, -4.814874649047852], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 80896, "num_env_steps_trained": 374700, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 374700, "last_target_update_ts": 80896, "num_target_updates": 157}, "sampler_results": {"episode_reward_max": 33.934633642435074, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -20.008422848433256, "episode_len_mean": 226.17, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744], "episode_lengths": [215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5617776086323929, "mean_inference_ms": 24.420066135623646, "mean_action_processing_ms": 0.13345384558143822, "mean_env_wait_ms": 4.494986561599768, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 33.934633642435074, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -20.008422848433256, "episode_len_mean": 226.17, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.2999998405575752, -19.389364428818226, -87.67433939129114, 1.6621254831552505, -77.38539167493582, -32.385392151772976, -238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744], "episode_lengths": [215, 240, 249, 233, 238, 213, 324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5617776086323929, "mean_inference_ms": 24.420066135623646, "mean_action_processing_ms": 0.13345384558143822, "mean_env_wait_ms": 4.494986561599768, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 374700, "num_env_steps_sampled": 80896, "num_env_steps_trained": 374700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 80896, "agent_timesteps_total": 80896, "timers": {"training_iteration_time_ms": 344.485, "learn_time_ms": 73.321, "learn_throughput": 4091.603, "synch_weights_time_ms": 20.282}, "counters": {"num_env_steps_sampled": 80896, "num_env_steps_trained": 374700, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 374700, "last_target_update_ts": 80896, "num_target_updates": 157}, "done": false, "episodes_total": 312, "training_iteration": 79, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-31-46", "timestamp": 1655494306, "time_this_iter_s": 5.479990720748901, "time_total_s": 429.44322419166565, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 429.44322419166565, "timesteps_since_restore": 0, "iterations_since_restore": 79, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 33.1375, "ram_util_percent": 64.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 16.218355178833008, "min_q": -3.8475735187530518, "max_q": 33.17033386230469, "mean_td_error": 0.597345769405365}, "td_error": [0.5749449729919434, 0.696619987487793, 0.7970895767211914, -0.03359794616699219, 0.2849159240722656, -0.08639717102050781, 0.6746735572814941, 0.6201419830322266, 0.10816001892089844, 0.47530651092529297, -0.156219482421875, 0.9458780288696289, 1.5469894409179688, 0.8702163696289062, 0.3875904083251953, 0.2728557586669922, -0.5889816284179688, 1.0453987121582031, 1.9787187576293945, -0.009648323059082031, 0.15361976623535156, 1.3042926788330078, 0.696619987487793, 0.6266918182373047, 0.5043811798095703, 0.41698741912841797, 0.8007287979125977, 0.3080577850341797, 1.1800994873046875, -0.1494007110595703, 0.24920654296875, 1.0431079864501953, 4.7663893699646, 1.0984477996826172, -0.38488292694091797, 1.7667827606201172, -0.17521190643310547, -0.779205322265625, 1.6069645881652832, 0.503814697265625, 1.0187339782714844, 1.1549773216247559, -0.38370513916015625, -0.55792236328125, 0.9722557067871094, 0.6055068969726562, 12.54653263092041, 2.8670711517333984, 1.0671796798706055, 0.4930706024169922, -0.1490011215209961, -0.12297248840332031, 0.218414306640625, 0.42685699462890625, 0.5749683380126953, 0.22470855712890625, 2.7512474060058594, -1.2439584732055664, 0.42193126678466797, 0.2580413818359375, -0.2681894302368164, -0.40558433532714844, 0.9161300659179688, 0.12136650085449219, 0.3077812194824219, 0.5881500244140625, 0.6953220367431641, -7.109891891479492, -0.050495147705078125, -0.05834484100341797, 0.08367919921875, -4.805596351623535, -4.263315200805664, 0.2250652313232422, -0.15351390838623047, 0.9082279205322266, 0.5045909881591797, -0.39201927185058594, 0.0572509765625, -0.09769153594970703, 0.22740459442138672, 0.8968932628631592, 1.0687026977539062, -8.068267822265625, 0.46150970458984375, 0.10192680358886719, 0.5466041564941406, 0.8507232666015625, -0.5947303771972656, 12.938061714172363, 0.6340084075927734, 0.21286487579345703, 0.0041713714599609375, 0.12028312683105469, 0.0462493896484375, 2.095529556274414, 0.055759429931640625, 0.6704826354980469, 0.6746735572814941, 0.07570838928222656, 0.8363227844238281, 0.5869417190551758, -0.2634706497192383, 0.3993806838989258, 0.3341388702392578, -0.019899368286132812, 0.42004966735839844, 0.28578758239746094, -0.5874977111816406, 0.8563442230224609, 0.4828815460205078, 0.8230094909667969, 0.13622760772705078, -0.6229419708251953, 0.2578392028808594, -0.3446941375732422, 0.3402423858642578, -0.0713052749633789, 14.93004322052002, 0.5037393569946289, 0.6704826354980469, -0.044721126556396484, 8.963483810424805, 1.001286506652832, -1.0354652404785156, 0.4242057800292969, 1.0858173370361328, -0.4307365417480469, 1.6183586120605469, 0.04443168640136719, -0.10350799560546875, 0.440185546875, 0.567962646484375, -7.545450210571289, 0.16051101684570312, 0.02395153045654297, -0.16504859924316406, 0.034526824951171875, -0.33263492584228516, 1.1962175369262695, 0.7861156463623047, 1.250809669494629, 0.3588991165161133, 0.1853771209716797, -0.02080249786376953, 0.011537551879882812, 8.585740089416504, 1.250809669494629, 1.461883544921875, 1.7171258926391602, 0.9672107696533203, 0.7702217102050781, 0.1449756622314453, 0.3588991165161133, 0.47202491760253906, 0.1307830810546875, 0.40419483184814453, 0.14469146728515625, 0.7045478820800781, 0.5004997253417969, 0.5533275604248047, 0.24528217315673828, 0.2724761962890625, 1.4250035285949707, -0.26651954650878906, 1.0053577423095703, 1.1278553009033203, -0.025704383850097656, 0.3127861022949219, 1.8151159286499023, -1.2648792266845703, -0.48255157470703125, -0.26682090759277344, 0.00066375732421875, 0.1932516098022461, 0.3192253112792969, -0.1110982894897461, 0.9195466041564941, 0.5234012603759766, 0.24556636810302734, -0.28301048278808594, -0.2055034637451172, 0.04265880584716797, 0.3259420394897461, 0.19166088104248047, 1.1649017333984375, 0.35652923583984375, -0.04277610778808594, 0.3696002960205078, -1.1322154998779297, 0.3958091735839844, 0.1492462158203125, 0.6323280334472656, 0.1838092803955078, 0.029909133911132812, -0.39616966247558594, -0.13711071014404297, 0.025261878967285156, 0.3387794494628906, 0.1686258316040039, 0.548670768737793, 7.2074103355407715, 1.5631256103515625, 1.2483148574829102, -0.1402454376220703, -0.053619384765625, 0.29131555557250977, -0.28716087341308594, 0.42004966735839844, 12.870591163635254, 0.3288707733154297, 0.9070847034454346, 0.1430950164794922, -0.049124717712402344, 0.5001926422119141, 0.27562713623046875, 1.082305908203125, 0.28496742248535156, 0.5913105010986328, -1.3230361938476562, 0.6357908248901367, 0.4107398986816406, 0.3827075958251953, -0.3084993362426758, 0.16145992279052734, -0.03766822814941406, -9.306747436523438, 0.2561483383178711, -0.19070053100585938, 0.30240821838378906, 0.18562602996826172, 0.5782527923583984, 1.0258445739746094, 1.615640640258789, 0.05547332763671875, 0.4336357116699219, 0.719080924987793, 0.3008546829223633, 0.165863037109375, 1.2705574035644531, 0.31102943420410156, -0.21458053588867188, 1.7080340385437012, 0.37021636962890625, 1.1457700729370117, 0.24029064178466797, 0.1791515350341797, 11.210763931274414, 0.19681739807128906, 0.08922958374023438, 1.081369400024414, 0.0065937042236328125, -0.4000420570373535, -0.020376205444335938, 0.9341964721679688, 0.39262962341308594, 0.39937400817871094, 0.3940157890319824, -0.1704540252685547, -1.5209732055664062, 0.6495456695556641, 0.023530960083007812, 0.06924247741699219, -0.8773727416992188, 0.5212783813476562, -0.03206920623779297, 1.5542612075805664, -0.2677345275878906, 0.5869503021240234, -0.13200092315673828, 0.6523284912109375, 14.583383560180664, -0.22212982177734375, 1.3125133514404297, 0.785736083984375, 0.22939109802246094, 2.735668182373047, 1.0006961822509766, -0.9190444946289062, 0.4973278045654297, -0.1394634246826172, 0.5480136871337891, 0.545166015625, 0.4809436798095703, 0.043727874755859375, 0.40692710876464844, 1.2520980834960938, -0.05863761901855469, 0.5073032379150391, 0.1640605926513672, 0.9274845123291016, 1.2246055603027344, 0.24321365356445312, 5.00401496887207, -0.2580423355102539, 0.2287425994873047, -0.1881418228149414, 0.8889503479003906, -0.1727752685546875, -0.26488685607910156], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 81920, "num_env_steps_trained": 379500, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 379500, "last_target_update_ts": 81920, "num_target_updates": 159}, "sampler_results": {"episode_reward_max": 33.934633642435074, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -20.768162764087318, "episode_len_mean": 227.06, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834], "episode_lengths": [324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5628875068316256, "mean_inference_ms": 24.429851739288367, "mean_action_processing_ms": 0.13348380411791122, "mean_env_wait_ms": 4.5027189797591785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 33.934633642435074, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -20.768162764087318, "episode_len_mean": 227.06, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-238.14842000603676, 8.528313793241978, 17.121270827949047, 5.8461170345544815, -31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834], "episode_lengths": [324, 179, 197, 226, 244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5628875068316256, "mean_inference_ms": 24.429851739288367, "mean_action_processing_ms": 0.13348380411791122, "mean_env_wait_ms": 4.5027189797591785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 379500, "num_env_steps_sampled": 81920, "num_env_steps_trained": 379500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 81920, "agent_timesteps_total": 81920, "timers": {"training_iteration_time_ms": 338.921, "learn_time_ms": 71.346, "learn_throughput": 4204.876, "synch_weights_time_ms": 20.496}, "counters": {"num_env_steps_sampled": 81920, "num_env_steps_trained": 379500, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 379500, "last_target_update_ts": 81920, "num_target_updates": 159}, "done": false, "episodes_total": 318, "training_iteration": 80, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-31-52", "timestamp": 1655494312, "time_this_iter_s": 5.621031761169434, "time_total_s": 435.0642559528351, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 435.0642559528351, "timesteps_since_restore": 0, "iterations_since_restore": 80, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.81111111111111, "ram_util_percent": 64.05555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 15.178844451904297, "min_q": -3.395221710205078, "max_q": 36.16490173339844, "mean_td_error": 0.31039026379585266}, "td_error": [0.16638946533203125, 0.4497051239013672, 0.04976463317871094, 1.499979019165039, -0.32869720458984375, -0.03318214416503906, 0.473236083984375, -0.16754436492919922, -0.12019920349121094, 0.027393341064453125, 3.0240206718444824, 0.4296274185180664, -0.2708282470703125, -0.8904991149902344, 0.19269275665283203, 1.1378631591796875, 0.9616236686706543, 0.4542064666748047, -0.019380569458007812, -0.6476926803588867, 0.09192657470703125, -0.4819612503051758, -0.10392189025878906, 0.30747413635253906, 0.47376060485839844, 0.2287731170654297, 0.3834686279296875, 0.1629009246826172, -0.11972680687904358, -0.41536521911621094, 0.20093727111816406, 0.2262248992919922, -0.05452537536621094, -1.1020174026489258, 0.009553909301757812, 0.8508167266845703, 0.29395103454589844, 0.2795124053955078, 0.24217987060546875, -0.0042667388916015625, 0.4924755096435547, 0.11164283752441406, -0.43142032623291016, 0.8252391815185547, 8.757987976074219, 1.2834405899047852, 0.34391307830810547, -0.00360870361328125, 0.3274836540222168, 0.31061744689941406, 0.2434864044189453, -0.22215843200683594, -0.18668746948242188, 0.1488056182861328, 5.632369518280029, 0.013278961181640625, 0.5858230590820312, 0.24145030975341797, 0.37302207946777344, 0.0930023193359375, 0.3564281463623047, 0.3038616180419922, -0.16412115097045898, 0.1735363006591797, -0.1713123321533203, 0.0059490203857421875, 0.39852333068847656, 0.49497413635253906, -0.23375511169433594, 0.20546627044677734, -0.36475276947021484, 0.22269630432128906, 1.2073545455932617, 0.026436805725097656, -4.196281433105469, -0.2817087173461914, 0.20546627044677734, -0.009901046752929688, -5.95619010925293, -0.32579851150512695, -4.71707820892334, -0.9106931686401367, 0.11566448211669922, 0.1488056182861328, 0.6472549438476562, -0.8337440490722656, 0.04291725158691406, 0.322845458984375, 0.28995609283447266, 0.012746810913085938, 0.3028373122215271, -4.94549560546875, 1.1723089218139648, 0.336181640625, 0.056115150451660156, 17.226028442382812, -0.03486824035644531, 0.40140247344970703, 0.3486604690551758, 0.01627826690673828, 0.48873138427734375, 2.6194286346435547, 0.6241283416748047, 1.1018056869506836, 0.5389938354492188, 0.13784408569335938, 0.5123405456542969, 0.6738700866699219, 0.13116836547851562, 1.2189302444458008, -0.08938980102539062, 1.5284709930419922, -0.46097660064697266, 0.7221107482910156, -5.158817291259766, -0.22487258911132812, 0.33222484588623047, 0.10685539245605469, -0.07639598846435547, 2.5769004821777344, 0.3284330368041992, 0.2747020721435547, -0.5769271850585938, 0.5439987182617188, 0.4750328063964844, -0.3205537796020508, -4.324005126953125, 0.0720638632774353, -0.09355354309082031, 0.29613685607910156, 0.6554098129272461, 0.165557861328125, -0.04199409484863281, 0.9788656234741211, 0.30503082275390625, 0.6779708862304688, 0.5450363159179688, -0.18413543701171875, 0.47558116912841797, 0.46459102630615234, 0.886016845703125, 0.11883163452148438, -0.10979270935058594, 0.3222808837890625, -0.691622257232666, 0.37411022186279297, 0.3138723373413086, 0.34293556213378906, -0.48232078552246094, 0.07538986206054688, -0.14585208892822266, 0.5495243072509766, -0.2603130340576172, -0.10994815826416016, 4.867335319519043, 0.05731010437011719, 0.4320869445800781, 0.2050333023071289, -0.012377738952636719, 0.32045555114746094, 0.2828540802001953, -0.46349430084228516, 0.8808355331420898, 0.9616236686706543, 1.6240344047546387, 0.7359886169433594, 0.06935501098632812, -0.001232147216796875, -0.019080162048339844, -0.15523910522460938, -0.042987823486328125, 0.16625499725341797, -0.011037826538085938, 0.2287435531616211, -0.2196340560913086, 0.7423381805419922, 0.22927379608154297, -0.5144948959350586, 0.5554237365722656, 0.26389598846435547, -0.9264335632324219, 0.07716560363769531, 0.2550926208496094, 0.26741981506347656, -0.06284713745117188, -0.1640625, 0.5385379791259766, 0.6901679039001465, 0.9406285285949707, 0.8386440277099609, 0.4226837158203125, -0.30466651916503906, 0.2287435531616211, 0.18601608276367188, -0.5237522125244141, 0.13059616088867188, -1.1263618469238281, 1.7208118438720703, 0.5925941467285156, -0.3665275573730469, 0.6495647430419922, 2.103260040283203, -4.028507232666016, 0.4227418899536133, -0.1811542510986328, 0.0930023193359375, 0.6896705627441406, -0.4294605255126953, 12.952625274658203, 0.12090682983398438, 0.3630867004394531, 0.2889575958251953, 1.658005714416504, -0.302581787109375, 0.1954936981201172, -0.20426368713378906, 0.09434318542480469, -0.9012479782104492, 0.14565277099609375, 0.5799636840820312, 0.48828983306884766, -0.41062164306640625, 0.1805095672607422, 0.6384563446044922, -0.2499542236328125, 0.22024847567081451, 0.49497413635253906, -1.5735855102539062, 1.1220054626464844, 1.858527660369873, -0.678307056427002, -0.330169677734375, 0.9616236686706543, -4.786342144012451, 6.267450332641602, -0.36318397521972656, 0.6731081008911133, -0.7121744155883789, -0.5459537506103516, 0.49993228912353516, -0.3294248580932617, -0.3754415512084961, 0.5027027130126953, -0.20778560638427734, 1.0001592636108398, 1.5014519691467285, 0.8318347930908203, 0.23409080505371094, -5.019201278686523, 0.40110111236572266, 0.24453163146972656, -0.15801239013671875, 0.6455068588256836, 3.7827720642089844, 3.675482749938965, 0.6181745529174805, 0.9493427276611328, 0.06935501098632812, 1.7422208786010742, 0.4816570281982422, -0.13518905639648438, 0.20027542114257812, 1.3208093643188477, 0.7112655639648438, 1.6938438415527344, 0.5956311225891113, 0.4265460968017578, 0.1423206329345703, 0.9276237487792969, 0.3125782012939453, 0.0060176849365234375, 0.26497650146484375, 1.0447158813476562, 0.48632049560546875, 0.48705482482910156, 0.7668142318725586, -0.0778360366821289, 1.0384721755981445, 0.5971603393554688, -0.06498908996582031, 0.013692855834960938, 0.6377086639404297, 1.7669639587402344, 2.267742156982422, 0.16800880432128906, 0.4121513366699219, 0.15932750701904297, 2.1623497009277344, -10.643261909484863, 0.5958003997802734, -1.8602924346923828, 0.2590303421020508, 1.8792204856872559, 1.1995973587036133, 0.23735332489013672, 0.8801126480102539, 2.2448551654815674, 0.3395652770996094, -1.5884003639221191, 0.09098052978515625], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 82944, "num_env_steps_trained": 384300, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 384300, "last_target_update_ts": 82944, "num_target_updates": 161}, "sampler_results": {"episode_reward_max": 33.934633642435074, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -19.09417576558888, "episode_len_mean": 227.03, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168], "episode_lengths": [244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5630024793480495, "mean_inference_ms": 24.44717193776752, "mean_action_processing_ms": 0.13357973496000602, "mean_env_wait_ms": 4.504616595285286, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 33.934633642435074, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -19.09417576558888, "episode_len_mean": 227.03, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31.84260017424822, 32.711687333881855, 15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168], "episode_lengths": [244, 210, 216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5630024793480495, "mean_inference_ms": 24.44717193776752, "mean_action_processing_ms": 0.13357973496000602, "mean_env_wait_ms": 4.504616595285286, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 384300, "num_env_steps_sampled": 82944, "num_env_steps_trained": 384300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 82944, "agent_timesteps_total": 82944, "timers": {"training_iteration_time_ms": 345.829, "learn_time_ms": 72.559, "learn_throughput": 4134.575, "synch_weights_time_ms": 20.484}, "counters": {"num_env_steps_sampled": 82944, "num_env_steps_trained": 384300, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 384300, "last_target_update_ts": 82944, "num_target_updates": 161}, "done": false, "episodes_total": 322, "training_iteration": 81, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-31-57", "timestamp": 1655494317, "time_this_iter_s": 5.503693580627441, "time_total_s": 440.5679495334625, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 440.5679495334625, "timesteps_since_restore": 0, "iterations_since_restore": 81, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.099999999999998, "ram_util_percent": 64.02857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 15.254817962646484, "min_q": -4.867845058441162, "max_q": 33.75554275512695, "mean_td_error": 0.467459499835968}, "td_error": [0.794072151184082, 0.15680694580078125, -2.7027416229248047, 0.23775815963745117, 0.390472412109375, 0.3719654083251953, 0.3164520263671875, -0.08018684387207031, 0.5732040405273438, 0.11773109436035156, -0.07422065734863281, 1.5723190307617188, 0.4769401550292969, 1.069260597229004, 0.6201257705688477, -0.055572509765625, 1.4550247192382812, 0.045795440673828125, 0.2860755920410156, 0.1632061004638672, 22.198713302612305, -4.874931335449219, 1.2586669921875, 0.1320514678955078, 3.9711427688598633, -0.13718032836914062, -0.20038604736328125, 0.22897911071777344, 0.025304794311523438, -0.1129150390625, -5.816497802734375, 0.2369670867919922, 0.2886533737182617, 0.9282703399658203, 1.0091791152954102, 0.3457050323486328, 0.0022716522216796875, -0.5438003540039062, -0.15876102447509766, -5.352694511413574, 0.40857982635498047, -5.036092758178711, 0.006205558776855469, 0.4160118103027344, 1.3473734855651855, 0.041213035583496094, -0.044277191162109375, 13.730620384216309, -0.6771984100341797, 0.9931497573852539, 0.4612293243408203, -0.06318378448486328, 0.07011032104492188, 0.12416839599609375, 3.0244598388671875, 3.5150203704833984, 0.16302490234375, 0.5828571319580078, 0.6773509979248047, 8.571479797363281, 10.927506446838379, 0.2606353759765625, 0.6220083236694336, 0.44915008544921875, -0.35498714447021484, 0.49481773376464844, 0.1978893280029297, 0.13820838928222656, -0.46886444091796875, -0.49426841735839844, -8.987030029296875, 0.631683349609375, 0.5372161865234375, 0.2283496856689453, 10.89531135559082, 0.4122171401977539, 0.2960028648376465, 0.9847187995910645, 0.5424079895019531, 0.4002065658569336, 0.38002967834472656, 0.3162956237792969, -0.2723879814147949, 2.6795711517333984, -0.1289386749267578, 0.2987689971923828, 0.011735916137695312, -0.7278461456298828, 0.04389476776123047, 1.263016700744629, 0.6870222091674805, 0.10132408142089844, 0.6005973815917969, 0.36171817779541016, 0.7479124069213867, -0.04236030578613281, 0.5979938507080078, 0.7263445854187012, 0.31006622314453125, -0.345245361328125, -0.14623069763183594, -0.06526756286621094, 0.1560344696044922, -0.1108846664428711, -9.20836067199707, -9.415438652038574, 0.4556446075439453, -0.15081214904785156, 0.5132017135620117, 0.20720386505126953, 0.27467918395996094, -0.2616539001464844, 0.7271633148193359, 0.5714607238769531, 1.261606216430664, 0.10492515563964844, 0.36056268215179443, 0.6570701599121094, 0.4423394203186035, 0.6913967132568359, 0.11342430114746094, -0.647730827331543, 12.848860740661621, -0.08120918273925781, 0.13485336303710938, 0.3283224105834961, 0.5845341682434082, 1.3257856369018555, 0.1993885040283203, 0.5283355712890625, 2.3209848403930664, 0.013536453247070312, 0.6162128448486328, 0.009342193603515625, 0.6872062683105469, 1.092818260192871, 1.035369873046875, -6.1160888671875, 1.2126483917236328, 0.4776182174682617, 1.2916536331176758, 2.0239925384521484, -0.7402715682983398, 0.6145305633544922, 0.20030784606933594, 0.32138729095458984, 0.39871692657470703, 1.2653589248657227, 0.12495708465576172, 0.49469566345214844, -0.2502861022949219, 0.03232383728027344, 0.34567928314208984, 1.0183753967285156, -9.415438652038574, 0.20154809951782227, 1.1687736511230469, 0.26763367652893066, 0.19012069702148438, 0.04657745361328125, 0.1416778564453125, -11.290495872497559, 0.1594219207763672, 0.06986427307128906, 1.3465356826782227, 0.6570701599121094, 0.5860786437988281, 0.2675046920776367, 0.5633792877197266, -0.1761951446533203, 0.21784210205078125, -0.6413774490356445, 0.2422161102294922, 0.41266822814941406, 0.8863658905029297, 1.408205509185791, 0.43650341033935547, 0.2282581329345703, 0.08225250244140625, 1.0987873077392578, -0.052901268005371094, 0.6140141487121582, 0.7555656433105469, 0.9357719421386719, 0.9798240661621094, 0.6548194885253906, -0.003276824951171875, -0.2622699737548828, 0.38277244567871094, 0.4232158660888672, -0.14831161499023438, -0.15955352783203125, 10.200960159301758, 0.2582216262817383, 1.2188072204589844, 0.0025119781494140625, 1.4547014236450195, 0.13658905029296875, -0.3572549819946289, -0.2999277114868164, 1.2506103515625, 0.6171302795410156, 2.070423126220703, 0.3041801452636719, 0.3083038330078125, 0.021823883056640625, -6.371940612792969, -5.1845855712890625, 0.9304389953613281, -0.4954805374145508, -0.11970138549804688, 0.025661468505859375, 0.7623624801635742, 0.09112167358398438, 0.7574234008789062, 0.768620491027832, 0.10593032836914062, 0.3471965789794922, 0.2982463836669922, 0.7649850845336914, 1.044999599456787, 1.027029037475586, 0.1864337921142578, 0.24354839324951172, 0.5853862762451172, 1.0192232131958008, 0.2334117889404297, 0.2125258445739746, -0.20082664489746094, -0.06189250946044922, 0.30988550186157227, -0.9627704620361328, 1.3129997253417969, 0.6675224304199219, 0.16026878356933594, 0.22731971740722656, 8.271781921386719, 1.0208263397216797, 1.408205509185791, 1.263016700744629, 0.7808609008789062, -0.09072303771972656, 0.19072723388671875, 0.1338329315185547, 0.3457050323486328, 0.9401226043701172, -0.046844482421875, 0.15398120880126953, -1.465484619140625, -2.704418182373047, 0.8246746063232422, 0.02736663818359375, -0.05197334289550781, 0.24490928649902344, 0.5556421279907227, 1.329542636871338, 0.2955656051635742, 0.15030193328857422, -0.20052528381347656, 0.3781547546386719, -0.05173492431640625, 0.5696382522583008, 0.23186969757080078, -0.39450502395629883, -0.06178569793701172, -0.0546417236328125, 1.8279294967651367, 0.49199485778808594, 0.7396984100341797, 0.3737053871154785, 0.6015825271606445, 1.0235004425048828, 0.9449167251586914, 1.832235336303711, 1.0485057830810547, 0.0073032379150390625, 0.7175073623657227, 0.6773509979248047, 0.04820442199707031, 0.14977645874023438, 0.7631111145019531, 0.22102832794189453, 0.812891960144043, 23.73603630065918, 0.5424079895019531, 1.6939716339111328, 2.376718521118164, 2.3234195709228516, 0.17755889892578125, -0.11844253540039062, 0.3523139953613281, 2.2392501831054688, -5.178852081298828, 0.1411118507385254, 0.23418521881103516, 0.17163467407226562, -8.581123352050781, 0.039928436279296875, 1.0532302856445312, -0.07699394226074219], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 83968, "num_env_steps_trained": 389100, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 389100, "last_target_update_ts": 83968, "num_target_updates": 163}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -18.681459095925092, "episode_len_mean": 227.01, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673], "episode_lengths": [216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5637225059772603, "mean_inference_ms": 24.445428337206543, "mean_action_processing_ms": 0.1335438140804572, "mean_env_wait_ms": 4.508816952999013, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -18.681459095925092, "episode_len_mean": 227.01, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.300902709364891, 28.37462016940117, -31.154165223240852, 16.561491638422012, -54.29424846917391, 6.300000123679638, -6.724578686058521, 12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673], "episode_lengths": [216, 182, 240, 203, 258, 205, 231, 246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5637225059772603, "mean_inference_ms": 24.445428337206543, "mean_action_processing_ms": 0.1335438140804572, "mean_env_wait_ms": 4.508816952999013, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 389100, "num_env_steps_sampled": 83968, "num_env_steps_trained": 389100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 83968, "agent_timesteps_total": 83968, "timers": {"training_iteration_time_ms": 351.432, "learn_time_ms": 73.757, "learn_throughput": 4067.41, "synch_weights_time_ms": 21.588}, "counters": {"num_env_steps_sampled": 83968, "num_env_steps_trained": 389100, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 389100, "last_target_update_ts": 83968, "num_target_updates": 163}, "done": false, "episodes_total": 324, "training_iteration": 82, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-32-03", "timestamp": 1655494323, "time_this_iter_s": 5.702281713485718, "time_total_s": 446.27023124694824, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 446.27023124694824, "timesteps_since_restore": 0, "iterations_since_restore": 82, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 35.55555555555556, "ram_util_percent": 64.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 15.426736831665039, "min_q": -1.377601146697998, "max_q": 32.65941619873047, "mean_td_error": -0.06239971145987511}, "td_error": [0.3362894058227539, 0.09030437469482422, -0.10020732879638672, -0.023702621459960938, -0.1000833511352539, 9.651298522949219, 0.5779604911804199, 0.4417741298675537, -0.1426849365234375, 0.033620357513427734, -6.97479248046875, -0.2743806838989258, -0.7267608642578125, -0.1487140655517578, 0.12948989868164062, -9.684843063354492, -0.18294906616210938, -0.07118511199951172, -2.701932907104492, -0.14249420166015625, -0.28682899475097656, -1.4768872261047363, -0.15293502807617188, 7.34785795211792, 0.3640613555908203, -0.37000370025634766, 0.11247634887695312, -0.02151775360107422, 1.0883264541625977, -1.1568717956542969, 0.07058906555175781, -5.375093460083008, -0.8290843963623047, -0.03901100158691406, 1.084245204925537, -0.04547309875488281, 0.39727210998535156, -0.1968231201171875, 0.24264907836914062, 0.2714347839355469, 0.4327516555786133, 0.0093994140625, -0.07803058624267578, 0.08162689208984375, 0.34351634979248047, 0.4693460464477539, 0.3723468780517578, -0.5498309135437012, 0.6007609367370605, -0.6000080108642578, -0.9488639831542969, 0.6007609367370605, 0.27536964416503906, -0.1307697296142578, 0.255281925201416, 0.3946342468261719, -0.35887908935546875, 0.058501243591308594, -9.953639030456543, 0.09298038482666016, -0.316436767578125, 1.2235584259033203, -0.1611347198486328, -0.8263635635375977, 0.163604736328125, -0.3124237060546875, 1.4953193664550781, -0.12459564208984375, -6.933141708374023, 0.3309497833251953, 0.1908111572265625, -0.14611434936523438, -0.2590980529785156, -0.17533493041992188, -0.48450469970703125, 6.615653991699219, -3.0284366607666016, 0.3688163757324219, -0.34514904022216797, -0.1646776795387268, -0.33730649948120117, -0.015558242797851562, 0.2712059020996094, 0.2976703643798828, 0.6840982437133789, -0.037174224853515625, 0.18517494201660156, 0.020275115966796875, -8.648479461669922, -0.06023406982421875, 8.497994422912598, -0.21845245361328125, -0.07583999633789062, 0.6248302459716797, 0.3688163757324219, -0.167633056640625, 11.977457046508789, -1.7346172332763672, -0.5982742309570312, -1.1308612823486328, -0.6505026817321777, -0.10915756225585938, -0.03828239440917969, 9.570840835571289, -0.2498798370361328, -0.2471332550048828, -0.022696971893310547, 0.18152332305908203, -2.0123462677001953, -0.13621807098388672, -0.7072086334228516, -0.43778419494628906, -0.31519317626953125, 0.24875831604003906, 0.11794281005859375, -0.4843177795410156, 0.003131866455078125, -0.5032052993774414, -0.43265199661254883, 0.026386260986328125, 0.5565700531005859, -0.9448776245117188, -1.1722478866577148, -0.0729217529296875, 1.6265449523925781, 0.0016489028930664062, -0.32617664337158203, 0.526494026184082, -0.24462509155273438, 0.15834808349609375, 0.005473136901855469, 0.8122959136962891, -0.2471466064453125, -0.1079254150390625, -0.0043182373046875, -0.31568050384521484, 0.2281055450439453, 0.0169830322265625, -0.1091914176940918, -0.19635009765625, 0.5396671295166016, -0.43265199661254883, -0.07936286926269531, 0.06128978729248047, -0.5738544464111328, 0.5019865036010742, 0.3200807571411133, -7.0647687911987305, -0.9026470184326172, 0.3521909713745117, -0.4665803909301758, 0.24432754516601562, -0.35037803649902344, 9.207358360290527, -0.2903251647949219, 0.1802234649658203, -0.12268543243408203, -0.5005693435668945, -0.09079837799072266, 0.5936565399169922, -1.1551427841186523, -0.28603172302246094, -0.670619010925293, -0.5821762084960938, -0.39443206787109375, -0.2963581085205078, 0.3002204895019531, -0.4048938751220703, 5.517866134643555, 16.13588523864746, -0.03901100158691406, 0.2724323272705078, 1.9272699356079102, -4.586112976074219, -0.092498779296875, -0.21280384063720703, -0.03514862060546875, 0.6281051635742188, 1.517618179321289, 0.03525543212890625, -0.0071086883544921875, 0.34255218505859375, -0.7262811660766602, -0.42653656005859375, 0.07929134368896484, 0.08713722229003906, 0.07040882110595703, -0.010732650756835938, -0.5893802642822266, 0.06301689147949219, -0.6695356369018555, 0.7180995941162109, 0.6728000640869141, 0.1907939910888672, -0.07252693176269531, -0.04843616485595703, -0.7768325805664062, 0.6397595405578613, -0.1168680191040039, 0.8769302368164062, 0.3424644470214844, 3.0903730392456055, -0.07771682739257812, 0.7922763824462891, -0.094451904296875, 0.009115219116210938, -0.32163429260253906, -0.3465614318847656, 0.07705497741699219, 20.738811492919922, 0.5634689331054688, 0.001346588134765625, -0.041942596435546875, 0.1511859893798828, -5.741003036499023, 1.3496437072753906, 0.024995803833007812, 0.2649879455566406, 1.517618179321289, 0.21210765838623047, 1.2235584259033203, -0.18543434143066406, -0.15527057647705078, -0.3794994354248047, 0.6730556488037109, 0.10979080200195312, 0.47364139556884766, -1.185317039489746, -0.991790771484375, 0.23289871215820312, 0.770106315612793, 0.007856369018554688, -0.3580493927001953, -1.3117790222167969, -0.3640022277832031, -0.2447662353515625, -5.048981666564941, -0.4497523307800293, -0.9949131011962891, -0.47687816619873047, 0.3944988250732422, -0.13404083251953125, 0.22162437438964844, -0.5194158554077148, -0.10336017608642578, 0.11435127258300781, 0.11460685729980469, 0.12009334564208984, -0.0147552490234375, -0.25059032440185547, 1.2567262649536133, -0.34480953216552734, 0.6000702381134033, -0.1547107696533203, -4.504798889160156, -0.8705635070800781, -0.48612403869628906, 0.19359207153320312, 0.4586305618286133, -0.3513975143432617, 0.2238321304321289, -0.18027305603027344, -0.6953353881835938, 0.3170318603515625, 0.721189022064209, -0.43162059783935547, 2.095587730407715, -0.34617042541503906, -5.288504600524902, 0.08146286010742188, -0.685028076171875, -0.08414745330810547, 1.0515460968017578, -0.5420780181884766, -0.4198169708251953, -0.1391592025756836, -0.15910053253173828, -0.3867816925048828, 0.15461349487304688, -0.09477806091308594, -9.488269805908203, 0.2063732147216797, -0.19522857666015625, -9.542753219604492, -5.444515228271484, 0.34145259857177734, 0.5324115753173828, 0.13025856018066406, 0.39681243896484375, -1.184122085571289, 0.5299210548400879, -4.111789703369141, -0.2075967788696289, 0.18800735473632812, 0.8681855201721191, -0.2244739532470703, -0.071533203125, -0.473876953125, -0.41237545013427734, -7.736688613891602], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 84992, "num_env_steps_trained": 393900, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 393900, "last_target_update_ts": 84992, "num_target_updates": 165}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -22.163871086984873, "episode_len_mean": 228.84, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503], "episode_lengths": [246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.56411888422729, "mean_inference_ms": 24.4521275795777, "mean_action_processing_ms": 0.13358597252472718, "mean_env_wait_ms": 4.510422514071326, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -484.3420528098941, "episode_reward_mean": -22.163871086984873, "episode_len_mean": 228.84, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.224757693707943, 13.910635210573673, -484.3420528098941, -45.06511031091213, 21.47542104125023, -334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503], "episode_lengths": [246, 212, 393, 250, 198, 340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.56411888422729, "mean_inference_ms": 24.4521275795777, "mean_action_processing_ms": 0.13358597252472718, "mean_env_wait_ms": 4.510422514071326, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 393900, "num_env_steps_sampled": 84992, "num_env_steps_trained": 393900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 84992, "agent_timesteps_total": 84992, "timers": {"training_iteration_time_ms": 357.219, "learn_time_ms": 73.554, "learn_throughput": 4078.637, "synch_weights_time_ms": 20.589}, "counters": {"num_env_steps_sampled": 84992, "num_env_steps_trained": 393900, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 393900, "last_target_update_ts": 84992, "num_target_updates": 165}, "done": false, "episodes_total": 331, "training_iteration": 83, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-32-09", "timestamp": 1655494329, "time_this_iter_s": 5.740321397781372, "time_total_s": 452.0105526447296, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 452.0105526447296, "timesteps_since_restore": 0, "iterations_since_restore": 83, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.6125, "ram_util_percent": 64.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 15.064436912536621, "min_q": -2.0094265937805176, "max_q": 36.962379455566406, "mean_td_error": -0.2438683807849884}, "td_error": [-0.18926525115966797, -0.09773826599121094, -0.08090019226074219, 0.21762847900390625, -0.8703708648681641, -0.8424911499023438, -2.6636524200439453, -0.13512229919433594, -0.035007476806640625, 6.397897720336914, -0.36711692810058594, 1.2327852249145508, 6.556487083435059, -0.16629505157470703, 0.6942081451416016, 0.5352954864501953, 0.5960721969604492, -0.4311676025390625, 0.2196812629699707, 0.22459983825683594, -0.3967628479003906, -0.5931224822998047, -0.4289207458496094, -0.7619228363037109, 0.18050384521484375, -0.19424819946289062, 0.16315841674804688, -0.009585857391357422, 0.9769134521484375, -0.11667633056640625, 0.4601578712463379, -0.6284542083740234, -0.3510856628417969, -0.9969749450683594, -0.31598854064941406, 1.8627910614013672, 1.1068038940429688, -0.22377872467041016, -0.3243217468261719, 0.29624271392822266, -0.9784669876098633, 1.1975173950195312, -0.03186798095703125, -0.058905601501464844, 0.1640491485595703, -0.013584136962890625, 0.03830146789550781, 0.33031654357910156, 0.7800464630126953, 0.43732166290283203, -0.3737678527832031, -0.1559276580810547, -0.26132965087890625, 0.5352954864501953, 0.7455687522888184, -0.259432315826416, -0.20163583755493164, 0.10161304473876953, -9.993891716003418, -5.0438690185546875, -0.43846988677978516, 0.42171287536621094, -0.04618644714355469, 0.1430377960205078, 1.7560534477233887, -7.388474941253662, 0.032855987548828125, -0.10083961486816406, -0.27246952056884766, -1.21075439453125, 0.9552252292633057, 0.07610130310058594, -0.0877227783203125, -0.12191581726074219, 0.16103363037109375, -0.508514404296875, -0.5023946762084961, -0.6348361968994141, 0.40242767333984375, -3.3828392028808594, -6.534708023071289, 0.008867263793945312, 0.04554557800292969, 8.525766372680664, -0.0208587646484375, 0.09855842590332031, -0.1904888153076172, -1.0209035873413086, 0.15265941619873047, 0.1955242156982422, -0.3642425537109375, 0.046202659606933594, -0.9413051605224609, 0.25358057022094727, -0.04542064666748047, 0.8298177719116211, -0.07047653198242188, 1.8186836242675781, -0.2748394012451172, -0.3942384719848633, 0.10538101196289062, -0.2943572998046875, -1.7947988510131836, -0.4545307159423828, -0.8717727661132812, -0.9473648071289062, 0.0022306442260742188, -4.892396926879883, -1.3603096008300781, 0.027301788330078125, -0.5243816375732422, -0.3043537139892578, 0.054190635681152344, -0.013945579528808594, -0.5178861618041992, 0.5191993713378906, 0.2523918151855469, 0.03367042541503906, -0.4661083221435547, -0.35927772521972656, 0.7022266387939453, -0.20812225341796875, 0.1331338882446289, -0.1226205825805664, 0.34874534606933594, -0.35797882080078125, -0.9896087646484375, -0.5720334053039551, -0.05631065368652344, 0.35786914825439453, 0.010616302490234375, -0.393035888671875, -0.42820167541503906, 2.009650230407715, -0.06921577453613281, -0.7581748962402344, 0.012426376342773438, 0.19293498992919922, -0.14644908905029297, -0.1914043426513672, -7.4029541015625, -0.47383880615234375, 0.6227817535400391, 0.1384601593017578, -0.09154701232910156, -0.06769466400146484, 0.10327768325805664, 0.06757164001464844, -0.23785066604614258, 0.36098289489746094, 0.13090133666992188, -1.5268993377685547, 0.7555246353149414, -0.3675508499145508, 0.6011066436767578, -4.673977851867676, 0.9005222320556641, 0.14190673828125, 0.22835731506347656, -0.6906452178955078, -0.8130426406860352, 0.11588668823242188, 0.41412353515625, -0.6967391967773438, -0.7704257965087891, -0.28336334228515625, 0.2738628387451172, -0.13064193725585938, 1.668168067932129, 0.9065777063369751, -0.27066898345947266, -7.499929428100586, 0.2225666046142578, 0.18005943298339844, 13.242951393127441, 0.015410423278808594, -0.6241035461425781, -0.09173011779785156, 0.6653614044189453, 1.1042804718017578, -0.38489723205566406, -0.11084270477294922, -0.39961814880371094, -0.09335517883300781, -0.2982807159423828, -0.20098876953125, -0.6536703109741211, -0.6186895370483398, 0.12793731689453125, -1.1582393646240234, -0.7154397964477539, 0.6998291015625, -0.3516826629638672, -0.07952117919921875, -0.2791328430175781, 0.2263031005859375, 0.009857177734375, -0.16642189025878906, 0.20418357849121094, 1.1914453506469727, -0.13420677185058594, -0.12691307067871094, 0.08314323425292969, 0.9931936264038086, -0.07944679260253906, 0.3218498229980469, -0.30042457580566406, -0.2517099380493164, -0.8677129745483398, -0.541748046875, 1.737234115600586, 0.9794349670410156, -0.5254793167114258, -0.32877635955810547, 0.44225454330444336, -5.649026870727539, 0.379549503326416, -1.306478500366211, -0.36048126220703125, 0.18025588989257812, 0.10657691955566406, -0.06436538696289062, -5.2491607666015625, -0.43773460388183594, -0.9868470430374146, 0.828059196472168, -0.05059242248535156, -0.38642120361328125, -0.07686138153076172, 0.09595108032226562, -5.165840148925781, 0.06525802612304688, 0.4398527145385742, 0.063812255859375, -0.08831596374511719, 0.00829315185546875, 0.7703218460083008, -0.017581939697265625, 0.5142931938171387, 0.24048811197280884, -0.6639404296875, 0.08957481384277344, -0.3354501724243164, -0.12743282318115234, -0.37725257873535156, -0.9127750396728516, -0.18413925170898438, 0.04846763610839844, 0.04596996307373047, -0.7573490142822266, -0.03312873840332031, -0.19683074951171875, -0.2439708709716797, 0.001895904541015625, -0.3820066452026367, -0.33173370361328125, 0.3014211654663086, -1.1183600425720215, 0.09984588623046875, -0.2929534912109375, -0.46988487243652344, -0.5278472900390625, 0.12783050537109375, 0.07783317565917969, 0.4576101303100586, -0.07686138153076172, -1.3807973861694336, -0.9850349426269531, 1.7196378707885742, -0.45497894287109375, -0.38631248474121094, -0.6273727416992188, 1.052694320678711, -0.5997066497802734, -0.5187511444091797, 1.4654054641723633, -5.663980484008789, -0.1259288787841797, -0.20971107482910156, -0.4503626823425293, 0.083282470703125, 0.2046680450439453, 0.7954425811767578, -8.651823043823242, -1.0446205139160156, -0.012606620788574219, -0.36763060092926025, 2.8086729049682617, -0.1543292999267578, -7.364891052246094, 0.13594722747802734, 0.24048811197280884, -0.2960224151611328, 0.12798690795898438, -0.6334571838378906, -0.24512481689453125, -0.4731111526489258, -0.09735298156738281, -0.11432647705078125, -0.0002384185791015625], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 86016, "num_env_steps_trained": 398700, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 398700, "last_target_update_ts": 86016, "num_target_updates": 167}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -334.2552738338709, "episode_reward_mean": -19.02237880989909, "episode_len_mean": 227.38, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877], "episode_lengths": [340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.56487265672473, "mean_inference_ms": 24.439367867748146, "mean_action_processing_ms": 0.13352442400227635, "mean_env_wait_ms": 4.513610554386881, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -334.2552738338709, "episode_reward_mean": -19.02237880989909, "episode_len_mean": 227.38, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-334.2552738338709, -27.800000078976154, 11.699999921023846, 7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877], "episode_lengths": [340, 200, 194, 241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.56487265672473, "mean_inference_ms": 24.439367867748146, "mean_action_processing_ms": 0.13352442400227635, "mean_env_wait_ms": 4.513610554386881, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 398700, "num_env_steps_sampled": 86016, "num_env_steps_trained": 398700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 86016, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 342.637, "learn_time_ms": 73.166, "learn_throughput": 4100.251, "synch_weights_time_ms": 20.488}, "counters": {"num_env_steps_sampled": 86016, "num_env_steps_trained": 398700, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 398700, "last_target_update_ts": 86016, "num_target_updates": 167}, "done": false, "episodes_total": 336, "training_iteration": 84, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-32-15", "timestamp": 1655494335, "time_this_iter_s": 5.54442286491394, "time_total_s": 457.55497550964355, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 457.55497550964355, "timesteps_since_restore": 0, "iterations_since_restore": 84, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.9875, "ram_util_percent": 64.0125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 15.034387588500977, "min_q": -3.4604506492614746, "max_q": 37.830909729003906, "mean_td_error": -0.26818156242370605}, "td_error": [0.1043853759765625, -0.07476043701171875, 0.05962181091308594, 1.0969462394714355, 0.1341533660888672, 0.22786712646484375, -0.5206718444824219, 0.2580680847167969, 0.049256324768066406, -0.22130775451660156, 0.4358682632446289, -0.6104416847229004, 0.25890350341796875, -0.2446136474609375, 1.4876346588134766, -0.18135833740234375, -0.7159957885742188, 0.2484912872314453, -1.045989990234375, 0.060260772705078125, 0.08755207061767578, -0.40587735176086426, -0.033702850341796875, -0.035053253173828125, 0.17299652099609375, -1.16241455078125, 0.20749664306640625, 0.21340179443359375, 0.11902046203613281, -1.2614216804504395, -0.5538253784179688, 0.502629280090332, -0.2323751449584961, 0.3452262878417969, -0.6571464538574219, 0.9366049766540527, -0.15749740600585938, -0.6383209228515625, -0.31929969787597656, 0.7459640502929688, 0.0599212646484375, -0.9482822418212891, -0.3487262725830078, -2.740067481994629, 0.2990837097167969, -0.16642522811889648, -0.33226776123046875, -0.2945127487182617, -0.10311126708984375, 0.12222576141357422, 0.01003265380859375, 0.16188430786132812, 0.13678407669067383, -0.6715412139892578, -0.33993053436279297, -1.1588611602783203, -0.14208412170410156, -0.9863481521606445, -0.6928501129150391, -0.10758113861083984, 0.28673362731933594, -0.6812534332275391, 0.13248062133789062, -2.3627052307128906, -5.222442626953125, -0.035831451416015625, -0.06785774230957031, 0.10503005981445312, -0.16401290893554688, -0.023992538452148438, -0.3585395812988281, 0.5297374725341797, 0.3535480499267578, -0.2021169662475586, -0.12504005432128906, 9.06684398651123, -1.8180179595947266, 0.07579803466796875, -0.6643906831741333, -0.4750657081604004, -0.3602619171142578, -1.8134384155273438, -0.3768463134765625, -0.30356597900390625, 0.46495914459228516, 0.174713134765625, -6.303418159484863, -7.894402980804443, 13.11716365814209, 0.28336524963378906, -0.5993518829345703, -0.08751296997070312, 0.054622650146484375, -0.2955198287963867, -0.12334156036376953, 0.17206096649169922, -0.47603416442871094, 0.15224838256835938, -0.2490692138671875, -0.4445152282714844, 0.5127429962158203, -0.36516720056533813, 0.5079593658447266, 0.1233673095703125, 0.17396926879882812, -0.19333267211914062, -0.99432373046875, 0.02259063720703125, -0.5339031219482422, -0.1552743911743164, -0.1598968505859375, -9.100749969482422, -2.2687716484069824, -0.17283248901367188, 0.050293922424316406, 0.06912994384765625, -0.8703556060791016, -0.7333593368530273, -5.004575729370117, 0.03464698791503906, -0.268965482711792, -4.935617446899414, -0.18752670288085938, -0.13533878326416016, -0.3129119873046875, 0.8375720977783203, 0.14350128173828125, 0.1972675323486328, -0.1914539337158203, -0.6187877655029297, 0.1524362564086914, -4.797798156738281, 0.7201414108276367, 1.0729808807373047, 0.22688674926757812, 0.10178756713867188, -0.7431902885437012, -0.3771800994873047, -0.04477691650390625, -0.06271839141845703, -1.045989990234375, -0.4479789733886719, -1.8420276641845703, -0.5370407104492188, 0.04543781280517578, -0.2200298309326172, -0.3998069763183594, -0.1552743911743164, -0.3185453414916992, 8.453228950500488, -6.123180389404297, 0.050293922424316406, 0.24909210205078125, 0.0061244964599609375, -0.3422236442565918, -0.2585773468017578, -0.15553760528564453, 0.24634170532226562, -0.03437042236328125, -0.1552743911743164, -9.373852729797363, -0.28725433349609375, -0.2842674255371094, 0.5987310409545898, 0.5412807464599609, 0.043045997619628906, 0.15361309051513672, -0.6513814926147461, 0.27614593505859375, 0.035556793212890625, -0.33019590377807617, 0.21805953979492188, 1.0406417846679688, -0.8551864624023438, -0.32721710205078125, 0.16895294189453125, 1.1096937656402588, 0.3245563507080078, 1.3236408233642578, -0.23050498962402344, -0.5447254180908203, 6.317415714263916, -0.17955970764160156, -1.179574966430664, 1.392141342163086, 0.16596031188964844, -2.284855842590332, -0.29207801818847656, -0.32732295989990234, -0.1611032485961914, 2.701207160949707, -1.047159194946289, 0.17960166931152344, 0.2525463104248047, -0.23643219470977783, -0.37032508850097656, -0.1328582763671875, -0.5317888259887695, -0.3574066162109375, 0.22623348236083984, -0.4479013681411743, -0.6051111221313477, 0.0010614395141601562, -0.3776741027832031, -0.019697189331054688, -8.721322059631348, 0.5148153305053711, -0.5452079772949219, 0.028405189514160156, -0.6650867462158203, 0.47571802139282227, -0.10157203674316406, 0.5829465389251709, 9.504279136657715, -7.345608711242676, -0.4965038299560547, 0.34079551696777344, -6.76542854309082, -0.32721710205078125, -0.4443702697753906, 0.44445323944091797, -0.018093109130859375, -0.4435386657714844, 0.6739082336425781, -0.3074207305908203, 0.010824203491210938, 1.6218090057373047, -0.20044517517089844, 1.4876346588134766, -0.10650920867919922, 0.022752761840820312, 0.4100227355957031, -0.5072116851806641, 0.4086189270019531, -0.43126678466796875, 0.6938793659210205, -0.11897945404052734, 0.07535552978515625, -1.9528121948242188, 0.34613800048828125, 0.04752206802368164, -0.6905231475830078, 0.2048969268798828, 0.49929046630859375, -0.10650920867919922, -0.2611122131347656, -8.6929931640625, 0.047059059143066406, -0.13389205932617188, 0.11040496826171875, -0.308927059173584, -6.942041397094727, 0.26488304138183594, -0.44059085845947266, -0.063568115234375, -0.30828285217285156, -0.4118022918701172, 0.10908985137939453, -1.097945213317871, 0.10974311828613281, 11.89096736907959, -0.22202110290527344, 0.8547210693359375, -0.41398048400878906, -0.0054683685302734375, 0.18015003204345703, 0.9485292434692383, -0.1552743911743164, 0.08868026733398438, -0.1548595428466797, 12.755099296569824, -0.0422368049621582, -5.1895599365234375, 0.05834197998046875, 0.12720870971679688, -0.5557880401611328, -4.177248001098633, -7.061463356018066, -0.19858551025390625, -0.03259849548339844, -0.29857540130615234, -0.32084083557128906, -0.41902828216552734, 0.023728370666503906, -0.053478240966796875, 0.16370201110839844, 0.021509170532226562, 0.24551057815551758, -0.3956432342529297, -0.0018749237060546875, -0.3526444435119629, -0.008638381958007812, -0.023426055908203125, 0.5639801025390625, -0.19487571716308594, 0.09641456604003906, 0.12973785400390625, 0.07013416290283203, 0.22867393493652344, -6.948060989379883], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 87040, "num_env_steps_trained": 403500, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 403500, "last_target_update_ts": 87040, "num_target_updates": 169}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -261.7231772765517, "episode_reward_mean": -16.223533906266095, "episode_len_mean": 227.1, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296], "episode_lengths": [241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5663094194010463, "mean_inference_ms": 24.461733074661996, "mean_action_processing_ms": 0.13358286559612179, "mean_env_wait_ms": 4.5242085629288145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -261.7231772765517, "episode_reward_mean": -16.223533906266095, "episode_len_mean": 227.1, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.610635325312614, 7.200000040233135, 7.4106356129050255, 18.727241553366184, 23.052169129252434, 16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296], "episode_lengths": [241, 177, 214, 209, 230, 204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5663094194010463, "mean_inference_ms": 24.461733074661996, "mean_action_processing_ms": 0.13358286559612179, "mean_env_wait_ms": 4.5242085629288145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 403500, "num_env_steps_sampled": 87040, "num_env_steps_trained": 403500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 87040, "agent_timesteps_total": 87040, "timers": {"training_iteration_time_ms": 355.576, "learn_time_ms": 72.814, "learn_throughput": 4120.093, "synch_weights_time_ms": 20.489}, "counters": {"num_env_steps_sampled": 87040, "num_env_steps_trained": 403500, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 403500, "last_target_update_ts": 87040, "num_target_updates": 169}, "done": false, "episodes_total": 339, "training_iteration": 85, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-32-21", "timestamp": 1655494341, "time_this_iter_s": 5.537306308746338, "time_total_s": 463.0922818183899, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 463.0922818183899, "timesteps_since_restore": 0, "iterations_since_restore": 85, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.7625, "ram_util_percent": 64.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.777968406677246, "min_q": -2.536057949066162, "max_q": 32.33601379394531, "mean_td_error": 0.06752099096775055}, "td_error": [-0.8020782470703125, -0.06756210327148438, -0.08342933654785156, 0.06614875793457031, -7.208353042602539, 0.23946475982666016, 0.09748268127441406, -0.40493011474609375, 3.880910873413086, -0.46718597412109375, -0.39890289306640625, 1.6225004196166992, 0.9931001663208008, -0.03125572204589844, -0.1260986328125, -0.16794443130493164, 0.2381753921508789, 1.0599727630615234, 0.3869667053222656, 0.7851934432983398, 0.22310829162597656, -0.24469375610351562, -0.10531044006347656, 0.6670417785644531, 4.377693176269531, -9.471973419189453, 0.5465130805969238, -0.1912250518798828, 0.24898719787597656, -0.8046760559082031, -9.604190826416016, 0.12492752075195312, 0.03948783874511719, 0.1308913230895996, -0.3933677673339844, 0.3890953063964844, -0.5939698219299316, -0.22479724884033203, 0.4343452453613281, 11.293078422546387, -0.5869331359863281, 0.16411399841308594, -0.08340263366699219, 1.3229084014892578, 0.05473804473876953, -0.4664630889892578, 0.7351870536804199, 0.0203399658203125, 0.7904090881347656, -0.7724666595458984, -0.16871261596679688, 0.14548587799072266, 0.11585044860839844, -5.882024765014648, -0.2800312042236328, 0.230499267578125, 1.1976861953735352, 0.9423255920410156, 0.8146133422851562, -0.6237506866455078, 0.13034439086914062, -0.5287971496582031, 0.2154674530029297, 0.04586505889892578, 0.033298492431640625, 0.710472583770752, 15.792160987854004, 0.7901401519775391, 0.43291670083999634, -0.5339412689208984, 3.059345245361328, -0.880650520324707, 0.2567253112792969, 0.4313850402832031, 0.46872615814208984, 0.10021018981933594, -1.0044727325439453, 0.13454532623291016, 0.21922969818115234, 0.3845367431640625, 1.3492698669433594, -0.2742767333984375, -0.0791015625, -0.026375293731689453, -0.04240608215332031, -0.04498291015625, 0.04034233093261719, 0.45448601245880127, 1.8927440643310547, 0.512211799621582, 1.409630298614502, 0.36736106872558594, 3.066481590270996, -0.615570068359375, 0.16832733154296875, 0.05021476745605469, -0.13251686096191406, 0.2551088333129883, 0.0642247200012207, 3.2547645568847656, 0.05878162384033203, 0.13808250427246094, -0.9356651306152344, -0.27433013916015625, 0.1947021484375, 0.004746437072753906, 4.519622802734375, 1.4600486755371094, -0.06166267395019531, -0.4323902130126953, 0.5902061462402344, -1.336604118347168, 0.26481056213378906, -1.0971097946166992, -6.616662979125977, -0.26368236541748047, -1.6472587585449219, 0.11220169067382812, -0.0176239013671875, 0.16666603088378906, 0.26184654235839844, 0.34881019592285156, 0.18651962280273438, 0.23238086700439453, -0.03426933288574219, 0.19516372680664062, -0.03970813751220703, -0.19551467895507812, -4.978343963623047, 4.162409782409668, 0.043628692626953125, 0.4235563278198242, 12.603439331054688, 1.938974380493164, -0.41573333740234375, -5.941436767578125, 0.4409494400024414, -0.10480308532714844, -11.697159767150879, -0.4419593811035156, -0.0009650588035583496, -1.2387275695800781, -0.08882522583007812, 0.7192296981811523, -0.8686618804931641, -0.23358631134033203, 0.14114761352539062, -0.17415523529052734, 0.6670417785644531, 0.045757293701171875, 0.0623779296875, -6.983479976654053, -0.47441864013671875, 0.6712226867675781, 0.12005805969238281, -0.1943817138671875, -0.15051937103271484, -0.2160320281982422, -0.08673381805419922, -0.17148971557617188, -0.1080770492553711, 0.3388805389404297, 1.231801986694336, -0.21889781951904297, -0.3614482879638672, 0.2808218002319336, -0.143157958984375, -2.653564453125, -0.1580028533935547, 0.23903656005859375, -0.0067653656005859375, -0.9184665679931641, 0.27276611328125, 0.16660594940185547, -0.13672828674316406, -0.557682991027832, -0.2514371871948242, -0.169830322265625, 0.8134899139404297, 0.22243213653564453, 0.12264442443847656, 0.10658788681030273, -0.11518573760986328, -0.6653900146484375, -7.092683792114258, -0.0164794921875, 0.12293148040771484, -0.8625774383544922, -0.5864715576171875, -1.1912860870361328, 0.4092445373535156, 0.5887813568115234, 9.814355850219727, -0.12501239776611328, -0.8002462387084961, -0.20628738403320312, -0.4126739501953125, 0.4313640594482422, -0.29660987854003906, 0.05267906188964844, 0.029998779296875, -7.201403617858887, 9.386734962463379, -0.7494487762451172, 1.0642108917236328, -0.4058828353881836, -11.04896354675293, 0.11092948913574219, 0.20795059204101562, -0.45517873764038086, 0.455596923828125, 0.3013162612915039, 0.02908802032470703, 0.38868045806884766, 1.6456193923950195, -0.02127838134765625, 0.022609710693359375, -1.8685779571533203, 0.6156711578369141, 0.21374130249023438, 0.3120388984680176, -0.6775110960006714, -0.1061553955078125, 0.9098081588745117, 0.2671937942504883, -0.1364917755126953, 1.3587455749511719, 0.0954899787902832, 0.40143680572509766, 0.2878303527832031, 1.3921241760253906, -0.39957618713378906, 0.32303619384765625, 0.5537128448486328, 1.3921241760253906, -0.03778505325317383, 0.8194012641906738, -0.06661415100097656, 1.0195026397705078, 0.527923583984375, -0.6321687698364258, -4.641348838806152, -0.3769054412841797, -0.6086158752441406, 0.18154048919677734, -0.5638446807861328, 0.08249950408935547, -0.3397331237792969, 0.11138916015625, 0.06233787536621094, 0.05870819091796875, -0.20301246643066406, 0.4102783203125, -1.1263742446899414, -0.21445655822753906, -0.3485240936279297, 0.12388801574707031, 0.27071189880371094, 0.2257709503173828, 0.13341426849365234, -0.1692190170288086, -0.28028106689453125, -0.10286712646484375, -0.46708011627197266, 0.050891876220703125, -0.9916858673095703, 11.187570571899414, 10.711109161376953, 0.8641209602355957, -0.1480560302734375, 0.7291812896728516, 0.1907978057861328, 0.01706218719482422, -0.4736919403076172, -0.523167610168457, 0.009641647338867188, -0.05415153503417969, 0.06360816955566406, -0.052280426025390625, -0.717803955078125, -0.5864715576171875, 0.09255504608154297, -0.47872066497802734, 0.5191822052001953, 0.0008821487426757812, -0.2586078643798828, 0.26662111282348633, -0.3428621292114258, 0.1296710968017578, 0.9814958572387695, 0.18354129791259766, 0.07128715515136719, 0.1054849624633789, -0.7909107208251953, 0.1479334831237793, -1.196476936340332, 0.12520790100097656, 0.47347450256347656, 0.11470222473144531, 0.7204990386962891], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 88064, "num_env_steps_trained": 408300, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 408300, "last_target_update_ts": 88064, "num_target_updates": 171}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -20.79464028865099, "episode_len_mean": 228.06, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981], "episode_lengths": [204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5662399615709546, "mean_inference_ms": 24.464253164303027, "mean_action_processing_ms": 0.13387624575440873, "mean_env_wait_ms": 4.52486843364462, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -20.79464028865099, "episode_len_mean": 228.06, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.05285869538784, 13.210635408759117, 4.648509480059147, 5.800000160932541, 24.438949078321457, -133.4776364415884, 16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981], "episode_lengths": [204, 202, 216, 189, 235, 269, 217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5662399615709546, "mean_inference_ms": 24.464253164303027, "mean_action_processing_ms": 0.13387624575440873, "mean_env_wait_ms": 4.52486843364462, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 408300, "num_env_steps_sampled": 88064, "num_env_steps_trained": 408300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 88064, "agent_timesteps_total": 88064, "timers": {"training_iteration_time_ms": 359.304, "learn_time_ms": 73.14, "learn_throughput": 4101.719, "synch_weights_time_ms": 20.883}, "counters": {"num_env_steps_sampled": 88064, "num_env_steps_trained": 408300, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 408300, "last_target_update_ts": 88064, "num_target_updates": 171}, "done": false, "episodes_total": 344, "training_iteration": 86, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-32-26", "timestamp": 1655494346, "time_this_iter_s": 5.6225056648254395, "time_total_s": 468.71478748321533, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 468.71478748321533, "timesteps_since_restore": 0, "iterations_since_restore": 86, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.712500000000002, "ram_util_percent": 64.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 15.419042587280273, "min_q": -1.944092869758606, "max_q": 36.45409393310547, "mean_td_error": -0.2099093645811081}, "td_error": [0.07768630981445312, 0.2674283981323242, -0.1756305694580078, 0.1175088882446289, 9.81285285949707, -0.03447532653808594, -0.31384849548339844, -0.346832275390625, 0.26111507415771484, -4.75579833984375, 1.3104705810546875, -0.23738670349121094, -0.0047588348388671875, -0.025697708129882812, 0.2133193016052246, -8.050908088684082, 1.626871109008789, 0.3051304817199707, -0.3712329864501953, -0.6096382141113281, -0.19863510131835938, 0.13812828063964844, -0.3433723449707031, 0.03962993621826172, -0.0032367706298828125, -0.05721282958984375, -1.331130027770996, -0.4437551498413086, -0.5438013076782227, 1.7760953903198242, -0.19250106811523438, -0.37302398681640625, -0.10581779479980469, -0.22456645965576172, 0.08412313461303711, -0.1662006378173828, -0.21732044219970703, 0.38884544372558594, 0.08633041381835938, 11.845980644226074, 0.2337493896484375, -4.928417205810547, 0.19850540161132812, -9.759688377380371, -0.5967426300048828, -0.07979649305343628, 4.409414291381836, 0.1637439727783203, -0.2965559959411621, 0.1786327362060547, -9.653980255126953, 0.0030689239501953125, 0.4652118682861328, 0.16958236694335938, -0.6379733085632324, 0.11167526245117188, 10.68030834197998, 3.4766311645507812, -0.2335205078125, -0.028787612915039062, -0.4461212158203125, -0.3609037399291992, -0.20116043090820312, -0.45244789123535156, -0.4397735595703125, 1.2209835052490234, -0.05677986145019531, -0.08352088928222656, -0.14945411682128906, -0.7692089080810547, 0.03225135803222656, -0.476837158203125, 10.787591934204102, -9.4124755859375, 0.3804206848144531, -0.24973678588867188, -0.32846832275390625, 0.2526741027832031, -0.05058097839355469, -0.017034530639648438, -0.12575817108154297, -0.33274173736572266, 0.13530445098876953, 0.5960397720336914, -0.08580207824707031, -12.519758224487305, -0.013641357421875, -0.33685898780822754, -0.9505438804626465, 1.6349067687988281, 0.07506728172302246, -0.024095535278320312, 0.5020046234130859, -0.36055946350097656, 0.2659645080566406, 0.085540771484375, -0.09732627868652344, 0.07506728172302246, 0.5672950744628906, -2.645479202270508, 0.0010528564453125, 0.9702339172363281, -0.046219825744628906, -0.9024868011474609, -0.588134765625, -6.273748397827148, -0.0435333251953125, 1.3319807052612305, -0.33115577697753906, -0.44414329528808594, -0.3892636299133301, -0.35822105407714844, 0.29356956481933594, 0.23693740367889404, -0.07084846496582031, 0.4963874816894531, -0.5519199371337891, -0.3442726135253906, -0.34061717987060547, 0.06917285919189453, 0.23436355590820312, 0.4406242370605469, 0.5714578628540039, -0.060211181640625, 0.4656047821044922, -0.3041267395019531, -0.1423640251159668, 0.004595756530761719, -0.1308917999267578, -0.13817501068115234, -3.2559547424316406, -0.14400005340576172, 0.38098716735839844, -0.7690544128417969, -0.17647171020507812, -0.5151634216308594, 0.15571022033691406, -0.1399860382080078, -1.5671052932739258, 0.08308029174804688, -6.6722636222839355, -0.0822000503540039, -0.4392242431640625, -0.3286781311035156, -0.22037029266357422, -0.30390357971191406, -0.30179595947265625, 0.27664661407470703, 0.22553443908691406, -0.10207748413085938, -0.5047931671142578, -0.301285982131958, -0.6412544250488281, -0.02764415740966797, 4.248054504394531, -0.3253955841064453, -1.0821056365966797, -0.38856983184814453, -0.5377635955810547, -1.0631904602050781, -0.8789691925048828, -0.7629451751708984, 0.6413536071777344, -0.08027267456054688, 5.83527946472168, -0.9683551788330078, 3.379847764968872, -0.06620311737060547, -0.17600440979003906, -0.25503063201904297, 0.18156051635742188, -0.14471435546875, -0.3241147994995117, -0.30008983612060547, -5.74017333984375, -1.9203238487243652, 0.19609642028808594, -0.11531448364257812, 0.4333457946777344, 0.7805967330932617, -6.460613250732422, -0.16026878356933594, 0.5741748809814453, 0.22672080993652344, -0.7281742095947266, -0.19189786911010742, -1.4784965515136719, 0.059741854667663574, -0.29832005500793457, -0.7491888999938965, -0.040287017822265625, 0.8148536682128906, 0.8373527526855469, -0.4290199279785156, -0.20987892150878906, 0.022451579570770264, -4.850042343139648, 0.07076454162597656, -0.02320098876953125, 0.8449287414550781, -0.128173828125, 0.09921646118164062, -0.3177042007446289, 0.7378005981445312, 0.07308292388916016, -0.1518726348876953, -0.12790489196777344, 1.275136947631836, 0.06792402267456055, -5.1515655517578125, 0.008645057678222656, 0.2638673782348633, 0.15125083923339844, 1.0513248443603516, 0.3754129409790039, -0.022403717041015625, -0.12680912017822266, 0.2368907928466797, 0.1580801010131836, -0.3847675323486328, -0.45327186584472656, -0.1603832244873047, -0.4528350830078125, -0.03363227844238281, -0.30917835235595703, 0.6255130767822266, -0.49526405334472656, -0.17255020141601562, -0.1488780975341797, -0.023743629455566406, -0.5012445449829102, 0.07506728172302246, -1.4992132186889648, -1.0619854927062988, 0.18863868713378906, -0.7209949493408203, 1.2699356079101562, -0.3286781311035156, -0.1353912353515625, -0.4386882781982422, -0.1577472686767578, -0.4700736999511719, -0.051815032958984375, -0.7153778076171875, 0.5591540336608887, -2.39471435546875, 0.39922428131103516, 0.020280838012695312, 0.11417198181152344, -0.20987892150878906, -0.43365001678466797, -0.47765541076660156, 0.43858909606933594, 0.16580772399902344, -1.6797819137573242, -0.15143966674804688, -0.3021125793457031, -0.7299022674560547, -1.3431129455566406, -0.9206075668334961, 0.07747650146484375, -0.12012100219726562, -1.1789093017578125, 0.179595947265625, 1.5578861236572266, 0.0013670921325683594, -0.3573799133300781, -0.16977310180664062, -0.32721900939941406, 0.0756673812866211, 0.12101364135742188, -0.15228652954101562, -0.4966392517089844, -0.20436334609985352, 0.6413536071777344, -0.17222881317138672, 0.19857549667358398, -0.2390880584716797, -0.09167098999023438, 0.3205862045288086, 0.48044586181640625, 0.48358792066574097, -0.27837562561035156, -0.09099292755126953, -0.4930839538574219, 0.6970882415771484, 0.6159439086914062, 0.5223369598388672, -4.350425720214844, 0.3031730651855469, -0.7370309829711914, 0.9209175109863281, -0.37067127227783203, -0.4610280990600586, 0.0923776626586914, 0.1267852783203125, -0.4367408752441406, -0.3572044372558594, -0.3155536651611328, 0.6353759765625], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 89088, "num_env_steps_trained": 413100, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 413100, "last_target_update_ts": 89088, "num_target_updates": 173}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -19.2627708119154, "episode_len_mean": 228.04, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125], "episode_lengths": [217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5667318079883327, "mean_inference_ms": 24.464510350770432, "mean_action_processing_ms": 0.1338000435170416, "mean_env_wait_ms": 4.525252676822665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -19.2627708119154, "episode_len_mean": 228.04, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.91322023421526, 26.265688367187977, -14.589364498853683, 4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125], "episode_lengths": [217, 220, 239, 222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5667318079883327, "mean_inference_ms": 24.464510350770432, "mean_action_processing_ms": 0.1338000435170416, "mean_env_wait_ms": 4.525252676822665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 413100, "num_env_steps_sampled": 89088, "num_env_steps_trained": 413100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 89088, "agent_timesteps_total": 89088, "timers": {"training_iteration_time_ms": 342.057, "learn_time_ms": 71.892, "learn_throughput": 4172.912, "synch_weights_time_ms": 20.388}, "counters": {"num_env_steps_sampled": 89088, "num_env_steps_trained": 413100, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 413100, "last_target_update_ts": 89088, "num_target_updates": 173}, "done": false, "episodes_total": 350, "training_iteration": 87, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-32-32", "timestamp": 1655494352, "time_this_iter_s": 5.55976414680481, "time_total_s": 474.27455163002014, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 474.27455163002014, "timesteps_since_restore": 0, "iterations_since_restore": 87, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 34.425, "ram_util_percent": 64.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.70165729522705, "min_q": -0.5735442042350769, "max_q": 32.32585525512695, "mean_td_error": -0.27475765347480774}, "td_error": [-0.3911933898925781, 0.4035015106201172, -0.32436561584472656, 0.7982673645019531, -0.3882427215576172, -0.38731956481933594, -0.0730743408203125, -2.2541465759277344, 0.08417701721191406, 6.916109561920166, -0.4255962371826172, 0.6286725997924805, -0.37151432037353516, -0.11075782775878906, -0.3646354675292969, -1.4290456771850586, -0.4394073486328125, -0.06233501434326172, 0.15815305709838867, -0.49280738830566406, -0.25144386291503906, -0.2518196105957031, -0.12086641788482666, -0.42513465881347656, -0.02090930938720703, 0.34572505950927734, -0.02592182159423828, -0.2395763397216797, -0.14104843139648438, 0.022064208984375, 0.08753681182861328, 0.33855104446411133, 0.9569053649902344, -0.4314594268798828, -0.2592124938964844, -0.15084075927734375, 0.8639392852783203, 0.11717700958251953, 0.11852073669433594, -0.03028583526611328, -0.28163719177246094, -4.71748161315918, -0.874143123626709, 0.011888504028320312, 0.14528846740722656, -0.2344226837158203, -0.3726634979248047, 10.748170852661133, 0.11704635620117188, -0.5492820739746094, -0.24664878845214844, -0.39952850341796875, 4.252816200256348, -0.8897781372070312, -0.7980995178222656, 1.1399688720703125, -0.9597949981689453, -0.4294605255126953, -0.5608959197998047, 0.09549713134765625, -0.04305076599121094, -5.680286407470703, 0.2968635559082031, -1.4295330047607422, 0.6939754486083984, -0.07938194274902344, -0.22684860229492188, -0.060352325439453125, 0.1684560775756836, 0.2560920715332031, -0.5720386505126953, -0.12086641788482666, -0.15919876098632812, -8.421297073364258, -2.624267578125, -0.16446590423583984, 0.12826108932495117, -0.9526119232177734, 0.07946491241455078, 0.11498260498046875, -0.2824211120605469, -6.567746162414551, 1.3601837158203125, 0.6235637664794922, -0.056514739990234375, 0.23752403259277344, -0.093170166015625, -0.02303028106689453, -0.568756103515625, -0.245513916015625, -0.6808624267578125, -0.1484236717224121, 0.09557628631591797, -0.19878387451171875, -0.2786579132080078, -0.5784740447998047, 0.12090039253234863, 6.367729187011719, -0.2890663146972656, -0.27324390411376953, -0.25252342224121094, -0.4463024139404297, -0.08247184753417969, -0.46959686279296875, -0.04302978515625, 0.28704357147216797, -0.056514739990234375, 5.042328834533691, -0.05072593688964844, -0.0380396842956543, -0.7306032180786133, -0.051136016845703125, -0.18105316162109375, -0.2160816192626953, -0.632227897644043, -0.06266593933105469, -6.717256546020508, -7.028826713562012, -1.803767204284668, -0.43396854400634766, -9.028764724731445, -0.1341533660888672, -0.09834098815917969, -0.1176910400390625, -0.29416847229003906, -0.2024521827697754, -1.2047669887542725, -0.06795120239257812, 0.33531761169433594, 0.6286182403564453, -0.5472640991210938, -0.6288399696350098, 0.016307830810546875, -0.10330581665039062, 0.17745590209960938, -0.3395519256591797, 0.12484359741210938, -10.567700386047363, 2.4928011894226074, 0.06017303466796875, -0.4455099105834961, 6.756115913391113, -0.4766113758087158, -0.2752552032470703, -1.0924386978149414, -0.22172164916992188, -0.2555103302001953, -0.17834091186523438, 0.0543975830078125, 3.9613757133483887, -0.2724647521972656, 0.05994224548339844, -0.0034160614013671875, 0.2824554443359375, -6.058514595031738, -0.6517820358276367, -0.6880893707275391, 0.09113883972167969, 1.4090924263000488, 3.588010787963867, -0.5851402282714844, -0.09027576446533203, -0.3283243179321289, -0.6930582523345947, 0.023281097412109375, 0.253753662109375, -0.3507728576660156, 8.240422248840332, -0.1752758026123047, -0.4642457962036133, 0.6286725997924805, -0.13399219512939453, -0.174041748046875, -0.1370067596435547, -0.3613910675048828, -0.19416427612304688, -0.5002269744873047, -0.43044281005859375, 1.1143136024475098, -0.6112918853759766, -0.8682408332824707, -0.1666717529296875, -0.3086051940917969, 0.06887054443359375, 0.06494808197021484, 0.029600143432617188, -0.21509742736816406, -0.018707275390625, 0.0920257568359375, 0.0740060806274414, -7.197666168212891, -0.061359405517578125, 0.717799186706543, -0.06723403930664062, -0.6035060882568359, 0.7075576782226562, -0.07973098754882812, -0.12054824829101562, -0.37001800537109375, -0.1073462963104248, -0.5215902328491211, 0.04326915740966797, -0.4314594268798828, -0.0602874755859375, 1.2321090698242188, -0.16860580444335938, -0.012208938598632812, -0.5411033630371094, -2.574355125427246, -0.24756669998168945, 4.876259803771973, -0.10629463195800781, -0.6507148742675781, 0.22969627380371094, -0.5222511291503906, -0.08432579040527344, -6.364492416381836, -0.36038780212402344, -1.002176284790039, -0.0014629364013671875, -0.04132270812988281, 0.20717334747314453, 0.6444854736328125, -1.7830066680908203, -0.2650279998779297, 4.876259803771973, 0.08135223388671875, -0.13599872589111328, -0.2676076889038086, -0.7102775573730469, 1.1866073608398438, -5.093070983886719, 1.6738958358764648, -0.4769630432128906, -0.06102561950683594, -1.2638945579528809, -0.1281890869140625, -2.1583995819091797, -0.1485309600830078, -0.2667503356933594, -0.08539295196533203, 0.1510772705078125, -0.5162162780761719, -0.21846485137939453, -1.1294689178466797, -0.39423561096191406, 0.1993389129638672, -0.26636695861816406, 0.18109607696533203, -0.06966590881347656, 0.044891357421875, -0.4784660339355469, 2.497682571411133, -0.45979785919189453, 0.2816314697265625, -0.3718900680541992, -0.0736837387084961, -0.34195613861083984, -0.32294464111328125, -0.7181267738342285, 2.1528778076171875, 0.5717353820800781, -0.7870426177978516, 0.6989989280700684, -0.6046619415283203, -7.475332736968994, -0.6046724319458008, 3.2637243270874023, -11.131982803344727, -0.09880256652832031, -0.08164215087890625, -0.6696681976318359, 2.6028289794921875, 0.06402969360351562, 0.18372344970703125, -4.810972213745117, -0.8059420585632324, 0.45346879959106445, -6.442106246948242, -0.20897483825683594, 0.12495136260986328, -0.9867246150970459, -0.029247283935546875, -0.9565839767456055, 0.8761472702026367, -0.5275096893310547, -0.1687488555908203, 0.21574020385742188, -0.19275450706481934, -0.05696296691894531, 1.4985942840576172, -0.3309345245361328, 0.17606449127197266, -0.16657257080078125, -0.07143211364746094, -0.26499366760253906, -0.24445056915283203, -0.1568927764892578, -0.4820423126220703, 0.9218935966491699], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 90112, "num_env_steps_trained": 417900, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 417900, "last_target_update_ts": 90112, "num_target_updates": 175}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -21.413798790872097, "episode_len_mean": 228.49, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789], "episode_lengths": [222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5682216864381214, "mean_inference_ms": 24.468790432155743, "mean_action_processing_ms": 0.13376556149864358, "mean_env_wait_ms": 4.531525349578247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -21.413798790872097, "episode_len_mean": 228.49, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.600000210106373, 23.07254123687744, 3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789], "episode_lengths": [222, 229, 200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5682216864381214, "mean_inference_ms": 24.468790432155743, "mean_action_processing_ms": 0.13376556149864358, "mean_env_wait_ms": 4.531525349578247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 417900, "num_env_steps_sampled": 90112, "num_env_steps_trained": 417900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 90112, "agent_timesteps_total": 90112, "timers": {"training_iteration_time_ms": 346.157, "learn_time_ms": 72.689, "learn_throughput": 4127.182, "synch_weights_time_ms": 20.489}, "counters": {"num_env_steps_sampled": 90112, "num_env_steps_trained": 417900, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 417900, "last_target_update_ts": 90112, "num_target_updates": 175}, "done": false, "episodes_total": 353, "training_iteration": 88, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-32-38", "timestamp": 1655494358, "time_this_iter_s": 5.483605146408081, "time_total_s": 479.7581567764282, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 479.7581567764282, "timesteps_since_restore": 0, "iterations_since_restore": 88, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.474999999999994, "ram_util_percent": 64.1125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 15.557815551757812, "min_q": -0.6938505172729492, "max_q": 34.654685974121094, "mean_td_error": 0.10232578217983246}, "td_error": [-0.47981929779052734, -0.18935108184814453, 0.42897891998291016, -0.5258026123046875, 0.0171661376953125, -0.03936767578125, -0.0006771087646484375, 0.1487894058227539, -0.26224422454833984, -0.5358295440673828, 0.0997161865234375, -11.422819137573242, 0.11956453323364258, -0.23303794860839844, -0.7837734222412109, 1.3806562423706055, 0.3718376159667969, -0.0027675628662109375, -0.1752796173095703, 0.6604480743408203, 0.5406770706176758, 0.08646965026855469, 0.27309131622314453, 0.6464176177978516, 0.30721569061279297, 0.44005149602890015, 0.6581764221191406, -0.0647735595703125, -0.0594482421875, 1.9096603393554688, 0.30767822265625, 0.8016338348388672, 0.2256011962890625, 0.06944942474365234, 0.07971763610839844, -1.0112972259521484, 0.7272520065307617, -0.23596954345703125, 0.3891010284423828, 0.39969635009765625, 0.7451658248901367, 0.3818359375, 0.5445289611816406, 1.9355192184448242, 0.5537948608398438, 0.09145545959472656, 0.014675557613372803, -0.0134124755859375, -0.15366268157958984, -0.16451454162597656, 1.0843772888183594, -0.037639617919921875, 0.25273895263671875, 0.2526054382324219, 0.41168975830078125, -0.772369384765625, -0.09103107452392578, -0.0015153884887695312, 0.4499549865722656, -0.15742111206054688, 0.07344627380371094, 1.050130844116211, 0.3813819885253906, 0.160797119140625, 0.10593605041503906, -0.011636734008789062, 1.0908527374267578, -0.00038909912109375, -9.329435348510742, 0.30767822265625, 1.414750576019287, 0.9283065795898438, 0.13203144073486328, -3.9083175659179688, 0.039646148681640625, -0.1912212371826172, 0.20567703247070312, -0.5358867645263672, -0.10304450988769531, 2.6680526733398438, 0.141265869140625, 0.1814403533935547, 1.5352873802185059, -0.22109031677246094, -0.3028736114501953, -0.05998992919921875, 1.0825233459472656, -0.2931346893310547, 0.165252685546875, 1.2866320610046387, 1.2600479125976562, -0.10631370544433594, 0.9323444366455078, 0.22344017028808594, -0.21634292602539062, 0.1059417724609375, 0.3383502960205078, 0.5082311630249023, 0.05623340606689453, 1.1827392578125, 0.3059196472167969, -11.759587287902832, -0.14868736267089844, 0.14232635498046875, 6.11552619934082, 0.5518779754638672, 0.011736869812011719, -0.21728157997131348, 7.246465682983398, 0.7772388458251953, -0.09983253479003906, 0.5722694396972656, -0.13282203674316406, 0.5103168487548828, 0.19667816162109375, -0.175506591796875, 0.4911651611328125, 0.32749366760253906, 0.6051774024963379, -0.5019865036010742, 0.024793624877929688, 0.5098838806152344, 0.47476959228515625, 0.632354736328125, -0.10826301574707031, 0.39904117584228516, 0.4468879699707031, 0.13245773315429688, 4.392106056213379, 0.1716928482055664, 0.25901031494140625, 0.13606643676757812, -6.111871719360352, -0.3138303756713867, 0.3675041198730469, 0.4709024429321289, -0.23596954345703125, 0.6691055297851562, 0.4435138702392578, 0.3370485305786133, -1.0603723526000977, 3.5774850845336914, 0.4923229217529297, 0.01309967041015625, -0.5023536682128906, -0.6476106643676758, 0.1601696014404297, 0.06505584716796875, 0.12822914123535156, -0.08664894104003906, -0.08046340942382812, -0.05267143249511719, -0.06902122497558594, 0.7521734237670898, -1.2421245574951172, -0.2982807159423828, 0.3874189853668213, 1.0451369285583496, -8.700963973999023, 0.030889511108398438, 0.15408039093017578, 0.4805612564086914, 0.6326980590820312, -4.222686767578125, 0.8566007614135742, 0.03360557556152344, -0.0248870849609375, 0.12053489685058594, 0.627133846282959, -0.13947105407714844, -0.1704120635986328, 11.362408638000488, -0.22788429260253906, 1.9529132843017578, 0.06066131591796875, 0.4795851707458496, 0.03252696990966797, 0.051853179931640625, -1.931600570678711, 1.0294475555419922, -8.700963973999023, 0.6602096557617188, -6.1260986328125, 9.57248592376709, 0.965693473815918, -6.638022422790527, -0.28737449645996094, 0.14460182189941406, -0.22401809692382812, 7.768317699432373, 0.08836936950683594, -4.950540542602539, 0.16185283660888672, 0.15345382690429688, 0.5980596542358398, -0.3988269865512848, 0.053203582763671875, 1.3010501861572266, 0.1255626678466797, 0.14158058166503906, -0.17245006561279297, -0.3399167060852051, 1.855203628540039, 0.9091739654541016, -0.04806327819824219, -0.00600433349609375, 0.9835567474365234, 1.6760320663452148, 0.8077096939086914, 2.520099639892578, -0.37308216094970703, -1.467635154724121, 0.13976287841796875, 0.21813392639160156, -0.14970970153808594, 0.172119140625, 0.04324531555175781, -0.09451484680175781, 0.0637350082397461, 0.057842254638671875, -0.08052635192871094, -6.252716064453125, 1.337254524230957, -0.04338264465332031, 0.37584781646728516, -0.0933380126953125, -0.10473251342773438, 0.19268035888671875, 1.5352873802185059, 8.355490684509277, 0.7205362319946289, 0.9921073913574219, -0.03512096405029297, -0.15351486206054688, 0.2388019561767578, 4.164371967315674, -10.507455825805664, -0.0020351409912109375, -0.04357337951660156, 0.08549213409423828, 0.5227384567260742, 0.19598770141601562, 0.41652870178222656, 12.549200057983398, 0.2718772888183594, 0.7511863708496094, 0.05845832824707031, -0.041724205017089844, -0.2891120910644531, 1.4327373504638672, -4.718730926513672, -0.01860332489013672, 0.21990013122558594, -0.8466854095458984, -6.722393035888672, 0.06580352783203125, -0.12815475463867188, -0.14038658142089844, 0.1254291534423828, -0.5298008918762207, 0.14555931091308594, 1.0478429794311523, 0.36180591583251953, -0.004719734191894531, 3.2283549308776855, -0.13145065307617188, 0.17719745635986328, 0.20941162109375, 0.06898880004882812, 0.22011756896972656, -0.3138303756713867, -0.10573577880859375, -2.2266759872436523, -5.15764045715332, 0.14044761657714844, 0.037662506103515625, -0.014252662658691406, 0.24230194091796875, 0.14555931091308594, -0.1342487335205078, 0.7967872619628906, 0.0075168609619140625, 0.32210731506347656, 5.089027404785156, 0.9039318561553955, 0.038300275802612305, 0.47376346588134766, 0.8719444274902344, 4.453207015991211, 0.09237289428710938, -5.15764045715332, 0.1583852767944336, 0.24324703216552734, 1.8968696594238281, 0.4636802673339844, 0.42550086975097656, 0.12952136993408203, 0.6045742034912109, 0.5995626449584961, -0.36832427978515625], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 91136, "num_env_steps_trained": 422700, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 422700, "last_target_update_ts": 91136, "num_target_updates": 177}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -21.53452420733869, "episode_len_mean": 228.42, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653], "episode_lengths": [200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.568283543656231, "mean_inference_ms": 24.474533108117395, "mean_action_processing_ms": 0.1338040256713466, "mean_env_wait_ms": 4.533576445525251, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -21.53452420733869, "episode_len_mean": 228.42, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.9000001549720764, -140.45617546141148, 5.799999922513962, 29.199086420238018, -47.941486120224, 11.481867268681526, 12.610635548830032, 23.556627541780472, 2.400000087916851, 33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653], "episode_lengths": [200, 300, 230, 218, 231, 238, 235, 222, 199, 199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.568283543656231, "mean_inference_ms": 24.474533108117395, "mean_action_processing_ms": 0.1338040256713466, "mean_env_wait_ms": 4.533576445525251, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 422700, "num_env_steps_sampled": 91136, "num_env_steps_trained": 422700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 91136, "agent_timesteps_total": 91136, "timers": {"training_iteration_time_ms": 347.549, "learn_time_ms": 74.8, "learn_throughput": 4010.679, "synch_weights_time_ms": 21.689}, "counters": {"num_env_steps_sampled": 91136, "num_env_steps_trained": 422700, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 422700, "last_target_update_ts": 91136, "num_target_updates": 177}, "done": false, "episodes_total": 355, "training_iteration": 89, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-32-43", "timestamp": 1655494363, "time_this_iter_s": 5.5068278312683105, "time_total_s": 485.26498460769653, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 485.26498460769653, "timesteps_since_restore": 0, "iterations_since_restore": 89, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 33.087500000000006, "ram_util_percent": 64.08749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.627503395080566, "min_q": 0.7403848171234131, "max_q": 34.583805084228516, "mean_td_error": -0.02340930886566639}, "td_error": [-0.3279075622558594, -0.10858726501464844, -0.5093574523925781, 0.27266693115234375, 1.2091541290283203, 0.35668373107910156, 0.09559345245361328, 0.2108173370361328, 0.030168533325195312, 0.02779388427734375, -0.8696680068969727, 0.23981761932373047, -1.4861888885498047, 0.7951011657714844, 0.005084991455078125, 0.2196502685546875, 0.33426856994628906, 0.29743289947509766, -0.2680778503417969, 11.514130592346191, -0.5569114685058594, -0.2807273864746094, 0.09057426452636719, 0.22757625579833984, -0.5448527336120605, 0.6414952278137207, 0.3480544090270996, 0.31664466857910156, -0.3096046447753906, 0.8375749588012695, 0.11631107330322266, -0.11903953552246094, -0.6070995330810547, -0.1533193588256836, -0.2746601104736328, 0.21711444854736328, -0.4792766571044922, 0.12973785400390625, -0.039783477783203125, 0.200225830078125, -0.9386081695556641, 0.17004013061523438, -0.2896251678466797, 0.3341493606567383, -1.583669662475586, 0.1145467758178711, -1.3902995586395264, -0.9814186096191406, -0.12101554870605469, -0.2733125686645508, -0.06669235229492188, -0.5065517425537109, -4.711967468261719, -0.4188404083251953, 0.15779495239257812, 0.7925376892089844, -0.5968160629272461, 0.043282508850097656, 2.7867727279663086, -0.05122852325439453, 2.265941619873047, -0.1040201187133789, 0.02904224395751953, -0.1634807586669922, -0.23276901245117188, 0.2715892791748047, -0.1411724090576172, -0.10190010070800781, -0.32657337188720703, 2.258965492248535, 0.5416450500488281, 0.2064075469970703, -1.1152057647705078, -0.4421100616455078, 0.4091529846191406, -1.0598649978637695, -0.9396038055419922, -0.5751447677612305, -1.571761131286621, -0.5351333618164062, 0.2610759735107422, 1.3807296752929688, 2.2716293334960938, -0.7514419555664062, 0.09907722473144531, 0.7607307434082031, -0.014657974243164062, -0.8745975494384766, -1.059967041015625, 0.48853111267089844, 0.4280128479003906, -0.5766143798828125, 0.42519330978393555, -0.3532218933105469, -0.08757781982421875, 8.371291160583496, 0.029142379760742188, 0.6414952278137207, 0.17936420440673828, -0.35187339782714844, 0.02904224395751953, 0.1407337188720703, -0.6101951599121094, 0.11473369598388672, 0.21202850341796875, 2.220064163208008, -0.0770559310913086, 0.09324455261230469, -1.5598602294921875, 0.03352928161621094, -0.07858848571777344, -0.3565330505371094, 0.5538578033447266, -1.6514081954956055, 0.05666828155517578, -0.22129440307617188, -0.15547680854797363, 0.07761287689208984, -0.657623291015625, 3.0055885314941406, -0.03354454040527344, 0.42836761474609375, -0.6202983856201172, -0.0409846305847168, -0.03212928771972656, -0.03630256652832031, -0.04773521423339844, 0.40029239654541016, -1.1033830642700195, -0.7052135467529297, -0.5471329689025879, 0.21413707733154297, 0.4629020690917969, 0.011133193969726562, 0.0043964385986328125, -0.20467185974121094, 0.45849609375, 0.007293701171875, 0.24264049530029297, -0.380340576171875, 0.20578956604003906, -7.305389404296875, -0.10779190063476562, -0.3871183395385742, -0.6813173294067383, 0.5404558181762695, 0.024120330810546875, -0.37430572509765625, 0.1951436996459961, 0.23358678817749023, -0.8719654083251953, 1.7691535949707031, 0.19898605346679688, -0.5742568969726562, -0.13933467864990234, 0.24809837341308594, 0.05977058410644531, -0.07292556762695312, 0.09176445007324219, -0.06108665466308594, -0.17146778106689453, -0.0865640640258789, -1.1210098266601562, -0.04534912109375, 0.2028350830078125, -0.2858848571777344, -0.2079029083251953, 0.018011093139648438, -0.12944793701171875, -0.17335891723632812, 0.9008998870849609, 0.6372661590576172, 0.15417003631591797, 0.8683300018310547, 0.12154388427734375, -0.18516719341278076, -0.1495380401611328, 0.07753181457519531, 0.6312723159790039, -0.038364410400390625, -0.059543609619140625, -8.170642852783203, 0.4977283477783203, -0.2511177062988281, -0.19760799407958984, -0.12427568435668945, 0.34265804290771484, 0.07345294952392578, -0.20510196685791016, -5.823450088500977, -0.05573749542236328, 0.5957660675048828, 0.273193359375, 12.652368545532227, -1.08135986328125, -0.025529861450195312, -0.6242456436157227, 0.24516677856445312, -0.0068817138671875, -0.07624244689941406, 0.0071086883544921875, -0.26131296157836914, -0.5315265655517578, -0.08909797668457031, 0.19126510620117188, 0.9536094665527344, 0.02068042755126953, 0.3199348449707031, 0.3528404235839844, -3.6379337310791016, -0.2516345977783203, 4.974689483642578, -0.13445281982421875, -0.14421939849853516, 0.30892419815063477, -2.2832603454589844, 0.037055015563964844, 0.2189950942993164, -0.3565330505371094, -0.39093685150146484, 0.2970314025878906, 0.06104755401611328, 0.2120952606201172, 0.12789344787597656, -0.08218860626220703, -0.2299671173095703, -0.15201902389526367, 0.08185005187988281, -0.2870492935180664, -6.302738189697266, -0.09513568878173828, 0.012764930725097656, -0.1113739013671875, -0.42671871185302734, 0.21766376495361328, -0.25121593475341797, -0.5415306091308594, 0.0026340484619140625, -0.02693939208984375, 0.29596996307373047, -0.8045845031738281, 0.08239555358886719, -6.117815971374512, 0.17961692810058594, 2.428577423095703, -0.21497535705566406, -1.60223388671875, 9.66479778289795, 0.4644775390625, -0.32417917251586914, -0.1607208251953125, -0.9242982864379883, -0.1559162139892578, -0.4176769256591797, 0.14950084686279297, -0.03735542297363281, 0.18688011169433594, -0.10973453521728516, 0.3486595153808594, -0.08679962158203125, 0.22758865356445312, 20.128787994384766, 0.06191253662109375, -0.0210723876953125, 0.05899620056152344, 0.06410789489746094, -10.314291000366211, 0.0867156982421875, -0.46103858947753906, -0.2256770133972168, -0.4280827045440674, 0.9103717803955078, -0.4857330322265625, 0.3372793197631836, -0.09842109680175781, -0.3497180938720703, -0.18091297149658203, -1.8078007698059082, -0.45133018493652344, 0.024854660034179688, 0.02844715118408203, 0.3036766052246094, -6.73900032043457, -0.23511505126953125, -0.5424261093139648, -0.5661754608154297, -0.11730575561523438, 0.1341266632080078, -0.3512554168701172, 0.0015912055969238281, 0.20408010482788086, -8.400978088378906, -0.0005340576171875, -0.27151989936828613, 2.667757511138916, -0.4280827045440674, 0.08239555358886719, -0.2741661071777344, -0.001285552978515625, -0.09122562408447266], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 92160, "num_env_steps_trained": 427500, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 427500, "last_target_update_ts": 92160, "num_target_updates": 179}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -19.64715486638248, "episode_len_mean": 227.28, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786], "episode_lengths": [199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5689181793751369, "mean_inference_ms": 24.464192077367933, "mean_action_processing_ms": 0.13382223358828932, "mean_env_wait_ms": 4.536271777811092, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -19.64715486638248, "episode_len_mean": 227.28, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.934633642435074, -75.12060614675283, -21.506900176405907, 15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786], "episode_lengths": [199, 253, 236, 198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5689181793751369, "mean_inference_ms": 24.464192077367933, "mean_action_processing_ms": 0.13382223358828932, "mean_env_wait_ms": 4.536271777811092, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 427500, "num_env_steps_sampled": 92160, "num_env_steps_trained": 427500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 92160, "agent_timesteps_total": 92160, "timers": {"training_iteration_time_ms": 365.166, "learn_time_ms": 73.707, "learn_throughput": 4070.197, "synch_weights_time_ms": 21.088}, "counters": {"num_env_steps_sampled": 92160, "num_env_steps_trained": 427500, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 427500, "last_target_update_ts": 92160, "num_target_updates": 179}, "done": false, "episodes_total": 364, "training_iteration": 90, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-32-49", "timestamp": 1655494369, "time_this_iter_s": 5.75580620765686, "time_total_s": 491.0207908153534, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 491.0207908153534, "timesteps_since_restore": 0, "iterations_since_restore": 90, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.91111111111112, "ram_util_percent": 64.02222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 15.052213668823242, "min_q": 0.7135733366012573, "max_q": 35.61838912963867, "mean_td_error": 0.16807803511619568}, "td_error": [-0.05145835876464844, 2.9130160808563232, 0.4944438934326172, 0.20072174072265625, 0.9261941909790039, 0.2124338150024414, -0.5526561737060547, -0.41462135314941406, 1.0084095001220703, 1.3779823780059814, 0.0005464553833007812, 0.029651641845703125, 0.24383068084716797, -0.5860261917114258, -0.34658241271972656, -0.260223388671875, -0.3887672424316406, 0.24156856536865234, -0.04756641387939453, 0.32529163360595703, -0.07956123352050781, -0.4067697525024414, 0.12257671356201172, 0.25904083251953125, 0.35059356689453125, 0.8183116912841797, -1.3761882781982422, 1.3528165817260742, -1.1987569332122803, -6.200423240661621, 0.8757462501525879, 0.3207569122314453, 0.15145492553710938, 0.4571056365966797, -0.15305328369140625, 0.0038280487060546875, -0.8558521270751953, 0.18326377868652344, -0.1636066436767578, 0.17223167419433594, 0.5182514190673828, 0.2013397216796875, -1.1163311004638672, -1.1569786071777344, 0.7486648559570312, -0.16926956176757812, 0.5085468292236328, -0.17708969116210938, -5.0934247970581055, -1.4091463088989258, -0.028810501098632812, 1.59393310546875, 0.007351875305175781, 0.23069190979003906, -0.2075033187866211, 1.6070880889892578, -0.9728164672851562, -0.15994834899902344, 0.04480743408203125, 7.51105260848999, 4.164309501647949, 0.4739646911621094, -0.03420257568359375, -1.1721210479736328, 0.5841255187988281, 0.17814159393310547, 0.23069190979003906, 0.09370040893554688, -0.5147829055786133, -0.6989297866821289, -0.0033359527587890625, -0.8611488342285156, 0.11838150024414062, -0.20358848571777344, -0.016577720642089844, 0.41019153594970703, -0.5117673873901367, 0.21706008911132812, -0.46970558166503906, -0.7251567840576172, -0.09798431396484375, 0.5551910400390625, -0.06581306457519531, 0.43584632873535156, 0.7514476776123047, 0.4186420440673828, 0.5154609680175781, -0.5101175308227539, -0.09487724304199219, 0.012290000915527344, -0.0662841796875, 0.0753793716430664, 0.20490264892578125, 0.12503433227539062, 0.15297317504882812, -1.1910686492919922, 12.378604888916016, -0.17129039764404297, -0.4285825490951538, 0.26280784606933594, 0.3381948471069336, 0.2930469512939453, 5.303260803222656, -0.1149139404296875, -0.029478073120117188, -0.8519291877746582, 0.16926240921020508, 0.14087677001953125, 2.6826791763305664, 0.2789573669433594, -0.43988895416259766, -0.2645301818847656, 0.0072917938232421875, 0.9888725280761719, 0.4925107955932617, -1.0624408721923828, 0.15731239318847656, -0.4748725891113281, -6.237588882446289, 0.9279994964599609, -0.26432156562805176, -0.9931011199951172, 0.17091941833496094, 0.9174137115478516, 0.054505348205566406, 0.7663154602050781, 0.03900432586669922, -0.06944084167480469, 0.7565374374389648, 0.117523193359375, 0.17055892944335938, 0.3816370964050293, -0.1857624053955078, -0.011516571044921875, 0.7183303833007812, 0.8183116912841797, -0.3044455051422119, 0.3790922164916992, -0.24461841583251953, 4.989982604980469, 0.9396438598632812, 0.7716999053955078, 0.33919334411621094, 1.2600574493408203, 0.6481266021728516, 1.3414716720581055, 0.36064815521240234, 0.2519083023071289, 0.37340259552001953, 0.15087890625, 0.5751543045043945, 0.2060222625732422, 0.17689990997314453, -0.3574798107147217, 0.5894927978515625, -0.26467323303222656, 0.1350231170654297, 0.6603550910949707, -0.13897132873535156, -2.0842742919921875, -0.048656463623046875, 0.4590110778808594, 0.47941017150878906, -0.031076431274414062, 0.3490161895751953, 0.2338695526123047, -0.0678863525390625, 0.11945152282714844, 0.3004875183105469, 0.6976327896118164, 0.66082763671875, -0.38997936248779297, 0.00493621826171875, 0.019415855407714844, -6.650447845458984, 0.1246938705444336, -0.016577720642089844, -0.2566394805908203, 0.04929161071777344, 0.3273124694824219, 0.12566566467285156, -0.18980932235717773, -0.13004302978515625, -0.5720558166503906, 0.38652610778808594, 0.38804149627685547, -0.030676841735839844, 0.8417158126831055, 0.3437938690185547, 0.2906379699707031, -0.14625930786132812, 0.3209800720214844, -0.12111425399780273, 0.04451560974121094, 0.05655097961425781, -0.05747795104980469, 3.998683452606201, -5.8670196533203125, 0.19505882263183594, 0.17247867584228516, 0.44420623779296875, -0.30869007110595703, 0.3151893615722656, 0.06607818603515625, 8.03023910522461, 1.1668758392333984, -0.17493438720703125, 2.0643482208251953, 0.05772590637207031, 0.11722469329833984, 1.3401122093200684, -6.947256088256836, 0.054505348205566406, -0.6732549667358398, -0.2862968444824219, -0.2606048583984375, 0.5362205505371094, 0.04936790466308594, 0.08150100708007812, 0.026674270629882812, 0.36876678466796875, -0.5931415557861328, 0.33701515197753906, 0.3626728057861328, 7.7187113761901855, -0.08989906311035156, 0.1673412322998047, -0.6484870910644531, 0.8163204193115234, 0.38279151916503906, 0.17554092407226562, 0.37741661071777344, -0.5413789749145508, 0.16009902954101562, -6.490678787231445, 0.11066436767578125, 0.4541664123535156, -0.26788997650146484, 1.2391910552978516, -0.014741897583007812, 0.1107177734375, -0.10588550567626953, -0.018499374389648438, -0.00046539306640625, -1.4686775207519531, -0.07736682891845703, -0.21064186096191406, 0.17438888549804688, -0.4285825490951538, -0.07216835021972656, 0.4866781234741211, -0.1058053970336914, 0.47922325134277344, -0.6676816940307617, 0.4064006805419922, -0.40996456146240234, -0.6732549667358398, -0.4224557876586914, 6.10859489440918, -0.10845756530761719, 0.24383544921875, -0.6732549667358398, 0.05871772766113281, 9.46522045135498, 0.032932281494140625, 0.10984611511230469, 1.094858169555664, -0.37893009185791016, -0.3142566680908203, -0.2797260284423828, 0.7424440383911133, 0.2117767333984375, 0.2867574691772461, -0.3179664611816406, 0.2331676483154297, -0.026346206665039062, -5.645511627197266, 0.2739219665527344, -0.024530410766601562, 3.092632293701172, 0.08501434326171875, 0.07531547546386719, -0.03585052490234375, 1.2580547332763672, -0.22515296936035156, 0.7278976440429688, 5.303260803222656, -6.051929473876953, 0.1939687728881836, 0.21158599853515625, -0.04505348205566406, 0.1367635726928711, 0.1280202865600586, -1.7683796882629395, 0.09765148162841797, -0.2656097412109375, 0.3346681594848633, 0.07652664184570312, -1.1601238250732422, 0.6190395355224609], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 93184, "num_env_steps_trained": 432300, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 432300, "last_target_update_ts": 93184, "num_target_updates": 181}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -20.306784199550748, "episode_len_mean": 227.6, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763], "episode_lengths": [198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5696133637428882, "mean_inference_ms": 24.47027030741987, "mean_action_processing_ms": 0.13367086818062876, "mean_env_wait_ms": 4.539541703786048, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -20.306784199550748, "episode_len_mean": 227.6, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.900902509689331, -0.8999999761581421, 11.296451963484287, 23.565137207508087, -136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763], "episode_lengths": [198, 213, 196, 224, 275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5696133637428882, "mean_inference_ms": 24.47027030741987, "mean_action_processing_ms": 0.13367086818062876, "mean_env_wait_ms": 4.539541703786048, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 432300, "num_env_steps_sampled": 93184, "num_env_steps_trained": 432300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 93184, "agent_timesteps_total": 93184, "timers": {"training_iteration_time_ms": 335.83, "learn_time_ms": 73.592, "learn_throughput": 4076.532, "synch_weights_time_ms": 21.587}, "counters": {"num_env_steps_sampled": 93184, "num_env_steps_trained": 432300, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 432300, "last_target_update_ts": 93184, "num_target_updates": 181}, "done": false, "episodes_total": 367, "training_iteration": 91, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-32-55", "timestamp": 1655494375, "time_this_iter_s": 5.4823830127716064, "time_total_s": 496.503173828125, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 496.503173828125, "timesteps_since_restore": 0, "iterations_since_restore": 91, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 31.599999999999998, "ram_util_percent": 64.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.513779640197754, "min_q": -0.25939232110977173, "max_q": 34.60955810546875, "mean_td_error": 0.08455508947372437}, "td_error": [0.05758523941040039, 0.7084312438964844, 0.38947582244873047, 1.1626510620117188, 1.5826425552368164, 0.46202659606933594, 0.17813587188720703, 0.0055484771728515625, 0.38637733459472656, 0.5950088500976562, 0.25121116638183594, 0.19754981994628906, 2.068582534790039, -0.14790725708007812, 1.1177377700805664, 0.7064857482910156, 2.1356611251831055, 0.1205282211303711, 0.15257549285888672, 0.1484832763671875, -0.4072113037109375, 0.5236892700195312, 0.15345478057861328, -0.2520275115966797, 0.24672698974609375, 0.5122842788696289, 0.06213951110839844, 0.1570873260498047, 11.034845352172852, -0.09976744651794434, -0.08062934875488281, 0.2778739929199219, 0.4040794372558594, 0.3923797607421875, -0.33062744140625, -0.40830516815185547, -0.806488037109375, 0.8831310272216797, -0.28812313079833984, 0.1545085906982422, 0.023693084716796875, -0.0806427001953125, 0.4956235885620117, 0.014749526977539062, 0.24895286560058594, -0.3062877655029297, 0.2778739929199219, -0.3391571044921875, -0.47707653045654297, 4.407258033752441, 1.6442151069641113, 0.9095916748046875, 0.00681304931640625, 0.28574275970458984, 0.32764387130737305, 0.3813037872314453, 0.2666015625, -0.36638832092285156, -0.5607872009277344, 0.14084529876708984, 0.4355506896972656, 0.27387356758117676, 0.3288860321044922, 0.49088096618652344, 0.16922283172607422, -5.6829376220703125, 0.5507931709289551, 2.6860713958740234, 0.02728128433227539, 0.034114837646484375, 0.32773590087890625, 0.0991220474243164, 0.25141334533691406, 0.7965154647827148, 0.11787986755371094, 0.03163719177246094, 0.0008525848388671875, 0.7759206295013428, 0.7519505023956299, 0.003795623779296875, 0.8939437866210938, 0.09566307067871094, 0.42707061767578125, 0.4148445129394531, -0.035483360290527344, 0.25839805603027344, -0.1450061798095703, 0.39107704162597656, -0.43776798248291016, 0.39029884338378906, 0.20381641387939453, -0.2875547409057617, 0.1817922592163086, 0.09794044494628906, 0.04780769348144531, 0.059958457946777344, 0.3185892105102539, -0.4312448501586914, 6.178460597991943, 0.8176364898681641, 1.0614051818847656, 1.5248165130615234, 2.09808349609375e-05, 0.030916213989257812, -0.5099921226501465, 1.1552543640136719, 0.1983966827392578, 0.1823263168334961, 0.2409343719482422, 0.16922283172607422, 5.572973728179932, 0.1151132583618164, 0.8542795181274414, 0.10448074340820312, -0.11396408081054688, 0.27772045135498047, 0.5023059844970703, 0.2628011703491211, 0.21175193786621094, 0.4582347869873047, -0.39559078216552734, 0.40911245346069336, 0.17167282104492188, 0.6079874038696289, -0.5947628021240234, -0.2678041458129883, 0.3681793212890625, 0.5191097259521484, -1.0553970336914062, 0.5606875419616699, 0.4505157470703125, 1.108144760131836, -0.11892127990722656, -0.33867740631103516, 0.05712127685546875, 0.28484535217285156, 0.681793212890625, 1.1900806427001953, 0.06371498107910156, 0.30762290954589844, 0.2378826141357422, 0.02377605438232422, 1.8647093772888184, 0.344033420085907, -0.06641864776611328, 0.03633403778076172, 0.24978065490722656, 0.36889076232910156, 0.3353152275085449, 0.22196197509765625, -0.07284443080425262, -0.24528121948242188, 4.951419830322266, -0.42530250549316406, 0.5536403656005859, 0.20726585388183594, 1.0391254425048828, 0.1643838882446289, 0.12639427185058594, 0.18459320068359375, -0.5999364852905273, 0.10408210754394531, 0.28574275970458984, 0.013639450073242188, -4.7449798583984375, 1.1411933898925781, -0.05941581726074219, 0.46653175354003906, -0.2595062255859375, -0.9954643249511719, -0.05684995651245117, 0.26274776458740234, 0.1088705062866211, 0.2261829376220703, -0.05408287048339844, 0.2487621307373047, 0.2052600383758545, 0.6260089874267578, -0.13380050659179688, 0.7458009719848633, 0.39118003845214844, 0.1608877182006836, -0.6330041885375977, -0.021035194396972656, 0.3010520935058594, 1.3639545440673828, -6.589973449707031, 5.643157005310059, 0.8751192092895508, 0.5257854461669922, 0.07087898254394531, 0.18297767639160156, 0.4020652770996094, -0.4712104797363281, 0.1770944595336914, 1.1241645812988281, 0.33986473083496094, 0.4343681335449219, -4.9802093505859375, 0.1595773696899414, -0.18337440490722656, -11.491382598876953, -0.15008163452148438, 0.8691215515136719, 0.18743515014648438, -0.06808280944824219, 0.10032081604003906, -4.492944717407227, -5.717437744140625, 1.040304183959961, -0.27916717529296875, 0.23562049865722656, 0.8602256774902344, 0.421295166015625, 0.1372842788696289, 0.37655162811279297, 2.815005302429199, -0.4299163818359375, 1.4400634765625, 0.4027242660522461, -0.8724880218505859, 1.2980079650878906, 0.41130638122558594, 0.3247714042663574, 0.029844284057617188, 0.1518268585205078, -0.26810455322265625, -1.0265703201293945, -9.130802154541016, 0.0877237319946289, 0.1565074920654297, -9.377350807189941, -0.6487264633178711, -0.20174407958984375, 0.216583251953125, -0.40067291259765625, -0.3874940872192383, 0.034832000732421875, 0.06472206115722656, 8.874204635620117, -4.570041656494141, 0.22699546813964844, 0.18444061279296875, 0.5606875419616699, -0.05178070068359375, 3.544123649597168, 0.08162879943847656, 0.29134559631347656, -9.032424926757812, 0.3547792434692383, -1.0220565795898438, 0.26771068572998047, -0.26235389709472656, -10.428068161010742, 0.08562707901000977, 5.168703079223633, 0.8683671951293945, 0.7487068176269531, -1.9133129119873047, -0.06282711029052734, 3.2954893112182617, 1.0678691864013672, -0.08144378662109375, 0.27772045135498047, -0.1771373748779297, 0.725311279296875, -0.47994232177734375, 5.388294696807861, -5.535392761230469, 0.39095211029052734, -4.54069709777832, -0.015794754028320312, -9.448406219482422, -0.41756629943847656, 0.021923065185546875, 0.13211631774902344, 0.21972942352294922, 0.44143104553222656, 0.18575811386108398, 0.08971595764160156, -0.3927192687988281, 0.052908897399902344, -0.05737113952636719, 0.28839588165283203, 1.8799686431884766, 0.7703285217285156, 0.26256275177001953, 0.8555831909179688, 0.21161460876464844, 1.7498388290405273, 0.6112422943115234, -0.06979560852050781, 0.148193359375, 0.2816810607910156, 0.4393806457519531, 0.2351226806640625, -0.05277538299560547, -0.3204374313354492, -0.1041402816772461, -0.4279346466064453], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 94208, "num_env_steps_trained": 437100, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 437100, "last_target_update_ts": 94208, "num_target_updates": 183}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -21.126347877979278, "episode_len_mean": 228.18, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763, 7.598936676979065, 3.30000002682209, -59.45756348967552, 16.46475064754486], "episode_lengths": [275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279, 220, 205, 254, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5705469858011379, "mean_inference_ms": 24.48674309954392, "mean_action_processing_ms": 0.13382991652053533, "mean_env_wait_ms": 4.546143447297365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -21.126347877979278, "episode_len_mean": 228.18, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-136.4561756402254, 22.94723206758499, -37.98539173603058, 25.713219851255417, -28.304855316877365, 24.221270695328712, 6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763, 7.598936676979065, 3.30000002682209, -59.45756348967552, 16.46475064754486], "episode_lengths": [275, 197, 224, 216, 242, 205, 179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279, 220, 205, 254, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5705469858011379, "mean_inference_ms": 24.48674309954392, "mean_action_processing_ms": 0.13382991652053533, "mean_env_wait_ms": 4.546143447297365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 437100, "num_env_steps_sampled": 94208, "num_env_steps_trained": 437100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 94208, "agent_timesteps_total": 94208, "timers": {"training_iteration_time_ms": 346.562, "learn_time_ms": 72.499, "learn_throughput": 4138.004, "synch_weights_time_ms": 21.088}, "counters": {"num_env_steps_sampled": 94208, "num_env_steps_trained": 437100, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 437100, "last_target_update_ts": 94208, "num_target_updates": 183}, "done": false, "episodes_total": 371, "training_iteration": 92, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-33-01", "timestamp": 1655494381, "time_this_iter_s": 5.568069219589233, "time_total_s": 502.07124304771423, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 502.07124304771423, "timesteps_since_restore": 0, "iterations_since_restore": 92, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 32.25, "ram_util_percent": 63.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.658616065979004, "min_q": -1.0837693214416504, "max_q": 32.18201446533203, "mean_td_error": 0.2556301951408386}, "td_error": [8.461048126220703, -7.051861763000488, -0.08123397827148438, 0.1747884750366211, 0.17554759979248047, 1.5659122467041016, -0.04979515075683594, 0.2743721008300781, 1.6442241668701172, 0.6691617965698242, 0.1906757354736328, 0.2647247314453125, -0.07644939422607422, 0.2768115997314453, 0.47825050354003906, 1.6523723602294922, 0.06827449798583984, -4.5562334060668945, 1.818586826324463, 0.1393280029296875, 0.9993343353271484, -0.006618499755859375, 6.213160991668701, 2.418600082397461, -0.10860729217529297, -0.15281295776367188, 1.6862903833389282, -0.18121767044067383, -0.3670196533203125, -0.07165336608886719, -0.5648002624511719, -1.3888816833496094, 0.0555424690246582, -0.0450897216796875, -0.1510915756225586, 0.2131366729736328, -5.702556610107422, 0.017980575561523438, 1.0671262741088867, 4.610212802886963, 0.1195383071899414, 0.18125438690185547, 0.01674652099609375, 1.0481414794921875, 0.04520988464355469, 0.3451499938964844, 0.2573509216308594, -0.006388664245605469, 0.17255592346191406, -0.14155960083007812, -0.5283164978027344, 0.17918014526367188, 0.3377094268798828, 0.1109619140625, -1.300394058227539, 0.38962745666503906, 0.4675016403198242, 0.3708505630493164, -0.19469547271728516, 0.1916942596435547, -1.2879791259765625, 0.0384521484375, 0.08658981323242188, 0.4548673629760742, 0.4156346321105957, 0.6919384002685547, 2.918765068054199, 1.7759332656860352, 0.1895313262939453, 0.3009815216064453, 0.44545745849609375, 1.7469596862792969, 0.1108388900756836, -0.011488080024719238, -1.4147520065307617, 0.7210750579833984, 0.43645286560058594, 0.20324134826660156, 0.19179534912109375, 0.5434627532958984, 0.2739410400390625, 0.8533525466918945, 0.6069717407226562, 5.7598490715026855, 0.43393898010253906, -6.242523193359375, -0.16487300395965576, 0.22923660278320312, 0.4145927429199219, 2.2642478942871094, 0.1285991668701172, 0.9146442413330078, 2.216289520263672, -0.13147258758544922, 0.24848556518554688, 8.91072940826416, 0.12398433685302734, 0.5595474243164062, 11.788792610168457, -0.023693084716796875, 0.3280038833618164, 0.4186992645263672, -5.963039398193359, 0.12863445281982422, 0.04559135437011719, 0.3824310302734375, -0.04049491882324219, 0.6544418334960938, -0.83428955078125, 0.40742015838623047, -0.04498577117919922, 0.20014667510986328, 0.31311702728271484, 1.1118183135986328, -0.5092267990112305, 0.9317426681518555, 2.8034286499023438, 0.32341670989990234, -1.246933937072754, 0.3884315490722656, -0.042862892150878906, -0.25366783142089844, -0.1992645263671875, 0.2112751007080078, -0.7475318908691406, -0.44637298583984375, 0.6303168535232544, 0.08959197998046875, 0.039813995361328125, 0.3412036895751953, -0.1992645263671875, 0.46118927001953125, 0.3390483856201172, -0.0988912582397461, 0.13647842407226562, 0.1051034927368164, 0.05349540710449219, 0.9831979274749756, 0.5540809631347656, -0.0791311264038086, 1.5089061260223389, 0.8519506454467773, 0.33560752868652344, -0.1628742218017578, -0.34155845642089844, 1.1774520874023438, 0.09576034545898438, -0.06546306610107422, 0.13665103912353516, -0.06671524047851562, 0.28887939453125, 0.19401168823242188, 0.3324089050292969, 0.272735595703125, 0.2595186233520508, 0.6836957931518555, 0.21982955932617188, 1.4505977630615234, 0.5410556793212891, 0.035923004150390625, 0.1349620819091797, 0.00177001953125, 0.024675369262695312, 1.4321269989013672, 0.49289417266845703, -0.1863856315612793, 0.7847576141357422, 0.03433990478515625, 0.19480514526367188, 0.1327342987060547, 0.6759357452392578, 0.5943660736083984, 0.08362388610839844, 1.073542594909668, 0.6758317947387695, 1.4450287818908691, 0.22577857971191406, 0.8286209106445312, 0.4059305191040039, 0.04144859313964844, -0.11717808246612549, -0.12278556823730469, 0.4769744873046875, 0.4290142059326172, 0.14847469329833984, -1.5175094604492188, 0.04016685485839844, 0.2126922607421875, 7.384769439697266, -0.40234375, 0.47734737396240234, -9.599601745605469, 0.18827438354492188, 0.038125038146972656, -0.013143539428710938, 0.6052074432373047, 0.5298614501953125, 0.39443302154541016, 0.7836723327636719, 0.6786918640136719, 0.4436359405517578, 0.7822685241699219, 0.5218000411987305, -9.653234481811523, 0.07079410552978516, -5.834842681884766, 0.028023719787597656, 0.051631927490234375, -0.9932212829589844, -6.995234489440918, 0.48053550720214844, -0.3364982604980469, 0.45354175567626953, 0.5061836242675781, 0.244415283203125, -0.14752483367919922, -10.975383758544922, 0.05514717102050781, -6.300543308258057, 0.10311508178710938, 0.08707618713378906, 0.6263866424560547, 0.3532524108886719, 0.2708628177642822, 0.7026157379150391, -0.0533447265625, 1.3468875885009766, -0.09540367126464844, 0.3376426696777344, -0.3532390594482422, 0.8056735992431641, -0.1482830047607422, 0.21878337860107422, -0.6251010894775391, 11.941044807434082, 0.21943378448486328, 0.13938331604003906, 0.5035676956176758, -0.014248847961425781, 0.2351512908935547, 0.1373119354248047, -0.22243309020996094, 0.007210731506347656, 0.3058357238769531, 1.0503177642822266, 0.6923942565917969, 0.5602645874023438, -0.6936612129211426, 0.6429605484008789, 0.144561767578125, 0.19215011596679688, 0.1310129165649414, 0.5225811004638672, -0.2812347412109375, 0.5018711090087891, -0.25508975982666016, 0.061041831970214844, 0.3016929626464844, 0.3811683654785156, 0.2500181198120117, -0.1135711669921875, 0.22777938842773438, 8.163067817687988, 0.7641372680664062, 0.2573509216308594, -0.15593719482421875, 0.367919921875, 1.0781421661376953, 0.87359619140625, -4.791214942932129, 1.0162630081176758, 0.4398231506347656, -0.029448986053466797, -0.8650064468383789, -0.09649848937988281, -0.006626129150390625, 0.146331787109375, 0.6779298782348633, 0.15704631805419922, 0.22377395629882812, 6.558948993682861, 0.7104463577270508, 1.012655258178711, -0.05380058288574219, 0.8202953338623047, 0.22027873992919922, 0.1385974884033203, 0.07784509658813477, 0.7104463577270508, -0.15538692474365234, -0.4610919952392578, 0.3124237060546875, 1.0546340942382812, 0.20946216583251953, -0.19820404052734375, 0.049483299255371094, 0.592717170715332, -0.7628936767578125, 0.5515251159667969, 0.032566070556640625], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 95232, "num_env_steps_trained": 441900, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 441900, "last_target_update_ts": 95232, "num_target_updates": 185}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -18.941539357155563, "episode_len_mean": 226.7, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763, 7.598936676979065, 3.30000002682209, -59.45756348967552, 16.46475064754486, 14.813682079315186, 32.30865779519081, 7.410635396838188, 11.610635228455067, 3.2000000700354576, 19.27254143357277], "episode_lengths": [179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279, 220, 205, 254, 210, 183, 215, 201, 185, 208, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5718658381905141, "mean_inference_ms": 24.484524919900288, "mean_action_processing_ms": 0.13407067809434475, "mean_env_wait_ms": 4.549427537548888, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -18.941539357155563, "episode_len_mean": 226.7, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.099999979138374, 18.312019683420658, -139.25617542117834, 17.310635179281235, 8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763, 7.598936676979065, 3.30000002682209, -59.45756348967552, 16.46475064754486, 14.813682079315186, 32.30865779519081, 7.410635396838188, 11.610635228455067, 3.2000000700354576, 19.27254143357277], "episode_lengths": [179, 182, 278, 235, 226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279, 220, 205, 254, 210, 183, 215, 201, 185, 208, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5718658381905141, "mean_inference_ms": 24.484524919900288, "mean_action_processing_ms": 0.13407067809434475, "mean_env_wait_ms": 4.549427537548888, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 441900, "num_env_steps_sampled": 95232, "num_env_steps_trained": 441900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 95232, "agent_timesteps_total": 95232, "timers": {"training_iteration_time_ms": 361.881, "learn_time_ms": 73.612, "learn_throughput": 4075.424, "synch_weights_time_ms": 22.093}, "counters": {"num_env_steps_sampled": 95232, "num_env_steps_trained": 441900, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 441900, "last_target_update_ts": 95232, "num_target_updates": 185}, "done": false, "episodes_total": 377, "training_iteration": 93, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-33-07", "timestamp": 1655494387, "time_this_iter_s": 5.793507099151611, "time_total_s": 507.86475014686584, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 507.86475014686584, "timesteps_since_restore": 0, "iterations_since_restore": 93, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.55, "ram_util_percent": 64.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.499544143676758, "min_q": -1.9974720478057861, "max_q": 34.59556198120117, "mean_td_error": 0.6796190738677979}, "td_error": [1.155843734741211, 0.9492015838623047, -0.40906429290771484, 1.4255294799804688, 0.6415863037109375, 1.3674964904785156, -5.538658142089844, -0.16511917114257812, 0.5906782150268555, 0.824854850769043, 1.2732629776000977, 0.7519435882568359, 2.264375686645508, 0.3167695999145508, 0.658353328704834, 0.3262028694152832, 0.5232858657836914, 0.4367561340332031, -0.4681510925292969, 0.8847770690917969, 0.24950432777404785, 0.11561965942382812, 1.5452604293823242, 1.1582183837890625, 8.687224388122559, 0.3414955139160156, 4.446871757507324, 1.0218658447265625, 0.640472412109375, 0.4648761749267578, 0.8512134552001953, 0.17197608947753906, 1.527627944946289, 0.743377685546875, 0.8565406799316406, 0.30043792724609375, 1.0915393829345703, 0.8733701705932617, 0.2838602066040039, 0.6561369895935059, 2.6114583015441895, 0.7086248397827148, 0.2421436309814453, 0.7489910125732422, 0.2774524688720703, 1.6072587966918945, 0.3858799934387207, 0.44795989990234375, 2.3738105297088623, 1.46099853515625, 0.9715604782104492, 0.6743478775024414, 0.06661605834960938, 0.3148946762084961, 0.5575923919677734, 3.017880916595459, 0.4871234893798828, -2.4568309783935547, 0.6094646453857422, 1.1743483543395996, 0.7504215240478516, 0.39858436584472656, 0.023542404174804688, 2.722991943359375, 0.3526802062988281, 0.3905296325683594, 2.717021942138672, 0.22347640991210938, 1.6020684242248535, 0.49706363677978516, 0.5942730903625488, 0.1583271026611328, 0.4983177185058594, 0.6875572204589844, -0.029531478881835938, 0.7830753326416016, 0.2404155731201172, 0.3170356750488281, 0.2684516906738281, -8.383697509765625, 0.5245990753173828, 0.8253383636474609, 4.148861408233643, 0.40394115447998047, 0.4836888313293457, 0.8977189064025879, 0.5723285675048828, -0.2538166046142578, 0.9196233749389648, 0.39079856872558594, -9.16250228881836, 0.33220863342285156, 1.0392138957977295, 0.3193511962890625, -0.2621574401855469, 8.2536039352417, 1.3197972774505615, 0.4382743835449219, 2.2944488525390625, 0.3290119171142578, 1.6647529602050781, 0.16466903686523438, 0.7852115631103516, 0.15050506591796875, 3.157601833343506, 0.325775146484375, 1.3305768966674805, 0.31758785247802734, 0.7447338104248047, -0.0298004150390625, -0.4303607940673828, 0.6474666595458984, 0.5635147094726562, 1.5913572311401367, -0.3441181182861328, 0.5274820327758789, 0.4369544982910156, 0.3689384460449219, 1.0006542205810547, 0.2923288345336914, -5.650193214416504, 0.791407585144043, 0.4038200378417969, 1.051321029663086, 0.020748138427734375, 0.7199544906616211, 1.9862499237060547, 0.8216733932495117, 1.122049331665039, 0.8605184555053711, 0.5783343315124512, -0.1717395782470703, 0.8669109344482422, 1.2397527694702148, -6.082843780517578, 0.7500705718994141, -5.919520854949951, 0.10694122314453125, 0.20280170440673828, 0.14177513122558594, 2.908296585083008, 0.19361591339111328, 2.722991943359375, -0.30098390579223633, 0.5895824432373047, -0.08524513244628906, 0.3652224540710449, 0.46309852600097656, 0.07810783386230469, 0.5708189010620117, 0.766697883605957, 0.8642921447753906, 9.386176109313965, 0.003772735595703125, 3.0025501251220703, 0.2613182067871094, -0.10309028625488281, 0.1829395294189453, -0.01854228973388672, 0.3219623565673828, 0.5275859832763672, 0.9151191711425781, -3.3655643463134766, 0.06940150260925293, 0.43245887756347656, 0.6706438064575195, 0.6816310882568359, 0.42748069763183594, 2.107950210571289, 0.31612205505371094, 1.6513996124267578, 0.9573631286621094, 0.1543445587158203, 1.0332250595092773, 0.058380126953125, -1.5732040405273438, 2.3022117614746094, 0.6023635864257812, 0.5124778747558594, 0.5404939651489258, 0.4741020202636719, 0.037244319915771484, 0.3975706100463867, 2.3687760829925537, 2.0971155166625977, 2.21274471282959, 1.998560905456543, 0.34234046936035156, 1.6548900604248047, 0.7985763549804688, 0.8609848022460938, 0.7441368103027344, 0.5566310882568359, 2.862473487854004, 0.2681617736816406, 0.7229557037353516, 6.545417785644531, 0.5652115345001221, 0.1500873565673828, 0.29031944274902344, 0.2522897720336914, -0.44035911560058594, 0.6340961456298828, 1.7527174949645996, 0.7459678649902344, -0.27516651153564453, 2.032808303833008, 2.1799697875976562, -0.4763927459716797, 0.42075252532958984, 1.5483894348144531, 0.7310314178466797, 0.1273822784423828, 1.9875445365905762, 4.790287971496582, 0.3333311080932617, 0.9168174266815186, 0.5774078369140625, -5.974387168884277, 0.36609840393066406, 1.1560897827148438, 0.9202613830566406, 0.5590152740478516, -0.8953571319580078, 0.631688117980957, -0.6998233795166016, -0.06564140319824219, 4.004179000854492, 0.6368064880371094, -0.5161037445068359, 0.2668876647949219, 1.4043598175048828, 0.038636207580566406, 5.534905910491943, 0.838005781173706, 0.5814857482910156, 0.773381233215332, 1.4291610717773438, 3.6466732025146484, 1.5483894348144531, 0.25235748291015625, 0.5683231353759766, 1.5496063232421875, -0.2357025146484375, 0.8020458221435547, 0.4736905097961426, -1.1530742645263672, 0.6407613754272461, 1.1566791534423828, 0.8693103790283203, 2.4343061447143555, -0.42618370056152344, 0.33922576904296875, 0.4550352096557617, 0.21577835083007812, 0.9168174266815186, -3.653179168701172, 0.7100563049316406, 0.9565582275390625, 0.18138504028320312, 1.367340087890625, 0.40665245056152344, 0.8208446502685547, 0.3333311080932617, 2.5934066772460938, 0.18399810791015625, 0.5822162628173828, 1.5726261138916016, 1.2667312622070312, 0.8070240020751953, 1.1877422332763672, 0.9095191955566406, 0.3193702697753906, 1.3560266494750977, -0.09235572814941406, 0.007556915283203125, 1.1771736145019531, 0.4620246887207031, -4.010467529296875, 0.7361335754394531, 1.4497718811035156, -0.0011053085327148438, 0.5630817413330078, 4.993157863616943, 0.27242231369018555, 1.3585243225097656, 0.3648109436035156, 0.21555280685424805, 0.5681657791137695, 0.08163070678710938, 0.7874250411987305, 0.3326578140258789, 0.3717823028564453, 0.8617115020751953, 1.4749641418457031, 0.1607961654663086, 1.5267705917358398, 0.3184852600097656, 1.264683723449707, 0.8606014251708984], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 96256, "num_env_steps_trained": 446700, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 446700, "last_target_update_ts": 96256, "num_target_updates": 187}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -17.40276617400348, "episode_len_mean": 226.64, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763, 7.598936676979065, 3.30000002682209, -59.45756348967552, 16.46475064754486, 14.813682079315186, 32.30865779519081, 7.410635396838188, 11.610635228455067, 3.2000000700354576, 19.27254143357277, 1.5000000596046448, 24.619942285120487, 30.72385536134243, -0.4999999701976776], "episode_lengths": [226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279, 220, 205, 254, 210, 183, 215, 201, 185, 208, 219, 224, 203, 212, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5716451642565682, "mean_inference_ms": 24.473119329726497, "mean_action_processing_ms": 0.13375019136974642, "mean_env_wait_ms": 4.549078280560469, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -17.40276617400348, "episode_len_mean": 226.64, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.200000062584877, 5.864785879850388, -67.57078368961811, 14.426869250833988, -111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763, 7.598936676979065, 3.30000002682209, -59.45756348967552, 16.46475064754486, 14.813682079315186, 32.30865779519081, 7.410635396838188, 11.610635228455067, 3.2000000700354576, 19.27254143357277, 1.5000000596046448, 24.619942285120487, 30.72385536134243, -0.4999999701976776], "episode_lengths": [226, 218, 269, 210, 245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279, 220, 205, 254, 210, 183, 215, 201, 185, 208, 219, 224, 203, 212, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5716451642565682, "mean_inference_ms": 24.473119329726497, "mean_action_processing_ms": 0.13375019136974642, "mean_env_wait_ms": 4.549078280560469, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 446700, "num_env_steps_sampled": 96256, "num_env_steps_trained": 446700, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 96256, "agent_timesteps_total": 96256, "timers": {"training_iteration_time_ms": 344.862, "learn_time_ms": 73.794, "learn_throughput": 4065.368, "synch_weights_time_ms": 21.187}, "counters": {"num_env_steps_sampled": 96256, "num_env_steps_trained": 446700, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 446700, "last_target_update_ts": 96256, "num_target_updates": 187}, "done": false, "episodes_total": 381, "training_iteration": 94, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-33-13", "timestamp": 1655494393, "time_this_iter_s": 5.648695945739746, "time_total_s": 513.5134460926056, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 513.5134460926056, "timesteps_since_restore": 0, "iterations_since_restore": 94, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 28.475, "ram_util_percent": 64.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.000563621520996, "min_q": -0.09412384033203125, "max_q": 35.8646354675293, "mean_td_error": 0.03650109842419624}, "td_error": [0.07535934448242188, 5.364571571350098, 0.2999439239501953, -4.991641998291016, 0.3905372619628906, 0.2992839813232422, 0.7396345138549805, 0.3354454040527344, 0.5326242446899414, 0.5206451416015625, 0.8355634212493896, -2.8838882446289062, -0.43299102783203125, 0.7411527633666992, 0.09731292724609375, 0.3315601348876953, 0.6108212471008301, 0.1760845184326172, 0.33844566345214844, 0.16580629348754883, -0.12760543823242188, 0.3047914505004883, 0.3491096496582031, 0.1533527374267578, 0.3984546661376953, -4.797158241271973, 0.2788887023925781, 0.47371482849121094, -0.062155723571777344, 0.36649513244628906, 0.016792774200439453, 0.2604694366455078, 0.7835562229156494, 0.3922462463378906, -0.12404060363769531, 0.3970785140991211, 0.9112472534179688, 0.7972345352172852, 0.20487213134765625, 0.4460735321044922, 0.2311115264892578, 0.9672842025756836, -0.43299102783203125, 0.1721811294555664, 0.41194725036621094, -5.74986457824707, -0.09778404235839844, 0.2149524688720703, 0.13222885131835938, 1.0726487636566162, -0.018673419952392578, 0.39920711517333984, -2.594228744506836, -0.1505880355834961, 0.4842395782470703, 1.4119701385498047, 0.23489761352539062, -0.28315162658691406, 0.02149486541748047, 1.276646614074707, 0.15431499481201172, 0.2429056167602539, -0.5601234436035156, -0.1351470947265625, 0.6400198936462402, 0.9869518280029297, 0.2885456085205078, 0.1436138153076172, 0.34139299392700195, 0.7949256896972656, 0.968440055847168, -0.8959378004074097, 1.1859116554260254, 0.06678962707519531, -0.1425790786743164, 0.1434183120727539, 0.9179878234863281, 0.4101734161376953, 0.04655647277832031, 5.934391975402832, -0.10279369354248047, -0.623779296875, 0.6351222991943359, 0.422590970993042, 0.011198997497558594, -0.1408519744873047, 0.4572010040283203, 0.5713834762573242, 0.2958698272705078, 0.38250017166137695, -0.04712104797363281, -0.3998851776123047, 0.2728748321533203, -0.6333789825439453, 0.15554428100585938, 0.2939186096191406, 0.06656742095947266, -0.27861595153808594, 0.6160173416137695, -0.5990753173828125, -0.010700225830078125, 0.2341747283935547, 0.06678962707519531, -0.2542533874511719, 0.014972686767578125, 1.0889949798583984, 0.249298095703125, 0.05575275421142578, 0.2812957763671875, 1.1052217483520508, -0.0355987548828125, -0.274749755859375, 0.19160079956054688, -0.3798084259033203, 0.06004905700683594, -0.2159280776977539, 0.3305540084838867, 0.5813465118408203, 0.6499433517456055, -0.11447429656982422, -0.45381879806518555, -0.16622543334960938, 0.29444074630737305, 0.0058536529541015625, 0.6863632202148438, 0.5383696556091309, -5.790585517883301, -0.0887594223022461, 1.1587848663330078, 0.09404349327087402, 0.9104518890380859, 0.5374069213867188, 0.2864675521850586, -6.001091480255127, -0.1453075408935547, 0.1387491226196289, 0.27929210662841797, 0.4470701217651367, 0.7019290924072266, -11.591920852661133, 1.4718809127807617, 1.0044994354248047, -0.03676795959472656, -0.8185672760009766, 0.6645450592041016, 0.5299091339111328, -0.015743255615234375, 0.25608348846435547, -7.402247428894043, -0.3621540069580078, -0.6925516128540039, -0.003958702087402344, -6.0261430740356445, 1.0357179641723633, 0.13313579559326172, -0.5880718231201172, 0.32940673828125, 0.3272104263305664, 0.44530487060546875, 0.5927982330322266, 0.7337760925292969, -0.002170562744140625, 0.21280479431152344, 0.2155475616455078, -0.5995578765869141, 0.7155189514160156, 0.16329479217529297, 0.2573738098144531, 0.45879650115966797, 0.33771324157714844, -0.6066951751708984, -4.0333251953125, 0.7303619384765625, -9.041662216186523, 1.0726487636566162, 2.4905624389648438, 0.06004905700683594, 2.1791934967041016, -0.153778076171875, -0.1998004913330078, -8.306072235107422, 1.0242996215820312, 0.19729232788085938, 0.2923746109008789, -0.34743499755859375, -0.06430625915527344, 1.5389699935913086, -0.5712757110595703, 0.8492393493652344, 0.34531688690185547, 0.9017953872680664, 0.13145828247070312, 0.6680865287780762, -0.09287452697753906, 0.26566600799560547, 0.3665151596069336, 0.6759920120239258, 6.0529327392578125, 0.27893924713134766, 0.6291666030883789, 0.41051578521728516, 0.17086410522460938, 0.2491774559020996, 0.4386329650878906, 0.3766164779663086, 0.4812278747558594, 0.6911911964416504, 1.1616554260253906, 1.1321287155151367, -0.10406303405761719, 0.4395160675048828, -0.02798318862915039, 0.20331573486328125, 1.025564193725586, -3.618337631225586, 0.30725669860839844, 0.4759101867675781, 0.13457489013671875, 0.4903240203857422, 0.6266727447509766, 0.05964851379394531, -0.039783477783203125, -0.2352619171142578, 0.009621620178222656, 0.27399539947509766, -0.09999608993530273, 0.31223106384277344, 0.5079784393310547, -0.34708595275878906, -0.07836341857910156, 0.24051380157470703, -0.03305244445800781, 2.13983154296875, 8.66529655456543, 0.16984939575195312, -7.402247428894043, 0.532313346862793, -0.34897518157958984, -0.0713191032409668, 2.340836763381958, -0.009847640991210938, 0.9582514762878418, 0.40894126892089844, 0.6291666030883789, 0.09279918670654297, 0.29781341552734375, 2.972705841064453, 0.3276958465576172, 0.7568264007568359, 1.2188396453857422, 0.7729129791259766, 0.8876228332519531, 0.4765462875366211, 1.1321287155151367, 0.578160285949707, 0.18994712829589844, 0.16069793701171875, -0.1274433135986328, 0.9320039749145508, 0.36046838760375977, 0.26934051513671875, 0.13787460327148438, 0.18177556991577148, -0.12470245361328125, 0.16490840911865234, 0.7239985466003418, 0.7971372604370117, 0.6507320404052734, -0.03772735595703125, 0.17998504638671875, 1.0288400650024414, 1.1321287155151367, -0.054912567138671875, 0.883906364440918, 0.4118843078613281, 0.4648895263671875, 0.2292633056640625, -4.797158241271973, -1.0287275314331055, 0.39710426330566406, -0.082672119140625, 1.7451438903808594, 1.0795526504516602, 1.6819286346435547, 0.5934238433837891, -4.674259185791016, 0.3687934875488281, 0.23549652099609375, 0.0694127082824707, 0.2510223388671875, 0.3892631530761719, 0.4988546371459961, 1.3270320892333984, -0.21344470977783203, -0.19686031341552734, 0.15665817260742188, 0.4261646270751953, -3.897068977355957, 0.7789859771728516, -7.57274055480957], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 97280, "num_env_steps_trained": 451500, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 451500, "last_target_update_ts": 97280, "num_target_updates": 189}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -19.62872389294207, "episode_len_mean": 227.48, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763, 7.598936676979065, 3.30000002682209, -59.45756348967552, 16.46475064754486, 14.813682079315186, 32.30865779519081, 7.410635396838188, 11.610635228455067, 3.2000000700354576, 19.27254143357277, 1.5000000596046448, 24.619942285120487, 30.72385536134243, -0.4999999701976776, 5.613219887018204, -149.49744275212288, 19.77542108297348, -137.56609860807657], "episode_lengths": [245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279, 220, 205, 254, 210, 183, 215, 201, 185, 208, 219, 224, 203, 212, 229, 234, 295, 228, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5727034322331681, "mean_inference_ms": 24.502288423449563, "mean_action_processing_ms": 0.13394648340366316, "mean_env_wait_ms": 4.5550827113699714, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -19.62872389294207, "episode_len_mean": 227.48, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-111.35329531878233, 5.510635428130627, -0.09224454313516617, 20.81153804808855, 5.6077554151415825, -6.451079651713371, -116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763, 7.598936676979065, 3.30000002682209, -59.45756348967552, 16.46475064754486, 14.813682079315186, 32.30865779519081, 7.410635396838188, 11.610635228455067, 3.2000000700354576, 19.27254143357277, 1.5000000596046448, 24.619942285120487, 30.72385536134243, -0.4999999701976776, 5.613219887018204, -149.49744275212288, 19.77542108297348, -137.56609860807657], "episode_lengths": [245, 232, 233, 208, 211, 204, 244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279, 220, 205, 254, 210, 183, 215, 201, 185, 208, 219, 224, 203, 212, 229, 234, 295, 228, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5727034322331681, "mean_inference_ms": 24.502288423449563, "mean_action_processing_ms": 0.13394648340366316, "mean_env_wait_ms": 4.5550827113699714, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 451500, "num_env_steps_sampled": 97280, "num_env_steps_trained": 451500, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 97280, "agent_timesteps_total": 97280, "timers": {"training_iteration_time_ms": 357.057, "learn_time_ms": 74.191, "learn_throughput": 4043.632, "synch_weights_time_ms": 21.186}, "counters": {"num_env_steps_sampled": 97280, "num_env_steps_trained": 451500, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 451500, "last_target_update_ts": 97280, "num_target_updates": 189}, "done": false, "episodes_total": 385, "training_iteration": 95, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-33-19", "timestamp": 1655494399, "time_this_iter_s": 5.701527833938599, "time_total_s": 519.2149739265442, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 519.2149739265442, "timesteps_since_restore": 0, "iterations_since_restore": 95, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 33.68888888888889, "ram_util_percent": 64.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 13.367134094238281, "min_q": -0.9662140607833862, "max_q": 31.453750610351562, "mean_td_error": 0.20529022812843323}, "td_error": [0.013573646545410156, -5.553638458251953, 0.27536773681640625, 0.7875595092773438, 0.007903575897216797, 2.0747604370117188, 0.6271076202392578, -0.32453441619873047, -0.1107320785522461, 0.39336585998535156, -5.83012580871582, 0.31307506561279297, -1.228464126586914, -0.14008522033691406, 1.3404664993286133, 5.729557037353516, -0.13834571838378906, 0.574211597442627, 0.6609983444213867, 0.3494100570678711, -0.03890419006347656, 0.7424521446228027, -0.29854297637939453, 3.512157440185547, -0.4661235809326172, 0.02370452880859375, 0.1122293472290039, 0.7700529098510742, -0.7682104110717773, -0.4904336929321289, 1.3352832794189453, 0.5229053497314453, 0.7547359466552734, -0.1192474365234375, -0.19850730895996094, 0.030043601989746094, -1.0000276565551758, 1.3057785034179688, 0.6200046539306641, 0.058632850646972656, -0.09885311126708984, 1.6101493835449219, -0.03287553787231445, 0.19339752197265625, -0.08926677703857422, -0.49073219299316406, 6.960423469543457, -0.49077415466308594, -0.23382186889648438, 0.493408203125, 2.724191188812256, -0.37457799911499023, 0.9830207824707031, -0.5527267456054688, -0.551666259765625, 0.017019271850585938, 0.1155548095703125, 6.991600036621094, -0.30394744873046875, -0.0281829833984375, 0.5055217742919922, 0.2716817855834961, 1.3210430145263672, 0.10923957824707031, -0.5382118225097656, -0.2201080322265625, 0.4940185546875, 0.6794443130493164, -0.20248889923095703, 9.02869987487793, 1.012350082397461, -0.09979820251464844, -0.4042491912841797, -0.05172157287597656, 0.5674581527709961, 0.5427055358886719, -0.0667428970336914, 2.5184993743896484, -1.2307045459747314, 0.628657341003418, -0.2384052276611328, -7.294493198394775, -0.3054695129394531, 0.6828098297119141, 0.7009248733520508, 0.03861856460571289, 1.547821044921875, -1.1154041290283203, 0.04972267150878906, 9.873856544494629, -0.46299171447753906, -0.5765247344970703, -5.139804363250732, -1.5304265022277832, 0.17592239379882812, -0.2575206756591797, 0.2264246940612793, -0.031485557556152344, -0.06754112243652344, 0.22991561889648438, 0.4777870178222656, 0.65545654296875, 0.02105093002319336, 2.7442665100097656, -0.1426219940185547, -0.29879283905029297, 0.4829254150390625, 0.20593833923339844, -0.11933517456054688, 0.4389476776123047, 0.3306427001953125, -0.20051288604736328, 0.7886867523193359, 0.5734901428222656, 0.46720123291015625, 0.9499053955078125, 4.680141448974609, -0.30309200286865234, 0.9959115386009216, -0.14835262298583984, -0.1478586196899414, 0.5690956115722656, 3.9929847717285156, 0.410308837890625, -1.0878095626831055, 0.4734382629394531, 0.6395654678344727, 0.053896427154541016, 0.5963153839111328, 0.3291025161743164, 0.602325439453125, 0.8497133255004883, 0.6742153167724609, 0.2768115997314453, 0.13537025451660156, 0.3804168701171875, 0.4826507568359375, -0.7561988830566406, -0.9348297119140625, 0.34943389892578125, 1.0337859392166138, -0.28068065643310547, 0.5143232345581055, 0.36723995208740234, 0.26143503189086914, 0.4973878860473633, 0.243072509765625, 0.4716038703918457, -0.16361045837402344, 8.694391250610352, -0.3509397506713867, -0.1734027862548828, 0.32737159729003906, -1.949397087097168, -0.0841817855834961, 0.05799102783203125, -0.4063906669616699, -0.463043212890625, -0.15102577209472656, 0.2230072021484375, -0.44618797302246094, 0.1048126220703125, -0.0064754486083984375, -4.622871398925781, 0.2806396484375, -0.21866703033447266, -6.516376495361328, 3.7144246101379395, 0.9034690856933594, 0.021368980407714844, 0.0692291259765625, 0.07553672790527344, 0.1691741943359375, 0.2826728820800781, 0.015637874603271484, -0.5681591033935547, -0.1474018096923828, 2.899393081665039, 0.013156890869140625, 0.16106605529785156, 2.9503374099731445, 0.8141450881958008, -0.11660051345825195, -0.7417497634887695, 1.4705562591552734, 0.34067726135253906, -0.26016998291015625, 0.008190155029296875, -0.19758033752441406, -0.3747425079345703, 0.2090778350830078, 0.3145751953125, 0.2946758270263672, -0.1721668243408203, 1.6267967224121094, -0.26377391815185547, 0.07143306732177734, 0.10715293884277344, 0.46150875091552734, 0.15648269653320312, 0.2657489776611328, 0.4550657272338867, 0.0037240982055664062, 0.1000518798828125, -0.3453245162963867, 0.7602958679199219, -0.86767578125, 0.6027069091796875, 0.23528718948364258, 2.0572690963745117, -0.09885311126708984, -0.13596248626708984, -0.044002532958984375, -0.20498180389404297, -1.1400017738342285, -0.06702899932861328, 0.266265869140625, 0.7054252624511719, 1.0124588012695312, 0.05230522155761719, -0.1591176986694336, -5.1119384765625, -0.1476726531982422, -0.09114718437194824, 0.1423025131225586, -4.644586563110352, -0.1333484649658203, -0.5013236999511719, 0.4943113327026367, -0.06987380981445312, 0.7881698608398438, 0.5431308746337891, 1.3057785034179688, 3.426787853240967, -0.1751422882080078, 0.817655086517334, -0.13729286193847656, -8.019035339355469, 0.4907693862915039, -6.637399673461914, -8.820551872253418, 0.03861856460571289, 0.16434478759765625, -0.1586918830871582, 0.1552600860595703, -0.21488094329833984, 0.3930177688598633, 1.364095687866211, 0.24178600311279297, 0.03413963317871094, -9.04651165008545, -0.05967235565185547, -5.83012580871582, 0.5376138687133789, -0.18850135803222656, 0.44579601287841797, 0.3220558166503906, 0.20088863372802734, -0.036197662353515625, 0.9387235641479492, 0.4485454559326172, 0.2533149719238281, -0.21316027641296387, -0.021871566772460938, 1.3325843811035156, -0.09168624877929688, 0.14693069458007812, -0.08735275268554688, 0.3530292510986328, 0.1177215576171875, 0.2090778350830078, 0.028112411499023438, -0.2245941162109375, 0.5513315200805664, -0.19861888885498047, -0.4242262840270996, 0.09560775756835938, 1.0910234451293945, -0.14774417877197266, 0.41050291061401367, -0.5997304916381836, 0.7653121948242188, 1.561976432800293, 0.17848968505859375, -5.414880752563477, 0.5278682708740234, -2.1472930908203125, -0.09707832336425781, 0.18665504455566406, -0.2353200912475586, -0.1889171600341797, 0.7471103668212891, -0.6061439514160156, 0.2704744338989258, 0.3869795799255371, 14.541341781616211, 13.311755180358887, 1.6231193542480469, 0.2017364501953125, 0.18729114532470703], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 98304, "num_env_steps_trained": 456300, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 456300, "last_target_update_ts": 98304, "num_target_updates": 191}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -18.76378698371351, "episode_len_mean": 226.68, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763, 7.598936676979065, 3.30000002682209, -59.45756348967552, 16.46475064754486, 14.813682079315186, 32.30865779519081, 7.410635396838188, 11.610635228455067, 3.2000000700354576, 19.27254143357277, 1.5000000596046448, 24.619942285120487, 30.72385536134243, -0.4999999701976776, 5.613219887018204, -149.49744275212288, 19.77542108297348, -137.56609860807657, 5.499999947845936, 24.00865748524666, 7.299999974668026, -21.046442843973637, -18.63521434366703, 3.4000000804662704], "episode_lengths": [244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279, 220, 205, 254, 210, 183, 215, 201, 185, 208, 219, 224, 203, 212, 229, 234, 295, 228, 250, 223, 215, 180, 207, 237, 191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5743691486338686, "mean_inference_ms": 24.495266964687975, "mean_action_processing_ms": 0.13395371732769365, "mean_env_wait_ms": 4.559356394899232, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -18.76378698371351, "episode_len_mean": 226.68, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-116.77078362554312, 12.007755473256111, 13.498493857681751, -160.56370700150728, 1.5000000223517418, -5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763, 7.598936676979065, 3.30000002682209, -59.45756348967552, 16.46475064754486, 14.813682079315186, 32.30865779519081, 7.410635396838188, 11.610635228455067, 3.2000000700354576, 19.27254143357277, 1.5000000596046448, 24.619942285120487, 30.72385536134243, -0.4999999701976776, 5.613219887018204, -149.49744275212288, 19.77542108297348, -137.56609860807657, 5.499999947845936, 24.00865748524666, 7.299999974668026, -21.046442843973637, -18.63521434366703, 3.4000000804662704], "episode_lengths": [244, 195, 232, 289, 231, 215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279, 220, 205, 254, 210, 183, 215, 201, 185, 208, 219, 224, 203, 212, 229, 234, 295, 228, 250, 223, 215, 180, 207, 237, 191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5743691486338686, "mean_inference_ms": 24.495266964687975, "mean_action_processing_ms": 0.13395371732769365, "mean_env_wait_ms": 4.559356394899232, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 456300, "num_env_steps_sampled": 98304, "num_env_steps_trained": 456300, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 98304, "agent_timesteps_total": 98304, "timers": {"training_iteration_time_ms": 372.721, "learn_time_ms": 74.367, "learn_throughput": 4034.055, "synch_weights_time_ms": 21.088}, "counters": {"num_env_steps_sampled": 98304, "num_env_steps_trained": 456300, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 456300, "last_target_update_ts": 98304, "num_target_updates": 191}, "done": false, "episodes_total": 391, "training_iteration": 96, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-33-25", "timestamp": 1655494405, "time_this_iter_s": 5.811709403991699, "time_total_s": 525.0266833305359, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 525.0266833305359, "timesteps_since_restore": 0, "iterations_since_restore": 96, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.712500000000002, "ram_util_percent": 64.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 12.605157852172852, "min_q": -2.4677741527557373, "max_q": 32.551536560058594, "mean_td_error": -0.5140407681465149}, "td_error": [-0.7009620666503906, -0.4859132766723633, -0.1995391845703125, -1.8490467071533203, -7.4884748458862305, -0.21754741668701172, -0.11757230758666992, 0.5204315185546875, -0.9289731979370117, -0.28529834747314453, -0.07494544982910156, -0.9157261848449707, -0.550323486328125, -1.0018348693847656, -0.06629371643066406, 1.1642303466796875, -1.6731886863708496, -0.2136211395263672, -0.5036201477050781, -0.09943771362304688, -0.20606136322021484, 0.3318061828613281, -0.2732400894165039, -1.1417889595031738, -0.2656517028808594, 0.706787109375, 0.10908770561218262, 0.05787944793701172, -0.23480224609375, 0.05745124816894531, 10.921205520629883, -0.5518970489501953, -0.40886878967285156, 0.6739597320556641, 0.015021324157714844, -0.4626169204711914, -0.9089984893798828, -2.276930332183838, 0.2964515686035156, 0.06502437591552734, -5.468770980834961, -0.7427558898925781, -6.205077171325684, -1.0509071350097656, 0.3345184326171875, 0.27188873291015625, -8.428301811218262, -0.10266828536987305, -0.0012674331665039062, -0.49263668060302734, -9.426813125610352, -0.5671873092651367, -0.21387672424316406, -1.5502614974975586, 0.05569171905517578, -0.36072731018066406, -0.2539348602294922, -9.904881477355957, 0.1895618438720703, 0.0088958740234375, -0.3765726089477539, 0.7959384918212891, -8.26161003112793, 0.14767932891845703, -0.5200743675231934, -0.3952674865722656, 1.4777412414550781, 0.531346321105957, -1.33563232421875, -0.25201416015625, 6.918156147003174, -0.09984970092773438, 1.0342531204223633, -0.7767887115478516, -0.6457557678222656, 0.11678695678710938, -0.22240066528320312, -0.12899208068847656, 0.11447811126708984, -4.4273481369018555, 0.1476278305053711, 0.8697757720947266, -1.7945632934570312, -0.11738014221191406, 0.3391294479370117, -1.3636894226074219, -0.1812906265258789, 0.28380823135375977, -0.5791645050048828, -0.9143824577331543, 0.5702924728393555, -6.002546310424805, -0.22625160217285156, -0.14395523071289062, 0.35493040084838867, -1.4005317687988281, 0.18723201751708984, 0.3769111633300781, -1.087052345275879, -7.110124588012695, -0.9485654830932617, 0.12407684326171875, -0.636500358581543, -0.4151325225830078, -0.17531204223632812, 1.575516700744629, 0.10057306289672852, -6.418813705444336, 0.05048179626464844, -0.6667976379394531, -0.3201022148132324, -0.40570783615112305, 0.2869586944580078, -0.08857917785644531, -0.7852640151977539, -0.4481077194213867, -0.4739265441894531, -0.3130655288696289, -0.14840221405029297, -0.09948563575744629, 0.35493040084838867, -5.733736038208008, -0.0449984073638916, -4.856513023376465, -0.13952064514160156, -0.1898941993713379, 0.024384498596191406, 1.877232551574707, 0.1097726821899414, -0.21755218505859375, -0.9573812484741211, -0.33010292053222656, 0.0627431869506836, -0.08308172225952148, -0.294588565826416, -0.18387317657470703, -0.7325069904327393, -7.671509742736816, -0.07858085632324219, -0.1839313507080078, 0.012885093688964844, -0.011696815490722656, -0.5701904296875, -0.8159985542297363, 0.10588455200195312, 0.638941764831543, -0.0075283050537109375, -8.393594741821289, -0.6355423927307129, -0.8062343597412109, 0.22413063049316406, 0.19367265701293945, -0.21534967422485352, -0.6276645660400391, -0.1544034481048584, -0.1476593017578125, -0.2574315071105957, -0.05017375946044922, 0.5702924728393555, 0.15185070037841797, -0.42442893981933594, 0.05068492889404297, -0.6593905687332153, 0.31679630279541016, -6.953282356262207, -1.008819580078125, 0.0530242919921875, -5.262713432312012, -0.06907367706298828, -0.654963493347168, 0.09648513793945312, -0.13155698776245117, -0.6603412628173828, -0.2453012466430664, 2.3245444297790527, 0.15653324127197266, 1.590639591217041, -0.40837621688842773, 1.5524396896362305, 0.10198187828063965, -0.00992584228515625, 0.1754446029663086, 0.10908770561218262, 0.14426803588867188, -0.5982561111450195, -0.2348957061767578, -0.06265830993652344, -0.3288917541503906, -0.4447975158691406, -0.4198570251464844, -0.9104843139648438, -0.7183761596679688, 0.2964515686035156, -0.580657958984375, -0.5018310546875, -0.9130363464355469, 0.13526344299316406, 0.4312009811401367, 0.04746055603027344, -0.13899707794189453, 0.14110374450683594, -0.2753634452819824, -0.05017375946044922, 0.2407093048095703, -0.435943603515625, -3.2558555603027344, -0.06759357452392578, -0.4548664093017578, -0.5967693328857422, -0.09162044525146484, -0.3446331024169922, -0.43195247650146484, -0.1523904800415039, 0.02301311492919922, -0.22982454299926758, -0.6751480102539062, 0.13487911224365234, 0.28380823135375977, -0.8442287445068359, 0.3385887145996094, -0.06780529022216797, -1.6731886863708496, -0.7839260101318359, -0.09943294525146484, -0.3913097381591797, 2.2839794158935547, 0.18407440185546875, -0.3535275459289551, -1.1180381774902344, -0.3740425109863281, -0.2028522491455078, -0.8758964538574219, -0.1250476837158203, -0.3557281494140625, 0.09039020538330078, -0.16047286987304688, -0.6716561317443848, -0.2718632221221924, 2.00007963180542, -0.9772891998291016, -1.5090198516845703, -0.2876014709472656, 0.3648524284362793, 0.13066673278808594, -0.2701601982116699, 0.073455810546875, -0.05336952209472656, -0.13789081573486328, -0.03341102600097656, 0.4005146026611328, -0.08298969268798828, -0.9782238006591797, 0.18666648864746094, -0.009344100952148438, -0.7598066329956055, 6.337886810302734, -9.193897247314453, -0.20925426483154297, -0.08455181121826172, -0.013376235961914062, -0.3452119827270508, -0.18610095977783203, -0.23234272003173828, 0.06896018981933594, -0.6280946731567383, 0.8772830963134766, -0.2718632221221924, 0.15259265899658203, -0.06834173202514648, 0.02053070068359375, 3.8752970695495605, -0.24654388427734375, -0.8604526519775391, 3.319477081298828, -6.890406608581543, -0.2816658020019531, -0.19387435913085938, 0.21860694885253906, -0.7180576324462891, -0.42336463928222656, -0.5008611679077148, 0.5984535217285156, -0.05953025817871094, 10.325301170349121, -0.48578643798828125, 1.0125417709350586, -0.22141742706298828, -9.313863754272461, 0.12603759765625, -0.3091583251953125, 0.01564788818359375, -0.9683666229248047, 0.14846038818359375, -0.2786588668823242, 0.15828704833984375, -1.2604193687438965, 0.09753036499023438, -0.5227737426757812, -1.026144027709961, 0.10250473022460938], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 99328, "num_env_steps_trained": 461100, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 461100, "last_target_update_ts": 99328, "num_target_updates": 193}, "sampler_results": {"episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -16.034504569545387, "episode_len_mean": 226.22, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763, 7.598936676979065, 3.30000002682209, -59.45756348967552, 16.46475064754486, 14.813682079315186, 32.30865779519081, 7.410635396838188, 11.610635228455067, 3.2000000700354576, 19.27254143357277, 1.5000000596046448, 24.619942285120487, 30.72385536134243, -0.4999999701976776, 5.613219887018204, -149.49744275212288, 19.77542108297348, -137.56609860807657, 5.499999947845936, 24.00865748524666, 7.299999974668026, -21.046442843973637, -18.63521434366703, 3.4000000804662704, 1.4000001475214958, 11.49999974668026, 6.400000140070915, -0.4999999776482582, 3.800000086426735], "episode_lengths": [215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279, 220, 205, 254, 210, 183, 215, 201, 185, 208, 219, 224, 203, 212, 229, 234, 295, 228, 250, 223, 215, 180, 207, 237, 191, 258, 233, 194, 237, 223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5741936908953709, "mean_inference_ms": 24.48186503505851, "mean_action_processing_ms": 0.1338763443262863, "mean_env_wait_ms": 4.557980376943595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 34.73011891543865, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -16.034504569545387, "episode_len_mean": 226.22, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.400000065565109, -2.9632187336683273, -117.15617549419403, 29.785761430859566, 7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763, 7.598936676979065, 3.30000002682209, -59.45756348967552, 16.46475064754486, 14.813682079315186, 32.30865779519081, 7.410635396838188, 11.610635228455067, 3.2000000700354576, 19.27254143357277, 1.5000000596046448, 24.619942285120487, 30.72385536134243, -0.4999999701976776, 5.613219887018204, -149.49744275212288, 19.77542108297348, -137.56609860807657, 5.499999947845936, 24.00865748524666, 7.299999974668026, -21.046442843973637, -18.63521434366703, 3.4000000804662704, 1.4000001475214958, 11.49999974668026, 6.400000140070915, -0.4999999776482582, 3.800000086426735], "episode_lengths": [215, 244, 269, 221, 219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279, 220, 205, 254, 210, 183, 215, 201, 185, 208, 219, 224, 203, 212, 229, 234, 295, 228, 250, 223, 215, 180, 207, 237, 191, 258, 233, 194, 237, 223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5741936908953709, "mean_inference_ms": 24.48186503505851, "mean_action_processing_ms": 0.1338763443262863, "mean_env_wait_ms": 4.557980376943595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 461100, "num_env_steps_sampled": 99328, "num_env_steps_trained": 461100, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 99328, "agent_timesteps_total": 99328, "timers": {"training_iteration_time_ms": 352.289, "learn_time_ms": 75.32, "learn_throughput": 3982.982, "synch_weights_time_ms": 21.489}, "counters": {"num_env_steps_sampled": 99328, "num_env_steps_trained": 461100, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 461100, "last_target_update_ts": 99328, "num_target_updates": 193}, "done": false, "episodes_total": 396, "training_iteration": 97, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-33-30", "timestamp": 1655494410, "time_this_iter_s": 5.605363607406616, "time_total_s": 530.6320469379425, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 530.6320469379425, "timesteps_since_restore": 0, "iterations_since_restore": 97, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.6375, "ram_util_percent": 64.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "mean_q": 14.081496238708496, "min_q": -0.7479225397109985, "max_q": 34.472286224365234, "mean_td_error": 0.8334661722183228}, "td_error": [-0.039356231689453125, -0.08789348602294922, 0.6870965957641602, 1.2186241149902344, 1.2271947860717773, 0.6599159240722656, 3.298778533935547, 1.833878517150879, 0.03855323791503906, 1.3005008697509766, 1.2488174438476562, 0.7377109527587891, -0.7660350799560547, 0.6566867828369141, 0.4444265365600586, 0.611076831817627, 0.41523170471191406, 0.0035915374755859375, -0.026395797729492188, 1.2404298782348633, 0.907257080078125, -0.017107009887695312, -0.227630615234375, 3.140313148498535, 0.4164552688598633, 0.8440685272216797, 1.2551870346069336, 0.09893369674682617, 1.6978235244750977, 0.1347503662109375, 0.7672710418701172, -0.07347488403320312, -8.043510437011719, 0.5975017547607422, 1.194300651550293, 0.08520793914794922, 1.700225830078125, 3.5055761337280273, 0.5259523391723633, 0.11635780334472656, 2.723794937133789, 1.4755678176879883, 0.23668670654296875, 0.5292854309082031, 0.8971213698387146, 0.017923355102539062, -0.3962879180908203, 1.3271265029907227, 0.7646384239196777, 0.6749134063720703, -0.3722972869873047, 0.5490036010742188, 0.29584503173828125, 0.7380332946777344, 0.8397417068481445, 0.8964309692382812, 0.49698638916015625, 0.7548465728759766, 1.0147466659545898, 1.2975902557373047, 0.8450174331665039, 0.13842487335205078, 1.1388607025146484, 0.3984661102294922, 0.9817924499511719, -8.13983154296875, 0.9104604721069336, 1.0766181945800781, 0.456113338470459, 1.5384578704833984, 0.9576334953308105, 0.47205257415771484, 1.6238670349121094, 0.1342935562133789, 1.1750030517578125, 0.8958988189697266, 0.4023885726928711, 0.2410430908203125, 0.6859426498413086, 0.11227035522460938, 0.8053216934204102, 1.5139684677124023, 0.7818813323974609, 1.2396059036254883, 0.5851306915283203, -1.2124881744384766, 0.8621406555175781, -0.09117698669433594, 1.2772235870361328, 1.270561695098877, 0.11921405792236328, 0.3169412612915039, 1.786850929260254, -0.1021881103515625, 0.09774947166442871, 0.137420654296875, 0.8990917205810547, 1.128852367401123, 1.0471160411834717, 1.9357872009277344, -3.8051414489746094, 0.8719930648803711, 1.6845932006835938, 1.031050682067871, 0.7928619384765625, 1.183262825012207, 1.2625141143798828, -0.03876304626464844, 0.27362823486328125, 0.5693931579589844, 0.7789949774742126, 5.33006477355957, -0.8751583099365234, 1.3304576873779297, 1.0078725814819336, 0.9803638458251953, -7.085643768310547, -0.18779468536376953, 0.7580413818359375, 1.0213851928710938, 2.7567930221557617, 0.04574298858642578, -7.353691101074219, 0.9619441032409668, 0.9792232513427734, 1.3374319076538086, 0.5412311553955078, 0.8165988922119141, 0.7370052337646484, 1.2518634796142578, 0.1490306854248047, 0.005126953125, -0.03375434875488281, 1.1232357025146484, 1.3236780166625977, 1.1444621086120605, -0.23354196548461914, 1.0037212371826172, 1.5774307250976562, 2.136974334716797, 4.344292163848877, 1.6094274520874023, 0.8719930648803711, 0.5082430839538574, 1.3489494323730469, 0.6486644744873047, 3.4512338638305664, -1.776115894317627, -3.8938822746276855, 1.7630615234375, 0.2876167297363281, 0.32558345794677734, 1.3445816040039062, 0.798126220703125, 0.7879600524902344, 0.7783956527709961, 0.8319530487060547, 1.134328842163086, 0.6427574157714844, 1.1425762176513672, 1.2719907760620117, 0.5499267578125, 4.890040874481201, 1.3829479217529297, 1.3006591796875, 0.9013891220092773, 0.03214073181152344, 1.5274178981781006, 1.3018741607666016, 1.8607540130615234, 1.6455045938491821, 0.5192017555236816, 0.7343587875366211, 1.2241034507751465, 1.9537887573242188, -0.6069579124450684, 1.2449541091918945, 2.1161060333251953, 6.649382591247559, 0.8237648010253906, 1.1987686157226562, 2.1161060333251953, 1.0875978469848633, 1.0682837963104248, 1.7535181045532227, 0.4835338592529297, 1.1525535583496094, 1.4329471588134766, 0.9778628349304199, -0.14638519287109375, 0.704742431640625, 1.2948040962219238, 1.172053337097168, 0.34839344024658203, 0.40509700775146484, 0.939448356628418, 1.585296630859375, 1.0673465728759766, 1.3825349807739258, 2.4235525131225586, 1.0050239562988281, 15.096145629882812, 1.2193355560302734, -3.765687942504883, 0.7024574279785156, 0.6509189605712891, -0.4708223342895508, 1.3170280456542969, 1.1114797592163086, 0.7962532043457031, -5.313562393188477, 0.5221800804138184, 0.8540153503417969, 5.643439769744873, 11.514540672302246, 1.1282405853271484, 1.7924928665161133, 1.3084063529968262, 0.7220363616943359, 1.4853096008300781, 1.6455045938491821, 1.337259292602539, -0.1008005142211914, 1.5088233947753906, 1.8125920295715332, -4.466226577758789, 1.6717901229858398, 0.4967193603515625, 1.5752677917480469, 5.444536209106445, 1.057814598083496, 0.13348388671875, 1.603569507598877, 0.5829057693481445, 1.5822782516479492, 1.239706039428711, 0.8398170471191406, 0.4897499084472656, 1.7637557983398438, 0.5968723297119141, -0.9925222396850586, 0.690821647644043, 1.5744619369506836, 2.2393293380737305, 0.8468761444091797, 1.621647834777832, -5.277217864990234, 0.583897590637207, 0.9708213806152344, 0.47072315216064453, 0.46366119384765625, 2.1630849838256836, 1.782989501953125, 0.39634227752685547, -0.6188621520996094, 0.11644649505615234, 0.04410409927368164, 0.9069452285766602, 0.30345821380615234, -0.5083580017089844, 1.2933025360107422, 0.6164913177490234, 1.3577156066894531, 1.2397308349609375, 1.0439319610595703, 0.9711141586303711, 1.5028390884399414, 1.7027626037597656, 0.9106178283691406, 1.4920196533203125, 1.216501235961914, 0.9759793281555176, 0.564549446105957, 0.5085039138793945, 2.991621971130371, 0.14983367919921875, 0.17780685424804688, 1.4939346313476562, -0.2541327476501465, -0.6713790893554688, 1.5522832870483398, 0.9235429763793945, 1.056145429611206, 0.11961746215820312, 1.3268623352050781, 0.17961502075195312, 0.4412956237792969, 0.15646839141845703, 0.3269023895263672, 0.22023391723632812, 1.1741418838500977, 0.3652915954589844, 6.976891040802002, -0.34714317321777344, 0.7856354713439941, -0.013047218322753906, 1.194106101989746, 1.9433813095092773, 0.1772480010986328, -0.12609004974365234], "custom_metrics": {}, "num_agent_steps_trained": 300}}, "num_env_steps_sampled": 100352, "num_env_steps_trained": 465900, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 465900, "last_target_update_ts": 100352, "num_target_updates": 195}, "sampler_results": {"episode_reward_max": 42.22475775331259, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -14.24563200801611, "episode_len_mean": 225.57, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763, 7.598936676979065, 3.30000002682209, -59.45756348967552, 16.46475064754486, 14.813682079315186, 32.30865779519081, 7.410635396838188, 11.610635228455067, 3.2000000700354576, 19.27254143357277, 1.5000000596046448, 24.619942285120487, 30.72385536134243, -0.4999999701976776, 5.613219887018204, -149.49744275212288, 19.77542108297348, -137.56609860807657, 5.499999947845936, 24.00865748524666, 7.299999974668026, -21.046442843973637, -18.63521434366703, 3.4000000804662704, 1.4000001475214958, 11.49999974668026, 6.400000140070915, -0.4999999776482582, 3.800000086426735, 21.76393073052168, 42.22475775331259, -11.986115217208862, 31.15105002373457], "episode_lengths": [219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279, 220, 205, 254, 210, 183, 215, 201, 185, 208, 219, 224, 203, 212, 229, 234, 295, 228, 250, 223, 215, 180, 207, 237, 191, 258, 233, 194, 237, 223, 208, 216, 250, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5741799374519396, "mean_inference_ms": 24.505274673706754, "mean_action_processing_ms": 0.1337956169141864, "mean_env_wait_ms": 4.560613895880892, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "episode_reward_max": 42.22475775331259, "episode_reward_min": -417.0205919444561, "episode_reward_mean": -14.24563200801611, "episode_len_mean": 225.57, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.300000160932541, -1.599999912083149, 3.499999977648258, 3.400000087916851, 21.823855608701706, -51.433811724185944, 6.300000064074993, 14.321270555257797, -11.638960637152195, 21.949584744870663, 14.521270833909512, 10.607755430042744, 8.600000217556953, 20.318390801548958, -261.7231772765517, -38.5639308989048, -26.48539187014103, 5.407755456864834, 17.938949286937714, -87.06838920712471, 20.175421468913555, 9.699999950826168, 34.73011891543865, 7.410635210573673, 12.66478594392538, 20.415510304272175, -126.85636539012194, -136.25617529451847, -86.19277760386467, 16.328313626348972, -73.98046842962503, -31.35707824677229, 13.175421297550201, 1.0752003192901611, -154.2406648993492, 3.700000062584877, 3.5000000074505806, -78.17078369110823, 4.200000055134296, 1.8000000417232513, -417.0205919444561, 17.21063531935215, 4.470348358154297e-08, 4.899999961256981, 19.710635244846344, 19.92127078026533, 8.110635451972485, 17.821270778775215, 12.996451742947102, 5.3000000566244125, 1.3000000342726707, -200.04156786203384, 12.228314034640789, 5.900000035762787, 9.699999764561653, 6.664785750210285, 9.310635440051556, 9.028313979506493, 19.11321983486414, 13.50775557756424, 13.099999822676182, 10.628313958644867, -17.024781472980976, 24.959246568381786, 17.993099883198738, 19.100902497768402, -165.74980837851763, 7.598936676979065, 3.30000002682209, -59.45756348967552, 16.46475064754486, 14.813682079315186, 32.30865779519081, 7.410635396838188, 11.610635228455067, 3.2000000700354576, 19.27254143357277, 1.5000000596046448, 24.619942285120487, 30.72385536134243, -0.4999999701976776, 5.613219887018204, -149.49744275212288, 19.77542108297348, -137.56609860807657, 5.499999947845936, 24.00865748524666, 7.299999974668026, -21.046442843973637, -18.63521434366703, 3.4000000804662704, 1.4000001475214958, 11.49999974668026, 6.400000140070915, -0.4999999776482582, 3.800000086426735, 21.76393073052168, 42.22475775331259, -11.986115217208862, 31.15105002373457], "episode_lengths": [219, 210, 204, 203, 215, 251, 183, 211, 245, 212, 194, 200, 231, 218, 323, 244, 225, 236, 227, 264, 216, 216, 231, 221, 199, 195, 277, 282, 272, 237, 256, 260, 200, 234, 258, 201, 232, 255, 219, 176, 363, 234, 211, 183, 226, 224, 204, 231, 233, 195, 187, 303, 231, 221, 223, 228, 226, 215, 240, 208, 180, 216, 251, 195, 215, 226, 279, 220, 205, 254, 210, 183, 215, 201, 185, 208, 219, 224, 203, 212, 229, 234, 295, 228, 250, 223, 215, 180, 207, 237, 191, 258, 233, 194, 237, 223, 208, 216, 250, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5741799374519396, "mean_inference_ms": 24.505274673706754, "mean_action_processing_ms": 0.1337956169141864, "mean_env_wait_ms": 4.560613895880892, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 16, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 465900, "num_env_steps_sampled": 100352, "num_env_steps_trained": 465900, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 4800, "timesteps_total": 100352, "agent_timesteps_total": 100352, "timers": {"training_iteration_time_ms": 345.179, "learn_time_ms": 74.907, "learn_throughput": 4004.951, "synch_weights_time_ms": 21.089}, "counters": {"num_env_steps_sampled": 100352, "num_env_steps_trained": 465900, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 465900, "last_target_update_ts": 100352, "num_target_updates": 195}, "done": true, "episodes_total": 400, "training_iteration": 98, "trial_id": "5ef09_00007", "experiment_id": "1301c5b2185047b4809b1a3a5c253743", "date": "2022-06-17_22-33-36", "timestamp": 1655494416, "time_this_iter_s": 5.489135980606079, "time_total_s": 536.1211829185486, "pid": 23812, "hostname": "EIS7Y0J022", "node_ip": "127.0.0.1", "config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"num_workers": 16, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 4, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": 450, "soft_horizon": false, "no_done_at_end": false, "env": "homm_env_tiny_trivial", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "recreate_failed_workers": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf2", "eager_tracing": false, "eager_max_retraces": 20, "explore": false, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "always_attach_evaluation_results": false, "keep_per_episode_custom_metrics": false, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "metrics_episode_collection_timeout_s": 180, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_reporting": 1, "min_train_timesteps_per_reporting": null, "min_sample_timesteps_per_reporting": 1000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box([0 0 0 ... 0 0 0], [7 7 7 ... 1 1 1], (1060,), int64)", "Discrete(8)", {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "disable_env_checking": false, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": 1000, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "target_network_update_freq": 500, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "ray.rllib.utils.replay_buffers.MultiAgentPrioritizedReplayBuffer", "capacity": 50000, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "replay_sequence_length": 1, "replay_batch_size": 300}, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "grad_clip": 40, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": false, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "worker_side_prioritization": false}, "time_since_restore": 536.1211829185486, "timesteps_since_restore": 0, "iterations_since_restore": 98, "warmup_time": 16.907930612564087, "perf": {"cpu_util_percent": 30.9125, "ram_util_percent": 64.07499999999999}}
